"use strict";var JHe=Object.create;var _2=Object.defineProperty;var Cme=Object.getOwnPropertyDescriptor;var ZHe=Object.getOwnPropertyNames;var eVe=Object.getPrototypeOf,tVe=Object.prototype.hasOwnProperty;var N=(n,e)=>()=>(n&&(e=n(n=0)),e);var P=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),Dr=(n,e)=>{for(var t in e)_2(n,t,{get:e[t],enumerable:!0})},Eme=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of ZHe(e))!tVe.call(n,o)&&o!==t&&_2(n,o,{get:()=>e[o],enumerable:!(r=Cme(e,o))||r.enumerable});return n};var q=(n,e,t)=>(t=n!=null?JHe(eVe(n)):{},Eme(e||!n||!n.__esModule?_2(t,"default",{value:n,enumerable:!0}):t,n)),Eo=n=>Eme(_2({},"__esModule",{value:!0}),n),E=(n,e,t,r)=>{for(var o=r>1?void 0:r?Cme(e,t):e,s=n.length-1,a;s>=0;s--)(a=n[s])&&(o=(r?a(e,t,o):a(o))||o);return r&&o&&_2(e,t,o),o},v=(n,e)=>(t,r)=>e(t,r,n);var ht=P((GPt,Pme)=>{"use strict";var RW=Object.defineProperty,nVe=Object.getOwnPropertyDescriptor,rVe=Object.getOwnPropertyNames,iVe=Object.prototype.hasOwnProperty,oVe=(n,e)=>{for(var t in e)RW(n,t,{get:e[t],enumerable:!0})},sVe=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of rVe(e))!iVe.call(n,o)&&o!==t&&RW(n,o,{get:()=>e[o],enumerable:!(r=nVe(e,o))||r.enumerable});return n},aVe=n=>sVe(RW({},"__esModule",{value:!0}),n),kme={};oVe(kme,{config:()=>pVe,t:()=>Rme});Pme.exports=aVe(kme);var cVe=require("fs"),lVe=require("fs/promises");async function uVe(n){if(n.protocol==="file:")return await(0,lVe.readFile)(n,"utf8");if(n.protocol==="http:"||n.protocol==="https:"){let e=await fetch(n.toString(),{headers:{"Accept-Encoding":"gzip, deflate",Accept:"application/json"},redirect:"follow"});if(!e.ok){let r=`Unexpected ${e.status} response while trying to read ${n}`;try{r+=`: ${await e.text()}`}catch{}throw new Error(r)}return await e.text()}throw new Error("Unsupported protocol")}function dVe(n){return(0,cVe.readFileSync)(n,"utf8")}var x2;function pVe(n){if("contents"in n){typeof n.contents=="string"?x2=JSON.parse(n.contents):x2=n.contents;return}if("fsPath"in n){let e=dVe(n.fsPath),t=JSON.parse(e);x2=wme(t)?t.contents.bundle:t;return}if(n.uri){let e=n.uri;return typeof n.uri=="string"&&(e=new URL(n.uri)),new Promise((t,r)=>{let o=uVe(e).then(s=>{try{let a=JSON.parse(s);x2=wme(a)?a.contents.bundle:a}catch(a){r(a)}}).catch(s=>{r(s)});t(o)})}}function Rme(...n){let e=n[0],t,r,o;if(typeof e=="string")t=e,r=e,n.splice(0,1),o=!n||typeof n[0]!="object"?n:n[0];else if(e instanceof Array){let a=n.slice(1);if(e.length!==a.length+1)throw new Error("expected a string as the first argument to l10n.t");let c=e[0];for(let l=1;l<e.length;l++)c+=`{${l-1}}`+e[l];return Rme(c,...a)}else r=e.message,t=r,e.comment&&e.comment.length>0&&(t+=`/${Array.isArray(e.comment)?e.comment.join(""):e.comment}`),o=e.args??{};let s=x2?.[t];return s?typeof s=="string"?iF(s,o):s.comment?iF(s.message,o):iF(r,o):iF(r,o)}var fVe=/{([^}]+)}/g;function iF(n,e){return Object.keys(e).length===0?n:n.replace(fVe,(t,r)=>e[r]??t)}function wme(n){return typeof n?.contents?.bundle=="object"&&typeof n?.version=="string"}});var V1=P(Op=>{"use strict";Object.defineProperty(Op,"__esModule",{value:!0});Op.BaseTokensPerName=Op.BaseTokensPerMessage=Op.BaseTokensPerCompletion=Op.ChatRole=void 0;var ige;(function(n){n.System="system",n.User="user",n.Assistant="assistant",n.Function="function",n.Tool="tool"})(ige||(Op.ChatRole=ige={}));Op.BaseTokensPerCompletion=3;Op.BaseTokensPerMessage=3;Op.BaseTokensPerName=1});var oge=P(bK=>{"use strict";Object.defineProperty(bK,"__esModule",{value:!0});bK.once=GGe;function GGe(n){let e,t=!1,r=(...o)=>(t||(e=n(...o),t=!0),e);return r.clear=()=>{t=!1},r}});var _K=P(wv=>{"use strict";Object.defineProperty(wv,"__esModule",{value:!0});wv.MaterializedChatMessage=wv.MaterializedChatMessageTextChunk=wv.MaterializedContainer=void 0;var G2=oge(),YF=V1(),G1=class n{id;name;priority;children;metadata;flags;constructor(e,t,r,o,s,a){this.id=e,this.name=t,this.priority=r,this.children=o,this.metadata=s,this.flags=a}has(e){return!!(this.flags&e)}async tokenCount(e){let t=0;return await Promise.all(this.children.map(async r=>{sge(r);let o=await r.tokenCount(e);t+=o})),t}async upperBoundTokenCount(e){let t=0;return await Promise.all(this.children.map(async r=>{let o=await r.upperBoundTokenCount(e);t+=o})),t}replaceNode(e,t){return dge(e,this.children,t)}allMetadata(){return uge(this)}*toChatMessages(){for(let e of this.children)sge(e),e instanceof n?yield*e.toChatMessages():e.isEmpty||(yield e.toChatMessage())}removeLowestPriorityChild(){this.has(1)?zGe(this):lge(this)}};wv.MaterializedContainer=G1;var z_=class{text;priority;metadata;lineBreakBefore;constructor(e,t,r=[],o){this.text=e,this.priority=t,this.metadata=r,this.lineBreakBefore=o}upperBoundTokenCount(e){return this._upperBound(e)}_upperBound=(0,G2.once)(async e=>await e.tokenLength(this.text)+(this.lineBreakBefore!==0?1:0))};wv.MaterializedChatMessageTextChunk=z_;var $_=class{id;role;name;toolCalls;toolCallId;priority;metadata;children;constructor(e,t,r,o,s,a,c,l){this.id=e,this.role=t,this.name=r,this.toolCalls=o,this.toolCallId=s,this.priority=a,this.metadata=c,this.children=l}async tokenCount(e){return this._tokenCount(e)}async upperBoundTokenCount(e){return this._upperBound(e)}get text(){return this._text()}get isEmpty(){return!/\S/.test(this.text)&&!this.toolCalls?.length&&!this.toolCallId}replaceNode(e,t){let r=dge(e,this.children,t);return r&&this.onChunksChange(),r}removeLowestPriorityChild(){lge(this)}onChunksChange(){this._tokenCount.clear(),this._upperBound.clear(),this._text.clear()}_tokenCount=(0,G2.once)(async e=>e.countMessageTokens(this.toChatMessage()));_upperBound=(0,G2.once)(async e=>{let t=await this._baseMessageTokenCount(e);return await Promise.all(this.children.map(async r=>{let o=await r.upperBoundTokenCount(e);t+=o})),t});_baseMessageTokenCount=(0,G2.once)(e=>e.countMessageTokens({...this.toChatMessage(),content:""}));_text=(0,G2.once)(()=>{let e="";for(let{text:t,isTextSibling:r}of cge(this))(t.lineBreakBefore===1||t.lineBreakBefore===2&&!r)&&e.length&&!e.endsWith(`
`)&&(e+=`
`),e+=t.text;return e.trim()});toChatMessage(){return this.role===YF.ChatRole.System?{role:this.role,content:this.text,...this.name?{name:this.name}:{}}:this.role===YF.ChatRole.Assistant?{role:this.role,content:this.text,...this.toolCalls?{tool_calls:this.toolCalls}:{},...this.name?{name:this.name}:{}}:this.role===YF.ChatRole.User?{role:this.role,content:this.text,...this.name?{name:this.name}:{}}:this.role===YF.ChatRole.Tool?{role:this.role,content:this.text,tool_call_id:this.toolCallId}:{role:this.role,content:this.text,name:this.name}}};wv.MaterializedChatMessage=$_;function QF(n){return!(n instanceof z_)}function sge(n){if(!(n instanceof G1)&&!(n instanceof $_))throw new Error(`Cannot have a text node outside a ChatMessage. Text: "${n.text}"`)}function*cge(n,e=!1){for(let t of n.children)t instanceof z_?(yield{text:t,isTextSibling:e},e=!0):(yield*cge(t,e),e=!1)}function zGe(n){let e;function t(s,a){if(s instanceof z_)(!e||s.priority<e.node.priority)&&(e={chain:a.slice(),node:s});else{a.push(s);for(let c of s.children)t(c,a);a.pop()}}if(t(n,[]),!e)throw new Error("No lowest priority node found");let r=e.node,o=e.chain.length-1;for(;o>=0;o--){let s=e.chain[o];if(s.children.splice(s.children.indexOf(r),1),s instanceof $_&&s.onChunksChange(),s.children.length>0)break;r=s}for(;o>=0;o--){let s=e.chain[o];s instanceof $_&&s.onChunksChange()}}function lge(n){let e,t=n.children.map((o,s)=>({chain:[n],index:s}));for(let o=0;o<t.length;o++){let{chain:s,index:a}=t[o],c=s[s.length-1].children[a];if(c instanceof G1&&c.has(4)){let l=[...s,c];t.splice(o+1,0,...c.children.map((u,d)=>({chain:l,index:d})))}else if(!e||c.priority<e.value.priority)e={chain:s,index:a,value:c};else if(c.priority===e.value.priority){e.lowestNested??=age(e.value);let l=age(c);l<e.lowestNested&&(e={chain:s,index:a,value:c,lowestNested:l})}}if(!e)throw new Error("No lowest priority node found");let r=e.chain[e.chain.length-1].children;e.value instanceof z_||e.value instanceof G1&&e.value.has(2)||QF(e.value)&&!e.value.children.length?r.splice(e.index,1):(e.value.removeLowestPriorityChild(),e.value.children.length===0&&r.splice(e.index,1));for(let o of e.chain)o instanceof $_&&o.onChunksChange()}function age(n){if(!QF(n))return-1;let e=Number.MAX_SAFE_INTEGER;for(let t of n.children)e=Math.min(e,t.priority);return e}function*uge(n){yield*n.metadata;for(let e of n.children)QF(e)?yield*uge(e):yield*e.metadata}function dge(n,e,t){for(let r=0;r<e.length;r++){let o=e[r];if(QF(o)){if(o.id===n){let a=e[r];return e[r]=t,a}let s=o.replaceNode(n,t);if(s)return s}}}});var fge=P(()=>{"use strict";function $Ge(n,e,...t){return{ctor:n,props:e,children:t.flat()}}function pge(){throw new Error("This should not be invoked!")}pge.isFragment=!0;globalThis.vscpp=$Ge;globalThis.vscppf=pge});var SK=P(XF=>{"use strict";Object.defineProperty(XF,"__esModule",{value:!0});XF.PromptElement=void 0;fge();var xK=class{props;get priority(){return this.props.priority??Number.MAX_SAFE_INTEGER}get insertLineBreakBefore(){return!0}constructor(e){this.props=e}};XF.PromptElement=xK});var PK=P(Or=>{"use strict";Object.defineProperty(Or,"__esModule",{value:!0});Or.Expandable=Or.Chunk=Or.LegacyPrioritization=Or.ToolResult=Or.PrioritizedList=Or.TextChunk=Or.ToolMessage=Or.FunctionMessage=Or.AssistantMessage=Or.UserMessage=Or.SystemMessage=Or.BaseChatMessage=void 0;Or.isChatMessagePromptElement=WGe;var z2=V1(),W_=SK();function WGe(n){return n instanceof JF||n instanceof ZF||n instanceof e5}var kv=class extends W_.PromptElement{render(){return vscpp(vscppf,null,this.props.children)}};Or.BaseChatMessage=kv;var JF=class extends kv{constructor(e){e.role=z2.ChatRole.System,super(e)}};Or.SystemMessage=JF;var ZF=class extends kv{constructor(e){e.role=z2.ChatRole.User,super(e)}};Or.UserMessage=ZF;var e5=class extends kv{constructor(e){e.role=z2.ChatRole.Assistant,super(e)}};Or.AssistantMessage=e5;var KGe=/\s+/g,IK=class extends kv{constructor(e){e.role=z2.ChatRole.Function,super(e)}};Or.FunctionMessage=IK;var TK=class extends kv{constructor(e){e.role=z2.ChatRole.Tool,super(e)}};Or.ToolMessage=TK;var t5=class extends W_.PromptElement{async prepare(e,t,r){let o=this.props.breakOnWhitespace?KGe:this.props.breakOn;if(!o)return vscpp(vscppf,null,this.props.children);let s="",a=[];for(let l of this.props.children||[])if(l&&typeof l=="object"){if(typeof l.ctor!="string")throw new Error("TextChunk children must be text literals or intrinsic attributes.");l.ctor==="br"?s+=`
`:a.push(l)}else l!=null&&(s+=l);let c=await YGe(e,o,s,r);return vscpp(vscppf,null,a,c)}render(e){return e}};Or.TextChunk=t5;async function YGe(n,e,t,r){if(e instanceof RegExp){if(!e.global)throw new Error(`\`breakOn\` expression must have the global flag set (got ${e})`);e.lastIndex=0}let o="",s=-1;for(;s<t.length;){let a;typeof e=="string"?a=t.indexOf(e,s===-1?0:s+e.length):a=e.exec(t)?.index??-1,a===-1&&(a=t.length);let c=o+t.slice(Math.max(0,s),a);if(await n.countTokens(c,r)>n.tokenBudget)return o;o=c,s=a}return o}var CK=class extends W_.PromptElement{render(){let e=this.props.children;if(e)return vscpp(vscppf,null,e.map((t,r)=>{if(!t)return;let o=this.props.descending?this.props.priority-r:this.props.priority-e.length+r;return typeof t!="object"?vscpp(t5,{priority:o},t):(t.props??={},t.props.priority=o,t)}))}};Or.PrioritizedList=CK;var EK=class extends W_.PromptElement{render(){let e=require("vscode");return vscpp(vscppf,null,this.props.data.content.map(t=>{if(t instanceof e.LanguageModelTextPart)return t.value;if(t instanceof e.LanguageModelPromptTsxPart)return vscpp("elementJSON",{data:t.value})}))}};Or.ToolResult=EK;var wK=class extends W_.PromptElement{render(){return vscpp(vscppf,null,this.props.children)}};Or.LegacyPrioritization=wK;var kK=class extends W_.PromptElement{render(){return vscpp(vscppf,null,this.props.children)}};Or.Chunk=kK;var RK=class extends W_.PromptElement{async render(e,t){return vscpp(vscppf,null,await this.props.value(t))}};Or.Expandable=RK});var hge=P($2=>{"use strict";Object.defineProperty($2,"__esModule",{value:!0});$2.localize=QGe;$2.localize2=XGe;$2.getConfiguredDefaultLocale=JGe;function mge(n,e){let t;return e.length===0?t=n:t=n.replace(/\{(\d+)\}/g,function(r,o){let s=o[0];return typeof e[s]<"u"?e[s]:r}),t}function QGe(n,e,...t){return mge(e,t)}function XGe(n,e,...t){let r=mge(e,t);return{original:r,value:r}}function JGe(n){}});var LK=P(Ge=>{"use strict";Object.defineProperty(Ge,"__esModule",{value:!0});Ge.isAndroid=Ge.isEdge=Ge.isSafari=Ge.isFirefox=Ge.isChrome=Ge.OS=Ge.setTimeout0=Ge.setTimeout0IsFaster=Ge.translationsConfigFile=Ge.platformLocale=Ge.locale=Ge.Language=Ge.language=Ge.userAgent=Ge.platform=Ge.isCI=Ge.isMobile=Ge.isIOS=Ge.webWorkerOrigin=Ge.isWebWorker=Ge.isWeb=Ge.isElectron=Ge.isNative=Ge.isLinuxSnap=Ge.isLinux=Ge.isMacintosh=Ge.isWindows=Ge.LANGUAGE_DEFAULT=void 0;Ge.PlatformToString=eze;Ge.isLittleEndian=tze;Ge.isBigSurOrNewer=nze;var gge=hge();Ge.LANGUAGE_DEFAULT="en";var Y2=!1,Q2=!1,K2=!1,_ge=!1,xge=!1,DK=!1,Sge=!1,NK=!1,Ige=!1,Tge=!1,W2,n5=Ge.LANGUAGE_DEFAULT,AK=Ge.LANGUAGE_DEFAULT,Cge,nh,rh=globalThis,gl;typeof rh.vscode<"u"&&typeof rh.vscode.process<"u"?gl=rh.vscode.process:typeof process<"u"&&(gl=process);var Ege=typeof gl?.versions?.electron=="string",ZGe=Ege&&gl?.type==="renderer";if(typeof gl=="object"){Y2=gl.platform==="win32",Q2=gl.platform==="darwin",K2=gl.platform==="linux",_ge=K2&&!!gl.env.SNAP&&!!gl.env.SNAP_REVISION,Sge=Ege,Ige=!!gl.env.CI||!!gl.env.BUILD_ARTIFACTSTAGINGDIRECTORY,W2=Ge.LANGUAGE_DEFAULT,n5=Ge.LANGUAGE_DEFAULT;let n=gl.env.VSCODE_NLS_CONFIG;if(n)try{let e=JSON.parse(n),t=e.availableLanguages["*"];W2=e.locale,AK=e.osLocale,n5=t||Ge.LANGUAGE_DEFAULT,Cge=e._translationsConfigFile}catch{}xge=!0}else typeof navigator=="object"&&!ZGe?(nh=navigator.userAgent,Y2=nh.indexOf("Windows")>=0,Q2=nh.indexOf("Macintosh")>=0,NK=(nh.indexOf("Macintosh")>=0||nh.indexOf("iPad")>=0||nh.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,K2=nh.indexOf("Linux")>=0,Tge=nh?.indexOf("Mobi")>=0,DK=!0,W2=gge.getConfiguredDefaultLocale(gge.localize({key:"ensureLoaderPluginIsLoaded",comment:["{Locked}"]},"_"))||Ge.LANGUAGE_DEFAULT,n5=W2,AK=navigator.language):console.error("Unable to resolve platform.");function eze(n){switch(n){case 0:return"Web";case 1:return"Mac";case 2:return"Linux";case 3:return"Windows"}}var r5=0;Q2?r5=1:Y2?r5=3:K2&&(r5=2);Ge.isWindows=Y2;Ge.isMacintosh=Q2;Ge.isLinux=K2;Ge.isLinuxSnap=_ge;Ge.isNative=xge;Ge.isElectron=Sge;Ge.isWeb=DK;Ge.isWebWorker=DK&&typeof rh.importScripts=="function";Ge.webWorkerOrigin=Ge.isWebWorker?rh.origin:void 0;Ge.isIOS=NK;Ge.isMobile=Tge;Ge.isCI=Ige;Ge.platform=r5;Ge.userAgent=nh;Ge.language=n5;var vge;(function(n){function e(){return Ge.language}n.value=e;function t(){return Ge.language.length===2?Ge.language==="en":Ge.language.length>=3?Ge.language[0]==="e"&&Ge.language[1]==="n"&&Ge.language[2]==="-":!1}n.isDefaultVariant=t;function r(){return Ge.language==="en"}n.isDefault=r})(vge||(Ge.Language=vge={}));Ge.locale=W2;Ge.platformLocale=AK;Ge.translationsConfigFile=Cge;Ge.setTimeout0IsFaster=typeof rh.postMessage=="function"&&!rh.importScripts;Ge.setTimeout0=(()=>{if(Ge.setTimeout0IsFaster){let n=[];rh.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let r=0,o=n.length;r<o;r++){let s=n[r];if(s.id===t.data.vscodeScheduleAsyncWork){n.splice(r,1),s.callback();return}}});let e=0;return t=>{let r=++e;n.push({id:r,callback:t}),rh.postMessage({vscodeScheduleAsyncWork:r},"*")}}return n=>setTimeout(n)})();Ge.OS=Q2||NK?2:Y2?1:3;var yge=!0,bge=!1;function tze(){if(!bge){bge=!0;let n=new Uint8Array(2);n[0]=1,n[1]=2,yge=new Uint16Array(n.buffer)[0]===513}return yge}Ge.isChrome=!!(Ge.userAgent&&Ge.userAgent.indexOf("Chrome")>=0);Ge.isFirefox=!!(Ge.userAgent&&Ge.userAgent.indexOf("Firefox")>=0);Ge.isSafari=!!(!Ge.isChrome&&Ge.userAgent&&Ge.userAgent.indexOf("Safari")>=0);Ge.isEdge=!!(Ge.userAgent&&Ge.userAgent.indexOf("Edg/")>=0);Ge.isAndroid=!!(Ge.userAgent&&Ge.userAgent.indexOf("Android")>=0);function nze(n){return parseFloat(n)>=20}});var kge=P(Mp=>{"use strict";Object.defineProperty(Mp,"__esModule",{value:!0});Mp.arch=Mp.platform=Mp.env=Mp.cwd=void 0;var wge=LK(),K_,OK=globalThis.vscode;if(typeof OK<"u"&&typeof OK.process<"u"){let n=OK.process;K_={get platform(){return n.platform},get arch(){return n.arch},get env(){return n.env},cwd(){return n.cwd()}}}else typeof process<"u"?K_={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:K_={get platform(){return wge.isWindows?"win32":wge.isMacintosh?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};Mp.cwd=K_.cwd;Mp.env=K_.env;Mp.platform=K_.platform;Mp.arch=K_.arch});var Pge=P(ct=>{"use strict";Object.defineProperty(ct,"__esModule",{value:!0});ct.delimiter=ct.sep=ct.toNamespacedPath=ct.parse=ct.format=ct.extname=ct.basename=ct.dirname=ct.relative=ct.resolve=ct.join=ct.isAbsolute=ct.normalize=ct.posix=ct.win32=void 0;var z1=kge(),rze=65,ize=97,oze=90,sze=122,Av=46,bs=47,yc=92,Rv=58,aze=63,i5=class extends Error{code;constructor(e,t,r){let o;typeof t=="string"&&t.indexOf("not ")===0?(o="must not be",t=t.replace(/^not /,"")):o="must be";let s=e.indexOf(".")!==-1?"property":"argument",a=`The "${e}" ${s} ${o} of type ${t}`;a+=`. Received type ${typeof r}`,super(a),this.code="ERR_INVALID_ARG_TYPE"}};function cze(n,e){if(n===null||typeof n!="object")throw new i5(e,"Object",n)}function Yi(n,e){if(typeof n!="string")throw new i5(e,"string",n)}var bc=z1.platform==="win32";function mn(n){return n===bs||n===yc}function MK(n){return n===bs}function Pv(n){return n>=rze&&n<=oze||n>=ize&&n<=sze}function o5(n,e,t,r){let o="",s=0,a=-1,c=0,l=0;for(let u=0;u<=n.length;++u){if(u<n.length)l=n.charCodeAt(u);else{if(r(l))break;l=bs}if(r(l)){if(!(a===u-1||c===1))if(c===2){if(o.length<2||s!==2||o.charCodeAt(o.length-1)!==Av||o.charCodeAt(o.length-2)!==Av){if(o.length>2){let d=o.lastIndexOf(t);d===-1?(o="",s=0):(o=o.slice(0,d),s=o.length-1-o.lastIndexOf(t)),a=u,c=0;continue}else if(o.length!==0){o="",s=0,a=u,c=0;continue}}e&&(o+=o.length>0?`${t}..`:"..",s=2)}else o.length>0?o+=`${t}${n.slice(a+1,u)}`:o=n.slice(a+1,u),s=u-a-1;a=u,c=0}else l===Av&&c!==-1?++c:c=-1}return o}function Rge(n,e){cze(e,"pathObject");let t=e.dir||e.root,r=e.base||`${e.name||""}${e.ext||""}`;return t?t===e.root?`${t}${r}`:`${t}${n}${r}`:r}ct.win32={resolve(...n){let e="",t="",r=!1;for(let o=n.length-1;o>=-1;o--){let s;if(o>=0){if(s=n[o],Yi(s,"path"),s.length===0)continue}else e.length===0?s=z1.cwd():(s=z1.env[`=${e}`]||z1.cwd(),(s===void 0||s.slice(0,2).toLowerCase()!==e.toLowerCase()&&s.charCodeAt(2)===yc)&&(s=`${e}\\`));let a=s.length,c=0,l="",u=!1,d=s.charCodeAt(0);if(a===1)mn(d)&&(c=1,u=!0);else if(mn(d))if(u=!0,mn(s.charCodeAt(1))){let p=2,f=p;for(;p<a&&!mn(s.charCodeAt(p));)p++;if(p<a&&p!==f){let m=s.slice(f,p);for(f=p;p<a&&mn(s.charCodeAt(p));)p++;if(p<a&&p!==f){for(f=p;p<a&&!mn(s.charCodeAt(p));)p++;(p===a||p!==f)&&(l=`\\\\${m}\\${s.slice(f,p)}`,c=p)}}}else c=1;else Pv(d)&&s.charCodeAt(1)===Rv&&(l=s.slice(0,2),c=2,a>2&&mn(s.charCodeAt(2))&&(u=!0,c=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(r){if(e.length>0)break}else if(t=`${s.slice(c)}\\${t}`,r=u,u&&e.length>0)break}return t=o5(t,!r,"\\",mn),r?`${e}\\${t}`:`${e}${t}`||"."},normalize(n){Yi(n,"path");let e=n.length;if(e===0)return".";let t=0,r,o=!1,s=n.charCodeAt(0);if(e===1)return MK(s)?"\\":n;if(mn(s))if(o=!0,mn(n.charCodeAt(1))){let c=2,l=c;for(;c<e&&!mn(n.charCodeAt(c));)c++;if(c<e&&c!==l){let u=n.slice(l,c);for(l=c;c<e&&mn(n.charCodeAt(c));)c++;if(c<e&&c!==l){for(l=c;c<e&&!mn(n.charCodeAt(c));)c++;if(c===e)return`\\\\${u}\\${n.slice(l)}\\`;c!==l&&(r=`\\\\${u}\\${n.slice(l,c)}`,t=c)}}}else t=1;else Pv(s)&&n.charCodeAt(1)===Rv&&(r=n.slice(0,2),t=2,e>2&&mn(n.charCodeAt(2))&&(o=!0,t=3));let a=t<e?o5(n.slice(t),!o,"\\",mn):"";return a.length===0&&!o&&(a="."),a.length>0&&mn(n.charCodeAt(e-1))&&(a+="\\"),r===void 0?o?`\\${a}`:a:o?`${r}\\${a}`:`${r}${a}`},isAbsolute(n){Yi(n,"path");let e=n.length;if(e===0)return!1;let t=n.charCodeAt(0);return mn(t)||e>2&&Pv(t)&&n.charCodeAt(1)===Rv&&mn(n.charCodeAt(2))},join(...n){if(n.length===0)return".";let e,t;for(let s=0;s<n.length;++s){let a=n[s];Yi(a,"path"),a.length>0&&(e===void 0?e=t=a:e+=`\\${a}`)}if(e===void 0)return".";let r=!0,o=0;if(typeof t=="string"&&mn(t.charCodeAt(0))){++o;let s=t.length;s>1&&mn(t.charCodeAt(1))&&(++o,s>2&&(mn(t.charCodeAt(2))?++o:r=!1))}if(r){for(;o<e.length&&mn(e.charCodeAt(o));)o++;o>=2&&(e=`\\${e.slice(o)}`)}return ct.win32.normalize(e)},relative(n,e){if(Yi(n,"from"),Yi(e,"to"),n===e)return"";let t=ct.win32.resolve(n),r=ct.win32.resolve(e);if(t===r||(n=t.toLowerCase(),e=r.toLowerCase(),n===e))return"";let o=0;for(;o<n.length&&n.charCodeAt(o)===yc;)o++;let s=n.length;for(;s-1>o&&n.charCodeAt(s-1)===yc;)s--;let a=s-o,c=0;for(;c<e.length&&e.charCodeAt(c)===yc;)c++;let l=e.length;for(;l-1>c&&e.charCodeAt(l-1)===yc;)l--;let u=l-c,d=a<u?a:u,p=-1,f=0;for(;f<d;f++){let h=n.charCodeAt(o+f);if(h!==e.charCodeAt(c+f))break;h===yc&&(p=f)}if(f!==d){if(p===-1)return r}else{if(u>d){if(e.charCodeAt(c+f)===yc)return r.slice(c+f+1);if(f===2)return r.slice(c+f)}a>d&&(n.charCodeAt(o+f)===yc?p=f:f===2&&(p=3)),p===-1&&(p=0)}let m="";for(f=o+p+1;f<=s;++f)(f===s||n.charCodeAt(f)===yc)&&(m+=m.length===0?"..":"\\..");return c+=p,m.length>0?`${m}${r.slice(c,l)}`:(r.charCodeAt(c)===yc&&++c,r.slice(c,l))},toNamespacedPath(n){if(typeof n!="string"||n.length===0)return n;let e=ct.win32.resolve(n);if(e.length<=2)return n;if(e.charCodeAt(0)===yc){if(e.charCodeAt(1)===yc){let t=e.charCodeAt(2);if(t!==aze&&t!==Av)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(Pv(e.charCodeAt(0))&&e.charCodeAt(1)===Rv&&e.charCodeAt(2)===yc)return`\\\\?\\${e}`;return n},dirname(n){Yi(n,"path");let e=n.length;if(e===0)return".";let t=-1,r=0,o=n.charCodeAt(0);if(e===1)return mn(o)?n:".";if(mn(o)){if(t=r=1,mn(n.charCodeAt(1))){let c=2,l=c;for(;c<e&&!mn(n.charCodeAt(c));)c++;if(c<e&&c!==l){for(l=c;c<e&&mn(n.charCodeAt(c));)c++;if(c<e&&c!==l){for(l=c;c<e&&!mn(n.charCodeAt(c));)c++;if(c===e)return n;c!==l&&(t=r=c+1)}}}}else Pv(o)&&n.charCodeAt(1)===Rv&&(t=e>2&&mn(n.charCodeAt(2))?3:2,r=t);let s=-1,a=!0;for(let c=e-1;c>=r;--c)if(mn(n.charCodeAt(c))){if(!a){s=c;break}}else a=!1;if(s===-1){if(t===-1)return".";s=t}return n.slice(0,s)},basename(n,e){e!==void 0&&Yi(e,"ext"),Yi(n,"path");let t=0,r=-1,o=!0,s;if(n.length>=2&&Pv(n.charCodeAt(0))&&n.charCodeAt(1)===Rv&&(t=2),e!==void 0&&e.length>0&&e.length<=n.length){if(e===n)return"";let a=e.length-1,c=-1;for(s=n.length-1;s>=t;--s){let l=n.charCodeAt(s);if(mn(l)){if(!o){t=s+1;break}}else c===-1&&(o=!1,c=s+1),a>=0&&(l===e.charCodeAt(a)?--a===-1&&(r=s):(a=-1,r=c))}return t===r?r=c:r===-1&&(r=n.length),n.slice(t,r)}for(s=n.length-1;s>=t;--s)if(mn(n.charCodeAt(s))){if(!o){t=s+1;break}}else r===-1&&(o=!1,r=s+1);return r===-1?"":n.slice(t,r)},extname(n){Yi(n,"path");let e=0,t=-1,r=0,o=-1,s=!0,a=0;n.length>=2&&n.charCodeAt(1)===Rv&&Pv(n.charCodeAt(0))&&(e=r=2);for(let c=n.length-1;c>=e;--c){let l=n.charCodeAt(c);if(mn(l)){if(!s){r=c+1;break}continue}o===-1&&(s=!1,o=c+1),l===Av?t===-1?t=c:a!==1&&(a=1):t!==-1&&(a=-1)}return t===-1||o===-1||a===0||a===1&&t===o-1&&t===r+1?"":n.slice(t,o)},format:Rge.bind(null,"\\"),parse(n){Yi(n,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return e;let t=n.length,r=0,o=n.charCodeAt(0);if(t===1)return mn(o)?(e.root=e.dir=n,e):(e.base=e.name=n,e);if(mn(o)){if(r=1,mn(n.charCodeAt(1))){let p=2,f=p;for(;p<t&&!mn(n.charCodeAt(p));)p++;if(p<t&&p!==f){for(f=p;p<t&&mn(n.charCodeAt(p));)p++;if(p<t&&p!==f){for(f=p;p<t&&!mn(n.charCodeAt(p));)p++;p===t?r=p:p!==f&&(r=p+1)}}}}else if(Pv(o)&&n.charCodeAt(1)===Rv){if(t<=2)return e.root=e.dir=n,e;if(r=2,mn(n.charCodeAt(2))){if(t===3)return e.root=e.dir=n,e;r=3}}r>0&&(e.root=n.slice(0,r));let s=-1,a=r,c=-1,l=!0,u=n.length-1,d=0;for(;u>=r;--u){if(o=n.charCodeAt(u),mn(o)){if(!l){a=u+1;break}continue}c===-1&&(l=!1,c=u+1),o===Av?s===-1?s=u:d!==1&&(d=1):s!==-1&&(d=-1)}return c!==-1&&(s===-1||d===0||d===1&&s===c-1&&s===a+1?e.base=e.name=n.slice(a,c):(e.name=n.slice(a,s),e.base=n.slice(a,c),e.ext=n.slice(s,c))),a>0&&a!==r?e.dir=n.slice(0,a-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null};var lze=(()=>{if(bc){let n=/\\/g;return()=>{let e=z1.cwd().replace(n,"/");return e.slice(e.indexOf("/"))}}return()=>z1.cwd()})();ct.posix={resolve(...n){let e="",t=!1;for(let r=n.length-1;r>=-1&&!t;r--){let o=r>=0?n[r]:lze();Yi(o,"path"),o.length!==0&&(e=`${o}/${e}`,t=o.charCodeAt(0)===bs)}return e=o5(e,!t,"/",MK),t?`/${e}`:e.length>0?e:"."},normalize(n){if(Yi(n,"path"),n.length===0)return".";let e=n.charCodeAt(0)===bs,t=n.charCodeAt(n.length-1)===bs;return n=o5(n,!e,"/",MK),n.length===0?e?"/":t?"./":".":(t&&(n+="/"),e?`/${n}`:n)},isAbsolute(n){return Yi(n,"path"),n.length>0&&n.charCodeAt(0)===bs},join(...n){if(n.length===0)return".";let e;for(let t=0;t<n.length;++t){let r=n[t];Yi(r,"path"),r.length>0&&(e===void 0?e=r:e+=`/${r}`)}return e===void 0?".":ct.posix.normalize(e)},relative(n,e){if(Yi(n,"from"),Yi(e,"to"),n===e||(n=ct.posix.resolve(n),e=ct.posix.resolve(e),n===e))return"";let t=1,r=n.length,o=r-t,s=1,a=e.length-s,c=o<a?o:a,l=-1,u=0;for(;u<c;u++){let p=n.charCodeAt(t+u);if(p!==e.charCodeAt(s+u))break;p===bs&&(l=u)}if(u===c)if(a>c){if(e.charCodeAt(s+u)===bs)return e.slice(s+u+1);if(u===0)return e.slice(s+u)}else o>c&&(n.charCodeAt(t+u)===bs?l=u:u===0&&(l=0));let d="";for(u=t+l+1;u<=r;++u)(u===r||n.charCodeAt(u)===bs)&&(d+=d.length===0?"..":"/..");return`${d}${e.slice(s+l)}`},toNamespacedPath(n){return n},dirname(n){if(Yi(n,"path"),n.length===0)return".";let e=n.charCodeAt(0)===bs,t=-1,r=!0;for(let o=n.length-1;o>=1;--o)if(n.charCodeAt(o)===bs){if(!r){t=o;break}}else r=!1;return t===-1?e?"/":".":e&&t===1?"//":n.slice(0,t)},basename(n,e){e!==void 0&&Yi(e,"ext"),Yi(n,"path");let t=0,r=-1,o=!0,s;if(e!==void 0&&e.length>0&&e.length<=n.length){if(e===n)return"";let a=e.length-1,c=-1;for(s=n.length-1;s>=0;--s){let l=n.charCodeAt(s);if(l===bs){if(!o){t=s+1;break}}else c===-1&&(o=!1,c=s+1),a>=0&&(l===e.charCodeAt(a)?--a===-1&&(r=s):(a=-1,r=c))}return t===r?r=c:r===-1&&(r=n.length),n.slice(t,r)}for(s=n.length-1;s>=0;--s)if(n.charCodeAt(s)===bs){if(!o){t=s+1;break}}else r===-1&&(o=!1,r=s+1);return r===-1?"":n.slice(t,r)},extname(n){Yi(n,"path");let e=-1,t=0,r=-1,o=!0,s=0;for(let a=n.length-1;a>=0;--a){let c=n.charCodeAt(a);if(c===bs){if(!o){t=a+1;break}continue}r===-1&&(o=!1,r=a+1),c===Av?e===-1?e=a:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||r===-1||s===0||s===1&&e===r-1&&e===t+1?"":n.slice(e,r)},format:Rge.bind(null,"/"),parse(n){Yi(n,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return e;let t=n.charCodeAt(0)===bs,r;t?(e.root="/",r=1):r=0;let o=-1,s=0,a=-1,c=!0,l=n.length-1,u=0;for(;l>=r;--l){let d=n.charCodeAt(l);if(d===bs){if(!c){s=l+1;break}continue}a===-1&&(c=!1,a=l+1),d===Av?o===-1?o=l:u!==1&&(u=1):o!==-1&&(u=-1)}if(a!==-1){let d=s===0&&t?1:s;o===-1||u===0||u===1&&o===a-1&&o===s+1?e.base=e.name=n.slice(d,a):(e.name=n.slice(d,o),e.base=n.slice(d,a),e.ext=n.slice(o,a))}return s>0?e.dir=n.slice(0,s-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};ct.posix.win32=ct.win32.win32=ct.win32;ct.posix.posix=ct.win32.posix=ct.posix;ct.normalize=bc?ct.win32.normalize:ct.posix.normalize;ct.isAbsolute=bc?ct.win32.isAbsolute:ct.posix.isAbsolute;ct.join=bc?ct.win32.join:ct.posix.join;ct.resolve=bc?ct.win32.resolve:ct.posix.resolve;ct.relative=bc?ct.win32.relative:ct.posix.relative;ct.dirname=bc?ct.win32.dirname:ct.posix.dirname;ct.basename=bc?ct.win32.basename:ct.posix.basename;ct.extname=bc?ct.win32.extname:ct.posix.extname;ct.format=bc?ct.win32.format:ct.posix.format;ct.parse=bc?ct.win32.parse:ct.posix.parse;ct.toNamespacedPath=bc?ct.win32.toNamespacedPath:ct.posix.toNamespacedPath;ct.sep=bc?ct.win32.sep:ct.posix.sep;ct.delimiter=bc?ct.win32.delimiter:ct.posix.delimiter});var Fge=P($1=>{"use strict";Object.defineProperty($1,"__esModule",{value:!0});$1.URI=void 0;$1.isUriComponents=vze;$1.uriToFsPath=l5;var Age=Pge(),a5=LK(),uze=/^\w[\w\d+.-]*$/,dze=/^\//,pze=/^\/\//;function fze(n,e){if(!n.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${n.authority}", path: "${n.path}", query: "${n.query}", fragment: "${n.fragment}"}`);if(n.scheme&&!uze.test(n.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(n.path){if(n.authority){if(!dze.test(n.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(pze.test(n.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function mze(n,e){return!n&&!e?"file":n}function hze(n,e){switch(n){case"https":case"http":case"file":e?e[0]!==xd&&(e=xd+e):e=xd;break}return e}var Mr="",xd="/",gze=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,c5=class n{static isUri(e){return e instanceof n?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}scheme;authority;path;query;fragment;constructor(e,t,r,o,s,a=!1){typeof e=="object"?(this.scheme=e.scheme||Mr,this.authority=e.authority||Mr,this.path=e.path||Mr,this.query=e.query||Mr,this.fragment=e.fragment||Mr):(this.scheme=mze(e,a),this.authority=t||Mr,this.path=hze(this.scheme,r||Mr),this.query=o||Mr,this.fragment=s||Mr,fze(this,a))}get fsPath(){return l5(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:r,path:o,query:s,fragment:a}=e;return t===void 0?t=this.scheme:t===null&&(t=Mr),r===void 0?r=this.authority:r===null&&(r=Mr),o===void 0?o=this.path:o===null&&(o=Mr),s===void 0?s=this.query:s===null&&(s=Mr),a===void 0?a=this.fragment:a===null&&(a=Mr),t===this.scheme&&r===this.authority&&o===this.path&&s===this.query&&a===this.fragment?this:new Dv(t,r,o,s,a)}static parse(e,t=!1){let r=gze.exec(e);return r?new Dv(r[2]||Mr,s5(r[4]||Mr),s5(r[5]||Mr),s5(r[7]||Mr),s5(r[9]||Mr),t):new Dv(Mr,Mr,Mr,Mr,Mr)}static file(e){let t=Mr;if(a5.isWindows&&(e=e.replace(/\\/g,xd)),e[0]===xd&&e[1]===xd){let r=e.indexOf(xd,2);r===-1?(t=e.substring(2),e=xd):(t=e.substring(2,r),e=e.substring(r)||xd)}return new Dv("file",t,e,Mr,Mr)}static from(e,t){return new Dv(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let r;return a5.isWindows&&e.scheme==="file"?r=n.file(Age.win32.join(l5(e,!0),...t)).path:r=Age.posix.join(e.path,...t),e.with({path:r})}toString(e=!1){return FK(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof n)return e;{let t=new Dv(e);return t._formatted=e.external??null,t._fsPath=e._sep===Lge?e.fsPath??null:null,t}}else return e}};$1.URI=c5;function vze(n){return!n||typeof n!="object"?!1:typeof n.scheme=="string"&&(typeof n.authority=="string"||typeof n.authority>"u")&&(typeof n.path=="string"||typeof n.path>"u")&&(typeof n.query=="string"||typeof n.query>"u")&&(typeof n.fragment=="string"||typeof n.fragment>"u")}var Lge=a5.isWindows?1:void 0,Dv=class extends c5{_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=l5(this,!1)),this._fsPath}toString(e=!1){return e?FK(this,!0):(this._formatted||(this._formatted=FK(this,!1)),this._formatted)}toJSON(){let e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=Lge),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}},Oge={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function Dge(n,e,t){let r,o=-1;for(let s=0;s<n.length;s++){let a=n.charCodeAt(s);if(a>=97&&a<=122||a>=65&&a<=90||a>=48&&a<=57||a===45||a===46||a===95||a===126||e&&a===47||t&&a===91||t&&a===93||t&&a===58)o!==-1&&(r+=encodeURIComponent(n.substring(o,s)),o=-1),r!==void 0&&(r+=n.charAt(s));else{r===void 0&&(r=n.substr(0,s));let c=Oge[a];c!==void 0?(o!==-1&&(r+=encodeURIComponent(n.substring(o,s)),o=-1),r+=c):o===-1&&(o=s)}}return o!==-1&&(r+=encodeURIComponent(n.substring(o))),r!==void 0?r:n}function yze(n){let e;for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r===35||r===63?(e===void 0&&(e=n.substr(0,t)),e+=Oge[r]):e!==void 0&&(e+=n[t])}return e!==void 0?e:n}function l5(n,e){let t;return n.authority&&n.path.length>1&&n.scheme==="file"?t=`//${n.authority}${n.path}`:n.path.charCodeAt(0)===47&&(n.path.charCodeAt(1)>=65&&n.path.charCodeAt(1)<=90||n.path.charCodeAt(1)>=97&&n.path.charCodeAt(1)<=122)&&n.path.charCodeAt(2)===58?e?t=n.path.substr(1):t=n.path[1].toLowerCase()+n.path.substr(2):t=n.path,a5.isWindows&&(t=t.replace(/\//g,"\\")),t}function FK(n,e){let t=e?yze:Dge,r="",{scheme:o,authority:s,path:a,query:c,fragment:l}=n;if(o&&(r+=o,r+=":"),(s||o==="file")&&(r+=xd,r+=xd),s){let u=s.indexOf("@");if(u!==-1){let d=s.substr(0,u);s=s.substr(u+1),u=d.lastIndexOf(":"),u===-1?r+=t(d,!1,!1):(r+=t(d.substr(0,u),!1,!1),r+=":",r+=t(d.substr(u+1),!1,!0)),r+="@"}s=s.toLowerCase(),u=s.lastIndexOf(":"),u===-1?r+=t(s,!1,!0):(r+=t(s.substr(0,u),!1,!0),r+=s.substr(u))}if(a){if(a.length>=3&&a.charCodeAt(0)===47&&a.charCodeAt(2)===58){let u=a.charCodeAt(1);u>=65&&u<=90&&(a=`/${String.fromCharCode(u+32)}:${a.substr(3)}`)}else if(a.length>=2&&a.charCodeAt(1)===58){let u=a.charCodeAt(0);u>=65&&u<=90&&(a=`${String.fromCharCode(u+32)}:${a.substr(2)}`)}r+=t(a,!0,!1)}return c&&(r+="?",r+=t(c,!1,!1)),l&&(r+="#",r+=e?l:Dge(l,!1,!1)),r}function Mge(n){try{return decodeURIComponent(n)}catch{return n.length>3?n.substr(0,3)+Mge(n.substr(3)):n}}var Nge=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function s5(n){return n.match(Nge)?n.replace(Nge,e=>Mge(e)):n}});var qK=P(Nv=>{"use strict";Object.defineProperty(Nv,"__esModule",{value:!0});Nv.PromptReference=Nv.ChatResponseReferencePartStatusKind=Nv.PromptMetadata=void 0;var X2=Fge(),UK=class{_marker;toString(){return Object.getPrototypeOf(this).constructor.name}};Nv.PromptMetadata=UK;var Uge;(function(n){n[n.Complete=1]="Complete",n[n.Partial=2]="Partial",n[n.Omitted=3]="Omitted"})(Uge||(Nv.ChatResponseReferencePartStatusKind=Uge={}));var BK=class n{anchor;iconPath;options;static fromJSON(e){let t=r=>"scheme"in r?X2.URI.from(r):{uri:X2.URI.from(r.uri),range:r.range};return new n("variableName"in e.anchor?{variableName:e.anchor.variableName,value:e.anchor.value&&t(e.anchor.value)}:t(e.anchor),e.iconPath&&("scheme"in e.iconPath?X2.URI.from(e.iconPath):"light"in e.iconPath?{light:X2.URI.from(e.iconPath.light),dark:X2.URI.from(e.iconPath.dark)}:e.iconPath),e.options)}constructor(e,t,r){this.anchor=e,this.iconPath=t,this.options=r}toJSON(){return{anchor:this.anchor,iconPath:this.iconPath,options:this.options}}};Nv.PromptReference=BK});var QK=P(W1=>{"use strict";Object.defineProperty(W1,"__esModule",{value:!0});W1.PromptRenderer=W1.MetadataMap=void 0;var jK=_K(),Sd=PK(),YK=qK(),Bge;(function(n){n.empty={get:()=>{},getAll:()=>[]}})(Bge||(W1.MetadataMap=Bge={}));var HK=class{_endpoint;_ctor;_props;_tokenizer;_usedContext=[];_ignoredFiles=[];_growables=[];_root=new u5(null,0);tracer=void 0;constructor(e,t,r,o){this._endpoint=e,this._ctor=t,this._props=r,this._tokenizer=o}getIgnoredFiles(){return Array.from(new Set(this._ignoredFiles))}getUsedContext(){return this._usedContext}createElement(e){return new e.ctor(e.props)}async _processPromptPieces(e,t,r,o){let s=new Map;for(let[l,u]of t.entries()){if(Array.isArray(u.children)&&(u.props=u.props??{},u.props.children=u.children),!u.ctor)throw new Error("Invalid ChatMessage child! Child must be a TSX component that extends PromptElement.");let d=this.createElement(u);u.node.setObj(d);let p=u.props.flexGrow??1/0,f=s.get(p);f||(f=[],s.set(p,f)),f.push({element:u,promptElementInstance:d})}if(s.size===0)return;let a=[...s.entries()].sort(([l],[u])=>u-l).map(([l,u])=>u),c=l=>{let u=0;for(let d=l+1;d<a.length;d++)for(let{element:p}of a[d]){if(!p.props.flexReserve)continue;let f=typeof p.props.flexReserve=="string"?Math.floor(e.remainingTokenBudget/Number(p.props.flexReserve.slice(1))):p.props.flexReserve;u+=f}return e.consume(u),u};for(let[l,u]of a.entries()){let d=c(l),p=0;for(let{element:h}of u)p+=(h.props.flex||h.props.flexBasis)??1;let f=u.map(h=>{let g=(h.element.props.flexBasis??1)/p;return{tokenBudget:Math.floor(e.remainingTokenBudget*g),endpoint:e.endpoint,countTokens:(y,b)=>this._tokenizer.tokenLength(y,b)}});e.consume(-d),this.tracer?.addRenderEpoch?.({inNode:u[0].element.node.parent?.id,flexValue:u[0].element.props.flexGrow??0,tokenBudget:e.remainingTokenBudget,reservedTokens:d,elements:u.map((h,g)=>({id:h.element.node.id,tokenBudget:f[g].tokenBudget}))}),await Promise.all(u.map(async({element:h,promptElementInstance:g},y)=>{let b=await g.prepare?.(f[y],r,o);h.node.setState(b)}));let m=await Promise.all(u.map(async({element:h,promptElementInstance:g},y)=>{let b=f[y];return await g.render(h.node.getState(),b,r,o)}));for(let[h,{element:g,promptElementInstance:y}]of u.entries()){let b=f[h],_=m[h];if(!_)continue;let x=await this._processPromptRenderPiece(new Y_(b.tokenBudget,this._endpoint),g,y,_,r,o);y instanceof Sd.Expandable&&this._growables.push({initialConsume:x,elem:g.node}),e.consume(x)}}}async _processPromptRenderPiece(e,t,r,o,s,a){let c=qge(o),l=new Y_(e.tokenBudget,this._endpoint),{tokensConsumed:u}=await bze(this._tokenizer,t,r,c);return l.consume(u),await this._handlePromptChildren(t,c,l,s,a),l.consumed}async renderElementJSON(e){return await this._processPromptPieces(new Y_(this._endpoint.modelMaxPromptTokens,this._endpoint),[{node:this._root,ctor:this._ctor,props:this._props,children:[]}],void 0,e),{node:this._root.toJSON()}}async render(e,t){await this._processPromptPieces(new Y_(this._endpoint.modelMaxPromptTokens,this._endpoint),[{node:this._root,ctor:this._ctor,props:this._props,children:[]}],e,t);let{container:r,allMetadata:o,removed:s}=await this._getFinalElementTree(this._endpoint.modelMaxPromptTokens,t);this.tracer?.didMaterializeTree?.({budget:this._endpoint.modelMaxPromptTokens,renderedTree:{container:r,removed:s,budget:this._endpoint.modelMaxPromptTokens},tokenizer:this._tokenizer,renderTree:f=>this._getFinalElementTree(f,void 0).then(m=>({...m,budget:f}))});let a=[...r.toChatMessages()],c=await r.tokenCount(this._tokenizer),l=[...r.allMetadata()],u=new Set,d=l.map(f=>{if(!(f instanceof Fp))return;let m=f.reference,h="variableName"in m.anchor;if(h&&!u.has(m.anchor.variableName))return u.add(m.anchor.variableName),m;if(!h)return m}).filter(WK),p=o.map(f=>{if(!(f instanceof Fp)||l.includes(f))return;let m=f.reference,h="variableName"in m.anchor;if(h&&!u.has(m.anchor.variableName))return u.add(m.anchor.variableName),m;if(!h)return m}).filter(WK);return{metadata:{get:f=>l.find(m=>m instanceof f),getAll:f=>l.filter(m=>m instanceof f)},messages:a,hasIgnoredFiles:this._ignoredFiles.length>0,tokenCount:c,references:d,omittedReferences:p}}async _getFinalElementTree(e,t){let r=this._root.materialize(),o=await r.tokenCount(this._tokenizer);if(o<e&&!await this._grow(r,o,e,t))return{container:r,allMetadata:[...r.allMetadata()],removed:0};let s=[...r.allMetadata()],a=0;for(;await r.upperBoundTokenCount(this._tokenizer)>e&&await r.tokenCount(this._tokenizer)>e;)r.removeLowestPriorityChild(),a++;return{container:r,allMetadata:s,removed:a}}async _grow(e,t,r,o){if(!this._growables.length)return!1;for(let s of this._growables){let a=s.elem.getObj();if(!(a instanceof Sd.Expandable))throw new Error("unreachable: expected growable");let c=new u5(null,0,s.elem.id),l=new Y_(r-t+s.initialConsume,this._endpoint),u=await this._processPromptRenderPiece(l,{node:c,ctor:this._ctor,props:{},children:[]},a,await a.render(void 0,{tokenBudget:l.tokenBudget,endpoint:this._endpoint,countTokens:(f,m)=>this._tokenizer.tokenLength(f,m)}),void 0,o),d=c.materialize();if(!e.replaceNode(s.elem.id,d))throw new Error("unreachable: could not find old element to replace");if(t-=s.initialConsume,t+=u,t>=r)break}return!0}_handlePromptChildren(e,t,r,o,s){if(e.ctor===Sd.TextChunk){this._handleExtrinsicTextChunkChildren(e.node,e.node,e.props,t);return}let a=[];for(let c of t){if(c.kind==="literal"){e.node.appendStringChild(c.value,e.props.priority??Number.MAX_SAFE_INTEGER);continue}if(c.kind==="intrinsic"){this._handleIntrinsic(e.node,c.name,{priority:e.props.priority??Number.MAX_SAFE_INTEGER,...c.props},VK(c.children));continue}let l=e.node.createChild();a.push({node:l,ctor:c.ctor,props:{priority:e.props.priority,...c.props},children:c.children})}return this._processPromptPieces(r,a,o,s)}_handleIntrinsic(e,t,r,o,s){switch(t){case"meta":return this._handleIntrinsicMeta(e,r,o);case"br":return this._handleIntrinsicLineBreak(e,r,o,r.priority,s);case"usedContext":return this._handleIntrinsicUsedContext(e,r,o);case"references":return this._handleIntrinsicReferences(e,r,o);case"ignoredFiles":return this._handleIntrinsicIgnoredFiles(e,r,o);case"elementJSON":return this._handleIntrinsicElementJSON(e,r.data)}throw new Error(`Unknown intrinsic element ${t}!`)}_handleIntrinsicMeta(e,t,r){if(r.length>0)throw new Error("<meta /> must not have children!");t.local?e.addMetadata(t.value):this._root.addMetadata(t.value)}_handleIntrinsicLineBreak(e,t,r,o,s){if(r.length>0)throw new Error("<br /> must not have children!");e.appendLineBreak(o??Number.MAX_SAFE_INTEGER,s)}_handleIntrinsicElementJSON(e,t){let r=e.appendPieceJSON(t.node);if(this.tracer?.includeInEpoch)for(let o of r.elements())this.tracer.includeInEpoch({id:o.id,tokenBudget:0})}_handleIntrinsicUsedContext(e,t,r){if(r.length>0)throw new Error("<usedContext /> must not have children!");this._usedContext.push(...t.value)}_handleIntrinsicReferences(e,t,r){if(r.length>0)throw new Error("<reference /> must not have children!");for(let o of t.value)e.addMetadata(new Fp(o))}_handleIntrinsicIgnoredFiles(e,t,r){if(r.length>0)throw new Error("<ignoredFiles /> must not have children!");this._ignoredFiles.push(...t.value)}_handleExtrinsicTextChunkChildren(e,t,r,o){let s=[],a=[];for(let c of o){if(c.kind==="extrinsic")throw new Error("TextChunk cannot have extrinsic children!");if(c.kind==="literal"&&s.push(c.value),c.kind==="intrinsic")if(c.name==="br")s.push(`
`);else if(c.name==="references")for(let l of c.props.value)a.push(new Fp(l));else this._handleIntrinsic(e,c.name,c.props,VK(c.children),t.childIndex)}e.appendStringChild(s.join(""),r?.priority??Number.MAX_SAFE_INTEGER,a,t.childIndex,!0)}};W1.PromptRenderer=HK;async function bze(n,e,t,r){let o=0;(0,Sd.isChatMessagePromptElement)(t)&&(o+=await n.countMessageTokens({role:e.props.role,content:"",...e.props.name?{name:e.props.name}:void 0}));for(let s of r)s.kind==="literal"&&(o+=await n.tokenLength(s.value));return{tokensConsumed:o}}function qge(n){return typeof n>"u"||typeof n=="boolean"?[]:typeof n=="string"||typeof n=="number"?[new $K(String(n))]:_ze(n)?[...VK(n.children)]:typeof n.ctor=="string"?[new GK(n.ctor,n.props,n.children)]:[new zK(n.ctor,n.props,n.children)]}function VK(n){return(n??[]).reduce((e,t)=>(e.push(...qge(t)),e),[])}var GK=class{name;props;children;kind="intrinsic";constructor(e,t,r){this.name=e,this.props=t,this.children=r}},zK=class{ctor;props;children;kind="extrinsic";constructor(e,t,r){this.ctor=e,this.props=t,this.children=r}},$K=class{value;priority;kind="literal";constructor(e,t){this.value=e,this.priority=t}},Y_=class{tokenBudget;endpoint;_consumed=0;constructor(e,t){this.tokenBudget=e,this.endpoint=t}get consumed(){return this._consumed>this.tokenBudget?this.tokenBudget:this._consumed}get remainingTokenBudget(){return Math.max(0,this.tokenBudget-this._consumed)}consume(e){this._consumed+=e}},u5=class n{parent;childIndex;id;static _nextId=0;static fromJSON(e,t){let r=new n(null,e);switch(r._metadata=t.references?.map(o=>new Fp(YK.PromptReference.fromJSON(o)))??[],r._children=t.children.map((o,s)=>{switch(o.type){case 1:return n.fromJSON(s,o);case 2:return J2.fromJSON(r,s,o);default:}}).filter(WK),t.ctor){case 1:r._obj=new Sd.BaseChatMessage(t.props);break;case 2:break;default:t.ctor}return r}kind=1;_obj=null;_state=void 0;_children=[];_metadata=[];constructor(e=null,t,r=n._nextId++){this.parent=e,this.childIndex=t,this.id=r}setObj(e){this._obj=e}getObj(){return this._obj}setState(e){this._state=e}getState(){return this._state}createChild(){let e=new n(this,this._children.length);return this._children.push(e),e}appendPieceJSON(e){let t=n.fromJSON(this._children.length,e);return this._children.push(t),t}appendStringChild(e,t,r,o=this._children.length,s=!1){this._children.push(new J2(this,o,e,t,r,s))}appendLineBreak(e,t=this._children.length){this._children.push(new J2(this,t,`
`,e))}toJSON(){let e={type:1,ctor:2,children:this._children.slice().sort((t,r)=>t.childIndex-r.childIndex).map(t=>t.toJSON()),priority:this._obj?.props.priority,references:this._metadata.filter(t=>t instanceof Fp).map(t=>t.reference.toJSON())};return this._obj instanceof Sd.BaseChatMessage&&(e.ctor=1,e.props={role:this._obj.props.role,name:this._obj.props.name,priority:this._obj.props.priority,toolCalls:this._obj.props.toolCalls,toolCallId:this._obj.props.toolCallId}),e}materialize(){if(this._children.sort((e,t)=>e.childIndex-t.childIndex),this._obj instanceof Sd.BaseChatMessage){if(!this._obj.props.role)throw new Error("Invalid ChatMessage!");return new jK.MaterializedChatMessage(this.id,this._obj.props.role,this._obj.props.name,this._obj instanceof Sd.AssistantMessage?this._obj.props.toolCalls:void 0,this._obj instanceof Sd.ToolMessage?this._obj.props.toolCallId:void 0,this._obj.props.priority??Number.MAX_SAFE_INTEGER,this._metadata,this._children.map(t=>t.materialize()))}else{let e=0;return this._obj instanceof Sd.LegacyPrioritization&&(e|=1),this._obj instanceof Sd.Chunk&&(e|=2),this._obj?.props.passPriority&&(e|=4),new jK.MaterializedContainer(this.id,this._obj?.constructor.name,this._obj?.props.priority??(this._obj?.props.passPriority?0:Number.MAX_SAFE_INTEGER),this._children.map(t=>t.materialize()),this._metadata,e)}}addMetadata(e){this._metadata.push(e)}*elements(){yield this;for(let e of this._children)e instanceof n&&(yield*e.elements())}},J2=class n{parent;childIndex;text;priority;metadata;lineBreakBefore;static fromJSON(e,t,r){return new n(e,t,r.text,r.priority,r.references?.map(o=>new Fp(YK.PromptReference.fromJSON(o))),r.lineBreakBefore)}kind=2;constructor(e,t,r,o,s,a=!1){this.parent=e,this.childIndex=t,this.text=r,this.priority=o,this.metadata=s,this.lineBreakBefore=a}collectLeafs(e){e.push(this)}materialize(){let e=this.lineBreakBefore?1:this.childIndex===0?2:0;return new jK.MaterializedChatMessageTextChunk(this.text,this.priority??Number.MAX_SAFE_INTEGER,this.metadata||[],e)}toJSON(){return{type:2,priority:this.priority,text:this.text,references:this.metadata?.filter(e=>e instanceof Fp).map(e=>e.reference.toJSON()),lineBreakBefore:this.lineBreakBefore}}};function _ze(n){return(typeof n.ctor=="function"&&n.ctor.isFragment)??!1}function WK(n){return n!==void 0}var KK=class extends YK.PromptMetadata{},Fp=class extends KK{reference;constructor(e){super(),this.reference=e}}});var jge=P(d5=>{"use strict";Object.defineProperty(d5,"__esModule",{value:!0});d5.AnyTokenizer=void 0;var Z2=V1(),XK=class{countTokens;constructor(e){this.countTokens=e}async tokenLength(e,t){return this.countTokens(e,t)}async countMessageTokens(e){return this.countTokens({role:this.toChatRole(e.role),content:e.content,content2:[e.content],name:"name"in e?e.name:void 0})}toChatRole(e){switch(e){case Z2.ChatRole.User:return 1;case Z2.ChatRole.Assistant:return 2;case Z2.ChatRole.System:return 1;case Z2.ChatRole.Function:return 1;case Z2.ChatRole.Tool:return 1}}};d5.AnyTokenizer=XK});var Hge=P(K1=>{"use strict";Object.defineProperty(K1,"__esModule",{value:!0});K1.tracerCss=K1.tracerSrc=void 0;K1.tracerSrc='"use strict";(()=>{var $,m,se,ze,w,re,le,q,X,G,K,Ae,D={},ce=[],Re=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,J=Array.isArray;function E(t,e){for(var n in e)t[n]=e[n];return t}function ue(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function l(t,e,n){var o,r,_,c={};for(_ in e)_=="key"?o=e[_]:_=="ref"?r=e[_]:c[_]=e[_];if(arguments.length>2&&(c.children=arguments.length>3?$.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(_ in t.defaultProps)c[_]===void 0&&(c[_]=t.defaultProps[_]);return R(t,c,o,r,null)}function R(t,e,n,o,r){var _={type:t,props:e,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:r??++se,__i:-1,__u:0};return r==null&&m.vnode!=null&&m.vnode(_),_}function I(t){return t.children}function B(t,e){this.props=t,this.context=e}function N(t,e){if(e==null)return t.__?N(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?N(t):null}function de(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return de(t)}}function ie(t){(!t.__d&&(t.__d=!0)&&w.push(t)&&!O.__r++||re!==m.debounceRendering)&&((re=m.debounceRendering)||le)(O)}function O(){var t,e,n,o,r,_,c,a;for(w.sort(q);t=w.shift();)t.__d&&(e=w.length,o=void 0,_=(r=(n=t).__v).__e,c=[],a=[],n.__P&&((o=E({},r)).__v=r.__v+1,m.vnode&&m.vnode(o),Q(n.__P,o,r,n.__n,n.__P.namespaceURI,32&r.__u?[_]:null,c,_??N(r),!!(32&r.__u),a),o.__v=r.__v,o.__.__k[o.__i]=o,me(c,o,a),o.__e!=_&&de(o)),w.length>e&&w.sort(q));O.__r=0}function pe(t,e,n,o,r,_,c,a,u,s,p){var i,f,d,b,C,x=o&&o.__k||ce,h=e.length;for(n.__d=u,Be(n,e,x),u=n.__d,i=0;i<h;i++)(d=n.__k[i])!=null&&(f=d.__i===-1?D:x[d.__i]||D,d.__i=i,Q(t,d,f,r,_,c,a,u,s,p),b=d.__e,d.ref&&f.ref!=d.ref&&(f.ref&&Y(f.ref,null,d),p.push(d.ref,d.__c||b,d)),C==null&&b!=null&&(C=b),65536&d.__u||f.__k===d.__k?u=fe(d,u,t):typeof d.type=="function"&&d.__d!==void 0?u=d.__d:b&&(u=b.nextSibling),d.__d=void 0,d.__u&=-196609);n.__d=u,n.__e=C}function Be(t,e,n){var o,r,_,c,a,u=e.length,s=n.length,p=s,i=0;for(t.__k=[],o=0;o<u;o++)(r=e[o])!=null&&typeof r!="boolean"&&typeof r!="function"?(c=o+i,(r=t.__k[o]=typeof r=="string"||typeof r=="number"||typeof r=="bigint"||r.constructor==String?R(null,r,null,null,null):J(r)?R(I,{children:r},null,null,null):r.constructor===void 0&&r.__b>0?R(r.type,r.props,r.key,r.ref?r.ref:null,r.__v):r).__=t,r.__b=t.__b+1,_=null,(a=r.__i=Oe(r,n,c,p))!==-1&&(p--,(_=n[a])&&(_.__u|=131072)),_==null||_.__v===null?(a==-1&&i--,typeof r.type!="function"&&(r.__u|=65536)):a!==c&&(a==c-1?i--:a==c+1?i++:(a>c?i--:i++,r.__u|=65536))):r=t.__k[o]=null;if(p)for(o=0;o<s;o++)(_=n[o])!=null&&!(131072&_.__u)&&(_.__e==t.__d&&(t.__d=N(_)),he(_,_))}function fe(t,e,n){var o,r;if(typeof t.type=="function"){for(o=t.__k,r=0;o&&r<o.length;r++)o[r]&&(o[r].__=t,e=fe(o[r],e,n));return e}t.__e!=e&&(e&&t.type&&!n.contains(e)&&(e=N(t)),n.insertBefore(t.__e,e||null),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType===8);return e}function Oe(t,e,n,o){var r=t.key,_=t.type,c=n-1,a=n+1,u=e[n];if(u===null||u&&r==u.key&&_===u.type&&!(131072&u.__u))return n;if(o>(u!=null&&!(131072&u.__u)?1:0))for(;c>=0||a<e.length;){if(c>=0){if((u=e[c])&&!(131072&u.__u)&&r==u.key&&_===u.type)return c;c--}if(a<e.length){if((u=e[a])&&!(131072&u.__u)&&r==u.key&&_===u.type)return a;a++}}return-1}function _e(t,e,n){e[0]==="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||Re.test(e)?n:n+"px"}function A(t,e,n,o,r){var _;e:if(e==="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof o=="string"&&(t.style.cssText=o=""),o)for(e in o)n&&e in n||_e(t.style,e,"");if(n)for(e in n)o&&n[e]===o[e]||_e(t.style,e,n[e])}else if(e[0]==="o"&&e[1]==="n")_=e!==(e=e.replace(/(PointerCapture)$|Capture$/i,"$1")),e=e.toLowerCase()in t||e==="onFocusOut"||e==="onFocusIn"?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+_]=n,n?o?n.u=o.u:(n.u=X,t.addEventListener(e,_?K:G,_)):t.removeEventListener(e,_?K:G,_);else{if(r=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!=="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function ae(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=X++;else if(e.t<n.u)return;return n(m.event?m.event(e):e)}}}function Q(t,e,n,o,r,_,c,a,u,s){var p,i,f,d,b,C,x,h,v,H,M,P,F,oe,U,j,k=e.type;if(e.constructor!==void 0)return null;128&n.__u&&(u=!!(32&n.__u),_=[a=e.__e=n.__e]),(p=m.__b)&&p(e);e:if(typeof k=="function")try{if(h=e.props,v="prototype"in k&&k.prototype.render,H=(p=k.contextType)&&o[p.__c],M=p?H?H.props.value:p.__:o,n.__c?x=(i=e.__c=n.__c).__=i.__E:(v?e.__c=i=new k(h,M):(e.__c=i=new B(h,M),i.constructor=k,i.render=We),H&&H.sub(i),i.props=h,i.state||(i.state={}),i.context=M,i.__n=o,f=i.__d=!0,i.__h=[],i._sb=[]),v&&i.__s==null&&(i.__s=i.state),v&&k.getDerivedStateFromProps!=null&&(i.__s==i.state&&(i.__s=E({},i.__s)),E(i.__s,k.getDerivedStateFromProps(h,i.__s))),d=i.props,b=i.state,i.__v=e,f)v&&k.getDerivedStateFromProps==null&&i.componentWillMount!=null&&i.componentWillMount(),v&&i.componentDidMount!=null&&i.__h.push(i.componentDidMount);else{if(v&&k.getDerivedStateFromProps==null&&h!==d&&i.componentWillReceiveProps!=null&&i.componentWillReceiveProps(h,M),!i.__e&&(i.shouldComponentUpdate!=null&&i.shouldComponentUpdate(h,i.__s,M)===!1||e.__v===n.__v)){for(e.__v!==n.__v&&(i.props=h,i.state=i.__s,i.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(z){z&&(z.__=e)}),P=0;P<i._sb.length;P++)i.__h.push(i._sb[P]);i._sb=[],i.__h.length&&c.push(i);break e}i.componentWillUpdate!=null&&i.componentWillUpdate(h,i.__s,M),v&&i.componentDidUpdate!=null&&i.__h.push(function(){i.componentDidUpdate(d,b,C)})}if(i.context=M,i.props=h,i.__P=t,i.__e=!1,F=m.__r,oe=0,v){for(i.state=i.__s,i.__d=!1,F&&F(e),p=i.render(i.props,i.state,i.context),U=0;U<i._sb.length;U++)i.__h.push(i._sb[U]);i._sb=[]}else do i.__d=!1,F&&F(e),p=i.render(i.props,i.state,i.context),i.state=i.__s;while(i.__d&&++oe<25);i.state=i.__s,i.getChildContext!=null&&(o=E(E({},o),i.getChildContext())),v&&!f&&i.getSnapshotBeforeUpdate!=null&&(C=i.getSnapshotBeforeUpdate(d,b)),pe(t,J(j=p!=null&&p.type===I&&p.key==null?p.props.children:p)?j:[j],e,n,o,r,_,c,a,u,s),i.base=e.__e,e.__u&=-161,i.__h.length&&c.push(i),x&&(i.__E=i.__=null)}catch(z){if(e.__v=null,u||_!=null){for(e.__u|=u?160:32;a&&a.nodeType===8&&a.nextSibling;)a=a.nextSibling;_[_.indexOf(a)]=null,e.__e=a}else e.__e=n.__e,e.__k=n.__k;m.__e(z,e,n)}else _==null&&e.__v===n.__v?(e.__k=n.__k,e.__e=n.__e):e.__e=$e(n.__e,e,n,o,r,_,c,u,s);(p=m.diffed)&&p(e)}function me(t,e,n){e.__d=void 0;for(var o=0;o<n.length;o++)Y(n[o],n[++o],n[++o]);m.__c&&m.__c(e,t),t.some(function(r){try{t=r.__h,r.__h=[],t.some(function(_){_.call(r)})}catch(_){m.__e(_,r.__v)}})}function $e(t,e,n,o,r,_,c,a,u){var s,p,i,f,d,b,C,x=n.props,h=e.props,v=e.type;if(v==="svg"?r="http://www.w3.org/2000/svg":v==="math"?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),_!=null){for(s=0;s<_.length;s++)if((d=_[s])&&"setAttribute"in d==!!v&&(v?d.localName===v:d.nodeType===3)){t=d,_[s]=null;break}}if(t==null){if(v===null)return document.createTextNode(h);t=document.createElementNS(r,v,h.is&&h),a&&(m.__m&&m.__m(e,_),a=!1),_=null}if(v===null)x===h||a&&t.data===h||(t.data=h);else{if(_=_&&$.call(t.childNodes),x=n.props||D,!a&&_!=null)for(x={},s=0;s<t.attributes.length;s++)x[(d=t.attributes[s]).name]=d.value;for(s in x)if(d=x[s],s!="children"){if(s=="dangerouslySetInnerHTML")i=d;else if(!(s in h)){if(s=="value"&&"defaultValue"in h||s=="checked"&&"defaultChecked"in h)continue;A(t,s,null,d,r)}}for(s in h)d=h[s],s=="children"?f=d:s=="dangerouslySetInnerHTML"?p=d:s=="value"?b=d:s=="checked"?C=d:a&&typeof d!="function"||x[s]===d||A(t,s,d,x[s],r);if(p)a||i&&(p.__html===i.__html||p.__html===t.innerHTML)||(t.innerHTML=p.__html),e.__k=[];else if(i&&(t.innerHTML=""),pe(t,J(f)?f:[f],e,n,o,v==="foreignObject"?"http://www.w3.org/1999/xhtml":r,_,c,_?_[0]:n.__k&&N(n,0),a,u),_!=null)for(s=_.length;s--;)ue(_[s]);a||(s="value",v==="progress"&&b==null?t.removeAttribute("value"):b!==void 0&&(b!==t[s]||v==="progress"&&!b||v==="option"&&b!==x[s])&&A(t,s,b,x[s],r),s="checked",C!==void 0&&C!==t[s]&&A(t,s,C,x[s],r))}return t}function Y(t,e,n){try{if(typeof t=="function"){var o=typeof t.__u=="function";o&&t.__u(),o&&e==null||(t.__u=t(e))}else t.current=e}catch(r){m.__e(r,n)}}function he(t,e,n){var o,r;if(m.unmount&&m.unmount(t),(o=t.ref)&&(o.current&&o.current!==t.__e||Y(o,null,e)),(o=t.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(_){m.__e(_,e)}o.base=o.__P=null}if(o=t.__k)for(r=0;r<o.length;r++)o[r]&&he(o[r],e,n||typeof t.type!="function");n||ue(t.__e),t.__c=t.__=t.__e=t.__d=void 0}function We(t,e,n){return this.constructor(t,n)}function ve(t,e,n){var o,r,_,c;m.__&&m.__(t,e),r=(o=typeof n=="function")?null:n&&n.__k||e.__k,_=[],c=[],Q(e,t=(!o&&n||e).__k=l(I,null,[t]),r||D,D,e.namespaceURI,!o&&n?[n]:r?null:e.firstChild?$.call(e.childNodes):null,_,!o&&n?n:r?r.__e:e.firstChild,o,c),me(_,t,c)}$=ce.slice,m={__e:function(t,e,n,o){for(var r,_,c;e=e.__;)if((r=e.__c)&&!r.__)try{if((_=r.constructor)&&_.getDerivedStateFromError!=null&&(r.setState(_.getDerivedStateFromError(t)),c=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(t,o||{}),c=r.__d),c)return r.__E=r}catch(a){t=a}throw t}},se=0,ze=function(t){return t!=null&&t.constructor==null},B.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=E({},this.state),typeof t=="function"&&(t=t(E({},n),this.props)),t&&E(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),ie(this))},B.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),ie(this))},B.prototype.render=I,w=[],le=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,q=function(t,e){return t.__v.__b-e.__v.__b},O.__r=0,X=0,G=ae(!1),K=ae(!0),Ae=0;var L,g,Z,ge,V=0,Ee=[],y=m,be=y.__b,ye=y.__r,xe=y.diffed,Ce=y.__c,ke=y.unmount,Te=y.__;function te(t,e){y.__h&&y.__h(g,t,V||e),V=0;var n=g.__H||(g.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function S(t){return V=1,Ve(Ie,t)}function Ve(t,e,n){var o=te(L++,2);if(o.t=t,!o.__c&&(o.__=[n?n(e):Ie(void 0,e),function(a){var u=o.__N?o.__N[0]:o.__[0],s=o.t(u,a);u!==s&&(o.__N=[s,o.__[1]],o.__c.setState({}))}],o.__c=g,!g.u)){var r=function(a,u,s){if(!o.__c.__H)return!0;var p=o.__c.__H.__.filter(function(f){return!!f.__c});if(p.every(function(f){return!f.__N}))return!_||_.call(this,a,u,s);var i=!1;return p.forEach(function(f){if(f.__N){var d=f.__[0];f.__=f.__N,f.__N=void 0,d!==f.__[0]&&(i=!0)}}),!(!i&&o.__c.props===a)&&(!_||_.call(this,a,u,s))};g.u=!0;var _=g.shouldComponentUpdate,c=g.componentWillUpdate;g.componentWillUpdate=function(a,u,s){if(this.__e){var p=_;_=void 0,r(a,u,s),_=p}c&&c.call(this,a,u,s)},g.shouldComponentUpdate=r}return o.__N||o.__}function Se(t,e){var n=te(L++,3);!y.__s&&Ne(n.__H,e)&&(n.__=t,n.i=e,g.__H.__h.push(n))}function we(t){return V=5,je(function(){return{current:t}},[])}function je(t,e){var n=te(L++,7);return Ne(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function qe(){for(var t;t=Ee.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(W),t.__H.__h.forEach(ee),t.__H.__h=[]}catch(e){t.__H.__h=[],y.__e(e,t.__v)}}y.__b=function(t){g=null,be&&be(t)},y.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),Te&&Te(t,e)},y.__r=function(t){ye&&ye(t),L=0;var e=(g=t.__c).__H;e&&(Z===g?(e.__h=[],g.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.i=n.__N=void 0})):(e.__h.forEach(W),e.__h.forEach(ee),e.__h=[],L=0)),Z=g},y.diffed=function(t){xe&&xe(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(Ee.push(e)!==1&&ge===y.requestAnimationFrame||((ge=y.requestAnimationFrame)||Ge)(qe)),e.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.i=void 0})),Z=g=null},y.__c=function(t,e){e.some(function(n){try{n.__h.forEach(W),n.__h=n.__h.filter(function(o){return!o.__||ee(o)})}catch(o){e.some(function(r){r.__h&&(r.__h=[])}),e=[],y.__e(o,n.__v)}}),Ce&&Ce(t,e)},y.unmount=function(t){ke&&ke(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(o){try{W(o)}catch(r){e=r}}),n.__H=void 0,e&&y.__e(e,n.__v))};var Me=typeof requestAnimationFrame=="function";function Ge(t){var e,n=function(){clearTimeout(o),Me&&cancelAnimationFrame(e),setTimeout(t)},o=setTimeout(n,100);Me&&(e=requestAnimationFrame(n))}function W(t){var e=g,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),g=e}function ee(t){var e=g;t.__c=t.__(),g=e}function Ne(t,e){return!t||t.length!==e.length||e.some(function(n,o){return n!==t[o]})}function Ie(t,e){return typeof e=="function"?e(t):e}function He(t,e){let n=we(void 0),o=(...r)=>{n.current&&clearTimeout(n.current),n.current=window.setTimeout(()=>{t(...r)},e)};return Se(()=>()=>{n.current&&clearTimeout(n.current)},[]),o}var Ke=new Intl.NumberFormat("en-US"),T=({value:t})=>l(I,null,Ke.format(t));var ne=[{bg:"#c1e7ff",fg:"#000"},{bg:"#abd2ec",fg:"#000"},{bg:"#94bed9",fg:"#000"},{bg:"#7faac6",fg:"#000"},{bg:"#6996b3",fg:"#fff"},{bg:"#5383a1",fg:"#fff"},{bg:"#3d708f",fg:"#fff"},{bg:"#255e7e",fg:"#fff"}],Xe=({scoreBy:t,nodes:e,epoch:n})=>{if(e.length===0)return null;let o=t;if(t.field!=="tokens"){let r=e[0][t.field],_=e[0][t.field];for(let c=1;c<e.length;c++)r=Math.max(r,e[c][t.field]),_=Math.max(_,e[c][t.field]);o={field:t.field,max:r,min:_}}return l("div",{className:"node-children"},e.map((r,_)=>r.type===2?l(Je,{scoreBy:o,key:_,node:r}):l(Le,{scoreBy:o,key:_,node:r,epoch:n})))},Fe=({node:t})=>l("div",{className:"node-stats"},"Used Tokens: ",l(T,{value:t.tokens})," / ","Priority:"," ",t.priority===Number.MAX_SAFE_INTEGER?"MAX":l(T,{value:t.priority})),De=({scoreBy:t,node:e,children:n,...o})=>{let r=0;if(t.max!==t.min){let _=(e[t.field]-t.min)/(t.max-t.min);r=Math.round((ne.length-1)*_)}return l("div",{...o,className:`node ${o.className||""}`,style:{backgroundColor:ne[r].bg,color:ne[r].fg}},n)},Je=({scoreBy:t,node:e})=>l(De,{node:e,scoreBy:t,tabIndex:0,className:"node-text"},l(Fe,{node:e}),l("div",{className:"node-content"},e.value)),Le=({scoreBy:t,node:e,epoch:n})=>{let[o,r]=S(!1),_=EPOCHS.findIndex(i=>i.elements.some(f=>f.id===e.id));if(_===void 0)throw new Error(`epoch not found for ${e.id}`);let c=EPOCHS[_],a=EPOCHS.at(n),u=c.elements.find(i=>i.id===e.id).tokenBudget,s=e.type===1?e.name||e.role.slice(0,1).toUpperCase()+e.role.slice(1)+"Message":e.name,p=_===n?"new-in-epoch":n<_?"before-epoch":"";return l(De,{node:e,scoreBy:t,className:p},l(Fe,{node:e}),l("div",{className:"node-content node-toggler",onClick:()=>r(i=>!i)},l("span",null,a?.inNode===e.id?"\\u{1F3C3} ":"",`<${s}>`),l("span",{className:"indicator"},o?"[+]":"[-]")),n===_&&l("div",{className:"node-stats"},"Token Budget: ",l(T,{value:u})),a?.inNode===e.id&&l("div",{className:"node-stats"},"Rendering flexGrow=",a.flexValue,l("br",null),l("br",null),"Splitting"," ",a.reservedTokens?`${a.tokenBudget} - ${a.reservedTokens} (reserved) = `:"",l(T,{value:a.tokenBudget})," tokens among ",a.elements.length," ","elements"),!o&&l(Xe,{nodes:e.children,scoreBy:t,epoch:n}))},Pe=({scoreBy:t,node:e,epoch:n})=>{let o;return t==="tokens"?o={field:"tokens",max:e.tokens,min:0}:o={field:"priority",max:e.priority,min:e.priority},l(Le,{scoreBy:o,node:e,epoch:n})};var Ue=({label:t,value:e,onChange:n,min:o,max:r})=>{let _=a=>{n(a.target.valueAsNumber)},c=`number-slider-${Math.random()}`;return l("div",{className:"controls-slider"},l("label",{htmlFor:c},t),l("input",{id:c,type:"range",min:o,max:r,value:e,onInput:_}),l("input",{type:"number",min:o,value:e,onInput:_,onChange:_}))},Qe=({scoreBy:t,onScoreByChange:e})=>{let n=o=>{let r=o.target.value;e(r)};return l("div",{className:"controls-scoreby"},"Visualize by",l("label",null,l("input",{type:"radio",name:"scoreBy",value:"tokens",checked:t==="tokens",onChange:n}),"Tokens"),l("label",null,l("input",{type:"radio",name:"scoreBy",value:"priority",checked:t==="priority",onChange:n}),"Priority"))},Ye=()=>{let[t,e]=S(DEFAULT_TOKENS),[n,o]=S(EPOCHS.length),[r,_]=S(DEFAULT_MODEL),[c,a]=S("tokens"),[u,s]=S("epoch"),p=He(async f=>{if(f===DEFAULT_TOKENS)return DEFAULT_MODEL;let b=await(await fetch(`${SERVER_ADDRESS}regen?n=${f}`)).json();_(b)},100),i=f=>{e(f),p(f),o(EPOCHS.length)};return l("div",{className:"app"},l("div",{className:"controls"},l("div",{className:"tabs"},l("div",{className:`tab ${u==="epoch"?"active":""}`,onClick:()=>s("epoch")},"View Order"),l("div",{className:`tab ${u==="tokens"?"active":""}`,onClick:()=>s("tokens")},"Change Token Budget")),l("div",{className:`tab-content ${u==="epoch"?"active":""}`},l(Ue,{label:"Render Epoch",value:n,onChange:o,min:0,max:EPOCHS.length})),l("div",{className:`tab-content ${u==="tokens"?"active":""}`},l(Ue,{label:"Token Budget",value:t,onChange:i,min:0,max:DEFAULT_TOKENS*2}))),l("div",{className:"control-description"},u==="tokens"?l("p",null,"Token changes here will prune elements and re-render Expandable ones, but the entire prompt is not being re-rendered"):l("p",null,"Changing the render epoch lets you see the order in which elements are rendered and how the token budget is allocated."),l("div",{className:"controls-stats"},l("span",null,"Used ",l(T,{value:r.container.tokens}),"/",l(T,{value:r.budget})," tokens"),l("span",null,"Removed ",l(T,{value:r.removed})," nodes"),l(Qe,{scoreBy:c,onScoreByChange:a}))),l(Pe,{node:r.container,scoreBy:c,epoch:n}))};ve(l(Ye,null),document.body);})();\n';K1.tracerCss=`body{font-family:-apple-system,BlinkMacSystemFont,Segoe WPC,Segoe UI,system-ui,Ubuntu,Droid Sans,sans-serif;background:#fff;margin:0}.render-pass{border-left:2px solid #ccc;&:hover{border-left-color:#000}}.literals li{white-space:pre;font-family:SF Mono,Monaco,Menlo,Consolas,Ubuntu Mono,Liberation Mono,DejaVu Sans Mono,Courier New,monospace}.render-flex,.render-element{padding-left:10px}.node{border:1px solid rgba(255,255,255,.5);margin:3px 10px;padding:3px 10px;border-radius:4px;width:fit-content;&.new-in-epoch{box-shadow:0 0 3px 2px red}&.before-epoch{pointer-events:none;filter:grayscale(1);color:#777!important;.node{color:#777!important}}&:last-child{margin-bottom:0}}.node-content{font-weight:700}.node-children{margin-left:20px;border-left:2px dashed rgba(255,255,255,.5);padding-left:10px}.node-toggler{cursor:pointer;display:flex;align-items:center;justify-content:space-between;.indicator{font-size:.7em}}.node-text{width:400px;&:focus,&:focus-within{outline:1px solid orange;.node-content{white-space:normal}}.node-content{font-weight:400;font-size:.8em;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}}.node-stats{font-family:SF Mono,Monaco,Menlo,Consolas,Ubuntu Mono,Liberation Mono,DejaVu Sans Mono,Courier New,monospace;font-size:.8em}.control-description{padding:10px;p{font-size:.9em;max-width:500px;margin-top:0}}.controls{display:flex;flex-direction:column;gap:10px;position:sticky;top:0;padding:10px;background:#fff;border-bottom:1px solid #ccc;z-index:1}.controls-slider{display:flex;align-items:center;gap:10px}.controls-stats{display:flex;gap:20px;list-style:none;padding:0;margin-top:0}.controls-scoreby{display:flex;gap:10px}.tabs{display:flex;border-bottom:1px solid #ccc;margin-bottom:10px}.tab{padding:10px;cursor:pointer;border:1px solid transparent;border-bottom:none}.tab.active{border-color:#ccc;border-bottom:1px solid #fff;background-color:#f9f9f9}.tab-content{display:none}.tab-content.active{display:block}
`});var Wge=P(m5=>{"use strict";Object.defineProperty(m5,"__esModule",{value:!0});m5.HTMLTracer=void 0;var Vge=Hge(),p5=_K(),JK=class{traceData;epochs=[];addRenderEpoch(e){this.epochs.push(e)}includeInEpoch(e){this.epochs[this.epochs.length-1].elements.push(e)}didMaterializeTree(e){this.traceData=e}async serveHTML(){return ZK.create({epochs:this.epochs,traceData:zge(this.traceData)})}serveRouter(e){return new f5({baseAddress:e,epochs:this.epochs,traceData:zge(this.traceData)})}};m5.HTMLTracer=JK;var f5=class{opts;serverToken=crypto.randomUUID();constructor(e){this.opts=e}route(e,t){let r=e,o=t,s=new URL(r.url||"/","http://localhost"),a=`/${this.serverToken}`;switch(s.pathname){case a:case`${a}/`:this.onRoot(s,r,o);break;case`${a}/regen`:this.onRegen(s,r,o);break;default:return!1}return!0}get address(){return this.opts.baseAddress+"/"+this.serverToken}async getHTML(){let{traceData:e,epochs:t}=this.opts;return`<body>
			<style>${Vge.tracerCss}</style>
			<script>
				const DEFAULT_TOKENS = ${JSON.stringify(e.budget)};
				const EPOCHS = ${JSON.stringify(t)};
				const DEFAULT_MODEL = ${JSON.stringify(await Gge(e.tokenizer,e.renderedTree))};
				const SERVER_ADDRESS = ${JSON.stringify(this.opts.baseAddress+"/"+this.serverToken+"/")};
				${Vge.tracerSrc}
			</script>
		</body>`}async onRegen(e,t,r){let{traceData:o}=this.opts,s=Number(e.searchParams.get("n")||o.budget),a=await o.renderTree(s),c=await Gge(o.tokenizer,a),l=JSON.stringify(c);r.setHeader("Content-Type","application/json"),r.setHeader("Content-Length",Buffer.byteLength(l)),r.end(l)}onRoot(e,t,r){this.getHTML().then(o=>{r.setHeader("Content-Type","text/html"),r.setHeader("Content-Length",Buffer.byteLength(o)),r.end(o)})}},ZK=class n extends f5{server;static async create(e){let{createServer:t}=await Promise.resolve().then(()=>require("http")),r=t((a,c)=>{try{s.route(a,c)||(c.statusCode=404,c.end("Not Found"))}catch(l){c.statusCode=500,c.end(String(l))}}),o=await new Promise((a,c)=>{r.listen(0,"127.0.0.1",()=>a(r.address().port)).on("error",c)}),s=new n({...e,baseAddress:`http://127.0.0.1:${o}`},r);return s}constructor(e,t){super(e),this.server=t}dispose(){this.server.closeAllConnections(),this.server.close()}};async function Gge(n,e){return{container:await $ge(n,e.container,!1),removed:e.removed,budget:e.budget}}async function $ge(n,e,t){let r={metadata:e.metadata.map(Sze),priority:e.priority};if(e instanceof p5.MaterializedChatMessageTextChunk)return{...r,type:2,value:e.text,tokens:await e.upperBoundTokenCount(n)};{let o={...r,id:e.id,name:e.name,children:await Promise.all(e.children.map(s=>$ge(n,s,t||e instanceof p5.MaterializedChatMessage))),tokens:t?await e.upperBoundTokenCount(n):await e.tokenCount(n)};if(e instanceof p5.MaterializedContainer)return{...o,type:0};if(e instanceof p5.MaterializedChatMessage)return{...o,type:1,role:e.role,text:e.text}}xze(e)}function xze(n){throw new Error("unreachable")}function Sze(n){return{name:n.constructor.name,value:JSON.stringify(n)}}var zge=n=>{if(n===void 0)throw new Error("Prompt must be rendered before calling HTMLTRacer.serveHTML");return n}});var Yge=P(eY=>{"use strict";Object.defineProperty(eY,"__esModule",{value:!0});eY.forEachNode=Kge;function Kge(n,e){if(e(n),n.type===1)for(let t of n.children)Kge(t,e)}});var Xge=P(Qge=>{"use strict";Object.defineProperty(Qge,"__esModule",{value:!0})});var Zge=P(Jge=>{"use strict";Object.defineProperty(Jge,"__esModule",{value:!0})});var tve=P(eve=>{"use strict";Object.defineProperty(eve,"__esModule",{value:!0})});var Ve=P(en=>{"use strict";var Ize=en&&en.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,o)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),eD=en&&en.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Ize(e,n,t)};Object.defineProperty(en,"__esModule",{value:!0});en.contentType=en.PromptRenderer=en.MetadataMap=en.PromptElement=en.ToolResult=en.UserMessage=en.ToolMessage=en.TextChunk=en.SystemMessage=en.PrioritizedList=en.LegacyPrioritization=en.FunctionMessage=en.Chunk=en.AssistantMessage=en.ChatRole=en.JSONTree=void 0;en.renderPrompt=wze;en.renderElementJSON=kze;en.toVsCodeChatMessages=ive;var h5=V1(),nve=QK(),Tze=jge();eD(Wge(),en);en.JSONTree=Yge();var Cze=V1();Object.defineProperty(en,"ChatRole",{enumerable:!0,get:function(){return Cze.ChatRole}});eD(qK(),en);eD(Xge(),en);eD(Zge(),en);eD(tve(),en);var Up=PK();Object.defineProperty(en,"AssistantMessage",{enumerable:!0,get:function(){return Up.AssistantMessage}});Object.defineProperty(en,"Chunk",{enumerable:!0,get:function(){return Up.Chunk}});Object.defineProperty(en,"FunctionMessage",{enumerable:!0,get:function(){return Up.FunctionMessage}});Object.defineProperty(en,"LegacyPrioritization",{enumerable:!0,get:function(){return Up.LegacyPrioritization}});Object.defineProperty(en,"PrioritizedList",{enumerable:!0,get:function(){return Up.PrioritizedList}});Object.defineProperty(en,"SystemMessage",{enumerable:!0,get:function(){return Up.SystemMessage}});Object.defineProperty(en,"TextChunk",{enumerable:!0,get:function(){return Up.TextChunk}});Object.defineProperty(en,"ToolMessage",{enumerable:!0,get:function(){return Up.ToolMessage}});Object.defineProperty(en,"UserMessage",{enumerable:!0,get:function(){return Up.UserMessage}});Object.defineProperty(en,"ToolResult",{enumerable:!0,get:function(){return Up.ToolResult}});var Eze=SK();Object.defineProperty(en,"PromptElement",{enumerable:!0,get:function(){return Eze.PromptElement}});var rve=QK();Object.defineProperty(en,"MetadataMap",{enumerable:!0,get:function(){return rve.MetadataMap}});Object.defineProperty(en,"PromptRenderer",{enumerable:!0,get:function(){return rve.PromptRenderer}});async function wze(n,e,t,r,o,s,a="vscode"){let c="countTokens"in r?new Tze.AnyTokenizer((h,g)=>r.countTokens(h,g)):r,l=new nve.PromptRenderer(t,n,e,c),{messages:u,tokenCount:d,references:p,metadata:f}=await l.render(o,s),m=l.getUsedContext();return a==="vscode"&&(u=ive(u)),{messages:u,tokenCount:d,metadatas:f,usedContext:m,references:p}}en.contentType="application/vnd.codechat.prompt+json.1";function kze(n,e,t,r){return new nve.PromptRenderer({modelMaxPromptTokens:t?.tokenBudget??Number.MAX_SAFE_INTEGER},n,e,{countMessageTokens(s){throw new Error("Tools may only return text, not messages.")},tokenLength(s,a){return Promise.resolve(t?.countTokens(s,a)??Promise.resolve(1))}}).renderElementJSON(r)}function ive(n){let e=require("vscode");return n.map(t=>{switch(t.role){case h5.ChatRole.Assistant:let r=e.LanguageModelChatMessage.Assistant(t.content,t.name);return t.tool_calls&&(r.content2=[t.content],r.content2.push(...t.tool_calls.map(o=>new e.LanguageModelToolCallPart(o.function.name,o.id,o.function.arguments)))),r;case h5.ChatRole.User:return e.LanguageModelChatMessage.User(t.content,t.name);case h5.ChatRole.Function:{let o=e.LanguageModelChatMessage.User("");return o.content2=[new e.LanguageModelToolResultPart(t.name,[new e.LanguageModelTextPart(t.content)])],o}case h5.ChatRole.Tool:{let o=e.LanguageModelChatMessage.User("");return o.content2=[new e.LanguageModelToolResultPart(t.tool_call_id,[new e.LanguageModelTextPart(t.content)])],o}default:throw new Error(`Converting chat message with role ${t.role} to VS Code chat message is not supported.`)}})}});var lve=P(qp=>{"use strict";Object.defineProperty(qp,"__esModule",{value:!0});qp.bytePairEncode=qp.BinaryMap=qp.binaryMapKey=void 0;var Pze=(n,e,t)=>{let r=t-e,o=16777215>>>Math.max(0,(3-r)*8),s=(n[e+0]|n[e+1]<<8|n[e+2]<<16)&o,a=16777215>>>Math.min(31,Math.max(0,(6-r)*8)),c=(n[e+3]|n[e+4]<<8|n[e+5]<<16)&a;return s+16777216*c};qp.binaryMapKey=Pze;var nY=class n{constructor(){this.nested=new Map,this.final=new Map}get(e,t=0,r=e.length){let o=r<6+t,s=(0,qp.binaryMapKey)(e,t,r);return o?this.final.get(s):this.nested.get(s)?.get(e,6+t,r)}set(e,t){let r=(0,qp.binaryMapKey)(e,0,e.length);if(e.length<6){this.final.set(r,t);return}let s=this.nested.get(r);if(s instanceof n)s.set(e.subarray(6),t);else{let a=new n;a.set(e.subarray(6),t),this.nested.set(r,a)}}};qp.BinaryMap=nY;var Bp=new Int32Array(128),Ba=new Int32Array(128);function Aze(n,e,t){if(t===1)return[e.get(n)];let r=2147483647,o=-1;for(;Bp.length<t*2;)Ba=new Int32Array(Ba.length*2),Bp=new Int32Array(Bp.length*2);for(let l=0;l<t-1;l++){let u=e.get(n,l,l+2)??2147483647;u<r&&(r=u,o=l),Ba[l]=l,Bp[l]=u}Ba[t-1]=t-1,Bp[t-1]=2147483647,Ba[t]=t,Bp[t]=2147483647;let s=t+1;function a(l,u=0){if(l+u+2<s){let d=e.get(n,Ba[l],Ba[l+u+2]);if(d!==void 0)return d}return 2147483647}for(;r!==2147483647;){Bp[Ba[o]]=a(o,1),o>0&&(Bp[Ba[o-1]]=a(o-1,1));for(let l=o+1;l<s-1;l++)Ba[l]=Ba[l+1];s--,o=-1,r=2147483647;for(let l=0;l<s-1;l++){let u=Bp[Ba[l]];Bp[Ba[l]]<r&&(r=u,o=l)}}let c=[];for(let l=0;l<s-1;l++)c.push(e.get(n,Ba[l],Ba[l+1]));return c}qp.bytePairEncode=Aze});var uve=P(y5=>{"use strict";Object.defineProperty(y5,"__esModule",{value:!0});y5.makeTextEncoder=void 0;var rY=class{constructor(){this.length=0,this.encoder=new TextEncoder}encode(e){let t=this.encoder.encode(e);return this.length=t.length,t}},iY=class{constructor(){this.buffer=Buffer.alloc(256),this.length=0}encode(e){for(;;){if(this.length=this.buffer.write(e,"utf8"),this.length<this.buffer.length-4)return this.buffer;this.buffer=Buffer.alloc(this.length*2),this.length=this.buffer.write(e)}}},Dze=()=>typeof Buffer<"u"?new iY:new rY;y5.makeTextEncoder=Dze});var dve=P(b5=>{"use strict";Object.defineProperty(b5,"__esModule",{value:!0});b5.LRUCache=void 0;var oY=class{constructor(e){this.size=e,this.nodes=new Map}get(e){let t=this.nodes.get(e);if(t)return this.moveToHead(t),t.value}set(e,t){let r=this.nodes.get(e);if(r)r.value=t,this.moveToHead(r);else{let o=new sY(e,t);this.nodes.set(e,o),this.addNode(o),this.nodes.size>this.size&&(this.nodes.delete(this.tail.key),this.removeNode(this.tail))}}moveToHead(e){this.removeNode(e),e.next=void 0,e.prev=void 0,this.addNode(e)}addNode(e){this.head&&(this.head.prev=e,e.next=this.head),this.tail||(this.tail=e),this.head=e}removeNode(e){e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev}};b5.LRUCache=oY;var sY=class{constructor(e,t){this.key=e,this.value=t}}});var cY=P(x5=>{"use strict";Object.defineProperty(x5,"__esModule",{value:!0});x5.TikTokenizer=void 0;var Nze=require("fs"),Lze=require("util"),_5=lve(),Oze=uve(),Mze=dve();function Fze(n){let e=new Map;try{let r=Nze.readFileSync(n,"utf-8");return t(r),e}catch(r){throw new Error(`Failed to load from BPE encoder file stream: ${r}`)}function t(r){for(let o of r.split(/[\r\n]+/)){if(o.trim()==="")continue;let s=o.split(" ");if(s.length!==2)throw new Error("Invalid format in the BPE encoder file stream");let a=new Uint8Array(Buffer.from(s[0],"base64")),c=parseInt(s[1]);if(!isNaN(c))e.set(a,c);else throw new Error(`Can't parse ${s[1]} to integer`)}}}function Uze(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var aY=class{constructor(e,t,r,o=8192){this.textEncoder=(0,Oze.makeTextEncoder)(),this.textDecoder=new Lze.TextDecoder("utf-8"),this.cache=new Mze.LRUCache(o);let s=typeof e=="string"?Fze(e):e;this.init(s,t,r)}init(e,t,r){this.encoder=new _5.BinaryMap;for(let[o,s]of e)this.encoder.set(o,s);this.regex=new RegExp(r,"gu"),this.specialTokensRegex=new RegExp(Array.from(t.keys()).map(o=>Uze(o)).join("|")),this.specialTokensEncoder=t,this.decoder=new Map;for(let[o,s]of e)this.decoder.set(s,o);if(e.size!==this.decoder.size)throw new Error("Encoder and decoder sizes do not match");this.specialTokensDecoder=new Map;for(let[o,s]of t)this.specialTokensDecoder.set(s,o)}findNextSpecialToken(e,t,r){let o=t,s=null;if(r&&this.specialTokensRegex)for(;s=e.slice(o).match(this.specialTokensRegex),!(!s||r&&r.includes(s[0]));)o+=s.index+1;let a=s?o+s.index:e.length;return[s,a]}encode(e,t){let r=[],o=0;for(;;){let s,a;if([s,a]=this.findNextSpecialToken(e,o,t),a>o&&this.encodeByIndex(e,r,o,a),s){if(o=o+this.encodeSpecialToken(r,s),o>=e.length)break}else break}return r}encodeSpecialToken(e,t){let r=this.specialTokensEncoder?.get(t[0]);return e.push(r),t.index+t[0].length}encodeByIndex(e,t,r,o){let s,a=e.substring(r,o);for(this.regex.lastIndex=0;s=this.regex.exec(a);){let c=this.cache.get(s[0]);if(c)for(let l of c)t.push(l);else{let l=this.textEncoder.encode(s[0]),u=this.encoder.get(l,0,this.textEncoder.length);if(u!==void 0)t.push(u),this.cache.set(s[0],[u]);else{let d=(0,_5.bytePairEncode)(l,this.encoder,this.textEncoder.length);for(let p of d)t.push(p);this.cache.set(s[0],d)}}}}encodeTrimSuffixByIndex(e,t,r,o,s,a,c){let l,u=e.substring(r,o);for(this.regex.lastIndex=0;l=this.regex.exec(u);){let d=l[0],p=this.cache.get(d);if(p)if(a+p.length<=s)a+=p.length,c+=d.length,t.push(...p);else{let f=s-a;a+=f,c+=d.length,t.push(...p.slice(0,f));break}else{let f=this.textEncoder.encode(d),m=this.encoder.get(f,0,f.length);if(m!==void 0)if(this.cache.set(d,[m]),a+1<=s)a++,c+=d.length,t.push(m);else break;else{let h=(0,_5.bytePairEncode)(f,this.encoder,this.textEncoder.length);if(this.cache.set(d,h),a+h.length<=s){a+=h.length,c+=d.length;for(let g of h)t.push(g)}else{let g=s-a;a+=g,c+=d.length;for(let y=0;y<g;y++)t.push(h[y]);break}}}if(a>=s)break}return{tokenCount:a,encodeLength:c}}encodeTrimSuffix(e,t,r){let o=[],s=0,a=0,c=0;for(;;){let u,d;if([u,d]=this.findNextSpecialToken(e,s,r),d>s){let{tokenCount:p,encodeLength:f}=this.encodeTrimSuffixByIndex(e,o,s,d,t,a,c);if(a=p,c=f,a>=t)break}if(u!==null){if(a++,a<=t&&(s=s+this.encodeSpecialToken(o,u),c+=u[0].length,s>=e.length)||a>=t)break}else break}let l=c===e.length?e:e.slice(0,c);return{tokenIds:o,text:l}}encodeTrimPrefix(e,t,r){let o=[],s=0,a=0,c=0,l=new Map;for(l.set(a,c);;){let f,m;if([f,m]=this.findNextSpecialToken(e,s,r),m>s){let h,g=e.substring(s,m);for(this.regex.lastIndex=0;h=this.regex.exec(g);){let y=h[0],b=this.cache.get(y);if(b)a+=b.length,c+=y.length,o.push(...b),l.set(a,c);else{let _=this.textEncoder.encode(y),x=this.encoder.get(_);if(x!==void 0)this.cache.set(y,[x]),a++,c+=y.length,o.push(x),l.set(a,c);else{let I=(0,_5.bytePairEncode)(_,this.encoder,this.textEncoder.length);this.cache.set(y,I),a+=I.length,c+=y.length;for(let S of I)o.push(S);l.set(a,c)}}}}if(f!==null){if(s=s+this.encodeSpecialToken(o,f),a++,c+=f[0].length,l.set(a,c),s>=e.length)break}else break}if(a<=t)return{tokenIds:o,text:e};let u=a-t,d=0,p=0;for(let[f,m]of l)if(f>=u){d=f,p=m;break}if(d>t){let f=this.encode(e,r),m=f.slice(f.length-t);return{tokenIds:m,text:this.decode(m)}}return{tokenIds:o.slice(d),text:e.slice(p)}}decode(e){let t=[];for(let r of e){let o=[],s=this.decoder?.get(r);if(s!==void 0)o=Array.from(s);else{let a=this.specialTokensDecoder?.get(r);if(a!==void 0){let c=this.textEncoder.encode(a);o=Array.from(c.subarray(0,this.textEncoder.length))}}t.push(...o)}return this.textDecoder.decode(new Uint8Array(t))}};x5.TikTokenizer=aY});var xve=P(Ro=>{"use strict";Object.defineProperty(Ro,"__esModule",{value:!0});Ro.createTokenizer=Ro.createByEncoderName=Ro.createByModelName=Ro.getRegexByModel=Ro.getRegexByEncoder=Ro.getSpecialTokensByModel=Ro.getSpecialTokensByEncoder=Ro.MODEL_TO_ENCODING=void 0;var I5=require("fs"),lY=require("path"),Bze=cY(),qze=new Map([["gpt-4o-","o200k_base"],["gpt-4-","cl100k_base"],["gpt-3.5-turbo-","cl100k_base"],["gpt-35-turbo-","cl100k_base"]]);Ro.MODEL_TO_ENCODING=new Map([["gpt-4o","o200k_base"],["gpt-4","cl100k_base"],["gpt-3.5-turbo","cl100k_base"],["text-davinci-003","p50k_base"],["text-davinci-002","p50k_base"],["text-davinci-001","r50k_base"],["text-curie-001","r50k_base"],["text-babbage-001","r50k_base"],["text-ada-001","r50k_base"],["davinci","r50k_base"],["curie","r50k_base"],["babbage","r50k_base"],["ada","r50k_base"],["code-davinci-002","p50k_base"],["code-davinci-001","p50k_base"],["code-cushman-002","p50k_base"],["code-cushman-001","p50k_base"],["davinci-codex","p50k_base"],["cushman-codex","p50k_base"],["text-davinci-edit-001","p50k_edit"],["code-davinci-edit-001","p50k_edit"],["text-embedding-ada-002","cl100k_base"],["text-similarity-davinci-001","r50k_base"],["text-similarity-curie-001","r50k_base"],["text-similarity-babbage-001","r50k_base"],["text-similarity-ada-001","r50k_base"],["text-search-davinci-doc-001","r50k_base"],["text-search-curie-doc-001","r50k_base"],["text-search-babbage-doc-001","r50k_base"],["text-search-ada-doc-001","r50k_base"],["code-search-babbage-code-001","r50k_base"],["code-search-ada-code-001","r50k_base"],["gpt2","gpt2"]]);var S5="<|endoftext|>",pve="<|fim_prefix|>",fve="<|fim_middle|>",mve="<|fim_suffix|>",hve="<|endofprompt|>",nD="'s|'t|'re|'ve|'m|'ll|'d| ?\\p{L}+| ?\\p{N}+| ?[^\\s\\p{L}\\p{N}]+|\\s+(?!\\S)|\\s+",gve="(?:'s|'S|'t|'T|'re|'RE|'Re|'eR|'ve|'VE|'vE|'Ve|'m|'M|'ll|'lL|'Ll|'LL|'d|'D)|[^\\r\\n\\p{L}\\p{N}]?\\p{L}+|\\p{N}{1,3}| ?[^\\s\\p{L}\\p{N}]+[\\r\\n]*|\\s*[\\r\\n]+|\\s+(?!\\S)|\\s+",jze=[`[^\r
\\p{L}\\p{N}]?[\\p{Lu}\\p{Lt}\\p{Lm}\\p{Lo}\\p{M}]*[\\p{Ll}\\p{Lm}\\p{Lo}\\p{M}]+(?:'s|'S|'t|'T|'re|'RE|'Re|'eR|'ve|'VE|'vE|'Ve|'m|'M|'ll|'lL|'Ll|'LL|'d|'D)?`,`[^\r
\\p{L}\\p{N}]?[\\p{Lu}\\p{Lt}\\p{Lm}\\p{Lo}\\p{M}]+[\\p{Ll}\\p{Lm}\\p{Lo}\\p{M}]*(?:'s|'S|'t|'T|'re|'RE|'Re|'eR|'ve|'VE|'vE|'Ve|'m|'M|'ll|'lL|'Ll|'LL|'d|'D)?`,"\\p{N}{1,3}"," ?[^\\s\\p{L}\\p{N}]+[\\r\\n/]*","\\s*[\\r\\n]+","\\s+(?!\\S)","\\s+"],vve=jze.join("|");function uY(n){let e="";if(Ro.MODEL_TO_ENCODING.has(n))e=Ro.MODEL_TO_ENCODING.get(n);else for(let[t,r]of qze)if(n.startsWith(t)){e=r;break}return e}async function Hze(n,e){let t=await fetch(n);if(!t.ok)throw new Error(`Failed to fetch file from ${n}. Status code: ${t.status}`);let r=await t.text();I5.writeFileSync(e,r)}function dY(n){let e=new Map([[S5,50256]]);switch(n){case"o200k_base":e=new Map([[S5,199999],[hve,200018]]);break;case"cl100k_base":e=new Map([[S5,100257],[pve,100258],[fve,100259],[mve,100260],[hve,100276]]);break;case"p50k_edit":e=new Map([[S5,50256],[pve,50281],[fve,50282],[mve,50283]]);break;default:break}return e}Ro.getSpecialTokensByEncoder=dY;function Vze(n){let e=uY(n);return dY(e)}Ro.getSpecialTokensByModel=Vze;function yve(n){switch(n){case"o200k_base":return vve;case"cl100k_base":return gve;default:break}return nD}Ro.getRegexByEncoder=yve;function Gze(n){let e=uY(n);return yve(e)}Ro.getRegexByModel=Gze;async function zze(n,e=null){return bve(uY(n),e)}Ro.createByModelName=zze;async function bve(n,e=null){let t,r,o=dY(n);switch(n){case"o200k_base":t=vve,r="https://openaipublic.blob.core.windows.net/encodings/o200k_base.tiktoken";break;case"cl100k_base":t=gve,r="https://openaipublic.blob.core.windows.net/encodings/cl100k_base.tiktoken";break;case"p50k_base":t=nD,r="https://openaipublic.blob.core.windows.net/encodings/p50k_base.tiktoken";break;case"p50k_edit":t=nD,r="https://openaipublic.blob.core.windows.net/encodings/p50k_base.tiktoken";break;case"r50k_base":t=nD,r="https://openaipublic.blob.core.windows.net/encodings/r50k_base.tiktoken";break;case"gpt2":t=nD,r="https://raw.githubusercontent.com/microsoft/Tokenizer/main/model/gpt2.tiktoken";break;default:throw new Error(`Doesn't support this encoder [${n}]`)}e!==null&&(o=new Map([...o,...e]));let s=lY.basename(r),a=lY.resolve(__dirname,"..","model");I5.existsSync(a)||I5.mkdirSync(a,{recursive:!0});let c=lY.resolve(a,s);return I5.existsSync(c)||(console.log(`Downloading file from ${r}`),await Hze(r,c),console.log(`Saved file to ${c}`)),_ve(c,o,t)}Ro.createByEncoderName=bve;function _ve(n,e,t,r=8192){return new Bze.TikTokenizer(n,e,t,r)}Ro.createTokenizer=_ve});var Sve=P(Po=>{"use strict";Object.defineProperty(Po,"__esModule",{value:!0});Po.createTokenizer=Po.createByEncoderName=Po.createByModelName=Po.getSpecialTokensByModel=Po.getSpecialTokensByEncoder=Po.getRegexByModel=Po.getRegexByEncoder=Po.MODEL_TO_ENCODING=Po.TikTokenizer=void 0;var $ze=cY();Object.defineProperty(Po,"TikTokenizer",{enumerable:!0,get:function(){return $ze.TikTokenizer}});var Fv=xve();Object.defineProperty(Po,"MODEL_TO_ENCODING",{enumerable:!0,get:function(){return Fv.MODEL_TO_ENCODING}});Object.defineProperty(Po,"getRegexByEncoder",{enumerable:!0,get:function(){return Fv.getRegexByEncoder}});Object.defineProperty(Po,"getRegexByModel",{enumerable:!0,get:function(){return Fv.getRegexByModel}});Object.defineProperty(Po,"getSpecialTokensByEncoder",{enumerable:!0,get:function(){return Fv.getSpecialTokensByEncoder}});Object.defineProperty(Po,"getSpecialTokensByModel",{enumerable:!0,get:function(){return Fv.getSpecialTokensByModel}});Object.defineProperty(Po,"createByModelName",{enumerable:!0,get:function(){return Fv.createByModelName}});Object.defineProperty(Po,"createByEncoderName",{enumerable:!0,get:function(){return Fv.createByEncoderName}});Object.defineProperty(Po,"createTokenizer",{enumerable:!0,get:function(){return Fv.createTokenizer}})});var qD=P((EGt,nbe)=>{"use strict";var of="\\\\/",Jye=`[^${of}]`,mh="\\.",AKe="\\+",DKe="\\?",a8="\\/",NKe="(?=.)",Zye="[^/]",iX=`(?:${a8}|$)`,ebe=`(?:^|${a8})`,oX=`${mh}{1,2}${iX}`,LKe=`(?!${mh})`,OKe=`(?!${ebe}${oX})`,MKe=`(?!${mh}{0,1}${iX})`,FKe=`(?!${oX})`,UKe=`[^.${a8}]`,BKe=`${Zye}*?`,qKe="/",tbe={DOT_LITERAL:mh,PLUS_LITERAL:AKe,QMARK_LITERAL:DKe,SLASH_LITERAL:a8,ONE_CHAR:NKe,QMARK:Zye,END_ANCHOR:iX,DOTS_SLASH:oX,NO_DOT:LKe,NO_DOTS:OKe,NO_DOT_SLASH:MKe,NO_DOTS_SLASH:FKe,QMARK_NO_DOT:UKe,STAR:BKe,START_ANCHOR:ebe,SEP:qKe},jKe={...tbe,SLASH_LITERAL:`[${of}]`,QMARK:Jye,STAR:`${Jye}*?`,DOTS_SLASH:`${mh}{1,2}(?:[${of}]|$)`,NO_DOT:`(?!${mh})`,NO_DOTS:`(?!(?:^|[${of}])${mh}{1,2}(?:[${of}]|$))`,NO_DOT_SLASH:`(?!${mh}{0,1}(?:[${of}]|$))`,NO_DOTS_SLASH:`(?!${mh}{1,2}(?:[${of}]|$))`,QMARK_NO_DOT:`[^.${of}]`,START_ANCHOR:`(?:^|[${of}])`,END_ANCHOR:`(?:[${of}]|$)`,SEP:"\\"},HKe={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};nbe.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:HKe,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,extglobChars(n){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${n.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(n){return n===!0?jKe:tbe}}});var c8=P(Ec=>{"use strict";var{REGEX_BACKSLASH:VKe,REGEX_REMOVE_BACKSLASH:GKe,REGEX_SPECIAL_CHARS:zKe,REGEX_SPECIAL_CHARS_GLOBAL:$Ke}=qD();Ec.isObject=n=>n!==null&&typeof n=="object"&&!Array.isArray(n);Ec.hasRegexChars=n=>zKe.test(n);Ec.isRegexChar=n=>n.length===1&&Ec.hasRegexChars(n);Ec.escapeRegex=n=>n.replace($Ke,"\\$1");Ec.toPosixSlashes=n=>n.replace(VKe,"/");Ec.removeBackslashes=n=>n.replace(GKe,e=>e==="\\"?"":e);Ec.supportsLookbehinds=()=>{if(typeof process<"u"){let n=process.version.slice(1).split(".").map(Number);if(n.length===3&&n[0]>=9||n[0]===8&&n[1]>=10)return!0}return!1};Ec.escapeLast=(n,e,t)=>{let r=n.lastIndexOf(e,t);return r===-1?n:n[r-1]==="\\"?Ec.escapeLast(n,e,r-1):`${n.slice(0,r)}\\${n.slice(r)}`};Ec.removePrefix=(n,e={})=>{let t=n;return t.startsWith("./")&&(t=t.slice(2),e.prefix="./"),t};Ec.wrapOutput=(n,e={},t={})=>{let r=t.contains?"":"^",o=t.contains?"":"$",s=`${r}(?:${n})${o}`;return e.negated===!0&&(s=`(?:^(?!${s}).*$)`),s};Ec.basename=(n,{windows:e}={})=>{let t=n.split(e?/[\\/]/:"/"),r=t[t.length-1];return r===""?t[t.length-2]:r}});var ube=P((kGt,lbe)=>{"use strict";var rbe=c8(),{CHAR_ASTERISK:sX,CHAR_AT:WKe,CHAR_BACKWARD_SLASH:jD,CHAR_COMMA:KKe,CHAR_DOT:aX,CHAR_EXCLAMATION_MARK:cX,CHAR_FORWARD_SLASH:cbe,CHAR_LEFT_CURLY_BRACE:lX,CHAR_LEFT_PARENTHESES:uX,CHAR_LEFT_SQUARE_BRACKET:YKe,CHAR_PLUS:QKe,CHAR_QUESTION_MARK:ibe,CHAR_RIGHT_CURLY_BRACE:XKe,CHAR_RIGHT_PARENTHESES:obe,CHAR_RIGHT_SQUARE_BRACKET:JKe}=qD(),sbe=n=>n===cbe||n===jD,abe=n=>{n.isPrefix!==!0&&(n.depth=n.isGlobstar?1/0:1)},ZKe=(n,e)=>{let t=e||{},r=n.length-1,o=t.parts===!0||t.scanToEnd===!0,s=[],a=[],c=[],l=n,u=-1,d=0,p=0,f=!1,m=!1,h=!1,g=!1,y=!1,b=!1,_=!1,x=!1,I=!1,S=!1,w=0,R,k,V={value:"",depth:0,isGlob:!1},F=()=>u>=r,K=()=>l.charCodeAt(u+1),$=()=>(R=k,l.charCodeAt(++u));for(;u<r;){k=$();let U;if(k===jD){_=V.backslashes=!0,k=$(),k===lX&&(b=!0);continue}if(b===!0||k===lX){for(w++;F()!==!0&&(k=$());){if(k===jD){_=V.backslashes=!0,$();continue}if(k===lX){w++;continue}if(b!==!0&&k===aX&&(k=$())===aX){if(f=V.isBrace=!0,h=V.isGlob=!0,S=!0,o===!0)continue;break}if(b!==!0&&k===KKe){if(f=V.isBrace=!0,h=V.isGlob=!0,S=!0,o===!0)continue;break}if(k===XKe&&(w--,w===0)){b=!1,f=V.isBrace=!0,S=!0;break}}if(o===!0)continue;break}if(k===cbe){if(s.push(u),a.push(V),V={value:"",depth:0,isGlob:!1},S===!0)continue;if(R===aX&&u===d+1){d+=2;continue}p=u+1;continue}if(t.noext!==!0&&(k===QKe||k===WKe||k===sX||k===ibe||k===cX)===!0&&K()===uX){if(h=V.isGlob=!0,g=V.isExtglob=!0,S=!0,k===cX&&u===d&&(I=!0),o===!0){for(;F()!==!0&&(k=$());){if(k===jD){_=V.backslashes=!0,k=$();continue}if(k===obe){h=V.isGlob=!0,S=!0;break}}continue}break}if(k===sX){if(R===sX&&(y=V.isGlobstar=!0),h=V.isGlob=!0,S=!0,o===!0)continue;break}if(k===ibe){if(h=V.isGlob=!0,S=!0,o===!0)continue;break}if(k===YKe){for(;F()!==!0&&(U=$());){if(U===jD){_=V.backslashes=!0,$();continue}if(U===JKe){m=V.isBracket=!0,h=V.isGlob=!0,S=!0;break}}if(o===!0)continue;break}if(t.nonegate!==!0&&k===cX&&u===d){x=V.negated=!0,d++;continue}if(t.noparen!==!0&&k===uX){if(h=V.isGlob=!0,o===!0){for(;F()!==!0&&(k=$());){if(k===uX){_=V.backslashes=!0,k=$();continue}if(k===obe){S=!0;break}}continue}break}if(h===!0){if(S=!0,o===!0)continue;break}}t.noext===!0&&(g=!1,h=!1);let j=l,D="",A="";d>0&&(D=l.slice(0,d),l=l.slice(d),p-=d),j&&h===!0&&p>0?(j=l.slice(0,p),A=l.slice(p)):h===!0?(j="",A=l):j=l,j&&j!==""&&j!=="/"&&j!==l&&sbe(j.charCodeAt(j.length-1))&&(j=j.slice(0,-1)),t.unescape===!0&&(A&&(A=rbe.removeBackslashes(A)),j&&_===!0&&(j=rbe.removeBackslashes(j)));let B={prefix:D,input:n,start:d,base:j,glob:A,isBrace:f,isBracket:m,isGlob:h,isExtglob:g,isGlobstar:y,negated:x,negatedExtglob:I};if(t.tokens===!0&&(B.maxDepth=0,sbe(k)||a.push(V),B.tokens=a),t.parts===!0||t.tokens===!0){let U;for(let W=0;W<s.length;W++){let ae=U?U+1:d,Y=s[W],X=n.slice(ae,Y);t.tokens&&(W===0&&d!==0?(a[W].isPrefix=!0,a[W].value=D):a[W].value=X,abe(a[W]),B.maxDepth+=a[W].depth),(W!==0||X!=="")&&c.push(X),U=Y}if(U&&U+1<n.length){let W=n.slice(U+1);c.push(W),t.tokens&&(a[a.length-1].value=W,abe(a[a.length-1]),B.maxDepth+=a[a.length-1].depth)}B.slashes=s,B.parts=c}return B};lbe.exports=ZKe});var fbe=P((RGt,pbe)=>{"use strict";var l8=qD(),Od=c8(),{MAX_LENGTH:u8,POSIX_REGEX_SOURCE:eYe,REGEX_NON_SPECIAL_CHARS:tYe,REGEX_SPECIAL_CHARS_BACKREF:nYe,REPLACEMENTS:dbe}=l8,rYe=(n,e)=>{if(typeof e.expandRange=="function")return e.expandRange(...n,e);n.sort();let t=`[${n.join("-")}]`;try{new RegExp(t)}catch{return n.map(o=>Od.escapeRegex(o)).join("..")}return t},HT=(n,e)=>`Missing ${n}: "${e}" - use "\\\\${e}" to match literal characters`,dX=(n,e)=>{if(typeof n!="string")throw new TypeError("Expected a string");n=dbe[n]||n;let t={...e},r=typeof t.maxLength=="number"?Math.min(u8,t.maxLength):u8,o=n.length;if(o>r)throw new SyntaxError(`Input length: ${o}, exceeds maximum allowed length: ${r}`);let s={type:"bos",value:"",output:t.prepend||""},a=[s],c=t.capture?"":"?:",l=l8.globChars(t.windows),u=l8.extglobChars(l),{DOT_LITERAL:d,PLUS_LITERAL:p,SLASH_LITERAL:f,ONE_CHAR:m,DOTS_SLASH:h,NO_DOT:g,NO_DOT_SLASH:y,NO_DOTS_SLASH:b,QMARK:_,QMARK_NO_DOT:x,STAR:I,START_ANCHOR:S}=l,w=xe=>`(${c}(?:(?!${S}${xe.dot?h:d}).)*?)`,R=t.dot?"":g,k=t.dot?_:x,V=t.bash===!0?w(t):I;t.capture&&(V=`(${V})`),typeof t.noext=="boolean"&&(t.noextglob=t.noext);let F={input:n,index:-1,start:0,dot:t.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:a};n=Od.removePrefix(n,F),o=n.length;let K=[],$=[],j=[],D=s,A,B=()=>F.index===o-1,U=F.peek=(xe=1)=>n[F.index+xe],W=F.advance=()=>n[++F.index]||"",ae=()=>n.slice(F.index+1),Y=(xe="",mt=0)=>{F.consumed+=xe,F.index+=mt},X=xe=>{F.output+=xe.output!=null?xe.output:xe.value,Y(xe.value)},Se=()=>{let xe=1;for(;U()==="!"&&(U(2)!=="("||U(3)==="?");)W(),F.start++,xe++;return xe%2===0?!1:(F.negated=!0,F.start++,!0)},te=xe=>{F[xe]++,j.push(xe)},Ie=xe=>{F[xe]--,j.pop()},Xe=xe=>{if(D.type==="globstar"){let mt=F.braces>0&&(xe.type==="comma"||xe.type==="brace"),G=xe.extglob===!0||K.length&&(xe.type==="pipe"||xe.type==="paren");xe.type!=="slash"&&xe.type!=="paren"&&!mt&&!G&&(F.output=F.output.slice(0,-D.output.length),D.type="star",D.value="*",D.output=V,F.output+=D.output)}if(K.length&&xe.type!=="paren"&&(K[K.length-1].inner+=xe.value),(xe.value||xe.output)&&X(xe),D&&D.type==="text"&&xe.type==="text"){D.value+=xe.value,D.output=(D.output||"")+xe.value;return}xe.prev=D,a.push(xe),D=xe},Ut=(xe,mt)=>{let G={...u[mt],conditions:1,inner:""};G.prev=D,G.parens=F.parens,G.output=F.output;let de=(t.capture?"(":"")+G.open;te("parens"),Xe({type:xe,value:mt,output:F.output?"":m}),Xe({type:"paren",extglob:!0,value:W(),output:de}),K.push(G)},Nn=xe=>{let mt=xe.close+(t.capture?")":""),G;if(xe.type==="negate"){let de=V;if(xe.inner&&xe.inner.length>1&&xe.inner.includes("/")&&(de=w(t)),(de!==V||B()||/^\)+$/.test(ae()))&&(mt=xe.close=`)$))${de}`),xe.inner.includes("*")&&(G=ae())&&/^\.[^\\/.]+$/.test(G)){let me=dX(G,{...e,fastpaths:!1}).output;mt=xe.close=`)${me})${de})`}xe.prev.type==="bos"&&(F.negatedExtglob=!0)}Xe({type:"paren",extglob:!0,value:A,output:mt}),Ie("parens")};if(t.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(n)){let xe=!1,mt=n.replace(nYe,(G,de,me,Ne,Ee,St)=>Ne==="\\"?(xe=!0,G):Ne==="?"?de?de+Ne+(Ee?_.repeat(Ee.length):""):St===0?k+(Ee?_.repeat(Ee.length):""):_.repeat(me.length):Ne==="."?d.repeat(me.length):Ne==="*"?de?de+Ne+(Ee?V:""):V:de?G:`\\${G}`);return xe===!0&&(t.unescape===!0?mt=mt.replace(/\\/g,""):mt=mt.replace(/\\+/g,G=>G.length%2===0?"\\\\":G?"\\":"")),mt===n&&t.contains===!0?(F.output=n,F):(F.output=Od.wrapOutput(mt,F,e),F)}for(;!B();){if(A=W(),A==="\0")continue;if(A==="\\"){let G=U();if(G==="/"&&t.bash!==!0||G==="."||G===";")continue;if(!G){A+="\\",Xe({type:"text",value:A});continue}let de=/^\\+/.exec(ae()),me=0;if(de&&de[0].length>2&&(me=de[0].length,F.index+=me,me%2!==0&&(A+="\\")),t.unescape===!0?A=W():A+=W(),F.brackets===0){Xe({type:"text",value:A});continue}}if(F.brackets>0&&(A!=="]"||D.value==="["||D.value==="[^")){if(t.posix!==!1&&A===":"){let G=D.value.slice(1);if(G.includes("[")&&(D.posix=!0,G.includes(":"))){let de=D.value.lastIndexOf("["),me=D.value.slice(0,de),Ne=D.value.slice(de+2),Ee=eYe[Ne];if(Ee){D.value=me+Ee,F.backtrack=!0,W(),!s.output&&a.indexOf(D)===1&&(s.output=m);continue}}}(A==="["&&U()!==":"||A==="-"&&U()==="]")&&(A=`\\${A}`),A==="]"&&(D.value==="["||D.value==="[^")&&(A=`\\${A}`),t.posix===!0&&A==="!"&&D.value==="["&&(A="^"),D.value+=A,X({value:A});continue}if(F.quotes===1&&A!=='"'){A=Od.escapeRegex(A),D.value+=A,X({value:A});continue}if(A==='"'){F.quotes=F.quotes===1?0:1,t.keepQuotes===!0&&Xe({type:"text",value:A});continue}if(A==="("){te("parens"),Xe({type:"paren",value:A});continue}if(A===")"){if(F.parens===0&&t.strictBrackets===!0)throw new SyntaxError(HT("opening","("));let G=K[K.length-1];if(G&&F.parens===G.parens+1){Nn(K.pop());continue}Xe({type:"paren",value:A,output:F.parens?")":"\\)"}),Ie("parens");continue}if(A==="["){if(t.nobracket===!0||!ae().includes("]")){if(t.nobracket!==!0&&t.strictBrackets===!0)throw new SyntaxError(HT("closing","]"));A=`\\${A}`}else te("brackets");Xe({type:"bracket",value:A});continue}if(A==="]"){if(t.nobracket===!0||D&&D.type==="bracket"&&D.value.length===1){Xe({type:"text",value:A,output:`\\${A}`});continue}if(F.brackets===0){if(t.strictBrackets===!0)throw new SyntaxError(HT("opening","["));Xe({type:"text",value:A,output:`\\${A}`});continue}Ie("brackets");let G=D.value.slice(1);if(D.posix!==!0&&G[0]==="^"&&!G.includes("/")&&(A=`/${A}`),D.value+=A,X({value:A}),t.literalBrackets===!1||Od.hasRegexChars(G))continue;let de=Od.escapeRegex(D.value);if(F.output=F.output.slice(0,-D.value.length),t.literalBrackets===!0){F.output+=de,D.value=de;continue}D.value=`(${c}${de}|${D.value})`,F.output+=D.value;continue}if(A==="{"&&t.nobrace!==!0){te("braces");let G={type:"brace",value:A,output:"(",outputIndex:F.output.length,tokensIndex:F.tokens.length};$.push(G),Xe(G);continue}if(A==="}"){let G=$[$.length-1];if(t.nobrace===!0||!G){Xe({type:"text",value:A,output:A});continue}let de=")";if(G.dots===!0){let me=a.slice(),Ne=[];for(let Ee=me.length-1;Ee>=0&&(a.pop(),me[Ee].type!=="brace");Ee--)me[Ee].type!=="dots"&&Ne.unshift(me[Ee].value);de=rYe(Ne,t),F.backtrack=!0}if(G.comma!==!0&&G.dots!==!0){let me=F.output.slice(0,G.outputIndex),Ne=F.tokens.slice(G.tokensIndex);G.value=G.output="\\{",A=de="\\}",F.output=me;for(let Ee of Ne)F.output+=Ee.output||Ee.value}Xe({type:"brace",value:A,output:de}),Ie("braces"),$.pop();continue}if(A==="|"){K.length>0&&K[K.length-1].conditions++,Xe({type:"text",value:A});continue}if(A===","){let G=A,de=$[$.length-1];de&&j[j.length-1]==="braces"&&(de.comma=!0,G="|"),Xe({type:"comma",value:A,output:G});continue}if(A==="/"){if(D.type==="dot"&&F.index===F.start+1){F.start=F.index+1,F.consumed="",F.output="",a.pop(),D=s;continue}Xe({type:"slash",value:A,output:f});continue}if(A==="."){if(F.braces>0&&D.type==="dot"){D.value==="."&&(D.output=d);let G=$[$.length-1];D.type="dots",D.output+=A,D.value+=A,G.dots=!0;continue}if(F.braces+F.parens===0&&D.type!=="bos"&&D.type!=="slash"){Xe({type:"text",value:A,output:d});continue}Xe({type:"dot",value:A,output:d});continue}if(A==="?"){if(!(D&&D.value==="(")&&t.noextglob!==!0&&U()==="("&&U(2)!=="?"){Ut("qmark",A);continue}if(D&&D.type==="paren"){let de=U(),me=A;if(de==="<"&&!Od.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(D.value==="("&&!/[!=<:]/.test(de)||de==="<"&&!/<([!=]|\w+>)/.test(ae()))&&(me=`\\${A}`),Xe({type:"text",value:A,output:me});continue}if(t.dot!==!0&&(D.type==="slash"||D.type==="bos")){Xe({type:"qmark",value:A,output:x});continue}Xe({type:"qmark",value:A,output:_});continue}if(A==="!"){if(t.noextglob!==!0&&U()==="("&&(U(2)!=="?"||!/[!=<:]/.test(U(3)))){Ut("negate",A);continue}if(t.nonegate!==!0&&F.index===0){Se();continue}}if(A==="+"){if(t.noextglob!==!0&&U()==="("&&U(2)!=="?"){Ut("plus",A);continue}if(D&&D.value==="("||t.regex===!1){Xe({type:"plus",value:A,output:p});continue}if(D&&(D.type==="bracket"||D.type==="paren"||D.type==="brace")||F.parens>0){Xe({type:"plus",value:A});continue}Xe({type:"plus",value:p});continue}if(A==="@"){if(t.noextglob!==!0&&U()==="("&&U(2)!=="?"){Xe({type:"at",extglob:!0,value:A,output:""});continue}Xe({type:"text",value:A});continue}if(A!=="*"){(A==="$"||A==="^")&&(A=`\\${A}`);let G=tYe.exec(ae());G&&(A+=G[0],F.index+=G[0].length),Xe({type:"text",value:A});continue}if(D&&(D.type==="globstar"||D.star===!0)){D.type="star",D.star=!0,D.value+=A,D.output=V,F.backtrack=!0,F.globstar=!0,Y(A);continue}let xe=ae();if(t.noextglob!==!0&&/^\([^?]/.test(xe)){Ut("star",A);continue}if(D.type==="star"){if(t.noglobstar===!0){Y(A);continue}let G=D.prev,de=G.prev,me=G.type==="slash"||G.type==="bos",Ne=de&&(de.type==="star"||de.type==="globstar");if(t.bash===!0&&(!me||xe[0]&&xe[0]!=="/")){Xe({type:"star",value:A,output:""});continue}let Ee=F.braces>0&&(G.type==="comma"||G.type==="brace"),St=K.length&&(G.type==="pipe"||G.type==="paren");if(!me&&G.type!=="paren"&&!Ee&&!St){Xe({type:"star",value:A,output:""});continue}for(;xe.slice(0,3)==="/**";){let Ft=n[F.index+4];if(Ft&&Ft!=="/")break;xe=xe.slice(3),Y("/**",3)}if(G.type==="bos"&&B()){D.type="globstar",D.value+=A,D.output=w(t),F.output=D.output,F.globstar=!0,Y(A);continue}if(G.type==="slash"&&G.prev.type!=="bos"&&!Ne&&B()){F.output=F.output.slice(0,-(G.output+D.output).length),G.output=`(?:${G.output}`,D.type="globstar",D.output=w(t)+(t.strictSlashes?")":"|$)"),D.value+=A,F.globstar=!0,F.output+=G.output+D.output,Y(A);continue}if(G.type==="slash"&&G.prev.type!=="bos"&&xe[0]==="/"){let Ft=xe[1]!==void 0?"|$":"";F.output=F.output.slice(0,-(G.output+D.output).length),G.output=`(?:${G.output}`,D.type="globstar",D.output=`${w(t)}${f}|${f}${Ft})`,D.value+=A,F.output+=G.output+D.output,F.globstar=!0,Y(A+W()),Xe({type:"slash",value:"/",output:""});continue}if(G.type==="bos"&&xe[0]==="/"){D.type="globstar",D.value+=A,D.output=`(?:^|${f}|${w(t)}${f})`,F.output=D.output,F.globstar=!0,Y(A+W()),Xe({type:"slash",value:"/",output:""});continue}F.output=F.output.slice(0,-D.output.length),D.type="globstar",D.output=w(t),D.value+=A,F.output+=D.output,F.globstar=!0,Y(A);continue}let mt={type:"star",value:A,output:V};if(t.bash===!0){mt.output=".*?",(D.type==="bos"||D.type==="slash")&&(mt.output=R+mt.output),Xe(mt);continue}if(D&&(D.type==="bracket"||D.type==="paren")&&t.regex===!0){mt.output=A,Xe(mt);continue}(F.index===F.start||D.type==="slash"||D.type==="dot")&&(D.type==="dot"?(F.output+=y,D.output+=y):t.dot===!0?(F.output+=b,D.output+=b):(F.output+=R,D.output+=R),U()!=="*"&&(F.output+=m,D.output+=m)),Xe(mt)}for(;F.brackets>0;){if(t.strictBrackets===!0)throw new SyntaxError(HT("closing","]"));F.output=Od.escapeLast(F.output,"["),Ie("brackets")}for(;F.parens>0;){if(t.strictBrackets===!0)throw new SyntaxError(HT("closing",")"));F.output=Od.escapeLast(F.output,"("),Ie("parens")}for(;F.braces>0;){if(t.strictBrackets===!0)throw new SyntaxError(HT("closing","}"));F.output=Od.escapeLast(F.output,"{"),Ie("braces")}if(t.strictSlashes!==!0&&(D.type==="star"||D.type==="bracket")&&Xe({type:"maybe_slash",value:"",output:`${f}?`}),F.backtrack===!0){F.output="";for(let xe of F.tokens)F.output+=xe.output!=null?xe.output:xe.value,xe.suffix&&(F.output+=xe.suffix)}return F};dX.fastpaths=(n,e)=>{let t={...e},r=typeof t.maxLength=="number"?Math.min(u8,t.maxLength):u8,o=n.length;if(o>r)throw new SyntaxError(`Input length: ${o}, exceeds maximum allowed length: ${r}`);n=dbe[n]||n;let{DOT_LITERAL:s,SLASH_LITERAL:a,ONE_CHAR:c,DOTS_SLASH:l,NO_DOT:u,NO_DOTS:d,NO_DOTS_SLASH:p,STAR:f,START_ANCHOR:m}=l8.globChars(t.windows),h=t.dot?d:u,g=t.dot?p:u,y=t.capture?"":"?:",b={negated:!1,prefix:""},_=t.bash===!0?".*?":f;t.capture&&(_=`(${_})`);let x=R=>R.noglobstar===!0?_:`(${y}(?:(?!${m}${R.dot?l:s}).)*?)`,I=R=>{switch(R){case"*":return`${h}${c}${_}`;case".*":return`${s}${c}${_}`;case"*.*":return`${h}${_}${s}${c}${_}`;case"*/*":return`${h}${_}${a}${c}${g}${_}`;case"**":return h+x(t);case"**/*":return`(?:${h}${x(t)}${a})?${g}${c}${_}`;case"**/*.*":return`(?:${h}${x(t)}${a})?${g}${_}${s}${c}${_}`;case"**/.*":return`(?:${h}${x(t)}${a})?${s}${c}${_}`;default:{let k=/^(.*?)\.(\w+)$/.exec(R);if(!k)return;let V=I(k[1]);return V?V+s+k[2]:void 0}}},S=Od.removePrefix(n,b),w=I(S);return w&&t.strictSlashes!==!0&&(w+=`${a}?`),w};pbe.exports=dX});var gbe=P((PGt,hbe)=>{"use strict";var iYe=ube(),pX=fbe(),mbe=c8(),oYe=qD(),sYe=n=>n&&typeof n=="object"&&!Array.isArray(n),ho=(n,e,t=!1)=>{if(Array.isArray(n)){let d=n.map(f=>ho(f,e,t));return f=>{for(let m of d){let h=m(f);if(h)return h}return!1}}let r=sYe(n)&&n.tokens&&n.input;if(n===""||typeof n!="string"&&!r)throw new TypeError("Expected pattern to be a non-empty string");let o=e||{},s=o.windows,a=r?ho.compileRe(n,e):ho.makeRe(n,e,!1,!0),c=a.state;delete a.state;let l=()=>!1;if(o.ignore){let d={...e,ignore:null,onMatch:null,onResult:null};l=ho(o.ignore,d,t)}let u=(d,p=!1)=>{let{isMatch:f,match:m,output:h}=ho.test(d,a,e,{glob:n,posix:s}),g={glob:n,state:c,regex:a,posix:s,input:d,output:h,match:m,isMatch:f};return typeof o.onResult=="function"&&o.onResult(g),f===!1?(g.isMatch=!1,p?g:!1):l(d)?(typeof o.onIgnore=="function"&&o.onIgnore(g),g.isMatch=!1,p?g:!1):(typeof o.onMatch=="function"&&o.onMatch(g),p?g:!0)};return t&&(u.state=c),u};ho.test=(n,e,t,{glob:r,posix:o}={})=>{if(typeof n!="string")throw new TypeError("Expected input to be a string");if(n==="")return{isMatch:!1,output:""};let s=t||{},a=s.format||(o?mbe.toPosixSlashes:null),c=n===r,l=c&&a?a(n):n;return c===!1&&(l=a?a(n):n,c=l===r),(c===!1||s.capture===!0)&&(s.matchBase===!0||s.basename===!0?c=ho.matchBase(n,e,t,o):c=e.exec(l)),{isMatch:!!c,match:c,output:l}};ho.matchBase=(n,e,t)=>(e instanceof RegExp?e:ho.makeRe(e,t)).test(mbe.basename(n));ho.isMatch=(n,e,t)=>ho(e,t)(n);ho.parse=(n,e)=>Array.isArray(n)?n.map(t=>ho.parse(t,e)):pX(n,{...e,fastpaths:!1});ho.scan=(n,e)=>iYe(n,e);ho.compileRe=(n,e,t=!1,r=!1)=>{if(t===!0)return n.output;let o=e||{},s=o.contains?"":"^",a=o.contains?"":"$",c=`${s}(?:${n.output})${a}`;n&&n.negated===!0&&(c=`^(?!${c}).*$`);let l=ho.toRegex(c,e);return r===!0&&(l.state=n),l};ho.makeRe=(n,e={},t=!1,r=!1)=>{if(!n||typeof n!="string")throw new TypeError("Expected a non-empty string");let o={negated:!1,fastpaths:!0};return e.fastpaths!==!1&&(n[0]==="."||n[0]==="*")&&(o.output=pX.fastpaths(n,e)),o.output||(o=pX(n,e)),ho.compileRe(o,e,t,r)};ho.toRegex=(n,e)=>{try{let t=e||{};return new RegExp(n,t.flags||(t.nocase?"i":""))}catch(t){if(e&&e.debug===!0)throw t;return/$^/}};ho.constants=oYe;hbe.exports=ho});var vbe=P((AGt,sf)=>{"use strict";var aYe=require("os"),hh=gbe(),cYe=aYe.platform()==="win32";function lYe(n,e,t=!1){return e&&(e.windows===null||e.windows===void 0)&&(e={...e,windows:cYe}),hh(n,e,t)}sf.exports=lYe;sf.exports.test=hh.test;sf.exports.matchBase=hh.matchBase;sf.exports.isMatch=hh.isMatch;sf.exports.parse=hh.parse;sf.exports.scan=hh.scan;sf.exports.compileRe=hh.compileRe;sf.exports.toRegex=hh.toRegex;sf.exports.makeRe=hh.makeRe});var Ibe=P(p0=>{"use strict";var uYe=p0&&p0.__awaiter||function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function c(d){try{u(r.next(d))}catch(p){a(p)}}function l(d){try{u(r.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((r=r.apply(n,e||[])).next())})};Object.defineProperty(p0,"__esModule",{value:!0});p0.isBinaryFileSync=p0.isBinaryFile=void 0;var d0=require("fs"),xX=require("util"),dYe=xX.promisify(d0.stat),pYe=xX.promisify(d0.open),fYe=xX.promisify(d0.close),GD=512,_X=class{constructor(e,t){this.fileBuffer=e,this.size=t,this.offset=0,this.error=!1}hasError(){return this.error}nextByte(){return this.offset===this.size||this.hasError()?(this.error=!0,255):this.fileBuffer[this.offset++]}next(e){let t=new Array;for(let r=0;r<e;r++)t[r]=this.nextByte();return t}};function bX(n){let e=0,t=0;for(;!n.hasError();){let r=n.nextByte();if(t=t|(r&127)<<7*e,!(r&128))break;e++}return t}function mYe(n){switch(bX(n)&7){case 0:return bX(n),!0;case 1:return n.next(8),!0;case 2:let r=bX(n);return n.next(r),!0;case 5:return n.next(4),!0}return!1}function hYe(n,e){let t=new _X(n,e),r=0;for(;;){if(!mYe(t)&&!t.hasError())return!1;if(t.hasError())break;r++}return r>0}function gYe(n,e){return uYe(this,void 0,void 0,function*(){if(xbe(n)){let t=yield dYe(n);Sbe(t);let r=yield pYe(n,"r"),o=Buffer.alloc(GD);return new Promise((s,a)=>{d0.read(r,o,0,GD,0,(c,l,u)=>{fYe(r),c?a(c):s(m8(o,l))})})}else return e===void 0&&(e=n.length),m8(n,e)})}p0.isBinaryFile=gYe;function vYe(n,e){if(xbe(n)){let t=d0.statSync(n);Sbe(t);let r=d0.openSync(n,"r"),o=Buffer.alloc(GD),s=d0.readSync(r,o,0,GD,0);return d0.closeSync(r),m8(o,s)}else return e===void 0&&(e=n.length),m8(n,e)}p0.isBinaryFileSync=vYe;function m8(n,e){if(e===0)return!1;let t=0,r=Math.min(e,GD);if(e>=3&&n[0]===239&&n[1]===187&&n[2]===191||e>=4&&n[0]===0&&n[1]===0&&n[2]===254&&n[3]===255||e>=4&&n[0]===255&&n[1]===254&&n[2]===0&&n[3]===0||e>=4&&n[0]===132&&n[1]===49&&n[2]===149&&n[3]===51)return!1;if(r>=5&&n.slice(0,5).toString()==="%PDF-")return!0;if(e>=2&&n[0]===254&&n[1]===255||e>=2&&n[0]===255&&n[1]===254)return!1;for(let o=0;o<r;o++){if(n[o]===0)return!0;if((n[o]<7||n[o]>14)&&(n[o]<32||n[o]>127)){if(n[o]>193&&n[o]<224&&o+1<r){if(o++,n[o]>127&&n[o]<192)continue}else if(n[o]>223&&n[o]<240&&o+2<r&&(o++,n[o]>127&&n[o]<192&&n[o+1]>127&&n[o+1]<192)){o++;continue}if(t++,o>=32&&t*100/r>10)return!0}}return!!(t*100/r>10||t>1&&hYe(n,r))}function xbe(n){return typeof n=="string"}function Sbe(n){if(!n.isFile())throw new Error("Path provided was not a file!")}});var pr=P(Qs=>{"use strict";var XJ=Symbol.for("yaml.alias"),Pxe=Symbol.for("yaml.document"),F9=Symbol.for("yaml.map"),Axe=Symbol.for("yaml.pair"),JJ=Symbol.for("yaml.scalar"),U9=Symbol.for("yaml.seq"),Ah=Symbol.for("yaml.node.type"),NXe=n=>!!n&&typeof n=="object"&&n[Ah]===XJ,LXe=n=>!!n&&typeof n=="object"&&n[Ah]===Pxe,OXe=n=>!!n&&typeof n=="object"&&n[Ah]===F9,MXe=n=>!!n&&typeof n=="object"&&n[Ah]===Axe,Dxe=n=>!!n&&typeof n=="object"&&n[Ah]===JJ,FXe=n=>!!n&&typeof n=="object"&&n[Ah]===U9;function Nxe(n){if(n&&typeof n=="object")switch(n[Ah]){case F9:case U9:return!0}return!1}function UXe(n){if(n&&typeof n=="object")switch(n[Ah]){case XJ:case F9:case JJ:case U9:return!0}return!1}var BXe=n=>(Dxe(n)||Nxe(n))&&!!n.anchor;Qs.ALIAS=XJ;Qs.DOC=Pxe;Qs.MAP=F9;Qs.NODE_TYPE=Ah;Qs.PAIR=Axe;Qs.SCALAR=JJ;Qs.SEQ=U9;Qs.hasAnchor=BXe;Qs.isAlias=NXe;Qs.isCollection=Nxe;Qs.isDocument=LXe;Qs.isMap=OXe;Qs.isNode=UXe;Qs.isPair=MXe;Qs.isScalar=Dxe;Qs.isSeq=FXe});var XN=P(ZJ=>{"use strict";var es=pr(),Oc=Symbol("break visit"),Lxe=Symbol("skip children"),Sf=Symbol("remove node");function B9(n,e){let t=Oxe(e);es.isDocument(n)?EE(null,n.contents,t,Object.freeze([n]))===Sf&&(n.contents=null):EE(null,n,t,Object.freeze([]))}B9.BREAK=Oc;B9.SKIP=Lxe;B9.REMOVE=Sf;function EE(n,e,t,r){let o=Mxe(n,e,t,r);if(es.isNode(o)||es.isPair(o))return Fxe(n,r,o),EE(n,o,t,r);if(typeof o!="symbol"){if(es.isCollection(e)){r=Object.freeze(r.concat(e));for(let s=0;s<e.items.length;++s){let a=EE(s,e.items[s],t,r);if(typeof a=="number")s=a-1;else{if(a===Oc)return Oc;a===Sf&&(e.items.splice(s,1),s-=1)}}}else if(es.isPair(e)){r=Object.freeze(r.concat(e));let s=EE("key",e.key,t,r);if(s===Oc)return Oc;s===Sf&&(e.key=null);let a=EE("value",e.value,t,r);if(a===Oc)return Oc;a===Sf&&(e.value=null)}}return o}async function q9(n,e){let t=Oxe(e);es.isDocument(n)?await wE(null,n.contents,t,Object.freeze([n]))===Sf&&(n.contents=null):await wE(null,n,t,Object.freeze([]))}q9.BREAK=Oc;q9.SKIP=Lxe;q9.REMOVE=Sf;async function wE(n,e,t,r){let o=await Mxe(n,e,t,r);if(es.isNode(o)||es.isPair(o))return Fxe(n,r,o),wE(n,o,t,r);if(typeof o!="symbol"){if(es.isCollection(e)){r=Object.freeze(r.concat(e));for(let s=0;s<e.items.length;++s){let a=await wE(s,e.items[s],t,r);if(typeof a=="number")s=a-1;else{if(a===Oc)return Oc;a===Sf&&(e.items.splice(s,1),s-=1)}}}else if(es.isPair(e)){r=Object.freeze(r.concat(e));let s=await wE("key",e.key,t,r);if(s===Oc)return Oc;s===Sf&&(e.key=null);let a=await wE("value",e.value,t,r);if(a===Oc)return Oc;a===Sf&&(e.value=null)}}return o}function Oxe(n){return typeof n=="object"&&(n.Collection||n.Node||n.Value)?Object.assign({Alias:n.Node,Map:n.Node,Scalar:n.Node,Seq:n.Node},n.Value&&{Map:n.Value,Scalar:n.Value,Seq:n.Value},n.Collection&&{Map:n.Collection,Seq:n.Collection},n):n}function Mxe(n,e,t,r){if(typeof t=="function")return t(n,e,r);if(es.isMap(e))return t.Map?.(n,e,r);if(es.isSeq(e))return t.Seq?.(n,e,r);if(es.isPair(e))return t.Pair?.(n,e,r);if(es.isScalar(e))return t.Scalar?.(n,e,r);if(es.isAlias(e))return t.Alias?.(n,e,r)}function Fxe(n,e,t){let r=e[e.length-1];if(es.isCollection(r))r.items[n]=t;else if(es.isPair(r))n==="key"?r.key=t:r.value=t;else if(es.isDocument(r))r.contents=t;else{let o=es.isAlias(r)?"alias":"scalar";throw new Error(`Cannot replace node with ${o} parent`)}}ZJ.visit=B9;ZJ.visitAsync=q9});var eZ=P(Bxe=>{"use strict";var Uxe=pr(),qXe=XN(),jXe={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},HXe=n=>n.replace(/[!,[\]{}]/g,e=>jXe[e]),JN=class n{constructor(e,t){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},n.defaultYaml,e),this.tags=Object.assign({},n.defaultTags,t)}clone(){let e=new n(this.yaml,this.tags);return e.docStart=this.docStart,e}atDocument(){let e=new n(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:n.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},n.defaultTags);break}return e}add(e,t){this.atNextDocument&&(this.yaml={explicit:n.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},n.defaultTags),this.atNextDocument=!1);let r=e.trim().split(/[ \t]+/),o=r.shift();switch(o){case"%TAG":{if(r.length!==2&&(t(0,"%TAG directive should contain exactly two parts"),r.length<2))return!1;let[s,a]=r;return this.tags[s]=a,!0}case"%YAML":{if(this.yaml.explicit=!0,r.length!==1)return t(0,"%YAML directive should contain exactly one part"),!1;let[s]=r;if(s==="1.1"||s==="1.2")return this.yaml.version=s,!0;{let a=/^\d+\.\d+$/.test(s);return t(6,`Unsupported YAML version ${s}`,a),!1}}default:return t(0,`Unknown directive ${o}`,!0),!1}}tagName(e,t){if(e==="!")return"!";if(e[0]!=="!")return t(`Not a valid tag: ${e}`),null;if(e[1]==="<"){let a=e.slice(2,-1);return a==="!"||a==="!!"?(t(`Verbatim tags aren't resolved, so ${e} is invalid.`),null):(e[e.length-1]!==">"&&t("Verbatim tags must end with a >"),a)}let[,r,o]=e.match(/^(.*!)([^!]*)$/s);o||t(`The ${e} tag has no suffix`);let s=this.tags[r];if(s)try{return s+decodeURIComponent(o)}catch(a){return t(String(a)),null}return r==="!"?e:(t(`Could not resolve tag: ${e}`),null)}tagString(e){for(let[t,r]of Object.entries(this.tags))if(e.startsWith(r))return t+HXe(e.substring(r.length));return e[0]==="!"?e:`!<${e}>`}toString(e){let t=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],r=Object.entries(this.tags),o;if(e&&r.length>0&&Uxe.isNode(e.contents)){let s={};qXe.visit(e.contents,(a,c)=>{Uxe.isNode(c)&&c.tag&&(s[c.tag]=!0)}),o=Object.keys(s)}else o=[];for(let[s,a]of r)s==="!!"&&a==="tag:yaml.org,2002:"||(!e||o.some(c=>c.startsWith(a)))&&t.push(`%TAG ${s} ${a}`);return t.join(`
`)}};JN.defaultYaml={explicit:!1,version:"1.2"};JN.defaultTags={"!!":"tag:yaml.org,2002:"};Bxe.Directives=JN});var j9=P(ZN=>{"use strict";var qxe=pr(),VXe=XN();function GXe(n){if(/[\x00-\x19\s,[\]{}]/.test(n)){let t=`Anchor must not contain whitespace or control characters: ${JSON.stringify(n)}`;throw new Error(t)}return!0}function jxe(n){let e=new Set;return VXe.visit(n,{Value(t,r){r.anchor&&e.add(r.anchor)}}),e}function Hxe(n,e){for(let t=1;;++t){let r=`${n}${t}`;if(!e.has(r))return r}}function zXe(n,e){let t=[],r=new Map,o=null;return{onAnchor:s=>{t.push(s),o||(o=jxe(n));let a=Hxe(e,o);return o.add(a),a},setAnchors:()=>{for(let s of t){let a=r.get(s);if(typeof a=="object"&&a.anchor&&(qxe.isScalar(a.node)||qxe.isCollection(a.node)))a.node.anchor=a.anchor;else{let c=new Error("Failed to resolve repeated object (this should not happen)");throw c.source=s,c}}},sourceObjects:r}}ZN.anchorIsValid=GXe;ZN.anchorNames=jxe;ZN.createNodeAnchors=zXe;ZN.findNewAnchor=Hxe});var tZ=P(Vxe=>{"use strict";function eL(n,e,t,r){if(r&&typeof r=="object")if(Array.isArray(r))for(let o=0,s=r.length;o<s;++o){let a=r[o],c=eL(n,r,String(o),a);c===void 0?delete r[o]:c!==a&&(r[o]=c)}else if(r instanceof Map)for(let o of Array.from(r.keys())){let s=r.get(o),a=eL(n,r,o,s);a===void 0?r.delete(o):a!==s&&r.set(o,a)}else if(r instanceof Set)for(let o of Array.from(r)){let s=eL(n,r,o,o);s===void 0?r.delete(o):s!==o&&(r.delete(o),r.add(s))}else for(let[o,s]of Object.entries(r)){let a=eL(n,r,o,s);a===void 0?delete r[o]:a!==s&&(r[o]=a)}return n.call(e,t,r)}Vxe.applyReviver=eL});var X0=P(zxe=>{"use strict";var $Xe=pr();function Gxe(n,e,t){if(Array.isArray(n))return n.map((r,o)=>Gxe(r,String(o),t));if(n&&typeof n.toJSON=="function"){if(!t||!$Xe.hasAnchor(n))return n.toJSON(e,t);let r={aliasCount:0,count:1,res:void 0};t.anchors.set(n,r),t.onCreate=s=>{r.res=s,delete t.onCreate};let o=n.toJSON(e,t);return t.onCreate&&t.onCreate(o),o}return typeof n=="bigint"&&!t?.keep?Number(n):n}zxe.toJS=Gxe});var H9=P(Wxe=>{"use strict";var WXe=tZ(),$xe=pr(),KXe=X0(),nZ=class{constructor(e){Object.defineProperty(this,$xe.NODE_TYPE,{value:e})}clone(){let e=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(e.range=this.range.slice()),e}toJS(e,{mapAsMap:t,maxAliasCount:r,onAnchor:o,reviver:s}={}){if(!$xe.isDocument(e))throw new TypeError("A document argument is required");let a={anchors:new Map,doc:e,keep:!0,mapAsMap:t===!0,mapKeyWarned:!1,maxAliasCount:typeof r=="number"?r:100},c=KXe.toJS(this,"",a);if(typeof o=="function")for(let{count:l,res:u}of a.anchors.values())o(u,l);return typeof s=="function"?WXe.applyReviver(s,{"":c},"",c):c}};Wxe.NodeBase=nZ});var tL=P(Yxe=>{"use strict";var YXe=j9(),Kxe=XN(),V9=pr(),QXe=H9(),XXe=X0(),rZ=class extends QXe.NodeBase{constructor(e){super(V9.ALIAS),this.source=e,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(e){let t;return Kxe.visit(e,{Node:(r,o)=>{if(o===this)return Kxe.visit.BREAK;o.anchor===this.source&&(t=o)}}),t}toJSON(e,t){if(!t)return{source:this.source};let{anchors:r,doc:o,maxAliasCount:s}=t,a=this.resolve(o);if(!a){let l=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(l)}let c=r.get(a);if(c||(XXe.toJS(a,null,t),c=r.get(a)),!c||c.res===void 0){let l="This should not happen: Alias anchor was not resolved?";throw new ReferenceError(l)}if(s>=0&&(c.count+=1,c.aliasCount===0&&(c.aliasCount=G9(o,a,r)),c.count*c.aliasCount>s)){let l="Excessive alias count indicates a resource exhaustion attack";throw new ReferenceError(l)}return c.res}toString(e,t,r){let o=`*${this.source}`;if(e){if(YXe.anchorIsValid(this.source),e.options.verifyAliasOrder&&!e.anchors.has(this.source)){let s=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(s)}if(e.implicitKey)return`${o} `}return o}};function G9(n,e,t){if(V9.isAlias(e)){let r=e.resolve(n),o=t&&r&&t.get(r);return o?o.count*o.aliasCount:0}else if(V9.isCollection(e)){let r=0;for(let o of e.items){let s=G9(n,o,t);s>r&&(r=s)}return r}else if(V9.isPair(e)){let r=G9(n,e.key,t),o=G9(n,e.value,t);return Math.max(r,o)}return 1}Yxe.Alias=rZ});var Uo=P(iZ=>{"use strict";var JXe=pr(),ZXe=H9(),eJe=X0(),tJe=n=>!n||typeof n!="function"&&typeof n!="object",J0=class extends ZXe.NodeBase{constructor(e){super(JXe.SCALAR),this.value=e}toJSON(e,t){return t?.keep?this.value:eJe.toJS(this.value,e,t)}toString(){return String(this.value)}};J0.BLOCK_FOLDED="BLOCK_FOLDED";J0.BLOCK_LITERAL="BLOCK_LITERAL";J0.PLAIN="PLAIN";J0.QUOTE_DOUBLE="QUOTE_DOUBLE";J0.QUOTE_SINGLE="QUOTE_SINGLE";iZ.Scalar=J0;iZ.isScalarValue=tJe});var nL=P(Xxe=>{"use strict";var nJe=tL(),Ux=pr(),Qxe=Uo(),rJe="tag:yaml.org,2002:";function iJe(n,e,t){if(e){let r=t.filter(s=>s.tag===e),o=r.find(s=>!s.format)??r[0];if(!o)throw new Error(`Tag ${e} not found`);return o}return t.find(r=>r.identify?.(n)&&!r.format)}function oJe(n,e,t){if(Ux.isDocument(n)&&(n=n.contents),Ux.isNode(n))return n;if(Ux.isPair(n)){let p=t.schema[Ux.MAP].createNode?.(t.schema,null,t);return p.items.push(n),p}(n instanceof String||n instanceof Number||n instanceof Boolean||typeof BigInt<"u"&&n instanceof BigInt)&&(n=n.valueOf());let{aliasDuplicateObjects:r,onAnchor:o,onTagObj:s,schema:a,sourceObjects:c}=t,l;if(r&&n&&typeof n=="object"){if(l=c.get(n),l)return l.anchor||(l.anchor=o(n)),new nJe.Alias(l.anchor);l={anchor:null,node:null},c.set(n,l)}e?.startsWith("!!")&&(e=rJe+e.slice(2));let u=iJe(n,e,a.tags);if(!u){if(n&&typeof n.toJSON=="function"&&(n=n.toJSON()),!n||typeof n!="object"){let p=new Qxe.Scalar(n);return l&&(l.node=p),p}u=n instanceof Map?a[Ux.MAP]:Symbol.iterator in Object(n)?a[Ux.SEQ]:a[Ux.MAP]}s&&(s(u),delete t.onTagObj);let d=u?.createNode?u.createNode(t.schema,n,t):typeof u?.nodeClass?.from=="function"?u.nodeClass.from(t.schema,n,t):new Qxe.Scalar(n);return e?d.tag=e:u.default||(d.tag=u.tag),l&&(l.node=d),d}Xxe.createNode=oJe});var $9=P(z9=>{"use strict";var sJe=nL(),If=pr(),aJe=H9();function oZ(n,e,t){let r=t;for(let o=e.length-1;o>=0;--o){let s=e[o];if(typeof s=="number"&&Number.isInteger(s)&&s>=0){let a=[];a[s]=r,r=a}else r=new Map([[s,r]])}return sJe.createNode(r,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:n,sourceObjects:new Map})}var Jxe=n=>n==null||typeof n=="object"&&!!n[Symbol.iterator]().next().done,sZ=class extends aJe.NodeBase{constructor(e,t){super(e),Object.defineProperty(this,"schema",{value:t,configurable:!0,enumerable:!1,writable:!0})}clone(e){let t=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return e&&(t.schema=e),t.items=t.items.map(r=>If.isNode(r)||If.isPair(r)?r.clone(e):r),this.range&&(t.range=this.range.slice()),t}addIn(e,t){if(Jxe(e))this.add(t);else{let[r,...o]=e,s=this.get(r,!0);if(If.isCollection(s))s.addIn(o,t);else if(s===void 0&&this.schema)this.set(r,oZ(this.schema,o,t));else throw new Error(`Expected YAML collection at ${r}. Remaining path: ${o}`)}}deleteIn(e){let[t,...r]=e;if(r.length===0)return this.delete(t);let o=this.get(t,!0);if(If.isCollection(o))return o.deleteIn(r);throw new Error(`Expected YAML collection at ${t}. Remaining path: ${r}`)}getIn(e,t){let[r,...o]=e,s=this.get(r,!0);return o.length===0?!t&&If.isScalar(s)?s.value:s:If.isCollection(s)?s.getIn(o,t):void 0}hasAllNullValues(e){return this.items.every(t=>{if(!If.isPair(t))return!1;let r=t.value;return r==null||e&&If.isScalar(r)&&r.value==null&&!r.commentBefore&&!r.comment&&!r.tag})}hasIn(e){let[t,...r]=e;if(r.length===0)return this.has(t);let o=this.get(t,!0);return If.isCollection(o)?o.hasIn(r):!1}setIn(e,t){let[r,...o]=e;if(o.length===0)this.set(r,t);else{let s=this.get(r,!0);if(If.isCollection(s))s.setIn(o,t);else if(s===void 0&&this.schema)this.set(r,oZ(this.schema,o,t));else throw new Error(`Expected YAML collection at ${r}. Remaining path: ${o}`)}}};z9.Collection=sZ;z9.collectionFromPath=oZ;z9.isEmptyPath=Jxe});var rL=P(W9=>{"use strict";var cJe=n=>n.replace(/^(?!$)(?: $)?/gm,"#");function aZ(n,e){return/^\n+$/.test(n)?n.substring(1):e?n.replace(/^(?! *$)/gm,e):n}var lJe=(n,e,t)=>n.endsWith(`
`)?aZ(t,e):t.includes(`
`)?`
`+aZ(t,e):(n.endsWith(" ")?"":" ")+t;W9.indentComment=aZ;W9.lineComment=lJe;W9.stringifyComment=cJe});var eSe=P(iL=>{"use strict";var uJe="flow",cZ="block",K9="quoted";function dJe(n,e,t="flow",{indentAtStart:r,lineWidth:o=80,minContentWidth:s=20,onFold:a,onOverflow:c}={}){if(!o||o<0)return n;o<s&&(s=0);let l=Math.max(1+s,1+o-e.length);if(n.length<=l)return n;let u=[],d={},p=o-e.length;typeof r=="number"&&(r>o-Math.max(2,s)?u.push(0):p=o-r);let f,m,h=!1,g=-1,y=-1,b=-1;t===cZ&&(g=Zxe(n,g,e.length),g!==-1&&(p=g+l));for(let x;x=n[g+=1];){if(t===K9&&x==="\\"){switch(y=g,n[g+1]){case"x":g+=3;break;case"u":g+=5;break;case"U":g+=9;break;default:g+=1}b=g}if(x===`
`)t===cZ&&(g=Zxe(n,g,e.length)),p=g+e.length+l,f=void 0;else{if(x===" "&&m&&m!==" "&&m!==`
`&&m!=="	"){let I=n[g+1];I&&I!==" "&&I!==`
`&&I!=="	"&&(f=g)}if(g>=p)if(f)u.push(f),p=f+l,f=void 0;else if(t===K9){for(;m===" "||m==="	";)m=x,x=n[g+=1],h=!0;let I=g>b+1?g-2:y-1;if(d[I])return n;u.push(I),d[I]=!0,p=I+l,f=void 0}else h=!0}m=x}if(h&&c&&c(),u.length===0)return n;a&&a();let _=n.slice(0,u[0]);for(let x=0;x<u.length;++x){let I=u[x],S=u[x+1]||n.length;I===0?_=`
${e}${n.slice(0,S)}`:(t===K9&&d[I]&&(_+=`${n[I]}\\`),_+=`
${e}${n.slice(I+1,S)}`)}return _}function Zxe(n,e,t){let r=e,o=e+1,s=n[o];for(;s===" "||s==="	";)if(e<o+t)s=n[++e];else{do s=n[++e];while(s&&s!==`
`);r=e,o=e+1,s=n[o]}return r}iL.FOLD_BLOCK=cZ;iL.FOLD_FLOW=uJe;iL.FOLD_QUOTED=K9;iL.foldFlowLines=dJe});var sL=P(tSe=>{"use strict";var Tf=Uo(),Z0=eSe(),Q9=(n,e)=>({indentAtStart:e?n.indent.length:n.indentAtStart,lineWidth:n.options.lineWidth,minContentWidth:n.options.minContentWidth}),X9=n=>/^(%|---|\.\.\.)/m.test(n);function pJe(n,e,t){if(!e||e<0)return!1;let r=e-t,o=n.length;if(o<=r)return!1;for(let s=0,a=0;s<o;++s)if(n[s]===`
`){if(s-a>r)return!0;if(a=s+1,o-a<=r)return!1}return!0}function oL(n,e){let t=JSON.stringify(n);if(e.options.doubleQuotedAsJSON)return t;let{implicitKey:r}=e,o=e.options.doubleQuotedMinMultiLineLength,s=e.indent||(X9(n)?"  ":""),a="",c=0;for(let l=0,u=t[l];u;u=t[++l])if(u===" "&&t[l+1]==="\\"&&t[l+2]==="n"&&(a+=t.slice(c,l)+"\\ ",l+=1,c=l,u="\\"),u==="\\")switch(t[l+1]){case"u":{a+=t.slice(c,l);let d=t.substr(l+2,4);switch(d){case"0000":a+="\\0";break;case"0007":a+="\\a";break;case"000b":a+="\\v";break;case"001b":a+="\\e";break;case"0085":a+="\\N";break;case"00a0":a+="\\_";break;case"2028":a+="\\L";break;case"2029":a+="\\P";break;default:d.substr(0,2)==="00"?a+="\\x"+d.substr(2):a+=t.substr(l,6)}l+=5,c=l+1}break;case"n":if(r||t[l+2]==='"'||t.length<o)l+=1;else{for(a+=t.slice(c,l)+`

`;t[l+2]==="\\"&&t[l+3]==="n"&&t[l+4]!=='"';)a+=`
`,l+=2;a+=s,t[l+2]===" "&&(a+="\\"),l+=1,c=l+1}break;default:l+=1}return a=c?a+t.slice(c):t,r?a:Z0.foldFlowLines(a,s,Z0.FOLD_QUOTED,Q9(e,!1))}function lZ(n,e){if(e.options.singleQuote===!1||e.implicitKey&&n.includes(`
`)||/[ \t]\n|\n[ \t]/.test(n))return oL(n,e);let t=e.indent||(X9(n)?"  ":""),r="'"+n.replace(/'/g,"''").replace(/\n+/g,`$&
${t}`)+"'";return e.implicitKey?r:Z0.foldFlowLines(r,t,Z0.FOLD_FLOW,Q9(e,!1))}function kE(n,e){let{singleQuote:t}=e.options,r;if(t===!1)r=oL;else{let o=n.includes('"'),s=n.includes("'");o&&!s?r=lZ:s&&!o?r=oL:r=t?lZ:oL}return r(n,e)}var uZ;try{uZ=new RegExp(`(^|(?<!
))
+(?!
|$)`,"g")}catch{uZ=/\n+(?!\n|$)/g}function Y9({comment:n,type:e,value:t},r,o,s){let{blockQuote:a,commentString:c,lineWidth:l}=r.options;if(!a||/\n[\t ]+$/.test(t)||/^\s*$/.test(t))return kE(t,r);let u=r.indent||(r.forceBlockIndent||X9(t)?"  ":""),d=a==="literal"?!0:a==="folded"||e===Tf.Scalar.BLOCK_FOLDED?!1:e===Tf.Scalar.BLOCK_LITERAL?!0:!pJe(t,l,u.length);if(!t)return d?`|
`:`>
`;let p,f;for(f=t.length;f>0;--f){let w=t[f-1];if(w!==`
`&&w!=="	"&&w!==" ")break}let m=t.substring(f),h=m.indexOf(`
`);h===-1?p="-":t===m||h!==m.length-1?(p="+",s&&s()):p="",m&&(t=t.slice(0,-m.length),m[m.length-1]===`
`&&(m=m.slice(0,-1)),m=m.replace(uZ,`$&${u}`));let g=!1,y,b=-1;for(y=0;y<t.length;++y){let w=t[y];if(w===" ")g=!0;else if(w===`
`)b=y;else break}let _=t.substring(0,b<y?b+1:y);_&&(t=t.substring(_.length),_=_.replace(/\n+/g,`$&${u}`));let I=(d?"|":">")+(g?u?"2":"1":"")+p;if(n&&(I+=" "+c(n.replace(/ ?[\r\n]+/g," ")),o&&o()),d)return t=t.replace(/\n+/g,`$&${u}`),`${I}
${u}${_}${t}${m}`;t=t.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${u}`);let S=Z0.foldFlowLines(`${_}${t}${m}`,u,Z0.FOLD_BLOCK,Q9(r,!0));return`${I}
${u}${S}`}function fJe(n,e,t,r){let{type:o,value:s}=n,{actualString:a,implicitKey:c,indent:l,indentStep:u,inFlow:d}=e;if(c&&s.includes(`
`)||d&&/[[\]{},]/.test(s))return kE(s,e);if(!s||/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(s))return c||d||!s.includes(`
`)?kE(s,e):Y9(n,e,t,r);if(!c&&!d&&o!==Tf.Scalar.PLAIN&&s.includes(`
`))return Y9(n,e,t,r);if(X9(s)){if(l==="")return e.forceBlockIndent=!0,Y9(n,e,t,r);if(c&&l===u)return kE(s,e)}let p=s.replace(/\n+/g,`$&
${l}`);if(a){let f=g=>g.default&&g.tag!=="tag:yaml.org,2002:str"&&g.test?.test(p),{compat:m,tags:h}=e.doc.schema;if(h.some(f)||m?.some(f))return kE(s,e)}return c?p:Z0.foldFlowLines(p,l,Z0.FOLD_FLOW,Q9(e,!1))}function mJe(n,e,t,r){let{implicitKey:o,inFlow:s}=e,a=typeof n.value=="string"?n:Object.assign({},n,{value:String(n.value)}),{type:c}=n;c!==Tf.Scalar.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(a.value)&&(c=Tf.Scalar.QUOTE_DOUBLE);let l=d=>{switch(d){case Tf.Scalar.BLOCK_FOLDED:case Tf.Scalar.BLOCK_LITERAL:return o||s?kE(a.value,e):Y9(a,e,t,r);case Tf.Scalar.QUOTE_DOUBLE:return oL(a.value,e);case Tf.Scalar.QUOTE_SINGLE:return lZ(a.value,e);case Tf.Scalar.PLAIN:return fJe(a,e,t,r);default:return null}},u=l(c);if(u===null){let{defaultKeyType:d,defaultStringType:p}=e.options,f=o&&d||p;if(u=l(f),u===null)throw new Error(`Unsupported default string type ${f}`)}return u}tSe.stringifyString=mJe});var aL=P(dZ=>{"use strict";var hJe=j9(),ey=pr(),gJe=rL(),vJe=sL();function yJe(n,e){let t=Object.assign({blockQuote:!0,commentString:gJe.stringifyComment,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},n.schema.toStringOptions,e),r;switch(t.collectionStyle){case"block":r=!1;break;case"flow":r=!0;break;default:r=null}return{anchors:new Set,doc:n,flowCollectionPadding:t.flowCollectionPadding?" ":"",indent:"",indentStep:typeof t.indent=="number"?" ".repeat(t.indent):"  ",inFlow:r,options:t}}function bJe(n,e){if(e.tag){let o=n.filter(s=>s.tag===e.tag);if(o.length>0)return o.find(s=>s.format===e.format)??o[0]}let t,r;if(ey.isScalar(e)){r=e.value;let o=n.filter(s=>s.identify?.(r));t=o.find(s=>s.format===e.format)??o.find(s=>!s.format)}else r=e,t=n.find(o=>o.nodeClass&&r instanceof o.nodeClass);if(!t){let o=r?.constructor?.name??typeof r;throw new Error(`Tag not resolved for ${o} value`)}return t}function _Je(n,e,{anchors:t,doc:r}){if(!r.directives)return"";let o=[],s=(ey.isScalar(n)||ey.isCollection(n))&&n.anchor;s&&hJe.anchorIsValid(s)&&(t.add(s),o.push(`&${s}`));let a=n.tag?n.tag:e.default?null:e.tag;return a&&o.push(r.directives.tagString(a)),o.join(" ")}function xJe(n,e,t,r){if(ey.isPair(n))return n.toString(e,t,r);if(ey.isAlias(n)){if(e.doc.directives)return n.toString(e);if(e.resolvedAliases?.has(n))throw new TypeError("Cannot stringify circular structure without alias nodes");e.resolvedAliases?e.resolvedAliases.add(n):e.resolvedAliases=new Set([n]),n=n.resolve(e.doc)}let o,s=ey.isNode(n)?n:e.doc.createNode(n,{onTagObj:l=>o=l});o||(o=bJe(e.doc.schema.tags,s));let a=_Je(s,o,e);a.length>0&&(e.indentAtStart=(e.indentAtStart??0)+a.length+1);let c=typeof o.stringify=="function"?o.stringify(s,e,t,r):ey.isScalar(s)?vJe.stringifyString(s,e,t,r):s.toString(e,t,r);return a?ey.isScalar(s)||c[0]==="{"||c[0]==="["?`${a} ${c}`:`${a}
${e.indent}${c}`:c}dZ.createStringifyContext=yJe;dZ.stringify=xJe});var oSe=P(iSe=>{"use strict";var Dh=pr(),nSe=Uo(),rSe=aL(),cL=rL();function SJe({key:n,value:e},t,r,o){let{allNullValues:s,doc:a,indent:c,indentStep:l,options:{commentString:u,indentSeq:d,simpleKeys:p}}=t,f=Dh.isNode(n)&&n.comment||null;if(p){if(f)throw new Error("With simple keys, key nodes cannot have comments");if(Dh.isCollection(n)||!Dh.isNode(n)&&typeof n=="object"){let R="With simple keys, collection cannot be used as a key value";throw new Error(R)}}let m=!p&&(!n||f&&e==null&&!t.inFlow||Dh.isCollection(n)||(Dh.isScalar(n)?n.type===nSe.Scalar.BLOCK_FOLDED||n.type===nSe.Scalar.BLOCK_LITERAL:typeof n=="object"));t=Object.assign({},t,{allNullValues:!1,implicitKey:!m&&(p||!s),indent:c+l});let h=!1,g=!1,y=rSe.stringify(n,t,()=>h=!0,()=>g=!0);if(!m&&!t.inFlow&&y.length>1024){if(p)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");m=!0}if(t.inFlow){if(s||e==null)return h&&r&&r(),y===""?"?":m?`? ${y}`:y}else if(s&&!p||e==null&&m)return y=`? ${y}`,f&&!h?y+=cL.lineComment(y,t.indent,u(f)):g&&o&&o(),y;h&&(f=null),m?(f&&(y+=cL.lineComment(y,t.indent,u(f))),y=`? ${y}
${c}:`):(y=`${y}:`,f&&(y+=cL.lineComment(y,t.indent,u(f))));let b,_,x;Dh.isNode(e)?(b=!!e.spaceBefore,_=e.commentBefore,x=e.comment):(b=!1,_=null,x=null,e&&typeof e=="object"&&(e=a.createNode(e))),t.implicitKey=!1,!m&&!f&&Dh.isScalar(e)&&(t.indentAtStart=y.length+1),g=!1,!d&&l.length>=2&&!t.inFlow&&!m&&Dh.isSeq(e)&&!e.flow&&!e.tag&&!e.anchor&&(t.indent=t.indent.substring(2));let I=!1,S=rSe.stringify(e,t,()=>I=!0,()=>g=!0),w=" ";if(f||b||_){if(w=b?`
`:"",_){let R=u(_);w+=`
${cL.indentComment(R,t.indent)}`}S===""&&!t.inFlow?w===`
`&&(w=`

`):w+=`
${t.indent}`}else if(!m&&Dh.isCollection(e)){let R=S[0],k=S.indexOf(`
`),V=k!==-1,F=t.inFlow??e.flow??e.items.length===0;if(V||!F){let K=!1;if(V&&(R==="&"||R==="!")){let $=S.indexOf(" ");R==="&"&&$!==-1&&$<k&&S[$+1]==="!"&&($=S.indexOf(" ",$+1)),($===-1||k<$)&&(K=!0)}K||(w=`
${t.indent}`)}}else(S===""||S[0]===`
`)&&(w="");return y+=w+S,t.inFlow?I&&r&&r():x&&!I?y+=cL.lineComment(y,t.indent,u(x)):g&&o&&o(),y}iSe.stringifyPair=SJe});var fZ=P(pZ=>{"use strict";function IJe(n,...e){n==="debug"&&console.log(...e)}function TJe(n,e){(n==="debug"||n==="warn")&&(typeof process<"u"&&process.emitWarning?process.emitWarning(e):console.warn(e))}pZ.debug=IJe;pZ.warn=TJe});var gZ=P(aSe=>{"use strict";var CJe=fZ(),EJe=aL(),RE=pr(),wJe=Uo(),mZ=X0(),sSe="<<";function kJe(n,e,{key:t,value:r}){if(n?.doc.schema.merge&&RJe(t))if(r=RE.isAlias(r)?r.resolve(n.doc):r,RE.isSeq(r))for(let o of r.items)hZ(n,e,o);else if(Array.isArray(r))for(let o of r)hZ(n,e,o);else hZ(n,e,r);else{let o=mZ.toJS(t,"",n);if(e instanceof Map)e.set(o,mZ.toJS(r,o,n));else if(e instanceof Set)e.add(o);else{let s=PJe(t,o,n),a=mZ.toJS(r,s,n);s in e?Object.defineProperty(e,s,{value:a,writable:!0,enumerable:!0,configurable:!0}):e[s]=a}}return e}var RJe=n=>n===sSe||RE.isScalar(n)&&n.value===sSe&&(!n.type||n.type===wJe.Scalar.PLAIN);function hZ(n,e,t){let r=n&&RE.isAlias(t)?t.resolve(n.doc):t;if(!RE.isMap(r))throw new Error("Merge sources must be maps or map aliases");let o=r.toJSON(null,n,Map);for(let[s,a]of o)e instanceof Map?e.has(s)||e.set(s,a):e instanceof Set?e.add(s):Object.prototype.hasOwnProperty.call(e,s)||Object.defineProperty(e,s,{value:a,writable:!0,enumerable:!0,configurable:!0});return e}function PJe(n,e,t){if(e===null)return"";if(typeof e!="object")return String(e);if(RE.isNode(n)&&t?.doc){let r=EJe.createStringifyContext(t.doc,{});r.anchors=new Set;for(let s of t.anchors.keys())r.anchors.add(s.anchor);r.inFlow=!0,r.inStringifyKey=!0;let o=n.toString(r);if(!t.mapKeyWarned){let s=JSON.stringify(o);s.length>40&&(s=s.substring(0,36)+'..."'),CJe.warn(t.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${s}. Set mapAsMap: true to use object keys.`),t.mapKeyWarned=!0}return o}return JSON.stringify(e)}aSe.addPairToJSMap=kJe});var ty=P(vZ=>{"use strict";var cSe=nL(),AJe=oSe(),DJe=gZ(),J9=pr();function NJe(n,e,t){let r=cSe.createNode(n,void 0,t),o=cSe.createNode(e,void 0,t);return new Z9(r,o)}var Z9=class n{constructor(e,t=null){Object.defineProperty(this,J9.NODE_TYPE,{value:J9.PAIR}),this.key=e,this.value=t}clone(e){let{key:t,value:r}=this;return J9.isNode(t)&&(t=t.clone(e)),J9.isNode(r)&&(r=r.clone(e)),new n(t,r)}toJSON(e,t){let r=t?.mapAsMap?new Map:{};return DJe.addPairToJSMap(t,r,this)}toString(e,t,r){return e?.doc?AJe.stringifyPair(this,e,t,r):JSON.stringify(this)}};vZ.Pair=Z9;vZ.createPair=NJe});var yZ=P(uSe=>{"use strict";var Bx=pr(),lSe=aL(),eU=rL();function LJe(n,e,t){return(e.inFlow??n.flow?MJe:OJe)(n,e,t)}function OJe({comment:n,items:e},t,{blockItemPrefix:r,flowChars:o,itemIndent:s,onChompKeep:a,onComment:c}){let{indent:l,options:{commentString:u}}=t,d=Object.assign({},t,{indent:s,type:null}),p=!1,f=[];for(let h=0;h<e.length;++h){let g=e[h],y=null;if(Bx.isNode(g))!p&&g.spaceBefore&&f.push(""),tU(t,f,g.commentBefore,p),g.comment&&(y=g.comment);else if(Bx.isPair(g)){let _=Bx.isNode(g.key)?g.key:null;_&&(!p&&_.spaceBefore&&f.push(""),tU(t,f,_.commentBefore,p))}p=!1;let b=lSe.stringify(g,d,()=>y=null,()=>p=!0);y&&(b+=eU.lineComment(b,s,u(y))),p&&y&&(p=!1),f.push(r+b)}let m;if(f.length===0)m=o.start+o.end;else{m=f[0];for(let h=1;h<f.length;++h){let g=f[h];m+=g?`
${l}${g}`:`
`}}return n?(m+=`
`+eU.indentComment(u(n),l),c&&c()):p&&a&&a(),m}function MJe({items:n},e,{flowChars:t,itemIndent:r}){let{indent:o,indentStep:s,flowCollectionPadding:a,options:{commentString:c}}=e;r+=s;let l=Object.assign({},e,{indent:r,inFlow:!0,type:null}),u=!1,d=0,p=[];for(let h=0;h<n.length;++h){let g=n[h],y=null;if(Bx.isNode(g))g.spaceBefore&&p.push(""),tU(e,p,g.commentBefore,!1),g.comment&&(y=g.comment);else if(Bx.isPair(g)){let _=Bx.isNode(g.key)?g.key:null;_&&(_.spaceBefore&&p.push(""),tU(e,p,_.commentBefore,!1),_.comment&&(u=!0));let x=Bx.isNode(g.value)?g.value:null;x?(x.comment&&(y=x.comment),x.commentBefore&&(u=!0)):g.value==null&&_?.comment&&(y=_.comment)}y&&(u=!0);let b=lSe.stringify(g,l,()=>y=null);h<n.length-1&&(b+=","),y&&(b+=eU.lineComment(b,r,c(y))),!u&&(p.length>d||b.includes(`
`))&&(u=!0),p.push(b),d=p.length}let{start:f,end:m}=t;if(p.length===0)return f+m;if(!u){let h=p.reduce((g,y)=>g+y.length+2,2);u=e.options.lineWidth>0&&h>e.options.lineWidth}if(u){let h=f;for(let g of p)h+=g?`
${s}${o}${g}`:`
`;return`${h}
${o}${m}`}else return`${f}${a}${p.join(" ")}${a}${m}`}function tU({indent:n,options:{commentString:e}},t,r,o){if(r&&o&&(r=r.replace(/^\n+/,"")),r){let s=eU.indentComment(e(r),n);t.push(s.trimStart())}}uSe.stringifyCollection=LJe});var ry=P(_Z=>{"use strict";var FJe=yZ(),UJe=gZ(),BJe=$9(),ny=pr(),nU=ty(),qJe=Uo();function lL(n,e){let t=ny.isScalar(e)?e.value:e;for(let r of n)if(ny.isPair(r)&&(r.key===e||r.key===t||ny.isScalar(r.key)&&r.key.value===t))return r}var bZ=class extends BJe.Collection{static get tagName(){return"tag:yaml.org,2002:map"}constructor(e){super(ny.MAP,e),this.items=[]}static from(e,t,r){let{keepUndefined:o,replacer:s}=r,a=new this(e),c=(l,u)=>{if(typeof s=="function")u=s.call(t,l,u);else if(Array.isArray(s)&&!s.includes(l))return;(u!==void 0||o)&&a.items.push(nU.createPair(l,u,r))};if(t instanceof Map)for(let[l,u]of t)c(l,u);else if(t&&typeof t=="object")for(let l of Object.keys(t))c(l,t[l]);return typeof e.sortMapEntries=="function"&&a.items.sort(e.sortMapEntries),a}add(e,t){let r;ny.isPair(e)?r=e:!e||typeof e!="object"||!("key"in e)?r=new nU.Pair(e,e?.value):r=new nU.Pair(e.key,e.value);let o=lL(this.items,r.key),s=this.schema?.sortMapEntries;if(o){if(!t)throw new Error(`Key ${r.key} already set`);ny.isScalar(o.value)&&qJe.isScalarValue(r.value)?o.value.value=r.value:o.value=r.value}else if(s){let a=this.items.findIndex(c=>s(r,c)<0);a===-1?this.items.push(r):this.items.splice(a,0,r)}else this.items.push(r)}delete(e){let t=lL(this.items,e);return t?this.items.splice(this.items.indexOf(t),1).length>0:!1}get(e,t){let o=lL(this.items,e)?.value;return(!t&&ny.isScalar(o)?o.value:o)??void 0}has(e){return!!lL(this.items,e)}set(e,t){this.add(new nU.Pair(e,t),!0)}toJSON(e,t,r){let o=r?new r:t?.mapAsMap?new Map:{};t?.onCreate&&t.onCreate(o);for(let s of this.items)UJe.addPairToJSMap(t,o,s);return o}toString(e,t,r){if(!e)return JSON.stringify(this);for(let o of this.items)if(!ny.isPair(o))throw new Error(`Map items must all be pairs; found ${JSON.stringify(o)} instead`);return!e.allNullValues&&this.hasAllNullValues(!1)&&(e=Object.assign({},e,{allNullValues:!0})),FJe.stringifyCollection(this,e,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:e.indent||"",onChompKeep:r,onComment:t})}};_Z.YAMLMap=bZ;_Z.findPair=lL});var PE=P(pSe=>{"use strict";var jJe=pr(),dSe=ry(),HJe={collection:"map",default:!0,nodeClass:dSe.YAMLMap,tag:"tag:yaml.org,2002:map",resolve(n,e){return jJe.isMap(n)||e("Expected a mapping for this tag"),n},createNode:(n,e,t)=>dSe.YAMLMap.from(n,e,t)};pSe.map=HJe});var iy=P(fSe=>{"use strict";var VJe=nL(),GJe=yZ(),zJe=$9(),iU=pr(),$Je=Uo(),WJe=X0(),xZ=class extends zJe.Collection{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(e){super(iU.SEQ,e),this.items=[]}add(e){this.items.push(e)}delete(e){let t=rU(e);return typeof t!="number"?!1:this.items.splice(t,1).length>0}get(e,t){let r=rU(e);if(typeof r!="number")return;let o=this.items[r];return!t&&iU.isScalar(o)?o.value:o}has(e){let t=rU(e);return typeof t=="number"&&t<this.items.length}set(e,t){let r=rU(e);if(typeof r!="number")throw new Error(`Expected a valid index, not ${e}.`);let o=this.items[r];iU.isScalar(o)&&$Je.isScalarValue(t)?o.value=t:this.items[r]=t}toJSON(e,t){let r=[];t?.onCreate&&t.onCreate(r);let o=0;for(let s of this.items)r.push(WJe.toJS(s,String(o++),t));return r}toString(e,t,r){return e?GJe.stringifyCollection(this,e,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(e.indent||"")+"  ",onChompKeep:r,onComment:t}):JSON.stringify(this)}static from(e,t,r){let{replacer:o}=r,s=new this(e);if(t&&Symbol.iterator in Object(t)){let a=0;for(let c of t){if(typeof o=="function"){let l=t instanceof Set?c:String(a++);c=o.call(t,l,c)}s.items.push(VJe.createNode(c,void 0,r))}}return s}};function rU(n){let e=iU.isScalar(n)?n.value:n;return e&&typeof e=="string"&&(e=Number(e)),typeof e=="number"&&Number.isInteger(e)&&e>=0?e:null}fSe.YAMLSeq=xZ});var AE=P(hSe=>{"use strict";var KJe=pr(),mSe=iy(),YJe={collection:"seq",default:!0,nodeClass:mSe.YAMLSeq,tag:"tag:yaml.org,2002:seq",resolve(n,e){return KJe.isSeq(n)||e("Expected a sequence for this tag"),n},createNode:(n,e,t)=>mSe.YAMLSeq.from(n,e,t)};hSe.seq=YJe});var uL=P(gSe=>{"use strict";var QJe=sL(),XJe={identify:n=>typeof n=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:n=>n,stringify(n,e,t,r){return e=Object.assign({actualString:!0},e),QJe.stringifyString(n,e,t,r)}};gSe.string=XJe});var oU=P(bSe=>{"use strict";var vSe=Uo(),ySe={identify:n=>n==null,createNode:()=>new vSe.Scalar(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new vSe.Scalar(null),stringify:({source:n},e)=>typeof n=="string"&&ySe.test.test(n)?n:e.options.nullStr};bSe.nullTag=ySe});var SZ=P(xSe=>{"use strict";var JJe=Uo(),_Se={identify:n=>typeof n=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:n=>new JJe.Scalar(n[0]==="t"||n[0]==="T"),stringify({source:n,value:e},t){if(n&&_Se.test.test(n)){let r=n[0]==="t"||n[0]==="T";if(e===r)return n}return e?t.options.trueStr:t.options.falseStr}};xSe.boolTag=_Se});var DE=P(SSe=>{"use strict";function ZJe({format:n,minFractionDigits:e,tag:t,value:r}){if(typeof r=="bigint")return String(r);let o=typeof r=="number"?r:Number(r);if(!isFinite(o))return isNaN(o)?".nan":o<0?"-.inf":".inf";let s=JSON.stringify(r);if(!n&&e&&(!t||t==="tag:yaml.org,2002:float")&&/^\d/.test(s)){let a=s.indexOf(".");a<0&&(a=s.length,s+=".");let c=e-(s.length-a-1);for(;c-- >0;)s+="0"}return s}SSe.stringifyNumber=ZJe});var TZ=P(sU=>{"use strict";var eZe=Uo(),IZ=DE(),tZe={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:n=>n.slice(-3).toLowerCase()==="nan"?NaN:n[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:IZ.stringifyNumber},nZe={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:n=>parseFloat(n),stringify(n){let e=Number(n.value);return isFinite(e)?e.toExponential():IZ.stringifyNumber(n)}},rZe={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(n){let e=new eZe.Scalar(parseFloat(n)),t=n.indexOf(".");return t!==-1&&n[n.length-1]==="0"&&(e.minFractionDigits=n.length-t-1),e},stringify:IZ.stringifyNumber};sU.float=rZe;sU.floatExp=nZe;sU.floatNaN=tZe});var EZ=P(cU=>{"use strict";var ISe=DE(),aU=n=>typeof n=="bigint"||Number.isInteger(n),CZ=(n,e,t,{intAsBigInt:r})=>r?BigInt(n):parseInt(n.substring(e),t);function TSe(n,e,t){let{value:r}=n;return aU(r)&&r>=0?t+r.toString(e):ISe.stringifyNumber(n)}var iZe={identify:n=>aU(n)&&n>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(n,e,t)=>CZ(n,2,8,t),stringify:n=>TSe(n,8,"0o")},oZe={identify:aU,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(n,e,t)=>CZ(n,0,10,t),stringify:ISe.stringifyNumber},sZe={identify:n=>aU(n)&&n>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(n,e,t)=>CZ(n,2,16,t),stringify:n=>TSe(n,16,"0x")};cU.int=oZe;cU.intHex=sZe;cU.intOct=iZe});var ESe=P(CSe=>{"use strict";var aZe=PE(),cZe=oU(),lZe=AE(),uZe=uL(),dZe=SZ(),wZ=TZ(),kZ=EZ(),pZe=[aZe.map,lZe.seq,uZe.string,cZe.nullTag,dZe.boolTag,kZ.intOct,kZ.int,kZ.intHex,wZ.floatNaN,wZ.floatExp,wZ.float];CSe.schema=pZe});var RSe=P(kSe=>{"use strict";var fZe=Uo(),mZe=PE(),hZe=AE();function wSe(n){return typeof n=="bigint"||Number.isInteger(n)}var lU=({value:n})=>JSON.stringify(n),gZe=[{identify:n=>typeof n=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:n=>n,stringify:lU},{identify:n=>n==null,createNode:()=>new fZe.Scalar(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:lU},{identify:n=>typeof n=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true|false$/,resolve:n=>n==="true",stringify:lU},{identify:wSe,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(n,e,{intAsBigInt:t})=>t?BigInt(n):parseInt(n,10),stringify:({value:n})=>wSe(n)?n.toString():JSON.stringify(n)},{identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:n=>parseFloat(n),stringify:lU}],vZe={default:!0,tag:"",test:/^/,resolve(n,e){return e(`Unresolved plain scalar ${JSON.stringify(n)}`),n}},yZe=[mZe.map,hZe.seq].concat(gZe,vZe);kSe.schema=yZe});var PZ=P(PSe=>{"use strict";var RZ=Uo(),bZe=sL(),_Ze={identify:n=>n instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(n,e){if(typeof Buffer=="function")return Buffer.from(n,"base64");if(typeof atob=="function"){let t=atob(n.replace(/[\n\r]/g,"")),r=new Uint8Array(t.length);for(let o=0;o<t.length;++o)r[o]=t.charCodeAt(o);return r}else return e("This environment does not support reading binary tags; either Buffer or atob is required"),n},stringify({comment:n,type:e,value:t},r,o,s){let a=t,c;if(typeof Buffer=="function")c=a instanceof Buffer?a.toString("base64"):Buffer.from(a.buffer).toString("base64");else if(typeof btoa=="function"){let l="";for(let u=0;u<a.length;++u)l+=String.fromCharCode(a[u]);c=btoa(l)}else throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(e||(e=RZ.Scalar.BLOCK_LITERAL),e!==RZ.Scalar.QUOTE_DOUBLE){let l=Math.max(r.options.lineWidth-r.indent.length,r.options.minContentWidth),u=Math.ceil(c.length/l),d=new Array(u);for(let p=0,f=0;p<u;++p,f+=l)d[p]=c.substr(f,l);c=d.join(e===RZ.Scalar.BLOCK_LITERAL?`
`:" ")}return bZe.stringifyString({comment:n,type:e,value:c},r,o,s)}};PSe.binary=_Ze});var pU=P(dU=>{"use strict";var uU=pr(),AZ=ty(),xZe=Uo(),SZe=iy();function ASe(n,e){if(uU.isSeq(n))for(let t=0;t<n.items.length;++t){let r=n.items[t];if(!uU.isPair(r)){if(uU.isMap(r)){r.items.length>1&&e("Each pair must have its own sequence indicator");let o=r.items[0]||new AZ.Pair(new xZe.Scalar(null));if(r.commentBefore&&(o.key.commentBefore=o.key.commentBefore?`${r.commentBefore}
${o.key.commentBefore}`:r.commentBefore),r.comment){let s=o.value??o.key;s.comment=s.comment?`${r.comment}
${s.comment}`:r.comment}r=o}n.items[t]=uU.isPair(r)?r:new AZ.Pair(r)}}else e("Expected a sequence for this tag");return n}function DSe(n,e,t){let{replacer:r}=t,o=new SZe.YAMLSeq(n);o.tag="tag:yaml.org,2002:pairs";let s=0;if(e&&Symbol.iterator in Object(e))for(let a of e){typeof r=="function"&&(a=r.call(e,String(s++),a));let c,l;if(Array.isArray(a))if(a.length===2)c=a[0],l=a[1];else throw new TypeError(`Expected [key, value] tuple: ${a}`);else if(a&&a instanceof Object){let u=Object.keys(a);if(u.length===1)c=u[0],l=a[c];else throw new TypeError(`Expected tuple with one key, not ${u.length} keys`)}else c=a;o.items.push(AZ.createPair(c,l,t))}return o}var IZe={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:ASe,createNode:DSe};dU.createPairs=DSe;dU.pairs=IZe;dU.resolvePairs=ASe});var LZ=P(NZ=>{"use strict";var NSe=pr(),DZ=X0(),dL=ry(),TZe=iy(),LSe=pU(),qx=class n extends TZe.YAMLSeq{constructor(){super(),this.add=dL.YAMLMap.prototype.add.bind(this),this.delete=dL.YAMLMap.prototype.delete.bind(this),this.get=dL.YAMLMap.prototype.get.bind(this),this.has=dL.YAMLMap.prototype.has.bind(this),this.set=dL.YAMLMap.prototype.set.bind(this),this.tag=n.tag}toJSON(e,t){if(!t)return super.toJSON(e);let r=new Map;t?.onCreate&&t.onCreate(r);for(let o of this.items){let s,a;if(NSe.isPair(o)?(s=DZ.toJS(o.key,"",t),a=DZ.toJS(o.value,s,t)):s=DZ.toJS(o,"",t),r.has(s))throw new Error("Ordered maps must not include duplicate keys");r.set(s,a)}return r}static from(e,t,r){let o=LSe.createPairs(e,t,r),s=new this;return s.items=o.items,s}};qx.tag="tag:yaml.org,2002:omap";var CZe={collection:"seq",identify:n=>n instanceof Map,nodeClass:qx,default:!1,tag:"tag:yaml.org,2002:omap",resolve(n,e){let t=LSe.resolvePairs(n,e),r=[];for(let{key:o}of t.items)NSe.isScalar(o)&&(r.includes(o.value)?e(`Ordered maps must not include duplicate keys: ${o.value}`):r.push(o.value));return Object.assign(new qx,t)},createNode:(n,e,t)=>qx.from(n,e,t)};NZ.YAMLOMap=qx;NZ.omap=CZe});var BSe=P(OZ=>{"use strict";var OSe=Uo();function MSe({value:n,source:e},t){return e&&(n?FSe:USe).test.test(e)?e:n?t.options.trueStr:t.options.falseStr}var FSe={identify:n=>n===!0,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new OSe.Scalar(!0),stringify:MSe},USe={identify:n=>n===!1,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new OSe.Scalar(!1),stringify:MSe};OZ.falseTag=USe;OZ.trueTag=FSe});var qSe=P(fU=>{"use strict";var EZe=Uo(),MZ=DE(),wZe={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:n=>n.slice(-3).toLowerCase()==="nan"?NaN:n[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:MZ.stringifyNumber},kZe={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:n=>parseFloat(n.replace(/_/g,"")),stringify(n){let e=Number(n.value);return isFinite(e)?e.toExponential():MZ.stringifyNumber(n)}},RZe={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(n){let e=new EZe.Scalar(parseFloat(n.replace(/_/g,""))),t=n.indexOf(".");if(t!==-1){let r=n.substring(t+1).replace(/_/g,"");r[r.length-1]==="0"&&(e.minFractionDigits=r.length)}return e},stringify:MZ.stringifyNumber};fU.float=RZe;fU.floatExp=kZe;fU.floatNaN=wZe});var HSe=P(fL=>{"use strict";var jSe=DE(),pL=n=>typeof n=="bigint"||Number.isInteger(n);function mU(n,e,t,{intAsBigInt:r}){let o=n[0];if((o==="-"||o==="+")&&(e+=1),n=n.substring(e).replace(/_/g,""),r){switch(t){case 2:n=`0b${n}`;break;case 8:n=`0o${n}`;break;case 16:n=`0x${n}`;break}let a=BigInt(n);return o==="-"?BigInt(-1)*a:a}let s=parseInt(n,t);return o==="-"?-1*s:s}function FZ(n,e,t){let{value:r}=n;if(pL(r)){let o=r.toString(e);return r<0?"-"+t+o.substr(1):t+o}return jSe.stringifyNumber(n)}var PZe={identify:pL,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(n,e,t)=>mU(n,2,2,t),stringify:n=>FZ(n,2,"0b")},AZe={identify:pL,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(n,e,t)=>mU(n,1,8,t),stringify:n=>FZ(n,8,"0")},DZe={identify:pL,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(n,e,t)=>mU(n,0,10,t),stringify:jSe.stringifyNumber},NZe={identify:pL,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(n,e,t)=>mU(n,2,16,t),stringify:n=>FZ(n,16,"0x")};fL.int=DZe;fL.intBin=PZe;fL.intHex=NZe;fL.intOct=AZe});var BZ=P(UZ=>{"use strict";var vU=pr(),hU=ty(),gU=ry(),jx=class n extends gU.YAMLMap{constructor(e){super(e),this.tag=n.tag}add(e){let t;vU.isPair(e)?t=e:e&&typeof e=="object"&&"key"in e&&"value"in e&&e.value===null?t=new hU.Pair(e.key,null):t=new hU.Pair(e,null),gU.findPair(this.items,t.key)||this.items.push(t)}get(e,t){let r=gU.findPair(this.items,e);return!t&&vU.isPair(r)?vU.isScalar(r.key)?r.key.value:r.key:r}set(e,t){if(typeof t!="boolean")throw new Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof t}`);let r=gU.findPair(this.items,e);r&&!t?this.items.splice(this.items.indexOf(r),1):!r&&t&&this.items.push(new hU.Pair(e))}toJSON(e,t){return super.toJSON(e,t,Set)}toString(e,t,r){if(!e)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},e,{allNullValues:!0}),t,r);throw new Error("Set items must all have null values")}static from(e,t,r){let{replacer:o}=r,s=new this(e);if(t&&Symbol.iterator in Object(t))for(let a of t)typeof o=="function"&&(a=o.call(t,a,a)),s.items.push(hU.createPair(a,null,r));return s}};jx.tag="tag:yaml.org,2002:set";var LZe={collection:"map",identify:n=>n instanceof Set,nodeClass:jx,default:!1,tag:"tag:yaml.org,2002:set",createNode:(n,e,t)=>jx.from(n,e,t),resolve(n,e){if(vU.isMap(n)){if(n.hasAllNullValues(!0))return Object.assign(new jx,n);e("Set items must all have null values")}else e("Expected a mapping for this tag");return n}};UZ.YAMLSet=jx;UZ.set=LZe});var jZ=P(yU=>{"use strict";var OZe=DE();function qZ(n,e){let t=n[0],r=t==="-"||t==="+"?n.substring(1):n,o=a=>e?BigInt(a):Number(a),s=r.replace(/_/g,"").split(":").reduce((a,c)=>a*o(60)+o(c),o(0));return t==="-"?o(-1)*s:s}function VSe(n){let{value:e}=n,t=a=>a;if(typeof e=="bigint")t=a=>BigInt(a);else if(isNaN(e)||!isFinite(e))return OZe.stringifyNumber(n);let r="";e<0&&(r="-",e*=t(-1));let o=t(60),s=[e%o];return e<60?s.unshift(0):(e=(e-s[0])/o,s.unshift(e%o),e>=60&&(e=(e-s[0])/o,s.unshift(e))),r+s.map(a=>String(a).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}var MZe={identify:n=>typeof n=="bigint"||Number.isInteger(n),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(n,e,{intAsBigInt:t})=>qZ(n,t),stringify:VSe},FZe={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:n=>qZ(n,!1),stringify:VSe},GSe={identify:n=>n instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(n){let e=n.match(GSe.test);if(!e)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");let[,t,r,o,s,a,c]=e.map(Number),l=e[7]?Number((e[7]+"00").substr(1,3)):0,u=Date.UTC(t,r-1,o,s||0,a||0,c||0,l),d=e[8];if(d&&d!=="Z"){let p=qZ(d,!1);Math.abs(p)<30&&(p*=60),u-=6e4*p}return new Date(u)},stringify:({value:n})=>n.toISOString().replace(/((T00:00)?:00)?\.000Z$/,"")};yU.floatTime=FZe;yU.intTime=MZe;yU.timestamp=GSe});var WSe=P($Se=>{"use strict";var UZe=PE(),BZe=oU(),qZe=AE(),jZe=uL(),HZe=PZ(),zSe=BSe(),HZ=qSe(),bU=HSe(),VZe=LZ(),GZe=pU(),zZe=BZ(),VZ=jZ(),$Ze=[UZe.map,qZe.seq,jZe.string,BZe.nullTag,zSe.trueTag,zSe.falseTag,bU.intBin,bU.intOct,bU.int,bU.intHex,HZ.floatNaN,HZ.floatExp,HZ.float,HZe.binary,VZe.omap,GZe.pairs,zZe.set,VZ.intTime,VZ.floatTime,VZ.timestamp];$Se.schema=$Ze});var rIe=P($Z=>{"use strict";var XSe=PE(),WZe=oU(),JSe=AE(),KZe=uL(),YZe=SZ(),GZ=TZ(),zZ=EZ(),QZe=ESe(),XZe=RSe(),ZSe=PZ(),eIe=LZ(),tIe=pU(),KSe=WSe(),nIe=BZ(),_U=jZ(),YSe=new Map([["core",QZe.schema],["failsafe",[XSe.map,JSe.seq,KZe.string]],["json",XZe.schema],["yaml11",KSe.schema],["yaml-1.1",KSe.schema]]),QSe={binary:ZSe.binary,bool:YZe.boolTag,float:GZ.float,floatExp:GZ.floatExp,floatNaN:GZ.floatNaN,floatTime:_U.floatTime,int:zZ.int,intHex:zZ.intHex,intOct:zZ.intOct,intTime:_U.intTime,map:XSe.map,null:WZe.nullTag,omap:eIe.omap,pairs:tIe.pairs,seq:JSe.seq,set:nIe.set,timestamp:_U.timestamp},JZe={"tag:yaml.org,2002:binary":ZSe.binary,"tag:yaml.org,2002:omap":eIe.omap,"tag:yaml.org,2002:pairs":tIe.pairs,"tag:yaml.org,2002:set":nIe.set,"tag:yaml.org,2002:timestamp":_U.timestamp};function ZZe(n,e){let t=YSe.get(e);if(!t)if(Array.isArray(n))t=[];else{let r=Array.from(YSe.keys()).filter(o=>o!=="yaml11").map(o=>JSON.stringify(o)).join(", ");throw new Error(`Unknown schema "${e}"; use one of ${r} or define customTags array`)}if(Array.isArray(n))for(let r of n)t=t.concat(r);else typeof n=="function"&&(t=n(t.slice()));return t.map(r=>{if(typeof r!="string")return r;let o=QSe[r];if(o)return o;let s=Object.keys(QSe).map(a=>JSON.stringify(a)).join(", ");throw new Error(`Unknown custom tag "${r}"; use one of ${s}`)})}$Z.coreKnownTags=JZe;$Z.getTags=ZZe});var YZ=P(iIe=>{"use strict";var WZ=pr(),eet=PE(),tet=AE(),net=uL(),xU=rIe(),ret=(n,e)=>n.key<e.key?-1:n.key>e.key?1:0,KZ=class n{constructor({compat:e,customTags:t,merge:r,resolveKnownTags:o,schema:s,sortMapEntries:a,toStringDefaults:c}){this.compat=Array.isArray(e)?xU.getTags(e,"compat"):e?xU.getTags(null,e):null,this.merge=!!r,this.name=typeof s=="string"&&s||"core",this.knownTags=o?xU.coreKnownTags:{},this.tags=xU.getTags(t,this.name),this.toStringOptions=c??null,Object.defineProperty(this,WZ.MAP,{value:eet.map}),Object.defineProperty(this,WZ.SCALAR,{value:net.string}),Object.defineProperty(this,WZ.SEQ,{value:tet.seq}),this.sortMapEntries=typeof a=="function"?a:a===!0?ret:null}clone(){let e=Object.create(n.prototype,Object.getOwnPropertyDescriptors(this));return e.tags=this.tags.slice(),e}};iIe.Schema=KZ});var sIe=P(oIe=>{"use strict";var iet=pr(),QZ=aL(),mL=rL();function oet(n,e){let t=[],r=e.directives===!0;if(e.directives!==!1&&n.directives){let l=n.directives.toString(n);l?(t.push(l),r=!0):n.directives.docStart&&(r=!0)}r&&t.push("---");let o=QZ.createStringifyContext(n,e),{commentString:s}=o.options;if(n.commentBefore){t.length!==1&&t.unshift("");let l=s(n.commentBefore);t.unshift(mL.indentComment(l,""))}let a=!1,c=null;if(n.contents){if(iet.isNode(n.contents)){if(n.contents.spaceBefore&&r&&t.push(""),n.contents.commentBefore){let d=s(n.contents.commentBefore);t.push(mL.indentComment(d,""))}o.forceBlockIndent=!!n.comment,c=n.contents.comment}let l=c?void 0:()=>a=!0,u=QZ.stringify(n.contents,o,()=>c=null,l);c&&(u+=mL.lineComment(u,"",s(c))),(u[0]==="|"||u[0]===">")&&t[t.length-1]==="---"?t[t.length-1]=`--- ${u}`:t.push(u)}else t.push(QZ.stringify(n.contents,o));if(n.directives?.docEnd)if(n.comment){let l=s(n.comment);l.includes(`
`)?(t.push("..."),t.push(mL.indentComment(l,""))):t.push(`... ${l}`)}else t.push("...");else{let l=n.comment;l&&a&&(l=l.replace(/^\n+/,"")),l&&((!a||c)&&t[t.length-1]!==""&&t.push(""),t.push(mL.indentComment(s(l),"")))}return t.join(`
`)+`
`}oIe.stringifyDocument=oet});var hL=P(aIe=>{"use strict";var set=tL(),NE=$9(),yu=pr(),aet=ty(),cet=X0(),uet=YZ(),det=sIe(),XZ=j9(),pet=tZ(),fet=nL(),JZ=eZ(),ZZ=class n{constructor(e,t,r){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,yu.NODE_TYPE,{value:yu.DOC});let o=null;typeof t=="function"||Array.isArray(t)?o=t:r===void 0&&t&&(r=t,t=void 0);let s=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,uniqueKeys:!0,version:"1.2"},r);this.options=s;let{version:a}=s;r?._directives?(this.directives=r._directives.atDocument(),this.directives.yaml.explicit&&(a=this.directives.yaml.version)):this.directives=new JZ.Directives({version:a}),this.setSchema(a,r),this.contents=e===void 0?null:this.createNode(e,o,r)}clone(){let e=Object.create(n.prototype,{[yu.NODE_TYPE]:{value:yu.DOC}});return e.commentBefore=this.commentBefore,e.comment=this.comment,e.errors=this.errors.slice(),e.warnings=this.warnings.slice(),e.options=Object.assign({},this.options),this.directives&&(e.directives=this.directives.clone()),e.schema=this.schema.clone(),e.contents=yu.isNode(this.contents)?this.contents.clone(e.schema):this.contents,this.range&&(e.range=this.range.slice()),e}add(e){LE(this.contents)&&this.contents.add(e)}addIn(e,t){LE(this.contents)&&this.contents.addIn(e,t)}createAlias(e,t){if(!e.anchor){let r=XZ.anchorNames(this);e.anchor=!t||r.has(t)?XZ.findNewAnchor(t||"a",r):t}return new set.Alias(e.anchor)}createNode(e,t,r){let o;if(typeof t=="function")e=t.call({"":e},"",e),o=t;else if(Array.isArray(t)){let y=_=>typeof _=="number"||_ instanceof String||_ instanceof Number,b=t.filter(y).map(String);b.length>0&&(t=t.concat(b)),o=t}else r===void 0&&t&&(r=t,t=void 0);let{aliasDuplicateObjects:s,anchorPrefix:a,flow:c,keepUndefined:l,onTagObj:u,tag:d}=r??{},{onAnchor:p,setAnchors:f,sourceObjects:m}=XZ.createNodeAnchors(this,a||"a"),h={aliasDuplicateObjects:s??!0,keepUndefined:l??!1,onAnchor:p,onTagObj:u,replacer:o,schema:this.schema,sourceObjects:m},g=fet.createNode(e,d,h);return c&&yu.isCollection(g)&&(g.flow=!0),f(),g}createPair(e,t,r={}){let o=this.createNode(e,null,r),s=this.createNode(t,null,r);return new aet.Pair(o,s)}delete(e){return LE(this.contents)?this.contents.delete(e):!1}deleteIn(e){return NE.isEmptyPath(e)?this.contents==null?!1:(this.contents=null,!0):LE(this.contents)?this.contents.deleteIn(e):!1}get(e,t){return yu.isCollection(this.contents)?this.contents.get(e,t):void 0}getIn(e,t){return NE.isEmptyPath(e)?!t&&yu.isScalar(this.contents)?this.contents.value:this.contents:yu.isCollection(this.contents)?this.contents.getIn(e,t):void 0}has(e){return yu.isCollection(this.contents)?this.contents.has(e):!1}hasIn(e){return NE.isEmptyPath(e)?this.contents!==void 0:yu.isCollection(this.contents)?this.contents.hasIn(e):!1}set(e,t){this.contents==null?this.contents=NE.collectionFromPath(this.schema,[e],t):LE(this.contents)&&this.contents.set(e,t)}setIn(e,t){NE.isEmptyPath(e)?this.contents=t:this.contents==null?this.contents=NE.collectionFromPath(this.schema,Array.from(e),t):LE(this.contents)&&this.contents.setIn(e,t)}setSchema(e,t={}){typeof e=="number"&&(e=String(e));let r;switch(e){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new JZ.Directives({version:"1.1"}),r={merge:!0,resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=e:this.directives=new JZ.Directives({version:e}),r={merge:!1,resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,r=null;break;default:{let o=JSON.stringify(e);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${o}`)}}if(t.schema instanceof Object)this.schema=t.schema;else if(r)this.schema=new uet.Schema(Object.assign(r,t));else throw new Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:e,jsonArg:t,mapAsMap:r,maxAliasCount:o,onAnchor:s,reviver:a}={}){let c={anchors:new Map,doc:this,keep:!e,mapAsMap:r===!0,mapKeyWarned:!1,maxAliasCount:typeof o=="number"?o:100},l=cet.toJS(this.contents,t??"",c);if(typeof s=="function")for(let{count:u,res:d}of c.anchors.values())s(d,u);return typeof a=="function"?pet.applyReviver(a,{"":l},"",l):l}toJSON(e,t){return this.toJS({json:!0,jsonArg:e,mapAsMap:!1,onAnchor:t})}toString(e={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in e&&(!Number.isInteger(e.indent)||Number(e.indent)<=0)){let t=JSON.stringify(e.indent);throw new Error(`"indent" option must be a positive integer, not ${t}`)}return det.stringifyDocument(this,e)}};function LE(n){if(yu.isCollection(n))return!0;throw new Error("Expected a YAML collection as document contents")}aIe.Document=ZZ});var yL=P(vL=>{"use strict";var gL=class extends Error{constructor(e,t,r,o){super(),this.name=e,this.code=r,this.message=o,this.pos=t}},eee=class extends gL{constructor(e,t,r){super("YAMLParseError",e,t,r)}},tee=class extends gL{constructor(e,t,r){super("YAMLWarning",e,t,r)}},met=(n,e)=>t=>{if(t.pos[0]===-1)return;t.linePos=t.pos.map(c=>e.linePos(c));let{line:r,col:o}=t.linePos[0];t.message+=` at line ${r}, column ${o}`;let s=o-1,a=n.substring(e.lineStarts[r-1],e.lineStarts[r]).replace(/[\n\r]+$/,"");if(s>=60&&a.length>80){let c=Math.min(s-39,a.length-79);a="\u2026"+a.substring(c),s-=c-1}if(a.length>80&&(a=a.substring(0,79)+"\u2026"),r>1&&/^ *$/.test(a.substring(0,s))){let c=n.substring(e.lineStarts[r-2],e.lineStarts[r-1]);c.length>80&&(c=c.substring(0,79)+`\u2026
`),a=c+a}if(/[^ ]/.test(a)){let c=1,l=t.linePos[1];l&&l.line===r&&l.col>o&&(c=Math.max(1,Math.min(l.col-o,80-s)));let u=" ".repeat(s)+"^".repeat(c);t.message+=`:

${a}
${u}
`}};vL.YAMLError=gL;vL.YAMLParseError=eee;vL.YAMLWarning=tee;vL.prettifyError=met});var bL=P(cIe=>{"use strict";function het(n,{flow:e,indicator:t,next:r,offset:o,onError:s,parentIndent:a,startOnNewline:c}){let l=!1,u=c,d=c,p="",f="",m=!1,h=!1,g=null,y=null,b=null,_=null,x=null,I=null,S=null;for(let k of n)switch(h&&(k.type!=="space"&&k.type!=="newline"&&k.type!=="comma"&&s(k.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),h=!1),g&&(u&&k.type!=="comment"&&k.type!=="newline"&&s(g,"TAB_AS_INDENT","Tabs are not allowed as indentation"),g=null),k.type){case"space":!e&&(t!=="doc-start"||r?.type!=="flow-collection")&&k.source.includes("	")&&(g=k),d=!0;break;case"comment":{d||s(k,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");let V=k.source.substring(1)||" ";p?p+=f+V:p=V,f="",u=!1;break}case"newline":u?p?p+=k.source:l=!0:f+=k.source,u=!0,m=!0,(y||b)&&(_=k),d=!0;break;case"anchor":y&&s(k,"MULTIPLE_ANCHORS","A node can have at most one anchor"),k.source.endsWith(":")&&s(k.offset+k.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),y=k,S===null&&(S=k.offset),u=!1,d=!1,h=!0;break;case"tag":{b&&s(k,"MULTIPLE_TAGS","A node can have at most one tag"),b=k,S===null&&(S=k.offset),u=!1,d=!1,h=!0;break}case t:(y||b)&&s(k,"BAD_PROP_ORDER",`Anchors and tags must be after the ${k.source} indicator`),I&&s(k,"UNEXPECTED_TOKEN",`Unexpected ${k.source} in ${e??"collection"}`),I=k,u=t==="seq-item-ind"||t==="explicit-key-ind",d=!1;break;case"comma":if(e){x&&s(k,"UNEXPECTED_TOKEN",`Unexpected , in ${e}`),x=k,u=!1,d=!1;break}default:s(k,"UNEXPECTED_TOKEN",`Unexpected ${k.type} token`),u=!1,d=!1}let w=n[n.length-1],R=w?w.offset+w.source.length:o;return h&&r&&r.type!=="space"&&r.type!=="newline"&&r.type!=="comma"&&(r.type!=="scalar"||r.source!=="")&&s(r.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),g&&(u&&g.indent<=a||r?.type==="block-map"||r?.type==="block-seq")&&s(g,"TAB_AS_INDENT","Tabs are not allowed as indentation"),{comma:x,found:I,spaceBefore:l,comment:p,hasNewline:m,anchor:y,tag:b,newlineAfterProp:_,end:R,start:S??R}}cIe.resolveProps=het});var SU=P(lIe=>{"use strict";function nee(n){if(!n)return null;switch(n.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(n.source.includes(`
`))return!0;if(n.end){for(let e of n.end)if(e.type==="newline")return!0}return!1;case"flow-collection":for(let e of n.items){for(let t of e.start)if(t.type==="newline")return!0;if(e.sep){for(let t of e.sep)if(t.type==="newline")return!0}if(nee(e.key)||nee(e.value))return!0}return!1;default:return!0}}lIe.containsNewline=nee});var ree=P(uIe=>{"use strict";var get=SU();function vet(n,e,t){if(e?.type==="flow-collection"){let r=e.end[0];r.indent===n&&(r.source==="]"||r.source==="}")&&get.containsNewline(e)&&t(r,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}uIe.flowIndentCheck=vet});var iee=P(pIe=>{"use strict";var dIe=pr();function yet(n,e,t){let{uniqueKeys:r}=n.options;if(r===!1)return!1;let o=typeof r=="function"?r:(s,a)=>s===a||dIe.isScalar(s)&&dIe.isScalar(a)&&s.value===a.value&&!(s.value==="<<"&&n.schema.merge);return e.some(s=>o(s.key,t))}pIe.mapIncludes=yet});var yIe=P(vIe=>{"use strict";var fIe=ty(),bet=ry(),mIe=bL(),_et=SU(),hIe=ree(),xet=iee(),gIe="All mapping items must start at the same column";function Iet({composeNode:n,composeEmptyNode:e},t,r,o,s){let a=s?.nodeClass??bet.YAMLMap,c=new a(t.schema);t.atRoot&&(t.atRoot=!1);let l=r.offset,u=null;for(let d of r.items){let{start:p,key:f,sep:m,value:h}=d,g=mIe.resolveProps(p,{indicator:"explicit-key-ind",next:f??m?.[0],offset:l,onError:o,parentIndent:r.indent,startOnNewline:!0}),y=!g.found;if(y){if(f&&(f.type==="block-seq"?o(l,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in f&&f.indent!==r.indent&&o(l,"BAD_INDENT",gIe)),!g.anchor&&!g.tag&&!m){u=g.end,g.comment&&(c.comment?c.comment+=`
`+g.comment:c.comment=g.comment);continue}(g.newlineAfterProp||_et.containsNewline(f))&&o(f??p[p.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else g.found?.indent!==r.indent&&o(l,"BAD_INDENT",gIe);let b=g.end,_=f?n(t,f,g,o):e(t,b,p,null,g,o);t.schema.compat&&hIe.flowIndentCheck(r.indent,f,o),xet.mapIncludes(t,c.items,_)&&o(b,"DUPLICATE_KEY","Map keys must be unique");let x=mIe.resolveProps(m??[],{indicator:"map-value-ind",next:h,offset:_.range[2],onError:o,parentIndent:r.indent,startOnNewline:!f||f.type==="block-scalar"});if(l=x.end,x.found){y&&(h?.type==="block-map"&&!x.hasNewline&&o(l,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),t.options.strict&&g.start<x.found.offset-1024&&o(_.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));let I=h?n(t,h,x,o):e(t,l,m,null,x,o);t.schema.compat&&hIe.flowIndentCheck(r.indent,h,o),l=I.range[2];let S=new fIe.Pair(_,I);t.options.keepSourceTokens&&(S.srcToken=d),c.items.push(S)}else{y&&o(_.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),x.comment&&(_.comment?_.comment+=`
`+x.comment:_.comment=x.comment);let I=new fIe.Pair(_);t.options.keepSourceTokens&&(I.srcToken=d),c.items.push(I)}}return u&&u<l&&o(u,"IMPOSSIBLE","Map comment with trailing content"),c.range=[r.offset,l,u??l],c}vIe.resolveBlockMap=Iet});var _Ie=P(bIe=>{"use strict";var Tet=iy(),Cet=bL(),Eet=ree();function wet({composeNode:n,composeEmptyNode:e},t,r,o,s){let a=s?.nodeClass??Tet.YAMLSeq,c=new a(t.schema);t.atRoot&&(t.atRoot=!1);let l=r.offset,u=null;for(let{start:d,value:p}of r.items){let f=Cet.resolveProps(d,{indicator:"seq-item-ind",next:p,offset:l,onError:o,parentIndent:r.indent,startOnNewline:!0});if(!f.found)if(f.anchor||f.tag||p)p&&p.type==="block-seq"?o(f.end,"BAD_INDENT","All sequence items must start at the same column"):o(l,"MISSING_CHAR","Sequence item without - indicator");else{u=f.end,f.comment&&(c.comment=f.comment);continue}let m=p?n(t,p,f,o):e(t,f.end,d,null,f,o);t.schema.compat&&Eet.flowIndentCheck(r.indent,p,o),l=m.range[2],c.items.push(m)}return c.range=[r.offset,l,u??l],c}bIe.resolveBlockSeq=wet});var OE=P(xIe=>{"use strict";function ket(n,e,t,r){let o="";if(n){let s=!1,a="";for(let c of n){let{source:l,type:u}=c;switch(u){case"space":s=!0;break;case"comment":{t&&!s&&r(c,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");let d=l.substring(1)||" ";o?o+=a+d:o=d,a="";break}case"newline":o&&(a+=l),s=!0;break;default:r(c,"UNEXPECTED_TOKEN",`Unexpected ${u} at node end`)}e+=l.length}}return{comment:o,offset:e}}xIe.resolveEnd=ket});var CIe=P(TIe=>{"use strict";var Ret=pr(),Pet=ty(),SIe=ry(),Aet=iy(),Det=OE(),IIe=bL(),Net=SU(),Let=iee(),oee="Block collections are not allowed within flow collections",see=n=>n&&(n.type==="block-map"||n.type==="block-seq");function Oet({composeNode:n,composeEmptyNode:e},t,r,o,s){let a=r.start.source==="{",c=a?"flow map":"flow sequence",l=s?.nodeClass??(a?SIe.YAMLMap:Aet.YAMLSeq),u=new l(t.schema);u.flow=!0;let d=t.atRoot;d&&(t.atRoot=!1);let p=r.offset+r.start.source.length;for(let y=0;y<r.items.length;++y){let b=r.items[y],{start:_,key:x,sep:I,value:S}=b,w=IIe.resolveProps(_,{flow:c,indicator:"explicit-key-ind",next:x??I?.[0],offset:p,onError:o,parentIndent:r.indent,startOnNewline:!1});if(!w.found){if(!w.anchor&&!w.tag&&!I&&!S){y===0&&w.comma?o(w.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${c}`):y<r.items.length-1&&o(w.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${c}`),w.comment&&(u.comment?u.comment+=`
`+w.comment:u.comment=w.comment),p=w.end;continue}!a&&t.options.strict&&Net.containsNewline(x)&&o(x,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(y===0)w.comma&&o(w.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${c}`);else if(w.comma||o(w.start,"MISSING_CHAR",`Missing , between ${c} items`),w.comment){let R="";e:for(let k of _)switch(k.type){case"comma":case"space":break;case"comment":R=k.source.substring(1);break e;default:break e}if(R){let k=u.items[u.items.length-1];Ret.isPair(k)&&(k=k.value??k.key),k.comment?k.comment+=`
`+R:k.comment=R,w.comment=w.comment.substring(R.length+1)}}if(!a&&!I&&!w.found){let R=S?n(t,S,w,o):e(t,w.end,I,null,w,o);u.items.push(R),p=R.range[2],see(S)&&o(R.range,"BLOCK_IN_FLOW",oee)}else{let R=w.end,k=x?n(t,x,w,o):e(t,R,_,null,w,o);see(x)&&o(k.range,"BLOCK_IN_FLOW",oee);let V=IIe.resolveProps(I??[],{flow:c,indicator:"map-value-ind",next:S,offset:k.range[2],onError:o,parentIndent:r.indent,startOnNewline:!1});if(V.found){if(!a&&!w.found&&t.options.strict){if(I)for(let $ of I){if($===V.found)break;if($.type==="newline"){o($,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}w.start<V.found.offset-1024&&o(V.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else S&&("source"in S&&S.source&&S.source[0]===":"?o(S,"MISSING_CHAR",`Missing space after : in ${c}`):o(V.start,"MISSING_CHAR",`Missing , or : between ${c} items`));let F=S?n(t,S,V,o):V.found?e(t,V.end,I,null,V,o):null;F?see(S)&&o(F.range,"BLOCK_IN_FLOW",oee):V.comment&&(k.comment?k.comment+=`
`+V.comment:k.comment=V.comment);let K=new Pet.Pair(k,F);if(t.options.keepSourceTokens&&(K.srcToken=b),a){let $=u;Let.mapIncludes(t,$.items,k)&&o(R,"DUPLICATE_KEY","Map keys must be unique"),$.items.push(K)}else{let $=new SIe.YAMLMap(t.schema);$.flow=!0,$.items.push(K),u.items.push($)}p=F?F.range[2]:V.end}}let f=a?"}":"]",[m,...h]=r.end,g=p;if(m&&m.source===f)g=m.offset+m.source.length;else{let y=c[0].toUpperCase()+c.substring(1),b=d?`${y} must end with a ${f}`:`${y} in block collection must be sufficiently indented and end with a ${f}`;o(p,d?"MISSING_CHAR":"BAD_INDENT",b),m&&m.source.length!==1&&h.unshift(m)}if(h.length>0){let y=Det.resolveEnd(h,g,t.options.strict,o);y.comment&&(u.comment?u.comment+=`
`+y.comment:u.comment=y.comment),u.range=[r.offset,g,y.offset]}else u.range=[r.offset,g,g];return u}TIe.resolveFlowCollection=Oet});var wIe=P(EIe=>{"use strict";var Met=pr(),Fet=Uo(),Uet=ry(),Bet=iy(),qet=yIe(),jet=_Ie(),Het=CIe();function aee(n,e,t,r,o,s){let a=t.type==="block-map"?qet.resolveBlockMap(n,e,t,r,s):t.type==="block-seq"?jet.resolveBlockSeq(n,e,t,r,s):Het.resolveFlowCollection(n,e,t,r,s),c=a.constructor;return o==="!"||o===c.tagName?(a.tag=c.tagName,a):(o&&(a.tag=o),a)}function Vet(n,e,t,r,o){let s=r.tag,a=s?e.directives.tagName(s.source,f=>o(s,"TAG_RESOLVE_FAILED",f)):null;if(t.type==="block-seq"){let{anchor:f,newlineAfterProp:m}=r,h=f&&s?f.offset>s.offset?f:s:f??s;h&&(!m||m.offset<h.offset)&&o(h,"MISSING_CHAR","Missing newline after block sequence props")}let c=t.type==="block-map"?"map":t.type==="block-seq"?"seq":t.start.source==="{"?"map":"seq";if(!s||!a||a==="!"||a===Uet.YAMLMap.tagName&&c==="map"||a===Bet.YAMLSeq.tagName&&c==="seq")return aee(n,e,t,o,a);let l=e.schema.tags.find(f=>f.tag===a&&f.collection===c);if(!l){let f=e.schema.knownTags[a];if(f&&f.collection===c)e.schema.tags.push(Object.assign({},f,{default:!1})),l=f;else return f?.collection?o(s,"BAD_COLLECTION_TYPE",`${f.tag} used for ${c} collection, but expects ${f.collection}`,!0):o(s,"TAG_RESOLVE_FAILED",`Unresolved tag: ${a}`,!0),aee(n,e,t,o,a)}let u=aee(n,e,t,o,a,l),d=l.resolve?.(u,f=>o(s,"TAG_RESOLVE_FAILED",f),e.options)??u,p=Met.isNode(d)?d:new Fet.Scalar(d);return p.range=u.range,p.tag=a,l?.format&&(p.format=l.format),p}EIe.composeCollection=Vet});var lee=P(kIe=>{"use strict";var cee=Uo();function Get(n,e,t){let r=e.offset,o=zet(e,n.options.strict,t);if(!o)return{value:"",type:null,comment:"",range:[r,r,r]};let s=o.mode===">"?cee.Scalar.BLOCK_FOLDED:cee.Scalar.BLOCK_LITERAL,a=e.source?$et(e.source):[],c=a.length;for(let g=a.length-1;g>=0;--g){let y=a[g][1];if(y===""||y==="\r")c=g;else break}if(c===0){let g=o.chomp==="+"&&a.length>0?`
`.repeat(Math.max(1,a.length-1)):"",y=r+o.length;return e.source&&(y+=e.source.length),{value:g,type:s,comment:o.comment,range:[r,y,y]}}let l=e.indent+o.indent,u=e.offset+o.length,d=0;for(let g=0;g<c;++g){let[y,b]=a[g];if(b===""||b==="\r")o.indent===0&&y.length>l&&(l=y.length);else{y.length<l&&t(u+y.length,"MISSING_CHAR","Block scalars with more-indented leading empty lines must use an explicit indentation indicator"),o.indent===0&&(l=y.length),d=g,l===0&&!n.atRoot&&t(u,"BAD_INDENT","Block scalar values in collections must be indented");break}u+=y.length+b.length+1}for(let g=a.length-1;g>=c;--g)a[g][0].length>l&&(c=g+1);let p="",f="",m=!1;for(let g=0;g<d;++g)p+=a[g][0].slice(l)+`
`;for(let g=d;g<c;++g){let[y,b]=a[g];u+=y.length+b.length+1;let _=b[b.length-1]==="\r";if(_&&(b=b.slice(0,-1)),b&&y.length<l){let I=`Block scalar lines must not be less indented than their ${o.indent?"explicit indentation indicator":"first line"}`;t(u-b.length-(_?2:1),"BAD_INDENT",I),y=""}s===cee.Scalar.BLOCK_LITERAL?(p+=f+y.slice(l)+b,f=`
`):y.length>l||b[0]==="	"?(f===" "?f=`
`:!m&&f===`
`&&(f=`

`),p+=f+y.slice(l)+b,f=`
`,m=!0):b===""?f===`
`?p+=`
`:f=`
`:(p+=f+b,f=" ",m=!1)}switch(o.chomp){case"-":break;case"+":for(let g=c;g<a.length;++g)p+=`
`+a[g][0].slice(l);p[p.length-1]!==`
`&&(p+=`
`);break;default:p+=`
`}let h=r+o.length+e.source.length;return{value:p,type:s,comment:o.comment,range:[r,h,h]}}function zet({offset:n,props:e},t,r){if(e[0].type!=="block-scalar-header")return r(e[0],"IMPOSSIBLE","Block scalar header not found"),null;let{source:o}=e[0],s=o[0],a=0,c="",l=-1;for(let f=1;f<o.length;++f){let m=o[f];if(!c&&(m==="-"||m==="+"))c=m;else{let h=Number(m);!a&&h?a=h:l===-1&&(l=n+f)}}l!==-1&&r(l,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${o}`);let u=!1,d="",p=o.length;for(let f=1;f<e.length;++f){let m=e[f];switch(m.type){case"space":u=!0;case"newline":p+=m.source.length;break;case"comment":t&&!u&&r(m,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),p+=m.source.length,d=m.source.substring(1);break;case"error":r(m,"UNEXPECTED_TOKEN",m.message),p+=m.source.length;break;default:{let h=`Unexpected token in block scalar header: ${m.type}`;r(m,"UNEXPECTED_TOKEN",h);let g=m.source;g&&typeof g=="string"&&(p+=g.length)}}}return{mode:s,indent:a,chomp:c,comment:d,length:p}}function $et(n){let e=n.split(/\n( *)/),t=e[0],r=t.match(/^( *)/),s=[r?.[1]?[r[1],t.slice(r[1].length)]:["",t]];for(let a=1;a<e.length;a+=2)s.push([e[a],e[a+1]]);return s}kIe.resolveBlockScalar=Get});var dee=P(PIe=>{"use strict";var uee=Uo(),Wet=OE();function Ket(n,e,t){let{offset:r,type:o,source:s,end:a}=n,c,l,u=(f,m,h)=>t(r+f,m,h);switch(o){case"scalar":c=uee.Scalar.PLAIN,l=Yet(s,u);break;case"single-quoted-scalar":c=uee.Scalar.QUOTE_SINGLE,l=Qet(s,u);break;case"double-quoted-scalar":c=uee.Scalar.QUOTE_DOUBLE,l=Xet(s,u);break;default:return t(n,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${o}`),{value:"",type:null,comment:"",range:[r,r+s.length,r+s.length]}}let d=r+s.length,p=Wet.resolveEnd(a,d,e,t);return{value:l,type:c,comment:p.comment,range:[r,d,p.offset]}}function Yet(n,e){let t="";switch(n[0]){case"	":t="a tab character";break;case",":t="flow indicator character ,";break;case"%":t="directive indicator character %";break;case"|":case">":{t=`block scalar indicator ${n[0]}`;break}case"@":case"`":{t=`reserved character ${n[0]}`;break}}return t&&e(0,"BAD_SCALAR_START",`Plain value cannot start with ${t}`),RIe(n)}function Qet(n,e){return(n[n.length-1]!=="'"||n.length===1)&&e(n.length,"MISSING_CHAR","Missing closing 'quote"),RIe(n.slice(1,-1)).replace(/''/g,"'")}function RIe(n){let e,t;try{e=new RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),t=new RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{e=/(.*?)[ \t]*\r?\n/sy,t=/[ \t]*(.*?)[ \t]*\r?\n/sy}let r=e.exec(n);if(!r)return n;let o=r[1],s=" ",a=e.lastIndex;for(t.lastIndex=a;r=t.exec(n);)r[1]===""?s===`
`?o+=s:s=`
`:(o+=s+r[1],s=" "),a=t.lastIndex;let c=/[ \t]*(.*)/sy;return c.lastIndex=a,r=c.exec(n),o+s+(r?.[1]??"")}function Xet(n,e){let t="";for(let r=1;r<n.length-1;++r){let o=n[r];if(!(o==="\r"&&n[r+1]===`
`))if(o===`
`){let{fold:s,offset:a}=Jet(n,r);t+=s,r=a}else if(o==="\\"){let s=n[++r],a=Zet[s];if(a)t+=a;else if(s===`
`)for(s=n[r+1];s===" "||s==="	";)s=n[++r+1];else if(s==="\r"&&n[r+1]===`
`)for(s=n[++r+1];s===" "||s==="	";)s=n[++r+1];else if(s==="x"||s==="u"||s==="U"){let c={x:2,u:4,U:8}[s];t+=ett(n,r+1,c,e),r+=c}else{let c=n.substr(r-1,2);e(r-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${c}`),t+=c}}else if(o===" "||o==="	"){let s=r,a=n[r+1];for(;a===" "||a==="	";)a=n[++r+1];a!==`
`&&!(a==="\r"&&n[r+2]===`
`)&&(t+=r>s?n.slice(s,r+1):o)}else t+=o}return(n[n.length-1]!=='"'||n.length===1)&&e(n.length,"MISSING_CHAR",'Missing closing "quote'),t}function Jet(n,e){let t="",r=n[e+1];for(;(r===" "||r==="	"||r===`
`||r==="\r")&&!(r==="\r"&&n[e+2]!==`
`);)r===`
`&&(t+=`
`),e+=1,r=n[e+1];return t||(t=" "),{fold:t,offset:e}}var Zet={0:"\0",a:"\x07",b:"\b",e:"\x1B",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"\x85",_:"\xA0",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"};function ett(n,e,t,r){let o=n.substr(e,t),a=o.length===t&&/^[0-9a-fA-F]+$/.test(o)?parseInt(o,16):NaN;if(isNaN(a)){let c=n.substr(e-2,t+2);return r(e-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${c}`),c}return String.fromCodePoint(a)}PIe.resolveFlowScalar=Ket});var NIe=P(DIe=>{"use strict";var ME=pr(),AIe=Uo(),ttt=lee(),ntt=dee();function rtt(n,e,t,r){let{value:o,type:s,comment:a,range:c}=e.type==="block-scalar"?ttt.resolveBlockScalar(n,e,r):ntt.resolveFlowScalar(e,n.options.strict,r),l=t?n.directives.tagName(t.source,p=>r(t,"TAG_RESOLVE_FAILED",p)):null,u=t&&l?itt(n.schema,o,l,t,r):e.type==="scalar"?ott(n,o,e,r):n.schema[ME.SCALAR],d;try{let p=u.resolve(o,f=>r(t??e,"TAG_RESOLVE_FAILED",f),n.options);d=ME.isScalar(p)?p:new AIe.Scalar(p)}catch(p){let f=p instanceof Error?p.message:String(p);r(t??e,"TAG_RESOLVE_FAILED",f),d=new AIe.Scalar(o)}return d.range=c,d.source=o,s&&(d.type=s),l&&(d.tag=l),u.format&&(d.format=u.format),a&&(d.comment=a),d}function itt(n,e,t,r,o){if(t==="!")return n[ME.SCALAR];let s=[];for(let c of n.tags)if(!c.collection&&c.tag===t)if(c.default&&c.test)s.push(c);else return c;for(let c of s)if(c.test?.test(e))return c;let a=n.knownTags[t];return a&&!a.collection?(n.tags.push(Object.assign({},a,{default:!1,test:void 0})),a):(o(r,"TAG_RESOLVE_FAILED",`Unresolved tag: ${t}`,t!=="tag:yaml.org,2002:str"),n[ME.SCALAR])}function ott({directives:n,schema:e},t,r,o){let s=e.tags.find(a=>a.default&&a.test?.test(t))||e[ME.SCALAR];if(e.compat){let a=e.compat.find(c=>c.default&&c.test?.test(t))??e[ME.SCALAR];if(s.tag!==a.tag){let c=n.tagString(s.tag),l=n.tagString(a.tag),u=`Value may be parsed as either ${c} or ${l}`;o(r,"TAG_RESOLVE_FAILED",u,!0)}}return s}DIe.composeScalar=rtt});var OIe=P(LIe=>{"use strict";function stt(n,e,t){if(e){t===null&&(t=e.length);for(let r=t-1;r>=0;--r){let o=e[r];switch(o.type){case"space":case"comment":case"newline":n-=o.source.length;continue}for(o=e[++r];o?.type==="space";)n+=o.source.length,o=e[++r];break}}return n}LIe.emptyScalarPosition=stt});var UIe=P(fee=>{"use strict";var att=tL(),ctt=wIe(),MIe=NIe(),ltt=OE(),utt=OIe(),dtt={composeNode:FIe,composeEmptyNode:pee};function FIe(n,e,t,r){let{spaceBefore:o,comment:s,anchor:a,tag:c}=t,l,u=!0;switch(e.type){case"alias":l=ptt(n,e,r),(a||c)&&r(e,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":l=MIe.composeScalar(n,e,c,r),a&&(l.anchor=a.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":l=ctt.composeCollection(dtt,n,e,t,r),a&&(l.anchor=a.source.substring(1));break;default:{let d=e.type==="error"?e.message:`Unsupported token (type: ${e.type})`;r(e,"UNEXPECTED_TOKEN",d),l=pee(n,e.offset,void 0,null,t,r),u=!1}}return a&&l.anchor===""&&r(a,"BAD_ALIAS","Anchor cannot be an empty string"),o&&(l.spaceBefore=!0),s&&(e.type==="scalar"&&e.source===""?l.comment=s:l.commentBefore=s),n.options.keepSourceTokens&&u&&(l.srcToken=e),l}function pee(n,e,t,r,{spaceBefore:o,comment:s,anchor:a,tag:c,end:l},u){let d={type:"scalar",offset:utt.emptyScalarPosition(e,t,r),indent:-1,source:""},p=MIe.composeScalar(n,d,c,u);return a&&(p.anchor=a.source.substring(1),p.anchor===""&&u(a,"BAD_ALIAS","Anchor cannot be an empty string")),o&&(p.spaceBefore=!0),s&&(p.comment=s,p.range[2]=l),p}function ptt({options:n},{offset:e,source:t,end:r},o){let s=new att.Alias(t.substring(1));s.source===""&&o(e,"BAD_ALIAS","Alias cannot be an empty string"),s.source.endsWith(":")&&o(e+t.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);let a=e+t.length,c=ltt.resolveEnd(r,a,n.strict,o);return s.range=[e,a,c.offset],c.comment&&(s.comment=c.comment),s}fee.composeEmptyNode=pee;fee.composeNode=FIe});var jIe=P(qIe=>{"use strict";var ftt=hL(),BIe=UIe(),mtt=OE(),htt=bL();function gtt(n,e,{offset:t,start:r,value:o,end:s},a){let c=Object.assign({_directives:e},n),l=new ftt.Document(void 0,c),u={atRoot:!0,directives:l.directives,options:l.options,schema:l.schema},d=htt.resolveProps(r,{indicator:"doc-start",next:o??s?.[0],offset:t,onError:a,parentIndent:0,startOnNewline:!0});d.found&&(l.directives.docStart=!0,o&&(o.type==="block-map"||o.type==="block-seq")&&!d.hasNewline&&a(d.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),l.contents=o?BIe.composeNode(u,o,d,a):BIe.composeEmptyNode(u,d.end,r,null,d,a);let p=l.contents.range[2],f=mtt.resolveEnd(s,p,!1,a);return f.comment&&(l.comment=f.comment),l.range=[t,p,f.offset],l}qIe.composeDoc=gtt});var hee=P(GIe=>{"use strict";var vtt=eZ(),ytt=hL(),_L=yL(),HIe=pr(),btt=jIe(),_tt=OE();function xL(n){if(typeof n=="number")return[n,n+1];if(Array.isArray(n))return n.length===2?n:[n[0],n[1]];let{offset:e,source:t}=n;return[e,e+(typeof t=="string"?t.length:1)]}function VIe(n){let e="",t=!1,r=!1;for(let o=0;o<n.length;++o){let s=n[o];switch(s[0]){case"#":e+=(e===""?"":r?`

`:`
`)+(s.substring(1)||" "),t=!0,r=!1;break;case"%":n[o+1]?.[0]!=="#"&&(o+=1),t=!1;break;default:t||(r=!0),t=!1}}return{comment:e,afterEmptyLine:r}}var mee=class{constructor(e={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(t,r,o,s)=>{let a=xL(t);s?this.warnings.push(new _L.YAMLWarning(a,r,o)):this.errors.push(new _L.YAMLParseError(a,r,o))},this.directives=new vtt.Directives({version:e.version||"1.2"}),this.options=e}decorate(e,t){let{comment:r,afterEmptyLine:o}=VIe(this.prelude);if(r){let s=e.contents;if(t)e.comment=e.comment?`${e.comment}
${r}`:r;else if(o||e.directives.docStart||!s)e.commentBefore=r;else if(HIe.isCollection(s)&&!s.flow&&s.items.length>0){let a=s.items[0];HIe.isPair(a)&&(a=a.key);let c=a.commentBefore;a.commentBefore=c?`${r}
${c}`:r}else{let a=s.commentBefore;s.commentBefore=a?`${r}
${a}`:r}}t?(Array.prototype.push.apply(e.errors,this.errors),Array.prototype.push.apply(e.warnings,this.warnings)):(e.errors=this.errors,e.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:VIe(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(e,t=!1,r=-1){for(let o of e)yield*this.next(o);yield*this.end(t,r)}*next(e){switch(process.env.LOG_STREAM&&console.dir(e,{depth:null}),e.type){case"directive":this.directives.add(e.source,(t,r,o)=>{let s=xL(e);s[0]+=t,this.onError(s,"BAD_DIRECTIVE",r,o)}),this.prelude.push(e.source),this.atDirectives=!0;break;case"document":{let t=btt.composeDoc(this.options,this.directives,e,this.onError);this.atDirectives&&!t.directives.docStart&&this.onError(e,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(t,!1),this.doc&&(yield this.doc),this.doc=t,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(e.source);break;case"error":{let t=e.source?`${e.message}: ${JSON.stringify(e.source)}`:e.message,r=new _L.YAMLParseError(xL(e),"UNEXPECTED_TOKEN",t);this.atDirectives||!this.doc?this.errors.push(r):this.doc.errors.push(r);break}case"doc-end":{if(!this.doc){let r="Unexpected doc-end without preceding document";this.errors.push(new _L.YAMLParseError(xL(e),"UNEXPECTED_TOKEN",r));break}this.doc.directives.docEnd=!0;let t=_tt.resolveEnd(e.end,e.offset+e.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),t.comment){let r=this.doc.comment;this.doc.comment=r?`${r}
${t.comment}`:t.comment}this.doc.range[2]=t.offset;break}default:this.errors.push(new _L.YAMLParseError(xL(e),"UNEXPECTED_TOKEN",`Unsupported token ${e.type}`))}}*end(e=!1,t=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(e){let r=Object.assign({_directives:this.directives},this.options),o=new ytt.Document(void 0,r);this.atDirectives&&this.onError(t,"MISSING_CHAR","Missing directives-end indicator line"),o.range=[0,t,t],this.decorate(o,!1),yield o}}};GIe.Composer=mee});var WIe=P(IU=>{"use strict";var xtt=lee(),Stt=dee(),Itt=yL(),zIe=sL();function Ttt(n,e=!0,t){if(n){let r=(o,s,a)=>{let c=typeof o=="number"?o:Array.isArray(o)?o[0]:o.offset;if(t)t(c,s,a);else throw new Itt.YAMLParseError([c,c+1],s,a)};switch(n.type){case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return Stt.resolveFlowScalar(n,e,r);case"block-scalar":return xtt.resolveBlockScalar({options:{strict:e}},n,r)}}return null}function Ctt(n,e){let{implicitKey:t=!1,indent:r,inFlow:o=!1,offset:s=-1,type:a="PLAIN"}=e,c=zIe.stringifyString({type:a,value:n},{implicitKey:t,indent:r>0?" ".repeat(r):"",inFlow:o,options:{blockQuote:!0,lineWidth:-1}}),l=e.end??[{type:"newline",offset:-1,indent:r,source:`
`}];switch(c[0]){case"|":case">":{let u=c.indexOf(`
`),d=c.substring(0,u),p=c.substring(u+1)+`
`,f=[{type:"block-scalar-header",offset:s,indent:r,source:d}];return $Ie(f,l)||f.push({type:"newline",offset:-1,indent:r,source:`
`}),{type:"block-scalar",offset:s,indent:r,props:f,source:p}}case'"':return{type:"double-quoted-scalar",offset:s,indent:r,source:c,end:l};case"'":return{type:"single-quoted-scalar",offset:s,indent:r,source:c,end:l};default:return{type:"scalar",offset:s,indent:r,source:c,end:l}}}function Ett(n,e,t={}){let{afterKey:r=!1,implicitKey:o=!1,inFlow:s=!1,type:a}=t,c="indent"in n?n.indent:null;if(r&&typeof c=="number"&&(c+=2),!a)switch(n.type){case"single-quoted-scalar":a="QUOTE_SINGLE";break;case"double-quoted-scalar":a="QUOTE_DOUBLE";break;case"block-scalar":{let u=n.props[0];if(u.type!=="block-scalar-header")throw new Error("Invalid block scalar header");a=u.source[0]===">"?"BLOCK_FOLDED":"BLOCK_LITERAL";break}default:a="PLAIN"}let l=zIe.stringifyString({type:a,value:e},{implicitKey:o||c===null,indent:c!==null&&c>0?" ".repeat(c):"",inFlow:s,options:{blockQuote:!0,lineWidth:-1}});switch(l[0]){case"|":case">":wtt(n,l);break;case'"':gee(n,l,"double-quoted-scalar");break;case"'":gee(n,l,"single-quoted-scalar");break;default:gee(n,l,"scalar")}}function wtt(n,e){let t=e.indexOf(`
`),r=e.substring(0,t),o=e.substring(t+1)+`
`;if(n.type==="block-scalar"){let s=n.props[0];if(s.type!=="block-scalar-header")throw new Error("Invalid block scalar header");s.source=r,n.source=o}else{let{offset:s}=n,a="indent"in n?n.indent:-1,c=[{type:"block-scalar-header",offset:s,indent:a,source:r}];$Ie(c,"end"in n?n.end:void 0)||c.push({type:"newline",offset:-1,indent:a,source:`
`});for(let l of Object.keys(n))l!=="type"&&l!=="offset"&&delete n[l];Object.assign(n,{type:"block-scalar",indent:a,props:c,source:o})}}function $Ie(n,e){if(e)for(let t of e)switch(t.type){case"space":case"comment":n.push(t);break;case"newline":return n.push(t),!0}return!1}function gee(n,e,t){switch(n.type){case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":n.type=t,n.source=e;break;case"block-scalar":{let r=n.props.slice(1),o=e.length;n.props[0].type==="block-scalar-header"&&(o-=n.props[0].source.length);for(let s of r)s.offset+=o;delete n.props,Object.assign(n,{type:t,source:e,end:r});break}case"block-map":case"block-seq":{let o={type:"newline",offset:n.offset+e.length,indent:n.indent,source:`
`};delete n.items,Object.assign(n,{type:t,source:e,end:[o]});break}default:{let r="indent"in n?n.indent:-1,o="end"in n&&Array.isArray(n.end)?n.end.filter(s=>s.type==="space"||s.type==="comment"||s.type==="newline"):[];for(let s of Object.keys(n))s!=="type"&&s!=="offset"&&delete n[s];Object.assign(n,{type:t,indent:r,source:e,end:o})}}}IU.createScalarToken=Ctt;IU.resolveAsScalar=Ttt;IU.setScalarValue=Ett});var YIe=P(KIe=>{"use strict";var ktt=n=>"type"in n?CU(n):TU(n);function CU(n){switch(n.type){case"block-scalar":{let e="";for(let t of n.props)e+=CU(t);return e+n.source}case"block-map":case"block-seq":{let e="";for(let t of n.items)e+=TU(t);return e}case"flow-collection":{let e=n.start.source;for(let t of n.items)e+=TU(t);for(let t of n.end)e+=t.source;return e}case"document":{let e=TU(n);if(n.end)for(let t of n.end)e+=t.source;return e}default:{let e=n.source;if("end"in n&&n.end)for(let t of n.end)e+=t.source;return e}}}function TU({start:n,key:e,sep:t,value:r}){let o="";for(let s of n)o+=s.source;if(e&&(o+=CU(e)),t)for(let s of t)o+=s.source;return r&&(o+=CU(r)),o}KIe.stringify=ktt});var ZIe=P(JIe=>{"use strict";var vee=Symbol("break visit"),Rtt=Symbol("skip children"),QIe=Symbol("remove item");function Hx(n,e){"type"in n&&n.type==="document"&&(n={start:n.start,value:n.value}),XIe(Object.freeze([]),n,e)}Hx.BREAK=vee;Hx.SKIP=Rtt;Hx.REMOVE=QIe;Hx.itemAtPath=(n,e)=>{let t=n;for(let[r,o]of e){let s=t?.[r];if(s&&"items"in s)t=s.items[o];else return}return t};Hx.parentCollection=(n,e)=>{let t=Hx.itemAtPath(n,e.slice(0,-1)),r=e[e.length-1][0],o=t?.[r];if(o&&"items"in o)return o;throw new Error("Parent collection not found")};function XIe(n,e,t){let r=t(e,n);if(typeof r=="symbol")return r;for(let o of["key","value"]){let s=e[o];if(s&&"items"in s){for(let a=0;a<s.items.length;++a){let c=XIe(Object.freeze(n.concat([[o,a]])),s.items[a],t);if(typeof c=="number")a=c-1;else{if(c===vee)return vee;c===QIe&&(s.items.splice(a,1),a-=1)}}typeof r=="function"&&o==="key"&&(r=r(e,n))}}return typeof r=="function"?r(e,n):r}JIe.visit=Hx});var EU=P(Mc=>{"use strict";var yee=WIe(),Ptt=YIe(),Att=ZIe(),bee="\uFEFF",_ee="",xee="",See="",Dtt=n=>!!n&&"items"in n,Ntt=n=>!!n&&(n.type==="scalar"||n.type==="single-quoted-scalar"||n.type==="double-quoted-scalar"||n.type==="block-scalar");function Ltt(n){switch(n){case bee:return"<BOM>";case _ee:return"<DOC>";case xee:return"<FLOW_END>";case See:return"<SCALAR>";default:return JSON.stringify(n)}}function Ott(n){switch(n){case bee:return"byte-order-mark";case _ee:return"doc-mode";case xee:return"flow-error-end";case See:return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case`
`:case`\r
`:return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(n[0]){case" ":case"	":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}Mc.createScalarToken=yee.createScalarToken;Mc.resolveAsScalar=yee.resolveAsScalar;Mc.setScalarValue=yee.setScalarValue;Mc.stringify=Ptt.stringify;Mc.visit=Att.visit;Mc.BOM=bee;Mc.DOCUMENT=_ee;Mc.FLOW_END=xee;Mc.SCALAR=See;Mc.isCollection=Dtt;Mc.isScalar=Ntt;Mc.prettyToken=Ltt;Mc.tokenType=Ott});var Cee=P(t1e=>{"use strict";var SL=EU();function zd(n){switch(n){case void 0:case" ":case`
`:case"\r":case"	":return!0;default:return!1}}var e1e=new Set("0123456789ABCDEFabcdef"),Mtt=new Set("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()"),wU=new Set(",[]{}"),Ftt=new Set(` ,[]{}
\r	`),Iee=n=>!n||Ftt.has(n),Tee=class{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(e,t=!1){if(e){if(typeof e!="string")throw TypeError("source is not a string");this.buffer=this.buffer?this.buffer+e:e,this.lineEndPos=null}this.atEnd=!t;let r=this.next??"stream";for(;r&&(t||this.hasChars(1));)r=yield*this.parseNext(r)}atLineEnd(){let e=this.pos,t=this.buffer[e];for(;t===" "||t==="	";)t=this.buffer[++e];return!t||t==="#"||t===`
`?!0:t==="\r"?this.buffer[e+1]===`
`:!1}charAt(e){return this.buffer[this.pos+e]}continueScalar(e){let t=this.buffer[e];if(this.indentNext>0){let r=0;for(;t===" ";)t=this.buffer[++r+e];if(t==="\r"){let o=this.buffer[r+e+1];if(o===`
`||!o&&!this.atEnd)return e+r+1}return t===`
`||r>=this.indentNext||!t&&!this.atEnd?e+r:-1}if(t==="-"||t==="."){let r=this.buffer.substr(e,3);if((r==="---"||r==="...")&&zd(this.buffer[e+3]))return-1}return e}getLine(){let e=this.lineEndPos;return(typeof e!="number"||e!==-1&&e<this.pos)&&(e=this.buffer.indexOf(`
`,this.pos),this.lineEndPos=e),e===-1?this.atEnd?this.buffer.substring(this.pos):null:(this.buffer[e-1]==="\r"&&(e-=1),this.buffer.substring(this.pos,e))}hasChars(e){return this.pos+e<=this.buffer.length}setNext(e){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=e,null}peek(e){return this.buffer.substr(this.pos,e)}*parseNext(e){switch(e){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let e=this.getLine();if(e===null)return this.setNext("stream");if(e[0]===SL.BOM&&(yield*this.pushCount(1),e=e.substring(1)),e[0]==="%"){let t=e.length,r=e.indexOf("#");for(;r!==-1;){let s=e[r-1];if(s===" "||s==="	"){t=r-1;break}else r=e.indexOf("#",r+1)}for(;;){let s=e[t-1];if(s===" "||s==="	")t-=1;else break}let o=(yield*this.pushCount(t))+(yield*this.pushSpaces(!0));return yield*this.pushCount(e.length-o),this.pushNewline(),"stream"}if(this.atLineEnd()){let t=yield*this.pushSpaces(!0);return yield*this.pushCount(e.length-t),yield*this.pushNewline(),"stream"}return yield SL.DOCUMENT,yield*this.parseLineStart()}*parseLineStart(){let e=this.charAt(0);if(!e&&!this.atEnd)return this.setNext("line-start");if(e==="-"||e==="."){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");let t=this.peek(3);if((t==="---"||t==="...")&&zd(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,t==="---"?"doc":"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!zd(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){let[e,t]=this.peek(2);if(!t&&!this.atEnd)return this.setNext("block-start");if((e==="-"||e==="?"||e===":")&&zd(t)){let r=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=r,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);let e=this.getLine();if(e===null)return this.setNext("doc");let t=yield*this.pushIndicators();switch(e[t]){case"#":yield*this.pushCount(e.length-t);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(Iee),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return t+=yield*this.parseBlockScalarHeader(),t+=yield*this.pushSpaces(!0),yield*this.pushCount(e.length-t),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let e,t,r=-1;do e=yield*this.pushNewline(),e>0?(t=yield*this.pushSpaces(!1),this.indentValue=r=t):t=0,t+=yield*this.pushSpaces(!0);while(e+t>0);let o=this.getLine();if(o===null)return this.setNext("flow");if((r!==-1&&r<this.indentNext&&o[0]!=="#"||r===0&&(o.startsWith("---")||o.startsWith("..."))&&zd(o[3]))&&!(r===this.indentNext-1&&this.flowLevel===1&&(o[0]==="]"||o[0]==="}")))return this.flowLevel=0,yield SL.FLOW_END,yield*this.parseLineStart();let s=0;for(;o[s]===",";)s+=yield*this.pushCount(1),s+=yield*this.pushSpaces(!0),this.flowKey=!1;switch(s+=yield*this.pushIndicators(),o[s]){case void 0:return"flow";case"#":return yield*this.pushCount(o.length-s),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(Iee),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{let a=this.charAt(1);if(this.flowKey||zd(a)||a===",")return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){let e=this.charAt(0),t=this.buffer.indexOf(e,this.pos+1);if(e==="'")for(;t!==-1&&this.buffer[t+1]==="'";)t=this.buffer.indexOf("'",t+2);else for(;t!==-1;){let s=0;for(;this.buffer[t-1-s]==="\\";)s+=1;if(s%2===0)break;t=this.buffer.indexOf('"',t+1)}let r=this.buffer.substring(0,t),o=r.indexOf(`
`,this.pos);if(o!==-1){for(;o!==-1;){let s=this.continueScalar(o+1);if(s===-1)break;o=r.indexOf(`
`,s)}o!==-1&&(t=o-(r[o-1]==="\r"?2:1))}if(t===-1){if(!this.atEnd)return this.setNext("quoted-scalar");t=this.buffer.length}return yield*this.pushToIndex(t+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let e=this.pos;for(;;){let t=this.buffer[++e];if(t==="+")this.blockScalarKeep=!0;else if(t>"0"&&t<="9")this.blockScalarIndent=Number(t)-1;else if(t!=="-")break}return yield*this.pushUntil(t=>zd(t)||t==="#")}*parseBlockScalar(){let e=this.pos-1,t=0,r;e:for(let s=this.pos;r=this.buffer[s];++s)switch(r){case" ":t+=1;break;case`
`:e=s,t=0;break;case"\r":{let a=this.buffer[s+1];if(!a&&!this.atEnd)return this.setNext("block-scalar");if(a===`
`)break}default:break e}if(!r&&!this.atEnd)return this.setNext("block-scalar");if(t>=this.indentNext){this.blockScalarIndent===-1?this.indentNext=t:this.indentNext=this.blockScalarIndent+(this.indentNext===0?1:this.indentNext);do{let s=this.continueScalar(e+1);if(s===-1)break;e=this.buffer.indexOf(`
`,s)}while(e!==-1);if(e===-1){if(!this.atEnd)return this.setNext("block-scalar");e=this.buffer.length}}let o=e+1;for(r=this.buffer[o];r===" ";)r=this.buffer[++o];if(r==="	"){for(;r==="	"||r===" "||r==="\r"||r===`
`;)r=this.buffer[++o];e=o-1}else if(!this.blockScalarKeep)do{let s=e-1,a=this.buffer[s];a==="\r"&&(a=this.buffer[--s]);let c=s;for(;a===" ";)a=this.buffer[--s];if(a===`
`&&s>=this.pos&&s+1+t>c)e=s;else break}while(!0);return yield SL.SCALAR,yield*this.pushToIndex(e+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){let e=this.flowLevel>0,t=this.pos-1,r=this.pos-1,o;for(;o=this.buffer[++r];)if(o===":"){let s=this.buffer[r+1];if(zd(s)||e&&wU.has(s))break;t=r}else if(zd(o)){let s=this.buffer[r+1];if(o==="\r"&&(s===`
`?(r+=1,o=`
`,s=this.buffer[r+1]):t=r),s==="#"||e&&wU.has(s))break;if(o===`
`){let a=this.continueScalar(r+1);if(a===-1)break;r=Math.max(r,a-2)}}else{if(e&&wU.has(o))break;t=r}return!o&&!this.atEnd?this.setNext("plain-scalar"):(yield SL.SCALAR,yield*this.pushToIndex(t+1,!0),e?"flow":"doc")}*pushCount(e){return e>0?(yield this.buffer.substr(this.pos,e),this.pos+=e,e):0}*pushToIndex(e,t){let r=this.buffer.slice(this.pos,e);return r?(yield r,this.pos+=r.length,r.length):(t&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(Iee))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{let e=this.flowLevel>0,t=this.charAt(1);if(zd(t)||e&&wU.has(t))return e?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if(this.charAt(1)==="<"){let e=this.pos+2,t=this.buffer[e];for(;!zd(t)&&t!==">";)t=this.buffer[++e];return yield*this.pushToIndex(t===">"?e+1:e,!1)}else{let e=this.pos+1,t=this.buffer[e];for(;t;)if(Mtt.has(t))t=this.buffer[++e];else if(t==="%"&&e1e.has(this.buffer[e+1])&&e1e.has(this.buffer[e+2]))t=this.buffer[e+=3];else break;return yield*this.pushToIndex(e,!1)}}*pushNewline(){let e=this.buffer[this.pos];return e===`
`?yield*this.pushCount(1):e==="\r"&&this.charAt(1)===`
`?yield*this.pushCount(2):0}*pushSpaces(e){let t=this.pos-1,r;do r=this.buffer[++t];while(r===" "||e&&r==="	");let o=t-this.pos;return o>0&&(yield this.buffer.substr(this.pos,o),this.pos=t),o}*pushUntil(e){let t=this.pos,r=this.buffer[t];for(;!e(r);)r=this.buffer[++t];return yield*this.pushToIndex(t,!1)}};t1e.Lexer=Tee});var wee=P(n1e=>{"use strict";var Eee=class{constructor(){this.lineStarts=[],this.addNewLine=e=>this.lineStarts.push(e),this.linePos=e=>{let t=0,r=this.lineStarts.length;for(;t<r;){let s=t+r>>1;this.lineStarts[s]<e?t=s+1:r=s}if(this.lineStarts[t]===e)return{line:t+1,col:1};if(t===0)return{line:0,col:e};let o=this.lineStarts[t-1];return{line:t,col:e-o+1}}}};n1e.LineCounter=Eee});var Ree=P(a1e=>{"use strict";var r1e=EU(),Utt=Cee();function Vx(n,e){for(let t=0;t<n.length;++t)if(n[t].type===e)return!0;return!1}function i1e(n){for(let e=0;e<n.length;++e)switch(n[e].type){case"space":case"comment":case"newline":break;default:return e}return-1}function s1e(n){switch(n?.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function kU(n){switch(n.type){case"document":return n.start;case"block-map":{let e=n.items[n.items.length-1];return e.sep??e.start}case"block-seq":return n.items[n.items.length-1].start;default:return[]}}function FE(n){if(n.length===0)return[];let e=n.length;e:for(;--e>=0;)switch(n[e].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;n[++e]?.type==="space";);return n.splice(e,n.length)}function o1e(n){if(n.start.type==="flow-seq-start")for(let e of n.items)e.sep&&!e.value&&!Vx(e.start,"explicit-key-ind")&&!Vx(e.sep,"map-value-ind")&&(e.key&&(e.value=e.key),delete e.key,s1e(e.value)?e.value.end?Array.prototype.push.apply(e.value.end,e.sep):e.value.end=e.sep:Array.prototype.push.apply(e.start,e.sep),delete e.sep)}var kee=class{constructor(e){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new Utt.Lexer,this.onNewLine=e}*parse(e,t=!1){this.onNewLine&&this.offset===0&&this.onNewLine(0);for(let r of this.lexer.lex(e,t))yield*this.next(r);t||(yield*this.end())}*next(e){if(this.source=e,process.env.LOG_TOKENS&&console.log("|",r1e.prettyToken(e)),this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=e.length;return}let t=r1e.tokenType(e);if(t)if(t==="scalar")this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=t,yield*this.step(),t){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+e.length);break;case"space":this.atNewLine&&e[0]===" "&&(this.indent+=e.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=e.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=e.length}else{let r=`Not a YAML token: ${e}`;yield*this.pop({type:"error",offset:this.offset,message:r,source:e}),this.offset+=e.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){let e=this.peek(1);if(this.type==="doc-end"&&(!e||e.type!=="doc-end")){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!e)return yield*this.stream();switch(e.type){case"document":return yield*this.document(e);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(e);case"block-scalar":return yield*this.blockScalar(e);case"block-map":return yield*this.blockMap(e);case"block-seq":return yield*this.blockSequence(e);case"flow-collection":return yield*this.flowCollection(e);case"doc-end":return yield*this.documentEnd(e)}yield*this.pop()}peek(e){return this.stack[this.stack.length-e]}*pop(e){let t=e??this.stack.pop();if(!t)yield{type:"error",offset:this.offset,source:"",message:"Tried to pop an empty stack"};else if(this.stack.length===0)yield t;else{let r=this.peek(1);switch(t.type==="block-scalar"?t.indent="indent"in r?r.indent:0:t.type==="flow-collection"&&r.type==="document"&&(t.indent=0),t.type==="flow-collection"&&o1e(t),r.type){case"document":r.value=t;break;case"block-scalar":r.props.push(t);break;case"block-map":{let o=r.items[r.items.length-1];if(o.value){r.items.push({start:[],key:t,sep:[]}),this.onKeyLine=!0;return}else if(o.sep)o.value=t;else{Object.assign(o,{key:t,sep:[]}),this.onKeyLine=!o.explicitKey;return}break}case"block-seq":{let o=r.items[r.items.length-1];o.value?r.items.push({start:[],value:t}):o.value=t;break}case"flow-collection":{let o=r.items[r.items.length-1];!o||o.value?r.items.push({start:[],key:t,sep:[]}):o.sep?o.value=t:Object.assign(o,{key:t,sep:[]});return}default:yield*this.pop(),yield*this.pop(t)}if((r.type==="document"||r.type==="block-map"||r.type==="block-seq")&&(t.type==="block-map"||t.type==="block-seq")){let o=t.items[t.items.length-1];o&&!o.sep&&!o.value&&o.start.length>0&&i1e(o.start)===-1&&(t.indent===0||o.start.every(s=>s.type!=="comment"||s.indent<t.indent))&&(r.type==="document"?r.end=o.start:r.items.push({start:o.start}),t.items.splice(-1,1))}}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{let e={type:"document",offset:this.offset,start:[]};this.type==="doc-start"&&e.start.push(this.sourceToken),this.stack.push(e);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(e){if(e.value)return yield*this.lineEnd(e);switch(this.type){case"doc-start":{i1e(e.start)!==-1?(yield*this.pop(),yield*this.step()):e.start.push(this.sourceToken);return}case"anchor":case"tag":case"space":case"comment":case"newline":e.start.push(this.sourceToken);return}let t=this.startBlockValue(e);t?this.stack.push(t):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(e){if(this.type==="map-value-ind"){let t=kU(this.peek(2)),r=FE(t),o;e.end?(o=e.end,o.push(this.sourceToken),delete e.end):o=[this.sourceToken];let s={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:r,key:e,sep:o}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=s}else yield*this.lineEnd(e)}*blockScalar(e){switch(this.type){case"space":case"comment":case"newline":e.props.push(this.sourceToken);return;case"scalar":if(e.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let t=this.source.indexOf(`
`)+1;for(;t!==0;)this.onNewLine(this.offset+t),t=this.source.indexOf(`
`,t)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(e){let t=e.items[e.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,t.value){let r="end"in t.value?t.value.end:void 0;(Array.isArray(r)?r[r.length-1]:void 0)?.type==="comment"?r?.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"space":case"comment":if(t.value)e.items.push({start:[this.sourceToken]});else if(t.sep)t.sep.push(this.sourceToken);else{if(this.atIndentedComment(t.start,e.indent)){let o=e.items[e.items.length-2]?.value?.end;if(Array.isArray(o)){Array.prototype.push.apply(o,t.start),o.push(this.sourceToken),e.items.pop();return}}t.start.push(this.sourceToken)}return}if(this.indent>=e.indent){let r=!this.onKeyLine&&this.indent===e.indent,o=r&&(t.sep||t.explicitKey)&&this.type!=="seq-item-ind",s=[];if(o&&t.sep&&!t.value){let a=[];for(let c=0;c<t.sep.length;++c){let l=t.sep[c];switch(l.type){case"newline":a.push(c);break;case"space":break;case"comment":l.indent>e.indent&&(a.length=0);break;default:a.length=0}}a.length>=2&&(s=t.sep.splice(a[1]))}switch(this.type){case"anchor":case"tag":o||t.value?(s.push(this.sourceToken),e.items.push({start:s}),this.onKeyLine=!0):t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"explicit-key-ind":!t.sep&&!t.explicitKey?(t.start.push(this.sourceToken),t.explicitKey=!0):o||t.value?(s.push(this.sourceToken),e.items.push({start:s,explicitKey:!0})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken],explicitKey:!0}]}),this.onKeyLine=!0;return;case"map-value-ind":if(t.explicitKey)if(t.sep)if(t.value)e.items.push({start:[],key:null,sep:[this.sourceToken]});else if(Vx(t.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:s,key:null,sep:[this.sourceToken]}]});else if(s1e(t.key)&&!Vx(t.sep,"newline")){let a=FE(t.start),c=t.key,l=t.sep;l.push(this.sourceToken),delete t.key,delete t.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:a,key:c,sep:l}]})}else s.length>0?t.sep=t.sep.concat(s,this.sourceToken):t.sep.push(this.sourceToken);else if(Vx(t.start,"newline"))Object.assign(t,{key:null,sep:[this.sourceToken]});else{let a=FE(t.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:a,key:null,sep:[this.sourceToken]}]})}else t.sep?t.value||o?e.items.push({start:s,key:null,sep:[this.sourceToken]}):Vx(t.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):t.sep.push(this.sourceToken):Object.assign(t,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{let a=this.flowScalar(this.type);o||t.value?(e.items.push({start:s,key:a,sep:[]}),this.onKeyLine=!0):t.sep?this.stack.push(a):(Object.assign(t,{key:a,sep:[]}),this.onKeyLine=!0);return}default:{let a=this.startBlockValue(e);if(a){r&&a.type!=="block-seq"&&e.items.push({start:s}),this.stack.push(a);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(e){let t=e.items[e.items.length-1];switch(this.type){case"newline":if(t.value){let r="end"in t.value?t.value.end:void 0;(Array.isArray(r)?r[r.length-1]:void 0)?.type==="comment"?r?.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else t.start.push(this.sourceToken);return;case"space":case"comment":if(t.value)e.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(t.start,e.indent)){let o=e.items[e.items.length-2]?.value?.end;if(Array.isArray(o)){Array.prototype.push.apply(o,t.start),o.push(this.sourceToken),e.items.pop();return}}t.start.push(this.sourceToken)}return;case"anchor":case"tag":if(t.value||this.indent<=e.indent)break;t.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==e.indent)break;t.value||Vx(t.start,"seq-item-ind")?e.items.push({start:[this.sourceToken]}):t.start.push(this.sourceToken);return}if(this.indent>e.indent){let r=this.startBlockValue(e);if(r){this.stack.push(r);return}}yield*this.pop(),yield*this.step()}*flowCollection(e){let t=e.items[e.items.length-1];if(this.type==="flow-error-end"){let r;do yield*this.pop(),r=this.peek(1);while(r&&r.type==="flow-collection")}else if(e.end.length===0){switch(this.type){case"comma":case"explicit-key-ind":!t||t.sep?e.items.push({start:[this.sourceToken]}):t.start.push(this.sourceToken);return;case"map-value-ind":!t||t.value?e.items.push({start:[],key:null,sep:[this.sourceToken]}):t.sep?t.sep.push(this.sourceToken):Object.assign(t,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!t||t.value?e.items.push({start:[this.sourceToken]}):t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{let o=this.flowScalar(this.type);!t||t.value?e.items.push({start:[],key:o,sep:[]}):t.sep?this.stack.push(o):Object.assign(t,{key:o,sep:[]});return}case"flow-map-end":case"flow-seq-end":e.end.push(this.sourceToken);return}let r=this.startBlockValue(e);r?this.stack.push(r):(yield*this.pop(),yield*this.step())}else{let r=this.peek(2);if(r.type==="block-map"&&(this.type==="map-value-ind"&&r.indent===e.indent||this.type==="newline"&&!r.items[r.items.length-1].sep))yield*this.pop(),yield*this.step();else if(this.type==="map-value-ind"&&r.type!=="flow-collection"){let o=kU(r),s=FE(o);o1e(e);let a=e.end.splice(1,e.end.length);a.push(this.sourceToken);let c={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:s,key:e,sep:a}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=c}else yield*this.lineEnd(e)}}flowScalar(e){if(this.onNewLine){let t=this.source.indexOf(`
`)+1;for(;t!==0;)this.onNewLine(this.offset+t),t=this.source.indexOf(`
`,t)+1}return{type:e,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(e){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;let t=kU(e),r=FE(t);return r.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:r,explicitKey:!0}]}}case"map-value-ind":{this.onKeyLine=!0;let t=kU(e),r=FE(t);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:r,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(e,t){return this.type!=="comment"||this.indent<=t?!1:e.every(r=>r.type==="newline"||r.type==="space")}*documentEnd(e){this.type!=="doc-mode"&&(e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop()))}*lineEnd(e){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;case"space":case"comment":default:e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop())}}};a1e.Parser=kee});var p1e=P(TL=>{"use strict";var c1e=hee(),Btt=hL(),IL=yL(),qtt=fZ(),jtt=wee(),l1e=Ree();function u1e(n){let e=n.prettyErrors!==!1;return{lineCounter:n.lineCounter||e&&new jtt.LineCounter||null,prettyErrors:e}}function Htt(n,e={}){let{lineCounter:t,prettyErrors:r}=u1e(e),o=new l1e.Parser(t?.addNewLine),s=new c1e.Composer(e),a=Array.from(s.compose(o.parse(n)));if(r&&t)for(let c of a)c.errors.forEach(IL.prettifyError(n,t)),c.warnings.forEach(IL.prettifyError(n,t));return a.length>0?a:Object.assign([],{empty:!0},s.streamInfo())}function d1e(n,e={}){let{lineCounter:t,prettyErrors:r}=u1e(e),o=new l1e.Parser(t?.addNewLine),s=new c1e.Composer(e),a=null;for(let c of s.compose(o.parse(n),!0,n.length))if(!a)a=c;else if(a.options.logLevel!=="silent"){a.errors.push(new IL.YAMLParseError(c.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}return r&&t&&(a.errors.forEach(IL.prettifyError(n,t)),a.warnings.forEach(IL.prettifyError(n,t))),a}function Vtt(n,e,t){let r;typeof e=="function"?r=e:t===void 0&&e&&typeof e=="object"&&(t=e);let o=d1e(n,t);if(!o)return null;if(o.warnings.forEach(s=>qtt.warn(o.options.logLevel,s)),o.errors.length>0){if(o.options.logLevel!=="silent")throw o.errors[0];o.errors=[]}return o.toJS(Object.assign({reviver:r},t))}function Gtt(n,e,t){let r=null;if(typeof e=="function"||Array.isArray(e)?r=e:t===void 0&&e&&(t=e),typeof t=="string"&&(t=t.length),typeof t=="number"){let o=Math.round(t);t=o<1?void 0:o>8?{indent:8}:{indent:o}}if(n===void 0){let{keepUndefined:o}=t??e??{};if(!o)return}return new Btt.Document(n,r,t).toString(t)}TL.parse=Vtt;TL.parseAllDocuments=Htt;TL.parseDocument=d1e;TL.stringify=Gtt});var Aee=P(br=>{"use strict";var ztt=hee(),$tt=hL(),Wtt=YZ(),Pee=yL(),Ktt=tL(),oy=pr(),Ytt=ty(),Qtt=Uo(),Xtt=ry(),Jtt=iy(),Ztt=EU(),ent=Cee(),tnt=wee(),nnt=Ree(),RU=p1e(),f1e=XN();br.Composer=ztt.Composer;br.Document=$tt.Document;br.Schema=Wtt.Schema;br.YAMLError=Pee.YAMLError;br.YAMLParseError=Pee.YAMLParseError;br.YAMLWarning=Pee.YAMLWarning;br.Alias=Ktt.Alias;br.isAlias=oy.isAlias;br.isCollection=oy.isCollection;br.isDocument=oy.isDocument;br.isMap=oy.isMap;br.isNode=oy.isNode;br.isPair=oy.isPair;br.isScalar=oy.isScalar;br.isSeq=oy.isSeq;br.Pair=Ytt.Pair;br.Scalar=Qtt.Scalar;br.YAMLMap=Xtt.YAMLMap;br.YAMLSeq=Jtt.YAMLSeq;br.CST=Ztt;br.Lexer=ent.Lexer;br.LineCounter=tnt.LineCounter;br.Parser=nnt.Parser;br.parse=RU.parse;br.parseAllDocuments=RU.parseAllDocuments;br.parseDocument=RU.parseDocument;br.stringify=RU.stringify;br.visit=f1e.visit;br.visitAsync=f1e.visitAsync});var B1e=P((Ywn,U1e)=>{var ew=1e3,tw=ew*60,nw=tw*60,Qx=nw*24,Rnt=Qx*7,Pnt=Qx*365.25;U1e.exports=function(n,e){e=e||{};var t=typeof n;if(t==="string"&&n.length>0)return Ant(n);if(t==="number"&&isFinite(n))return e.long?Nnt(n):Dnt(n);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(n))};function Ant(n){if(n=String(n),!(n.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(n);if(e){var t=parseFloat(e[1]),r=(e[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return t*Pnt;case"weeks":case"week":case"w":return t*Rnt;case"days":case"day":case"d":return t*Qx;case"hours":case"hour":case"hrs":case"hr":case"h":return t*nw;case"minutes":case"minute":case"mins":case"min":case"m":return t*tw;case"seconds":case"second":case"secs":case"sec":case"s":return t*ew;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function Dnt(n){var e=Math.abs(n);return e>=Qx?Math.round(n/Qx)+"d":e>=nw?Math.round(n/nw)+"h":e>=tw?Math.round(n/tw)+"m":e>=ew?Math.round(n/ew)+"s":n+"ms"}function Nnt(n){var e=Math.abs(n);return e>=Qx?t7(n,e,Qx,"day"):e>=nw?t7(n,e,nw,"hour"):e>=tw?t7(n,e,tw,"minute"):e>=ew?t7(n,e,ew,"second"):n+" ms"}function t7(n,e,t,r){var o=e>=t*1.5;return Math.round(n/t)+" "+r+(o?"s":"")}});var Jee=P((Qwn,q1e)=>{function Lnt(n){t.debug=t,t.default=t,t.coerce=l,t.disable=s,t.enable=o,t.enabled=a,t.humanize=B1e(),t.destroy=u,Object.keys(n).forEach(d=>{t[d]=n[d]}),t.names=[],t.skips=[],t.formatters={};function e(d){let p=0;for(let f=0;f<d.length;f++)p=(p<<5)-p+d.charCodeAt(f),p|=0;return t.colors[Math.abs(p)%t.colors.length]}t.selectColor=e;function t(d){let p,f=null,m,h;function g(...y){if(!g.enabled)return;let b=g,_=Number(new Date),x=_-(p||_);b.diff=x,b.prev=p,b.curr=_,p=_,y[0]=t.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let I=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(w,R)=>{if(w==="%%")return"%";I++;let k=t.formatters[R];if(typeof k=="function"){let V=y[I];w=k.call(b,V),y.splice(I,1),I--}return w}),t.formatArgs.call(b,y),(b.log||t.log).apply(b,y)}return g.namespace=d,g.useColors=t.useColors(),g.color=t.selectColor(d),g.extend=r,g.destroy=t.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>f!==null?f:(m!==t.namespaces&&(m=t.namespaces,h=t.enabled(d)),h),set:y=>{f=y}}),typeof t.init=="function"&&t.init(g),g}function r(d,p){let f=t(this.namespace+(typeof p>"u"?":":p)+d);return f.log=this.log,f}function o(d){t.save(d),t.namespaces=d,t.names=[],t.skips=[];let p,f=(typeof d=="string"?d:"").split(/[\s,]+/),m=f.length;for(p=0;p<m;p++)f[p]&&(d=f[p].replace(/\*/g,".*?"),d[0]==="-"?t.skips.push(new RegExp("^"+d.slice(1)+"$")):t.names.push(new RegExp("^"+d+"$")))}function s(){let d=[...t.names.map(c),...t.skips.map(c).map(p=>"-"+p)].join(",");return t.enable(""),d}function a(d){if(d[d.length-1]==="*")return!0;let p,f;for(p=0,f=t.skips.length;p<f;p++)if(t.skips[p].test(d))return!1;for(p=0,f=t.names.length;p<f;p++)if(t.names[p].test(d))return!0;return!1}function c(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function l(d){return d instanceof Error?d.stack||d.message:d}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}q1e.exports=Lnt});var j1e=P((kl,n7)=>{kl.formatArgs=Mnt;kl.save=Fnt;kl.load=Unt;kl.useColors=Ont;kl.storage=Bnt();kl.destroy=(()=>{let n=!1;return()=>{n||(n=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();kl.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Ont(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Mnt(n){if(n[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+n[0]+(this.useColors?"%c ":" ")+"+"+n7.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;n.splice(1,0,e,"color: inherit");let t=0,r=0;n[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(t++,o==="%c"&&(r=t))}),n.splice(r,0,e)}kl.log=console.debug||console.log||(()=>{});function Fnt(n){try{n?kl.storage.setItem("debug",n):kl.storage.removeItem("debug")}catch{}}function Unt(){let n;try{n=kl.storage.getItem("debug")}catch{}return!n&&typeof process<"u"&&"env"in process&&(n=process.env.DEBUG),n}function Bnt(){try{return localStorage}catch{}}n7.exports=Jee()(kl);var{formatters:qnt}=n7.exports;qnt.j=function(n){try{return JSON.stringify(n)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var V1e=P((Xwn,H1e)=>{"use strict";H1e.exports=(n,e=process.argv)=>{let t=n.startsWith("-")?"":n.length===1?"-":"--",r=e.indexOf(t+n),o=e.indexOf("--");return r!==-1&&(o===-1||r<o)}});var $1e=P((Jwn,z1e)=>{"use strict";var jnt=require("os"),G1e=require("tty"),xu=V1e(),{env:Rs}=process,py;xu("no-color")||xu("no-colors")||xu("color=false")||xu("color=never")?py=0:(xu("color")||xu("colors")||xu("color=true")||xu("color=always"))&&(py=1);"FORCE_COLOR"in Rs&&(Rs.FORCE_COLOR==="true"?py=1:Rs.FORCE_COLOR==="false"?py=0:py=Rs.FORCE_COLOR.length===0?1:Math.min(parseInt(Rs.FORCE_COLOR,10),3));function Zee(n){return n===0?!1:{level:n,hasBasic:!0,has256:n>=2,has16m:n>=3}}function ete(n,e){if(py===0)return 0;if(xu("color=16m")||xu("color=full")||xu("color=truecolor"))return 3;if(xu("color=256"))return 2;if(n&&!e&&py===void 0)return 0;let t=py||0;if(Rs.TERM==="dumb")return t;if(process.platform==="win32"){let r=jnt.release().split(".");return Number(r[0])>=10&&Number(r[2])>=10586?Number(r[2])>=14931?3:2:1}if("CI"in Rs)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(r=>r in Rs)||Rs.CI_NAME==="codeship"?1:t;if("TEAMCITY_VERSION"in Rs)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(Rs.TEAMCITY_VERSION)?1:0;if(Rs.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in Rs){let r=parseInt((Rs.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(Rs.TERM_PROGRAM){case"iTerm.app":return r>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(Rs.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(Rs.TERM)||"COLORTERM"in Rs?1:t}function Hnt(n){let e=ete(n,n&&n.isTTY);return Zee(e)}z1e.exports={supportsColor:Hnt,stdout:Zee(ete(!0,G1e.isatty(1))),stderr:Zee(ete(!0,G1e.isatty(2)))}});var K1e=P((Js,i7)=>{var Vnt=require("tty"),r7=require("util");Js.init=Qnt;Js.log=Wnt;Js.formatArgs=znt;Js.save=Knt;Js.load=Ynt;Js.useColors=Gnt;Js.destroy=r7.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");Js.colors=[6,2,3,4,5,1];try{let n=$1e();n&&(n.stderr||n).level>=2&&(Js.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}Js.inspectOpts=Object.keys(process.env).filter(n=>/^debug_/i.test(n)).reduce((n,e)=>{let t=e.substring(6).toLowerCase().replace(/_([a-z])/g,(o,s)=>s.toUpperCase()),r=process.env[e];return/^(yes|on|true|enabled)$/i.test(r)?r=!0:/^(no|off|false|disabled)$/i.test(r)?r=!1:r==="null"?r=null:r=Number(r),n[t]=r,n},{});function Gnt(){return"colors"in Js.inspectOpts?!!Js.inspectOpts.colors:Vnt.isatty(process.stderr.fd)}function znt(n){let{namespace:e,useColors:t}=this;if(t){let r=this.color,o="\x1B[3"+(r<8?r:"8;5;"+r),s=`  ${o};1m${e} \x1B[0m`;n[0]=s+n[0].split(`
`).join(`
`+s),n.push(o+"m+"+i7.exports.humanize(this.diff)+"\x1B[0m")}else n[0]=$nt()+e+" "+n[0]}function $nt(){return Js.inspectOpts.hideDate?"":new Date().toISOString()+" "}function Wnt(...n){return process.stderr.write(r7.format(...n)+`
`)}function Knt(n){n?process.env.DEBUG=n:delete process.env.DEBUG}function Ynt(){return process.env.DEBUG}function Qnt(n){n.inspectOpts={};let e=Object.keys(Js.inspectOpts);for(let t=0;t<e.length;t++)n.inspectOpts[e[t]]=Js.inspectOpts[e[t]]}i7.exports=Jee()(Js);var{formatters:W1e}=i7.exports;W1e.o=function(n){return this.inspectOpts.colors=this.useColors,r7.inspect(n,this.inspectOpts).split(`
`).map(e=>e.trim()).join(" ")};W1e.O=function(n){return this.inspectOpts.colors=this.useColors,r7.inspect(n,this.inspectOpts)}});var $d=P((Zwn,tte)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?tte.exports=j1e():tte.exports=K1e()});var ate=P((nkn,J1e)=>{var FL=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,Xnt=typeof AbortController=="function",o7=Xnt?AbortController:class{constructor(){this.signal=new Y1e}abort(){this.signal.dispatchEvent("abort")}},Jnt=typeof AbortSignal=="function",Znt=typeof o7.AbortSignal=="function",Y1e=Jnt?AbortSignal:Znt?o7.AbortController:class{constructor(){this.aborted=!1,this._listeners=[]}dispatchEvent(e){if(e==="abort"){this.aborted=!0;let t={type:e,target:this};this.onabort(t),this._listeners.forEach(r=>r(t),this)}}onabort(){}addEventListener(e,t){e==="abort"&&this._listeners.push(t)}removeEventListener(e,t){e==="abort"&&(this._listeners=this._listeners.filter(r=>r!==t))}},ote=new Set,nte=(n,e)=>{let t=`LRU_CACHE_OPTION_${n}`;s7(t)&&ste(t,`${n} option`,`options.${e}`,iw)},rte=(n,e)=>{let t=`LRU_CACHE_METHOD_${n}`;if(s7(t)){let{prototype:r}=iw,{get:o}=Object.getOwnPropertyDescriptor(r,n);ste(t,`${n} method`,`cache.${e}()`,o)}},ert=(n,e)=>{let t=`LRU_CACHE_PROPERTY_${n}`;if(s7(t)){let{prototype:r}=iw,{get:o}=Object.getOwnPropertyDescriptor(r,n);ste(t,`${n} property`,`cache.${e}`,o)}},Q1e=(...n)=>{typeof process=="object"&&process&&typeof process.emitWarning=="function"?process.emitWarning(...n):console.error(...n)},s7=n=>!ote.has(n),ste=(n,e,t,r)=>{ote.add(n);let o=`The ${e} is deprecated. Please use ${t} instead.`;Q1e(o,"DeprecationWarning",n,r)},Xx=n=>n&&n===Math.floor(n)&&n>0&&isFinite(n),X1e=n=>Xx(n)?n<=Math.pow(2,8)?Uint8Array:n<=Math.pow(2,16)?Uint16Array:n<=Math.pow(2,32)?Uint32Array:n<=Number.MAX_SAFE_INTEGER?rw:null:null,rw=class extends Array{constructor(e){super(e),this.fill(0)}},ite=class{constructor(e){if(e===0)return[];let t=X1e(e);this.heap=new t(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}},iw=class n{constructor(e={}){let{max:t=0,ttl:r,ttlResolution:o=1,ttlAutopurge:s,updateAgeOnGet:a,updateAgeOnHas:c,allowStale:l,dispose:u,disposeAfter:d,noDisposeOnSet:p,noUpdateTTL:f,maxSize:m=0,sizeCalculation:h,fetchMethod:g,fetchContext:y,noDeleteOnFetchRejection:b,noDeleteOnStaleGet:_}=e,{length:x,maxAge:I,stale:S}=e instanceof n?{}:e;if(t!==0&&!Xx(t))throw new TypeError("max option must be a nonnegative integer");let w=t?X1e(t):Array;if(!w)throw new Error("invalid max value: "+t);if(this.max=t,this.maxSize=m,this.sizeCalculation=h||x,this.sizeCalculation){if(!this.maxSize)throw new TypeError("cannot set sizeCalculation without setting maxSize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=g||null,this.fetchMethod&&typeof this.fetchMethod!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.fetchContext=y,!this.fetchMethod&&y!==void 0)throw new TypeError("cannot set fetchContext without fetchMethod");if(this.keyMap=new Map,this.keyList=new Array(t).fill(null),this.valList=new Array(t).fill(null),this.next=new w(t),this.prev=new w(t),this.head=0,this.tail=0,this.free=new ite(t),this.initialFill=1,this.size=0,typeof u=="function"&&(this.dispose=u),typeof d=="function"?(this.disposeAfter=d,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!p,this.noUpdateTTL=!!f,this.noDeleteOnFetchRejection=!!b,this.maxSize!==0){if(!Xx(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!l||!!S,this.noDeleteOnStaleGet=!!_,this.updateAgeOnGet=!!a,this.updateAgeOnHas=!!c,this.ttlResolution=Xx(o)||o===0?o:1,this.ttlAutopurge=!!s,this.ttl=r||I||0,this.ttl){if(!Xx(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(this.max===0&&this.ttl===0&&this.maxSize===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){let R="LRU_CACHE_UNBOUNDED";s7(R)&&(ote.add(R),Q1e("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",R,n))}S&&nte("stale","allowStale"),I&&nte("maxAge","ttl"),x&&nte("length","sizeCalculation")}getRemainingTTL(e){return this.has(e,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new rw(this.max),this.starts=new rw(this.max),this.setItemTTL=(r,o,s=FL.now())=>{if(this.starts[r]=o!==0?s:0,this.ttls[r]=o,o!==0&&this.ttlAutopurge){let a=setTimeout(()=>{this.isStale(r)&&this.delete(this.keyList[r])},o+1);a.unref&&a.unref()}},this.updateItemAge=r=>{this.starts[r]=this.ttls[r]!==0?FL.now():0};let e=0,t=()=>{let r=FL.now();if(this.ttlResolution>0){e=r;let o=setTimeout(()=>e=0,this.ttlResolution);o.unref&&o.unref()}return r};this.getRemainingTTL=r=>{let o=this.keyMap.get(r);return o===void 0?0:this.ttls[o]===0||this.starts[o]===0?1/0:this.starts[o]+this.ttls[o]-(e||t())},this.isStale=r=>this.ttls[r]!==0&&this.starts[r]!==0&&(e||t())-this.starts[r]>this.ttls[r]}updateItemAge(e){}setItemTTL(e,t,r){}isStale(e){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new rw(this.max),this.removeItemSize=e=>{this.calculatedSize-=this.sizes[e],this.sizes[e]=0},this.requireSize=(e,t,r,o)=>{if(!Xx(r))if(o){if(typeof o!="function")throw new TypeError("sizeCalculation must be a function");if(r=o(t,e),!Xx(r))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer)");return r},this.addItemSize=(e,t)=>{this.sizes[e]=t;let r=this.maxSize-this.sizes[e];for(;this.calculatedSize>r;)this.evict(!0);this.calculatedSize+=this.sizes[e]}}removeItemSize(e){}addItemSize(e,t){}requireSize(e,t,r,o){if(r||o)throw new TypeError("cannot set size without setting maxSize on cache")}*indexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.tail;!(!this.isValidIndex(t)||((e||!this.isStale(t))&&(yield t),t===this.head));)t=this.prev[t]}*rindexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.head;!(!this.isValidIndex(t)||((e||!this.isStale(t))&&(yield t),t===this.tail));)t=this.next[t]}isValidIndex(e){return this.keyMap.get(this.keyList[e])===e}*entries(){for(let e of this.indexes())yield[this.keyList[e],this.valList[e]]}*rentries(){for(let e of this.rindexes())yield[this.keyList[e],this.valList[e]]}*keys(){for(let e of this.indexes())yield this.keyList[e]}*rkeys(){for(let e of this.rindexes())yield this.keyList[e]}*values(){for(let e of this.indexes())yield this.valList[e]}*rvalues(){for(let e of this.rindexes())yield this.valList[e]}[Symbol.iterator](){return this.entries()}find(e,t={}){for(let r of this.indexes())if(e(this.valList[r],this.keyList[r],this))return this.get(this.keyList[r],t)}forEach(e,t=this){for(let r of this.indexes())e.call(t,this.valList[r],this.keyList[r],this)}rforEach(e,t=this){for(let r of this.rindexes())e.call(t,this.valList[r],this.keyList[r],this)}get prune(){return rte("prune","purgeStale"),this.purgeStale}purgeStale(){let e=!1;for(let t of this.rindexes({allowStale:!0}))this.isStale(t)&&(this.delete(this.keyList[t]),e=!0);return e}dump(){let e=[];for(let t of this.indexes({allowStale:!0})){let r=this.keyList[t],o=this.valList[t],a={value:this.isBackgroundFetch(o)?o.__staleWhileFetching:o};if(this.ttls){a.ttl=this.ttls[t];let c=FL.now()-this.starts[t];a.start=Math.floor(Date.now()-c)}this.sizes&&(a.size=this.sizes[t]),e.unshift([r,a])}return e}load(e){this.clear();for(let[t,r]of e){if(r.start){let o=Date.now()-r.start;r.start=FL.now()-o}this.set(t,r.value,r)}}dispose(e,t,r){}set(e,t,{ttl:r=this.ttl,start:o,noDisposeOnSet:s=this.noDisposeOnSet,size:a=0,sizeCalculation:c=this.sizeCalculation,noUpdateTTL:l=this.noUpdateTTL}={}){if(a=this.requireSize(e,t,a,c),this.maxSize&&a>this.maxSize)return this;let u=this.size===0?void 0:this.keyMap.get(e);if(u===void 0)u=this.newIndex(),this.keyList[u]=e,this.valList[u]=t,this.keyMap.set(e,u),this.next[this.tail]=u,this.prev[u]=this.tail,this.tail=u,this.size++,this.addItemSize(u,a),l=!1;else{let d=this.valList[u];t!==d&&(this.isBackgroundFetch(d)?d.__abortController.abort():s||(this.dispose(d,e,"set"),this.disposeAfter&&this.disposed.push([d,e,"set"])),this.removeItemSize(u),this.valList[u]=t,this.addItemSize(u,a)),this.moveToTail(u)}if(r!==0&&this.ttl===0&&!this.ttls&&this.initializeTTLTracking(),l||this.setItemTTL(u,r,o),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return this.size===0?this.tail:this.size===this.max&&this.max!==0?this.evict(!1):this.free.length!==0?this.free.pop():this.initialFill++}pop(){if(this.size){let e=this.valList[this.head];return this.evict(!0),e}}evict(e){let t=this.head,r=this.keyList[t],o=this.valList[t];return this.isBackgroundFetch(o)?o.__abortController.abort():(this.dispose(o,r,"evict"),this.disposeAfter&&this.disposed.push([o,r,"evict"])),this.removeItemSize(t),e&&(this.keyList[t]=null,this.valList[t]=null,this.free.push(t)),this.head=this.next[t],this.keyMap.delete(r),this.size--,t}has(e,{updateAgeOnHas:t=this.updateAgeOnHas}={}){let r=this.keyMap.get(e);return r!==void 0&&!this.isStale(r)?(t&&this.updateItemAge(r),!0):!1}peek(e,{allowStale:t=this.allowStale}={}){let r=this.keyMap.get(e);if(r!==void 0&&(t||!this.isStale(r))){let o=this.valList[r];return this.isBackgroundFetch(o)?o.__staleWhileFetching:o}}backgroundFetch(e,t,r,o){let s=t===void 0?void 0:this.valList[t];if(this.isBackgroundFetch(s))return s;let a=new o7,c={signal:a.signal,options:r,context:o},l=f=>(a.signal.aborted||this.set(e,f,c.options),f),u=f=>{if(this.valList[t]===p&&(!r.noDeleteOnFetchRejection||p.__staleWhileFetching===void 0?this.delete(e):this.valList[t]=p.__staleWhileFetching),p.__returned===p)throw f},d=f=>f(this.fetchMethod(e,s,c)),p=new Promise(d).then(l,u);return p.__abortController=a,p.__staleWhileFetching=s,p.__returned=null,t===void 0?(this.set(e,p,c.options),t=this.keyMap.get(e)):this.valList[t]=p,p}isBackgroundFetch(e){return e&&typeof e=="object"&&typeof e.then=="function"&&Object.prototype.hasOwnProperty.call(e,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(e,"__returned")&&(e.__returned===e||e.__returned===null)}async fetch(e,{allowStale:t=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,ttl:s=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:c=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:u=this.noUpdateTTL,noDeleteOnFetchRejection:d=this.noDeleteOnFetchRejection,fetchContext:p=this.fetchContext,forceRefresh:f=!1}={}){if(!this.fetchMethod)return this.get(e,{allowStale:t,updateAgeOnGet:r,noDeleteOnStaleGet:o});let m={allowStale:t,updateAgeOnGet:r,noDeleteOnStaleGet:o,ttl:s,noDisposeOnSet:a,size:c,sizeCalculation:l,noUpdateTTL:u,noDeleteOnFetchRejection:d},h=this.keyMap.get(e);if(h===void 0){let g=this.backgroundFetch(e,h,m,p);return g.__returned=g}else{let g=this.valList[h];if(this.isBackgroundFetch(g))return t&&g.__staleWhileFetching!==void 0?g.__staleWhileFetching:g.__returned=g;if(!f&&!this.isStale(h))return this.moveToTail(h),r&&this.updateItemAge(h),g;let y=this.backgroundFetch(e,h,m,p);return t&&y.__staleWhileFetching!==void 0?y.__staleWhileFetching:y.__returned=y}}get(e,{allowStale:t=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet}={}){let s=this.keyMap.get(e);if(s!==void 0){let a=this.valList[s],c=this.isBackgroundFetch(a);return this.isStale(s)?c?t?a.__staleWhileFetching:void 0:(o||this.delete(e),t?a:void 0):c?void 0:(this.moveToTail(s),r&&this.updateItemAge(s),a)}}connect(e,t){this.prev[t]=e,this.next[e]=t}moveToTail(e){e!==this.tail&&(e===this.head?this.head=this.next[e]:this.connect(this.prev[e],this.next[e]),this.connect(this.tail,e),this.tail=e)}get del(){return rte("del","delete"),this.delete}delete(e){let t=!1;if(this.size!==0){let r=this.keyMap.get(e);if(r!==void 0)if(t=!0,this.size===1)this.clear();else{this.removeItemSize(r);let o=this.valList[r];this.isBackgroundFetch(o)?o.__abortController.abort():(this.dispose(o,e,"delete"),this.disposeAfter&&this.disposed.push([o,e,"delete"])),this.keyMap.delete(e),this.keyList[r]=null,this.valList[r]=null,r===this.tail?this.tail=this.prev[r]:r===this.head?this.head=this.next[r]:(this.next[this.prev[r]]=this.next[r],this.prev[this.next[r]]=this.prev[r]),this.size--,this.free.push(r)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return t}clear(){for(let e of this.rindexes({allowStale:!0})){let t=this.valList[e];if(this.isBackgroundFetch(t))t.__abortController.abort();else{let r=this.keyList[e];this.dispose(t,r,"delete"),this.disposeAfter&&this.disposed.push([t,r,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return rte("reset","clear"),this.clear}get length(){return ert("length","size"),this.size}static get AbortController(){return o7}static get AbortSignal(){return Y1e}};J1e.exports=iw});var ute=P((rkn,Z1e)=>{"use strict";var UL=class extends Error{constructor(e,t,r){super(e),this.type=t,this._name=r}get name(){return this._name}get[Symbol.toStringTag](){return this._name}},cte=class extends UL{constructor(e,t,r){super(e,t,"FetchError"),r&&(this.code=r.code,this.errno=r.errno,this.erroredSysCall=r.syscall)}},lte=class extends UL{constructor(e,t="aborted"){super(e,t,"AbortError")}};Z1e.exports={FetchBaseError:UL,FetchError:cte,AbortError:lte}});var Fh=P((ikn,tTe)=>{"use strict";var{constants:{MAX_LENGTH:trt}}=require("buffer"),{pipeline:a7,PassThrough:nrt}=require("stream"),{promisify:rrt}=require("util"),{createGunzip:irt,createInflate:ort,createBrotliDecompress:srt,constants:{Z_SYNC_FLUSH:eTe}}=require("zlib"),art=$d()("helix-fetch:utils"),crt=rrt(a7),lrt=(n,e)=>n===204||n===304||+e["content-length"]==0?!1:/^\s*(?:(x-)?deflate|(x-)?gzip|br)\s*$/.test(e["content-encoding"]),urt=(n,e,t,r)=>{if(!lrt(n,e))return t;let o=s=>{s&&(art(`encountered error while decoding stream: ${s}`),r(s))};switch(e["content-encoding"].trim()){case"gzip":case"x-gzip":return a7(t,irt({flush:eTe,finishFlush:eTe}),o);case"deflate":case"x-deflate":return a7(t,ort(),o);case"br":return a7(t,srt(),o);default:return t}},drt=n=>{if(!n||typeof n!="object"||Object.prototype.toString.call(n)!=="[object Object]")return!1;if(Object.getPrototypeOf(n)===null)return!0;let e=n;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(n)===e},c7=(n,e)=>{if(Buffer.isBuffer(n))return n.length;switch(typeof n){case"string":return n.length*2;case"boolean":return 4;case"number":return 8;case"symbol":return Symbol.keyFor(n)?Symbol.keyFor(n).length*2:(n.toString().length-8)*2;case"object":return Array.isArray(n)?prt(n,e):frt(n,e);default:return 0}},prt=(n,e)=>(e.add(n),n.map(t=>e.has(t)?0:c7(t,e)).reduce((t,r)=>t+r,0)),frt=(n,e)=>{if(n==null)return 0;e.add(n);let t=0,r=[];for(let o in n)r.push(o);return r.push(...Object.getOwnPropertySymbols(n)),r.forEach(o=>{if(t+=c7(o,e),typeof n[o]=="object"&&n[o]!==null){if(e.has(n[o]))return;e.add(n[o])}t+=c7(n[o],e)}),t},mrt=n=>c7(n,new WeakSet),hrt=async n=>{let e=new nrt,t=0,r=[];return e.on("data",o=>{if(t+o.length>trt)throw new Error("Buffer.constants.MAX_SIZE exceeded");r.push(o),t+=o.length}),await crt(n,e),Buffer.concat(r,t)};tTe.exports={decodeStream:urt,isPlainObject:drt,sizeof:mrt,streamToBuffer:hrt}});var u7=P((okn,oTe)=>{"use strict";var{PassThrough:nTe,Readable:Uh}=require("stream"),{types:{isAnyArrayBuffer:iTe}}=require("util"),{FetchError:grt,FetchBaseError:vrt}=ute(),{streamToBuffer:yrt}=Fh(),brt=Buffer.alloc(0),Su=Symbol("Body internals"),_rt=n=>n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength),rTe=async n=>{if(n[Su].disturbed)throw new TypeError("Already read");if(n[Su].error)throw new TypeError(`Stream had error: ${n[Su].error.message}`);n[Su].disturbed=!0;let{stream:e}=n[Su];return e===null?brt:yrt(e)},l7=class{constructor(e){let t;e==null?t=null:e instanceof URLSearchParams?t=Uh.from(e.toString()):e instanceof Uh?t=e:Buffer.isBuffer(e)?t=Uh.from(e):iTe(e)?t=Uh.from(Buffer.from(e)):typeof e=="string"||e instanceof String?t=Uh.from(e):t=Uh.from(String(e)),this[Su]={stream:t,disturbed:!1,error:null},e instanceof Uh&&t.on("error",r=>{let o=r instanceof vrt?r:new grt(`Invalid response body while trying to fetch ${this.url}: ${r.message}`,"system",r);this[Su].error=o})}get body(){return this[Su].stream}get bodyUsed(){return this[Su].disturbed}async buffer(){return rTe(this)}async arrayBuffer(){return _rt(await this.buffer())}async text(){return(await rTe(this)).toString()}async json(){return JSON.parse(await this.text())}};Object.defineProperties(l7.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}});var xrt=n=>{if(n[Su].disturbed)throw new TypeError("Cannot clone: already read");let{stream:e}=n[Su],t=e;if(e instanceof Uh){t=new nTe;let r=new nTe;e.pipe(t),e.pipe(r),n[Su].stream=r}return t},Srt=n=>n===null?null:typeof n=="string"?"text/plain; charset=utf-8":n instanceof URLSearchParams?"application/x-www-form-urlencoded; charset=utf-8":Buffer.isBuffer(n)||iTe(n)||n instanceof Uh?null:"text/plain; charset=utf-8";oTe.exports={Body:l7,cloneStream:xrt,guessContentType:Srt}});var ow=P((skn,lTe)=>{"use strict";var{validateHeaderName:sTe,validateHeaderValue:aTe}=require("http"),{isPlainObject:Irt}=Fh(),Bh=Symbol("Headers internals"),BL=n=>{let e=typeof n!="string"?String(n):n;if(typeof sTe=="function")sTe(e);else if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(e)){let t=new TypeError(`Header name must be a valid HTTP token [${e}]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),t}return e.toLowerCase()},cTe=(n,e)=>{let t=typeof n!="string"?String(n):n;if(typeof aTe=="function")aTe(e,t);else if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(t)){let r=new TypeError(`Invalid character in header content ["${e}"]`);throw Object.defineProperty(r,"code",{value:"ERR_INVALID_CHAR"}),r}return t},d7=class n{constructor(e={}){if(this[Bh]={map:new Map},e instanceof n)e.forEach((t,r)=>{this.append(r,t)});else if(Array.isArray(e))e.forEach(([t,r])=>{this.append(t,r)});else if(Irt(e))for(let[t,r]of Object.entries(e))this.append(t,r)}set(e,t){this[Bh].map.set(BL(e),cTe(t,e))}has(e){return this[Bh].map.has(BL(e))}get(e){let t=this[Bh].map.get(BL(e));return t===void 0?null:t}append(e,t){let r=BL(e),o=cTe(t,e),s=this[Bh].map.get(r);this[Bh].map.set(r,s?`${s}, ${o}`:o)}delete(e){this[Bh].map.delete(BL(e))}forEach(e,t){for(let r of this.keys())e.call(t,this.get(r),r)}keys(){return Array.from(this[Bh].map.keys()).sort()}*values(){for(let e of this.keys())yield this.get(e)}*entries(){for(let e of this.keys())yield[e,this.get(e)]}[Symbol.iterator](){return this.entries()}get[Symbol.toStringTag](){return this.constructor.name}plain(){return Object.fromEntries(this[Bh].map)}};Object.defineProperties(d7.prototype,["append","delete","entries","forEach","get","has","keys","set","values"].reduce((n,e)=>(n[e]={enumerable:!0},n),{}));lTe.exports={Headers:d7}});var dte=P((akn,uTe)=>{"use strict";var{EventEmitter:Trt}=require("events"),Wd=Symbol("AbortSignal internals"),sw=class{constructor(){this[Wd]={eventEmitter:new Trt,onabort:null,aborted:!1}}get aborted(){return this[Wd].aborted}get onabort(){return this[Wd].onabort}set onabort(e){this[Wd].onabort=e}get[Symbol.toStringTag](){return this.constructor.name}removeEventListener(e,t){this[Wd].eventEmitter.removeListener(e,t)}addEventListener(e,t){this[Wd].eventEmitter.on(e,t)}dispatchEvent(e){let t={type:e,target:this},r=`on${e}`;typeof this[Wd][r]=="function"&&this[r](t),this[Wd].eventEmitter.emit(e,t)}fire(){this[Wd].aborted=!0,this.dispatchEvent("abort")}};Object.defineProperties(sw.prototype,{addEventListener:{enumerable:!0},removeEventListener:{enumerable:!0},dispatchEvent:{enumerable:!0},aborted:{enumerable:!0},onabort:{enumerable:!0}});var f7=class extends sw{constructor(e){if(!Number.isInteger(e))throw new TypeError(`Expected an integer, got ${typeof e}`);super(),this[Wd].timerId=setTimeout(()=>{this.fire()},e)}clear(){clearTimeout(this[Wd].timerId)}};Object.defineProperties(f7.prototype,{clear:{enumerable:!0}});var p7=Symbol("AbortController internals"),m7=class{constructor(){this[p7]={signal:new sw}}get signal(){return this[p7].signal}get[Symbol.toStringTag](){return this.constructor.name}abort(){this[p7].signal.aborted||this[p7].signal.fire()}};Object.defineProperties(m7.prototype,{signal:{enumerable:!0},abort:{enumerable:!0}});uTe.exports={AbortController:m7,AbortSignal:sw,TimeoutSignal:f7}});var qL=P((ckn,fTe)=>{"use strict";var{randomBytes:Crt}=require("crypto"),{Readable:Ert}=require("stream"),fte=n=>typeof n=="object"&&["arrayBuffer","stream","text","slice","constructor"].map(e=>typeof n[e]).filter(e=>e!=="function").length===0&&typeof n.type=="string"&&typeof n.size=="number"&&/^(Blob|File)$/.test(n[Symbol.toStringTag]),wrt=n=>n!=null&&typeof n=="object"&&["append","delete","get","getAll","has","set","keys","values","entries","constructor"].map(e=>typeof n[e]).filter(e=>e!=="function").length===0&&n[Symbol.toStringTag]==="FormData",dTe=n=>`--${n}--\r
\r
`,pTe=(n,e,t)=>{let r="";return r+=`--${n}\r
`,r+=`Content-Disposition: form-data; name="${e}"`,fte(t)&&(r+=`; filename="${t.name}"\r
`,r+=`Content-Type: ${t.type||"application/octet-stream"}`),`${r}\r
\r
`};async function*krt(n,e){for(let[t,r]of n)yield pTe(e,t,r),fte(r)?yield*r.stream():yield r,yield`\r
`;yield dTe(e)}var Rrt=(n,e)=>{let t=0;for(let[r,o]of n)t+=Buffer.byteLength(pTe(e,r,o)),t+=fte(o)?o.size:Buffer.byteLength(String(o)),t+=Buffer.byteLength(`\r
`);return t+=Buffer.byteLength(dTe(e)),t},pte=class{constructor(e){this.fd=e,this.boundary=Crt(8).toString("hex")}length(){return typeof this._length>"u"&&(this._length=Rrt(this.fd,this.boundary)),this._length}contentType(){return`multipart/form-data; boundary=${this.boundary}`}stream(){return Ert.from(krt(this.fd,this.boundary))}};fTe.exports={isFormData:wrt,FormDataSerializer:pte}});var hTe=P((lkn,mTe)=>{"use strict";var{AbortSignal:Prt}=dte(),{Body:Art,cloneStream:Drt,guessContentType:Nrt}=u7(),{Headers:Lrt}=ow(),{isPlainObject:Ort}=Fh(),{isFormData:Mrt,FormDataSerializer:Frt}=qL(),Urt=20,fy=Symbol("Request internals"),h7=class n extends Art{constructor(e,t={}){let r=e instanceof n?e:null,o=r?new URL(r.url):new URL(e),s=t.method||r&&r.method||"GET";if(s=s.toUpperCase(),(t.body!=null||r&&r.body!==null)&&["GET","HEAD"].includes(s))throw new TypeError("Request with GET/HEAD method cannot have body");let a=t.body||(r&&r.body?Drt(r):null),c=new Lrt(t.headers||r&&r.headers||{});if(Mrt(a)&&!c.has("content-type")){let p=new Frt(a);a=p.stream(),c.set("content-type",p.contentType()),!c.has("transfer-encoding")&&!c.has("content-length")&&c.set("content-length",p.length())}if(!c.has("content-type"))if(Ort(a))a=JSON.stringify(a),c.set("content-type","application/json");else{let p=Nrt(a);p&&c.set("content-type",p)}super(a);let l=r?r.signal:null;if("signal"in t&&(l=t.signal),l&&!(l instanceof Prt))throw new TypeError("signal needs to be an instance of AbortSignal");let u=t.redirect||r&&r.redirect||"follow";if(!["follow","error","manual"].includes(u))throw new TypeError(`'${u}' is not a valid redirect option`);let d=t.cache||r&&r.cache||"default";if(!["default","no-store","reload","no-cache","force-cache","only-if-cached"].includes(d))throw new TypeError(`'${d}' is not a valid cache option`);this[fy]={init:{...t},method:s,redirect:u,cache:d,headers:c,parsedURL:o,signal:l},t.follow===void 0?!r||r.follow===void 0?this.follow=Urt:this.follow=r.follow:this.follow=t.follow,this.counter=t.counter||r&&r.counter||0,t.compress===void 0?!r||r.compress===void 0?this.compress=!0:this.compress=r.compress:this.compress=t.compress,t.decode===void 0?!r||r.decode===void 0?this.decode=!0:this.decode=r.decode:this.decode=t.decode}get method(){return this[fy].method}get url(){return this[fy].parsedURL.toString()}get headers(){return this[fy].headers}get redirect(){return this[fy].redirect}get cache(){return this[fy].cache}get signal(){return this[fy].signal}clone(){return new n(this)}get init(){return this[fy].init}get[Symbol.toStringTag](){return this.constructor.name}};Object.defineProperties(h7.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},cache:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}});mTe.exports={Request:h7}});var mte=P((ukn,gTe)=>{"use strict";var{Body:Brt,cloneStream:qrt,guessContentType:jrt}=u7(),{Headers:Hrt}=ow(),{isPlainObject:Vrt}=Fh(),{isFormData:Grt,FormDataSerializer:zrt}=qL(),Kd=Symbol("Response internals"),g7=class n extends Brt{constructor(e=null,t={}){let r=new Hrt(t.headers),o=e;if(Grt(o)&&!r.has("content-type")){let s=new zrt(o);o=s.stream(),r.set("content-type",s.contentType()),!r.has("transfer-encoding")&&!r.has("content-length")&&r.set("content-length",s.length())}if(o!==null&&!r.has("content-type"))if(Vrt(o))o=JSON.stringify(o),r.set("content-type","application/json");else{let s=jrt(o);s&&r.set("content-type",s)}super(o),this[Kd]={url:t.url,status:t.status||200,statusText:t.statusText||"",headers:r,httpVersion:t.httpVersion,decoded:t.decoded,counter:t.counter}}get url(){return this[Kd].url||""}get status(){return this[Kd].status}get statusText(){return this[Kd].statusText}get ok(){return this[Kd].status>=200&&this[Kd].status<300}get redirected(){return this[Kd].counter>0}get headers(){return this[Kd].headers}get httpVersion(){return this[Kd].httpVersion}get decoded(){return this[Kd].decoded}static redirect(e,t=302){if(![301,302,303,307,308].includes(t))throw new RangeError("Invalid status code");return new n(null,{headers:{location:new URL(e).toString()},status:t})}clone(){if(this.bodyUsed)throw new TypeError("Cannot clone: already read");return new n(qrt(this),{...this[Kd]})}get[Symbol.toStringTag](){return this.constructor.name}};Object.defineProperties(g7.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});gTe.exports={Response:g7}});var yTe=P((pkn,vTe)=>{"use strict";var $rt=new Set([200,203,204,206,300,301,308,404,405,410,414,501]),Wrt=new Set([200,203,204,300,301,302,303,307,308,404,405,410,414,501]),Krt=new Set([500,502,503,504]),Yrt={date:!0,connection:!0,"keep-alive":!0,"proxy-authenticate":!0,"proxy-authorization":!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0},Qrt={"content-length":!0,"content-encoding":!0,"transfer-encoding":!0,"content-range":!0};function Jx(n){let e=parseInt(n,10);return isFinite(e)?e:0}function Xrt(n){return n?Krt.has(n.status):!0}function hte(n){let e={};if(!n)return e;let t=n.trim().split(/,/);for(let r of t){let[o,s]=r.split(/=/,2);e[o.trim()]=s===void 0?!0:s.trim().replace(/^"|"$/g,"")}return e}function Jrt(n){let e=[];for(let t in n){let r=n[t];e.push(r===!0?t:t+"="+r)}if(e.length)return e.join(", ")}vTe.exports=class{constructor(e,t,{shared:r,cacheHeuristic:o,immutableMinTimeToLive:s,ignoreCargoCult:a,_fromObject:c}={}){if(c){this._fromObject(c);return}if(!t||!t.headers)throw Error("Response headers missing");this._assertRequestHasHeaders(e),this._responseTime=this.now(),this._isShared=r!==!1,this._cacheHeuristic=o!==void 0?o:.1,this._immutableMinTtl=s!==void 0?s:24*3600*1e3,this._status="status"in t?t.status:200,this._resHeaders=t.headers,this._rescc=hte(t.headers["cache-control"]),this._method="method"in e?e.method:"GET",this._url=e.url,this._host=e.headers.host,this._noAuthorization=!e.headers.authorization,this._reqHeaders=t.headers.vary?e.headers:null,this._reqcc=hte(e.headers["cache-control"]),a&&"pre-check"in this._rescc&&"post-check"in this._rescc&&(delete this._rescc["pre-check"],delete this._rescc["post-check"],delete this._rescc["no-cache"],delete this._rescc["no-store"],delete this._rescc["must-revalidate"],this._resHeaders=Object.assign({},this._resHeaders,{"cache-control":Jrt(this._rescc)}),delete this._resHeaders.expires,delete this._resHeaders.pragma),t.headers["cache-control"]==null&&/no-cache/.test(t.headers.pragma)&&(this._rescc["no-cache"]=!0)}now(){return Date.now()}storable(){return!!(!this._reqcc["no-store"]&&(this._method==="GET"||this._method==="HEAD"||this._method==="POST"&&this._hasExplicitExpiration())&&Wrt.has(this._status)&&!this._rescc["no-store"]&&(!this._isShared||!this._rescc.private)&&(!this._isShared||this._noAuthorization||this._allowsStoringAuthenticated())&&(this._resHeaders.expires||this._rescc["max-age"]||this._isShared&&this._rescc["s-maxage"]||this._rescc.public||$rt.has(this._status)))}_hasExplicitExpiration(){return this._isShared&&this._rescc["s-maxage"]||this._rescc["max-age"]||this._resHeaders.expires}_assertRequestHasHeaders(e){if(!e||!e.headers)throw Error("Request headers missing")}satisfiesWithoutRevalidation(e){this._assertRequestHasHeaders(e);let t=hte(e.headers["cache-control"]);return t["no-cache"]||/no-cache/.test(e.headers.pragma)||t["max-age"]&&this.age()>t["max-age"]||t["min-fresh"]&&this.timeToLive()<1e3*t["min-fresh"]||this.stale()&&!(t["max-stale"]&&!this._rescc["must-revalidate"]&&(t["max-stale"]===!0||t["max-stale"]>this.age()-this.maxAge()))?!1:this._requestMatches(e,!1)}_requestMatches(e,t){return(!this._url||this._url===e.url)&&this._host===e.headers.host&&(!e.method||this._method===e.method||t&&e.method==="HEAD")&&this._varyMatches(e)}_allowsStoringAuthenticated(){return this._rescc["must-revalidate"]||this._rescc.public||this._rescc["s-maxage"]}_varyMatches(e){if(!this._resHeaders.vary)return!0;if(this._resHeaders.vary==="*")return!1;let t=this._resHeaders.vary.trim().toLowerCase().split(/\s*,\s*/);for(let r of t)if(e.headers[r]!==this._reqHeaders[r])return!1;return!0}_copyWithoutHopByHopHeaders(e){let t={};for(let r in e)Yrt[r]||(t[r]=e[r]);if(e.connection){let r=e.connection.trim().split(/\s*,\s*/);for(let o of r)delete t[o]}if(t.warning){let r=t.warning.split(/,/).filter(o=>!/^\s*1[0-9][0-9]/.test(o));r.length?t.warning=r.join(",").trim():delete t.warning}return t}responseHeaders(){let e=this._copyWithoutHopByHopHeaders(this._resHeaders),t=this.age();return t>3600*24&&!this._hasExplicitExpiration()&&this.maxAge()>3600*24&&(e.warning=(e.warning?`${e.warning}, `:"")+'113 - "rfc7234 5.5.4"'),e.age=`${Math.round(t)}`,e.date=new Date(this.now()).toUTCString(),e}date(){let e=Date.parse(this._resHeaders.date);return isFinite(e)?e:this._responseTime}age(){let e=this._ageValue(),t=(this.now()-this._responseTime)/1e3;return e+t}_ageValue(){return Jx(this._resHeaders.age)}maxAge(){if(!this.storable()||this._rescc["no-cache"]||this._isShared&&this._resHeaders["set-cookie"]&&!this._rescc.public&&!this._rescc.immutable||this._resHeaders.vary==="*")return 0;if(this._isShared){if(this._rescc["proxy-revalidate"])return 0;if(this._rescc["s-maxage"])return Jx(this._rescc["s-maxage"])}if(this._rescc["max-age"])return Jx(this._rescc["max-age"]);let e=this._rescc.immutable?this._immutableMinTtl:0,t=this.date();if(this._resHeaders.expires){let r=Date.parse(this._resHeaders.expires);return Number.isNaN(r)||r<t?0:Math.max(e,(r-t)/1e3)}if(this._resHeaders["last-modified"]){let r=Date.parse(this._resHeaders["last-modified"]);if(isFinite(r)&&t>r)return Math.max(e,(t-r)/1e3*this._cacheHeuristic)}return e}timeToLive(){let e=this.maxAge()-this.age(),t=e+Jx(this._rescc["stale-if-error"]),r=e+Jx(this._rescc["stale-while-revalidate"]);return Math.max(0,e,t,r)*1e3}stale(){return this.maxAge()<=this.age()}_useStaleIfError(){return this.maxAge()+Jx(this._rescc["stale-if-error"])>this.age()}useStaleWhileRevalidate(){return this.maxAge()+Jx(this._rescc["stale-while-revalidate"])>this.age()}static fromObject(e){return new this(void 0,void 0,{_fromObject:e})}_fromObject(e){if(this._responseTime)throw Error("Reinitialized");if(!e||e.v!==1)throw Error("Invalid serialization");this._responseTime=e.t,this._isShared=e.sh,this._cacheHeuristic=e.ch,this._immutableMinTtl=e.imm!==void 0?e.imm:24*3600*1e3,this._status=e.st,this._resHeaders=e.resh,this._rescc=e.rescc,this._method=e.m,this._url=e.u,this._host=e.h,this._noAuthorization=e.a,this._reqHeaders=e.reqh,this._reqcc=e.reqcc}toObject(){return{v:1,t:this._responseTime,sh:this._isShared,ch:this._cacheHeuristic,imm:this._immutableMinTtl,st:this._status,resh:this._resHeaders,rescc:this._rescc,m:this._method,u:this._url,h:this._host,a:this._noAuthorization,reqh:this._reqHeaders,reqcc:this._reqcc}}revalidationHeaders(e){this._assertRequestHasHeaders(e);let t=this._copyWithoutHopByHopHeaders(e.headers);if(delete t["if-range"],!this._requestMatches(e,!0)||!this.storable())return delete t["if-none-match"],delete t["if-modified-since"],t;if(this._resHeaders.etag&&(t["if-none-match"]=t["if-none-match"]?`${t["if-none-match"]}, ${this._resHeaders.etag}`:this._resHeaders.etag),t["accept-ranges"]||t["if-match"]||t["if-unmodified-since"]||this._method&&this._method!="GET"){if(delete t["if-modified-since"],t["if-none-match"]){let o=t["if-none-match"].split(/,/).filter(s=>!/^\s*W\//.test(s));o.length?t["if-none-match"]=o.join(",").trim():delete t["if-none-match"]}}else this._resHeaders["last-modified"]&&!t["if-modified-since"]&&(t["if-modified-since"]=this._resHeaders["last-modified"]);return t}revalidatedPolicy(e,t){if(this._assertRequestHasHeaders(e),this._useStaleIfError()&&Xrt(t))return{modified:!1,matches:!1,policy:this};if(!t||!t.headers)throw Error("Response headers missing");let r=!1;if(t.status!==void 0&&t.status!=304?r=!1:t.headers.etag&&!/^\s*W\//.test(t.headers.etag)?r=this._resHeaders.etag&&this._resHeaders.etag.replace(/^\s*W\//,"")===t.headers.etag:this._resHeaders.etag&&t.headers.etag?r=this._resHeaders.etag.replace(/^\s*W\//,"")===t.headers.etag.replace(/^\s*W\//,""):this._resHeaders["last-modified"]?r=this._resHeaders["last-modified"]===t.headers["last-modified"]:!this._resHeaders.etag&&!this._resHeaders["last-modified"]&&!t.headers.etag&&!t.headers["last-modified"]&&(r=!0),!r)return{policy:new this.constructor(e,t),modified:t.status!=304,matches:!1};let o={};for(let a in this._resHeaders)o[a]=a in t.headers&&!Qrt[a]?t.headers[a]:this._resHeaders[a];let s=Object.assign({},t,{status:this._status,method:this._method,headers:o});return{policy:new this.constructor(e,s,{shared:this._isShared,cacheHeuristic:this._cacheHeuristic,immutableMinTimeToLive:this._immutableMinTtl}),modified:!1,matches:!0}}}});var STe=P((fkn,xTe)=>{"use strict";var Zrt=yTe(),{Headers:eit}=ow(),bTe=n=>({url:n.url,method:n.method,headers:n.headers.plain()}),_Te=n=>({status:n.status,headers:n.headers.plain()}),gte=class{constructor(e,t,r){this.policy=new Zrt(bTe(e),_Te(t),r)}storable(){return this.policy.storable()}satisfiesWithoutRevalidation(e){return this.policy.satisfiesWithoutRevalidation(bTe(e))}responseHeaders(e){return new eit(this.policy.responseHeaders(_Te(e)))}timeToLive(){return this.policy.timeToLive()}};xTe.exports=gte});var CTe=P((mkn,TTe)=>{"use strict";var{Readable:tit}=require("stream"),{Headers:ITe}=ow(),{Response:nit}=mte(),my=Symbol("CacheableResponse internals"),rit=n=>n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength),vte=class n extends nit{constructor(e,t){super(e,t);let r=new ITe(t.headers);this[my]={headers:r,bufferedBody:e}}get headers(){return this[my].headers}set headers(e){if(e instanceof ITe)this[my].headers=e;else throw new TypeError("instance of Headers expected")}get body(){return tit.from(this[my].bufferedBody)}get bodyUsed(){return!1}async buffer(){return this[my].bufferedBody}async arrayBuffer(){return rit(this[my].bufferedBody)}async text(){return this[my].bufferedBody.toString()}async json(){return JSON.parse(await this.text())}clone(){let{url:e,status:t,statusText:r,headers:o,httpVersion:s,decoded:a,counter:c}=this;return new n(this[my].bufferedBody,{url:e,status:t,statusText:r,headers:o,httpVersion:s,decoded:a,counter:c})}get[Symbol.toStringTag](){return this.constructor.name}},iit=async n=>{let e=await n.buffer(),{url:t,status:r,statusText:o,headers:s,httpVersion:a,decoded:c,counter:l}=n;return new vte(e,{url:t,status:r,statusText:o,headers:s,httpVersion:a,decoded:c,counter:l})};TTe.exports={cacheableResponse:iit}});var v7=P((hkn,ETe)=>{"use strict";var yte=class extends Error{get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};ETe.exports={RequestAbortedError:yte}});var ATe=P((gkn,PTe)=>{"use strict";var kTe=require("http"),RTe=require("https"),{Readable:oit}=require("stream"),qh=$d()("helix-fetch:h1"),{RequestAbortedError:wTe}=v7(),{decodeStream:sit}=Fh(),ait=(n,e)=>{let{h1:t,options:{h1:r,rejectUnauthorized:o}}=n;return e==="https:"?t.httpsAgent?t.httpsAgent:r||typeof o=="boolean"?(t.httpsAgent=new RTe.Agent(typeof o=="boolean"?{...r||{},rejectUnauthorized:o}:r),t.httpsAgent):void 0:t.httpAgent?t.httpAgent:r?(t.httpAgent=new kTe.Agent(r),t.httpAgent):void 0},cit=n=>{n.h1={}},lit=async({h1:n})=>{n.httpAgent&&(qh("resetContext: destroying httpAgent"),n.httpAgent.destroy(),delete n.httpAgent),n.httpsAgent&&(qh("resetContext: destroying httpsAgent"),n.httpsAgent.destroy(),delete n.httpsAgent)},uit=(n,e,t)=>{let{statusCode:r,statusMessage:o,httpVersion:s,httpVersionMajor:a,httpVersionMinor:c,headers:l}=n,u=e?sit(r,l,n,t):n;return{statusCode:r,statusText:o,httpVersion:s,httpVersionMajor:a,httpVersionMinor:c,headers:l,readable:u,decoded:!!(e&&u!==n)}},dit=async(n,e,t)=>{let{request:r}=e.protocol==="https:"?RTe:kTe,o=ait(n,e.protocol),s={...t,agent:o},{socket:a,body:c}=s;return a&&(delete s.socket,a.assigned||(a.assigned=!0,o?s.agent=new Proxy(o,{get:(l,u)=>u==="createConnection"&&!a.inUse?(d,p)=>{qh(`agent reusing socket #${a.id} (${a.servername})`),a.inUse=!0,p(null,a)}:l[u]}):s.createConnection=(l,u)=>{qh(`reusing socket #${a.id} (${a.servername})`),a.inUse=!0,u(null,a)})),new Promise((l,u)=>{qh(`${s.method} ${e.href}`);let d,{signal:p}=s,f=()=>{p.removeEventListener("abort",f),a&&!a.inUse&&(qh(`discarding redundant socket used for ALPN: #${a.id} ${a.servername}`),a.destroy()),u(new wTe),d&&d.abort()};if(p){if(p.aborted){u(new wTe);return}p.addEventListener("abort",f)}d=r(e,s),d.once("response",m=>{p&&p.removeEventListener("abort",f),a&&!a.inUse&&(qh(`discarding redundant socket used for ALPN: #${a.id} ${a.servername}`),a.destroy()),l(uit(m,s.decode,u))}),d.once("error",m=>{p&&p.removeEventListener("abort",f),a&&!a.inUse&&(qh(`discarding redundant socket used for ALPN: #${a.id} ${a.servername}`),a.destroy()),d.aborted||(qh(`${s.method} ${e.href} failed with: ${m.message}`),d.abort(),u(m))}),c instanceof oit?c.pipe(d):(c&&d.write(c),d.end())})};PTe.exports={request:dit,setupContext:cit,resetContext:lit}});var OTe=P((vkn,LTe)=>{"use strict";var{connect:pit,constants:fit}=require("http2"),{Readable:mit}=require("stream"),si=$d()("helix-fetch:h2"),{RequestAbortedError:DTe}=v7(),{decodeStream:hit}=Fh(),{NGHTTP2_CANCEL:jL}=fit,git=5*60*1e3,vit=5e3,yit=n=>{n.h2={sessionCache:{}}},bit=async({h2:n})=>Promise.all(Object.values(n.sessionCache).map(e=>new Promise(t=>{e.on("close",t),si(`resetContext: destroying session (socket #${e.socket&&e.socket.id}, ${e.socket&&e.socket.servername})`),e.destroy()}))),NTe=(n,e,t,r=()=>{})=>{let o={...n},s=o[":status"];delete o[":status"];let a=t?hit(s,n,e,r):e;return{statusCode:s,statusText:"",httpVersion:"2.0",httpVersionMajor:2,httpVersionMinor:0,headers:o,readable:a,decoded:!!(t&&a!==e)}},_it=(n,e,t,r,o,s)=>{let{options:{h2:{pushPromiseHandler:a,pushHandler:c,pushedStreamIdleTimeout:l=vit}}}=n,u=o[":path"],d=`${e}${u}`;si(`received PUSH_PROMISE: ${d}, stream #${r.id}, headers: ${JSON.stringify(o)}, flags: ${s}`),a&&a(d,o,()=>{r.close(jL)}),r.on("push",(p,f)=>{si(`received push headers for ${e}${u}, stream #${r.id}, headers: ${JSON.stringify(p)}, flags: ${f}`),r.setTimeout(l,()=>{si(`closing pushed stream #${r.id} after ${l} ms of inactivity`),r.close(jL)}),c&&c(d,o,NTe(p,r,t))}),r.on("aborted",()=>{si(`pushed stream #${r.id} aborted`)}),r.on("error",p=>{si(`pushed stream #${r.id} encountered error: ${p}`)}),r.on("frameError",(p,f,m)=>{si(`pushed stream #${r.id} encountered frameError: type: ${p}, code: ${f}, id: ${m}`)})},xit=async(n,e,t)=>{let{origin:r,pathname:o,search:s,hash:a}=e,c=`${o}${s}${a}`,{options:{h2:l={}},h2:{sessionCache:u}}=n,{idleSessionTimeout:d=git,pushPromiseHandler:p,pushHandler:f}=l,m={...t},{method:h,headers:g,socket:y,body:b,decode:_}=m;return y&&delete m.socket,g.host&&(g[":authority"]=g.host,delete g.host),new Promise((x,I)=>{let S=u[r];if(!S||S.closed||S.destroyed){let F=!(n.options.rejectUnauthorized===!1||l.rejectUnauthorized===!1),K={...l,rejectUnauthorized:F};y&&!y.inUse&&(K.createConnection=()=>(si(`reusing socket #${y.id} (${y.servername})`),y.inUse=!0,y)),S=pit(r,{...K,settings:{enablePush:!!(p||f)}}),S.setMaxListeners(1e3),S.setTimeout(d,()=>{si(`closing session ${r} after ${d} ms of inactivity`),S.close()}),S.once("connect",()=>{si(`session ${r} established`),si(`caching session ${r}`),u[r]=S}),S.on("localSettings",j=>{si(`session ${r} localSettings: ${JSON.stringify(j)}`)}),S.on("remoteSettings",j=>{si(`session ${r} remoteSettings: ${JSON.stringify(j)}`)}),S.once("close",()=>{si(`session ${r} closed`),u[r]===S&&(si(`discarding cached session ${r}`),delete u[r])}),S.once("error",j=>{si(`session ${r} encountered error: ${j}`),u[r]===S&&(si(`discarding cached session ${r}`),delete u[r])}),S.on("frameError",(j,D,A)=>{si(`session ${r} encountered frameError: type: ${j}, code: ${D}, id: ${A}`)}),S.once("goaway",(j,D,A)=>{si(`session ${r} received GOAWAY frame: errorCode: ${j}, lastStreamID: ${D}, opaqueData: ${A?A.toString():void 0}`)}),S.on("stream",(j,D,A)=>{_it(n,r,_,j,D,A)})}else y&&y.id!==S.socket.id&&!y.inUse&&(si(`discarding redundant socket used for ALPN: #${y.id} ${y.servername}`),y.destroy());si(`${h} ${e.host}${c}`);let w,{signal:R}=m,k=()=>{R.removeEventListener("abort",k),I(new DTe),w&&w.close(jL)};if(R){if(R.aborted){I(new DTe);return}R.addEventListener("abort",k)}let V=F=>{si(`session ${r} encountered error during ${m.method} ${e.href}: ${F}`),I(F)};S.once("error",V),w=S.request({":method":h,":path":c,...g}),w.once("response",F=>{S.off("error",V),R&&R.removeEventListener("abort",k),x(NTe(F,w,m.decode,I))}),w.once("error",F=>{S.off("error",V),R&&R.removeEventListener("abort",k),w.rstCode!==jL&&(si(`${m.method} ${e.href} failed with: ${F.message}`),w.close(jL),I(F))}),w.once("frameError",(F,K,$)=>{S.off("error",V),si(`encountered frameError during ${m.method} ${e.href}: type: ${F}, code: ${K}, id: ${$}`)}),w.on("push",(F,K)=>{si(`received 'push' event: headers: ${JSON.stringify(F)}, flags: ${K}`)}),b instanceof mit?b.pipe(w):(b&&w.write(b),w.end())})};LTe.exports={request:xit,setupContext:yit,resetContext:bit}});var FTe=P((ykn,MTe)=>{"use strict";var{EventEmitter:Sit}=require("events"),Iit=()=>{let n={},e=new Sit;return e.setMaxListeners(0),{acquire:t=>new Promise(r=>{if(!n[t]){n[t]=!0,r();return}let o=s=>{n[t]||(n[t]=!0,e.removeListener(t,o),r(s))};e.on(t,o)}),release:(t,r)=>{Reflect.deleteProperty(n,t),setImmediate(()=>e.emit(t,r))}}};MTe.exports=Iit});var UTe=P((bkn,Tit)=>{Tit.exports={name:"@adobe/helix-fetch",version:"3.1.1",description:"Light-weight Fetch implementation transparently supporting both HTTP/1(.1) and HTTP/2",main:"src/index.js",scripts:{test:"nyc mocha",lint:"./node_modules/.bin/eslint .","semantic-release":"semantic-release"},mocha:{timeout:"5000",recursive:"true",reporter:"mocha-multi-reporters","reporter-options":"configFile=.mocha-multi.json"},engines:{node:">=12.0"},types:"src/index.d.ts",exports:{import:"./src/index.mjs",require:"./src/index.js"},repository:{type:"git",url:"https://github.com/adobe/helix-fetch"},author:"",license:"Apache-2.0",bugs:{url:"https://github.com/adobe/helix-fetch/issues"},homepage:"https://github.com/adobe/helix-fetch#readme",keywords:["fetch","whatwg","Fetch API","http","https","http2","h2","promise","async","request","RFC 7234","7234","caching","cache"],dependencies:{debug:"4.3.4","http-cache-semantics":"^4.1.1","lru-cache":"7.13.1"},devDependencies:{"@adobe/eslint-config-helix":"1.3.2","@semantic-release/changelog":"6.0.1","@semantic-release/git":"10.0.1",chai:"4.3.6","chai-as-promised":"7.1.1","chai-bytes":"0.1.2","chai-iterator":"3.0.2",eslint:"8.21.0","eslint-plugin-header":"3.1.1","eslint-plugin-import":"2.26.0","formdata-node":"4.3.3","lint-staged":"13.0.3",mocha:"10.0.0","mocha-multi-reporters":"1.5.1",nock:"13.2.9",nyc:"15.1.0","parse-cache-control":"1.0.1",pem:"1.14.6",proxy:"^1.0.2","semantic-release":"19.0.3",sinon:"14.0.0","stream-buffers":"3.0.2",tunnel:"^0.0.6"},"lint-staged":{"*.js":"eslint"},config:{commitizen:{path:"node_modules/cz-conventional-changelog"},ghooks:{"pre-commit":"npx lint-staged"}}}});var VTe=P((_kn,HTe)=>{"use strict";var{Readable:Cit}=require("stream"),Eit=require("tls"),{types:{isAnyArrayBuffer:wit}}=require("util"),kit=ate(),bte=$d()("helix-fetch:core"),{RequestAbortedError:y7}=v7(),_te=ATe(),b7=OTe(),Rit=FTe(),{isPlainObject:Pit}=Fh(),{isFormData:Ait,FormDataSerializer:Dit}=qL(),{version:Nit}=UTe(),xte="h2",Ste="h2c",Ite="http/1.0",Zx="http/1.1",Lit=100,Oit=60*60*1e3,Mit=[xte,Zx,Ite],Fit=`helix-fetch/${Nit}`,Uit={method:"GET",compress:!0,decode:!0},BTe=0,qTe=Rit(),jTe=(n,e)=>new Promise((t,r)=>{let{signal:o}=e,s,a=()=>{o.removeEventListener("abort",a);let u=new y7;r(u),s&&s.destroy(u)};if(o){if(o.aborted){r(new y7);return}o.addEventListener("abort",a)}let c=+n.port||443,l=u=>{o&&o.removeEventListener("abort",a),u instanceof y7||(bte(`connecting to ${n.hostname}:${c} failed with: ${u.message}`),r(u))};s=Eit.connect(c,n.hostname,e),s.once("secureConnect",()=>{o&&o.removeEventListener("abort",a),s.off("error",l),BTe+=1,s.id=BTe,s.secureConnecting=!1,bte(`established TLS connection: #${s.id} (${s.servername})`),t(s)}),s.once("error",l)}),Bit=async(n,e)=>{let t=await qTe.acquire(n.origin);try{return t||(t=await jTe(n,e)),t}finally{qTe.release(n.origin,t)}},qit=async(n,e,t)=>{let r=`${e.protocol}//${e.host}`,o=n.alpnCache.get(r);if(o)return{protocol:o};switch(e.protocol){case"http:":return o=Zx,n.alpnCache.set(r,o),{protocol:o};case"http2:":return o=Ste,n.alpnCache.set(r,o),{protocol:o};case"https:":break;default:throw new TypeError(`unsupported protocol: ${e.protocol}`)}let{options:{rejectUnauthorized:s,h1:a={},h2:c={}}}=n,l=!(s===!1||a.rejectUnauthorized===!1||c.rejectUnauthorized===!1),u={servername:e.hostname,ALPNProtocols:n.alpnProtocols,signal:t,rejectUnauthorized:l};n.options.ca&&(u.ca=n.options.ca);let d=await Bit(e,u);return o=d.alpnProtocol,o||(o=Zx),n.alpnCache.set(r,o),{protocol:o,socket:d}},jit=n=>{let e={};return Object.keys(n).forEach(t=>{e[t.toLowerCase()]=n[t]}),e},Hit=async(n,e,t,r)=>{let o=e.protocol==="https:",s;e.port?s=e.port:o?s=443:s=80;let a={...t,host:e.host,hostname:e.hostname,port:s},c=await n(a);if(o){let u={...a,ALPNProtocols:r};u.socket=c,u.servername=a.host;let d=await jTe(e,u);return{protocol:d.alpnProtocol||Zx,socket:d}}return{protocol:c.alpnProtocol||Zx,socket:c}},Vit=async(n,e,t)=>{let r=new URL(e),o={...Uit,...t||{}};typeof o.method=="string"&&(o.method=o.method.toUpperCase()),o.headers=jit(o.headers||{}),o.headers.host===void 0&&(o.headers.host=r.host),n.userAgent&&o.headers["user-agent"]===void 0&&(o.headers["user-agent"]=n.userAgent);let s;if(o.body instanceof URLSearchParams)s="application/x-www-form-urlencoded; charset=utf-8",o.body=o.body.toString();else if(Ait(o.body)){let u=new Dit(o.body);s=u.contentType(),o.body=u.stream(),o.headers["transfer-encoding"]===void 0&&o.headers["content-length"]===void 0&&(o.headers["content-length"]=String(u.length()))}else typeof o.body=="string"||o.body instanceof String?s="text/plain; charset=utf-8":Pit(o.body)?(o.body=JSON.stringify(o.body),s="application/json"):wit(o.body)&&(o.body=Buffer.from(o.body));o.headers["content-type"]===void 0&&s!==void 0&&(o.headers["content-type"]=s),o.body!=null&&(o.body instanceof Cit||(!(typeof o.body=="string"||o.body instanceof String)&&!Buffer.isBuffer(o.body)&&(o.body=String(o.body)),o.headers["transfer-encoding"]===void 0&&o.headers["content-length"]===void 0&&(o.headers["content-length"]=String(Buffer.isBuffer(o.body)?o.body.length:Buffer.byteLength(o.body,"utf-8"))))),o.headers.accept===void 0&&(o.headers.accept="*/*"),o.body==null&&["POST","PUT"].includes(o.method)&&(o.headers["content-length"]="0"),o.compress&&o.headers["accept-encoding"]===void 0&&(o.headers["accept-encoding"]="gzip,deflate,br");let{signal:a}=o,{protocol:c,socket:l=null}=n.socketFactory?await Hit(n.socketFactory,r,o,n.alpnProtocols):await qit(n,r,a);switch(bte(`${r.host} -> ${c}`),c){case xte:try{return await b7.request(n,r,l?{...o,socket:l}:o)}catch(u){let{code:d,message:p}=u;throw d==="ERR_HTTP2_ERROR"&&p==="Protocol error"&&n.alpnCache.delete(`${r.protocol}//${r.host}`),u}case Ste:return b7.request(n,new URL(`http://${r.host}${r.pathname}${r.hash}${r.search}`),l?{...o,socket:l}:o);case Ite:case Zx:return _te.request(n,r,l?{...o,socket:l}:o);default:throw new TypeError(`unsupported protocol: ${c}`)}},Git=async n=>(n.alpnCache.clear(),Promise.all([_te.resetContext(n),b7.resetContext(n)])),zit=n=>{let{options:{alpnProtocols:e=Mit,alpnCacheTTL:t=Oit,alpnCacheSize:r=Lit,userAgent:o=Fit,socketFactory:s}}=n;n.alpnProtocols=e,n.alpnCache=new kit({max:r,ttl:t}),n.userAgent=o,n.socketFactory=s,_te.setupContext(n),b7.setupContext(n)};HTe.exports={request:Vit,setupContext:zit,resetContext:Git,RequestAbortedError:y7,ALPN_HTTP2:xte,ALPN_HTTP2C:Ste,ALPN_HTTP1_1:Zx,ALPN_HTTP1_0:Ite}});var zTe=P((xkn,GTe)=>{"use strict";var $it=$d()("helix-fetch:core"),{request:Wit,setupContext:Kit,resetContext:Yit,RequestAbortedError:Qit,ALPN_HTTP2:Xit,ALPN_HTTP2C:Jit,ALPN_HTTP1_1:Zit,ALPN_HTTP1_0:eot}=VTe(),Tte=class n{constructor(e){this.options={...e||{}},Kit(this)}api(){return{request:async(e,t)=>this.request(e,t),context:(e={})=>new n(e).api(),setCA:e=>this.setCA(e),reset:async()=>this.reset(),RequestAbortedError:Qit,ALPN_HTTP2:Xit,ALPN_HTTP2C:Jit,ALPN_HTTP1_1:Zit,ALPN_HTTP1_0:eot}}async request(e,t){return Wit(this,e,t)}setCA(e){this.options.ca=e}async reset(){return $it("resetting context"),Yit(this)}};GTe.exports=new Tte().api()});var QTe=P((Skn,YTe)=>{"use strict";var{EventEmitter:tot}=require("events"),{Readable:HL}=require("stream"),Cte=$d()("helix-fetch"),not=ate(),{Body:rot}=u7(),{Headers:Rte}=ow(),{Request:eS}=hTe(),{Response:wte}=mte(),{FetchBaseError:iot,FetchError:VL,AbortError:_7}=ute(),{AbortController:oot,AbortSignal:sot,TimeoutSignal:aot}=dte(),cot=STe(),{cacheableResponse:lot}=CTe(),{sizeof:uot}=Fh(),{isFormData:dot}=qL(),{context:pot,RequestAbortedError:fot}=zTe(),$Te=["GET","HEAD"],mot=500,hot=100*1024*1024,Ete="push",WTe=async(n,e,t)=>{let{request:r}=n.context,o=e instanceof eS&&typeof t>"u"?e:new eS(e,t),{method:s,body:a,signal:c,compress:l,decode:u,follow:d,redirect:p,init:{body:f}}=o,m;if(c&&c.aborted){let S=new _7("The operation was aborted.");throw o.init.body instanceof HL&&o.init.body.destroy(S),S}try{m=await r(o.url,{...t,method:s,headers:o.headers.plain(),body:f&&!(f instanceof HL)&&!dot(f)?f:a,compress:l,decode:u,follow:d,redirect:p,signal:c})}catch(S){throw f instanceof HL&&f.destroy(S),S instanceof TypeError?S:S instanceof fot?new _7("The operation was aborted."):new VL(S.message,"system",S)}let h=()=>{c.removeEventListener("abort",h);let S=new _7("The operation was aborted.");o.init.body instanceof HL&&o.init.body.destroy(S),m.readable.emit("error",S)};c&&c.addEventListener("abort",h);let{statusCode:g,statusText:y,httpVersion:b,headers:_,readable:x,decoded:I}=m;if([301,302,303,307,308].includes(g)){let{location:S}=_,w=S==null?null:new URL(S,o.url);switch(o.redirect){case"manual":break;case"error":throw c&&c.removeEventListener("abort",h),new VL(`uri requested responds with a redirect, redirect mode is set to 'error': ${o.url}`,"no-redirect");case"follow":{if(w===null)break;if(o.counter>=o.follow)throw c&&c.removeEventListener("abort",h),new VL(`maximum redirect reached at: ${o.url}`,"max-redirect");let R={headers:new Rte(o.headers),follow:o.follow,compress:o.compress,decode:o.decode,counter:o.counter+1,method:o.method,body:o.body,signal:o.signal};if(g!==303&&o.body&&o.init.body instanceof HL)throw c&&c.removeEventListener("abort",h),new VL("Cannot follow redirect with body being a readable stream","unsupported-redirect");return(g===303||(g===301||g===302)&&o.method==="POST")&&(R.method="GET",R.body=void 0,R.headers.delete("content-length")),c&&c.removeEventListener("abort",h),WTe(n,new eS(w,R))}default:}}return c&&(x.once("end",()=>{c.removeEventListener("abort",h)}),x.once("error",()=>{c.removeEventListener("abort",h)})),new wte(x,{url:o.url,status:g,statusText:y,headers:_,httpVersion:b,decoded:I,counter:o.counter})},KTe=async(n,e,t)=>{if(n.options.maxCacheSize===0||!$Te.includes(e.method))return t;let r=new cot(e,t,{shared:!1});if(r.storable()){let o=await lot(t);return n.cache.set(e.url,{policy:r,response:o},r.timeToLive()),o}else return t},got=async(n,e,t)=>{let r=new eS(e,t);if(n.options.maxCacheSize!==0&&$Te.includes(r.method)&&!["no-store","reload"].includes(r.cache)){let{policy:a,response:c}=n.cache.get(r.url)||{};if(a&&a.satisfiesWithoutRevalidation(r)){c.headers=new Rte(a.responseHeaders(c));let l=c.clone();return l.fromCache=!0,l}}let s=await WTe(n,r);return r.cache!=="no-store"?KTe(n,r,s):s},vot=(n,e={})=>{let t=new URL(n);if(typeof e!="object"||Array.isArray(e))throw new TypeError("qs: object expected");return Object.entries(e).forEach(([r,o])=>{Array.isArray(o)?o.forEach(s=>t.searchParams.append(r,s)):t.searchParams.append(r,o)}),t.href},yot=n=>new aot(n),kte=class n{constructor(e){this.options={...e};let{maxCacheSize:t}=this.options,r=typeof t=="number"&&t>=0?t:hot,o=mot;r===0&&(r=1,o=1);let s=({response:c},l)=>uot(c);this.cache=new not({max:o,maxSize:r,sizeCalculation:s}),this.eventEmitter=new tot,this.options.h2=this.options.h2||{},typeof this.options.h2.enablePush>"u"&&(this.options.h2.enablePush=!0);let{enablePush:a}=this.options.h2;a&&(this.options.h2.pushPromiseHandler=(c,l,u)=>{let d={...l};Object.keys(d).filter(p=>p.startsWith(":")).forEach(p=>delete d[p]),this.pushPromiseHandler(c,d,u)},this.options.h2.pushHandler=(c,l,u)=>{let d={...l};Object.keys(d).filter(b=>b.startsWith(":")).forEach(b=>delete d[b]);let{statusCode:p,statusText:f,httpVersion:m,headers:h,readable:g,decoded:y}=u;this.pushHandler(c,d,new wte(g,{url:c,status:p,statusText:f,headers:h,httpVersion:m,decoded:y}))}),this.context=pot(this.options)}api(){return{fetch:async(e,t)=>this.fetch(e,t),Body:rot,Headers:Rte,Request:eS,Response:wte,AbortController:oot,AbortSignal:sot,FetchBaseError:iot,FetchError:VL,AbortError:_7,context:(e={})=>new n(e).api(),setCA:e=>this.setCA(e),noCache:(e={})=>new n({...e,maxCacheSize:0}).api(),h1:(e={})=>new n({...e,alpnProtocols:[this.context.ALPN_HTTP1_1]}).api(),keepAlive:(e={})=>new n({...e,alpnProtocols:[this.context.ALPN_HTTP1_1],h1:{keepAlive:!0}}).api(),h1NoCache:(e={})=>new n({...e,maxCacheSize:0,alpnProtocols:[this.context.ALPN_HTTP1_1]}).api(),keepAliveNoCache:(e={})=>new n({...e,maxCacheSize:0,alpnProtocols:[this.context.ALPN_HTTP1_1],h1:{keepAlive:!0}}).api(),reset:async()=>this.context.reset(),onPush:e=>this.onPush(e),offPush:e=>this.offPush(e),createUrl:vot,timeoutSignal:yot,clearCache:()=>this.clearCache(),cacheStats:()=>this.cacheStats(),ALPN_HTTP2:this.context.ALPN_HTTP2,ALPN_HTTP2C:this.context.ALPN_HTTP2C,ALPN_HTTP1_1:this.context.ALPN_HTTP1_1,ALPN_HTTP1_0:this.context.ALPN_HTTP1_0}}async fetch(e,t){return got(this,e,t)}setCA(e){this.options.ca=e,this.context.setCA(e)}onPush(e){return this.eventEmitter.on(Ete,e)}offPush(e){return this.eventEmitter.off(Ete,e)}clearCache(){this.cache.clear()}cacheStats(){return{size:this.cache.calculatedSize,count:this.cache.size}}pushPromiseHandler(e,t,r){Cte(`received server push promise: ${e}, headers: ${JSON.stringify(t)}`);let o=new eS(e,{headers:t}),{policy:s}=this.cache.get(e)||{};s&&s.satisfiesWithoutRevalidation(o)&&(Cte(`already cached, reject push promise: ${e}, headers: ${JSON.stringify(t)}`),r())}async pushHandler(e,t,r){Cte(`caching resource pushed by server: ${e}, reqHeaders: ${JSON.stringify(t)}, status: ${r.status}, respHeaders: ${JSON.stringify(r.headers)}`);let o=await KTe(this,new eS(e,{headers:t}),r);this.eventEmitter.emit(Ete,e,o)}};YTe.exports=new kte().api()});var JTe=P((Ikn,XTe)=>{"use strict";XTe.exports=QTe()});var In=P((Qkn,tCe)=>{tCe.exports={options:{usePureJavaScript:!1}}});var iCe=P((Xkn,rCe)=>{var Dte={};rCe.exports=Dte;var nCe={};Dte.encode=function(n,e,t){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(t!==void 0&&typeof t!="number")throw new TypeError('"maxline" must be a number.');var r="";if(!(n instanceof Uint8Array))r=_ot(n,e);else{var o=0,s=e.length,a=e.charAt(0),c=[0];for(o=0;o<n.length;++o){for(var l=0,u=n[o];l<c.length;++l)u+=c[l]<<8,c[l]=u%s,u=u/s|0;for(;u>0;)c.push(u%s),u=u/s|0}for(o=0;n[o]===0&&o<n.length-1;++o)r+=a;for(o=c.length-1;o>=0;--o)r+=e[c[o]]}if(t){var d=new RegExp(".{1,"+t+"}","g");r=r.match(d).join(`\r
`)}return r};Dte.decode=function(n,e){if(typeof n!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var t=nCe[e];if(!t){t=nCe[e]=[];for(var r=0;r<e.length;++r)t[e.charCodeAt(r)]=r}n=n.replace(/\s/g,"");for(var o=e.length,s=e.charAt(0),a=[0],r=0;r<n.length;r++){var c=t[n.charCodeAt(r)];if(c===void 0)return;for(var l=0,u=c;l<a.length;++l)u+=a[l]*o,a[l]=u&255,u>>=8;for(;u>0;)a.push(u&255),u>>=8}for(var d=0;n[d]===s&&d<n.length-1;++d)a.push(0);return typeof Buffer<"u"?Buffer.from(a.reverse()):new Uint8Array(a.reverse())};function _ot(n,e){var t=0,r=e.length,o=e.charAt(0),s=[0];for(t=0;t<n.length();++t){for(var a=0,c=n.at(t);a<s.length;++a)c+=s[a]<<8,s[a]=c%r,c=c/r|0;for(;c>0;)s.push(c%r),c=c/r|0}var l="";for(t=0;n.at(t)===0&&t<n.length()-1;++t)l+=o;for(t=s.length-1;t>=0;--t)l+=e[s[t]];return l}});var rr=P((Jkn,cCe)=>{var oCe=In(),sCe=iCe(),ee=cCe.exports=oCe.util=oCe.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){ee.nextTick=process.nextTick,typeof setImmediate=="function"?ee.setImmediate=setImmediate:ee.setImmediate=ee.nextTick;return}if(typeof setImmediate=="function"){ee.setImmediate=function(){return setImmediate.apply(void 0,arguments)},ee.nextTick=function(c){return setImmediate(c)};return}if(ee.setImmediate=function(c){setTimeout(c,0)},typeof window<"u"&&typeof window.postMessage=="function"){let c=function(l){if(l.source===window&&l.data===n){l.stopPropagation();var u=e.slice();e.length=0,u.forEach(function(d){d()})}};var a=c,n="forge.setImmediate",e=[];ee.setImmediate=function(l){e.push(l),e.length===1&&window.postMessage(n,"*")},window.addEventListener("message",c,!0)}if(typeof MutationObserver<"u"){var t=Date.now(),r=!0,o=document.createElement("div"),e=[];new MutationObserver(function(){var l=e.slice();e.length=0,l.forEach(function(u){u()})}).observe(o,{attributes:!0});var s=ee.setImmediate;ee.setImmediate=function(l){Date.now()-t>15?(t=Date.now(),s(l)):(e.push(l),e.length===1&&o.setAttribute("a",r=!r))}}ee.nextTick=ee.setImmediate})();ee.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;ee.globalScope=function(){return ee.isNodejs?global:typeof self>"u"?window:self}();ee.isArray=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};ee.isArrayBuffer=function(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer};ee.isArrayBufferView=function(n){return n&&ee.isArrayBuffer(n.buffer)&&n.byteLength!==void 0};function GL(n){if(!(n===8||n===16||n===24||n===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+n)}ee.ByteBuffer=Nte;function Nte(n){if(this.data="",this.read=0,typeof n=="string")this.data=n;else if(ee.isArrayBuffer(n)||ee.isArrayBufferView(n))if(typeof Buffer<"u"&&n instanceof Buffer)this.data=n.toString("binary");else{var e=new Uint8Array(n);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var t=0;t<e.length;++t)this.putByte(e[t])}}else(n instanceof Nte||typeof n=="object"&&typeof n.data=="string"&&typeof n.read=="number")&&(this.data=n.data,this.read=n.read);this._constructedStringLength=0}ee.ByteStringBuffer=Nte;var xot=4096;ee.ByteStringBuffer.prototype._optimizeConstructedString=function(n){this._constructedStringLength+=n,this._constructedStringLength>xot&&(this.data.substr(0,1),this._constructedStringLength=0)};ee.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};ee.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};ee.ByteStringBuffer.prototype.putByte=function(n){return this.putBytes(String.fromCharCode(n))};ee.ByteStringBuffer.prototype.fillWithByte=function(n,e){n=String.fromCharCode(n);for(var t=this.data;e>0;)e&1&&(t+=n),e>>>=1,e>0&&(n+=n);return this.data=t,this._optimizeConstructedString(e),this};ee.ByteStringBuffer.prototype.putBytes=function(n){return this.data+=n,this._optimizeConstructedString(n.length),this};ee.ByteStringBuffer.prototype.putString=function(n){return this.putBytes(ee.encodeUtf8(n))};ee.ByteStringBuffer.prototype.putInt16=function(n){return this.putBytes(String.fromCharCode(n>>8&255)+String.fromCharCode(n&255))};ee.ByteStringBuffer.prototype.putInt24=function(n){return this.putBytes(String.fromCharCode(n>>16&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n&255))};ee.ByteStringBuffer.prototype.putInt32=function(n){return this.putBytes(String.fromCharCode(n>>24&255)+String.fromCharCode(n>>16&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n&255))};ee.ByteStringBuffer.prototype.putInt16Le=function(n){return this.putBytes(String.fromCharCode(n&255)+String.fromCharCode(n>>8&255))};ee.ByteStringBuffer.prototype.putInt24Le=function(n){return this.putBytes(String.fromCharCode(n&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n>>16&255))};ee.ByteStringBuffer.prototype.putInt32Le=function(n){return this.putBytes(String.fromCharCode(n&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n>>16&255)+String.fromCharCode(n>>24&255))};ee.ByteStringBuffer.prototype.putInt=function(n,e){GL(e);var t="";do e-=8,t+=String.fromCharCode(n>>e&255);while(e>0);return this.putBytes(t)};ee.ByteStringBuffer.prototype.putSignedInt=function(n,e){return n<0&&(n+=2<<e-1),this.putInt(n,e)};ee.ByteStringBuffer.prototype.putBuffer=function(n){return this.putBytes(n.getBytes())};ee.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};ee.ByteStringBuffer.prototype.getInt16=function(){var n=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,n};ee.ByteStringBuffer.prototype.getInt24=function(){var n=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,n};ee.ByteStringBuffer.prototype.getInt32=function(){var n=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,n};ee.ByteStringBuffer.prototype.getInt16Le=function(){var n=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,n};ee.ByteStringBuffer.prototype.getInt24Le=function(){var n=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,n};ee.ByteStringBuffer.prototype.getInt32Le=function(){var n=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,n};ee.ByteStringBuffer.prototype.getInt=function(n){GL(n);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),n-=8;while(n>0);return e};ee.ByteStringBuffer.prototype.getSignedInt=function(n){var e=this.getInt(n),t=2<<n-2;return e>=t&&(e-=t<<1),e};ee.ByteStringBuffer.prototype.getBytes=function(n){var e;return n?(n=Math.min(this.length(),n),e=this.data.slice(this.read,this.read+n),this.read+=n):n===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};ee.ByteStringBuffer.prototype.bytes=function(n){return typeof n>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+n)};ee.ByteStringBuffer.prototype.at=function(n){return this.data.charCodeAt(this.read+n)};ee.ByteStringBuffer.prototype.setAt=function(n,e){return this.data=this.data.substr(0,this.read+n)+String.fromCharCode(e)+this.data.substr(this.read+n+1),this};ee.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};ee.ByteStringBuffer.prototype.copy=function(){var n=ee.createBuffer(this.data);return n.read=this.read,n};ee.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};ee.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};ee.ByteStringBuffer.prototype.truncate=function(n){var e=Math.max(0,this.length()-n);return this.data=this.data.substr(this.read,e),this.read=0,this};ee.ByteStringBuffer.prototype.toHex=function(){for(var n="",e=this.read;e<this.data.length;++e){var t=this.data.charCodeAt(e);t<16&&(n+="0"),n+=t.toString(16)}return n};ee.ByteStringBuffer.prototype.toString=function(){return ee.decodeUtf8(this.bytes())};function Sot(n,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var t=ee.isArrayBuffer(n),r=ee.isArrayBufferView(n);if(t||r){t?this.data=new DataView(n):this.data=new DataView(n.buffer,n.byteOffset,n.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,n!=null&&this.putBytes(n),"writeOffset"in e&&(this.write=e.writeOffset)}ee.DataBuffer=Sot;ee.DataBuffer.prototype.length=function(){return this.write-this.read};ee.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};ee.DataBuffer.prototype.accommodate=function(n,e){if(this.length()>=n)return this;e=Math.max(e||this.growSize,n);var t=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),r=new Uint8Array(this.length()+e);return r.set(t),this.data=new DataView(r.buffer),this};ee.DataBuffer.prototype.putByte=function(n){return this.accommodate(1),this.data.setUint8(this.write++,n),this};ee.DataBuffer.prototype.fillWithByte=function(n,e){this.accommodate(e);for(var t=0;t<e;++t)this.data.setUint8(n);return this};ee.DataBuffer.prototype.putBytes=function(n,e){if(ee.isArrayBufferView(n)){var t=new Uint8Array(n.buffer,n.byteOffset,n.byteLength),r=t.byteLength-t.byteOffset;this.accommodate(r);var o=new Uint8Array(this.data.buffer,this.write);return o.set(t),this.write+=r,this}if(ee.isArrayBuffer(n)){var t=new Uint8Array(n);this.accommodate(t.byteLength);var o=new Uint8Array(this.data.buffer);return o.set(t,this.write),this.write+=t.byteLength,this}if(n instanceof ee.DataBuffer||typeof n=="object"&&typeof n.read=="number"&&typeof n.write=="number"&&ee.isArrayBufferView(n.data)){var t=new Uint8Array(n.data.byteLength,n.read,n.length());this.accommodate(t.byteLength);var o=new Uint8Array(n.data.byteLength,this.write);return o.set(t),this.write+=t.byteLength,this}if(n instanceof ee.ByteStringBuffer&&(n=n.data,e="binary"),e=e||"binary",typeof n=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(n.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=ee.binary.hex.decode(n,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(n.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=ee.binary.base64.decode(n,s,this.write),this;if(e==="utf8"&&(n=ee.encodeUtf8(n),e="binary"),e==="binary"||e==="raw")return this.accommodate(n.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=ee.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(n.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=ee.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+n)};ee.DataBuffer.prototype.putBuffer=function(n){return this.putBytes(n),n.clear(),this};ee.DataBuffer.prototype.putString=function(n){return this.putBytes(n,"utf16")};ee.DataBuffer.prototype.putInt16=function(n){return this.accommodate(2),this.data.setInt16(this.write,n),this.write+=2,this};ee.DataBuffer.prototype.putInt24=function(n){return this.accommodate(3),this.data.setInt16(this.write,n>>8&65535),this.data.setInt8(this.write,n>>16&255),this.write+=3,this};ee.DataBuffer.prototype.putInt32=function(n){return this.accommodate(4),this.data.setInt32(this.write,n),this.write+=4,this};ee.DataBuffer.prototype.putInt16Le=function(n){return this.accommodate(2),this.data.setInt16(this.write,n,!0),this.write+=2,this};ee.DataBuffer.prototype.putInt24Le=function(n){return this.accommodate(3),this.data.setInt8(this.write,n>>16&255),this.data.setInt16(this.write,n>>8&65535,!0),this.write+=3,this};ee.DataBuffer.prototype.putInt32Le=function(n){return this.accommodate(4),this.data.setInt32(this.write,n,!0),this.write+=4,this};ee.DataBuffer.prototype.putInt=function(n,e){GL(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,n>>e&255);while(e>0);return this};ee.DataBuffer.prototype.putSignedInt=function(n,e){return GL(e),this.accommodate(e/8),n<0&&(n+=2<<e-1),this.putInt(n,e)};ee.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};ee.DataBuffer.prototype.getInt16=function(){var n=this.data.getInt16(this.read);return this.read+=2,n};ee.DataBuffer.prototype.getInt24=function(){var n=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,n};ee.DataBuffer.prototype.getInt32=function(){var n=this.data.getInt32(this.read);return this.read+=4,n};ee.DataBuffer.prototype.getInt16Le=function(){var n=this.data.getInt16(this.read,!0);return this.read+=2,n};ee.DataBuffer.prototype.getInt24Le=function(){var n=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,n};ee.DataBuffer.prototype.getInt32Le=function(){var n=this.data.getInt32(this.read,!0);return this.read+=4,n};ee.DataBuffer.prototype.getInt=function(n){GL(n);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),n-=8;while(n>0);return e};ee.DataBuffer.prototype.getSignedInt=function(n){var e=this.getInt(n),t=2<<n-2;return e>=t&&(e-=t<<1),e};ee.DataBuffer.prototype.getBytes=function(n){var e;return n?(n=Math.min(this.length(),n),e=this.data.slice(this.read,this.read+n),this.read+=n):n===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};ee.DataBuffer.prototype.bytes=function(n){return typeof n>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+n)};ee.DataBuffer.prototype.at=function(n){return this.data.getUint8(this.read+n)};ee.DataBuffer.prototype.setAt=function(n,e){return this.data.setUint8(n,e),this};ee.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};ee.DataBuffer.prototype.copy=function(){return new ee.DataBuffer(this)};ee.DataBuffer.prototype.compact=function(){if(this.read>0){var n=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(n.byteLength);e.set(n),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};ee.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};ee.DataBuffer.prototype.truncate=function(n){return this.write=Math.max(0,this.length()-n),this.read=Math.min(this.read,this.write),this};ee.DataBuffer.prototype.toHex=function(){for(var n="",e=this.read;e<this.data.byteLength;++e){var t=this.data.getUint8(e);t<16&&(n+="0"),n+=t.toString(16)}return n};ee.DataBuffer.prototype.toString=function(n){var e=new Uint8Array(this.data,this.read,this.length());if(n=n||"utf8",n==="binary"||n==="raw")return ee.binary.raw.encode(e);if(n==="hex")return ee.binary.hex.encode(e);if(n==="base64")return ee.binary.base64.encode(e);if(n==="utf8")return ee.text.utf8.decode(e);if(n==="utf16")return ee.text.utf16.decode(e);throw new Error("Invalid encoding: "+n)};ee.createBuffer=function(n,e){return e=e||"raw",n!==void 0&&e==="utf8"&&(n=ee.encodeUtf8(n)),new ee.ByteBuffer(n)};ee.fillString=function(n,e){for(var t="";e>0;)e&1&&(t+=n),e>>>=1,e>0&&(n+=n);return t};ee.xorBytes=function(n,e,t){for(var r="",o="",s="",a=0,c=0;t>0;--t,++a)o=n.charCodeAt(a)^e.charCodeAt(a),c>=10&&(r+=s,s="",c=0),s+=String.fromCharCode(o),++c;return r+=s,r};ee.hexToBytes=function(n){var e="",t=0;for(n.length&!0&&(t=1,e+=String.fromCharCode(parseInt(n[0],16)));t<n.length;t+=2)e+=String.fromCharCode(parseInt(n.substr(t,2),16));return e};ee.bytesToHex=function(n){return ee.createBuffer(n).toHex()};ee.int32ToBytes=function(n){return String.fromCharCode(n>>24&255)+String.fromCharCode(n>>16&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n&255)};var hy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",gy=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],aCe="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";ee.encode64=function(n,e){for(var t="",r="",o,s,a,c=0;c<n.length;)o=n.charCodeAt(c++),s=n.charCodeAt(c++),a=n.charCodeAt(c++),t+=hy.charAt(o>>2),t+=hy.charAt((o&3)<<4|s>>4),isNaN(s)?t+="==":(t+=hy.charAt((s&15)<<2|a>>6),t+=isNaN(a)?"=":hy.charAt(a&63)),e&&t.length>e&&(r+=t.substr(0,e)+`\r
`,t=t.substr(e));return r+=t,r};ee.decode64=function(n){n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",t,r,o,s,a=0;a<n.length;)t=gy[n.charCodeAt(a++)-43],r=gy[n.charCodeAt(a++)-43],o=gy[n.charCodeAt(a++)-43],s=gy[n.charCodeAt(a++)-43],e+=String.fromCharCode(t<<2|r>>4),o!==64&&(e+=String.fromCharCode((r&15)<<4|o>>2),s!==64&&(e+=String.fromCharCode((o&3)<<6|s)));return e};ee.encodeUtf8=function(n){return unescape(encodeURIComponent(n))};ee.decodeUtf8=function(n){return decodeURIComponent(escape(n))};ee.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:sCe.encode,decode:sCe.decode}};ee.binary.raw.encode=function(n){return String.fromCharCode.apply(null,n)};ee.binary.raw.decode=function(n,e,t){var r=e;r||(r=new Uint8Array(n.length)),t=t||0;for(var o=t,s=0;s<n.length;++s)r[o++]=n.charCodeAt(s);return e?o-t:r};ee.binary.hex.encode=ee.bytesToHex;ee.binary.hex.decode=function(n,e,t){var r=e;r||(r=new Uint8Array(Math.ceil(n.length/2))),t=t||0;var o=0,s=t;for(n.length&1&&(o=1,r[s++]=parseInt(n[0],16));o<n.length;o+=2)r[s++]=parseInt(n.substr(o,2),16);return e?s-t:r};ee.binary.base64.encode=function(n,e){for(var t="",r="",o,s,a,c=0;c<n.byteLength;)o=n[c++],s=n[c++],a=n[c++],t+=hy.charAt(o>>2),t+=hy.charAt((o&3)<<4|s>>4),isNaN(s)?t+="==":(t+=hy.charAt((s&15)<<2|a>>6),t+=isNaN(a)?"=":hy.charAt(a&63)),e&&t.length>e&&(r+=t.substr(0,e)+`\r
`,t=t.substr(e));return r+=t,r};ee.binary.base64.decode=function(n,e,t){var r=e;r||(r=new Uint8Array(Math.ceil(n.length/4)*3)),n=n.replace(/[^A-Za-z0-9\+\/\=]/g,""),t=t||0;for(var o,s,a,c,l=0,u=t;l<n.length;)o=gy[n.charCodeAt(l++)-43],s=gy[n.charCodeAt(l++)-43],a=gy[n.charCodeAt(l++)-43],c=gy[n.charCodeAt(l++)-43],r[u++]=o<<2|s>>4,a!==64&&(r[u++]=(s&15)<<4|a>>2,c!==64&&(r[u++]=(a&3)<<6|c));return e?u-t:r.subarray(0,u)};ee.binary.base58.encode=function(n,e){return ee.binary.baseN.encode(n,aCe,e)};ee.binary.base58.decode=function(n,e){return ee.binary.baseN.decode(n,aCe,e)};ee.text={utf8:{},utf16:{}};ee.text.utf8.encode=function(n,e,t){n=ee.encodeUtf8(n);var r=e;r||(r=new Uint8Array(n.length)),t=t||0;for(var o=t,s=0;s<n.length;++s)r[o++]=n.charCodeAt(s);return e?o-t:r};ee.text.utf8.decode=function(n){return ee.decodeUtf8(String.fromCharCode.apply(null,n))};ee.text.utf16.encode=function(n,e,t){var r=e;r||(r=new Uint8Array(n.length*2));var o=new Uint16Array(r.buffer);t=t||0;for(var s=t,a=t,c=0;c<n.length;++c)o[a++]=n.charCodeAt(c),s+=2;return e?s-t:r};ee.text.utf16.decode=function(n){return String.fromCharCode.apply(null,new Uint16Array(n.buffer))};ee.deflate=function(n,e,t){if(e=ee.decode64(n.deflate(ee.encode64(e)).rval),t){var r=2,o=e.charCodeAt(1);o&32&&(r=6),e=e.substring(r,e.length-4)}return e};ee.inflate=function(n,e,t){var r=n.inflate(ee.encode64(e)).rval;return r===null?null:ee.decode64(r)};var Lte=function(n,e,t){if(!n)throw new Error("WebStorage not available.");var r;if(t===null?r=n.removeItem(e):(t=ee.encode64(JSON.stringify(t)),r=n.setItem(e,t)),typeof r<"u"&&r.rval!==!0){var o=new Error(r.error.message);throw o.id=r.error.id,o.name=r.error.name,o}},Ote=function(n,e){if(!n)throw new Error("WebStorage not available.");var t=n.getItem(e);if(n.init)if(t.rval===null){if(t.error){var r=new Error(t.error.message);throw r.id=t.error.id,r.name=t.error.name,r}t=null}else t=t.rval;return t!==null&&(t=JSON.parse(ee.decode64(t))),t},Iot=function(n,e,t,r){var o=Ote(n,e);o===null&&(o={}),o[t]=r,Lte(n,e,o)},Tot=function(n,e,t){var r=Ote(n,e);return r!==null&&(r=t in r?r[t]:null),r},Cot=function(n,e,t){var r=Ote(n,e);if(r!==null&&t in r){delete r[t];var o=!0;for(var s in r){o=!1;break}o&&(r=null),Lte(n,e,r)}},Eot=function(n,e){Lte(n,e,null)},S7=function(n,e,t){var r=null;typeof t>"u"&&(t=["web","flash"]);var o,s=!1,a=null;for(var c in t){o=t[c];try{if(o==="flash"||o==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");r=n.apply(this,e),s=o==="flash"}(o==="web"||o==="both")&&(e[0]=localStorage,r=n.apply(this,e),s=!0)}catch(l){a=l}if(s)break}if(!s)throw a;return r};ee.setItem=function(n,e,t,r,o){S7(Iot,arguments,o)};ee.getItem=function(n,e,t,r){return S7(Tot,arguments,r)};ee.removeItem=function(n,e,t,r){S7(Cot,arguments,r)};ee.clearItems=function(n,e,t){S7(Eot,arguments,t)};ee.isEmpty=function(n){for(var e in n)if(n.hasOwnProperty(e))return!1;return!0};ee.format=function(n){for(var e=/%./g,t,r,o=0,s=[],a=0;t=e.exec(n);){r=n.substring(a,e.lastIndex-2),r.length>0&&s.push(r),a=e.lastIndex;var c=t[0][1];switch(c){case"s":case"o":o<arguments.length?s.push(arguments[o+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+c+"?>")}}return s.push(n.substring(a)),s.join("")};ee.formatNumber=function(n,e,t,r){var o=n,s=isNaN(e=Math.abs(e))?2:e,a=t===void 0?",":t,c=r===void 0?".":r,l=o<0?"-":"",u=parseInt(o=Math.abs(+o||0).toFixed(s),10)+"",d=u.length>3?u.length%3:0;return l+(d?u.substr(0,d)+c:"")+u.substr(d).replace(/(\d{3})(?=\d)/g,"$1"+c)+(s?a+Math.abs(o-u).toFixed(s).slice(2):"")};ee.formatSize=function(n){return n>=1073741824?n=ee.formatNumber(n/1073741824,2,".","")+" GiB":n>=1048576?n=ee.formatNumber(n/1048576,2,".","")+" MiB":n>=1024?n=ee.formatNumber(n/1024,0)+" KiB":n=ee.formatNumber(n,0)+" bytes",n};ee.bytesFromIP=function(n){return n.indexOf(".")!==-1?ee.bytesFromIPv4(n):n.indexOf(":")!==-1?ee.bytesFromIPv6(n):null};ee.bytesFromIPv4=function(n){if(n=n.split("."),n.length!==4)return null;for(var e=ee.createBuffer(),t=0;t<n.length;++t){var r=parseInt(n[t],10);if(isNaN(r))return null;e.putByte(r)}return e.getBytes()};ee.bytesFromIPv6=function(n){var e=0;n=n.split(":").filter(function(a){return a.length===0&&++e,!0});for(var t=(8-n.length+e)*2,r=ee.createBuffer(),o=0;o<8;++o){if(!n[o]||n[o].length===0){r.fillWithByte(0,t),t=0;continue}var s=ee.hexToBytes(n[o]);s.length<2&&r.putByte(0),r.putBytes(s)}return r.getBytes()};ee.bytesToIP=function(n){return n.length===4?ee.bytesToIPv4(n):n.length===16?ee.bytesToIPv6(n):null};ee.bytesToIPv4=function(n){if(n.length!==4)return null;for(var e=[],t=0;t<n.length;++t)e.push(n.charCodeAt(t));return e.join(".")};ee.bytesToIPv6=function(n){if(n.length!==16)return null;for(var e=[],t=[],r=0,o=0;o<n.length;o+=2){for(var s=ee.bytesToHex(n[o]+n[o+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var a=t[t.length-1],c=e.length;!a||c!==a.end+1?t.push({start:c,end:c}):(a.end=c,a.end-a.start>t[r].end-t[r].start&&(r=t.length-1))}e.push(s)}if(t.length>0){var l=t[r];l.end-l.start>0&&(e.splice(l.start,l.end-l.start+1,""),l.start===0&&e.unshift(""),l.end===7&&e.push(""))}return e.join(":")};ee.estimateCores=function(n,e){if(typeof n=="function"&&(e=n,n={}),n=n||{},"cores"in ee&&!n.update)return e(null,ee.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return ee.cores=navigator.hardwareConcurrency,e(null,ee.cores);if(typeof Worker>"u")return ee.cores=1,e(null,ee.cores);if(typeof Blob>"u")return ee.cores=2,e(null,ee.cores);var t=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(a){for(var c=Date.now(),l=c+4;Date.now()<l;);self.postMessage({st:c,et:l})})}.toString(),")()"],{type:"application/javascript"}));r([],5,16);function r(a,c,l){if(c===0){var u=Math.floor(a.reduce(function(d,p){return d+p},0)/a.length);return ee.cores=Math.max(1,u),URL.revokeObjectURL(t),e(null,ee.cores)}o(l,function(d,p){a.push(s(l,p)),r(a,c-1,l)})}function o(a,c){for(var l=[],u=[],d=0;d<a;++d){var p=new Worker(t);p.addEventListener("message",function(f){if(u.push(f.data),u.length===a){for(var m=0;m<a;++m)l[m].terminate();c(null,u)}}),l.push(p)}for(var d=0;d<a;++d)l[d].postMessage(d)}function s(a,c){for(var l=[],u=0;u<a;++u)for(var d=c[u],p=l[u]=[],f=0;f<a;++f)if(u!==f){var m=c[f];(d.st>m.st&&d.st<m.et||m.st>d.st&&m.st<d.et)&&p.push(f)}return l.reduce(function(h,g){return Math.max(h,g.length)},0)}}});var I7=P((Zkn,lCe)=>{var Ps=In();rr();lCe.exports=Ps.cipher=Ps.cipher||{};Ps.cipher.algorithms=Ps.cipher.algorithms||{};Ps.cipher.createCipher=function(n,e){var t=n;if(typeof t=="string"&&(t=Ps.cipher.getAlgorithm(t),t&&(t=t())),!t)throw new Error("Unsupported algorithm: "+n);return new Ps.cipher.BlockCipher({algorithm:t,key:e,decrypt:!1})};Ps.cipher.createDecipher=function(n,e){var t=n;if(typeof t=="string"&&(t=Ps.cipher.getAlgorithm(t),t&&(t=t())),!t)throw new Error("Unsupported algorithm: "+n);return new Ps.cipher.BlockCipher({algorithm:t,key:e,decrypt:!0})};Ps.cipher.registerAlgorithm=function(n,e){n=n.toUpperCase(),Ps.cipher.algorithms[n]=e};Ps.cipher.getAlgorithm=function(n){return n=n.toUpperCase(),n in Ps.cipher.algorithms?Ps.cipher.algorithms[n]:null};var Mte=Ps.cipher.BlockCipher=function(n){this.algorithm=n.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=n.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=n.decrypt,this.algorithm.initialize(n)};Mte.prototype.start=function(n){n=n||{};var e={};for(var t in n)e[t]=n[t];e.decrypt=this._decrypt,this._finish=!1,this._input=Ps.util.createBuffer(),this.output=n.output||Ps.util.createBuffer(),this.mode.start(e)};Mte.prototype.update=function(n){for(n&&this._input.putBuffer(n);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};Mte.prototype.finish=function(n){n&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(t){return n(this.blockSize,t,!1)},this.mode.unpad=function(t){return n(this.blockSize,t,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var Ute=P((eRn,uCe)=>{var As=In();rr();As.cipher=As.cipher||{};var On=uCe.exports=As.cipher.modes=As.cipher.modes||{};On.ecb=function(n){n=n||{},this.name="ECB",this.cipher=n.cipher,this.blockSize=n.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};On.ecb.prototype.start=function(n){};On.ecb.prototype.encrypt=function(n,e,t){if(n.length()<this.blockSize&&!(t&&n.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=n.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)e.putInt32(this._outBlock[r])};On.ecb.prototype.decrypt=function(n,e,t){if(n.length()<this.blockSize&&!(t&&n.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=n.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)e.putInt32(this._outBlock[r])};On.ecb.prototype.pad=function(n,e){var t=n.length()===this.blockSize?this.blockSize:this.blockSize-n.length();return n.fillWithByte(t,t),!0};On.ecb.prototype.unpad=function(n,e){if(e.overflow>0)return!1;var t=n.length(),r=n.at(t-1);return r>this.blockSize<<2?!1:(n.truncate(r),!0)};On.cbc=function(n){n=n||{},this.name="CBC",this.cipher=n.cipher,this.blockSize=n.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};On.cbc.prototype.start=function(n){if(n.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in n)this._iv=T7(n.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};On.cbc.prototype.encrypt=function(n,e,t){if(n.length()<this.blockSize&&!(t&&n.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=this._prev[r]^n.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)e.putInt32(this._outBlock[r]);this._prev=this._outBlock};On.cbc.prototype.decrypt=function(n,e,t){if(n.length()<this.blockSize&&!(t&&n.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=n.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)e.putInt32(this._prev[r]^this._outBlock[r]);this._prev=this._inBlock.slice(0)};On.cbc.prototype.pad=function(n,e){var t=n.length()===this.blockSize?this.blockSize:this.blockSize-n.length();return n.fillWithByte(t,t),!0};On.cbc.prototype.unpad=function(n,e){if(e.overflow>0)return!1;var t=n.length(),r=n.at(t-1);return r>this.blockSize<<2?!1:(n.truncate(r),!0)};On.cfb=function(n){n=n||{},this.name="CFB",this.cipher=n.cipher,this.blockSize=n.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=As.util.createBuffer(),this._partialBytes=0};On.cfb.prototype.start=function(n){if(!("iv"in n))throw new Error("Invalid IV parameter.");this._iv=T7(n.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};On.cfb.prototype.encrypt=function(n,e,t){var r=n.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var o=0;o<this._ints;++o)this._inBlock[o]=n.getInt32()^this._outBlock[o],e.putInt32(this._inBlock[o]);return}var s=(this.blockSize-r)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialBlock[o]=n.getInt32()^this._outBlock[o],this._partialOutput.putInt32(this._partialBlock[o]);if(s>0)n.read-=this.blockSize;else for(var o=0;o<this._ints;++o)this._inBlock[o]=this._partialBlock[o];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0};On.cfb.prototype.decrypt=function(n,e,t){var r=n.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var o=0;o<this._ints;++o)this._inBlock[o]=n.getInt32(),e.putInt32(this._inBlock[o]^this._outBlock[o]);return}var s=(this.blockSize-r)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialBlock[o]=n.getInt32(),this._partialOutput.putInt32(this._partialBlock[o]^this._outBlock[o]);if(s>0)n.read-=this.blockSize;else for(var o=0;o<this._ints;++o)this._inBlock[o]=this._partialBlock[o];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0};On.ofb=function(n){n=n||{},this.name="OFB",this.cipher=n.cipher,this.blockSize=n.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=As.util.createBuffer(),this._partialBytes=0};On.ofb.prototype.start=function(n){if(!("iv"in n))throw new Error("Invalid IV parameter.");this._iv=T7(n.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};On.ofb.prototype.encrypt=function(n,e,t){var r=n.length();if(n.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var o=0;o<this._ints;++o)e.putInt32(n.getInt32()^this._outBlock[o]),this._inBlock[o]=this._outBlock[o];return}var s=(this.blockSize-r)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialOutput.putInt32(n.getInt32()^this._outBlock[o]);if(s>0)n.read-=this.blockSize;else for(var o=0;o<this._ints;++o)this._inBlock[o]=this._outBlock[o];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0};On.ofb.prototype.decrypt=On.ofb.prototype.encrypt;On.ctr=function(n){n=n||{},this.name="CTR",this.cipher=n.cipher,this.blockSize=n.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=As.util.createBuffer(),this._partialBytes=0};On.ctr.prototype.start=function(n){if(!("iv"in n))throw new Error("Invalid IV parameter.");this._iv=T7(n.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};On.ctr.prototype.encrypt=function(n,e,t){var r=n.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize)for(var o=0;o<this._ints;++o)e.putInt32(n.getInt32()^this._outBlock[o]);else{var s=(this.blockSize-r)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialOutput.putInt32(n.getInt32()^this._outBlock[o]);if(s>0&&(n.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}C7(this._inBlock)};On.ctr.prototype.decrypt=On.ctr.prototype.encrypt;On.gcm=function(n){n=n||{},this.name="GCM",this.cipher=n.cipher,this.blockSize=n.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=As.util.createBuffer(),this._partialBytes=0,this._R=3774873600};On.gcm.prototype.start=function(n){if(!("iv"in n))throw new Error("Invalid IV parameter.");var e=As.util.createBuffer(n.iv);this._cipherLength=0;var t;if("additionalData"in n?t=As.util.createBuffer(n.additionalData):t=As.util.createBuffer(),"tagLength"in n?this._tagLength=n.tagLength:this._tagLength=128,this._tag=null,n.decrypt&&(this._tag=As.util.createBuffer(n.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var r=e.length();if(r===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Fte(r*8)))}this._inBlock=this._j0.slice(0),C7(this._inBlock),this._partialBytes=0,t=As.util.createBuffer(t),this._aDataLength=Fte(t.length()*8);var o=t.length()%this.blockSize;for(o&&t.fillWithByte(0,this.blockSize-o),this._s=[0,0,0,0];t.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])};On.gcm.prototype.encrypt=function(n,e,t){var r=n.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var o=0;o<this._ints;++o)e.putInt32(this._outBlock[o]^=n.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-r)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialOutput.putInt32(n.getInt32()^this._outBlock[o]);if(s<=0||t){if(t){var a=r%this.blockSize;this._cipherLength+=a,this._partialOutput.truncate(this.blockSize-a)}else this._cipherLength+=this.blockSize;for(var o=0;o<this._ints;++o)this._outBlock[o]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return n.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),C7(this._inBlock)};On.gcm.prototype.decrypt=function(n,e,t){var r=n.length();if(r<this.blockSize&&!(t&&r>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),C7(this._inBlock),this._hashBlock[0]=n.getInt32(),this._hashBlock[1]=n.getInt32(),this._hashBlock[2]=n.getInt32(),this._hashBlock[3]=n.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var o=0;o<this._ints;++o)e.putInt32(this._outBlock[o]^this._hashBlock[o]);r<this.blockSize?this._cipherLength+=r%this.blockSize:this._cipherLength+=this.blockSize};On.gcm.prototype.afterFinish=function(n,e){var t=!0;e.decrypt&&e.overflow&&n.truncate(this.blockSize-e.overflow),this.tag=As.util.createBuffer();var r=this._aDataLength.concat(Fte(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,r);var o=[];this.cipher.encrypt(this._j0,o);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^o[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(t=!1),t};On.gcm.prototype.multiply=function(n,e){for(var t=[0,0,0,0],r=e.slice(0),o=0;o<128;++o){var s=n[o/32|0]&1<<31-o%32;s&&(t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3]),this.pow(r,r)}return t};On.gcm.prototype.pow=function(n,e){for(var t=n[3]&1,r=3;r>0;--r)e[r]=n[r]>>>1|(n[r-1]&1)<<31;e[0]=n[0]>>>1,t&&(e[0]^=this._R)};On.gcm.prototype.tableMultiply=function(n){for(var e=[0,0,0,0],t=0;t<32;++t){var r=t/8|0,o=n[r]>>>(7-t%8)*4&15,s=this._m[t][o];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};On.gcm.prototype.ghash=function(n,e,t){return e[0]^=t[0],e[1]^=t[1],e[2]^=t[2],e[3]^=t[3],this.tableMultiply(e)};On.gcm.prototype.generateHashTable=function(n,e){for(var t=8/e,r=4*t,o=16*t,s=new Array(o),a=0;a<o;++a){var c=[0,0,0,0],l=a/r|0,u=(r-1-a%r)*e;c[l]=1<<e-1<<u,s[a]=this.generateSubHashTable(this.multiply(c,n),e)}return s};On.gcm.prototype.generateSubHashTable=function(n,e){var t=1<<e,r=t>>>1,o=new Array(t);o[r]=n.slice(0);for(var s=r>>>1;s>0;)this.pow(o[2*s],o[s]=[]),s>>=1;for(s=2;s<r;){for(var a=1;a<s;++a){var c=o[s],l=o[a];o[s+a]=[c[0]^l[0],c[1]^l[1],c[2]^l[2],c[3]^l[3]]}s*=2}for(o[0]=[0,0,0,0],s=r+1;s<t;++s){var u=o[s^r];o[s]=[n[0]^u[0],n[1]^u[1],n[2]^u[2],n[3]^u[3]]}return o};function T7(n,e){if(typeof n=="string"&&(n=As.util.createBuffer(n)),As.util.isArray(n)&&n.length>4){var t=n;n=As.util.createBuffer();for(var r=0;r<t.length;++r)n.putByte(t[r])}if(n.length()<e)throw new Error("Invalid IV length; got "+n.length()+" bytes and expected "+e+" bytes.");if(!As.util.isArray(n)){for(var o=[],s=e/4,r=0;r<s;++r)o.push(n.getInt32());n=o}return n}function C7(n){n[n.length-1]=n[n.length-1]+1&4294967295}function Fte(n){return[n/4294967296|0,n&4294967295]}});var vy=P((tRn,mCe)=>{var Wr=In();I7();Ute();rr();mCe.exports=Wr.aes=Wr.aes||{};Wr.aes.startEncrypting=function(n,e,t,r){var o=E7({key:n,output:t,decrypt:!1,mode:r});return o.start(e),o};Wr.aes.createEncryptionCipher=function(n,e){return E7({key:n,output:null,decrypt:!1,mode:e})};Wr.aes.startDecrypting=function(n,e,t,r){var o=E7({key:n,output:t,decrypt:!0,mode:r});return o.start(e),o};Wr.aes.createDecryptionCipher=function(n,e){return E7({key:n,output:null,decrypt:!0,mode:e})};Wr.aes.Algorithm=function(n,e){jte||pCe();var t=this;t.name=n,t.mode=new e({blockSize:16,cipher:{encrypt:function(r,o){return qte(t._w,r,o,!1)},decrypt:function(r,o){return qte(t._w,r,o,!0)}}}),t._init=!1};Wr.aes.Algorithm.prototype.initialize=function(n){if(!this._init){var e=n.key,t;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=Wr.util.createBuffer(e);else if(Wr.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){t=e,e=Wr.util.createBuffer();for(var r=0;r<t.length;++r)e.putByte(t[r])}if(!Wr.util.isArray(e)){t=e,e=[];var o=t.length();if(o===16||o===24||o===32){o=o>>>2;for(var r=0;r<o;++r)e.push(t.getInt32())}}if(!Wr.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,a=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=fCe(e,n.decrypt&&!a),this._init=!0}};Wr.aes._expandKey=function(n,e){return jte||pCe(),fCe(n,e)};Wr.aes._updateBlock=qte;lw("AES-ECB",Wr.cipher.modes.ecb);lw("AES-CBC",Wr.cipher.modes.cbc);lw("AES-CFB",Wr.cipher.modes.cfb);lw("AES-OFB",Wr.cipher.modes.ofb);lw("AES-CTR",Wr.cipher.modes.ctr);lw("AES-GCM",Wr.cipher.modes.gcm);function lw(n,e){var t=function(){return new Wr.aes.Algorithm(n,e)};Wr.cipher.registerAlgorithm(n,t)}var jte=!1,cw=4,Ga,Bte,dCe,tS,Yd;function pCe(){jte=!0,dCe=[0,1,2,4,8,16,32,64,128,27,54];for(var n=new Array(256),e=0;e<128;++e)n[e]=e<<1,n[e+128]=e+128<<1^283;Ga=new Array(256),Bte=new Array(256),tS=new Array(4),Yd=new Array(4);for(var e=0;e<4;++e)tS[e]=new Array(256),Yd[e]=new Array(256);for(var t=0,r=0,o,s,a,c,l,u,d,e=0;e<256;++e){c=r^r<<1^r<<2^r<<3^r<<4,c=c>>8^c&255^99,Ga[t]=c,Bte[c]=t,l=n[c],o=n[t],s=n[o],a=n[s],u=l<<24^c<<16^c<<8^(c^l),d=(o^s^a)<<24^(t^a)<<16^(t^s^a)<<8^(t^o^a);for(var p=0;p<4;++p)tS[p][t]=u,Yd[p][c]=d,u=u<<24|u>>>8,d=d<<24|d>>>8;t===0?t=r=1:(t=o^n[n[n[o^a]]],r^=n[n[r]])}}function fCe(n,e){for(var t=n.slice(0),r,o=1,s=t.length,a=s+6+1,c=cw*a,l=s;l<c;++l)r=t[l-1],l%s===0?(r=Ga[r>>>16&255]<<24^Ga[r>>>8&255]<<16^Ga[r&255]<<8^Ga[r>>>24]^dCe[o]<<24,o++):s>6&&l%s===4&&(r=Ga[r>>>24]<<24^Ga[r>>>16&255]<<16^Ga[r>>>8&255]<<8^Ga[r&255]),t[l]=t[l-s]^r;if(e){var u,d=Yd[0],p=Yd[1],f=Yd[2],m=Yd[3],h=t.slice(0);c=t.length;for(var l=0,g=c-cw;l<c;l+=cw,g-=cw)if(l===0||l===c-cw)h[l]=t[g],h[l+1]=t[g+3],h[l+2]=t[g+2],h[l+3]=t[g+1];else for(var y=0;y<cw;++y)u=t[g+y],h[l+(3&-y)]=d[Ga[u>>>24]]^p[Ga[u>>>16&255]]^f[Ga[u>>>8&255]]^m[Ga[u&255]];t=h}return t}function qte(n,e,t,r){var o=n.length/4-1,s,a,c,l,u;r?(s=Yd[0],a=Yd[1],c=Yd[2],l=Yd[3],u=Bte):(s=tS[0],a=tS[1],c=tS[2],l=tS[3],u=Ga);var d,p,f,m,h,g,y;d=e[0]^n[0],p=e[r?3:1]^n[1],f=e[2]^n[2],m=e[r?1:3]^n[3];for(var b=3,_=1;_<o;++_)h=s[d>>>24]^a[p>>>16&255]^c[f>>>8&255]^l[m&255]^n[++b],g=s[p>>>24]^a[f>>>16&255]^c[m>>>8&255]^l[d&255]^n[++b],y=s[f>>>24]^a[m>>>16&255]^c[d>>>8&255]^l[p&255]^n[++b],m=s[m>>>24]^a[d>>>16&255]^c[p>>>8&255]^l[f&255]^n[++b],d=h,p=g,f=y;t[0]=u[d>>>24]<<24^u[p>>>16&255]<<16^u[f>>>8&255]<<8^u[m&255]^n[++b],t[r?3:1]=u[p>>>24]<<24^u[f>>>16&255]<<16^u[m>>>8&255]<<8^u[d&255]^n[++b],t[2]=u[f>>>24]<<24^u[m>>>16&255]<<16^u[d>>>8&255]<<8^u[p&255]^n[++b],t[r?1:3]=u[m>>>24]<<24^u[d>>>16&255]<<16^u[p>>>8&255]<<8^u[f&255]^n[++b]}function E7(n){n=n||{};var e=(n.mode||"CBC").toUpperCase(),t="AES-"+e,r;n.decrypt?r=Wr.cipher.createDecipher(t,n.key):r=Wr.cipher.createCipher(t,n.key);var o=r.start;return r.start=function(s,a){var c=null;a instanceof Wr.util.ByteBuffer&&(c=a,a={}),a=a||{},a.output=c,a.iv=s,o.call(r,a)},r}});var yy=P((nRn,hCe)=>{var zL=In();zL.pki=zL.pki||{};var Hte=hCe.exports=zL.pki.oids=zL.oids=zL.oids||{};function qe(n,e){Hte[n]=e,Hte[e]=n}function xr(n,e){Hte[n]=e}qe("1.2.840.113549.1.1.1","rsaEncryption");qe("1.2.840.113549.1.1.4","md5WithRSAEncryption");qe("1.2.840.113549.1.1.5","sha1WithRSAEncryption");qe("1.2.840.113549.1.1.7","RSAES-OAEP");qe("1.2.840.113549.1.1.8","mgf1");qe("1.2.840.113549.1.1.9","pSpecified");qe("1.2.840.113549.1.1.10","RSASSA-PSS");qe("1.2.840.113549.1.1.11","sha256WithRSAEncryption");qe("1.2.840.113549.1.1.12","sha384WithRSAEncryption");qe("1.2.840.113549.1.1.13","sha512WithRSAEncryption");qe("1.3.101.112","EdDSA25519");qe("1.2.840.10040.4.3","dsa-with-sha1");qe("1.3.14.3.2.7","desCBC");qe("1.3.14.3.2.26","sha1");qe("1.3.14.3.2.29","sha1WithRSASignature");qe("2.16.840.1.101.3.4.2.1","sha256");qe("2.16.840.1.101.3.4.2.2","sha384");qe("2.16.840.1.101.3.4.2.3","sha512");qe("2.16.840.1.101.3.4.2.4","sha224");qe("2.16.840.1.101.3.4.2.5","sha512-224");qe("2.16.840.1.101.3.4.2.6","sha512-256");qe("1.2.840.113549.2.2","md2");qe("1.2.840.113549.2.5","md5");qe("1.2.840.113549.1.7.1","data");qe("1.2.840.113549.1.7.2","signedData");qe("1.2.840.113549.1.7.3","envelopedData");qe("1.2.840.113549.1.7.4","signedAndEnvelopedData");qe("1.2.840.113549.1.7.5","digestedData");qe("1.2.840.113549.1.7.6","encryptedData");qe("1.2.840.113549.1.9.1","emailAddress");qe("1.2.840.113549.1.9.2","unstructuredName");qe("1.2.840.113549.1.9.3","contentType");qe("1.2.840.113549.1.9.4","messageDigest");qe("1.2.840.113549.1.9.5","signingTime");qe("1.2.840.113549.1.9.6","counterSignature");qe("1.2.840.113549.1.9.7","challengePassword");qe("1.2.840.113549.1.9.8","unstructuredAddress");qe("1.2.840.113549.1.9.14","extensionRequest");qe("1.2.840.113549.1.9.20","friendlyName");qe("1.2.840.113549.1.9.21","localKeyId");qe("1.2.840.113549.1.9.22.1","x509Certificate");qe("1.2.840.113549.1.12.10.1.1","keyBag");qe("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");qe("1.2.840.113549.1.12.10.1.3","certBag");qe("1.2.840.113549.1.12.10.1.4","crlBag");qe("1.2.840.113549.1.12.10.1.5","secretBag");qe("1.2.840.113549.1.12.10.1.6","safeContentsBag");qe("1.2.840.113549.1.5.13","pkcs5PBES2");qe("1.2.840.113549.1.5.12","pkcs5PBKDF2");qe("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");qe("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");qe("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");qe("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");qe("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");qe("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");qe("1.2.840.113549.2.7","hmacWithSHA1");qe("1.2.840.113549.2.8","hmacWithSHA224");qe("1.2.840.113549.2.9","hmacWithSHA256");qe("1.2.840.113549.2.10","hmacWithSHA384");qe("1.2.840.113549.2.11","hmacWithSHA512");qe("1.2.840.113549.3.7","des-EDE3-CBC");qe("2.16.840.1.101.3.4.1.2","aes128-CBC");qe("2.16.840.1.101.3.4.1.22","aes192-CBC");qe("2.16.840.1.101.3.4.1.42","aes256-CBC");qe("2.5.4.3","commonName");qe("2.5.4.4","surname");qe("2.5.4.5","serialNumber");qe("2.5.4.6","countryName");qe("2.5.4.7","localityName");qe("2.5.4.8","stateOrProvinceName");qe("2.5.4.9","streetAddress");qe("2.5.4.10","organizationName");qe("2.5.4.11","organizationalUnitName");qe("2.5.4.12","title");qe("2.5.4.13","description");qe("2.5.4.15","businessCategory");qe("2.5.4.17","postalCode");qe("2.5.4.42","givenName");qe("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");qe("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");qe("2.16.840.1.113730.1.1","nsCertType");qe("2.16.840.1.113730.1.13","nsComment");xr("2.5.29.1","authorityKeyIdentifier");xr("2.5.29.2","keyAttributes");xr("2.5.29.3","certificatePolicies");xr("2.5.29.4","keyUsageRestriction");xr("2.5.29.5","policyMapping");xr("2.5.29.6","subtreesConstraint");xr("2.5.29.7","subjectAltName");xr("2.5.29.8","issuerAltName");xr("2.5.29.9","subjectDirectoryAttributes");xr("2.5.29.10","basicConstraints");xr("2.5.29.11","nameConstraints");xr("2.5.29.12","policyConstraints");xr("2.5.29.13","basicConstraints");qe("2.5.29.14","subjectKeyIdentifier");qe("2.5.29.15","keyUsage");xr("2.5.29.16","privateKeyUsagePeriod");qe("2.5.29.17","subjectAltName");qe("2.5.29.18","issuerAltName");qe("2.5.29.19","basicConstraints");xr("2.5.29.20","cRLNumber");xr("2.5.29.21","cRLReason");xr("2.5.29.22","expirationDate");xr("2.5.29.23","instructionCode");xr("2.5.29.24","invalidityDate");xr("2.5.29.25","cRLDistributionPoints");xr("2.5.29.26","issuingDistributionPoint");xr("2.5.29.27","deltaCRLIndicator");xr("2.5.29.28","issuingDistributionPoint");xr("2.5.29.29","certificateIssuer");xr("2.5.29.30","nameConstraints");qe("2.5.29.31","cRLDistributionPoints");qe("2.5.29.32","certificatePolicies");xr("2.5.29.33","policyMappings");xr("2.5.29.34","policyConstraints");qe("2.5.29.35","authorityKeyIdentifier");xr("2.5.29.36","policyConstraints");qe("2.5.29.37","extKeyUsage");xr("2.5.29.46","freshestCRL");xr("2.5.29.54","inhibitAnyPolicy");qe("1.3.6.1.4.1.11129.2.4.2","timestampList");qe("1.3.6.1.5.5.7.1.1","authorityInfoAccess");qe("1.3.6.1.5.5.7.3.1","serverAuth");qe("1.3.6.1.5.5.7.3.2","clientAuth");qe("1.3.6.1.5.5.7.3.3","codeSigning");qe("1.3.6.1.5.5.7.3.4","emailProtection");qe("1.3.6.1.5.5.7.3.8","timeStamping")});var Qd=P((rRn,vCe)=>{var ai=In();rr();yy();var ot=vCe.exports=ai.asn1=ai.asn1||{};ot.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};ot.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};ot.create=function(n,e,t,r,o){if(ai.util.isArray(r)){for(var s=[],a=0;a<r.length;++a)r[a]!==void 0&&s.push(r[a]);r=s}var c={tagClass:n,type:e,constructed:t,composed:t||ai.util.isArray(r),value:r};return o&&"bitStringContents"in o&&(c.bitStringContents=o.bitStringContents,c.original=ot.copy(c)),c};ot.copy=function(n,e){var t;if(ai.util.isArray(n)){t=[];for(var r=0;r<n.length;++r)t.push(ot.copy(n[r],e));return t}return typeof n=="string"?n:(t={tagClass:n.tagClass,type:n.type,constructed:n.constructed,composed:n.composed,value:ot.copy(n.value,e)},e&&!e.excludeBitStringContents&&(t.bitStringContents=n.bitStringContents),t)};ot.equals=function(n,e,t){if(ai.util.isArray(n)){if(!ai.util.isArray(e)||n.length!==e.length)return!1;for(var r=0;r<n.length;++r)if(!ot.equals(n[r],e[r]))return!1;return!0}if(typeof n!=typeof e)return!1;if(typeof n=="string")return n===e;var o=n.tagClass===e.tagClass&&n.type===e.type&&n.constructed===e.constructed&&n.composed===e.composed&&ot.equals(n.value,e.value);return t&&t.includeBitStringContents&&(o=o&&n.bitStringContents===e.bitStringContents),o};ot.getBerValueLength=function(n){var e=n.getByte();if(e!==128){var t,r=e&128;return r?t=n.getInt((e&127)<<3):t=e,t}};function $L(n,e,t){if(t>e){var r=new Error("Too few bytes to parse DER.");throw r.available=n.length(),r.remaining=e,r.requested=t,r}}var wot=function(n,e){var t=n.getByte();if(e--,t!==128){var r,o=t&128;if(!o)r=t;else{var s=t&127;$L(n,e,s),r=n.getInt(s<<3)}if(r<0)throw new Error("Negative length: "+r);return r}};ot.fromDer=function(n,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof n=="string"&&(n=ai.util.createBuffer(n));var t=n.length(),r=w7(n,n.length(),0,e);if(e.parseAllBytes&&n.length()!==0){var o=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw o.byteCount=t,o.remaining=n.length(),o}return r};function w7(n,e,t,r){var o;$L(n,e,2);var s=n.getByte();e--;var a=s&192,c=s&31;o=n.length();var l=wot(n,e);if(e-=o-n.length(),l!==void 0&&l>e){if(r.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=n.length(),u.remaining=e,u.requested=l,u}l=e}var d,p,f=(s&32)===32;if(f)if(d=[],l===void 0)for(;;){if($L(n,e,2),n.bytes(2)==="\0\0"){n.getBytes(2),e-=2;break}o=n.length(),d.push(w7(n,e,t+1,r)),e-=o-n.length()}else for(;l>0;)o=n.length(),d.push(w7(n,l,t+1,r)),e-=o-n.length(),l-=o-n.length();if(d===void 0&&a===ot.Class.UNIVERSAL&&c===ot.Type.BITSTRING&&(p=n.bytes(l)),d===void 0&&r.decodeBitStrings&&a===ot.Class.UNIVERSAL&&c===ot.Type.BITSTRING&&l>1){var m=n.read,h=e,g=0;if(c===ot.Type.BITSTRING&&($L(n,e,1),g=n.getByte(),e--),g===0)try{o=n.length();var y={strict:!0,decodeBitStrings:!0},b=w7(n,e,t+1,y),_=o-n.length();e-=_,c==ot.Type.BITSTRING&&_++;var x=b.tagClass;_===l&&(x===ot.Class.UNIVERSAL||x===ot.Class.CONTEXT_SPECIFIC)&&(d=[b])}catch{}d===void 0&&(n.read=m,e=h)}if(d===void 0){if(l===void 0){if(r.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");l=e}if(c===ot.Type.BMPSTRING)for(d="";l>0;l-=2)$L(n,e,2),d+=String.fromCharCode(n.getInt16()),e-=2;else d=n.getBytes(l),e-=l}var I=p===void 0?null:{bitStringContents:p};return ot.create(a,c,f,d,I)}ot.toDer=function(n){var e=ai.util.createBuffer(),t=n.tagClass|n.type,r=ai.util.createBuffer(),o=!1;if("bitStringContents"in n&&(o=!0,n.original&&(o=ot.equals(n,n.original))),o)r.putBytes(n.bitStringContents);else if(n.composed){n.constructed?t|=32:r.putByte(0);for(var s=0;s<n.value.length;++s)n.value[s]!==void 0&&r.putBuffer(ot.toDer(n.value[s]))}else if(n.type===ot.Type.BMPSTRING)for(var s=0;s<n.value.length;++s)r.putInt16(n.value.charCodeAt(s));else n.type===ot.Type.INTEGER&&n.value.length>1&&(n.value.charCodeAt(0)===0&&!(n.value.charCodeAt(1)&128)||n.value.charCodeAt(0)===255&&(n.value.charCodeAt(1)&128)===128)?r.putBytes(n.value.substr(1)):r.putBytes(n.value);if(e.putByte(t),r.length()<=127)e.putByte(r.length()&127);else{var a=r.length(),c="";do c+=String.fromCharCode(a&255),a=a>>>8;while(a>0);e.putByte(c.length|128);for(var s=c.length-1;s>=0;--s)e.putByte(c.charCodeAt(s))}return e.putBuffer(r),e};ot.oidToDer=function(n){var e=n.split("."),t=ai.util.createBuffer();t.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var r,o,s,a,c=2;c<e.length;++c){r=!0,o=[],s=parseInt(e[c],10);do a=s&127,s=s>>>7,r||(a|=128),o.push(a),r=!1;while(s>0);for(var l=o.length-1;l>=0;--l)t.putByte(o[l])}return t};ot.derToOid=function(n){var e;typeof n=="string"&&(n=ai.util.createBuffer(n));var t=n.getByte();e=Math.floor(t/40)+"."+t%40;for(var r=0;n.length()>0;)t=n.getByte(),r=r<<7,t&128?r+=t&127:(e+="."+(r+t),r=0);return e};ot.utcTimeToDate=function(n){var e=new Date,t=parseInt(n.substr(0,2),10);t=t>=50?1900+t:2e3+t;var r=parseInt(n.substr(2,2),10)-1,o=parseInt(n.substr(4,2),10),s=parseInt(n.substr(6,2),10),a=parseInt(n.substr(8,2),10),c=0;if(n.length>11){var l=n.charAt(10),u=10;l!=="+"&&l!=="-"&&(c=parseInt(n.substr(10,2),10),u+=2)}if(e.setUTCFullYear(t,r,o),e.setUTCHours(s,a,c,0),u&&(l=n.charAt(u),l==="+"||l==="-")){var d=parseInt(n.substr(u+1,2),10),p=parseInt(n.substr(u+4,2),10),f=d*60+p;f*=6e4,l==="+"?e.setTime(+e-f):e.setTime(+e+f)}return e};ot.generalizedTimeToDate=function(n){var e=new Date,t=parseInt(n.substr(0,4),10),r=parseInt(n.substr(4,2),10)-1,o=parseInt(n.substr(6,2),10),s=parseInt(n.substr(8,2),10),a=parseInt(n.substr(10,2),10),c=parseInt(n.substr(12,2),10),l=0,u=0,d=!1;n.charAt(n.length-1)==="Z"&&(d=!0);var p=n.length-5,f=n.charAt(p);if(f==="+"||f==="-"){var m=parseInt(n.substr(p+1,2),10),h=parseInt(n.substr(p+4,2),10);u=m*60+h,u*=6e4,f==="+"&&(u*=-1),d=!0}return n.charAt(14)==="."&&(l=parseFloat(n.substr(14),10)*1e3),d?(e.setUTCFullYear(t,r,o),e.setUTCHours(s,a,c,l),e.setTime(+e+u)):(e.setFullYear(t,r,o),e.setHours(s,a,c,l)),e};ot.dateToUtcTime=function(n){if(typeof n=="string")return n;var e="",t=[];t.push((""+n.getUTCFullYear()).substr(2)),t.push(""+(n.getUTCMonth()+1)),t.push(""+n.getUTCDate()),t.push(""+n.getUTCHours()),t.push(""+n.getUTCMinutes()),t.push(""+n.getUTCSeconds());for(var r=0;r<t.length;++r)t[r].length<2&&(e+="0"),e+=t[r];return e+="Z",e};ot.dateToGeneralizedTime=function(n){if(typeof n=="string")return n;var e="",t=[];t.push(""+n.getUTCFullYear()),t.push(""+(n.getUTCMonth()+1)),t.push(""+n.getUTCDate()),t.push(""+n.getUTCHours()),t.push(""+n.getUTCMinutes()),t.push(""+n.getUTCSeconds());for(var r=0;r<t.length;++r)t[r].length<2&&(e+="0"),e+=t[r];return e+="Z",e};ot.integerToDer=function(n){var e=ai.util.createBuffer();if(n>=-128&&n<128)return e.putSignedInt(n,8);if(n>=-32768&&n<32768)return e.putSignedInt(n,16);if(n>=-8388608&&n<8388608)return e.putSignedInt(n,24);if(n>=-2147483648&&n<2147483648)return e.putSignedInt(n,32);var t=new Error("Integer too large; max is 32-bits.");throw t.integer=n,t};ot.derToInteger=function(n){typeof n=="string"&&(n=ai.util.createBuffer(n));var e=n.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return n.getSignedInt(e)};ot.validate=function(n,e,t,r){var o=!1;if((n.tagClass===e.tagClass||typeof e.tagClass>"u")&&(n.type===e.type||typeof e.type>"u"))if(n.constructed===e.constructed||typeof e.constructed>"u"){if(o=!0,e.value&&ai.util.isArray(e.value))for(var s=0,a=0;o&&a<e.value.length;++a)o=e.value[a].optional||!1,n.value[s]&&(o=ot.validate(n.value[s],e.value[a],t,r),o?++s:e.value[a].optional&&(o=!0)),!o&&r&&r.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+n.value.length+'"');if(o&&t&&(e.capture&&(t[e.capture]=n.value),e.captureAsn1&&(t[e.captureAsn1]=n),e.captureBitStringContents&&"bitStringContents"in n&&(t[e.captureBitStringContents]=n.bitStringContents),e.captureBitStringValue&&"bitStringContents"in n)){var c;if(n.bitStringContents.length<2)t[e.captureBitStringValue]="";else{var l=n.bitStringContents.charCodeAt(0);if(l!==0)throw new Error("captureBitStringValue only supported for zero unused bits");t[e.captureBitStringValue]=n.bitStringContents.slice(1)}}}else r&&r.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+n.constructed+'"');else r&&(n.tagClass!==e.tagClass&&r.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+n.tagClass+'"'),n.type!==e.type&&r.push("["+e.name+'] Expected type "'+e.type+'", got "'+n.type+'"'));return o};var gCe=/[^\\u0000-\\u00ff]/;ot.prettyPrint=function(n,e,t){var r="";e=e||0,t=t||2,e>0&&(r+=`
`);for(var o="",s=0;s<e*t;++s)o+=" ";switch(r+=o+"Tag: ",n.tagClass){case ot.Class.UNIVERSAL:r+="Universal:";break;case ot.Class.APPLICATION:r+="Application:";break;case ot.Class.CONTEXT_SPECIFIC:r+="Context-Specific:";break;case ot.Class.PRIVATE:r+="Private:";break}if(n.tagClass===ot.Class.UNIVERSAL)switch(r+=n.type,n.type){case ot.Type.NONE:r+=" (None)";break;case ot.Type.BOOLEAN:r+=" (Boolean)";break;case ot.Type.INTEGER:r+=" (Integer)";break;case ot.Type.BITSTRING:r+=" (Bit string)";break;case ot.Type.OCTETSTRING:r+=" (Octet string)";break;case ot.Type.NULL:r+=" (Null)";break;case ot.Type.OID:r+=" (Object Identifier)";break;case ot.Type.ODESC:r+=" (Object Descriptor)";break;case ot.Type.EXTERNAL:r+=" (External or Instance of)";break;case ot.Type.REAL:r+=" (Real)";break;case ot.Type.ENUMERATED:r+=" (Enumerated)";break;case ot.Type.EMBEDDED:r+=" (Embedded PDV)";break;case ot.Type.UTF8:r+=" (UTF8)";break;case ot.Type.ROID:r+=" (Relative Object Identifier)";break;case ot.Type.SEQUENCE:r+=" (Sequence)";break;case ot.Type.SET:r+=" (Set)";break;case ot.Type.PRINTABLESTRING:r+=" (Printable String)";break;case ot.Type.IA5String:r+=" (IA5String (ASCII))";break;case ot.Type.UTCTIME:r+=" (UTC time)";break;case ot.Type.GENERALIZEDTIME:r+=" (Generalized time)";break;case ot.Type.BMPSTRING:r+=" (BMP String)";break}else r+=n.type;if(r+=`
`,r+=o+"Constructed: "+n.constructed+`
`,n.composed){for(var a=0,c="",s=0;s<n.value.length;++s)n.value[s]!==void 0&&(a+=1,c+=ot.prettyPrint(n.value[s],e+1,t),s+1<n.value.length&&(c+=","));r+=o+"Sub values: "+a+c}else{if(r+=o+"Value: ",n.type===ot.Type.OID){var l=ot.derToOid(n.value);r+=l,ai.pki&&ai.pki.oids&&l in ai.pki.oids&&(r+=" ("+ai.pki.oids[l]+") ")}if(n.type===ot.Type.INTEGER)try{r+=ot.derToInteger(n.value)}catch{r+="0x"+ai.util.bytesToHex(n.value)}else if(n.type===ot.Type.BITSTRING){if(n.value.length>1?r+="0x"+ai.util.bytesToHex(n.value.slice(1)):r+="(none)",n.value.length>0){var u=n.value.charCodeAt(0);u==1?r+=" (1 unused bit shown)":u>1&&(r+=" ("+u+" unused bits shown)")}}else if(n.type===ot.Type.OCTETSTRING)gCe.test(n.value)||(r+="("+n.value+") "),r+="0x"+ai.util.bytesToHex(n.value);else if(n.type===ot.Type.UTF8)try{r+=ai.util.decodeUtf8(n.value)}catch(d){if(d.message==="URI malformed")r+="0x"+ai.util.bytesToHex(n.value)+" (malformed UTF8)";else throw d}else n.type===ot.Type.PRINTABLESTRING||n.type===ot.Type.IA5String?r+=n.value:gCe.test(n.value)?r+="0x"+ai.util.bytesToHex(n.value):n.value.length===0?r+="[null]":r+=n.value}return r}});var Ef=P((iRn,yCe)=>{var k7=In();yCe.exports=k7.md=k7.md||{};k7.md.algorithms=k7.md.algorithms||{}});var uw=P((oRn,bCe)=>{var jh=In();Ef();rr();var kot=bCe.exports=jh.hmac=jh.hmac||{};kot.create=function(){var n=null,e=null,t=null,r=null,o={};return o.start=function(s,a){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in jh.md.algorithms)e=jh.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(a===null)a=n;else{if(typeof a=="string")a=jh.util.createBuffer(a);else if(jh.util.isArray(a)){var c=a;a=jh.util.createBuffer();for(var l=0;l<c.length;++l)a.putByte(c[l])}var u=a.length();u>e.blockLength&&(e.start(),e.update(a.bytes()),a=e.digest()),t=jh.util.createBuffer(),r=jh.util.createBuffer(),u=a.length();for(var l=0;l<u;++l){var c=a.at(l);t.putByte(54^c),r.putByte(92^c)}if(u<e.blockLength)for(var c=e.blockLength-u,l=0;l<c;++l)t.putByte(54),r.putByte(92);n=a,t=t.bytes(),r=r.bytes()}e.start(),e.update(t)},o.update=function(s){e.update(s)},o.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(r),e.update(s),e.digest()},o.digest=o.getMac,o}});var P7=P((sRn,ICe)=>{var wf=In();Ef();rr();var xCe=ICe.exports=wf.md5=wf.md5||{};wf.md.md5=wf.md.algorithms.md5=xCe;xCe.create=function(){SCe||Rot();var n=null,e=wf.util.createBuffer(),t=new Array(16),r={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return r.start=function(){r.messageLength=0,r.fullMessageLength=r.messageLength64=[];for(var o=r.messageLengthSize/4,s=0;s<o;++s)r.fullMessageLength.push(0);return e=wf.util.createBuffer(),n={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},r},r.start(),r.update=function(o,s){s==="utf8"&&(o=wf.util.encodeUtf8(o));var a=o.length;r.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var c=r.fullMessageLength.length-1;c>=0;--c)r.fullMessageLength[c]+=a[1],a[1]=a[0]+(r.fullMessageLength[c]/4294967296>>>0),r.fullMessageLength[c]=r.fullMessageLength[c]>>>0,a[0]=a[1]/4294967296>>>0;return e.putBytes(o),_Ce(n,t,e),(e.read>2048||e.length()===0)&&e.compact(),r},r.digest=function(){var o=wf.util.createBuffer();o.putBytes(e.bytes());var s=r.fullMessageLength[r.fullMessageLength.length-1]+r.messageLengthSize,a=s&r.blockLength-1;o.putBytes(Vte.substr(0,r.blockLength-a));for(var c,l=0,u=r.fullMessageLength.length-1;u>=0;--u)c=r.fullMessageLength[u]*8+l,l=c/4294967296>>>0,o.putInt32Le(c>>>0);var d={h0:n.h0,h1:n.h1,h2:n.h2,h3:n.h3};_Ce(d,t,o);var p=wf.util.createBuffer();return p.putInt32Le(d.h0),p.putInt32Le(d.h1),p.putInt32Le(d.h2),p.putInt32Le(d.h3),p},r};var Vte=null,R7=null,WL=null,dw=null,SCe=!1;function Rot(){Vte="\x80",Vte+=wf.util.fillString("\0",64),R7=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],WL=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],dw=new Array(64);for(var n=0;n<64;++n)dw[n]=Math.floor(Math.abs(Math.sin(n+1))*4294967296);SCe=!0}function _Ce(n,e,t){for(var r,o,s,a,c,l,u,d,p=t.length();p>=64;){for(o=n.h0,s=n.h1,a=n.h2,c=n.h3,d=0;d<16;++d)e[d]=t.getInt32Le(),l=c^s&(a^c),r=o+l+dw[d]+e[d],u=WL[d],o=c,c=a,a=s,s+=r<<u|r>>>32-u;for(;d<32;++d)l=a^c&(s^a),r=o+l+dw[d]+e[R7[d]],u=WL[d],o=c,c=a,a=s,s+=r<<u|r>>>32-u;for(;d<48;++d)l=s^a^c,r=o+l+dw[d]+e[R7[d]],u=WL[d],o=c,c=a,a=s,s+=r<<u|r>>>32-u;for(;d<64;++d)l=a^(s|~c),r=o+l+dw[d]+e[R7[d]],u=WL[d],o=c,c=a,a=s,s+=r<<u|r>>>32-u;n.h0=n.h0+o|0,n.h1=n.h1+s|0,n.h2=n.h2+a|0,n.h3=n.h3+c|0,p-=64}}});var nS=P((aRn,CCe)=>{var D7=In();rr();var TCe=CCe.exports=D7.pem=D7.pem||{};TCe.encode=function(n,e){e=e||{};var t="-----BEGIN "+n.type+`-----\r
`,r;if(n.procType&&(r={name:"Proc-Type",values:[String(n.procType.version),n.procType.type]},t+=A7(r)),n.contentDomain&&(r={name:"Content-Domain",values:[n.contentDomain]},t+=A7(r)),n.dekInfo&&(r={name:"DEK-Info",values:[n.dekInfo.algorithm]},n.dekInfo.parameters&&r.values.push(n.dekInfo.parameters),t+=A7(r)),n.headers)for(var o=0;o<n.headers.length;++o)t+=A7(n.headers[o]);return n.procType&&(t+=`\r
`),t+=D7.util.encode64(n.body,e.maxline||64)+`\r
`,t+="-----END "+n.type+`-----\r
`,t};TCe.decode=function(n){for(var e=[],t=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,r=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,o=/\r?\n/,s;s=t.exec(n),!!s;){var a=s[1];a==="NEW CERTIFICATE REQUEST"&&(a="CERTIFICATE REQUEST");var c={type:a,procType:null,contentDomain:null,dekInfo:null,headers:[],body:D7.util.decode64(s[3])};if(e.push(c),!!s[2]){for(var l=s[2].split(o),u=0;s&&u<l.length;){for(var d=l[u].replace(/\s+$/,""),p=u+1;p<l.length;++p){var f=l[p];if(!/\s/.test(f[0]))break;d+=f,u=p}if(s=d.match(r),s){for(var m={name:s[1],values:[]},h=s[2].split(","),g=0;g<h.length;++g)m.values.push(Pot(h[g]));if(c.procType)if(!c.contentDomain&&m.name==="Content-Domain")c.contentDomain=h[0]||"";else if(!c.dekInfo&&m.name==="DEK-Info"){if(m.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');c.dekInfo={algorithm:h[0],parameters:h[1]||null}}else c.headers.push(m);else{if(m.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(m.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');c.procType={version:h[0],type:h[1]}}}++u}if(c.procType==="ENCRYPTED"&&!c.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function A7(n){for(var e=n.name+": ",t=[],r=function(l,u){return" "+u},o=0;o<n.values.length;++o)t.push(n.values[o].replace(/^(\S+\r\n)/,r));e+=t.join(",")+`\r
`;for(var s=0,a=-1,o=0;o<e.length;++o,++s)if(s>65&&a!==-1){var c=e[a];c===","?(++a,e=e.substr(0,a)+`\r
 `+e.substr(a)):e=e.substr(0,a)+`\r
`+c+e.substr(a+1),s=o-a-1,a=-1,++o}else(e[o]===" "||e[o]==="	"||e[o]===",")&&(a=o);return e}function Pot(n){return n.replace(/^\s+/,"")}});var KL=P((cRn,wCe)=>{var yi=In();I7();Ute();rr();wCe.exports=yi.des=yi.des||{};yi.des.startEncrypting=function(n,e,t,r){var o=N7({key:n,output:t,decrypt:!1,mode:r||(e===null?"ECB":"CBC")});return o.start(e),o};yi.des.createEncryptionCipher=function(n,e){return N7({key:n,output:null,decrypt:!1,mode:e})};yi.des.startDecrypting=function(n,e,t,r){var o=N7({key:n,output:t,decrypt:!0,mode:r||(e===null?"ECB":"CBC")});return o.start(e),o};yi.des.createDecryptionCipher=function(n,e){return N7({key:n,output:null,decrypt:!0,mode:e})};yi.des.Algorithm=function(n,e){var t=this;t.name=n,t.mode=new e({blockSize:8,cipher:{encrypt:function(r,o){return ECe(t._keys,r,o,!1)},decrypt:function(r,o){return ECe(t._keys,r,o,!0)}}}),t._init=!1};yi.des.Algorithm.prototype.initialize=function(n){if(!this._init){var e=yi.util.createBuffer(n.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=Bot(e),this._init=!0}};kf("DES-ECB",yi.cipher.modes.ecb);kf("DES-CBC",yi.cipher.modes.cbc);kf("DES-CFB",yi.cipher.modes.cfb);kf("DES-OFB",yi.cipher.modes.ofb);kf("DES-CTR",yi.cipher.modes.ctr);kf("3DES-ECB",yi.cipher.modes.ecb);kf("3DES-CBC",yi.cipher.modes.cbc);kf("3DES-CFB",yi.cipher.modes.cfb);kf("3DES-OFB",yi.cipher.modes.ofb);kf("3DES-CTR",yi.cipher.modes.ctr);function kf(n,e){var t=function(){return new yi.des.Algorithm(n,e)};yi.cipher.registerAlgorithm(n,t)}var Aot=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Dot=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Not=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Lot=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Oot=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Mot=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Fot=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Uot=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Bot(n){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],t=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],r=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],o=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],c=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],l=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],d=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],p=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],f=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],m=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],h=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=n.length()>8?3:1,y=[],b=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],_=0,x,I=0;I<g;I++){var S=n.getInt32(),w=n.getInt32();x=(S>>>4^w)&252645135,w^=x,S^=x<<4,x=(w>>>-16^S)&65535,S^=x,w^=x<<-16,x=(S>>>2^w)&858993459,w^=x,S^=x<<2,x=(w>>>-16^S)&65535,S^=x,w^=x<<-16,x=(S>>>1^w)&1431655765,w^=x,S^=x<<1,x=(w>>>8^S)&16711935,S^=x,w^=x<<8,x=(S>>>1^w)&1431655765,w^=x,S^=x<<1,x=S<<8|w>>>20&240,S=w<<24|w<<8&16711680|w>>>8&65280|w>>>24&240,w=x;for(var R=0;R<b.length;++R){b[R]?(S=S<<2|S>>>26,w=w<<2|w>>>26):(S=S<<1|S>>>27,w=w<<1|w>>>27),S&=-15,w&=-15;var k=e[S>>>28]|t[S>>>24&15]|r[S>>>20&15]|o[S>>>16&15]|s[S>>>12&15]|a[S>>>8&15]|c[S>>>4&15],V=l[w>>>28]|u[w>>>24&15]|d[w>>>20&15]|p[w>>>16&15]|f[w>>>12&15]|m[w>>>8&15]|h[w>>>4&15];x=(V>>>16^k)&65535,y[_++]=k^x,y[_++]=V^x<<16}}return y}function ECe(n,e,t,r){var o=n.length===32?3:9,s;o===3?s=r?[30,-2,-2]:[0,32,2]:s=r?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var a,c=e[0],l=e[1];a=(c>>>4^l)&252645135,l^=a,c^=a<<4,a=(c>>>16^l)&65535,l^=a,c^=a<<16,a=(l>>>2^c)&858993459,c^=a,l^=a<<2,a=(l>>>8^c)&16711935,c^=a,l^=a<<8,a=(c>>>1^l)&1431655765,l^=a,c^=a<<1,c=c<<1|c>>>31,l=l<<1|l>>>31;for(var u=0;u<o;u+=3){for(var d=s[u+1],p=s[u+2],f=s[u];f!=d;f+=p){var m=l^n[f],h=(l>>>4|l<<28)^n[f+1];a=c,c=l,l=a^(Dot[m>>>24&63]|Lot[m>>>16&63]|Mot[m>>>8&63]|Uot[m&63]|Aot[h>>>24&63]|Not[h>>>16&63]|Oot[h>>>8&63]|Fot[h&63])}a=c,c=l,l=a}c=c>>>1|c<<31,l=l>>>1|l<<31,a=(c>>>1^l)&1431655765,l^=a,c^=a<<1,a=(l>>>8^c)&16711935,c^=a,l^=a<<8,a=(l>>>2^c)&858993459,c^=a,l^=a<<2,a=(c>>>16^l)&65535,l^=a,c^=a<<16,a=(c>>>4^l)&252645135,l^=a,c^=a<<4,t[0]=c,t[1]=l}function N7(n){n=n||{};var e=(n.mode||"CBC").toUpperCase(),t="DES-"+e,r;n.decrypt?r=yi.cipher.createDecipher(t,n.key):r=yi.cipher.createCipher(t,n.key);var o=r.start;return r.start=function(s,a){var c=null;a instanceof yi.util.ByteBuffer&&(c=a,a={}),a=a||{},a.output=c,a.iv=s,o.call(r,a)},r}});var L7=P((lRn,kCe)=>{var za=In();uw();Ef();rr();var qot=za.pkcs5=za.pkcs5||{},Hh;za.util.isNodejs&&!za.options.usePureJavaScript&&(Hh=require("crypto"));kCe.exports=za.pbkdf2=qot.pbkdf2=function(n,e,t,r,o,s){if(typeof o=="function"&&(s=o,o=null),za.util.isNodejs&&!za.options.usePureJavaScript&&Hh.pbkdf2&&(o===null||typeof o!="object")&&(Hh.pbkdf2Sync.length>4||!o||o==="sha1"))return typeof o!="string"&&(o="sha1"),n=Buffer.from(n,"binary"),e=Buffer.from(e,"binary"),s?Hh.pbkdf2Sync.length===4?Hh.pbkdf2(n,e,t,r,function(x,I){if(x)return s(x);s(null,I.toString("binary"))}):Hh.pbkdf2(n,e,t,r,o,function(x,I){if(x)return s(x);s(null,I.toString("binary"))}):Hh.pbkdf2Sync.length===4?Hh.pbkdf2Sync(n,e,t,r).toString("binary"):Hh.pbkdf2Sync(n,e,t,r,o).toString("binary");if((typeof o>"u"||o===null)&&(o="sha1"),typeof o=="string"){if(!(o in za.md.algorithms))throw new Error("Unknown hash algorithm: "+o);o=za.md[o].create()}var a=o.digestLength;if(r>4294967295*a){var c=new Error("Derived key is too long.");if(s)return s(c);throw c}var l=Math.ceil(r/a),u=r-(l-1)*a,d=za.hmac.create();d.start(o,n);var p="",f,m,h;if(!s){for(var g=1;g<=l;++g){d.start(null,null),d.update(e),d.update(za.util.int32ToBytes(g)),f=h=d.digest().getBytes();for(var y=2;y<=t;++y)d.start(null,null),d.update(h),m=d.digest().getBytes(),f=za.util.xorBytes(f,m,a),h=m;p+=g<l?f:f.substr(0,u)}return p}var g=1,y;function b(){if(g>l)return s(null,p);d.start(null,null),d.update(e),d.update(za.util.int32ToBytes(g)),f=h=d.digest().getBytes(),y=2,_()}function _(){if(y<=t)return d.start(null,null),d.update(h),m=d.digest().getBytes(),f=za.util.xorBytes(f,m,a),h=m,++y,za.util.setImmediate(_);p+=g<l?f:f.substr(0,u),++g,b()}b()}});var zte=P((uRn,NCe)=>{var Rf=In();Ef();rr();var PCe=NCe.exports=Rf.sha256=Rf.sha256||{};Rf.md.sha256=Rf.md.algorithms.sha256=PCe;PCe.create=function(){ACe||jot();var n=null,e=Rf.util.createBuffer(),t=new Array(64),r={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return r.start=function(){r.messageLength=0,r.fullMessageLength=r.messageLength64=[];for(var o=r.messageLengthSize/4,s=0;s<o;++s)r.fullMessageLength.push(0);return e=Rf.util.createBuffer(),n={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},r},r.start(),r.update=function(o,s){s==="utf8"&&(o=Rf.util.encodeUtf8(o));var a=o.length;r.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var c=r.fullMessageLength.length-1;c>=0;--c)r.fullMessageLength[c]+=a[1],a[1]=a[0]+(r.fullMessageLength[c]/4294967296>>>0),r.fullMessageLength[c]=r.fullMessageLength[c]>>>0,a[0]=a[1]/4294967296>>>0;return e.putBytes(o),RCe(n,t,e),(e.read>2048||e.length()===0)&&e.compact(),r},r.digest=function(){var o=Rf.util.createBuffer();o.putBytes(e.bytes());var s=r.fullMessageLength[r.fullMessageLength.length-1]+r.messageLengthSize,a=s&r.blockLength-1;o.putBytes(Gte.substr(0,r.blockLength-a));for(var c,l,u=r.fullMessageLength[0]*8,d=0;d<r.fullMessageLength.length-1;++d)c=r.fullMessageLength[d+1]*8,l=c/4294967296>>>0,u+=l,o.putInt32(u>>>0),u=c>>>0;o.putInt32(u);var p={h0:n.h0,h1:n.h1,h2:n.h2,h3:n.h3,h4:n.h4,h5:n.h5,h6:n.h6,h7:n.h7};RCe(p,t,o);var f=Rf.util.createBuffer();return f.putInt32(p.h0),f.putInt32(p.h1),f.putInt32(p.h2),f.putInt32(p.h3),f.putInt32(p.h4),f.putInt32(p.h5),f.putInt32(p.h6),f.putInt32(p.h7),f},r};var Gte=null,ACe=!1,DCe=null;function jot(){Gte="\x80",Gte+=Rf.util.fillString("\0",64),DCe=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],ACe=!0}function RCe(n,e,t){for(var r,o,s,a,c,l,u,d,p,f,m,h,g,y,b,_=t.length();_>=64;){for(u=0;u<16;++u)e[u]=t.getInt32();for(;u<64;++u)r=e[u-2],r=(r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10,o=e[u-15],o=(o>>>7|o<<25)^(o>>>18|o<<14)^o>>>3,e[u]=r+e[u-7]+o+e[u-16]|0;for(d=n.h0,p=n.h1,f=n.h2,m=n.h3,h=n.h4,g=n.h5,y=n.h6,b=n.h7,u=0;u<64;++u)a=(h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7),c=y^h&(g^y),s=(d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),l=d&p|f&(d^p),r=b+a+c+DCe[u]+e[u],o=s+l,b=y,y=g,g=h,h=m+r>>>0,m=f,f=p,p=d,d=r+o>>>0;n.h0=n.h0+d|0,n.h1=n.h1+p|0,n.h2=n.h2+f|0,n.h3=n.h3+m|0,n.h4=n.h4+h|0,n.h5=n.h5+g|0,n.h6=n.h6+y|0,n.h7=n.h7+b|0,_-=64}}});var $te=P((dRn,LCe)=>{var Pf=In();rr();var O7=null;Pf.util.isNodejs&&!Pf.options.usePureJavaScript&&!process.versions["node-webkit"]&&(O7=require("crypto"));var Hot=LCe.exports=Pf.prng=Pf.prng||{};Hot.create=function(n){for(var e={plugin:n,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},t=n.md,r=new Array(32),o=0;o<32;++o)r[o]=t.create();e.pools=r,e.pool=0,e.generate=function(u,d){if(!d)return e.generateSync(u);var p=e.plugin.cipher,f=e.plugin.increment,m=e.plugin.formatKey,h=e.plugin.formatSeed,g=Pf.util.createBuffer();e.key=null,y();function y(b){if(b)return d(b);if(g.length()>=u)return d(null,g.getBytes(u));if(e.generated>1048575&&(e.key=null),e.key===null)return Pf.util.nextTick(function(){s(y)});var _=p(e.key,e.seed);e.generated+=_.length,g.putBytes(_),e.key=m(p(e.key,f(e.seed))),e.seed=h(p(e.key,e.seed)),Pf.util.setImmediate(y)}},e.generateSync=function(u){var d=e.plugin.cipher,p=e.plugin.increment,f=e.plugin.formatKey,m=e.plugin.formatSeed;e.key=null;for(var h=Pf.util.createBuffer();h.length()<u;){e.generated>1048575&&(e.key=null),e.key===null&&a();var g=d(e.key,e.seed);e.generated+=g.length,h.putBytes(g),e.key=f(d(e.key,p(e.seed))),e.seed=m(d(e.key,e.seed))}return h.getBytes(u)};function s(u){if(e.pools[0].messageLength>=32)return c(),u();var d=32-e.pools[0].messageLength<<5;e.seedFile(d,function(p,f){if(p)return u(p);e.collect(f),c(),u()})}function a(){if(e.pools[0].messageLength>=32)return c();var u=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(u)),c()}function c(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var u=e.plugin.md.create();u.update(e.keyBytes);for(var d=1,p=0;p<32;++p)e.reseeds%d===0&&(u.update(e.pools[p].digest().getBytes()),e.pools[p].start()),d=d<<1;e.keyBytes=u.digest().getBytes(),u.start(),u.update(e.keyBytes);var f=u.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(f),e.generated=0}function l(u){var d=null,p=Pf.util.globalScope,f=p.crypto||p.msCrypto;f&&f.getRandomValues&&(d=function(S){return f.getRandomValues(S)});var m=Pf.util.createBuffer();if(d)for(;m.length()<u;){var h=Math.max(1,Math.min(u-m.length(),65536)/4),g=new Uint32Array(Math.floor(h));try{d(g);for(var y=0;y<g.length;++y)m.putInt32(g[y])}catch(S){if(!(typeof QuotaExceededError<"u"&&S instanceof QuotaExceededError))throw S}}if(m.length()<u)for(var b,_,x,I=Math.floor(Math.random()*65536);m.length()<u;){_=16807*(I&65535),b=16807*(I>>16),_+=(b&32767)<<16,_+=b>>15,_=(_&2147483647)+(_>>31),I=_&4294967295;for(var y=0;y<3;++y)x=I>>>(y<<3),x^=Math.floor(Math.random()*256),m.putByte(x&255)}return m.getBytes(u)}return O7?(e.seedFile=function(u,d){O7.randomBytes(u,function(p,f){if(p)return d(p);d(null,f.toString())})},e.seedFileSync=function(u){return O7.randomBytes(u).toString()}):(e.seedFile=function(u,d){try{d(null,l(u))}catch(p){d(p)}},e.seedFileSync=l),e.collect=function(u){for(var d=u.length,p=0;p<d;++p)e.pools[e.pool].update(u.substr(p,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(u,d){for(var p="",f=0;f<d;f+=8)p+=String.fromCharCode(u>>f&255);e.collect(p)},e.registerWorker=function(u){if(u===self)e.seedFile=function(p,f){function m(h){var g=h.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",m),f(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",m),self.postMessage({forge:{prng:{needed:p}}})};else{var d=function(p){var f=p.data;f.forge&&f.forge.prng&&e.seedFile(f.forge.prng.needed,function(m,h){u.postMessage({forge:{prng:{err:m,bytes:h}}})})};u.addEventListener("message",d)}},e}});var Iu=P((pRn,Wte)=>{var Ds=In();vy();zte();$te();rr();(function(){if(Ds.random&&Ds.random.getBytes){Wte.exports=Ds.random;return}(function(n){var e={},t=new Array(4),r=Ds.util.createBuffer();e.formatKey=function(p){var f=Ds.util.createBuffer(p);return p=new Array(4),p[0]=f.getInt32(),p[1]=f.getInt32(),p[2]=f.getInt32(),p[3]=f.getInt32(),Ds.aes._expandKey(p,!1)},e.formatSeed=function(p){var f=Ds.util.createBuffer(p);return p=new Array(4),p[0]=f.getInt32(),p[1]=f.getInt32(),p[2]=f.getInt32(),p[3]=f.getInt32(),p},e.cipher=function(p,f){return Ds.aes._updateBlock(p,f,t,!1),r.putInt32(t[0]),r.putInt32(t[1]),r.putInt32(t[2]),r.putInt32(t[3]),r.getBytes()},e.increment=function(p){return++p[3],p},e.md=Ds.md.sha256;function o(){var p=Ds.prng.create(e);return p.getBytes=function(f,m){return p.generate(f,m)},p.getBytesSync=function(f){return p.generate(f)},p}var s=o(),a=null,c=Ds.util.globalScope,l=c.crypto||c.msCrypto;if(l&&l.getRandomValues&&(a=function(p){return l.getRandomValues(p)}),Ds.options.usePureJavaScript||!Ds.util.isNodejs&&!a){if(typeof window>"u"||window.document,s.collectInt(+new Date,32),typeof navigator<"u"){var u="";for(var d in navigator)try{typeof navigator[d]=="string"&&(u+=navigator[d])}catch{}s.collect(u),u=null}n&&(n().mousemove(function(p){s.collectInt(p.clientX,16),s.collectInt(p.clientY,16)}),n().keypress(function(p){s.collectInt(p.charCode,8)}))}if(!Ds.random)Ds.random=s;else for(var d in s)Ds.random[d]=s[d];Ds.random.createInstance=o,Wte.exports=Ds.random})(typeof jQuery<"u"?jQuery:null)})()});var Yte=P((fRn,FCe)=>{var Fc=In();rr();var Kte=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],OCe=[1,2,3,5],Vot=function(n,e){return n<<e&65535|(n&65535)>>16-e},Got=function(n,e){return(n&65535)>>e|n<<16-e&65535};FCe.exports=Fc.rc2=Fc.rc2||{};Fc.rc2.expandKey=function(n,e){typeof n=="string"&&(n=Fc.util.createBuffer(n)),e=e||128;var t=n,r=n.length(),o=e,s=Math.ceil(o/8),a=255>>(o&7),c;for(c=r;c<128;c++)t.putByte(Kte[t.at(c-1)+t.at(c-r)&255]);for(t.setAt(128-s,Kte[t.at(128-s)&a]),c=127-s;c>=0;c--)t.setAt(c,Kte[t.at(c+1)^t.at(c+s)]);return t};var MCe=function(n,e,t){var r=!1,o=null,s=null,a=null,c,l,u,d,p=[];for(n=Fc.rc2.expandKey(n,e),u=0;u<64;u++)p.push(n.getInt16Le());t?(c=function(h){for(u=0;u<4;u++)h[u]+=p[d]+(h[(u+3)%4]&h[(u+2)%4])+(~h[(u+3)%4]&h[(u+1)%4]),h[u]=Vot(h[u],OCe[u]),d++},l=function(h){for(u=0;u<4;u++)h[u]+=p[h[(u+3)%4]&63]}):(c=function(h){for(u=3;u>=0;u--)h[u]=Got(h[u],OCe[u]),h[u]-=p[d]+(h[(u+3)%4]&h[(u+2)%4])+(~h[(u+3)%4]&h[(u+1)%4]),d--},l=function(h){for(u=3;u>=0;u--)h[u]-=p[h[(u+3)%4]&63]});var f=function(h){var g=[];for(u=0;u<4;u++){var y=o.getInt16Le();a!==null&&(t?y^=a.getInt16Le():a.putInt16Le(y)),g.push(y&65535)}d=t?0:63;for(var b=0;b<h.length;b++)for(var _=0;_<h[b][0];_++)h[b][1](g);for(u=0;u<4;u++)a!==null&&(t?a.putInt16Le(g[u]):g[u]^=a.getInt16Le()),s.putInt16Le(g[u])},m=null;return m={start:function(h,g){h&&typeof h=="string"&&(h=Fc.util.createBuffer(h)),r=!1,o=Fc.util.createBuffer(),s=g||new Fc.util.createBuffer,a=h,m.output=s},update:function(h){for(r||o.putBuffer(h);o.length()>=8;)f([[5,c],[1,l],[6,c],[1,l],[5,c]])},finish:function(h){var g=!0;if(t)if(h)g=h(8,o,!t);else{var y=o.length()===8?8:8-o.length();o.fillWithByte(y,y)}if(g&&(r=!0,m.update()),!t&&(g=o.length()===0,g))if(h)g=h(8,s,!t);else{var b=s.length(),_=s.at(b-1);_>b?g=!1:s.truncate(_)}return g}},m};Fc.rc2.startEncrypting=function(n,e,t){var r=Fc.rc2.createEncryptionCipher(n,128);return r.start(e,t),r};Fc.rc2.createEncryptionCipher=function(n,e){return MCe(n,e,!0)};Fc.rc2.startDecrypting=function(n,e,t){var r=Fc.rc2.createDecryptionCipher(n,128);return r.start(e,t),r};Fc.rc2.createDecryptionCipher=function(n,e){return MCe(n,e,!1)}});var QL=P((mRn,zCe)=>{var Qte=In();zCe.exports=Qte.jsbn=Qte.jsbn||{};var Vh,zot=0xdeadbeefcafe,UCe=(zot&16777215)==15715070;function we(n,e,t){this.data=[],n!=null&&(typeof n=="number"?this.fromNumber(n,e,t):e==null&&typeof n!="string"?this.fromString(n,256):this.fromString(n,e))}Qte.jsbn.BigInteger=we;function ir(){return new we(null)}function $ot(n,e,t,r,o,s){for(;--s>=0;){var a=e*this.data[n++]+t.data[r]+o;o=Math.floor(a/67108864),t.data[r++]=a&67108863}return o}function Wot(n,e,t,r,o,s){for(var a=e&32767,c=e>>15;--s>=0;){var l=this.data[n]&32767,u=this.data[n++]>>15,d=c*l+u*a;l=a*l+((d&32767)<<15)+t.data[r]+(o&1073741823),o=(l>>>30)+(d>>>15)+c*u+(o>>>30),t.data[r++]=l&1073741823}return o}function BCe(n,e,t,r,o,s){for(var a=e&16383,c=e>>14;--s>=0;){var l=this.data[n]&16383,u=this.data[n++]>>14,d=c*l+u*a;l=a*l+((d&16383)<<14)+t.data[r]+o,o=(l>>28)+(d>>14)+c*u,t.data[r++]=l&268435455}return o}typeof navigator>"u"?(we.prototype.am=BCe,Vh=28):UCe&&navigator.appName=="Microsoft Internet Explorer"?(we.prototype.am=Wot,Vh=30):UCe&&navigator.appName!="Netscape"?(we.prototype.am=$ot,Vh=26):(we.prototype.am=BCe,Vh=28);we.prototype.DB=Vh;we.prototype.DM=(1<<Vh)-1;we.prototype.DV=1<<Vh;var Xte=52;we.prototype.FV=Math.pow(2,Xte);we.prototype.F1=Xte-Vh;we.prototype.F2=2*Vh-Xte;var Kot="0123456789abcdefghijklmnopqrstuvwxyz",M7=new Array,pw,Tu;pw=48;for(Tu=0;Tu<=9;++Tu)M7[pw++]=Tu;pw=97;for(Tu=10;Tu<36;++Tu)M7[pw++]=Tu;pw=65;for(Tu=10;Tu<36;++Tu)M7[pw++]=Tu;function qCe(n){return Kot.charAt(n)}function jCe(n,e){var t=M7[n.charCodeAt(e)];return t??-1}function Yot(n){for(var e=this.t-1;e>=0;--e)n.data[e]=this.data[e];n.t=this.t,n.s=this.s}function Qot(n){this.t=1,this.s=n<0?-1:0,n>0?this.data[0]=n:n<-1?this.data[0]=n+this.DV:this.t=0}function by(n){var e=ir();return e.fromInt(n),e}function Xot(n,e){var t;if(e==16)t=4;else if(e==8)t=3;else if(e==256)t=8;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else{this.fromRadix(n,e);return}this.t=0,this.s=0;for(var r=n.length,o=!1,s=0;--r>=0;){var a=t==8?n[r]&255:jCe(n,r);if(a<0){n.charAt(r)=="-"&&(o=!0);continue}o=!1,s==0?this.data[this.t++]=a:s+t>this.DB?(this.data[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this.data[this.t++]=a>>this.DB-s):this.data[this.t-1]|=a<<s,s+=t,s>=this.DB&&(s-=this.DB)}t==8&&n[0]&128&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),o&&we.ZERO.subTo(this,this)}function Jot(){for(var n=this.s&this.DM;this.t>0&&this.data[this.t-1]==n;)--this.t}function Zot(n){if(this.s<0)return"-"+this.negate().toString(n);var e;if(n==16)e=4;else if(n==8)e=3;else if(n==2)e=1;else if(n==32)e=5;else if(n==4)e=2;else return this.toRadix(n);var t=(1<<e)-1,r,o=!1,s="",a=this.t,c=this.DB-a*this.DB%e;if(a-- >0)for(c<this.DB&&(r=this.data[a]>>c)>0&&(o=!0,s=qCe(r));a>=0;)c<e?(r=(this.data[a]&(1<<c)-1)<<e-c,r|=this.data[--a]>>(c+=this.DB-e)):(r=this.data[a]>>(c-=e)&t,c<=0&&(c+=this.DB,--a)),r>0&&(o=!0),o&&(s+=qCe(r));return o?s:"0"}function est(){var n=ir();return we.ZERO.subTo(this,n),n}function tst(){return this.s<0?this.negate():this}function nst(n){var e=this.s-n.s;if(e!=0)return e;var t=this.t;if(e=t-n.t,e!=0)return this.s<0?-e:e;for(;--t>=0;)if((e=this.data[t]-n.data[t])!=0)return e;return 0}function F7(n){var e=1,t;return(t=n>>>16)!=0&&(n=t,e+=16),(t=n>>8)!=0&&(n=t,e+=8),(t=n>>4)!=0&&(n=t,e+=4),(t=n>>2)!=0&&(n=t,e+=2),(t=n>>1)!=0&&(n=t,e+=1),e}function rst(){return this.t<=0?0:this.DB*(this.t-1)+F7(this.data[this.t-1]^this.s&this.DM)}function ist(n,e){var t;for(t=this.t-1;t>=0;--t)e.data[t+n]=this.data[t];for(t=n-1;t>=0;--t)e.data[t]=0;e.t=this.t+n,e.s=this.s}function ost(n,e){for(var t=n;t<this.t;++t)e.data[t-n]=this.data[t];e.t=Math.max(this.t-n,0),e.s=this.s}function sst(n,e){var t=n%this.DB,r=this.DB-t,o=(1<<r)-1,s=Math.floor(n/this.DB),a=this.s<<t&this.DM,c;for(c=this.t-1;c>=0;--c)e.data[c+s+1]=this.data[c]>>r|a,a=(this.data[c]&o)<<t;for(c=s-1;c>=0;--c)e.data[c]=0;e.data[s]=a,e.t=this.t+s+1,e.s=this.s,e.clamp()}function ast(n,e){e.s=this.s;var t=Math.floor(n/this.DB);if(t>=this.t){e.t=0;return}var r=n%this.DB,o=this.DB-r,s=(1<<r)-1;e.data[0]=this.data[t]>>r;for(var a=t+1;a<this.t;++a)e.data[a-t-1]|=(this.data[a]&s)<<o,e.data[a-t]=this.data[a]>>r;r>0&&(e.data[this.t-t-1]|=(this.s&s)<<o),e.t=this.t-t,e.clamp()}function cst(n,e){for(var t=0,r=0,o=Math.min(n.t,this.t);t<o;)r+=this.data[t]-n.data[t],e.data[t++]=r&this.DM,r>>=this.DB;if(n.t<this.t){for(r-=n.s;t<this.t;)r+=this.data[t],e.data[t++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;t<n.t;)r-=n.data[t],e.data[t++]=r&this.DM,r>>=this.DB;r-=n.s}e.s=r<0?-1:0,r<-1?e.data[t++]=this.DV+r:r>0&&(e.data[t++]=r),e.t=t,e.clamp()}function lst(n,e){var t=this.abs(),r=n.abs(),o=t.t;for(e.t=o+r.t;--o>=0;)e.data[o]=0;for(o=0;o<r.t;++o)e.data[o+t.t]=t.am(0,r.data[o],e,o,0,t.t);e.s=0,e.clamp(),this.s!=n.s&&we.ZERO.subTo(e,e)}function ust(n){for(var e=this.abs(),t=n.t=2*e.t;--t>=0;)n.data[t]=0;for(t=0;t<e.t-1;++t){var r=e.am(t,e.data[t],n,2*t,0,1);(n.data[t+e.t]+=e.am(t+1,2*e.data[t],n,2*t+1,r,e.t-t-1))>=e.DV&&(n.data[t+e.t]-=e.DV,n.data[t+e.t+1]=1)}n.t>0&&(n.data[n.t-1]+=e.am(t,e.data[t],n,2*t,0,1)),n.s=0,n.clamp()}function dst(n,e,t){var r=n.abs();if(!(r.t<=0)){var o=this.abs();if(o.t<r.t){e?.fromInt(0),t!=null&&this.copyTo(t);return}t==null&&(t=ir());var s=ir(),a=this.s,c=n.s,l=this.DB-F7(r.data[r.t-1]);l>0?(r.lShiftTo(l,s),o.lShiftTo(l,t)):(r.copyTo(s),o.copyTo(t));var u=s.t,d=s.data[u-1];if(d!=0){var p=d*(1<<this.F1)+(u>1?s.data[u-2]>>this.F2:0),f=this.FV/p,m=(1<<this.F1)/p,h=1<<this.F2,g=t.t,y=g-u,b=e??ir();for(s.dlShiftTo(y,b),t.compareTo(b)>=0&&(t.data[t.t++]=1,t.subTo(b,t)),we.ONE.dlShiftTo(u,b),b.subTo(s,s);s.t<u;)s.data[s.t++]=0;for(;--y>=0;){var _=t.data[--g]==d?this.DM:Math.floor(t.data[g]*f+(t.data[g-1]+h)*m);if((t.data[g]+=s.am(0,_,t,y,0,u))<_)for(s.dlShiftTo(y,b),t.subTo(b,t);t.data[g]<--_;)t.subTo(b,t)}e!=null&&(t.drShiftTo(u,e),a!=c&&we.ZERO.subTo(e,e)),t.t=u,t.clamp(),l>0&&t.rShiftTo(l,t),a<0&&we.ZERO.subTo(t,t)}}}function pst(n){var e=ir();return this.abs().divRemTo(n,null,e),this.s<0&&e.compareTo(we.ZERO)>0&&n.subTo(e,e),e}function rS(n){this.m=n}function fst(n){return n.s<0||n.compareTo(this.m)>=0?n.mod(this.m):n}function mst(n){return n}function hst(n){n.divRemTo(this.m,null,n)}function gst(n,e,t){n.multiplyTo(e,t),this.reduce(t)}function vst(n,e){n.squareTo(e),this.reduce(e)}rS.prototype.convert=fst;rS.prototype.revert=mst;rS.prototype.reduce=hst;rS.prototype.mulTo=gst;rS.prototype.sqrTo=vst;function yst(){if(this.t<1)return 0;var n=this.data[0];if(!(n&1))return 0;var e=n&3;return e=e*(2-(n&15)*e)&15,e=e*(2-(n&255)*e)&255,e=e*(2-((n&65535)*e&65535))&65535,e=e*(2-n*e%this.DV)%this.DV,e>0?this.DV-e:-e}function iS(n){this.m=n,this.mp=n.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<n.DB-15)-1,this.mt2=2*n.t}function bst(n){var e=ir();return n.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),n.s<0&&e.compareTo(we.ZERO)>0&&this.m.subTo(e,e),e}function _st(n){var e=ir();return n.copyTo(e),this.reduce(e),e}function xst(n){for(;n.t<=this.mt2;)n.data[n.t++]=0;for(var e=0;e<this.m.t;++e){var t=n.data[e]&32767,r=t*this.mpl+((t*this.mph+(n.data[e]>>15)*this.mpl&this.um)<<15)&n.DM;for(t=e+this.m.t,n.data[t]+=this.m.am(0,r,n,e,0,this.m.t);n.data[t]>=n.DV;)n.data[t]-=n.DV,n.data[++t]++}n.clamp(),n.drShiftTo(this.m.t,n),n.compareTo(this.m)>=0&&n.subTo(this.m,n)}function Sst(n,e){n.squareTo(e),this.reduce(e)}function Ist(n,e,t){n.multiplyTo(e,t),this.reduce(t)}iS.prototype.convert=bst;iS.prototype.revert=_st;iS.prototype.reduce=xst;iS.prototype.mulTo=Ist;iS.prototype.sqrTo=Sst;function Tst(){return(this.t>0?this.data[0]&1:this.s)==0}function Cst(n,e){if(n>4294967295||n<1)return we.ONE;var t=ir(),r=ir(),o=e.convert(this),s=F7(n)-1;for(o.copyTo(t);--s>=0;)if(e.sqrTo(t,r),(n&1<<s)>0)e.mulTo(r,o,t);else{var a=t;t=r,r=a}return e.revert(t)}function Est(n,e){var t;return n<256||e.isEven()?t=new rS(e):t=new iS(e),this.exp(n,t)}we.prototype.copyTo=Yot;we.prototype.fromInt=Qot;we.prototype.fromString=Xot;we.prototype.clamp=Jot;we.prototype.dlShiftTo=ist;we.prototype.drShiftTo=ost;we.prototype.lShiftTo=sst;we.prototype.rShiftTo=ast;we.prototype.subTo=cst;we.prototype.multiplyTo=lst;we.prototype.squareTo=ust;we.prototype.divRemTo=dst;we.prototype.invDigit=yst;we.prototype.isEven=Tst;we.prototype.exp=Cst;we.prototype.toString=Zot;we.prototype.negate=est;we.prototype.abs=tst;we.prototype.compareTo=nst;we.prototype.bitLength=rst;we.prototype.mod=pst;we.prototype.modPowInt=Est;we.ZERO=by(0);we.ONE=by(1);function wst(){var n=ir();return this.copyTo(n),n}function kst(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Rst(){return this.t==0?this.s:this.data[0]<<24>>24}function Pst(){return this.t==0?this.s:this.data[0]<<16>>16}function Ast(n){return Math.floor(Math.LN2*this.DB/Math.log(n))}function Dst(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Nst(n){if(n==null&&(n=10),this.signum()==0||n<2||n>36)return"0";var e=this.chunkSize(n),t=Math.pow(n,e),r=by(t),o=ir(),s=ir(),a="";for(this.divRemTo(r,o,s);o.signum()>0;)a=(t+s.intValue()).toString(n).substr(1)+a,o.divRemTo(r,o,s);return s.intValue().toString(n)+a}function Lst(n,e){this.fromInt(0),e==null&&(e=10);for(var t=this.chunkSize(e),r=Math.pow(e,t),o=!1,s=0,a=0,c=0;c<n.length;++c){var l=jCe(n,c);if(l<0){n.charAt(c)=="-"&&this.signum()==0&&(o=!0);continue}a=e*a+l,++s>=t&&(this.dMultiply(r),this.dAddOffset(a,0),s=0,a=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(a,0)),o&&we.ZERO.subTo(this,this)}function Ost(n,e,t){if(typeof e=="number")if(n<2)this.fromInt(1);else for(this.fromNumber(n,t),this.testBit(n-1)||this.bitwiseTo(we.ONE.shiftLeft(n-1),Jte,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>n&&this.subTo(we.ONE.shiftLeft(n-1),this);else{var r=new Array,o=n&7;r.length=(n>>3)+1,e.nextBytes(r),o>0?r[0]&=(1<<o)-1:r[0]=0,this.fromString(r,256)}}function Mst(){var n=this.t,e=new Array;e[0]=this.s;var t=this.DB-n*this.DB%8,r,o=0;if(n-- >0)for(t<this.DB&&(r=this.data[n]>>t)!=(this.s&this.DM)>>t&&(e[o++]=r|this.s<<this.DB-t);n>=0;)t<8?(r=(this.data[n]&(1<<t)-1)<<8-t,r|=this.data[--n]>>(t+=this.DB-8)):(r=this.data[n]>>(t-=8)&255,t<=0&&(t+=this.DB,--n)),r&128&&(r|=-256),o==0&&(this.s&128)!=(r&128)&&++o,(o>0||r!=this.s)&&(e[o++]=r);return e}function Fst(n){return this.compareTo(n)==0}function Ust(n){return this.compareTo(n)<0?this:n}function Bst(n){return this.compareTo(n)>0?this:n}function qst(n,e,t){var r,o,s=Math.min(n.t,this.t);for(r=0;r<s;++r)t.data[r]=e(this.data[r],n.data[r]);if(n.t<this.t){for(o=n.s&this.DM,r=s;r<this.t;++r)t.data[r]=e(this.data[r],o);t.t=this.t}else{for(o=this.s&this.DM,r=s;r<n.t;++r)t.data[r]=e(o,n.data[r]);t.t=n.t}t.s=e(this.s,n.s),t.clamp()}function jst(n,e){return n&e}function Hst(n){var e=ir();return this.bitwiseTo(n,jst,e),e}function Jte(n,e){return n|e}function Vst(n){var e=ir();return this.bitwiseTo(n,Jte,e),e}function HCe(n,e){return n^e}function Gst(n){var e=ir();return this.bitwiseTo(n,HCe,e),e}function VCe(n,e){return n&~e}function zst(n){var e=ir();return this.bitwiseTo(n,VCe,e),e}function $st(){for(var n=ir(),e=0;e<this.t;++e)n.data[e]=this.DM&~this.data[e];return n.t=this.t,n.s=~this.s,n}function Wst(n){var e=ir();return n<0?this.rShiftTo(-n,e):this.lShiftTo(n,e),e}function Kst(n){var e=ir();return n<0?this.lShiftTo(-n,e):this.rShiftTo(n,e),e}function Yst(n){if(n==0)return-1;var e=0;return n&65535||(n>>=16,e+=16),n&255||(n>>=8,e+=8),n&15||(n>>=4,e+=4),n&3||(n>>=2,e+=2),n&1||++e,e}function Qst(){for(var n=0;n<this.t;++n)if(this.data[n]!=0)return n*this.DB+Yst(this.data[n]);return this.s<0?this.t*this.DB:-1}function Xst(n){for(var e=0;n!=0;)n&=n-1,++e;return e}function Jst(){for(var n=0,e=this.s&this.DM,t=0;t<this.t;++t)n+=Xst(this.data[t]^e);return n}function Zst(n){var e=Math.floor(n/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<n%this.DB)!=0}function eat(n,e){var t=we.ONE.shiftLeft(n);return this.bitwiseTo(t,e,t),t}function tat(n){return this.changeBit(n,Jte)}function nat(n){return this.changeBit(n,VCe)}function rat(n){return this.changeBit(n,HCe)}function iat(n,e){for(var t=0,r=0,o=Math.min(n.t,this.t);t<o;)r+=this.data[t]+n.data[t],e.data[t++]=r&this.DM,r>>=this.DB;if(n.t<this.t){for(r+=n.s;t<this.t;)r+=this.data[t],e.data[t++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;t<n.t;)r+=n.data[t],e.data[t++]=r&this.DM,r>>=this.DB;r+=n.s}e.s=r<0?-1:0,r>0?e.data[t++]=r:r<-1&&(e.data[t++]=this.DV+r),e.t=t,e.clamp()}function oat(n){var e=ir();return this.addTo(n,e),e}function sat(n){var e=ir();return this.subTo(n,e),e}function aat(n){var e=ir();return this.multiplyTo(n,e),e}function cat(n){var e=ir();return this.divRemTo(n,e,null),e}function lat(n){var e=ir();return this.divRemTo(n,null,e),e}function uat(n){var e=ir(),t=ir();return this.divRemTo(n,e,t),new Array(e,t)}function dat(n){this.data[this.t]=this.am(0,n-1,this,0,0,this.t),++this.t,this.clamp()}function pat(n,e){if(n!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=n;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function YL(){}function GCe(n){return n}function fat(n,e,t){n.multiplyTo(e,t)}function mat(n,e){n.squareTo(e)}YL.prototype.convert=GCe;YL.prototype.revert=GCe;YL.prototype.mulTo=fat;YL.prototype.sqrTo=mat;function hat(n){return this.exp(n,new YL)}function gat(n,e,t){var r=Math.min(this.t+n.t,e);for(t.s=0,t.t=r;r>0;)t.data[--r]=0;var o;for(o=t.t-this.t;r<o;++r)t.data[r+this.t]=this.am(0,n.data[r],t,r,0,this.t);for(o=Math.min(n.t,e);r<o;++r)this.am(0,n.data[r],t,r,0,e-r);t.clamp()}function vat(n,e,t){--e;var r=t.t=this.t+n.t-e;for(t.s=0;--r>=0;)t.data[r]=0;for(r=Math.max(e-this.t,0);r<n.t;++r)t.data[this.t+r-e]=this.am(e-r,n.data[r],t,0,0,this.t+r-e);t.clamp(),t.drShiftTo(1,t)}function fw(n){this.r2=ir(),this.q3=ir(),we.ONE.dlShiftTo(2*n.t,this.r2),this.mu=this.r2.divide(n),this.m=n}function yat(n){if(n.s<0||n.t>2*this.m.t)return n.mod(this.m);if(n.compareTo(this.m)<0)return n;var e=ir();return n.copyTo(e),this.reduce(e),e}function bat(n){return n}function _at(n){for(n.drShiftTo(this.m.t-1,this.r2),n.t>this.m.t+1&&(n.t=this.m.t+1,n.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);n.compareTo(this.r2)<0;)n.dAddOffset(1,this.m.t+1);for(n.subTo(this.r2,n);n.compareTo(this.m)>=0;)n.subTo(this.m,n)}function xat(n,e){n.squareTo(e),this.reduce(e)}function Sat(n,e,t){n.multiplyTo(e,t),this.reduce(t)}fw.prototype.convert=yat;fw.prototype.revert=bat;fw.prototype.reduce=_at;fw.prototype.mulTo=Sat;fw.prototype.sqrTo=xat;function Iat(n,e){var t=n.bitLength(),r,o=by(1),s;if(t<=0)return o;t<18?r=1:t<48?r=3:t<144?r=4:t<768?r=5:r=6,t<8?s=new rS(e):e.isEven()?s=new fw(e):s=new iS(e);var a=new Array,c=3,l=r-1,u=(1<<r)-1;if(a[1]=s.convert(this),r>1){var d=ir();for(s.sqrTo(a[1],d);c<=u;)a[c]=ir(),s.mulTo(d,a[c-2],a[c]),c+=2}var p=n.t-1,f,m=!0,h=ir(),g;for(t=F7(n.data[p])-1;p>=0;){for(t>=l?f=n.data[p]>>t-l&u:(f=(n.data[p]&(1<<t+1)-1)<<l-t,p>0&&(f|=n.data[p-1]>>this.DB+t-l)),c=r;!(f&1);)f>>=1,--c;if((t-=c)<0&&(t+=this.DB,--p),m)a[f].copyTo(o),m=!1;else{for(;c>1;)s.sqrTo(o,h),s.sqrTo(h,o),c-=2;c>0?s.sqrTo(o,h):(g=o,o=h,h=g),s.mulTo(h,a[f],o)}for(;p>=0&&!(n.data[p]&1<<t);)s.sqrTo(o,h),g=o,o=h,h=g,--t<0&&(t=this.DB-1,--p)}return s.revert(o)}function Tat(n){var e=this.s<0?this.negate():this.clone(),t=n.s<0?n.negate():n.clone();if(e.compareTo(t)<0){var r=e;e=t,t=r}var o=e.getLowestSetBit(),s=t.getLowestSetBit();if(s<0)return e;for(o<s&&(s=o),s>0&&(e.rShiftTo(s,e),t.rShiftTo(s,t));e.signum()>0;)(o=e.getLowestSetBit())>0&&e.rShiftTo(o,e),(o=t.getLowestSetBit())>0&&t.rShiftTo(o,t),e.compareTo(t)>=0?(e.subTo(t,e),e.rShiftTo(1,e)):(t.subTo(e,t),t.rShiftTo(1,t));return s>0&&t.lShiftTo(s,t),t}function Cat(n){if(n<=0)return 0;var e=this.DV%n,t=this.s<0?n-1:0;if(this.t>0)if(e==0)t=this.data[0]%n;else for(var r=this.t-1;r>=0;--r)t=(e*t+this.data[r])%n;return t}function Eat(n){var e=n.isEven();if(this.isEven()&&e||n.signum()==0)return we.ZERO;for(var t=n.clone(),r=this.clone(),o=by(1),s=by(0),a=by(0),c=by(1);t.signum()!=0;){for(;t.isEven();)t.rShiftTo(1,t),e?((!o.isEven()||!s.isEven())&&(o.addTo(this,o),s.subTo(n,s)),o.rShiftTo(1,o)):s.isEven()||s.subTo(n,s),s.rShiftTo(1,s);for(;r.isEven();)r.rShiftTo(1,r),e?((!a.isEven()||!c.isEven())&&(a.addTo(this,a),c.subTo(n,c)),a.rShiftTo(1,a)):c.isEven()||c.subTo(n,c),c.rShiftTo(1,c);t.compareTo(r)>=0?(t.subTo(r,t),e&&o.subTo(a,o),s.subTo(c,s)):(r.subTo(t,r),e&&a.subTo(o,a),c.subTo(s,c))}if(r.compareTo(we.ONE)!=0)return we.ZERO;if(c.compareTo(n)>=0)return c.subtract(n);if(c.signum()<0)c.addTo(n,c);else return c;return c.signum()<0?c.add(n):c}var Xd=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],wat=(1<<26)/Xd[Xd.length-1];function kat(n){var e,t=this.abs();if(t.t==1&&t.data[0]<=Xd[Xd.length-1]){for(e=0;e<Xd.length;++e)if(t.data[0]==Xd[e])return!0;return!1}if(t.isEven())return!1;for(e=1;e<Xd.length;){for(var r=Xd[e],o=e+1;o<Xd.length&&r<wat;)r*=Xd[o++];for(r=t.modInt(r);e<o;)if(r%Xd[e++]==0)return!1}return t.millerRabin(n)}function Rat(n){var e=this.subtract(we.ONE),t=e.getLowestSetBit();if(t<=0)return!1;for(var r=e.shiftRight(t),o=Pat(),s,a=0;a<n;++a){do s=new we(this.bitLength(),o);while(s.compareTo(we.ONE)<=0||s.compareTo(e)>=0);var c=s.modPow(r,this);if(c.compareTo(we.ONE)!=0&&c.compareTo(e)!=0){for(var l=1;l++<t&&c.compareTo(e)!=0;)if(c=c.modPowInt(2,this),c.compareTo(we.ONE)==0)return!1;if(c.compareTo(e)!=0)return!1}}return!0}function Pat(){return{nextBytes:function(n){for(var e=0;e<n.length;++e)n[e]=Math.floor(Math.random()*256)}}}we.prototype.chunkSize=Ast;we.prototype.toRadix=Nst;we.prototype.fromRadix=Lst;we.prototype.fromNumber=Ost;we.prototype.bitwiseTo=qst;we.prototype.changeBit=eat;we.prototype.addTo=iat;we.prototype.dMultiply=dat;we.prototype.dAddOffset=pat;we.prototype.multiplyLowerTo=gat;we.prototype.multiplyUpperTo=vat;we.prototype.modInt=Cat;we.prototype.millerRabin=Rat;we.prototype.clone=wst;we.prototype.intValue=kst;we.prototype.byteValue=Rst;we.prototype.shortValue=Pst;we.prototype.signum=Dst;we.prototype.toByteArray=Mst;we.prototype.equals=Fst;we.prototype.min=Ust;we.prototype.max=Bst;we.prototype.and=Hst;we.prototype.or=Vst;we.prototype.xor=Gst;we.prototype.andNot=zst;we.prototype.not=$st;we.prototype.shiftLeft=Wst;we.prototype.shiftRight=Kst;we.prototype.getLowestSetBit=Qst;we.prototype.bitCount=Jst;we.prototype.testBit=Zst;we.prototype.setBit=tat;we.prototype.clearBit=nat;we.prototype.flipBit=rat;we.prototype.add=oat;we.prototype.subtract=sat;we.prototype.multiply=aat;we.prototype.divide=cat;we.prototype.remainder=lat;we.prototype.divideAndRemainder=uat;we.prototype.modPow=Iat;we.prototype.modInverse=Eat;we.prototype.pow=hat;we.prototype.gcd=Tat;we.prototype.isProbablePrime=kat});var mw=P((hRn,YCe)=>{var Af=In();Ef();rr();var WCe=YCe.exports=Af.sha1=Af.sha1||{};Af.md.sha1=Af.md.algorithms.sha1=WCe;WCe.create=function(){KCe||Aat();var n=null,e=Af.util.createBuffer(),t=new Array(80),r={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return r.start=function(){r.messageLength=0,r.fullMessageLength=r.messageLength64=[];for(var o=r.messageLengthSize/4,s=0;s<o;++s)r.fullMessageLength.push(0);return e=Af.util.createBuffer(),n={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},r},r.start(),r.update=function(o,s){s==="utf8"&&(o=Af.util.encodeUtf8(o));var a=o.length;r.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var c=r.fullMessageLength.length-1;c>=0;--c)r.fullMessageLength[c]+=a[1],a[1]=a[0]+(r.fullMessageLength[c]/4294967296>>>0),r.fullMessageLength[c]=r.fullMessageLength[c]>>>0,a[0]=a[1]/4294967296>>>0;return e.putBytes(o),$Ce(n,t,e),(e.read>2048||e.length()===0)&&e.compact(),r},r.digest=function(){var o=Af.util.createBuffer();o.putBytes(e.bytes());var s=r.fullMessageLength[r.fullMessageLength.length-1]+r.messageLengthSize,a=s&r.blockLength-1;o.putBytes(Zte.substr(0,r.blockLength-a));for(var c,l,u=r.fullMessageLength[0]*8,d=0;d<r.fullMessageLength.length-1;++d)c=r.fullMessageLength[d+1]*8,l=c/4294967296>>>0,u+=l,o.putInt32(u>>>0),u=c>>>0;o.putInt32(u);var p={h0:n.h0,h1:n.h1,h2:n.h2,h3:n.h3,h4:n.h4};$Ce(p,t,o);var f=Af.util.createBuffer();return f.putInt32(p.h0),f.putInt32(p.h1),f.putInt32(p.h2),f.putInt32(p.h3),f.putInt32(p.h4),f},r};var Zte=null,KCe=!1;function Aat(){Zte="\x80",Zte+=Af.util.fillString("\0",64),KCe=!0}function $Ce(n,e,t){for(var r,o,s,a,c,l,u,d,p=t.length();p>=64;){for(o=n.h0,s=n.h1,a=n.h2,c=n.h3,l=n.h4,d=0;d<16;++d)r=t.getInt32(),e[d]=r,u=c^s&(a^c),r=(o<<5|o>>>27)+u+l+1518500249+r,l=c,c=a,a=(s<<30|s>>>2)>>>0,s=o,o=r;for(;d<20;++d)r=e[d-3]^e[d-8]^e[d-14]^e[d-16],r=r<<1|r>>>31,e[d]=r,u=c^s&(a^c),r=(o<<5|o>>>27)+u+l+1518500249+r,l=c,c=a,a=(s<<30|s>>>2)>>>0,s=o,o=r;for(;d<32;++d)r=e[d-3]^e[d-8]^e[d-14]^e[d-16],r=r<<1|r>>>31,e[d]=r,u=s^a^c,r=(o<<5|o>>>27)+u+l+1859775393+r,l=c,c=a,a=(s<<30|s>>>2)>>>0,s=o,o=r;for(;d<40;++d)r=e[d-6]^e[d-16]^e[d-28]^e[d-32],r=r<<2|r>>>30,e[d]=r,u=s^a^c,r=(o<<5|o>>>27)+u+l+1859775393+r,l=c,c=a,a=(s<<30|s>>>2)>>>0,s=o,o=r;for(;d<60;++d)r=e[d-6]^e[d-16]^e[d-28]^e[d-32],r=r<<2|r>>>30,e[d]=r,u=s&a|c&(s^a),r=(o<<5|o>>>27)+u+l+2400959708+r,l=c,c=a,a=(s<<30|s>>>2)>>>0,s=o,o=r;for(;d<80;++d)r=e[d-6]^e[d-16]^e[d-28]^e[d-32],r=r<<2|r>>>30,e[d]=r,u=s^a^c,r=(o<<5|o>>>27)+u+l+3395469782+r,l=c,c=a,a=(s<<30|s>>>2)>>>0,s=o,o=r;n.h0=n.h0+o|0,n.h1=n.h1+s|0,n.h2=n.h2+a|0,n.h3=n.h3+c|0,n.h4=n.h4+l|0,p-=64}}});var ene=P((gRn,XCe)=>{var Df=In();rr();Iu();mw();var QCe=XCe.exports=Df.pkcs1=Df.pkcs1||{};QCe.encode_rsa_oaep=function(n,e,t){var r,o,s,a;typeof t=="string"?(r=t,o=arguments[3]||void 0,s=arguments[4]||void 0):t&&(r=t.label||void 0,o=t.seed||void 0,s=t.md||void 0,t.mgf1&&t.mgf1.md&&(a=t.mgf1.md)),s?s.start():s=Df.md.sha1.create(),a||(a=s);var c=Math.ceil(n.n.bitLength()/8),l=c-2*s.digestLength-2;if(e.length>l){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=e.length,u.maxLength=l,u}r||(r=""),s.update(r,"raw");for(var d=s.digest(),p="",f=l-e.length,m=0;m<f;m++)p+="\0";var h=d.getBytes()+p+""+e;if(!o)o=Df.random.getBytes(s.digestLength);else if(o.length!==s.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=o.length,u.digestLength=s.digestLength,u}var g=U7(o,c-s.digestLength-1,a),y=Df.util.xorBytes(h,g,h.length),b=U7(y,s.digestLength,a),_=Df.util.xorBytes(o,b,o.length);return"\0"+_+y};QCe.decode_rsa_oaep=function(n,e,t){var r,o,s;typeof t=="string"?(r=t,o=arguments[3]||void 0):t&&(r=t.label||void 0,o=t.md||void 0,t.mgf1&&t.mgf1.md&&(s=t.mgf1.md));var a=Math.ceil(n.n.bitLength()/8);if(e.length!==a){var y=new Error("RSAES-OAEP encoded message length is invalid.");throw y.length=e.length,y.expectedLength=a,y}if(o===void 0?o=Df.md.sha1.create():o.start(),s||(s=o),a<2*o.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");r||(r=""),o.update(r,"raw");for(var c=o.digest().getBytes(),l=e.charAt(0),u=e.substring(1,o.digestLength+1),d=e.substring(1+o.digestLength),p=U7(d,o.digestLength,s),f=Df.util.xorBytes(u,p,u.length),m=U7(f,a-o.digestLength-1,s),h=Df.util.xorBytes(d,m,d.length),g=h.substring(0,o.digestLength),y=l!=="\0",b=0;b<o.digestLength;++b)y|=c.charAt(b)!==g.charAt(b);for(var _=1,x=o.digestLength,I=o.digestLength;I<h.length;I++){var S=h.charCodeAt(I),w=S&1^1,R=_?65534:0;y|=S&R,_=_&w,x+=_}if(y||h.charCodeAt(x)!==1)throw new Error("Invalid RSAES-OAEP padding.");return h.substring(x+1)};function U7(n,e,t){t||(t=Df.md.sha1.create());for(var r="",o=Math.ceil(e/t.digestLength),s=0;s<o;++s){var a=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);t.start(),t.update(n+a),r+=t.digest().getBytes()}return r.substring(0,e)}});var nne=P((vRn,tne)=>{var _y=In();rr();QL();Iu();(function(){if(_y.prime){tne.exports=_y.prime;return}var n=tne.exports=_y.prime=_y.prime||{},e=_y.jsbn.BigInteger,t=[6,4,2,4,2,4,6,2],r=new e(null);r.fromInt(30);var o=function(p,f){return p|f};n.generateProbablePrime=function(p,f,m){typeof f=="function"&&(m=f,f={}),f=f||{};var h=f.algorithm||"PRIMEINC";typeof h=="string"&&(h={name:h}),h.options=h.options||{};var g=f.prng||_y.random,y={nextBytes:function(b){for(var _=g.getBytesSync(b.length),x=0;x<b.length;++x)b[x]=_.charCodeAt(x)}};if(h.name==="PRIMEINC")return s(p,y,h.options,m);throw new Error("Invalid prime generation algorithm: "+h.name)};function s(p,f,m,h){return"workers"in m?l(p,f,m,h):a(p,f,m,h)}function a(p,f,m,h){var g=u(p,f),y=0,b=d(g.bitLength());"millerRabinTests"in m&&(b=m.millerRabinTests);var _=10;"maxBlockTime"in m&&(_=m.maxBlockTime),c(g,p,f,y,b,_,h)}function c(p,f,m,h,g,y,b){var _=+new Date;do{if(p.bitLength()>f&&(p=u(f,m)),p.isProbablePrime(g))return b(null,p);p.dAddOffset(t[h++%8],0)}while(y<0||+new Date-_<y);_y.util.setImmediate(function(){c(p,f,m,h,g,y,b)})}function l(p,f,m,h){if(typeof Worker>"u")return a(p,f,m,h);var g=u(p,f),y=m.workers,b=m.workLoad||100,_=b*30/8,x=m.workerScript||"forge/prime.worker.js";if(y===-1)return _y.util.estimateCores(function(S,w){S&&(w=2),y=w-1,I()});I();function I(){y=Math.max(1,y);for(var S=[],w=0;w<y;++w)S[w]=new Worker(x);for(var R=y,w=0;w<y;++w)S[w].addEventListener("message",V);var k=!1;function V(F){if(!k){--R;var K=F.data;if(K.found){for(var $=0;$<S.length;++$)S[$].terminate();return k=!0,h(null,new e(K.prime,16))}g.bitLength()>p&&(g=u(p,f));var j=g.toString(16);F.target.postMessage({hex:j,workLoad:b}),g.dAddOffset(_,0)}}}}function u(p,f){var m=new e(p,f),h=p-1;return m.testBit(h)||m.bitwiseTo(e.ONE.shiftLeft(h),o,m),m.dAddOffset(31-m.mod(r).byteValue(),0),m}function d(p){return p<=100?27:p<=150?18:p<=200?15:p<=250?12:p<=300?9:p<=350?8:p<=400?7:p<=500?6:p<=600?5:p<=800?4:p<=1250?3:2}})()});var XL=P((yRn,iEe)=>{var Lt=In();Qd();QL();yy();ene();nne();Iu();rr();typeof Jn>"u"&&(Jn=Lt.jsbn.BigInteger);var Jn,rne=Lt.util.isNodejs?require("crypto"):null,se=Lt.asn1,Cu=Lt.util;Lt.pki=Lt.pki||{};iEe.exports=Lt.pki.rsa=Lt.rsa=Lt.rsa||{};var cn=Lt.pki,Dat=[6,4,2,4,2,4,6,2],Nat={name:"PrivateKeyInfo",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:se.Class.UNIVERSAL,type:se.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:se.Class.UNIVERSAL,type:se.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Lat={name:"RSAPrivateKey",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Oat={name:"RSAPublicKey",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},Mat=Lt.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:se.Class.UNIVERSAL,type:se.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:se.Class.UNIVERSAL,type:se.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Fat={name:"DigestInfo",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:se.Class.UNIVERSAL,type:se.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:se.Class.UNIVERSAL,type:se.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:se.Class.UNIVERSAL,type:se.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Uat=function(n){var e;if(n.algorithm in cn.oids)e=cn.oids[n.algorithm];else{var t=new Error("Unknown message digest algorithm.");throw t.algorithm=n.algorithm,t}var r=se.oidToDer(e).getBytes(),o=se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[]),s=se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[]);s.value.push(se.create(se.Class.UNIVERSAL,se.Type.OID,!1,r)),s.value.push(se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,""));var a=se.create(se.Class.UNIVERSAL,se.Type.OCTETSTRING,!1,n.digest().getBytes());return o.value.push(s),o.value.push(a),se.toDer(o).getBytes()},nEe=function(n,e,t){if(t)return n.modPow(e.e,e.n);if(!e.p||!e.q)return n.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(Jn.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(Jn.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var r;do r=new Jn(Lt.util.bytesToHex(Lt.random.getBytes(e.n.bitLength()/8)),16);while(r.compareTo(e.n)>=0||!r.gcd(e.n).equals(Jn.ONE));n=n.multiply(r.modPow(e.e,e.n)).mod(e.n);for(var o=n.mod(e.p).modPow(e.dP,e.p),s=n.mod(e.q).modPow(e.dQ,e.q);o.compareTo(s)<0;)o=o.add(e.p);var a=o.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return a=a.multiply(r.modInverse(e.n)).mod(e.n),a};cn.rsa.encrypt=function(n,e,t){var r=t,o,s=Math.ceil(e.n.bitLength()/8);t!==!1&&t!==!0?(r=t===2,o=rEe(n,e,t)):(o=Lt.util.createBuffer(),o.putBytes(n));for(var a=new Jn(o.toHex(),16),c=nEe(a,e,r),l=c.toString(16),u=Lt.util.createBuffer(),d=s-Math.ceil(l.length/2);d>0;)u.putByte(0),--d;return u.putBytes(Lt.util.hexToBytes(l)),u.getBytes()};cn.rsa.decrypt=function(n,e,t,r){var o=Math.ceil(e.n.bitLength()/8);if(n.length!==o){var s=new Error("Encrypted message length is invalid.");throw s.length=n.length,s.expected=o,s}var a=new Jn(Lt.util.createBuffer(n).toHex(),16);if(a.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var c=nEe(a,e,t),l=c.toString(16),u=Lt.util.createBuffer(),d=o-Math.ceil(l.length/2);d>0;)u.putByte(0),--d;return u.putBytes(Lt.util.hexToBytes(l)),r!==!1?B7(u.getBytes(),e,t):u.getBytes()};cn.rsa.createKeyPairGenerationState=function(n,e,t){typeof n=="string"&&(n=parseInt(n,10)),n=n||2048,t=t||{};var r=t.prng||Lt.random,o={nextBytes:function(c){for(var l=r.getBytesSync(c.length),u=0;u<c.length;++u)c[u]=l.charCodeAt(u)}},s=t.algorithm||"PRIMEINC",a;if(s==="PRIMEINC")a={algorithm:s,state:0,bits:n,rng:o,eInt:e||65537,e:new Jn(null),p:null,q:null,qBits:n>>1,pBits:n-(n>>1),pqState:0,num:null,keys:null},a.e.fromInt(a.eInt);else throw new Error("Invalid key generation algorithm: "+s);return a};cn.rsa.stepKeyPairGenerationState=function(n,e){"algorithm"in n||(n.algorithm="PRIMEINC");var t=new Jn(null);t.fromInt(30);for(var r=0,o=function(p,f){return p|f},s=+new Date,a,c=0;n.keys===null&&(e<=0||c<e);){if(n.state===0){var l=n.p===null?n.pBits:n.qBits,u=l-1;n.pqState===0?(n.num=new Jn(l,n.rng),n.num.testBit(u)||n.num.bitwiseTo(Jn.ONE.shiftLeft(u),o,n.num),n.num.dAddOffset(31-n.num.mod(t).byteValue(),0),r=0,++n.pqState):n.pqState===1?n.num.bitLength()>l?n.pqState=0:n.num.isProbablePrime(qat(n.num.bitLength()))?++n.pqState:n.num.dAddOffset(Dat[r++%8],0):n.pqState===2?n.pqState=n.num.subtract(Jn.ONE).gcd(n.e).compareTo(Jn.ONE)===0?3:0:n.pqState===3&&(n.pqState=0,n.p===null?n.p=n.num:n.q=n.num,n.p!==null&&n.q!==null&&++n.state,n.num=null)}else if(n.state===1)n.p.compareTo(n.q)<0&&(n.num=n.p,n.p=n.q,n.q=n.num),++n.state;else if(n.state===2)n.p1=n.p.subtract(Jn.ONE),n.q1=n.q.subtract(Jn.ONE),n.phi=n.p1.multiply(n.q1),++n.state;else if(n.state===3)n.phi.gcd(n.e).compareTo(Jn.ONE)===0?++n.state:(n.p=null,n.q=null,n.state=0);else if(n.state===4)n.n=n.p.multiply(n.q),n.n.bitLength()===n.bits?++n.state:(n.q=null,n.state=0);else if(n.state===5){var d=n.e.modInverse(n.phi);n.keys={privateKey:cn.rsa.setPrivateKey(n.n,n.e,d,n.p,n.q,d.mod(n.p1),d.mod(n.q1),n.q.modInverse(n.p)),publicKey:cn.rsa.setPublicKey(n.n,n.e)}}a=+new Date,c+=a-s,s=a}return n.keys!==null};cn.rsa.generateKeyPair=function(n,e,t,r){if(arguments.length===1?typeof n=="object"?(t=n,n=void 0):typeof n=="function"&&(r=n,n=void 0):arguments.length===2?typeof n=="number"?typeof e=="function"?(r=e,e=void 0):typeof e!="number"&&(t=e,e=void 0):(t=n,r=e,n=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof t=="function"&&(r=t,t=void 0):(r=t,t=e,e=void 0)),t=t||{},n===void 0&&(n=t.bits||2048),e===void 0&&(e=t.e||65537),!Lt.options.usePureJavaScript&&!t.prng&&n>=256&&n<=16384&&(e===65537||e===3)){if(r){if(JCe("generateKeyPair"))return rne.generateKeyPair("rsa",{modulusLength:n,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(c,l,u){if(c)return r(c);r(null,{privateKey:cn.privateKeyFromPem(u),publicKey:cn.publicKeyFromPem(l)})});if(ZCe("generateKey")&&ZCe("exportKey"))return Cu.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:n,publicExponent:tEe(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(c){return Cu.globalScope.crypto.subtle.exportKey("pkcs8",c.privateKey)}).then(void 0,function(c){r(c)}).then(function(c){if(c){var l=cn.privateKeyFromAsn1(se.fromDer(Lt.util.createBuffer(c)));r(null,{privateKey:l,publicKey:cn.setRsaPublicKey(l.n,l.e)})}});if(eEe("generateKey")&&eEe("exportKey")){var o=Cu.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:n,publicExponent:tEe(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);o.oncomplete=function(c){var l=c.target.result,u=Cu.globalScope.msCrypto.subtle.exportKey("pkcs8",l.privateKey);u.oncomplete=function(d){var p=d.target.result,f=cn.privateKeyFromAsn1(se.fromDer(Lt.util.createBuffer(p)));r(null,{privateKey:f,publicKey:cn.setRsaPublicKey(f.n,f.e)})},u.onerror=function(d){r(d)}},o.onerror=function(c){r(c)};return}}else if(JCe("generateKeyPairSync")){var s=rne.generateKeyPairSync("rsa",{modulusLength:n,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:cn.privateKeyFromPem(s.privateKey),publicKey:cn.publicKeyFromPem(s.publicKey)}}}var a=cn.rsa.createKeyPairGenerationState(n,e,t);if(!r)return cn.rsa.stepKeyPairGenerationState(a,0),a.keys;Bat(a,t,r)};cn.setRsaPublicKey=cn.rsa.setPublicKey=function(n,e){var t={n,e};return t.encrypt=function(r,o,s){if(typeof o=="string"?o=o.toUpperCase():o===void 0&&(o="RSAES-PKCS1-V1_5"),o==="RSAES-PKCS1-V1_5")o={encode:function(c,l,u){return rEe(c,l,2).getBytes()}};else if(o==="RSA-OAEP"||o==="RSAES-OAEP")o={encode:function(c,l){return Lt.pkcs1.encode_rsa_oaep(l,c,s)}};else if(["RAW","NONE","NULL",null].indexOf(o)!==-1)o={encode:function(c){return c}};else if(typeof o=="string")throw new Error('Unsupported encryption scheme: "'+o+'".');var a=o.encode(r,t,!0);return cn.rsa.encrypt(a,t,!0)},t.verify=function(r,o,s,a){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),a===void 0&&(a={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in a||(a._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(l,u){u=B7(u,t,!0);var d=se.fromDer(u,{parseAllBytes:a._parseAllDigestBytes}),p={},f=[];if(!se.validate(d,Fat,p,f)){var m=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw m.errors=f,m}var h=se.derToOid(p.algorithmIdentifier);if(!(h===Lt.oids.md2||h===Lt.oids.md5||h===Lt.oids.sha1||h===Lt.oids.sha224||h===Lt.oids.sha256||h===Lt.oids.sha384||h===Lt.oids.sha512||h===Lt.oids["sha512-224"]||h===Lt.oids["sha512-256"])){var m=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw m.oid=h,m}if((h===Lt.oids.md2||h===Lt.oids.md5)&&!("parameters"in p))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return l===p.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(l,u){return u=B7(u,t,!0),l===u}});var c=cn.rsa.decrypt(o,t,!0,!1);return s.verify(r,c,t.n.bitLength())},t};cn.setRsaPrivateKey=cn.rsa.setPrivateKey=function(n,e,t,r,o,s,a,c){var l={n,e,d:t,p:r,q:o,dP:s,dQ:a,qInv:c};return l.decrypt=function(u,d,p){typeof d=="string"?d=d.toUpperCase():d===void 0&&(d="RSAES-PKCS1-V1_5");var f=cn.rsa.decrypt(u,l,!1,!1);if(d==="RSAES-PKCS1-V1_5")d={decode:B7};else if(d==="RSA-OAEP"||d==="RSAES-OAEP")d={decode:function(m,h){return Lt.pkcs1.decode_rsa_oaep(h,m,p)}};else if(["RAW","NONE","NULL",null].indexOf(d)!==-1)d={decode:function(m){return m}};else throw new Error('Unsupported encryption scheme: "'+d+'".');return d.decode(f,l,!1)},l.sign=function(u,d){var p=!1;typeof d=="string"&&(d=d.toUpperCase()),d===void 0||d==="RSASSA-PKCS1-V1_5"?(d={encode:Uat},p=1):(d==="NONE"||d==="NULL"||d===null)&&(d={encode:function(){return u}},p=1);var f=d.encode(u,l.n.bitLength());return cn.rsa.encrypt(f,l,p)},l};cn.wrapRsaPrivateKey=function(n){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,se.integerToDer(0).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(cn.oids.rsaEncryption).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,"")]),se.create(se.Class.UNIVERSAL,se.Type.OCTETSTRING,!1,se.toDer(n).getBytes())])};cn.privateKeyFromAsn1=function(n){var e={},t=[];if(se.validate(n,Nat,e,t)&&(n=se.fromDer(Lt.util.createBuffer(e.privateKey))),e={},t=[],!se.validate(n,Lat,e,t)){var r=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw r.errors=t,r}var o,s,a,c,l,u,d,p;return o=Lt.util.createBuffer(e.privateKeyModulus).toHex(),s=Lt.util.createBuffer(e.privateKeyPublicExponent).toHex(),a=Lt.util.createBuffer(e.privateKeyPrivateExponent).toHex(),c=Lt.util.createBuffer(e.privateKeyPrime1).toHex(),l=Lt.util.createBuffer(e.privateKeyPrime2).toHex(),u=Lt.util.createBuffer(e.privateKeyExponent1).toHex(),d=Lt.util.createBuffer(e.privateKeyExponent2).toHex(),p=Lt.util.createBuffer(e.privateKeyCoefficient).toHex(),cn.setRsaPrivateKey(new Jn(o,16),new Jn(s,16),new Jn(a,16),new Jn(c,16),new Jn(l,16),new Jn(u,16),new Jn(d,16),new Jn(p,16))};cn.privateKeyToAsn1=cn.privateKeyToRSAPrivateKey=function(n){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,se.integerToDer(0).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,Nf(n.n)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,Nf(n.e)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,Nf(n.d)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,Nf(n.p)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,Nf(n.q)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,Nf(n.dP)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,Nf(n.dQ)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,Nf(n.qInv))])};cn.publicKeyFromAsn1=function(n){var e={},t=[];if(se.validate(n,Mat,e,t)){var r=se.derToOid(e.publicKeyOid);if(r!==cn.oids.rsaEncryption){var o=new Error("Cannot read public key. Unknown OID.");throw o.oid=r,o}n=e.rsaPublicKey}if(t=[],!se.validate(n,Oat,e,t)){var o=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw o.errors=t,o}var s=Lt.util.createBuffer(e.publicKeyModulus).toHex(),a=Lt.util.createBuffer(e.publicKeyExponent).toHex();return cn.setRsaPublicKey(new Jn(s,16),new Jn(a,16))};cn.publicKeyToAsn1=cn.publicKeyToSubjectPublicKeyInfo=function(n){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(cn.oids.rsaEncryption).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,"")]),se.create(se.Class.UNIVERSAL,se.Type.BITSTRING,!1,[cn.publicKeyToRSAPublicKey(n)])])};cn.publicKeyToRSAPublicKey=function(n){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,Nf(n.n)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,Nf(n.e))])};function rEe(n,e,t){var r=Lt.util.createBuffer(),o=Math.ceil(e.n.bitLength()/8);if(n.length>o-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=n.length,s.max=o-11,s}r.putByte(0),r.putByte(t);var a=o-3-n.length,c;if(t===0||t===1){c=t===0?0:255;for(var l=0;l<a;++l)r.putByte(c)}else for(;a>0;){for(var u=0,d=Lt.random.getBytes(a),l=0;l<a;++l)c=d.charCodeAt(l),c===0?++u:r.putByte(c);a=u}return r.putByte(0),r.putBytes(n),r}function B7(n,e,t,r){var o=Math.ceil(e.n.bitLength()/8),s=Lt.util.createBuffer(n),a=s.getByte(),c=s.getByte();if(a!==0||t&&c!==0&&c!==1||!t&&c!=2||t&&c===0&&typeof r>"u")throw new Error("Encryption block is invalid.");var l=0;if(c===0){l=o-3-r;for(var u=0;u<l;++u)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(c===1)for(l=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++l}else if(c===2)for(l=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++l}var d=s.getByte();if(d!==0||l!==o-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function Bat(n,e,t){typeof e=="function"&&(t=e,e={}),e=e||{};var r={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(r.prng=e.prng),o();function o(){s(n.pBits,function(c,l){if(c)return t(c);if(n.p=l,n.q!==null)return a(c,n.q);s(n.qBits,a)})}function s(c,l){Lt.prime.generateProbablePrime(c,r,l)}function a(c,l){if(c)return t(c);if(n.q=l,n.p.compareTo(n.q)<0){var u=n.p;n.p=n.q,n.q=u}if(n.p.subtract(Jn.ONE).gcd(n.e).compareTo(Jn.ONE)!==0){n.p=null,o();return}if(n.q.subtract(Jn.ONE).gcd(n.e).compareTo(Jn.ONE)!==0){n.q=null,s(n.qBits,a);return}if(n.p1=n.p.subtract(Jn.ONE),n.q1=n.q.subtract(Jn.ONE),n.phi=n.p1.multiply(n.q1),n.phi.gcd(n.e).compareTo(Jn.ONE)!==0){n.p=n.q=null,o();return}if(n.n=n.p.multiply(n.q),n.n.bitLength()!==n.bits){n.q=null,s(n.qBits,a);return}var d=n.e.modInverse(n.phi);n.keys={privateKey:cn.rsa.setPrivateKey(n.n,n.e,d,n.p,n.q,d.mod(n.p1),d.mod(n.q1),n.q.modInverse(n.p)),publicKey:cn.rsa.setPublicKey(n.n,n.e)},t(null,n.keys)}}function Nf(n){var e=n.toString(16);e[0]>="8"&&(e="00"+e);var t=Lt.util.hexToBytes(e);return t.length>1&&(t.charCodeAt(0)===0&&!(t.charCodeAt(1)&128)||t.charCodeAt(0)===255&&(t.charCodeAt(1)&128)===128)?t.substr(1):t}function qat(n){return n<=100?27:n<=150?18:n<=200?15:n<=250?12:n<=300?9:n<=350?8:n<=400?7:n<=500?6:n<=600?5:n<=800?4:n<=1250?3:2}function JCe(n){return Lt.util.isNodejs&&typeof rne[n]=="function"}function ZCe(n){return typeof Cu.globalScope<"u"&&typeof Cu.globalScope.crypto=="object"&&typeof Cu.globalScope.crypto.subtle=="object"&&typeof Cu.globalScope.crypto.subtle[n]=="function"}function eEe(n){return typeof Cu.globalScope<"u"&&typeof Cu.globalScope.msCrypto=="object"&&typeof Cu.globalScope.msCrypto.subtle=="object"&&typeof Cu.globalScope.msCrypto.subtle[n]=="function"}function tEe(n){for(var e=Lt.util.hexToBytes(n.toString(16)),t=new Uint8Array(e.length),r=0;r<e.length;++r)t[r]=e.charCodeAt(r);return t}});var ine=P((bRn,lEe)=>{var pt=In();vy();Qd();KL();Ef();yy();L7();nS();Iu();Yte();XL();rr();typeof oEe>"u"&&(oEe=pt.jsbn.BigInteger);var oEe,he=pt.asn1,bn=pt.pki=pt.pki||{};lEe.exports=bn.pbe=pt.pbe=pt.pbe||{};var oS=bn.oids,jat={name:"EncryptedPrivateKeyInfo",tagClass:he.Class.UNIVERSAL,type:he.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:he.Class.UNIVERSAL,type:he.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:he.Class.UNIVERSAL,type:he.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:he.Class.UNIVERSAL,type:he.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:he.Class.UNIVERSAL,type:he.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Hat={name:"PBES2Algorithms",tagClass:he.Class.UNIVERSAL,type:he.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:he.Class.UNIVERSAL,type:he.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:he.Class.UNIVERSAL,type:he.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:he.Class.UNIVERSAL,type:he.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:he.Class.UNIVERSAL,type:he.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:he.Class.UNIVERSAL,type:he.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:he.Class.UNIVERSAL,type:he.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:he.Class.UNIVERSAL,type:he.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:he.Class.UNIVERSAL,type:he.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:he.Class.UNIVERSAL,type:he.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:he.Class.UNIVERSAL,type:he.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:he.Class.UNIVERSAL,type:he.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Vat={name:"pkcs-12PbeParams",tagClass:he.Class.UNIVERSAL,type:he.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:he.Class.UNIVERSAL,type:he.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:he.Class.UNIVERSAL,type:he.Type.INTEGER,constructed:!1,capture:"iterations"}]};bn.encryptPrivateKeyInfo=function(n,e,t){t=t||{},t.saltSize=t.saltSize||8,t.count=t.count||2048,t.algorithm=t.algorithm||"aes128",t.prfAlgorithm=t.prfAlgorithm||"sha1";var r=pt.random.getBytesSync(t.saltSize),o=t.count,s=he.integerToDer(o),a,c,l;if(t.algorithm.indexOf("aes")===0||t.algorithm==="des"){var u,d,p;switch(t.algorithm){case"aes128":a=16,u=16,d=oS["aes128-CBC"],p=pt.aes.createEncryptionCipher;break;case"aes192":a=24,u=16,d=oS["aes192-CBC"],p=pt.aes.createEncryptionCipher;break;case"aes256":a=32,u=16,d=oS["aes256-CBC"],p=pt.aes.createEncryptionCipher;break;case"des":a=8,u=8,d=oS.desCBC,p=pt.des.createEncryptionCipher;break;default:var f=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw f.algorithm=t.algorithm,f}var m="hmacWith"+t.prfAlgorithm.toUpperCase(),h=cEe(m),g=pt.pkcs5.pbkdf2(e,r,o,a,h),y=pt.random.getBytesSync(u),b=p(g);b.start(y),b.update(he.toDer(n)),b.finish(),l=b.output.getBytes();var _=Gat(r,s,a,m);c=he.create(he.Class.UNIVERSAL,he.Type.SEQUENCE,!0,[he.create(he.Class.UNIVERSAL,he.Type.OID,!1,he.oidToDer(oS.pkcs5PBES2).getBytes()),he.create(he.Class.UNIVERSAL,he.Type.SEQUENCE,!0,[he.create(he.Class.UNIVERSAL,he.Type.SEQUENCE,!0,[he.create(he.Class.UNIVERSAL,he.Type.OID,!1,he.oidToDer(oS.pkcs5PBKDF2).getBytes()),_]),he.create(he.Class.UNIVERSAL,he.Type.SEQUENCE,!0,[he.create(he.Class.UNIVERSAL,he.Type.OID,!1,he.oidToDer(d).getBytes()),he.create(he.Class.UNIVERSAL,he.Type.OCTETSTRING,!1,y)])])])}else if(t.algorithm==="3des"){a=24;var x=new pt.util.ByteBuffer(r),g=bn.pbe.generatePkcs12Key(e,x,1,o,a),y=bn.pbe.generatePkcs12Key(e,x,2,o,a),b=pt.des.createEncryptionCipher(g);b.start(y),b.update(he.toDer(n)),b.finish(),l=b.output.getBytes(),c=he.create(he.Class.UNIVERSAL,he.Type.SEQUENCE,!0,[he.create(he.Class.UNIVERSAL,he.Type.OID,!1,he.oidToDer(oS["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),he.create(he.Class.UNIVERSAL,he.Type.SEQUENCE,!0,[he.create(he.Class.UNIVERSAL,he.Type.OCTETSTRING,!1,r),he.create(he.Class.UNIVERSAL,he.Type.INTEGER,!1,s.getBytes())])])}else{var f=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw f.algorithm=t.algorithm,f}var I=he.create(he.Class.UNIVERSAL,he.Type.SEQUENCE,!0,[c,he.create(he.Class.UNIVERSAL,he.Type.OCTETSTRING,!1,l)]);return I};bn.decryptPrivateKeyInfo=function(n,e){var t=null,r={},o=[];if(!he.validate(n,jat,r,o)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=o,s}var a=he.derToOid(r.encryptionOid),c=bn.pbe.getCipher(a,r.encryptionParams,e),l=pt.util.createBuffer(r.encryptedData);return c.update(l),c.finish()&&(t=he.fromDer(c.output)),t};bn.encryptedPrivateKeyToPem=function(n,e){var t={type:"ENCRYPTED PRIVATE KEY",body:he.toDer(n).getBytes()};return pt.pem.encode(t,{maxline:e})};bn.encryptedPrivateKeyFromPem=function(n){var e=pt.pem.decode(n)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var t=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw t.headerType=e.type,t}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return he.fromDer(e.body)};bn.encryptRsaPrivateKey=function(n,e,t){if(t=t||{},!t.legacy){var r=bn.wrapRsaPrivateKey(bn.privateKeyToAsn1(n));return r=bn.encryptPrivateKeyInfo(r,e,t),bn.encryptedPrivateKeyToPem(r)}var o,s,a,c;switch(t.algorithm){case"aes128":o="AES-128-CBC",a=16,s=pt.random.getBytesSync(16),c=pt.aes.createEncryptionCipher;break;case"aes192":o="AES-192-CBC",a=24,s=pt.random.getBytesSync(16),c=pt.aes.createEncryptionCipher;break;case"aes256":o="AES-256-CBC",a=32,s=pt.random.getBytesSync(16),c=pt.aes.createEncryptionCipher;break;case"3des":o="DES-EDE3-CBC",a=24,s=pt.random.getBytesSync(8),c=pt.des.createEncryptionCipher;break;case"des":o="DES-CBC",a=8,s=pt.random.getBytesSync(8),c=pt.des.createEncryptionCipher;break;default:var l=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+t.algorithm+'".');throw l.algorithm=t.algorithm,l}var u=pt.pbe.opensslDeriveBytes(e,s.substr(0,8),a),d=c(u);d.start(s),d.update(he.toDer(bn.privateKeyToAsn1(n))),d.finish();var p={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:o,parameters:pt.util.bytesToHex(s).toUpperCase()},body:d.output.getBytes()};return pt.pem.encode(p)};bn.decryptRsaPrivateKey=function(n,e){var t=null,r=pt.pem.decode(n)[0];if(r.type!=="ENCRYPTED PRIVATE KEY"&&r.type!=="PRIVATE KEY"&&r.type!=="RSA PRIVATE KEY"){var o=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw o.headerType=o,o}if(r.procType&&r.procType.type==="ENCRYPTED"){var s,a;switch(r.dekInfo.algorithm){case"DES-CBC":s=8,a=pt.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,a=pt.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,a=pt.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,a=pt.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,a=pt.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,a=function(p){return pt.rc2.createDecryptionCipher(p,40)};break;case"RC2-64-CBC":s=8,a=function(p){return pt.rc2.createDecryptionCipher(p,64)};break;case"RC2-128-CBC":s=16,a=function(p){return pt.rc2.createDecryptionCipher(p,128)};break;default:var o=new Error('Could not decrypt private key; unsupported encryption algorithm "'+r.dekInfo.algorithm+'".');throw o.algorithm=r.dekInfo.algorithm,o}var c=pt.util.hexToBytes(r.dekInfo.parameters),l=pt.pbe.opensslDeriveBytes(e,c.substr(0,8),s),u=a(l);if(u.start(c),u.update(pt.util.createBuffer(r.body)),u.finish())t=u.output.getBytes();else return t}else t=r.body;return r.type==="ENCRYPTED PRIVATE KEY"?t=bn.decryptPrivateKeyInfo(he.fromDer(t),e):t=he.fromDer(t),t!==null&&(t=bn.privateKeyFromAsn1(t)),t};bn.pbe.generatePkcs12Key=function(n,e,t,r,o,s){var a,c;if(typeof s>"u"||s===null){if(!("sha1"in pt.md))throw new Error('"sha1" hash algorithm unavailable.');s=pt.md.sha1.create()}var l=s.digestLength,u=s.blockLength,d=new pt.util.ByteBuffer,p=new pt.util.ByteBuffer;if(n!=null){for(c=0;c<n.length;c++)p.putInt16(n.charCodeAt(c));p.putInt16(0)}var f=p.length(),m=e.length(),h=new pt.util.ByteBuffer;h.fillWithByte(t,u);var g=u*Math.ceil(m/u),y=new pt.util.ByteBuffer;for(c=0;c<g;c++)y.putByte(e.at(c%m));var b=u*Math.ceil(f/u),_=new pt.util.ByteBuffer;for(c=0;c<b;c++)_.putByte(p.at(c%f));var x=y;x.putBuffer(_);for(var I=Math.ceil(o/l),S=1;S<=I;S++){var w=new pt.util.ByteBuffer;w.putBytes(h.bytes()),w.putBytes(x.bytes());for(var R=0;R<r;R++)s.start(),s.update(w.getBytes()),w=s.digest();var k=new pt.util.ByteBuffer;for(c=0;c<u;c++)k.putByte(w.at(c%l));var V=Math.ceil(m/u)+Math.ceil(f/u),F=new pt.util.ByteBuffer;for(a=0;a<V;a++){var K=new pt.util.ByteBuffer(x.getBytes(u)),$=511;for(c=k.length()-1;c>=0;c--)$=$>>8,$+=k.at(c)+K.at(c),K.setAt(c,$&255);F.putBuffer(K)}x=F,d.putBuffer(w)}return d.truncate(d.length()-o),d};bn.pbe.getCipher=function(n,e,t){switch(n){case bn.oids.pkcs5PBES2:return bn.pbe.getCipherForPBES2(n,e,t);case bn.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case bn.oids["pbewithSHAAnd40BitRC2-CBC"]:return bn.pbe.getCipherForPKCS12PBE(n,e,t);default:var r=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw r.oid=n,r.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],r}};bn.pbe.getCipherForPBES2=function(n,e,t){var r={},o=[];if(!he.validate(e,Hat,r,o)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=o,s}if(n=he.derToOid(r.kdfOid),n!==bn.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=n,s.supportedOids=["pkcs5PBKDF2"],s}if(n=he.derToOid(r.encOid),n!==bn.oids["aes128-CBC"]&&n!==bn.oids["aes192-CBC"]&&n!==bn.oids["aes256-CBC"]&&n!==bn.oids["des-EDE3-CBC"]&&n!==bn.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=n,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var a=r.kdfSalt,c=pt.util.createBuffer(r.kdfIterationCount);c=c.getInt(c.length()<<3);var l,u;switch(bn.oids[n]){case"aes128-CBC":l=16,u=pt.aes.createDecryptionCipher;break;case"aes192-CBC":l=24,u=pt.aes.createDecryptionCipher;break;case"aes256-CBC":l=32,u=pt.aes.createDecryptionCipher;break;case"des-EDE3-CBC":l=24,u=pt.des.createDecryptionCipher;break;case"desCBC":l=8,u=pt.des.createDecryptionCipher;break}var d=aEe(r.prfOid),p=pt.pkcs5.pbkdf2(t,a,c,l,d),f=r.encIv,m=u(p);return m.start(f),m};bn.pbe.getCipherForPKCS12PBE=function(n,e,t){var r={},o=[];if(!he.validate(e,Vat,r,o)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=o,s}var a=pt.util.createBuffer(r.salt),c=pt.util.createBuffer(r.iterations);c=c.getInt(c.length()<<3);var l,u,d;switch(n){case bn.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:l=24,u=8,d=pt.des.startDecrypting;break;case bn.oids["pbewithSHAAnd40BitRC2-CBC"]:l=5,u=8,d=function(g,y){var b=pt.rc2.createDecryptionCipher(g,40);return b.start(y,null),b};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=n,s}var p=aEe(r.prfOid),f=bn.pbe.generatePkcs12Key(t,a,1,c,l,p);p.start();var m=bn.pbe.generatePkcs12Key(t,a,2,c,u,p);return d(f,m)};bn.pbe.opensslDeriveBytes=function(n,e,t,r){if(typeof r>"u"||r===null){if(!("md5"in pt.md))throw new Error('"md5" hash algorithm unavailable.');r=pt.md.md5.create()}e===null&&(e="");for(var o=[sEe(r,n+e)],s=16,a=1;s<t;++a,s+=16)o.push(sEe(r,o[a-1]+n+e));return o.join("").substr(0,t)};function sEe(n,e){return n.start().update(e).digest().getBytes()}function aEe(n){var e;if(!n)e="hmacWithSHA1";else if(e=bn.oids[he.derToOid(n)],!e){var t=new Error("Unsupported PRF OID.");throw t.oid=n,t.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],t}return cEe(e)}function cEe(n){var e=pt.md;switch(n){case"hmacWithSHA224":e=pt.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":n=n.substr(8).toLowerCase();break;default:var t=new Error("Unsupported PRF algorithm.");throw t.algorithm=n,t.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],t}if(!e||!(n in e))throw new Error("Unknown hash algorithm: "+n);return e[n].create()}function Gat(n,e,t,r){var o=he.create(he.Class.UNIVERSAL,he.Type.SEQUENCE,!0,[he.create(he.Class.UNIVERSAL,he.Type.OCTETSTRING,!1,n),he.create(he.Class.UNIVERSAL,he.Type.INTEGER,!1,e.getBytes())]);return r!=="hmacWithSHA1"&&o.value.push(he.create(he.Class.UNIVERSAL,he.Type.INTEGER,!1,pt.util.hexToBytes(t.toString(16))),he.create(he.Class.UNIVERSAL,he.Type.SEQUENCE,!0,[he.create(he.Class.UNIVERSAL,he.Type.OID,!1,he.oidToDer(bn.oids[r]).getBytes()),he.create(he.Class.UNIVERSAL,he.Type.NULL,!1,"")])),o}});var one=P((_Rn,pEe)=>{var hw=In();Qd();rr();var st=hw.asn1,gw=pEe.exports=hw.pkcs7asn1=hw.pkcs7asn1||{};hw.pkcs7=hw.pkcs7||{};hw.pkcs7.asn1=gw;var uEe={name:"ContentInfo",tagClass:st.Class.UNIVERSAL,type:st.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:st.Class.UNIVERSAL,type:st.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:st.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};gw.contentInfoValidator=uEe;var dEe={name:"EncryptedContentInfo",tagClass:st.Class.UNIVERSAL,type:st.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:st.Class.UNIVERSAL,type:st.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:st.Class.UNIVERSAL,type:st.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:st.Class.UNIVERSAL,type:st.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:st.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:st.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};gw.envelopedDataValidator={name:"EnvelopedData",tagClass:st.Class.UNIVERSAL,type:st.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:st.Class.UNIVERSAL,type:st.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:st.Class.UNIVERSAL,type:st.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(dEe)};gw.encryptedDataValidator={name:"EncryptedData",tagClass:st.Class.UNIVERSAL,type:st.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:st.Class.UNIVERSAL,type:st.Type.INTEGER,constructed:!1,capture:"version"}].concat(dEe)};var zat={name:"SignerInfo",tagClass:st.Class.UNIVERSAL,type:st.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:st.Class.UNIVERSAL,type:st.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:st.Class.UNIVERSAL,type:st.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:st.Class.UNIVERSAL,type:st.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:st.Class.UNIVERSAL,type:st.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:st.Class.UNIVERSAL,type:st.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:st.Class.UNIVERSAL,type:st.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:st.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:st.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:st.Class.UNIVERSAL,type:st.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:st.Class.UNIVERSAL,type:st.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:st.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};gw.signedDataValidator={name:"SignedData",tagClass:st.Class.UNIVERSAL,type:st.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:st.Class.UNIVERSAL,type:st.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:st.Class.UNIVERSAL,type:st.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},uEe,{name:"SignedData.Certificates",tagClass:st.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:st.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:st.Class.UNIVERSAL,type:st.Type.SET,capture:"signerInfos",optional:!0,value:[zat]}]};gw.recipientInfoValidator={name:"RecipientInfo",tagClass:st.Class.UNIVERSAL,type:st.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:st.Class.UNIVERSAL,type:st.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:st.Class.UNIVERSAL,type:st.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:st.Class.UNIVERSAL,type:st.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:st.Class.UNIVERSAL,type:st.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:st.Class.UNIVERSAL,type:st.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:st.Class.UNIVERSAL,type:st.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:st.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:st.Class.UNIVERSAL,type:st.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}});var sne=P((xRn,fEe)=>{var sS=In();rr();sS.mgf=sS.mgf||{};var $at=fEe.exports=sS.mgf.mgf1=sS.mgf1=sS.mgf1||{};$at.create=function(n){var e={generate:function(t,r){for(var o=new sS.util.ByteBuffer,s=Math.ceil(r/n.digestLength),a=0;a<s;a++){var c=new sS.util.ByteBuffer;c.putInt32(a),n.start(),n.update(t+c.getBytes()),o.putBuffer(n.digest())}return o.truncate(o.length()-r),o.getBytes()}};return e}});var hEe=P((SRn,mEe)=>{var q7=In();sne();mEe.exports=q7.mgf=q7.mgf||{};q7.mgf.mgf1=q7.mgf1});var j7=P((IRn,gEe)=>{var aS=In();Iu();rr();var Wat=gEe.exports=aS.pss=aS.pss||{};Wat.create=function(n){arguments.length===3&&(n={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var e=n.md,t=n.mgf,r=e.digestLength,o=n.salt||null;typeof o=="string"&&(o=aS.util.createBuffer(o));var s;if("saltLength"in n)s=n.saltLength;else if(o!==null)s=o.length();else throw new Error("Salt length not specified or specific salt not given.");if(o!==null&&o.length()!==s)throw new Error("Given salt length does not match length of given salt.");var a=n.prng||aS.random,c={};return c.encode=function(l,u){var d,p=u-1,f=Math.ceil(p/8),m=l.digest().getBytes();if(f<r+s+2)throw new Error("Message is too long to encrypt.");var h;o===null?h=a.getBytesSync(s):h=o.bytes();var g=new aS.util.ByteBuffer;g.fillWithByte(0,8),g.putBytes(m),g.putBytes(h),e.start(),e.update(g.getBytes());var y=e.digest().getBytes(),b=new aS.util.ByteBuffer;b.fillWithByte(0,f-s-r-2),b.putByte(1),b.putBytes(h);var _=b.getBytes(),x=f-r-1,I=t.generate(y,x),S="";for(d=0;d<x;d++)S+=String.fromCharCode(_.charCodeAt(d)^I.charCodeAt(d));var w=65280>>8*f-p&255;return S=String.fromCharCode(S.charCodeAt(0)&~w)+S.substr(1),S+y+"\xBC"},c.verify=function(l,u,d){var p,f=d-1,m=Math.ceil(f/8);if(u=u.substr(-m),m<r+s+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(u.charCodeAt(m-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var h=m-r-1,g=u.substr(0,h),y=u.substr(h,r),b=65280>>8*m-f&255;if(g.charCodeAt(0)&b)throw new Error("Bits beyond keysize not zero as expected.");var _=t.generate(y,h),x="";for(p=0;p<h;p++)x+=String.fromCharCode(g.charCodeAt(p)^_.charCodeAt(p));x=String.fromCharCode(x.charCodeAt(0)&~b)+x.substr(1);var I=m-r-s-2;for(p=0;p<I;p++)if(x.charCodeAt(p)!==0)throw new Error("Leftmost octets not zero as expected");if(x.charCodeAt(I)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var S=x.substr(-s),w=new aS.util.ByteBuffer;w.fillWithByte(0,8),w.putBytes(l),w.putBytes(S),e.start(),e.update(w.getBytes());var R=e.digest().getBytes();return y===R},c}});var G7=P((TRn,xEe)=>{var Ot=In();vy();Qd();KL();Ef();hEe();yy();nS();j7();XL();rr();var L=Ot.asn1,Ke=xEe.exports=Ot.pki=Ot.pki||{},Zn=Ke.oids,eo={};eo.CN=Zn.commonName;eo.commonName="CN";eo.C=Zn.countryName;eo.countryName="C";eo.L=Zn.localityName;eo.localityName="L";eo.ST=Zn.stateOrProvinceName;eo.stateOrProvinceName="ST";eo.O=Zn.organizationName;eo.organizationName="O";eo.OU=Zn.organizationalUnitName;eo.organizationalUnitName="OU";eo.E=Zn.emailAddress;eo.emailAddress="E";var yEe=Ot.pki.rsa.publicKeyValidator,Kat={name:"Certificate",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:L.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:L.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:L.Class.UNIVERSAL,type:L.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:L.Class.UNIVERSAL,type:L.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:L.Class.UNIVERSAL,type:L.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:L.Class.UNIVERSAL,type:L.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},yEe,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:L.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:L.Class.UNIVERSAL,type:L.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:L.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:L.Class.UNIVERSAL,type:L.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:L.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:L.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:L.Class.UNIVERSAL,type:L.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},Yat={name:"rsapss",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:L.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:L.Class.UNIVERSAL,type:L.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:L.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:L.Class.UNIVERSAL,type:L.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:L.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:L.Class.UNIVERSAL,type:L.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:L.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:L.Class.UNIVERSAL,type:L.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},Qat={name:"CertificationRequestInfo",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},yEe,{name:"CertificationRequestInfo.attributes",tagClass:L.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:L.Class.UNIVERSAL,type:L.Type.SET,constructed:!0}]}]}]},Xat={name:"CertificationRequest",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[Qat,{name:"CertificationRequest.signatureAlgorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:L.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:L.Class.UNIVERSAL,type:L.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};Ke.RDNAttributesAsArray=function(n,e){for(var t=[],r,o,s,a=0;a<n.value.length;++a){r=n.value[a];for(var c=0;c<r.value.length;++c)s={},o=r.value[c],s.type=L.derToOid(o.value[0].value),s.value=o.value[1].value,s.valueTagClass=o.value[1].type,s.type in Zn&&(s.name=Zn[s.type],s.name in eo&&(s.shortName=eo[s.name])),e&&(e.update(s.type),e.update(s.value)),t.push(s)}return t};Ke.CRIAttributesAsArray=function(n){for(var e=[],t=0;t<n.length;++t)for(var r=n[t],o=L.derToOid(r.value[0].value),s=r.value[1].value,a=0;a<s.length;++a){var c={};if(c.type=o,c.value=s[a].value,c.valueTagClass=s[a].type,c.type in Zn&&(c.name=Zn[c.type],c.name in eo&&(c.shortName=eo[c.name])),c.type===Zn.extensionRequest){c.extensions=[];for(var l=0;l<c.value.length;++l)c.extensions.push(Ke.certificateExtensionFromAsn1(c.value[l]))}e.push(c)}return e};function xy(n,e){typeof e=="string"&&(e={shortName:e});for(var t=null,r,o=0;t===null&&o<n.attributes.length;++o)r=n.attributes[o],(e.type&&e.type===r.type||e.name&&e.name===r.name||e.shortName&&e.shortName===r.shortName)&&(t=r);return t}var H7=function(n,e,t){var r={};if(n!==Zn["RSASSA-PSS"])return r;t&&(r={hash:{algorithmOid:Zn.sha1},mgf:{algorithmOid:Zn.mgf1,hash:{algorithmOid:Zn.sha1}},saltLength:20});var o={},s=[];if(!L.validate(e,Yat,o,s)){var a=new Error("Cannot read RSASSA-PSS parameter block.");throw a.errors=s,a}return o.hashOid!==void 0&&(r.hash=r.hash||{},r.hash.algorithmOid=L.derToOid(o.hashOid)),o.maskGenOid!==void 0&&(r.mgf=r.mgf||{},r.mgf.algorithmOid=L.derToOid(o.maskGenOid),r.mgf.hash=r.mgf.hash||{},r.mgf.hash.algorithmOid=L.derToOid(o.maskGenHashOid)),o.saltLength!==void 0&&(r.saltLength=o.saltLength.charCodeAt(0)),r},V7=function(n){switch(Zn[n.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return Ot.md.sha1.create();case"md5WithRSAEncryption":return Ot.md.md5.create();case"sha256WithRSAEncryption":return Ot.md.sha256.create();case"sha384WithRSAEncryption":return Ot.md.sha384.create();case"sha512WithRSAEncryption":return Ot.md.sha512.create();case"RSASSA-PSS":return Ot.md.sha256.create();default:var e=new Error("Could not compute "+n.type+" digest. Unknown signature OID.");throw e.signatureOid=n.signatureOid,e}},bEe=function(n){var e=n.certificate,t;switch(e.signatureOid){case Zn.sha1WithRSAEncryption:case Zn.sha1WithRSASignature:break;case Zn["RSASSA-PSS"]:var r,o;if(r=Zn[e.signatureParameters.mgf.hash.algorithmOid],r===void 0||Ot.md[r]===void 0){var s=new Error("Unsupported MGF hash function.");throw s.oid=e.signatureParameters.mgf.hash.algorithmOid,s.name=r,s}if(o=Zn[e.signatureParameters.mgf.algorithmOid],o===void 0||Ot.mgf[o]===void 0){var s=new Error("Unsupported MGF function.");throw s.oid=e.signatureParameters.mgf.algorithmOid,s.name=o,s}if(o=Ot.mgf[o].create(Ot.md[r].create()),r=Zn[e.signatureParameters.hash.algorithmOid],r===void 0||Ot.md[r]===void 0){var s=new Error("Unsupported RSASSA-PSS hash function.");throw s.oid=e.signatureParameters.hash.algorithmOid,s.name=r,s}t=Ot.pss.create(Ot.md[r].create(),o,e.signatureParameters.saltLength);break}return e.publicKey.verify(n.md.digest().getBytes(),n.signature,t)};Ke.certificateFromPem=function(n,e,t){var r=Ot.pem.decode(n)[0];if(r.type!=="CERTIFICATE"&&r.type!=="X509 CERTIFICATE"&&r.type!=="TRUSTED CERTIFICATE"){var o=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw o.headerType=r.type,o}if(r.procType&&r.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var s=L.fromDer(r.body,t);return Ke.certificateFromAsn1(s,e)};Ke.certificateToPem=function(n,e){var t={type:"CERTIFICATE",body:L.toDer(Ke.certificateToAsn1(n)).getBytes()};return Ot.pem.encode(t,{maxline:e})};Ke.publicKeyFromPem=function(n){var e=Ot.pem.decode(n)[0];if(e.type!=="PUBLIC KEY"&&e.type!=="RSA PUBLIC KEY"){var t=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw t.headerType=e.type,t}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var r=L.fromDer(e.body);return Ke.publicKeyFromAsn1(r)};Ke.publicKeyToPem=function(n,e){var t={type:"PUBLIC KEY",body:L.toDer(Ke.publicKeyToAsn1(n)).getBytes()};return Ot.pem.encode(t,{maxline:e})};Ke.publicKeyToRSAPublicKeyPem=function(n,e){var t={type:"RSA PUBLIC KEY",body:L.toDer(Ke.publicKeyToRSAPublicKey(n)).getBytes()};return Ot.pem.encode(t,{maxline:e})};Ke.getPublicKeyFingerprint=function(n,e){e=e||{};var t=e.md||Ot.md.sha1.create(),r=e.type||"RSAPublicKey",o;switch(r){case"RSAPublicKey":o=L.toDer(Ke.publicKeyToRSAPublicKey(n)).getBytes();break;case"SubjectPublicKeyInfo":o=L.toDer(Ke.publicKeyToAsn1(n)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+e.type+'".')}t.start(),t.update(o);var s=t.digest();if(e.encoding==="hex"){var a=s.toHex();return e.delimiter?a.match(/.{2}/g).join(e.delimiter):a}else{if(e.encoding==="binary")return s.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return s};Ke.certificationRequestFromPem=function(n,e,t){var r=Ot.pem.decode(n)[0];if(r.type!=="CERTIFICATE REQUEST"){var o=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw o.headerType=r.type,o}if(r.procType&&r.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var s=L.fromDer(r.body,t);return Ke.certificationRequestFromAsn1(s,e)};Ke.certificationRequestToPem=function(n,e){var t={type:"CERTIFICATE REQUEST",body:L.toDer(Ke.certificationRequestToAsn1(n)).getBytes()};return Ot.pem.encode(t,{maxline:e})};Ke.createCertificate=function(){var n={};return n.version=2,n.serialNumber="00",n.signatureOid=null,n.signature=null,n.siginfo={},n.siginfo.algorithmOid=null,n.validity={},n.validity.notBefore=new Date,n.validity.notAfter=new Date,n.issuer={},n.issuer.getField=function(e){return xy(n.issuer,e)},n.issuer.addField=function(e){Eu([e]),n.issuer.attributes.push(e)},n.issuer.attributes=[],n.issuer.hash=null,n.subject={},n.subject.getField=function(e){return xy(n.subject,e)},n.subject.addField=function(e){Eu([e]),n.subject.attributes.push(e)},n.subject.attributes=[],n.subject.hash=null,n.extensions=[],n.publicKey=null,n.md=null,n.setSubject=function(e,t){Eu(e),n.subject.attributes=e,delete n.subject.uniqueId,t&&(n.subject.uniqueId=t),n.subject.hash=null},n.setIssuer=function(e,t){Eu(e),n.issuer.attributes=e,delete n.issuer.uniqueId,t&&(n.issuer.uniqueId=t),n.issuer.hash=null},n.setExtensions=function(e){for(var t=0;t<e.length;++t)_Ee(e[t],{cert:n});n.extensions=e},n.getExtension=function(e){typeof e=="string"&&(e={name:e});for(var t=null,r,o=0;t===null&&o<n.extensions.length;++o)r=n.extensions[o],(e.id&&r.id===e.id||e.name&&r.name===e.name)&&(t=r);return t},n.sign=function(e,t){n.md=t||Ot.md.sha1.create();var r=Zn[n.md.algorithm+"WithRSAEncryption"];if(!r){var o=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw o.algorithm=n.md.algorithm,o}n.signatureOid=n.siginfo.algorithmOid=r,n.tbsCertificate=Ke.getTBSCertificate(n);var s=L.toDer(n.tbsCertificate);n.md.update(s.getBytes()),n.signature=e.sign(n.md)},n.verify=function(e){var t=!1;if(!n.issued(e)){var r=e.issuer,o=n.subject,s=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw s.expectedIssuer=o.attributes,s.actualIssuer=r.attributes,s}var a=e.md;if(a===null){a=V7({signatureOid:e.signatureOid,type:"certificate"});var c=e.tbsCertificate||Ke.getTBSCertificate(e),l=L.toDer(c);a.update(l.getBytes())}return a!==null&&(t=bEe({certificate:n,md:a,signature:e.signature})),t},n.isIssuer=function(e){var t=!1,r=n.issuer,o=e.subject;if(r.hash&&o.hash)t=r.hash===o.hash;else if(r.attributes.length===o.attributes.length){t=!0;for(var s,a,c=0;t&&c<r.attributes.length;++c)s=r.attributes[c],a=o.attributes[c],(s.type!==a.type||s.value!==a.value)&&(t=!1)}return t},n.issued=function(e){return e.isIssuer(n)},n.generateSubjectKeyIdentifier=function(){return Ke.getPublicKeyFingerprint(n.publicKey,{type:"RSAPublicKey"})},n.verifySubjectKeyIdentifier=function(){for(var e=Zn.subjectKeyIdentifier,t=0;t<n.extensions.length;++t){var r=n.extensions[t];if(r.id===e){var o=n.generateSubjectKeyIdentifier().getBytes();return Ot.util.hexToBytes(r.subjectKeyIdentifier)===o}}return!1},n};Ke.certificateFromAsn1=function(n,e){var t={},r=[];if(!L.validate(n,Kat,t,r)){var o=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw o.errors=r,o}var s=L.derToOid(t.publicKeyOid);if(s!==Ke.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var a=Ke.createCertificate();a.version=t.certVersion?t.certVersion.charCodeAt(0):0;var c=Ot.util.createBuffer(t.certSerialNumber);a.serialNumber=c.toHex(),a.signatureOid=Ot.asn1.derToOid(t.certSignatureOid),a.signatureParameters=H7(a.signatureOid,t.certSignatureParams,!0),a.siginfo.algorithmOid=Ot.asn1.derToOid(t.certinfoSignatureOid),a.siginfo.parameters=H7(a.siginfo.algorithmOid,t.certinfoSignatureParams,!1),a.signature=t.certSignature;var l=[];if(t.certValidity1UTCTime!==void 0&&l.push(L.utcTimeToDate(t.certValidity1UTCTime)),t.certValidity2GeneralizedTime!==void 0&&l.push(L.generalizedTimeToDate(t.certValidity2GeneralizedTime)),t.certValidity3UTCTime!==void 0&&l.push(L.utcTimeToDate(t.certValidity3UTCTime)),t.certValidity4GeneralizedTime!==void 0&&l.push(L.generalizedTimeToDate(t.certValidity4GeneralizedTime)),l.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(l.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(a.validity.notBefore=l[0],a.validity.notAfter=l[1],a.tbsCertificate=t.tbsCertificate,e){a.md=V7({signatureOid:a.signatureOid,type:"certificate"});var u=L.toDer(a.tbsCertificate);a.md.update(u.getBytes())}var d=Ot.md.sha1.create(),p=L.toDer(t.certIssuer);d.update(p.getBytes()),a.issuer.getField=function(h){return xy(a.issuer,h)},a.issuer.addField=function(h){Eu([h]),a.issuer.attributes.push(h)},a.issuer.attributes=Ke.RDNAttributesAsArray(t.certIssuer),t.certIssuerUniqueId&&(a.issuer.uniqueId=t.certIssuerUniqueId),a.issuer.hash=d.digest().toHex();var f=Ot.md.sha1.create(),m=L.toDer(t.certSubject);return f.update(m.getBytes()),a.subject.getField=function(h){return xy(a.subject,h)},a.subject.addField=function(h){Eu([h]),a.subject.attributes.push(h)},a.subject.attributes=Ke.RDNAttributesAsArray(t.certSubject),t.certSubjectUniqueId&&(a.subject.uniqueId=t.certSubjectUniqueId),a.subject.hash=f.digest().toHex(),t.certExtensions?a.extensions=Ke.certificateExtensionsFromAsn1(t.certExtensions):a.extensions=[],a.publicKey=Ke.publicKeyFromAsn1(t.subjectPublicKeyInfo),a};Ke.certificateExtensionsFromAsn1=function(n){for(var e=[],t=0;t<n.value.length;++t)for(var r=n.value[t],o=0;o<r.value.length;++o)e.push(Ke.certificateExtensionFromAsn1(r.value[o]));return e};Ke.certificateExtensionFromAsn1=function(n){var e={};if(e.id=L.derToOid(n.value[0].value),e.critical=!1,n.value[1].type===L.Type.BOOLEAN?(e.critical=n.value[1].value.charCodeAt(0)!==0,e.value=n.value[2].value):e.value=n.value[1].value,e.id in Zn){if(e.name=Zn[e.id],e.name==="keyUsage"){var t=L.fromDer(e.value),r=0,o=0;t.value.length>1&&(r=t.value.charCodeAt(1),o=t.value.length>2?t.value.charCodeAt(2):0),e.digitalSignature=(r&128)===128,e.nonRepudiation=(r&64)===64,e.keyEncipherment=(r&32)===32,e.dataEncipherment=(r&16)===16,e.keyAgreement=(r&8)===8,e.keyCertSign=(r&4)===4,e.cRLSign=(r&2)===2,e.encipherOnly=(r&1)===1,e.decipherOnly=(o&128)===128}else if(e.name==="basicConstraints"){var t=L.fromDer(e.value);t.value.length>0&&t.value[0].type===L.Type.BOOLEAN?e.cA=t.value[0].value.charCodeAt(0)!==0:e.cA=!1;var s=null;t.value.length>0&&t.value[0].type===L.Type.INTEGER?s=t.value[0].value:t.value.length>1&&(s=t.value[1].value),s!==null&&(e.pathLenConstraint=L.derToInteger(s))}else if(e.name==="extKeyUsage")for(var t=L.fromDer(e.value),a=0;a<t.value.length;++a){var c=L.derToOid(t.value[a].value);c in Zn?e[Zn[c]]=!0:e[c]=!0}else if(e.name==="nsCertType"){var t=L.fromDer(e.value),r=0;t.value.length>1&&(r=t.value.charCodeAt(1)),e.client=(r&128)===128,e.server=(r&64)===64,e.email=(r&32)===32,e.objsign=(r&16)===16,e.reserved=(r&8)===8,e.sslCA=(r&4)===4,e.emailCA=(r&2)===2,e.objCA=(r&1)===1}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.altNames=[];for(var l,t=L.fromDer(e.value),u=0;u<t.value.length;++u){l=t.value[u];var d={type:l.type,value:l.value};switch(e.altNames.push(d),l.type){case 1:case 2:case 6:break;case 7:d.ip=Ot.util.bytesToIP(l.value);break;case 8:d.oid=L.derToOid(l.value);break;default:}}}else if(e.name==="subjectKeyIdentifier"){var t=L.fromDer(e.value);e.subjectKeyIdentifier=Ot.util.bytesToHex(t.value)}}return e};Ke.certificationRequestFromAsn1=function(n,e){var t={},r=[];if(!L.validate(n,Xat,t,r)){var o=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw o.errors=r,o}var s=L.derToOid(t.publicKeyOid);if(s!==Ke.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var a=Ke.createCertificationRequest();if(a.version=t.csrVersion?t.csrVersion.charCodeAt(0):0,a.signatureOid=Ot.asn1.derToOid(t.csrSignatureOid),a.signatureParameters=H7(a.signatureOid,t.csrSignatureParams,!0),a.siginfo.algorithmOid=Ot.asn1.derToOid(t.csrSignatureOid),a.siginfo.parameters=H7(a.siginfo.algorithmOid,t.csrSignatureParams,!1),a.signature=t.csrSignature,a.certificationRequestInfo=t.certificationRequestInfo,e){a.md=V7({signatureOid:a.signatureOid,type:"certification request"});var c=L.toDer(a.certificationRequestInfo);a.md.update(c.getBytes())}var l=Ot.md.sha1.create();return a.subject.getField=function(u){return xy(a.subject,u)},a.subject.addField=function(u){Eu([u]),a.subject.attributes.push(u)},a.subject.attributes=Ke.RDNAttributesAsArray(t.certificationRequestInfoSubject,l),a.subject.hash=l.digest().toHex(),a.publicKey=Ke.publicKeyFromAsn1(t.subjectPublicKeyInfo),a.getAttribute=function(u){return xy(a,u)},a.addAttribute=function(u){Eu([u]),a.attributes.push(u)},a.attributes=Ke.CRIAttributesAsArray(t.certificationRequestInfoAttributes||[]),a};Ke.createCertificationRequest=function(){var n={};return n.version=0,n.signatureOid=null,n.signature=null,n.siginfo={},n.siginfo.algorithmOid=null,n.subject={},n.subject.getField=function(e){return xy(n.subject,e)},n.subject.addField=function(e){Eu([e]),n.subject.attributes.push(e)},n.subject.attributes=[],n.subject.hash=null,n.publicKey=null,n.attributes=[],n.getAttribute=function(e){return xy(n,e)},n.addAttribute=function(e){Eu([e]),n.attributes.push(e)},n.md=null,n.setSubject=function(e){Eu(e),n.subject.attributes=e,n.subject.hash=null},n.setAttributes=function(e){Eu(e),n.attributes=e},n.sign=function(e,t){n.md=t||Ot.md.sha1.create();var r=Zn[n.md.algorithm+"WithRSAEncryption"];if(!r){var o=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw o.algorithm=n.md.algorithm,o}n.signatureOid=n.siginfo.algorithmOid=r,n.certificationRequestInfo=Ke.getCertificationRequestInfo(n);var s=L.toDer(n.certificationRequestInfo);n.md.update(s.getBytes()),n.signature=e.sign(n.md)},n.verify=function(){var e=!1,t=n.md;if(t===null){t=V7({signatureOid:n.signatureOid,type:"certification request"});var r=n.certificationRequestInfo||Ke.getCertificationRequestInfo(n),o=L.toDer(r);t.update(o.getBytes())}return t!==null&&(e=bEe({certificate:n,md:t,signature:n.signature})),e},n};function vw(n){for(var e=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[]),t,r,o=n.attributes,s=0;s<o.length;++s){t=o[s];var a=t.value,c=L.Type.PRINTABLESTRING;"valueTagClass"in t&&(c=t.valueTagClass,c===L.Type.UTF8&&(a=Ot.util.encodeUtf8(a))),r=L.create(L.Class.UNIVERSAL,L.Type.SET,!0,[L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(t.type).getBytes()),L.create(L.Class.UNIVERSAL,c,!1,a)])]),e.value.push(r)}return e}function Eu(n){for(var e,t=0;t<n.length;++t){if(e=n[t],typeof e.name>"u"&&(e.type&&e.type in Ke.oids?e.name=Ke.oids[e.type]:e.shortName&&e.shortName in eo&&(e.name=Ke.oids[eo[e.shortName]])),typeof e.type>"u")if(e.name&&e.name in Ke.oids)e.type=Ke.oids[e.name];else{var r=new Error("Attribute type not specified.");throw r.attribute=e,r}if(typeof e.shortName>"u"&&e.name&&e.name in eo&&(e.shortName=eo[e.name]),e.type===Zn.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=L.Type.SEQUENCE,!e.value&&e.extensions)){e.value=[];for(var o=0;o<e.extensions.length;++o)e.value.push(Ke.certificateExtensionToAsn1(_Ee(e.extensions[o])))}if(typeof e.value>"u"){var r=new Error("Attribute value not specified.");throw r.attribute=e,r}}}function _Ee(n,e){if(e=e||{},typeof n.name>"u"&&n.id&&n.id in Ke.oids&&(n.name=Ke.oids[n.id]),typeof n.id>"u")if(n.name&&n.name in Ke.oids)n.id=Ke.oids[n.name];else{var t=new Error("Extension ID not specified.");throw t.extension=n,t}if(typeof n.value<"u")return n;if(n.name==="keyUsage"){var r=0,o=0,s=0;n.digitalSignature&&(o|=128,r=7),n.nonRepudiation&&(o|=64,r=6),n.keyEncipherment&&(o|=32,r=5),n.dataEncipherment&&(o|=16,r=4),n.keyAgreement&&(o|=8,r=3),n.keyCertSign&&(o|=4,r=2),n.cRLSign&&(o|=2,r=1),n.encipherOnly&&(o|=1,r=0),n.decipherOnly&&(s|=128,r=7);var a=String.fromCharCode(r);s!==0?a+=String.fromCharCode(o)+String.fromCharCode(s):o!==0&&(a+=String.fromCharCode(o)),n.value=L.create(L.Class.UNIVERSAL,L.Type.BITSTRING,!1,a)}else if(n.name==="basicConstraints")n.value=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[]),n.cA&&n.value.value.push(L.create(L.Class.UNIVERSAL,L.Type.BOOLEAN,!1,"\xFF")),"pathLenConstraint"in n&&n.value.value.push(L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,L.integerToDer(n.pathLenConstraint).getBytes()));else if(n.name==="extKeyUsage"){n.value=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[]);var c=n.value.value;for(var l in n)n[l]===!0&&(l in Zn?c.push(L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(Zn[l]).getBytes())):l.indexOf(".")!==-1&&c.push(L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(l).getBytes())))}else if(n.name==="nsCertType"){var r=0,o=0;n.client&&(o|=128,r=7),n.server&&(o|=64,r=6),n.email&&(o|=32,r=5),n.objsign&&(o|=16,r=4),n.reserved&&(o|=8,r=3),n.sslCA&&(o|=4,r=2),n.emailCA&&(o|=2,r=1),n.objCA&&(o|=1,r=0);var a=String.fromCharCode(r);o!==0&&(a+=String.fromCharCode(o)),n.value=L.create(L.Class.UNIVERSAL,L.Type.BITSTRING,!1,a)}else if(n.name==="subjectAltName"||n.name==="issuerAltName"){n.value=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[]);for(var u,d=0;d<n.altNames.length;++d){u=n.altNames[d];var a=u.value;if(u.type===7&&u.ip){if(a=Ot.util.bytesFromIP(u.ip),a===null){var t=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw t.extension=n,t}}else u.type===8&&(u.oid?a=L.oidToDer(L.oidToDer(u.oid)):a=L.oidToDer(a));n.value.value.push(L.create(L.Class.CONTEXT_SPECIFIC,u.type,!1,a))}}else if(n.name==="nsComment"&&e.cert){if(!/^[\x00-\x7F]*$/.test(n.comment)||n.comment.length<1||n.comment.length>128)throw new Error('Invalid "nsComment" content.');n.value=L.create(L.Class.UNIVERSAL,L.Type.IA5STRING,!1,n.comment)}else if(n.name==="subjectKeyIdentifier"&&e.cert){var p=e.cert.generateSubjectKeyIdentifier();n.subjectKeyIdentifier=p.toHex(),n.value=L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,p.getBytes())}else if(n.name==="authorityKeyIdentifier"&&e.cert){n.value=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[]);var c=n.value.value;if(n.keyIdentifier){var f=n.keyIdentifier===!0?e.cert.generateSubjectKeyIdentifier().getBytes():n.keyIdentifier;c.push(L.create(L.Class.CONTEXT_SPECIFIC,0,!1,f))}if(n.authorityCertIssuer){var m=[L.create(L.Class.CONTEXT_SPECIFIC,4,!0,[vw(n.authorityCertIssuer===!0?e.cert.issuer:n.authorityCertIssuer)])];c.push(L.create(L.Class.CONTEXT_SPECIFIC,1,!0,m))}if(n.serialNumber){var h=Ot.util.hexToBytes(n.serialNumber===!0?e.cert.serialNumber:n.serialNumber);c.push(L.create(L.Class.CONTEXT_SPECIFIC,2,!1,h))}}else if(n.name==="cRLDistributionPoints"){n.value=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[]);for(var c=n.value.value,g=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[]),y=L.create(L.Class.CONTEXT_SPECIFIC,0,!0,[]),u,d=0;d<n.altNames.length;++d){u=n.altNames[d];var a=u.value;if(u.type===7&&u.ip){if(a=Ot.util.bytesFromIP(u.ip),a===null){var t=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw t.extension=n,t}}else u.type===8&&(u.oid?a=L.oidToDer(L.oidToDer(u.oid)):a=L.oidToDer(a));y.value.push(L.create(L.Class.CONTEXT_SPECIFIC,u.type,!1,a))}g.value.push(L.create(L.Class.CONTEXT_SPECIFIC,0,!0,[y])),c.push(g)}if(typeof n.value>"u"){var t=new Error("Extension value not specified.");throw t.extension=n,t}return n}function ane(n,e){switch(n){case Zn["RSASSA-PSS"]:var t=[];return e.hash.algorithmOid!==void 0&&t.push(L.create(L.Class.CONTEXT_SPECIFIC,0,!0,[L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(e.hash.algorithmOid).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.NULL,!1,"")])])),e.mgf.algorithmOid!==void 0&&t.push(L.create(L.Class.CONTEXT_SPECIFIC,1,!0,[L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(e.mgf.algorithmOid).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(e.mgf.hash.algorithmOid).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.NULL,!1,"")])])])),e.saltLength!==void 0&&t.push(L.create(L.Class.CONTEXT_SPECIFIC,2,!0,[L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,L.integerToDer(e.saltLength).getBytes())])),L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,t);default:return L.create(L.Class.UNIVERSAL,L.Type.NULL,!1,"")}}function Jat(n){var e=L.create(L.Class.CONTEXT_SPECIFIC,0,!0,[]);if(n.attributes.length===0)return e;for(var t=n.attributes,r=0;r<t.length;++r){var o=t[r],s=o.value,a=L.Type.UTF8;"valueTagClass"in o&&(a=o.valueTagClass),a===L.Type.UTF8&&(s=Ot.util.encodeUtf8(s));var c=!1;"valueConstructed"in o&&(c=o.valueConstructed);var l=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(o.type).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.SET,!0,[L.create(L.Class.UNIVERSAL,a,c,s)])]);e.value.push(l)}return e}var Zat=new Date("1950-01-01T00:00:00Z"),ect=new Date("2050-01-01T00:00:00Z");function vEe(n){return n>=Zat&&n<ect?L.create(L.Class.UNIVERSAL,L.Type.UTCTIME,!1,L.dateToUtcTime(n)):L.create(L.Class.UNIVERSAL,L.Type.GENERALIZEDTIME,!1,L.dateToGeneralizedTime(n))}Ke.getTBSCertificate=function(n){var e=vEe(n.validity.notBefore),t=vEe(n.validity.notAfter),r=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.CONTEXT_SPECIFIC,0,!0,[L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,L.integerToDer(n.version).getBytes())]),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,Ot.util.hexToBytes(n.serialNumber)),L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(n.siginfo.algorithmOid).getBytes()),ane(n.siginfo.algorithmOid,n.siginfo.parameters)]),vw(n.issuer),L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[e,t]),vw(n.subject),Ke.publicKeyToAsn1(n.publicKey)]);return n.issuer.uniqueId&&r.value.push(L.create(L.Class.CONTEXT_SPECIFIC,1,!0,[L.create(L.Class.UNIVERSAL,L.Type.BITSTRING,!1,"\0"+n.issuer.uniqueId)])),n.subject.uniqueId&&r.value.push(L.create(L.Class.CONTEXT_SPECIFIC,2,!0,[L.create(L.Class.UNIVERSAL,L.Type.BITSTRING,!1,"\0"+n.subject.uniqueId)])),n.extensions.length>0&&r.value.push(Ke.certificateExtensionsToAsn1(n.extensions)),r};Ke.getCertificationRequestInfo=function(n){var e=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,L.integerToDer(n.version).getBytes()),vw(n.subject),Ke.publicKeyToAsn1(n.publicKey),Jat(n)]);return e};Ke.distinguishedNameToAsn1=function(n){return vw(n)};Ke.certificateToAsn1=function(n){var e=n.tbsCertificate||Ke.getTBSCertificate(n);return L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[e,L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(n.signatureOid).getBytes()),ane(n.signatureOid,n.signatureParameters)]),L.create(L.Class.UNIVERSAL,L.Type.BITSTRING,!1,"\0"+n.signature)])};Ke.certificateExtensionsToAsn1=function(n){var e=L.create(L.Class.CONTEXT_SPECIFIC,3,!0,[]),t=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[]);e.value.push(t);for(var r=0;r<n.length;++r)t.value.push(Ke.certificateExtensionToAsn1(n[r]));return e};Ke.certificateExtensionToAsn1=function(n){var e=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[]);e.value.push(L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(n.id).getBytes())),n.critical&&e.value.push(L.create(L.Class.UNIVERSAL,L.Type.BOOLEAN,!1,"\xFF"));var t=n.value;return typeof n.value!="string"&&(t=L.toDer(t).getBytes()),e.value.push(L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,t)),e};Ke.certificationRequestToAsn1=function(n){var e=n.certificationRequestInfo||Ke.getCertificationRequestInfo(n);return L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[e,L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(n.signatureOid).getBytes()),ane(n.signatureOid,n.signatureParameters)]),L.create(L.Class.UNIVERSAL,L.Type.BITSTRING,!1,"\0"+n.signature)])};Ke.createCaStore=function(n){var e={certs:{}};e.getIssuer=function(a){var c=t(a.issuer);return c},e.addCertificate=function(a){if(typeof a=="string"&&(a=Ot.pki.certificateFromPem(a)),r(a.subject),!e.hasCertificate(a))if(a.subject.hash in e.certs){var c=e.certs[a.subject.hash];Ot.util.isArray(c)||(c=[c]),c.push(a),e.certs[a.subject.hash]=c}else e.certs[a.subject.hash]=a},e.hasCertificate=function(a){typeof a=="string"&&(a=Ot.pki.certificateFromPem(a));var c=t(a.subject);if(!c)return!1;Ot.util.isArray(c)||(c=[c]);for(var l=L.toDer(Ke.certificateToAsn1(a)).getBytes(),u=0;u<c.length;++u){var d=L.toDer(Ke.certificateToAsn1(c[u])).getBytes();if(l===d)return!0}return!1},e.listAllCertificates=function(){var a=[];for(var c in e.certs)if(e.certs.hasOwnProperty(c)){var l=e.certs[c];if(!Ot.util.isArray(l))a.push(l);else for(var u=0;u<l.length;++u)a.push(l[u])}return a},e.removeCertificate=function(a){var c;if(typeof a=="string"&&(a=Ot.pki.certificateFromPem(a)),r(a.subject),!e.hasCertificate(a))return null;var l=t(a.subject);if(!Ot.util.isArray(l))return c=e.certs[a.subject.hash],delete e.certs[a.subject.hash],c;for(var u=L.toDer(Ke.certificateToAsn1(a)).getBytes(),d=0;d<l.length;++d){var p=L.toDer(Ke.certificateToAsn1(l[d])).getBytes();u===p&&(c=l[d],l.splice(d,1))}return l.length===0&&delete e.certs[a.subject.hash],c};function t(a){return r(a),e.certs[a.hash]||null}function r(a){if(!a.hash){var c=Ot.md.sha1.create();a.attributes=Ke.RDNAttributesAsArray(vw(a),c),a.hash=c.digest().toHex()}}if(n)for(var o=0;o<n.length;++o){var s=n[o];e.addCertificate(s)}return e};Ke.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};Ke.verifyCertificateChain=function(n,e,t){typeof t=="function"&&(t={verify:t}),t=t||{},e=e.slice(0);var r=e.slice(0),o=t.validityCheckDate;typeof o>"u"&&(o=new Date);var s=!0,a=null,c=0;do{var l=e.shift(),u=null,d=!1;if(o&&(o<l.validity.notBefore||o>l.validity.notAfter)&&(a={message:"Certificate is not valid yet or has expired.",error:Ke.certificateError.certificate_expired,notBefore:l.validity.notBefore,notAfter:l.validity.notAfter,now:o}),a===null){if(u=e[0]||n.getIssuer(l),u===null&&l.isIssuer(l)&&(d=!0,u=l),u){var p=u;Ot.util.isArray(p)||(p=[p]);for(var f=!1;!f&&p.length>0;){u=p.shift();try{f=u.verify(l)}catch{}}f||(a={message:"Certificate signature is invalid.",error:Ke.certificateError.bad_certificate})}a===null&&(!u||d)&&!n.hasCertificate(l)&&(a={message:"Certificate is not trusted.",error:Ke.certificateError.unknown_ca})}if(a===null&&u&&!l.isIssuer(u)&&(a={message:"Certificate issuer is invalid.",error:Ke.certificateError.bad_certificate}),a===null)for(var m={keyUsage:!0,basicConstraints:!0},h=0;a===null&&h<l.extensions.length;++h){var g=l.extensions[h];g.critical&&!(g.name in m)&&(a={message:"Certificate has an unsupported critical extension.",error:Ke.certificateError.unsupported_certificate})}if(a===null&&(!s||e.length===0&&(!u||d))){var y=l.getExtension("basicConstraints"),b=l.getExtension("keyUsage");if(b!==null&&(!b.keyCertSign||y===null)&&(a={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:Ke.certificateError.bad_certificate}),a===null&&y!==null&&!y.cA&&(a={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:Ke.certificateError.bad_certificate}),a===null&&b!==null&&"pathLenConstraint"in y){var _=c-1;_>y.pathLenConstraint&&(a={message:"Certificate basicConstraints pathLenConstraint violated.",error:Ke.certificateError.bad_certificate})}}var x=a===null?!0:a.error,I=t.verify?t.verify(x,c,r):x;if(I===!0)a=null;else throw x===!0&&(a={message:"The application rejected the certificate.",error:Ke.certificateError.bad_certificate}),(I||I===0)&&(typeof I=="object"&&!Ot.util.isArray(I)?(I.message&&(a.message=I.message),I.error&&(a.error=I.error)):typeof I=="string"&&(a.error=I)),a;s=!1,++c}while(e.length>0);return!0}});var lne=P((CRn,IEe)=>{var Kr=In();Qd();uw();yy();one();ine();Iu();XL();mw();rr();G7();var z=Kr.asn1,Mn=Kr.pki,ZL=IEe.exports=Kr.pkcs12=Kr.pkcs12||{},SEe={name:"ContentInfo",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:z.Class.UNIVERSAL,type:z.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:z.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},tct={name:"PFX",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,capture:"version"},SEe,{name:"PFX.macData",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:z.Class.UNIVERSAL,type:z.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:z.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:z.Class.UNIVERSAL,type:z.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:z.Class.UNIVERSAL,type:z.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:z.Class.UNIVERSAL,type:z.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},nct={name:"SafeBag",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:z.Class.UNIVERSAL,type:z.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:z.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:z.Class.UNIVERSAL,type:z.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},rct={name:"Attribute",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:z.Class.UNIVERSAL,type:z.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:z.Class.UNIVERSAL,type:z.Type.SET,constructed:!0,capture:"values"}]},ict={name:"CertBag",tagClass:z.Class.UNIVERSAL,type:z.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:z.Class.UNIVERSAL,type:z.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:z.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:z.Class.UNIVERSAL,type:z.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function JL(n,e,t,r){for(var o=[],s=0;s<n.length;s++)for(var a=0;a<n[s].safeBags.length;a++){var c=n[s].safeBags[a];if(!(r!==void 0&&c.type!==r)){if(e===null){o.push(c);continue}c.attributes[e]!==void 0&&c.attributes[e].indexOf(t)>=0&&o.push(c)}}return o}ZL.pkcs12FromAsn1=function(n,e,t){typeof e=="string"?(t=e,e=!0):e===void 0&&(e=!0);var r={},o=[];if(!z.validate(n,tct,r,o)){var s=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw s.errors=s,s}var a={version:r.version.charCodeAt(0),safeContents:[],getBags:function(y){var b={},_;return"localKeyId"in y?_=y.localKeyId:"localKeyIdHex"in y&&(_=Kr.util.hexToBytes(y.localKeyIdHex)),_===void 0&&!("friendlyName"in y)&&"bagType"in y&&(b[y.bagType]=JL(a.safeContents,null,null,y.bagType)),_!==void 0&&(b.localKeyId=JL(a.safeContents,"localKeyId",_,y.bagType)),"friendlyName"in y&&(b.friendlyName=JL(a.safeContents,"friendlyName",y.friendlyName,y.bagType)),b},getBagsByFriendlyName:function(y,b){return JL(a.safeContents,"friendlyName",y,b)},getBagsByLocalKeyId:function(y,b){return JL(a.safeContents,"localKeyId",y,b)}};if(r.version.charCodeAt(0)!==3){var s=new Error("PKCS#12 PFX of version other than 3 not supported.");throw s.version=r.version.charCodeAt(0),s}if(z.derToOid(r.contentType)!==Mn.oids.data){var s=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw s.oid=z.derToOid(r.contentType),s}var c=r.content.value[0];if(c.tagClass!==z.Class.UNIVERSAL||c.type!==z.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(c=cne(c),r.mac){var l=null,u=0,d=z.derToOid(r.macAlgorithm);switch(d){case Mn.oids.sha1:l=Kr.md.sha1.create(),u=20;break;case Mn.oids.sha256:l=Kr.md.sha256.create(),u=32;break;case Mn.oids.sha384:l=Kr.md.sha384.create(),u=48;break;case Mn.oids.sha512:l=Kr.md.sha512.create(),u=64;break;case Mn.oids.md5:l=Kr.md.md5.create(),u=16;break}if(l===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+d);var p=new Kr.util.ByteBuffer(r.macSalt),f="macIterations"in r?parseInt(Kr.util.bytesToHex(r.macIterations),16):1,m=ZL.generateKey(t,p,3,f,u,l),h=Kr.hmac.create();h.start(l,m),h.update(c.value);var g=h.getMac();if(g.getBytes()!==r.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return oct(a,c.value,e,t),a};function cne(n){if(n.composed||n.constructed){for(var e=Kr.util.createBuffer(),t=0;t<n.value.length;++t)e.putBytes(n.value[t].value);n.composed=n.constructed=!1,n.value=e.getBytes()}return n}function oct(n,e,t,r){if(e=z.fromDer(e,t),e.tagClass!==z.Class.UNIVERSAL||e.type!==z.Type.SEQUENCE||e.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var o=0;o<e.value.length;o++){var s=e.value[o],a={},c=[];if(!z.validate(s,SEe,a,c)){var l=new Error("Cannot read ContentInfo.");throw l.errors=c,l}var u={encrypted:!1},d=null,p=a.content.value[0];switch(z.derToOid(a.contentType)){case Mn.oids.data:if(p.tagClass!==z.Class.UNIVERSAL||p.type!==z.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");d=cne(p).value;break;case Mn.oids.encryptedData:d=sct(p,r),u.encrypted=!0;break;default:var l=new Error("Unsupported PKCS#12 contentType.");throw l.contentType=z.derToOid(a.contentType),l}u.safeBags=act(d,t,r),n.safeContents.push(u)}}function sct(n,e){var t={},r=[];if(!z.validate(n,Kr.pkcs7.asn1.encryptedDataValidator,t,r)){var o=new Error("Cannot read EncryptedContentInfo.");throw o.errors=r,o}var s=z.derToOid(t.contentType);if(s!==Mn.oids.data){var o=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw o.oid=s,o}s=z.derToOid(t.encAlgorithm);var a=Mn.pbe.getCipher(s,t.encParameter,e),c=cne(t.encryptedContentAsn1),l=Kr.util.createBuffer(c.value);if(a.update(l),!a.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return a.output.getBytes()}function act(n,e,t){if(!e&&n.length===0)return[];if(n=z.fromDer(n,e),n.tagClass!==z.Class.UNIVERSAL||n.type!==z.Type.SEQUENCE||n.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var r=[],o=0;o<n.value.length;o++){var s=n.value[o],a={},c=[];if(!z.validate(s,nct,a,c)){var l=new Error("Cannot read SafeBag.");throw l.errors=c,l}var u={type:z.derToOid(a.bagId),attributes:cct(a.bagAttributes)};r.push(u);var d,p,f=a.bagValue.value[0];switch(u.type){case Mn.oids.pkcs8ShroudedKeyBag:if(f=Mn.decryptPrivateKeyInfo(f,t),f===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case Mn.oids.keyBag:try{u.key=Mn.privateKeyFromAsn1(f)}catch{u.key=null,u.asn1=f}continue;case Mn.oids.certBag:d=ict,p=function(){if(z.derToOid(a.certId)!==Mn.oids.x509Certificate){var h=new Error("Unsupported certificate type, only X.509 supported.");throw h.oid=z.derToOid(a.certId),h}var g=z.fromDer(a.cert,e);try{u.cert=Mn.certificateFromAsn1(g,!0)}catch{u.cert=null,u.asn1=g}};break;default:var l=new Error("Unsupported PKCS#12 SafeBag type.");throw l.oid=u.type,l}if(d!==void 0&&!z.validate(f,d,a,c)){var l=new Error("Cannot read PKCS#12 "+d.name);throw l.errors=c,l}p()}return r}function cct(n){var e={};if(n!==void 0)for(var t=0;t<n.length;++t){var r={},o=[];if(!z.validate(n[t],rct,r,o)){var s=new Error("Cannot read PKCS#12 BagAttribute.");throw s.errors=o,s}var a=z.derToOid(r.oid);if(Mn.oids[a]!==void 0){e[Mn.oids[a]]=[];for(var c=0;c<r.values.length;++c)e[Mn.oids[a]].push(r.values[c].value)}}return e}ZL.toPkcs12Asn1=function(n,e,t,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||r.encAlgorithm||"aes128","useMac"in r||(r.useMac=!0),"localKeyId"in r||(r.localKeyId=null),"generateLocalKeyId"in r||(r.generateLocalKeyId=!0);var o=r.localKeyId,s;if(o!==null)o=Kr.util.hexToBytes(o);else if(r.generateLocalKeyId)if(e){var a=Kr.util.isArray(e)?e[0]:e;typeof a=="string"&&(a=Mn.certificateFromPem(a));var c=Kr.md.sha1.create();c.update(z.toDer(Mn.certificateToAsn1(a)).getBytes()),o=c.digest().getBytes()}else o=Kr.random.getBytes(20);var l=[];o!==null&&l.push(z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(Mn.oids.localKeyId).getBytes()),z.create(z.Class.UNIVERSAL,z.Type.SET,!0,[z.create(z.Class.UNIVERSAL,z.Type.OCTETSTRING,!1,o)])])),"friendlyName"in r&&l.push(z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(Mn.oids.friendlyName).getBytes()),z.create(z.Class.UNIVERSAL,z.Type.SET,!0,[z.create(z.Class.UNIVERSAL,z.Type.BMPSTRING,!1,r.friendlyName)])])),l.length>0&&(s=z.create(z.Class.UNIVERSAL,z.Type.SET,!0,l));var u=[],d=[];e!==null&&(Kr.util.isArray(e)?d=e:d=[e]);for(var p=[],f=0;f<d.length;++f){e=d[f],typeof e=="string"&&(e=Mn.certificateFromPem(e));var m=f===0?s:void 0,h=Mn.certificateToAsn1(e),g=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(Mn.oids.certBag).getBytes()),z.create(z.Class.CONTEXT_SPECIFIC,0,!0,[z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(Mn.oids.x509Certificate).getBytes()),z.create(z.Class.CONTEXT_SPECIFIC,0,!0,[z.create(z.Class.UNIVERSAL,z.Type.OCTETSTRING,!1,z.toDer(h).getBytes())])])]),m]);p.push(g)}if(p.length>0){var y=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,p),b=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(Mn.oids.data).getBytes()),z.create(z.Class.CONTEXT_SPECIFIC,0,!0,[z.create(z.Class.UNIVERSAL,z.Type.OCTETSTRING,!1,z.toDer(y).getBytes())])]);u.push(b)}var _=null;if(n!==null){var x=Mn.wrapRsaPrivateKey(Mn.privateKeyToAsn1(n));t===null?_=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(Mn.oids.keyBag).getBytes()),z.create(z.Class.CONTEXT_SPECIFIC,0,!0,[x]),s]):_=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(Mn.oids.pkcs8ShroudedKeyBag).getBytes()),z.create(z.Class.CONTEXT_SPECIFIC,0,!0,[Mn.encryptPrivateKeyInfo(x,t,r)]),s]);var I=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[_]),S=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(Mn.oids.data).getBytes()),z.create(z.Class.CONTEXT_SPECIFIC,0,!0,[z.create(z.Class.UNIVERSAL,z.Type.OCTETSTRING,!1,z.toDer(I).getBytes())])]);u.push(S)}var w=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,u),R;if(r.useMac){var c=Kr.md.sha1.create(),k=new Kr.util.ByteBuffer(Kr.random.getBytes(r.saltSize)),V=r.count,n=ZL.generateKey(t,k,3,V,20),F=Kr.hmac.create();F.start(c,n),F.update(z.toDer(w).getBytes());var K=F.getMac();R=z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(Mn.oids.sha1).getBytes()),z.create(z.Class.UNIVERSAL,z.Type.NULL,!1,"")]),z.create(z.Class.UNIVERSAL,z.Type.OCTETSTRING,!1,K.getBytes())]),z.create(z.Class.UNIVERSAL,z.Type.OCTETSTRING,!1,k.getBytes()),z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,z.integerToDer(V).getBytes())])}return z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.INTEGER,!1,z.integerToDer(3).getBytes()),z.create(z.Class.UNIVERSAL,z.Type.SEQUENCE,!0,[z.create(z.Class.UNIVERSAL,z.Type.OID,!1,z.oidToDer(Mn.oids.data).getBytes()),z.create(z.Class.CONTEXT_SPECIFIC,0,!0,[z.create(z.Class.UNIVERSAL,z.Type.OCTETSTRING,!1,z.toDer(w).getBytes())])]),R])};ZL.generateKey=Kr.pbe.generatePkcs12Key});var dne=P((ERn,TEe)=>{var Sy=In();Qd();yy();ine();nS();L7();lne();j7();XL();rr();G7();var une=Sy.asn1,yw=TEe.exports=Sy.pki=Sy.pki||{};yw.pemToDer=function(n){var e=Sy.pem.decode(n)[0];if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return Sy.util.createBuffer(e.body)};yw.privateKeyFromPem=function(n){var e=Sy.pem.decode(n)[0];if(e.type!=="PRIVATE KEY"&&e.type!=="RSA PRIVATE KEY"){var t=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw t.headerType=e.type,t}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var r=une.fromDer(e.body);return yw.privateKeyFromAsn1(r)};yw.privateKeyToPem=function(n,e){var t={type:"RSA PRIVATE KEY",body:une.toDer(yw.privateKeyToAsn1(n)).getBytes()};return Sy.pem.encode(t,{maxline:e})};yw.privateKeyInfoToPem=function(n,e){var t={type:"PRIVATE KEY",body:une.toDer(n).getBytes()};return Sy.pem.encode(t,{maxline:e})}});var vne=P((wRn,DEe)=>{var ke=In();Qd();uw();P7();nS();dne();Iu();mw();rr();var K7=function(n,e,t,r){var o=ke.util.createBuffer(),s=n.length>>1,a=s+(n.length&1),c=n.substr(0,a),l=n.substr(s,a),u=ke.util.createBuffer(),d=ke.hmac.create();t=e+t;var p=Math.ceil(r/16),f=Math.ceil(r/20);d.start("MD5",c);var m=ke.util.createBuffer();u.putBytes(t);for(var h=0;h<p;++h)d.start(null,null),d.update(u.getBytes()),u.putBuffer(d.digest()),d.start(null,null),d.update(u.bytes()+t),m.putBuffer(d.digest());d.start("SHA1",l);var g=ke.util.createBuffer();u.clear(),u.putBytes(t);for(var h=0;h<f;++h)d.start(null,null),d.update(u.getBytes()),u.putBuffer(d.digest()),d.start(null,null),d.update(u.bytes()+t),g.putBuffer(d.digest());return o.putBytes(ke.util.xorBytes(m.getBytes(),g.getBytes(),r)),o},lct=function(n,e,t){var r=ke.hmac.create();r.start("SHA1",n);var o=ke.util.createBuffer();return o.putInt32(e[0]),o.putInt32(e[1]),o.putByte(t.type),o.putByte(t.version.major),o.putByte(t.version.minor),o.putInt16(t.length),o.putBytes(t.fragment.bytes()),r.update(o.getBytes()),r.digest().getBytes()},uct=function(n,e,t){var r=!1;try{var o=n.deflate(e.fragment.getBytes());e.fragment=ke.util.createBuffer(o),e.length=o.length,r=!0}catch{}return r},dct=function(n,e,t){var r=!1;try{var o=n.inflate(e.fragment.getBytes());e.fragment=ke.util.createBuffer(o),e.length=o.length,r=!0}catch{}return r},Rl=function(n,e){var t=0;switch(e){case 1:t=n.getByte();break;case 2:t=n.getInt16();break;case 3:t=n.getInt24();break;case 4:t=n.getInt32();break}return ke.util.createBuffer(n.getBytes(t))},wu=function(n,e,t){n.putInt(t.length(),e<<3),n.putBuffer(t)},M={};M.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}};M.SupportedVersions=[M.Versions.TLS_1_1,M.Versions.TLS_1_0];M.Version=M.SupportedVersions[0];M.MaxFragment=15360;M.ConnectionEnd={server:0,client:1};M.PRFAlgorithm={tls_prf_sha256:0};M.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2};M.CipherType={stream:0,block:1,aead:2};M.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4};M.CompressionMethod={none:0,deflate:1};M.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24};M.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20};M.Alert={};M.Alert.Level={warning:1,fatal:2};M.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100};M.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2};M.CipherSuites={};M.getCipherSuite=function(n){var e=null;for(var t in M.CipherSuites){var r=M.CipherSuites[t];if(r.id[0]===n.charCodeAt(0)&&r.id[1]===n.charCodeAt(1)){e=r;break}}return e};M.handleUnexpected=function(n,e){var t=!n.open&&n.entity===M.ConnectionEnd.client;t||n.error(n,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.unexpected_message}})};M.handleHelloRequest=function(n,e,t){!n.handshaking&&n.handshakes>0&&(M.queue(n,M.createAlert(n,{level:M.Alert.Level.warning,description:M.Alert.Description.no_renegotiation})),M.flush(n)),n.process()};M.parseHelloMessage=function(n,e,t){var r=null,o=n.entity===M.ConnectionEnd.client;if(t<38)n.error(n,{message:o?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.illegal_parameter}});else{var s=e.fragment,a=s.length();if(r={version:{major:s.getByte(),minor:s.getByte()},random:ke.util.createBuffer(s.getBytes(32)),session_id:Rl(s,1),extensions:[]},o?(r.cipher_suite=s.getBytes(2),r.compression_method=s.getByte()):(r.cipher_suites=Rl(s,2),r.compression_methods=Rl(s,1)),a=t-(a-s.length()),a>0){for(var c=Rl(s,2);c.length()>0;)r.extensions.push({type:[c.getByte(),c.getByte()],data:Rl(c,2)});if(!o)for(var l=0;l<r.extensions.length;++l){var u=r.extensions[l];if(u.type[0]===0&&u.type[1]===0)for(var d=Rl(u.data,2);d.length()>0;){var p=d.getByte();if(p!==0)break;n.session.extensions.server_name.serverNameList.push(Rl(d,2).getBytes())}}}if(n.session.version&&(r.version.major!==n.session.version.major||r.version.minor!==n.session.version.minor))return n.error(n,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.protocol_version}});if(o)n.session.cipherSuite=M.getCipherSuite(r.cipher_suite);else for(var f=ke.util.createBuffer(r.cipher_suites.bytes());f.length()>0&&(n.session.cipherSuite=M.getCipherSuite(f.getBytes(2)),n.session.cipherSuite===null););if(n.session.cipherSuite===null)return n.error(n,{message:"No cipher suites in common.",send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.handshake_failure},cipherSuite:ke.util.bytesToHex(r.cipher_suite)});o?n.session.compressionMethod=r.compression_method:n.session.compressionMethod=M.CompressionMethod.none}return r};M.createSecurityParameters=function(n,e){var t=n.entity===M.ConnectionEnd.client,r=e.random.bytes(),o=t?n.session.sp.client_random:r,s=t?r:M.createRandom().getBytes();n.session.sp={entity:n.entity,prf_algorithm:M.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:n.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:o,server_random:s}};M.handleServerHello=function(n,e,t){var r=M.parseHelloMessage(n,e,t);if(!n.fail){if(r.version.minor<=n.version.minor)n.version.minor=r.version.minor;else return n.error(n,{message:"Incompatible TLS version.",send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.protocol_version}});n.session.version=n.version;var o=r.session_id.bytes();o.length>0&&o===n.session.id?(n.expect=wEe,n.session.resuming=!0,n.session.sp.server_random=r.random.bytes()):(n.expect=fct,n.session.resuming=!1,M.createSecurityParameters(n,r)),n.session.id=o,n.process()}};M.handleClientHello=function(n,e,t){var r=M.parseHelloMessage(n,e,t);if(!n.fail){var o=r.session_id.bytes(),s=null;if(n.sessionCache&&(s=n.sessionCache.getSession(o),s===null?o="":(s.version.major!==r.version.major||s.version.minor>r.version.minor)&&(s=null,o="")),o.length===0&&(o=ke.random.getBytes(32)),n.session.id=o,n.session.clientHelloVersion=r.version,n.session.sp={},s)n.version=n.session.version=s.version,n.session.sp=s.sp;else{for(var a,c=1;c<M.SupportedVersions.length&&(a=M.SupportedVersions[c],!(a.minor<=r.version.minor));++c);n.version={major:a.major,minor:a.minor},n.session.version=n.version}s!==null?(n.expect=hne,n.session.resuming=!0,n.session.sp.client_random=r.random.bytes()):(n.expect=n.verifyClient!==!1?_ct:mne,n.session.resuming=!1,M.createSecurityParameters(n,r)),n.open=!0,M.queue(n,M.createRecord(n,{type:M.ContentType.handshake,data:M.createServerHello(n)})),n.session.resuming?(M.queue(n,M.createRecord(n,{type:M.ContentType.change_cipher_spec,data:M.createChangeCipherSpec()})),n.state.pending=M.createConnectionState(n),n.state.current.write=n.state.pending.write,M.queue(n,M.createRecord(n,{type:M.ContentType.handshake,data:M.createFinished(n)}))):(M.queue(n,M.createRecord(n,{type:M.ContentType.handshake,data:M.createCertificate(n)})),n.fail||(M.queue(n,M.createRecord(n,{type:M.ContentType.handshake,data:M.createServerKeyExchange(n)})),n.verifyClient!==!1&&M.queue(n,M.createRecord(n,{type:M.ContentType.handshake,data:M.createCertificateRequest(n)})),M.queue(n,M.createRecord(n,{type:M.ContentType.handshake,data:M.createServerHelloDone(n)})))),M.flush(n),n.process()}};M.handleCertificate=function(n,e,t){if(t<3)return n.error(n,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.illegal_parameter}});var r=e.fragment,o={certificate_list:Rl(r,3)},s,a,c=[];try{for(;o.certificate_list.length()>0;)s=Rl(o.certificate_list,3),a=ke.asn1.fromDer(s),s=ke.pki.certificateFromAsn1(a,!0),c.push(s)}catch(u){return n.error(n,{message:"Could not parse certificate list.",cause:u,send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.bad_certificate}})}var l=n.entity===M.ConnectionEnd.client;(l||n.verifyClient===!0)&&c.length===0?n.error(n,{message:l?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.illegal_parameter}}):c.length===0?n.expect=l?CEe:mne:(l?n.session.serverCertificate=c[0]:n.session.clientCertificate=c[0],M.verifyCertificateChain(n,c)&&(n.expect=l?CEe:mne)),n.process()};M.handleServerKeyExchange=function(n,e,t){if(t>0)return n.error(n,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.unsupported_certificate}});n.expect=mct,n.process()};M.handleClientKeyExchange=function(n,e,t){if(t<48)return n.error(n,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.unsupported_certificate}});var r=e.fragment,o={enc_pre_master_secret:Rl(r,2).getBytes()},s=null;if(n.getPrivateKey)try{s=n.getPrivateKey(n,n.session.serverCertificate),s=ke.pki.privateKeyFromPem(s)}catch(l){n.error(n,{message:"Could not get private key.",cause:l,send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.internal_error}})}if(s===null)return n.error(n,{message:"No private key set.",send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.internal_error}});try{var a=n.session.sp;a.pre_master_secret=s.decrypt(o.enc_pre_master_secret);var c=n.session.clientHelloVersion;if(c.major!==a.pre_master_secret.charCodeAt(0)||c.minor!==a.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{a.pre_master_secret=ke.random.getBytes(48)}n.expect=hne,n.session.clientCertificate!==null&&(n.expect=xct),n.process()};M.handleCertificateRequest=function(n,e,t){if(t<3)return n.error(n,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.illegal_parameter}});var r=e.fragment,o={certificate_types:Rl(r,1),certificate_authorities:Rl(r,2)};n.session.certificateRequest=o,n.expect=hct,n.process()};M.handleCertificateVerify=function(n,e,t){if(t<2)return n.error(n,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.illegal_parameter}});var r=e.fragment;r.read-=4;var o=r.bytes();r.read+=4;var s={signature:Rl(r,2).getBytes()},a=ke.util.createBuffer();a.putBuffer(n.session.md5.digest()),a.putBuffer(n.session.sha1.digest()),a=a.getBytes();try{var c=n.session.clientCertificate;if(!c.publicKey.verify(a,s.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");n.session.md5.update(o),n.session.sha1.update(o)}catch{return n.error(n,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.handshake_failure}})}n.expect=hne,n.process()};M.handleServerHelloDone=function(n,e,t){if(t>0)return n.error(n,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.record_overflow}});if(n.serverCertificate===null){var r={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.insufficient_security}},o=0,s=n.verify(n,r.alert.description,o,[]);if(s!==!0)return(s||s===0)&&(typeof s=="object"&&!ke.util.isArray(s)?(s.message&&(r.message=s.message),s.alert&&(r.alert.description=s.alert)):typeof s=="number"&&(r.alert.description=s)),n.error(n,r)}n.session.certificateRequest!==null&&(e=M.createRecord(n,{type:M.ContentType.handshake,data:M.createCertificate(n)}),M.queue(n,e)),e=M.createRecord(n,{type:M.ContentType.handshake,data:M.createClientKeyExchange(n)}),M.queue(n,e),n.expect=yct;var a=function(c,l){c.session.certificateRequest!==null&&c.session.clientCertificate!==null&&M.queue(c,M.createRecord(c,{type:M.ContentType.handshake,data:M.createCertificateVerify(c,l)})),M.queue(c,M.createRecord(c,{type:M.ContentType.change_cipher_spec,data:M.createChangeCipherSpec()})),c.state.pending=M.createConnectionState(c),c.state.current.write=c.state.pending.write,M.queue(c,M.createRecord(c,{type:M.ContentType.handshake,data:M.createFinished(c)})),c.expect=wEe,M.flush(c),c.process()};if(n.session.certificateRequest===null||n.session.clientCertificate===null)return a(n,null);M.getClientSignature(n,a)};M.handleChangeCipherSpec=function(n,e){if(e.fragment.getByte()!==1)return n.error(n,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.illegal_parameter}});var t=n.entity===M.ConnectionEnd.client;(n.session.resuming&&t||!n.session.resuming&&!t)&&(n.state.pending=M.createConnectionState(n)),n.state.current.read=n.state.pending.read,(!n.session.resuming&&t||n.session.resuming&&!t)&&(n.state.pending=null),n.expect=t?gct:Sct,n.process()};M.handleFinished=function(n,e,t){var r=e.fragment;r.read-=4;var o=r.bytes();r.read+=4;var s=e.fragment.getBytes();r=ke.util.createBuffer(),r.putBuffer(n.session.md5.digest()),r.putBuffer(n.session.sha1.digest());var a=n.entity===M.ConnectionEnd.client,c=a?"server finished":"client finished",l=n.session.sp,u=12,d=K7;if(r=d(l.master_secret,c,r.getBytes(),u),r.getBytes()!==s)return n.error(n,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.decrypt_error}});n.session.md5.update(o),n.session.sha1.update(o),(n.session.resuming&&a||!n.session.resuming&&!a)&&(M.queue(n,M.createRecord(n,{type:M.ContentType.change_cipher_spec,data:M.createChangeCipherSpec()})),n.state.current.write=n.state.pending.write,n.state.pending=null,M.queue(n,M.createRecord(n,{type:M.ContentType.handshake,data:M.createFinished(n)}))),n.expect=a?vct:Ict,n.handshaking=!1,++n.handshakes,n.peerCertificate=a?n.session.serverCertificate:n.session.clientCertificate,M.flush(n),n.isConnected=!0,n.connected(n),n.process()};M.handleAlert=function(n,e){var t=e.fragment,r={level:t.getByte(),description:t.getByte()},o;switch(r.description){case M.Alert.Description.close_notify:o="Connection closed.";break;case M.Alert.Description.unexpected_message:o="Unexpected message.";break;case M.Alert.Description.bad_record_mac:o="Bad record MAC.";break;case M.Alert.Description.decryption_failed:o="Decryption failed.";break;case M.Alert.Description.record_overflow:o="Record overflow.";break;case M.Alert.Description.decompression_failure:o="Decompression failed.";break;case M.Alert.Description.handshake_failure:o="Handshake failure.";break;case M.Alert.Description.bad_certificate:o="Bad certificate.";break;case M.Alert.Description.unsupported_certificate:o="Unsupported certificate.";break;case M.Alert.Description.certificate_revoked:o="Certificate revoked.";break;case M.Alert.Description.certificate_expired:o="Certificate expired.";break;case M.Alert.Description.certificate_unknown:o="Certificate unknown.";break;case M.Alert.Description.illegal_parameter:o="Illegal parameter.";break;case M.Alert.Description.unknown_ca:o="Unknown certificate authority.";break;case M.Alert.Description.access_denied:o="Access denied.";break;case M.Alert.Description.decode_error:o="Decode error.";break;case M.Alert.Description.decrypt_error:o="Decrypt error.";break;case M.Alert.Description.export_restriction:o="Export restriction.";break;case M.Alert.Description.protocol_version:o="Unsupported protocol version.";break;case M.Alert.Description.insufficient_security:o="Insufficient security.";break;case M.Alert.Description.internal_error:o="Internal error.";break;case M.Alert.Description.user_canceled:o="User canceled.";break;case M.Alert.Description.no_renegotiation:o="Renegotiation not supported.";break;default:o="Unknown error.";break}if(r.description===M.Alert.Description.close_notify)return n.close();n.error(n,{message:o,send:!1,origin:n.entity===M.ConnectionEnd.client?"server":"client",alert:r}),n.process()};M.handleHandshake=function(n,e){var t=e.fragment,r=t.getByte(),o=t.getInt24();if(o>t.length())return n.fragmented=e,e.fragment=ke.util.createBuffer(),t.read-=4,n.process();n.fragmented=null,t.read-=4;var s=t.bytes(o+4);t.read+=4,r in W7[n.entity][n.expect]?(n.entity===M.ConnectionEnd.server&&!n.open&&!n.fail&&(n.handshaking=!0,n.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:ke.md.md5.create(),sha1:ke.md.sha1.create()}),r!==M.HandshakeType.hello_request&&r!==M.HandshakeType.certificate_verify&&r!==M.HandshakeType.finished&&(n.session.md5.update(s),n.session.sha1.update(s)),W7[n.entity][n.expect][r](n,e,o)):M.handleUnexpected(n,e)};M.handleApplicationData=function(n,e){n.data.putBuffer(e.fragment),n.dataReady(n),n.process()};M.handleHeartbeat=function(n,e){var t=e.fragment,r=t.getByte(),o=t.getInt16(),s=t.getBytes(o);if(r===M.HeartbeatMessageType.heartbeat_request){if(n.handshaking||o>s.length)return n.process();M.queue(n,M.createRecord(n,{type:M.ContentType.heartbeat,data:M.createHeartbeat(M.HeartbeatMessageType.heartbeat_response,s)})),M.flush(n)}else if(r===M.HeartbeatMessageType.heartbeat_response){if(s!==n.expectedHeartbeatPayload)return n.process();n.heartbeatReceived&&n.heartbeatReceived(n,ke.util.createBuffer(s))}n.process()};var pct=0,fct=1,CEe=2,mct=3,hct=4,wEe=5,gct=6,vct=7,yct=8,bct=0,_ct=1,mne=2,xct=3,hne=4,Sct=5,Ict=6,O=M.handleUnexpected,kEe=M.handleChangeCipherSpec,Zs=M.handleAlert,$a=M.handleHandshake,REe=M.handleApplicationData,ea=M.handleHeartbeat,gne=[];gne[M.ConnectionEnd.client]=[[O,Zs,$a,O,ea],[O,Zs,$a,O,ea],[O,Zs,$a,O,ea],[O,Zs,$a,O,ea],[O,Zs,$a,O,ea],[kEe,Zs,O,O,ea],[O,Zs,$a,O,ea],[O,Zs,$a,REe,ea],[O,Zs,$a,O,ea]];gne[M.ConnectionEnd.server]=[[O,Zs,$a,O,ea],[O,Zs,$a,O,ea],[O,Zs,$a,O,ea],[O,Zs,$a,O,ea],[kEe,Zs,O,O,ea],[O,Zs,$a,O,ea],[O,Zs,$a,REe,ea],[O,Zs,$a,O,ea]];var Iy=M.handleHelloRequest,Tct=M.handleServerHello,PEe=M.handleCertificate,EEe=M.handleServerKeyExchange,pne=M.handleCertificateRequest,z7=M.handleServerHelloDone,AEe=M.handleFinished,W7=[];W7[M.ConnectionEnd.client]=[[O,O,Tct,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O],[Iy,O,O,O,O,O,O,O,O,O,O,PEe,EEe,pne,z7,O,O,O,O,O,O],[Iy,O,O,O,O,O,O,O,O,O,O,O,EEe,pne,z7,O,O,O,O,O,O],[Iy,O,O,O,O,O,O,O,O,O,O,O,O,pne,z7,O,O,O,O,O,O],[Iy,O,O,O,O,O,O,O,O,O,O,O,O,O,z7,O,O,O,O,O,O],[Iy,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O],[Iy,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,AEe],[Iy,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O],[Iy,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O]];var Cct=M.handleClientHello,Ect=M.handleClientKeyExchange,wct=M.handleCertificateVerify;W7[M.ConnectionEnd.server]=[[O,Cct,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,PEe,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,Ect,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,wct,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,AEe],[O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O,O]];M.generateKeys=function(n,e){var t=K7,r=e.client_random+e.server_random;n.session.resuming||(e.master_secret=t(e.pre_master_secret,"master secret",r,48).bytes(),e.pre_master_secret=null),r=e.server_random+e.client_random;var o=2*e.mac_key_length+2*e.enc_key_length,s=n.version.major===M.Versions.TLS_1_0.major&&n.version.minor===M.Versions.TLS_1_0.minor;s&&(o+=2*e.fixed_iv_length);var a=t(e.master_secret,"key expansion",r,o),c={client_write_MAC_key:a.getBytes(e.mac_key_length),server_write_MAC_key:a.getBytes(e.mac_key_length),client_write_key:a.getBytes(e.enc_key_length),server_write_key:a.getBytes(e.enc_key_length)};return s&&(c.client_write_IV=a.getBytes(e.fixed_iv_length),c.server_write_IV=a.getBytes(e.fixed_iv_length)),c};M.createConnectionState=function(n){var e=n.entity===M.ConnectionEnd.client,t=function(){var s={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(a){return!0},compressionState:null,compressFunction:function(a){return!0},updateSequenceNumber:function(){s.sequenceNumber[1]===4294967295?(s.sequenceNumber[1]=0,++s.sequenceNumber[0]):++s.sequenceNumber[1]}};return s},r={read:t(),write:t()};if(r.read.update=function(s,a){return r.read.cipherFunction(a,r.read)?r.read.compressFunction(s,a,r.read)||s.error(s,{message:"Could not decompress record.",send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.decompression_failure}}):s.error(s,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.bad_record_mac}}),!s.fail},r.write.update=function(s,a){return r.write.compressFunction(s,a,r.write)?r.write.cipherFunction(a,r.write)||s.error(s,{message:"Could not encrypt record.",send:!1,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.internal_error}}):s.error(s,{message:"Could not compress record.",send:!1,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.internal_error}}),!s.fail},n.session){var o=n.session.sp;switch(n.session.cipherSuite.initSecurityParameters(o),o.keys=M.generateKeys(n,o),r.read.macKey=e?o.keys.server_write_MAC_key:o.keys.client_write_MAC_key,r.write.macKey=e?o.keys.client_write_MAC_key:o.keys.server_write_MAC_key,n.session.cipherSuite.initConnectionState(r,n,o),o.compression_algorithm){case M.CompressionMethod.none:break;case M.CompressionMethod.deflate:r.read.compressFunction=dct,r.write.compressFunction=uct;break;default:throw new Error("Unsupported compression algorithm.")}}return r};M.createRandom=function(){var n=new Date,e=+n+n.getTimezoneOffset()*6e4,t=ke.util.createBuffer();return t.putInt32(e),t.putBytes(ke.random.getBytes(28)),t};M.createRecord=function(n,e){if(!e.data)return null;var t={type:e.type,version:{major:n.version.major,minor:n.version.minor},length:e.data.length(),fragment:e.data};return t};M.createAlert=function(n,e){var t=ke.util.createBuffer();return t.putByte(e.level),t.putByte(e.description),M.createRecord(n,{type:M.ContentType.alert,data:t})};M.createClientHello=function(n){n.session.clientHelloVersion={major:n.version.major,minor:n.version.minor};for(var e=ke.util.createBuffer(),t=0;t<n.cipherSuites.length;++t){var r=n.cipherSuites[t];e.putByte(r.id[0]),e.putByte(r.id[1])}var o=e.length(),s=ke.util.createBuffer();s.putByte(M.CompressionMethod.none);var a=s.length(),c=ke.util.createBuffer();if(n.virtualHost){var l=ke.util.createBuffer();l.putByte(0),l.putByte(0);var u=ke.util.createBuffer();u.putByte(0),wu(u,2,ke.util.createBuffer(n.virtualHost));var d=ke.util.createBuffer();wu(d,2,u),wu(l,2,d),c.putBuffer(l)}var p=c.length();p>0&&(p+=2);var f=n.session.id,m=f.length+1+2+4+28+2+o+1+a+p,h=ke.util.createBuffer();return h.putByte(M.HandshakeType.client_hello),h.putInt24(m),h.putByte(n.version.major),h.putByte(n.version.minor),h.putBytes(n.session.sp.client_random),wu(h,1,ke.util.createBuffer(f)),wu(h,2,e),wu(h,1,s),p>0&&wu(h,2,c),h};M.createServerHello=function(n){var e=n.session.id,t=e.length+1+2+4+28+2+1,r=ke.util.createBuffer();return r.putByte(M.HandshakeType.server_hello),r.putInt24(t),r.putByte(n.version.major),r.putByte(n.version.minor),r.putBytes(n.session.sp.server_random),wu(r,1,ke.util.createBuffer(e)),r.putByte(n.session.cipherSuite.id[0]),r.putByte(n.session.cipherSuite.id[1]),r.putByte(n.session.compressionMethod),r};M.createCertificate=function(n){var e=n.entity===M.ConnectionEnd.client,t=null;if(n.getCertificate){var r;e?r=n.session.certificateRequest:r=n.session.extensions.server_name.serverNameList,t=n.getCertificate(n,r)}var o=ke.util.createBuffer();if(t!==null)try{ke.util.isArray(t)||(t=[t]);for(var s=null,a=0;a<t.length;++a){var c=ke.pem.decode(t[a])[0];if(c.type!=="CERTIFICATE"&&c.type!=="X509 CERTIFICATE"&&c.type!=="TRUSTED CERTIFICATE"){var l=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw l.headerType=c.type,l}if(c.procType&&c.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var u=ke.util.createBuffer(c.body);s===null&&(s=ke.asn1.fromDer(u.bytes(),!1));var d=ke.util.createBuffer();wu(d,3,u),o.putBuffer(d)}t=ke.pki.certificateFromAsn1(s),e?n.session.clientCertificate=t:n.session.serverCertificate=t}catch(m){return n.error(n,{message:"Could not send certificate list.",cause:m,send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.bad_certificate}})}var p=3+o.length(),f=ke.util.createBuffer();return f.putByte(M.HandshakeType.certificate),f.putInt24(p),wu(f,3,o),f};M.createClientKeyExchange=function(n){var e=ke.util.createBuffer();e.putByte(n.session.clientHelloVersion.major),e.putByte(n.session.clientHelloVersion.minor),e.putBytes(ke.random.getBytes(46));var t=n.session.sp;t.pre_master_secret=e.getBytes();var r=n.session.serverCertificate.publicKey;e=r.encrypt(t.pre_master_secret);var o=e.length+2,s=ke.util.createBuffer();return s.putByte(M.HandshakeType.client_key_exchange),s.putInt24(o),s.putInt16(e.length),s.putBytes(e),s};M.createServerKeyExchange=function(n){var e=0,t=ke.util.createBuffer();return e>0&&(t.putByte(M.HandshakeType.server_key_exchange),t.putInt24(e)),t};M.getClientSignature=function(n,e){var t=ke.util.createBuffer();t.putBuffer(n.session.md5.digest()),t.putBuffer(n.session.sha1.digest()),t=t.getBytes(),n.getSignature=n.getSignature||function(r,o,s){var a=null;if(r.getPrivateKey)try{a=r.getPrivateKey(r,r.session.clientCertificate),a=ke.pki.privateKeyFromPem(a)}catch(c){r.error(r,{message:"Could not get private key.",cause:c,send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.internal_error}})}a===null?r.error(r,{message:"No private key set.",send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.internal_error}}):o=a.sign(o,null),s(r,o)},n.getSignature(n,t,e)};M.createCertificateVerify=function(n,e){var t=e.length+2,r=ke.util.createBuffer();return r.putByte(M.HandshakeType.certificate_verify),r.putInt24(t),r.putInt16(e.length),r.putBytes(e),r};M.createCertificateRequest=function(n){var e=ke.util.createBuffer();e.putByte(1);var t=ke.util.createBuffer();for(var r in n.caStore.certs){var o=n.caStore.certs[r],s=ke.pki.distinguishedNameToAsn1(o.subject),a=ke.asn1.toDer(s);t.putInt16(a.length()),t.putBuffer(a)}var c=1+e.length()+2+t.length(),l=ke.util.createBuffer();return l.putByte(M.HandshakeType.certificate_request),l.putInt24(c),wu(l,1,e),wu(l,2,t),l};M.createServerHelloDone=function(n){var e=ke.util.createBuffer();return e.putByte(M.HandshakeType.server_hello_done),e.putInt24(0),e};M.createChangeCipherSpec=function(){var n=ke.util.createBuffer();return n.putByte(1),n};M.createFinished=function(n){var e=ke.util.createBuffer();e.putBuffer(n.session.md5.digest()),e.putBuffer(n.session.sha1.digest());var t=n.entity===M.ConnectionEnd.client,r=n.session.sp,o=12,s=K7,a=t?"client finished":"server finished";e=s(r.master_secret,a,e.getBytes(),o);var c=ke.util.createBuffer();return c.putByte(M.HandshakeType.finished),c.putInt24(e.length()),c.putBuffer(e),c};M.createHeartbeat=function(n,e,t){typeof t>"u"&&(t=e.length);var r=ke.util.createBuffer();r.putByte(n),r.putInt16(t),r.putBytes(e);var o=r.length(),s=Math.max(16,o-t-3);return r.putBytes(ke.random.getBytes(s)),r};M.queue=function(n,e){if(e&&!(e.fragment.length()===0&&(e.type===M.ContentType.handshake||e.type===M.ContentType.alert||e.type===M.ContentType.change_cipher_spec))){if(e.type===M.ContentType.handshake){var t=e.fragment.bytes();n.session.md5.update(t),n.session.sha1.update(t),t=null}var r;if(e.fragment.length()<=M.MaxFragment)r=[e];else{r=[];for(var o=e.fragment.bytes();o.length>M.MaxFragment;)r.push(M.createRecord(n,{type:e.type,data:ke.util.createBuffer(o.slice(0,M.MaxFragment))})),o=o.slice(M.MaxFragment);o.length>0&&r.push(M.createRecord(n,{type:e.type,data:ke.util.createBuffer(o)}))}for(var s=0;s<r.length&&!n.fail;++s){var a=r[s],c=n.state.current.write;c.update(n,a)&&n.records.push(a)}}};M.flush=function(n){for(var e=0;e<n.records.length;++e){var t=n.records[e];n.tlsData.putByte(t.type),n.tlsData.putByte(t.version.major),n.tlsData.putByte(t.version.minor),n.tlsData.putInt16(t.fragment.length()),n.tlsData.putBuffer(n.records[e].fragment)}return n.records=[],n.tlsDataReady(n)};var fne=function(n){switch(n){case!0:return!0;case ke.pki.certificateError.bad_certificate:return M.Alert.Description.bad_certificate;case ke.pki.certificateError.unsupported_certificate:return M.Alert.Description.unsupported_certificate;case ke.pki.certificateError.certificate_revoked:return M.Alert.Description.certificate_revoked;case ke.pki.certificateError.certificate_expired:return M.Alert.Description.certificate_expired;case ke.pki.certificateError.certificate_unknown:return M.Alert.Description.certificate_unknown;case ke.pki.certificateError.unknown_ca:return M.Alert.Description.unknown_ca;default:return M.Alert.Description.bad_certificate}},kct=function(n){switch(n){case!0:return!0;case M.Alert.Description.bad_certificate:return ke.pki.certificateError.bad_certificate;case M.Alert.Description.unsupported_certificate:return ke.pki.certificateError.unsupported_certificate;case M.Alert.Description.certificate_revoked:return ke.pki.certificateError.certificate_revoked;case M.Alert.Description.certificate_expired:return ke.pki.certificateError.certificate_expired;case M.Alert.Description.certificate_unknown:return ke.pki.certificateError.certificate_unknown;case M.Alert.Description.unknown_ca:return ke.pki.certificateError.unknown_ca;default:return ke.pki.certificateError.bad_certificate}};M.verifyCertificateChain=function(n,e){try{var t={};for(var r in n.verifyOptions)t[r]=n.verifyOptions[r];t.verify=function(s,a,c){var l=fne(s),u=n.verify(n,s,a,c);if(u!==!0){if(typeof u=="object"&&!ke.util.isArray(u)){var d=new Error("The application rejected the certificate.");throw d.send=!0,d.alert={level:M.Alert.Level.fatal,description:M.Alert.Description.bad_certificate},u.message&&(d.message=u.message),u.alert&&(d.alert.description=u.alert),d}u!==s&&(u=kct(u))}return u},ke.pki.verifyCertificateChain(n.caStore,e,t)}catch(s){var o=s;(typeof o!="object"||ke.util.isArray(o))&&(o={send:!0,alert:{level:M.Alert.Level.fatal,description:fne(s)}}),"send"in o||(o.send=!0),"alert"in o||(o.alert={level:M.Alert.Level.fatal,description:fne(o.error)}),n.error(n,o)}return!n.fail};M.createSessionCache=function(n,e){var t=null;if(n&&n.getSession&&n.setSession&&n.order)t=n;else{t={},t.cache=n||{},t.capacity=Math.max(e||100,1),t.order=[];for(var r in n)t.order.length<=e?t.order.push(r):delete n[r];t.getSession=function(o){var s=null,a=null;if(o?a=ke.util.bytesToHex(o):t.order.length>0&&(a=t.order[0]),a!==null&&a in t.cache){s=t.cache[a],delete t.cache[a];for(var c in t.order)if(t.order[c]===a){t.order.splice(c,1);break}}return s},t.setSession=function(o,s){if(t.order.length===t.capacity){var a=t.order.shift();delete t.cache[a]}var a=ke.util.bytesToHex(o);t.order.push(a),t.cache[a]=s}}return t};M.createConnection=function(n){var e=null;n.caStore?ke.util.isArray(n.caStore)?e=ke.pki.createCaStore(n.caStore):e=n.caStore:e=ke.pki.createCaStore();var t=n.cipherSuites||null;if(t===null){t=[];for(var r in M.CipherSuites)t.push(M.CipherSuites[r])}var o=n.server?M.ConnectionEnd.server:M.ConnectionEnd.client,s=n.sessionCache?M.createSessionCache(n.sessionCache):null,a={version:{major:M.Version.major,minor:M.Version.minor},entity:o,sessionId:n.sessionId,caStore:e,sessionCache:s,cipherSuites:t,connected:n.connected,virtualHost:n.virtualHost||null,verifyClient:n.verifyClient||!1,verify:n.verify||function(d,p,f,m){return p},verifyOptions:n.verifyOptions||{},getCertificate:n.getCertificate||null,getPrivateKey:n.getPrivateKey||null,getSignature:n.getSignature||null,input:ke.util.createBuffer(),tlsData:ke.util.createBuffer(),data:ke.util.createBuffer(),tlsDataReady:n.tlsDataReady,dataReady:n.dataReady,heartbeatReceived:n.heartbeatReceived,closed:n.closed,error:function(d,p){p.origin=p.origin||(d.entity===M.ConnectionEnd.client?"client":"server"),p.send&&(M.queue(d,M.createAlert(d,p.alert)),M.flush(d));var f=p.fatal!==!1;f&&(d.fail=!0),n.error(d,p),f&&d.close(!1)},deflate:n.deflate||null,inflate:n.inflate||null};a.reset=function(d){a.version={major:M.Version.major,minor:M.Version.minor},a.record=null,a.session=null,a.peerCertificate=null,a.state={pending:null,current:null},a.expect=a.entity===M.ConnectionEnd.client?pct:bct,a.fragmented=null,a.records=[],a.open=!1,a.handshakes=0,a.handshaking=!1,a.isConnected=!1,a.fail=!(d||typeof d>"u"),a.input.clear(),a.tlsData.clear(),a.data.clear(),a.state.current=M.createConnectionState(a)},a.reset();var c=function(d,p){var f=p.type-M.ContentType.change_cipher_spec,m=gne[d.entity][d.expect];f in m?m[f](d,p):M.handleUnexpected(d,p)},l=function(d){var p=0,f=d.input,m=f.length();if(m<5)p=5-m;else{d.record={type:f.getByte(),version:{major:f.getByte(),minor:f.getByte()},length:f.getInt16(),fragment:ke.util.createBuffer(),ready:!1};var h=d.record.version.major===d.version.major;h&&d.session&&d.session.version&&(h=d.record.version.minor===d.version.minor),h||d.error(d,{message:"Incompatible TLS version.",send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.protocol_version}})}return p},u=function(d){var p=0,f=d.input,m=f.length();if(m<d.record.length)p=d.record.length-m;else{d.record.fragment.putBytes(f.getBytes(d.record.length)),f.compact();var h=d.state.current.read;h.update(d,d.record)&&(d.fragmented!==null&&(d.fragmented.type===d.record.type?(d.fragmented.fragment.putBuffer(d.record.fragment),d.record=d.fragmented):d.error(d,{message:"Invalid fragmented record.",send:!0,alert:{level:M.Alert.Level.fatal,description:M.Alert.Description.unexpected_message}})),d.record.ready=!0)}return p};return a.handshake=function(d){if(a.entity!==M.ConnectionEnd.client)a.error(a,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(a.handshaking)a.error(a,{message:"Handshake already in progress.",fatal:!1});else{a.fail&&!a.open&&a.handshakes===0&&(a.fail=!1),a.handshaking=!0,d=d||"";var p=null;d.length>0&&(a.sessionCache&&(p=a.sessionCache.getSession(d)),p===null&&(d="")),d.length===0&&a.sessionCache&&(p=a.sessionCache.getSession(),p!==null&&(d=p.id)),a.session={id:d,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:ke.md.md5.create(),sha1:ke.md.sha1.create()},p&&(a.version=p.version,a.session.sp=p.sp),a.session.sp.client_random=M.createRandom().getBytes(),a.open=!0,M.queue(a,M.createRecord(a,{type:M.ContentType.handshake,data:M.createClientHello(a)})),M.flush(a)}},a.process=function(d){var p=0;return d&&a.input.putBytes(d),a.fail||(a.record!==null&&a.record.ready&&a.record.fragment.isEmpty()&&(a.record=null),a.record===null&&(p=l(a)),!a.fail&&a.record!==null&&!a.record.ready&&(p=u(a)),!a.fail&&a.record!==null&&a.record.ready&&c(a,a.record)),p},a.prepare=function(d){return M.queue(a,M.createRecord(a,{type:M.ContentType.application_data,data:ke.util.createBuffer(d)})),M.flush(a)},a.prepareHeartbeatRequest=function(d,p){return d instanceof ke.util.ByteBuffer&&(d=d.bytes()),typeof p>"u"&&(p=d.length),a.expectedHeartbeatPayload=d,M.queue(a,M.createRecord(a,{type:M.ContentType.heartbeat,data:M.createHeartbeat(M.HeartbeatMessageType.heartbeat_request,d,p)})),M.flush(a)},a.close=function(d){if(!a.fail&&a.sessionCache&&a.session){var p={id:a.session.id,version:a.session.version,sp:a.session.sp};p.sp.keys=null,a.sessionCache.setSession(p.id,p)}a.open&&(a.open=!1,a.input.clear(),(a.isConnected||a.handshaking)&&(a.isConnected=a.handshaking=!1,M.queue(a,M.createAlert(a,{level:M.Alert.Level.warning,description:M.Alert.Description.close_notify})),M.flush(a)),a.closed(a)),a.reset(d)},a};DEe.exports=ke.tls=ke.tls||{};for($7 in M)typeof M[$7]!="function"&&(ke.tls[$7]=M[$7]);var $7;ke.tls.prf_tls1=K7;ke.tls.hmac_sha1=lct;ke.tls.createSessionCache=M.createSessionCache;ke.tls.createConnection=M.createConnection});var OEe=P((kRn,LEe)=>{var Ty=In();vy();vne();var ku=LEe.exports=Ty.tls;ku.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(n){n.bulk_cipher_algorithm=ku.BulkCipherAlgorithm.aes,n.cipher_type=ku.CipherType.block,n.enc_key_length=16,n.block_length=16,n.fixed_iv_length=16,n.record_iv_length=16,n.mac_algorithm=ku.MACAlgorithm.hmac_sha1,n.mac_length=20,n.mac_key_length=20},initConnectionState:NEe};ku.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(n){n.bulk_cipher_algorithm=ku.BulkCipherAlgorithm.aes,n.cipher_type=ku.CipherType.block,n.enc_key_length=32,n.block_length=16,n.fixed_iv_length=16,n.record_iv_length=16,n.mac_algorithm=ku.MACAlgorithm.hmac_sha1,n.mac_length=20,n.mac_key_length=20},initConnectionState:NEe};function NEe(n,e,t){var r=e.entity===Ty.tls.ConnectionEnd.client;n.read.cipherState={init:!1,cipher:Ty.cipher.createDecipher("AES-CBC",r?t.keys.server_write_key:t.keys.client_write_key),iv:r?t.keys.server_write_IV:t.keys.client_write_IV},n.write.cipherState={init:!1,cipher:Ty.cipher.createCipher("AES-CBC",r?t.keys.client_write_key:t.keys.server_write_key),iv:r?t.keys.client_write_IV:t.keys.server_write_IV},n.read.cipherFunction=Dct,n.write.cipherFunction=Rct,n.read.macLength=n.write.macLength=t.mac_length,n.read.macFunction=n.write.macFunction=ku.hmac_sha1}function Rct(n,e){var t=!1,r=e.macFunction(e.macKey,e.sequenceNumber,n);n.fragment.putBytes(r),e.updateSequenceNumber();var o;n.version.minor===ku.Versions.TLS_1_0.minor?o=e.cipherState.init?null:e.cipherState.iv:o=Ty.random.getBytesSync(16),e.cipherState.init=!0;var s=e.cipherState.cipher;return s.start({iv:o}),n.version.minor>=ku.Versions.TLS_1_1.minor&&s.output.putBytes(o),s.update(n.fragment),s.finish(Pct)&&(n.fragment=s.output,n.length=n.fragment.length(),t=!0),t}function Pct(n,e,t){if(!t){var r=n-e.length()%n;e.fillWithByte(r-1,r)}return!0}function Act(n,e,t){var r=!0;if(t){for(var o=e.length(),s=e.last(),a=o-1-s;a<o-1;++a)r=r&&e.at(a)==s;r&&e.truncate(s+1)}return r}function Dct(n,e){var t=!1,r;n.version.minor===ku.Versions.TLS_1_0.minor?r=e.cipherState.init?null:e.cipherState.iv:r=n.fragment.getBytes(16),e.cipherState.init=!0;var o=e.cipherState.cipher;o.start({iv:r}),o.update(n.fragment),t=o.finish(Act);var s=e.macLength,a=Ty.random.getBytesSync(s),c=o.output.length();c>=s?(n.fragment=o.output.getBytes(c-s),a=o.output.getBytes(s)):n.fragment=o.output.getBytes(),n.fragment=Ty.util.createBuffer(n.fragment),n.length=n.fragment.length();var l=e.macFunction(e.macKey,e.sequenceNumber,n);return e.updateSequenceNumber(),t=Nct(e.macKey,a,l)&&t,t}function Nct(n,e,t){var r=Ty.hmac.create();return r.start("SHA1",n),r.update(e),e=r.digest().getBytes(),r.start(null,null),r.update(t),t=r.digest().getBytes(),e===t}});var _ne=P((RRn,BEe)=>{var ci=In();Ef();rr();var eO=BEe.exports=ci.sha512=ci.sha512||{};ci.md.sha512=ci.md.algorithms.sha512=eO;var FEe=ci.sha384=ci.sha512.sha384=ci.sha512.sha384||{};FEe.create=function(){return eO.create("SHA-384")};ci.md.sha384=ci.md.algorithms.sha384=FEe;ci.sha512.sha256=ci.sha512.sha256||{create:function(){return eO.create("SHA-512/256")}};ci.md["sha512/256"]=ci.md.algorithms["sha512/256"]=ci.sha512.sha256;ci.sha512.sha224=ci.sha512.sha224||{create:function(){return eO.create("SHA-512/224")}};ci.md["sha512/224"]=ci.md.algorithms["sha512/224"]=ci.sha512.sha224;eO.create=function(n){if(UEe||Lct(),typeof n>"u"&&(n="SHA-512"),!(n in cS))throw new Error("Invalid SHA-512 algorithm: "+n);for(var e=cS[n],t=null,r=ci.util.createBuffer(),o=new Array(80),s=0;s<80;++s)o[s]=new Array(2);var a=64;switch(n){case"SHA-384":a=48;break;case"SHA-512/256":a=32;break;case"SHA-512/224":a=28;break}var c={algorithm:n.replace("-","").toLowerCase(),blockLength:128,digestLength:a,messageLength:0,fullMessageLength:null,messageLengthSize:16};return c.start=function(){c.messageLength=0,c.fullMessageLength=c.messageLength128=[];for(var l=c.messageLengthSize/4,u=0;u<l;++u)c.fullMessageLength.push(0);r=ci.util.createBuffer(),t=new Array(e.length);for(var u=0;u<e.length;++u)t[u]=e[u].slice(0);return c},c.start(),c.update=function(l,u){u==="utf8"&&(l=ci.util.encodeUtf8(l));var d=l.length;c.messageLength+=d,d=[d/4294967296>>>0,d>>>0];for(var p=c.fullMessageLength.length-1;p>=0;--p)c.fullMessageLength[p]+=d[1],d[1]=d[0]+(c.fullMessageLength[p]/4294967296>>>0),c.fullMessageLength[p]=c.fullMessageLength[p]>>>0,d[0]=d[1]/4294967296>>>0;return r.putBytes(l),MEe(t,o,r),(r.read>2048||r.length()===0)&&r.compact(),c},c.digest=function(){var l=ci.util.createBuffer();l.putBytes(r.bytes());var u=c.fullMessageLength[c.fullMessageLength.length-1]+c.messageLengthSize,d=u&c.blockLength-1;l.putBytes(yne.substr(0,c.blockLength-d));for(var p,f,m=c.fullMessageLength[0]*8,h=0;h<c.fullMessageLength.length-1;++h)p=c.fullMessageLength[h+1]*8,f=p/4294967296>>>0,m+=f,l.putInt32(m>>>0),m=p>>>0;l.putInt32(m);for(var g=new Array(t.length),h=0;h<t.length;++h)g[h]=t[h].slice(0);MEe(g,o,l);var y=ci.util.createBuffer(),b;n==="SHA-512"?b=g.length:n==="SHA-384"?b=g.length-2:b=g.length-4;for(var h=0;h<b;++h)y.putInt32(g[h][0]),(h!==b-1||n!=="SHA-512/224")&&y.putInt32(g[h][1]);return y},c};var yne=null,UEe=!1,bne=null,cS=null;function Lct(){yne="\x80",yne+=ci.util.fillString("\0",128),bne=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],cS={},cS["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],cS["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],cS["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],cS["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],UEe=!0}function MEe(n,e,t){for(var r,o,s,a,c,l,u,d,p,f,m,h,g,y,b,_,x,I,S,w,R,k,V,F,K,$,j,D,A,B,U,W,ae,Y,X,Se=t.length();Se>=128;){for(A=0;A<16;++A)e[A][0]=t.getInt32()>>>0,e[A][1]=t.getInt32()>>>0;for(;A<80;++A)W=e[A-2],B=W[0],U=W[1],r=((B>>>19|U<<13)^(U>>>29|B<<3)^B>>>6)>>>0,o=((B<<13|U>>>19)^(U<<3|B>>>29)^(B<<26|U>>>6))>>>0,Y=e[A-15],B=Y[0],U=Y[1],s=((B>>>1|U<<31)^(B>>>8|U<<24)^B>>>7)>>>0,a=((B<<31|U>>>1)^(B<<24|U>>>8)^(B<<25|U>>>7))>>>0,ae=e[A-7],X=e[A-16],U=o+ae[1]+a+X[1],e[A][0]=r+ae[0]+s+X[0]+(U/4294967296>>>0)>>>0,e[A][1]=U>>>0;for(g=n[0][0],y=n[0][1],b=n[1][0],_=n[1][1],x=n[2][0],I=n[2][1],S=n[3][0],w=n[3][1],R=n[4][0],k=n[4][1],V=n[5][0],F=n[5][1],K=n[6][0],$=n[6][1],j=n[7][0],D=n[7][1],A=0;A<80;++A)u=((R>>>14|k<<18)^(R>>>18|k<<14)^(k>>>9|R<<23))>>>0,d=((R<<18|k>>>14)^(R<<14|k>>>18)^(k<<23|R>>>9))>>>0,p=(K^R&(V^K))>>>0,f=($^k&(F^$))>>>0,c=((g>>>28|y<<4)^(y>>>2|g<<30)^(y>>>7|g<<25))>>>0,l=((g<<4|y>>>28)^(y<<30|g>>>2)^(y<<25|g>>>7))>>>0,m=(g&b|x&(g^b))>>>0,h=(y&_|I&(y^_))>>>0,U=D+d+f+bne[A][1]+e[A][1],r=j+u+p+bne[A][0]+e[A][0]+(U/4294967296>>>0)>>>0,o=U>>>0,U=l+h,s=c+m+(U/4294967296>>>0)>>>0,a=U>>>0,j=K,D=$,K=V,$=F,V=R,F=k,U=w+o,R=S+r+(U/4294967296>>>0)>>>0,k=U>>>0,S=x,w=I,x=b,I=_,b=g,_=y,U=o+a,g=r+s+(U/4294967296>>>0)>>>0,y=U>>>0;U=n[0][1]+y,n[0][0]=n[0][0]+g+(U/4294967296>>>0)>>>0,n[0][1]=U>>>0,U=n[1][1]+_,n[1][0]=n[1][0]+b+(U/4294967296>>>0)>>>0,n[1][1]=U>>>0,U=n[2][1]+I,n[2][0]=n[2][0]+x+(U/4294967296>>>0)>>>0,n[2][1]=U>>>0,U=n[3][1]+w,n[3][0]=n[3][0]+S+(U/4294967296>>>0)>>>0,n[3][1]=U>>>0,U=n[4][1]+k,n[4][0]=n[4][0]+R+(U/4294967296>>>0)>>>0,n[4][1]=U>>>0,U=n[5][1]+F,n[5][0]=n[5][0]+V+(U/4294967296>>>0)>>>0,n[5][1]=U>>>0,U=n[6][1]+$,n[6][0]=n[6][0]+K+(U/4294967296>>>0)>>>0,n[6][1]=U>>>0,U=n[7][1]+D,n[7][0]=n[7][0]+j+(U/4294967296>>>0)>>>0,n[7][1]=U>>>0,Se-=128}}});var qEe=P(xne=>{var Oct=In();Qd();var Ns=Oct.asn1;xne.privateKeyValidator={name:"PrivateKeyInfo",tagClass:Ns.Class.UNIVERSAL,type:Ns.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:Ns.Class.UNIVERSAL,type:Ns.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:Ns.Class.UNIVERSAL,type:Ns.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Ns.Class.UNIVERSAL,type:Ns.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:Ns.Class.UNIVERSAL,type:Ns.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]};xne.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:Ns.Class.UNIVERSAL,type:Ns.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:Ns.Class.UNIVERSAL,type:Ns.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Ns.Class.UNIVERSAL,type:Ns.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:Ns.Class.UNIVERSAL,type:Ns.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}});var ZEe=P((ARn,JEe)=>{var ta=In();QL();Iu();_ne();rr();var $Ee=qEe(),Mct=$Ee.publicKeyValidator,Fct=$Ee.privateKeyValidator;typeof jEe>"u"&&(jEe=ta.jsbn.BigInteger);var jEe,Tne=ta.util.ByteBuffer,Uc=typeof Buffer>"u"?Uint8Array:Buffer;ta.pki=ta.pki||{};JEe.exports=ta.pki.ed25519=ta.ed25519=ta.ed25519||{};var Fn=ta.ed25519;Fn.constants={};Fn.constants.PUBLIC_KEY_BYTE_LENGTH=32;Fn.constants.PRIVATE_KEY_BYTE_LENGTH=64;Fn.constants.SEED_BYTE_LENGTH=32;Fn.constants.SIGN_BYTE_LENGTH=64;Fn.constants.HASH_BYTE_LENGTH=64;Fn.generateKeyPair=function(n){n=n||{};var e=n.seed;if(e===void 0)e=ta.random.getBytesSync(Fn.constants.SEED_BYTE_LENGTH);else if(typeof e=="string"){if(e.length!==Fn.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+Fn.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');e=Gh({message:e,encoding:"binary"});for(var t=new Uc(Fn.constants.PUBLIC_KEY_BYTE_LENGTH),r=new Uc(Fn.constants.PRIVATE_KEY_BYTE_LENGTH),o=0;o<32;++o)r[o]=e[o];return jct(t,r),{publicKey:t,privateKey:r}};Fn.privateKeyFromAsn1=function(n){var e={},t=[],r=ta.asn1.validate(n,Fct,e,t);if(!r){var o=new Error("Invalid Key.");throw o.errors=t,o}var s=ta.asn1.derToOid(e.privateKeyOid),a=ta.oids.EdDSA25519;if(s!==a)throw new Error('Invalid OID "'+s+'"; OID must be "'+a+'".');var c=e.privateKey,l=Gh({message:ta.asn1.fromDer(c).value,encoding:"binary"});return{privateKeyBytes:l}};Fn.publicKeyFromAsn1=function(n){var e={},t=[],r=ta.asn1.validate(n,Mct,e,t);if(!r){var o=new Error("Invalid Key.");throw o.errors=t,o}var s=ta.asn1.derToOid(e.publicKeyOid),a=ta.oids.EdDSA25519;if(s!==a)throw new Error('Invalid OID "'+s+'"; OID must be "'+a+'".');var c=e.ed25519PublicKey;if(c.length!==Fn.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return Gh({message:c,encoding:"binary"})};Fn.publicKeyFromPrivateKey=function(n){n=n||{};var e=Gh({message:n.privateKey,encoding:"binary"});if(e.length!==Fn.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+Fn.constants.PRIVATE_KEY_BYTE_LENGTH);for(var t=new Uc(Fn.constants.PUBLIC_KEY_BYTE_LENGTH),r=0;r<t.length;++r)t[r]=e[32+r];return t};Fn.sign=function(n){n=n||{};var e=Gh(n),t=Gh({message:n.privateKey,encoding:"binary"});if(t.length===Fn.constants.SEED_BYTE_LENGTH){var r=Fn.generateKeyPair({seed:t});t=r.privateKey}else if(t.length!==Fn.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+Fn.constants.SEED_BYTE_LENGTH+" or "+Fn.constants.PRIVATE_KEY_BYTE_LENGTH);var o=new Uc(Fn.constants.SIGN_BYTE_LENGTH+e.length);Hct(o,e,e.length,t);for(var s=new Uc(Fn.constants.SIGN_BYTE_LENGTH),a=0;a<s.length;++a)s[a]=o[a];return s};Fn.verify=function(n){n=n||{};var e=Gh(n);if(n.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var t=Gh({message:n.signature,encoding:"binary"});if(t.length!==Fn.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+Fn.constants.SIGN_BYTE_LENGTH);var r=Gh({message:n.publicKey,encoding:"binary"});if(r.length!==Fn.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+Fn.constants.PUBLIC_KEY_BYTE_LENGTH);var o=new Uc(Fn.constants.SIGN_BYTE_LENGTH+e.length),s=new Uc(Fn.constants.SIGN_BYTE_LENGTH+e.length),a;for(a=0;a<Fn.constants.SIGN_BYTE_LENGTH;++a)o[a]=t[a];for(a=0;a<e.length;++a)o[a+Fn.constants.SIGN_BYTE_LENGTH]=e[a];return Vct(s,o,o.length,r)>=0};function Gh(n){var e=n.message;if(e instanceof Uint8Array||e instanceof Uc)return e;var t=n.encoding;if(e===void 0)if(n.md)e=n.md.digest().getBytes(),t="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof e=="string"&&!t)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.from(e,t);e=new Tne(e,t)}else if(!(e instanceof Tne))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var r=new Uc(e.length()),o=0;o<r.length;++o)r[o]=e.at(o);return r}var Cne=Vt(),Y7=Vt([1]),Uct=Vt([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),Bct=Vt([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),HEe=Vt([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),VEe=Vt([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),Sne=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),qct=Vt([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function tO(n,e){var t=ta.md.sha512.create(),r=new Tne(n);t.update(r.getBytes(e),"binary");var o=t.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(o,"binary");for(var s=new Uc(Fn.constants.HASH_BYTE_LENGTH),a=0;a<64;++a)s[a]=o.charCodeAt(a);return s}function jct(n,e){var t=[Vt(),Vt(),Vt(),Vt()],r,o=tO(e,32);for(o[0]&=248,o[31]&=127,o[31]|=64,Rne(t,o),kne(n,t),r=0;r<32;++r)e[r+32]=n[r];return 0}function Hct(n,e,t,r){var o,s,a=new Float64Array(64),c=[Vt(),Vt(),Vt(),Vt()],l=tO(r,32);l[0]&=248,l[31]&=127,l[31]|=64;var u=t+64;for(o=0;o<t;++o)n[64+o]=e[o];for(o=0;o<32;++o)n[32+o]=l[32+o];var d=tO(n.subarray(32),t+32);for(Ene(d),Rne(c,d),kne(n,c),o=32;o<64;++o)n[o]=r[o];var p=tO(n,t+64);for(Ene(p),o=32;o<64;++o)a[o]=0;for(o=0;o<32;++o)a[o]=d[o];for(o=0;o<32;++o)for(s=0;s<32;s++)a[o+s]+=p[o]*l[s];return WEe(n.subarray(32),a),u}function Vct(n,e,t,r){var o,s,a=new Uc(32),c=[Vt(),Vt(),Vt(),Vt()],l=[Vt(),Vt(),Vt(),Vt()];if(s=-1,t<64||Gct(l,r))return-1;for(o=0;o<t;++o)n[o]=e[o];for(o=0;o<32;++o)n[o+32]=r[o];var u=tO(n,t);if(Ene(u),QEe(c,l,u),Rne(l,e.subarray(32)),wne(c,l),kne(a,c),t-=64,KEe(e,0,a,0)){for(o=0;o<t;++o)n[o]=0;return-1}for(o=0;o<t;++o)n[o]=e[o+64];return s=t,s}function WEe(n,e){var t,r,o,s;for(r=63;r>=32;--r){for(t=0,o=r-32,s=r-12;o<s;++o)e[o]+=t-16*e[r]*Sne[o-(r-32)],t=e[o]+128>>8,e[o]-=t*256;e[o]+=t,e[r]=0}for(t=0,o=0;o<32;++o)e[o]+=t-(e[31]>>4)*Sne[o],t=e[o]>>8,e[o]&=255;for(o=0;o<32;++o)e[o]-=t*Sne[o];for(r=0;r<32;++r)e[r+1]+=e[r]>>8,n[r]=e[r]&255}function Ene(n){for(var e=new Float64Array(64),t=0;t<64;++t)e[t]=n[t],n[t]=0;WEe(n,e)}function wne(n,e){var t=Vt(),r=Vt(),o=Vt(),s=Vt(),a=Vt(),c=Vt(),l=Vt(),u=Vt(),d=Vt();_w(t,n[1],n[0]),_w(d,e[1],e[0]),jr(t,t,d),bw(r,n[0],n[1]),bw(d,e[0],e[1]),jr(r,r,d),jr(o,n[3],e[3]),jr(o,o,Bct),jr(s,n[2],e[2]),bw(s,s,s),_w(a,r,t),_w(c,s,o),bw(l,s,o),bw(u,r,t),jr(n[0],a,c),jr(n[1],u,l),jr(n[2],l,c),jr(n[3],a,u)}function GEe(n,e,t){for(var r=0;r<4;++r)XEe(n[r],e[r],t)}function kne(n,e){var t=Vt(),r=Vt(),o=Vt();Kct(o,e[2]),jr(t,e[0],o),jr(r,e[1],o),Q7(n,r),n[31]^=YEe(t)<<7}function Q7(n,e){var t,r,o,s=Vt(),a=Vt();for(t=0;t<16;++t)a[t]=e[t];for(Ine(a),Ine(a),Ine(a),r=0;r<2;++r){for(s[0]=a[0]-65517,t=1;t<15;++t)s[t]=a[t]-65535-(s[t-1]>>16&1),s[t-1]&=65535;s[15]=a[15]-32767-(s[14]>>16&1),o=s[15]>>16&1,s[14]&=65535,XEe(a,s,1-o)}for(t=0;t<16;t++)n[2*t]=a[t]&255,n[2*t+1]=a[t]>>8}function Gct(n,e){var t=Vt(),r=Vt(),o=Vt(),s=Vt(),a=Vt(),c=Vt(),l=Vt();return Cy(n[2],Y7),zct(n[1],e),lS(o,n[1]),jr(s,o,Uct),_w(o,o,n[2]),bw(s,n[2],s),lS(a,s),lS(c,a),jr(l,c,a),jr(t,l,o),jr(t,t,s),$ct(t,t),jr(t,t,o),jr(t,t,s),jr(t,t,s),jr(n[0],t,s),lS(r,n[0]),jr(r,r,s),zEe(r,o)&&jr(n[0],n[0],qct),lS(r,n[0]),jr(r,r,s),zEe(r,o)?-1:(YEe(n[0])===e[31]>>7&&_w(n[0],Cne,n[0]),jr(n[3],n[0],n[1]),0)}function zct(n,e){var t;for(t=0;t<16;++t)n[t]=e[2*t]+(e[2*t+1]<<8);n[15]&=32767}function $ct(n,e){var t=Vt(),r;for(r=0;r<16;++r)t[r]=e[r];for(r=250;r>=0;--r)lS(t,t),r!==1&&jr(t,t,e);for(r=0;r<16;++r)n[r]=t[r]}function zEe(n,e){var t=new Uc(32),r=new Uc(32);return Q7(t,n),Q7(r,e),KEe(t,0,r,0)}function KEe(n,e,t,r){return Wct(n,e,t,r,32)}function Wct(n,e,t,r,o){var s,a=0;for(s=0;s<o;++s)a|=n[e+s]^t[r+s];return(1&a-1>>>8)-1}function YEe(n){var e=new Uc(32);return Q7(e,n),e[0]&1}function QEe(n,e,t){var r,o;for(Cy(n[0],Cne),Cy(n[1],Y7),Cy(n[2],Y7),Cy(n[3],Cne),o=255;o>=0;--o)r=t[o/8|0]>>(o&7)&1,GEe(n,e,r),wne(e,n),wne(n,n),GEe(n,e,r)}function Rne(n,e){var t=[Vt(),Vt(),Vt(),Vt()];Cy(t[0],HEe),Cy(t[1],VEe),Cy(t[2],Y7),jr(t[3],HEe,VEe),QEe(n,t,e)}function Cy(n,e){var t;for(t=0;t<16;t++)n[t]=e[t]|0}function Kct(n,e){var t=Vt(),r;for(r=0;r<16;++r)t[r]=e[r];for(r=253;r>=0;--r)lS(t,t),r!==2&&r!==4&&jr(t,t,e);for(r=0;r<16;++r)n[r]=t[r]}function Ine(n){var e,t,r=1;for(e=0;e<16;++e)t=n[e]+r+65535,r=Math.floor(t/65536),n[e]=t-r*65536;n[0]+=r-1+37*(r-1)}function XEe(n,e,t){for(var r,o=~(t-1),s=0;s<16;++s)r=o&(n[s]^e[s]),n[s]^=r,e[s]^=r}function Vt(n){var e,t=new Float64Array(16);if(n)for(e=0;e<n.length;++e)t[e]=n[e];return t}function bw(n,e,t){for(var r=0;r<16;++r)n[r]=e[r]+t[r]}function _w(n,e,t){for(var r=0;r<16;++r)n[r]=e[r]-t[r]}function lS(n,e){jr(n,e,e)}function jr(n,e,t){var r,o,s=0,a=0,c=0,l=0,u=0,d=0,p=0,f=0,m=0,h=0,g=0,y=0,b=0,_=0,x=0,I=0,S=0,w=0,R=0,k=0,V=0,F=0,K=0,$=0,j=0,D=0,A=0,B=0,U=0,W=0,ae=0,Y=t[0],X=t[1],Se=t[2],te=t[3],Ie=t[4],Xe=t[5],Ut=t[6],Nn=t[7],xe=t[8],mt=t[9],G=t[10],de=t[11],me=t[12],Ne=t[13],Ee=t[14],St=t[15];r=e[0],s+=r*Y,a+=r*X,c+=r*Se,l+=r*te,u+=r*Ie,d+=r*Xe,p+=r*Ut,f+=r*Nn,m+=r*xe,h+=r*mt,g+=r*G,y+=r*de,b+=r*me,_+=r*Ne,x+=r*Ee,I+=r*St,r=e[1],a+=r*Y,c+=r*X,l+=r*Se,u+=r*te,d+=r*Ie,p+=r*Xe,f+=r*Ut,m+=r*Nn,h+=r*xe,g+=r*mt,y+=r*G,b+=r*de,_+=r*me,x+=r*Ne,I+=r*Ee,S+=r*St,r=e[2],c+=r*Y,l+=r*X,u+=r*Se,d+=r*te,p+=r*Ie,f+=r*Xe,m+=r*Ut,h+=r*Nn,g+=r*xe,y+=r*mt,b+=r*G,_+=r*de,x+=r*me,I+=r*Ne,S+=r*Ee,w+=r*St,r=e[3],l+=r*Y,u+=r*X,d+=r*Se,p+=r*te,f+=r*Ie,m+=r*Xe,h+=r*Ut,g+=r*Nn,y+=r*xe,b+=r*mt,_+=r*G,x+=r*de,I+=r*me,S+=r*Ne,w+=r*Ee,R+=r*St,r=e[4],u+=r*Y,d+=r*X,p+=r*Se,f+=r*te,m+=r*Ie,h+=r*Xe,g+=r*Ut,y+=r*Nn,b+=r*xe,_+=r*mt,x+=r*G,I+=r*de,S+=r*me,w+=r*Ne,R+=r*Ee,k+=r*St,r=e[5],d+=r*Y,p+=r*X,f+=r*Se,m+=r*te,h+=r*Ie,g+=r*Xe,y+=r*Ut,b+=r*Nn,_+=r*xe,x+=r*mt,I+=r*G,S+=r*de,w+=r*me,R+=r*Ne,k+=r*Ee,V+=r*St,r=e[6],p+=r*Y,f+=r*X,m+=r*Se,h+=r*te,g+=r*Ie,y+=r*Xe,b+=r*Ut,_+=r*Nn,x+=r*xe,I+=r*mt,S+=r*G,w+=r*de,R+=r*me,k+=r*Ne,V+=r*Ee,F+=r*St,r=e[7],f+=r*Y,m+=r*X,h+=r*Se,g+=r*te,y+=r*Ie,b+=r*Xe,_+=r*Ut,x+=r*Nn,I+=r*xe,S+=r*mt,w+=r*G,R+=r*de,k+=r*me,V+=r*Ne,F+=r*Ee,K+=r*St,r=e[8],m+=r*Y,h+=r*X,g+=r*Se,y+=r*te,b+=r*Ie,_+=r*Xe,x+=r*Ut,I+=r*Nn,S+=r*xe,w+=r*mt,R+=r*G,k+=r*de,V+=r*me,F+=r*Ne,K+=r*Ee,$+=r*St,r=e[9],h+=r*Y,g+=r*X,y+=r*Se,b+=r*te,_+=r*Ie,x+=r*Xe,I+=r*Ut,S+=r*Nn,w+=r*xe,R+=r*mt,k+=r*G,V+=r*de,F+=r*me,K+=r*Ne,$+=r*Ee,j+=r*St,r=e[10],g+=r*Y,y+=r*X,b+=r*Se,_+=r*te,x+=r*Ie,I+=r*Xe,S+=r*Ut,w+=r*Nn,R+=r*xe,k+=r*mt,V+=r*G,F+=r*de,K+=r*me,$+=r*Ne,j+=r*Ee,D+=r*St,r=e[11],y+=r*Y,b+=r*X,_+=r*Se,x+=r*te,I+=r*Ie,S+=r*Xe,w+=r*Ut,R+=r*Nn,k+=r*xe,V+=r*mt,F+=r*G,K+=r*de,$+=r*me,j+=r*Ne,D+=r*Ee,A+=r*St,r=e[12],b+=r*Y,_+=r*X,x+=r*Se,I+=r*te,S+=r*Ie,w+=r*Xe,R+=r*Ut,k+=r*Nn,V+=r*xe,F+=r*mt,K+=r*G,$+=r*de,j+=r*me,D+=r*Ne,A+=r*Ee,B+=r*St,r=e[13],_+=r*Y,x+=r*X,I+=r*Se,S+=r*te,w+=r*Ie,R+=r*Xe,k+=r*Ut,V+=r*Nn,F+=r*xe,K+=r*mt,$+=r*G,j+=r*de,D+=r*me,A+=r*Ne,B+=r*Ee,U+=r*St,r=e[14],x+=r*Y,I+=r*X,S+=r*Se,w+=r*te,R+=r*Ie,k+=r*Xe,V+=r*Ut,F+=r*Nn,K+=r*xe,$+=r*mt,j+=r*G,D+=r*de,A+=r*me,B+=r*Ne,U+=r*Ee,W+=r*St,r=e[15],I+=r*Y,S+=r*X,w+=r*Se,R+=r*te,k+=r*Ie,V+=r*Xe,F+=r*Ut,K+=r*Nn,$+=r*xe,j+=r*mt,D+=r*G,A+=r*de,B+=r*me,U+=r*Ne,W+=r*Ee,ae+=r*St,s+=38*S,a+=38*w,c+=38*R,l+=38*k,u+=38*V,d+=38*F,p+=38*K,f+=38*$,m+=38*j,h+=38*D,g+=38*A,y+=38*B,b+=38*U,_+=38*W,x+=38*ae,o=1,r=s+o+65535,o=Math.floor(r/65536),s=r-o*65536,r=a+o+65535,o=Math.floor(r/65536),a=r-o*65536,r=c+o+65535,o=Math.floor(r/65536),c=r-o*65536,r=l+o+65535,o=Math.floor(r/65536),l=r-o*65536,r=u+o+65535,o=Math.floor(r/65536),u=r-o*65536,r=d+o+65535,o=Math.floor(r/65536),d=r-o*65536,r=p+o+65535,o=Math.floor(r/65536),p=r-o*65536,r=f+o+65535,o=Math.floor(r/65536),f=r-o*65536,r=m+o+65535,o=Math.floor(r/65536),m=r-o*65536,r=h+o+65535,o=Math.floor(r/65536),h=r-o*65536,r=g+o+65535,o=Math.floor(r/65536),g=r-o*65536,r=y+o+65535,o=Math.floor(r/65536),y=r-o*65536,r=b+o+65535,o=Math.floor(r/65536),b=r-o*65536,r=_+o+65535,o=Math.floor(r/65536),_=r-o*65536,r=x+o+65535,o=Math.floor(r/65536),x=r-o*65536,r=I+o+65535,o=Math.floor(r/65536),I=r-o*65536,s+=o-1+37*(o-1),o=1,r=s+o+65535,o=Math.floor(r/65536),s=r-o*65536,r=a+o+65535,o=Math.floor(r/65536),a=r-o*65536,r=c+o+65535,o=Math.floor(r/65536),c=r-o*65536,r=l+o+65535,o=Math.floor(r/65536),l=r-o*65536,r=u+o+65535,o=Math.floor(r/65536),u=r-o*65536,r=d+o+65535,o=Math.floor(r/65536),d=r-o*65536,r=p+o+65535,o=Math.floor(r/65536),p=r-o*65536,r=f+o+65535,o=Math.floor(r/65536),f=r-o*65536,r=m+o+65535,o=Math.floor(r/65536),m=r-o*65536,r=h+o+65535,o=Math.floor(r/65536),h=r-o*65536,r=g+o+65535,o=Math.floor(r/65536),g=r-o*65536,r=y+o+65535,o=Math.floor(r/65536),y=r-o*65536,r=b+o+65535,o=Math.floor(r/65536),b=r-o*65536,r=_+o+65535,o=Math.floor(r/65536),_=r-o*65536,r=x+o+65535,o=Math.floor(r/65536),x=r-o*65536,r=I+o+65535,o=Math.floor(r/65536),I=r-o*65536,s+=o-1+37*(o-1),n[0]=s,n[1]=a,n[2]=c,n[3]=l,n[4]=u,n[5]=d,n[6]=p,n[7]=f,n[8]=m,n[9]=h,n[10]=g,n[11]=y,n[12]=b,n[13]=_,n[14]=x,n[15]=I}});var rwe=P((DRn,nwe)=>{var Pl=In();rr();Iu();QL();nwe.exports=Pl.kem=Pl.kem||{};var ewe=Pl.jsbn.BigInteger;Pl.kem.rsa={};Pl.kem.rsa.create=function(n,e){e=e||{};var t=e.prng||Pl.random,r={};return r.encrypt=function(o,s){var a=Math.ceil(o.n.bitLength()/8),c;do c=new ewe(Pl.util.bytesToHex(t.getBytesSync(a)),16).mod(o.n);while(c.compareTo(ewe.ONE)<=0);c=Pl.util.hexToBytes(c.toString(16));var l=a-c.length;l>0&&(c=Pl.util.fillString("\0",l)+c);var u=o.encrypt(c,"NONE"),d=n.generate(c,s);return{encapsulation:u,key:d}},r.decrypt=function(o,s,a){var c=o.decrypt(s,"NONE");return n.generate(c,a)},r};Pl.kem.kdf1=function(n,e){twe(this,n,0,e||n.digestLength)};Pl.kem.kdf2=function(n,e){twe(this,n,1,e||n.digestLength)};function twe(n,e,t,r){n.generate=function(o,s){for(var a=new Pl.util.ByteBuffer,c=Math.ceil(s/r)+t,l=new Pl.util.ByteBuffer,u=t;u<c;++u){l.putInt32(u),e.start(),e.update(o+l.getBytes());var d=e.digest();a.putBytes(d.getBytes(r))}return a.truncate(a.length()-s),a.getBytes()}}});var awe=P((NRn,swe)=>{var jn=In();rr();swe.exports=jn.log=jn.log||{};jn.log.levels=["none","error","warning","info","debug","verbose","max"];var X7={},Dne=[],rO=null;jn.log.LEVEL_LOCKED=2;jn.log.NO_LEVEL_CHECK=4;jn.log.INTERPOLATE=8;for(Lf=0;Lf<jn.log.levels.length;++Lf)Pne=jn.log.levels[Lf],X7[Pne]={index:Lf,name:Pne.toUpperCase()};var Pne,Lf;jn.log.logMessage=function(n){for(var e=X7[n.level].index,t=0;t<Dne.length;++t){var r=Dne[t];if(r.flags&jn.log.NO_LEVEL_CHECK)r.f(n);else{var o=X7[r.level].index;e<=o&&r.f(r,n)}}};jn.log.prepareStandard=function(n){"standard"in n||(n.standard=X7[n.level].name+" ["+n.category+"] "+n.message)};jn.log.prepareFull=function(n){if(!("full"in n)){var e=[n.message];e=e.concat([]),n.full=jn.util.format.apply(this,e)}};jn.log.prepareStandardFull=function(n){"standardFull"in n||(jn.log.prepareStandard(n),n.standardFull=n.standard)};for(Ane=["error","warning","info","debug","verbose"],Lf=0;Lf<Ane.length;++Lf)(function(e){jn.log[e]=function(t,r){var o=Array.prototype.slice.call(arguments).slice(2),s={timestamp:new Date,level:e,category:t,message:r,arguments:o};jn.log.logMessage(s)}})(Ane[Lf]);var Ane,Lf;jn.log.makeLogger=function(n){var e={flags:0,f:n};return jn.log.setLevel(e,"none"),e};jn.log.setLevel=function(n,e){var t=!1;if(n&&!(n.flags&jn.log.LEVEL_LOCKED))for(var r=0;r<jn.log.levels.length;++r){var o=jn.log.levels[r];if(e==o){n.level=e,t=!0;break}}return t};jn.log.lock=function(n,e){typeof e>"u"||e?n.flags|=jn.log.LEVEL_LOCKED:n.flags&=~jn.log.LEVEL_LOCKED};jn.log.addLogger=function(n){Dne.push(n)};typeof console<"u"&&"log"in console?(console.error&&console.warn&&console.info&&console.debug?(iwe={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},iO=function(n,e){jn.log.prepareStandard(e);var t=iwe[e.level],r=[e.standard];r=r.concat(e.arguments.slice()),t.apply(console,r)},xw=jn.log.makeLogger(iO)):(iO=function(e,t){jn.log.prepareStandardFull(t),console.log(t.standardFull)},xw=jn.log.makeLogger(iO)),jn.log.setLevel(xw,"debug"),jn.log.addLogger(xw),rO=xw):console={log:function(){}};var xw,iwe,iO;rO!==null&&typeof window<"u"&&window.location&&(nO=new URL(window.location.href).searchParams,nO.has("console.level")&&jn.log.setLevel(rO,nO.get("console.level").slice(-1)[0]),nO.has("console.lock")&&(owe=nO.get("console.lock").slice(-1)[0],owe=="true"&&jn.log.lock(rO)));var nO,owe;jn.log.consoleLogger=rO});var lwe=P((LRn,cwe)=>{cwe.exports=Ef();P7();mw();zte();_ne()});var pwe=P((ORn,dwe)=>{var et=In();vy();Qd();KL();yy();nS();one();Iu();rr();G7();var Z=et.asn1,Wa=dwe.exports=et.pkcs7=et.pkcs7||{};Wa.messageFromPem=function(n){var e=et.pem.decode(n)[0];if(e.type!=="PKCS7"){var t=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw t.headerType=e.type,t}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var r=Z.fromDer(e.body);return Wa.messageFromAsn1(r)};Wa.messageToPem=function(n,e){var t={type:"PKCS7",body:Z.toDer(n.toAsn1()).getBytes()};return et.pem.encode(t,{maxline:e})};Wa.messageFromAsn1=function(n){var e={},t=[];if(!Z.validate(n,Wa.asn1.contentInfoValidator,e,t)){var r=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw r.errors=t,r}var o=Z.derToOid(e.contentType),s;switch(o){case et.pki.oids.envelopedData:s=Wa.createEnvelopedData();break;case et.pki.oids.encryptedData:s=Wa.createEncryptedData();break;case et.pki.oids.signedData:s=Wa.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+o+" is not (yet) supported.")}return s.fromAsn1(e.content.value[0]),s};Wa.createSignedData=function(){var n=null;return n={type:et.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(r){if(Lne(n,r,Wa.asn1.signedDataValidator),n.certificates=[],n.crls=[],n.digestAlgorithmIdentifiers=[],n.contentInfo=null,n.signerInfos=[],n.rawCapture.certificates)for(var o=n.rawCapture.certificates.value,s=0;s<o.length;++s)n.certificates.push(et.pki.certificateFromAsn1(o[s]))},toAsn1:function(){n.contentInfo||n.sign();for(var r=[],o=0;o<n.certificates.length;++o)r.push(et.pki.certificateToAsn1(n.certificates[o]));var s=[],a=Z.create(Z.Class.CONTEXT_SPECIFIC,0,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.INTEGER,!1,Z.integerToDer(n.version).getBytes()),Z.create(Z.Class.UNIVERSAL,Z.Type.SET,!0,n.digestAlgorithmIdentifiers),n.contentInfo])]);return r.length>0&&a.value[0].value.push(Z.create(Z.Class.CONTEXT_SPECIFIC,0,!0,r)),s.length>0&&a.value[0].value.push(Z.create(Z.Class.CONTEXT_SPECIFIC,1,!0,s)),a.value[0].value.push(Z.create(Z.Class.UNIVERSAL,Z.Type.SET,!0,n.signerInfos)),Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.OID,!1,Z.oidToDer(n.type).getBytes()),a])},addSigner:function(r){var o=r.issuer,s=r.serialNumber;if(r.certificate){var a=r.certificate;typeof a=="string"&&(a=et.pki.certificateFromPem(a)),o=a.issuer.attributes,s=a.serialNumber}var c=r.key;if(!c)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof c=="string"&&(c=et.pki.privateKeyFromPem(c));var l=r.digestAlgorithm||et.pki.oids.sha1;switch(l){case et.pki.oids.sha1:case et.pki.oids.sha256:case et.pki.oids.sha384:case et.pki.oids.sha512:case et.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+l)}var u=r.authenticatedAttributes||[];if(u.length>0){for(var d=!1,p=!1,f=0;f<u.length;++f){var m=u[f];if(!d&&m.type===et.pki.oids.contentType){if(d=!0,p)break;continue}if(!p&&m.type===et.pki.oids.messageDigest){if(p=!0,d)break;continue}}if(!d||!p)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}n.signers.push({key:c,version:1,issuer:o,serialNumber:s,digestAlgorithm:l,signatureAlgorithm:et.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:u,unauthenticatedAttributes:[]})},sign:function(r){if(r=r||{},(typeof n.content!="object"||n.contentInfo===null)&&(n.contentInfo=Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.OID,!1,Z.oidToDer(et.pki.oids.data).getBytes())]),"content"in n)){var o;n.content instanceof et.util.ByteBuffer?o=n.content.bytes():typeof n.content=="string"&&(o=et.util.encodeUtf8(n.content)),r.detached?n.detachedContent=Z.create(Z.Class.UNIVERSAL,Z.Type.OCTETSTRING,!1,o):n.contentInfo.value.push(Z.create(Z.Class.CONTEXT_SPECIFIC,0,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.OCTETSTRING,!1,o)]))}if(n.signers.length!==0){var s=e();t(s)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(r){typeof r=="string"&&(r=et.pki.certificateFromPem(r)),n.certificates.push(r)},addCertificateRevokationList:function(r){throw new Error("PKCS#7 CRL support not yet implemented.")}},n;function e(){for(var r={},o=0;o<n.signers.length;++o){var s=n.signers[o],a=s.digestAlgorithm;a in r||(r[a]=et.md[et.pki.oids[a]].create()),s.authenticatedAttributes.length===0?s.md=r[a]:s.md=et.md[et.pki.oids[a]].create()}n.digestAlgorithmIdentifiers=[];for(var a in r)n.digestAlgorithmIdentifiers.push(Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.OID,!1,Z.oidToDer(a).getBytes()),Z.create(Z.Class.UNIVERSAL,Z.Type.NULL,!1,"")]));return r}function t(r){var o;if(n.detachedContent?o=n.detachedContent:(o=n.contentInfo.value[1],o=o.value[0]),!o)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var s=Z.derToOid(n.contentInfo.value[0].value),a=Z.toDer(o);a.getByte(),Z.getBerValueLength(a),a=a.getBytes();for(var c in r)r[c].start().update(a);for(var l=new Date,u=0;u<n.signers.length;++u){var d=n.signers[u];if(d.authenticatedAttributes.length===0){if(s!==et.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{d.authenticatedAttributesAsn1=Z.create(Z.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var p=Z.create(Z.Class.UNIVERSAL,Z.Type.SET,!0,[]),f=0;f<d.authenticatedAttributes.length;++f){var m=d.authenticatedAttributes[f];m.type===et.pki.oids.messageDigest?m.value=r[d.digestAlgorithm].digest():m.type===et.pki.oids.signingTime&&(m.value||(m.value=l)),p.value.push(Nne(m)),d.authenticatedAttributesAsn1.value.push(Nne(m))}a=Z.toDer(p).getBytes(),d.md.start().update(a)}d.signature=d.key.sign(d.md,"RSASSA-PKCS1-V1_5")}n.signerInfos=elt(n.signers)}};Wa.createEncryptedData=function(){var n=null;return n={type:et.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:et.pki.oids["aes256-CBC"]},fromAsn1:function(e){Lne(n,e,Wa.asn1.encryptedDataValidator)},decrypt:function(e){e!==void 0&&(n.encryptedContent.key=e),uwe(n)}},n};Wa.createEnvelopedData=function(){var n=null;return n={type:et.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:et.pki.oids["aes256-CBC"]},fromAsn1:function(e){var t=Lne(n,e,Wa.asn1.envelopedDataValidator);n.recipients=Xct(t.recipientInfos.value)},toAsn1:function(){return Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.OID,!1,Z.oidToDer(n.type).getBytes()),Z.create(Z.Class.CONTEXT_SPECIFIC,0,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.INTEGER,!1,Z.integerToDer(n.version).getBytes()),Z.create(Z.Class.UNIVERSAL,Z.Type.SET,!0,Jct(n.recipients)),Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,tlt(n.encryptedContent))])])])},findRecipient:function(e){for(var t=e.issuer.attributes,r=0;r<n.recipients.length;++r){var o=n.recipients[r],s=o.issuer;if(o.serialNumber===e.serialNumber&&s.length===t.length){for(var a=!0,c=0;c<t.length;++c)if(s[c].type!==t[c].type||s[c].value!==t[c].value){a=!1;break}if(a)return o}}return null},decrypt:function(e,t){if(n.encryptedContent.key===void 0&&e!==void 0&&t!==void 0)switch(e.encryptedContent.algorithm){case et.pki.oids.rsaEncryption:case et.pki.oids.desCBC:var r=t.decrypt(e.encryptedContent.content);n.encryptedContent.key=et.util.createBuffer(r);break;default:throw new Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm)}uwe(n)},addRecipient:function(e){n.recipients.push({version:0,issuer:e.issuer.attributes,serialNumber:e.serialNumber,encryptedContent:{algorithm:et.pki.oids.rsaEncryption,key:e.publicKey}})},encrypt:function(e,t){if(n.encryptedContent.content===void 0){t=t||n.encryptedContent.algorithm,e=e||n.encryptedContent.key;var r,o,s;switch(t){case et.pki.oids["aes128-CBC"]:r=16,o=16,s=et.aes.createEncryptionCipher;break;case et.pki.oids["aes192-CBC"]:r=24,o=16,s=et.aes.createEncryptionCipher;break;case et.pki.oids["aes256-CBC"]:r=32,o=16,s=et.aes.createEncryptionCipher;break;case et.pki.oids["des-EDE3-CBC"]:r=24,o=8,s=et.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+t)}if(e===void 0)e=et.util.createBuffer(et.random.getBytes(r));else if(e.length()!=r)throw new Error("Symmetric key has wrong length; got "+e.length()+" bytes, expected "+r+".");n.encryptedContent.algorithm=t,n.encryptedContent.key=e,n.encryptedContent.parameter=et.util.createBuffer(et.random.getBytes(o));var a=s(e);if(a.start(n.encryptedContent.parameter.copy()),a.update(n.content),!a.finish())throw new Error("Symmetric encryption failed.");n.encryptedContent.content=a.output}for(var c=0;c<n.recipients.length;++c){var l=n.recipients[c];if(l.encryptedContent.content===void 0)switch(l.encryptedContent.algorithm){case et.pki.oids.rsaEncryption:l.encryptedContent.content=l.encryptedContent.key.encrypt(n.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+l.encryptedContent.algorithm)}}}},n};function Yct(n){var e={},t=[];if(!Z.validate(n,Wa.asn1.recipientInfoValidator,e,t)){var r=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw r.errors=t,r}return{version:e.version.charCodeAt(0),issuer:et.pki.RDNAttributesAsArray(e.issuer),serialNumber:et.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:Z.derToOid(e.encAlgorithm),parameter:e.encParameter?e.encParameter.value:void 0,content:e.encKey}}}function Qct(n){return Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.INTEGER,!1,Z.integerToDer(n.version).getBytes()),Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,[et.pki.distinguishedNameToAsn1({attributes:n.issuer}),Z.create(Z.Class.UNIVERSAL,Z.Type.INTEGER,!1,et.util.hexToBytes(n.serialNumber))]),Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.OID,!1,Z.oidToDer(n.encryptedContent.algorithm).getBytes()),Z.create(Z.Class.UNIVERSAL,Z.Type.NULL,!1,"")]),Z.create(Z.Class.UNIVERSAL,Z.Type.OCTETSTRING,!1,n.encryptedContent.content)])}function Xct(n){for(var e=[],t=0;t<n.length;++t)e.push(Yct(n[t]));return e}function Jct(n){for(var e=[],t=0;t<n.length;++t)e.push(Qct(n[t]));return e}function Zct(n){var e=Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.INTEGER,!1,Z.integerToDer(n.version).getBytes()),Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,[et.pki.distinguishedNameToAsn1({attributes:n.issuer}),Z.create(Z.Class.UNIVERSAL,Z.Type.INTEGER,!1,et.util.hexToBytes(n.serialNumber))]),Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.OID,!1,Z.oidToDer(n.digestAlgorithm).getBytes()),Z.create(Z.Class.UNIVERSAL,Z.Type.NULL,!1,"")])]);if(n.authenticatedAttributesAsn1&&e.value.push(n.authenticatedAttributesAsn1),e.value.push(Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.OID,!1,Z.oidToDer(n.signatureAlgorithm).getBytes()),Z.create(Z.Class.UNIVERSAL,Z.Type.NULL,!1,"")])),e.value.push(Z.create(Z.Class.UNIVERSAL,Z.Type.OCTETSTRING,!1,n.signature)),n.unauthenticatedAttributes.length>0){for(var t=Z.create(Z.Class.CONTEXT_SPECIFIC,1,!0,[]),r=0;r<n.unauthenticatedAttributes.length;++r){var o=n.unauthenticatedAttributes[r];t.values.push(Nne(o))}e.value.push(t)}return e}function elt(n){for(var e=[],t=0;t<n.length;++t)e.push(Zct(n[t]));return e}function Nne(n){var e;if(n.type===et.pki.oids.contentType)e=Z.create(Z.Class.UNIVERSAL,Z.Type.OID,!1,Z.oidToDer(n.value).getBytes());else if(n.type===et.pki.oids.messageDigest)e=Z.create(Z.Class.UNIVERSAL,Z.Type.OCTETSTRING,!1,n.value.bytes());else if(n.type===et.pki.oids.signingTime){var t=new Date("1950-01-01T00:00:00Z"),r=new Date("2050-01-01T00:00:00Z"),o=n.value;if(typeof o=="string"){var s=Date.parse(o);isNaN(s)?o.length===13?o=Z.utcTimeToDate(o):o=Z.generalizedTimeToDate(o):o=new Date(s)}o>=t&&o<r?e=Z.create(Z.Class.UNIVERSAL,Z.Type.UTCTIME,!1,Z.dateToUtcTime(o)):e=Z.create(Z.Class.UNIVERSAL,Z.Type.GENERALIZEDTIME,!1,Z.dateToGeneralizedTime(o))}return Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.OID,!1,Z.oidToDer(n.type).getBytes()),Z.create(Z.Class.UNIVERSAL,Z.Type.SET,!0,[e])])}function tlt(n){return[Z.create(Z.Class.UNIVERSAL,Z.Type.OID,!1,Z.oidToDer(et.pki.oids.data).getBytes()),Z.create(Z.Class.UNIVERSAL,Z.Type.SEQUENCE,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.OID,!1,Z.oidToDer(n.algorithm).getBytes()),n.parameter?Z.create(Z.Class.UNIVERSAL,Z.Type.OCTETSTRING,!1,n.parameter.getBytes()):void 0]),Z.create(Z.Class.CONTEXT_SPECIFIC,0,!0,[Z.create(Z.Class.UNIVERSAL,Z.Type.OCTETSTRING,!1,n.content.getBytes())])]}function Lne(n,e,t){var r={},o=[];if(!Z.validate(e,t,r,o)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}var a=Z.derToOid(r.contentType);if(a!==et.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(r.encryptedContent){var c="";if(et.util.isArray(r.encryptedContent))for(var l=0;l<r.encryptedContent.length;++l){if(r.encryptedContent[l].type!==Z.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");c+=r.encryptedContent[l].value}else c=r.encryptedContent;n.encryptedContent={algorithm:Z.derToOid(r.encAlgorithm),parameter:et.util.createBuffer(r.encParameter.value),content:et.util.createBuffer(c)}}if(r.content){var c="";if(et.util.isArray(r.content))for(var l=0;l<r.content.length;++l){if(r.content[l].type!==Z.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");c+=r.content[l].value}else c=r.content;n.content=et.util.createBuffer(c)}return n.version=r.version.charCodeAt(0),n.rawCapture=r,r}function uwe(n){if(n.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(n.content===void 0){var e;switch(n.encryptedContent.algorithm){case et.pki.oids["aes128-CBC"]:case et.pki.oids["aes192-CBC"]:case et.pki.oids["aes256-CBC"]:e=et.aes.createDecryptionCipher(n.encryptedContent.key);break;case et.pki.oids.desCBC:case et.pki.oids["des-EDE3-CBC"]:e=et.des.createDecryptionCipher(n.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+n.encryptedContent.algorithm)}if(e.start(n.encryptedContent.parameter),e.update(n.encryptedContent.content),!e.finish())throw new Error("Symmetric decryption failed.");n.content=e.output}}});var mwe=P((MRn,fwe)=>{var Bo=In();vy();uw();P7();mw();rr();var Z7=fwe.exports=Bo.ssh=Bo.ssh||{};Z7.privateKeyToPutty=function(n,e,t){t=t||"",e=e||"";var r="ssh-rsa",o=e===""?"none":"aes256-cbc",s="PuTTY-User-Key-File-2: "+r+`\r
`;s+="Encryption: "+o+`\r
`,s+="Comment: "+t+`\r
`;var a=Bo.util.createBuffer();Sw(a,r),Of(a,n.e),Of(a,n.n);var c=Bo.util.encode64(a.bytes(),64),l=Math.floor(c.length/66)+1;s+="Public-Lines: "+l+`\r
`,s+=c;var u=Bo.util.createBuffer();Of(u,n.d),Of(u,n.p),Of(u,n.q),Of(u,n.qInv);var d;if(!e)d=Bo.util.encode64(u.bytes(),64);else{var p=u.length()+16-1;p-=p%16;var f=J7(u.bytes());f.truncate(f.length()-p+u.length()),u.putBuffer(f);var m=Bo.util.createBuffer();m.putBuffer(J7("\0\0\0\0",e)),m.putBuffer(J7("\0\0\0",e));var h=Bo.aes.createEncryptionCipher(m.truncate(8),"CBC");h.start(Bo.util.createBuffer().fillWithByte(0,16)),h.update(u.copy()),h.finish();var g=h.output;g.truncate(16),d=Bo.util.encode64(g.bytes(),64)}l=Math.floor(d.length/66)+1,s+=`\r
Private-Lines: `+l+`\r
`,s+=d;var y=J7("putty-private-key-file-mac-key",e),b=Bo.util.createBuffer();Sw(b,r),Sw(b,o),Sw(b,t),b.putInt32(a.length()),b.putBuffer(a),b.putInt32(u.length()),b.putBuffer(u);var _=Bo.hmac.create();return _.start("sha1",y),_.update(b.bytes()),s+=`\r
Private-MAC: `+_.digest().toHex()+`\r
`,s};Z7.publicKeyToOpenSSH=function(n,e){var t="ssh-rsa";e=e||"";var r=Bo.util.createBuffer();return Sw(r,t),Of(r,n.e),Of(r,n.n),t+" "+Bo.util.encode64(r.bytes())+" "+e};Z7.privateKeyToOpenSSH=function(n,e){return e?Bo.pki.encryptRsaPrivateKey(n,e,{legacy:!0,algorithm:"aes128"}):Bo.pki.privateKeyToPem(n)};Z7.getPublicKeyFingerprint=function(n,e){e=e||{};var t=e.md||Bo.md.md5.create(),r="ssh-rsa",o=Bo.util.createBuffer();Sw(o,r),Of(o,n.e),Of(o,n.n),t.start(),t.update(o.getBytes());var s=t.digest();if(e.encoding==="hex"){var a=s.toHex();return e.delimiter?a.match(/.{2}/g).join(e.delimiter):a}else{if(e.encoding==="binary")return s.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return s};function Of(n,e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=Bo.util.hexToBytes(t);n.putInt32(r.length),n.putBytes(r)}function Sw(n,e){n.putInt32(e.length),n.putString(e)}function J7(){for(var n=Bo.md.sha1.create(),e=arguments.length,t=0;t<e;++t)n.update(arguments[t]);return n.digest()}});var gwe=P((FRn,hwe)=>{hwe.exports=In();vy();OEe();Qd();I7();KL();ZEe();uw();rwe();awe();lwe();sne();L7();nS();ene();lne();pwe();dne();nne();$te();j7();Iu();Yte();mwe();vne();rr()});var vwe=P((URn,nlt)=>{nlt.exports={name:"@roamhq/mac-ca",version:"1.0.7",description:"Get Mac OS Root certificates",main:"index.js",repository:{type:"git",url:"https://github.com/WonderInventions/mac-ca.git"},scripts:{test:'echo "Error: no test specified" && exit 1',lint:"eslint ."},license:"BSD-3-Clause",dependencies:{"node-forge":"^1.3.1"},devDependencies:{eslint:"^8.22.0"}}});var _we=P((BRn,One)=>{var tB=gwe(),ywe=vwe(),eB=One.exports.validFormats={der:0,pem:1,txt:2,asn1:3};function bwe(n){let e=tB.pki.pemToDer(n),t=tB.asn1,r=t.fromDer(e.data.toString("binary")).value[0].value,o=r[0],s=o.tagClass===t.Class.CONTEXT_SPECIFIC&&o.type===0&&o.constructed,a=r.slice(s);return{serial:a[0],issuer:a[2],valid:a[3],subject:a[4]}}function rlt(n){let e=bwe(n),t=new Date,r=e.subject.value.map(a=>a.value[0].value[1].value).join("/"),o=e.valid.value.map(a=>a.value).join(" - "),s=t.toTimeString().replace(/\s*\(.*\)\s*/,"");return[`Subject	${r}`,`Valid	${o}`,`Saved	${t.toLocaleDateString()} ${s} by ${ywe.name}@${ywe.version}`,String(n)].join(`
`)}One.exports.transform=function(n){return function(e){try{switch(n){case eB.der:return tB.pki.pemToDer(e);case eB.pem:return e;case eB.txt:return rlt(e);case eB.asn1:return bwe(e);default:return tB.pki.certificateFromPem(e)}}catch{return}}}});var xwe=P((qRn,Iw)=>{var Mne=require("https"),Fne=_we();if(process.platform!=="darwin")Iw.exports.all=()=>[],Iw.exports.each=()=>{};else{let c=function(u,d,p){return p.indexOf(u)===d};ilt=c;let n=require("child_process"),e=/(?=-----BEGIN\sCERTIFICATE-----)/g,t="/System/Library/Keychains/SystemRootCertificates.keychain",r=["find-certificate","-a","-p"],o=n.spawnSync("/usr/bin/security",r).stdout.toString().split(e),s=n.spawnSync("/usr/bin/security",r.concat(t)).stdout.toString().split(e);Mne.globalAgent.options.ca=Mne.globalAgent.options.ca||[];let a=Mne.globalAgent.options.ca,l=o.concat(s);l.filter(c).forEach(u=>a.push(u)),Iw.exports.der2=Fne.validFormats,Iw.exports.all=function(u){return l.map(Fne.transform(u)).filter(d=>d)},Iw.exports.each=function(u,d){return typeof u=="function"&&(d=u,u=void 0),l.map(Fne.transform(u)).filter(p=>p).forEach(d)}}var ilt});var fRe=P((TGn,pRe)=>{function iRe(n){return Array.isArray(n)?n:[n]}var cRe="",oRe=" ",Hre="\\",Uut=/^\s+$/,But=/(?:[^\\]|^)\\$/,qut=/^\\!/,jut=/^\\#/,Hut=/\r?\n/g,Vut=/^\.*\/|^\.+$/,Vre="/",lRe="node-ignore";typeof Symbol<"u"&&(lRe=Symbol.for("node-ignore"));var sRe=lRe,Gut=(n,e,t)=>Object.defineProperty(n,e,{value:t}),zut=/([0-z])-([0-z])/g,uRe=()=>!1,$ut=n=>n.replace(zut,(e,t,r)=>t.charCodeAt(0)<=r.charCodeAt(0)?e:cRe),Wut=n=>{let{length:e}=n;return n.slice(0,e-e%2)},Kut=[[/\\?\s+$/,n=>n.indexOf("\\")===0?oRe:cRe],[/\\\s/g,()=>oRe],[/[\\$.|*+(){^]/g,n=>`\\${n}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(n,e,t)=>e+6<t.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(n,e,t)=>{let r=t.replace(/\\\*/g,"[^\\/]*");return e+r}],[/\\\\\\(?=[$.|*+(){^])/g,()=>Hre],[/\\\\/g,()=>Hre],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(n,e,t,r,o)=>e===Hre?`\\[${t}${Wut(r)}${o}`:o==="]"&&r.length%2===0?`[${$ut(t)}${r}]`:"[]"],[/(?:[^*])$/,n=>/\/$/.test(n)?`${n}$`:`${n}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(n,e)=>`${e?`${e}[^/]+`:"[^/]*"}(?=$|\\/$)`]],aRe=Object.create(null),Yut=(n,e)=>{let t=aRe[n];return t||(t=Kut.reduce((r,o)=>r.replace(o[0],o[1].bind(n)),n),aRe[n]=t),e?new RegExp(t,"i"):new RegExp(t)},$re=n=>typeof n=="string",Qut=n=>n&&$re(n)&&!Uut.test(n)&&!But.test(n)&&n.indexOf("#")!==0,Xut=n=>n.split(Hut),Gre=class{constructor(e,t,r,o){this.origin=e,this.pattern=t,this.negative=r,this.regex=o}},Jut=(n,e)=>{let t=n,r=!1;n.indexOf("!")===0&&(r=!0,n=n.substr(1)),n=n.replace(qut,"!").replace(jut,"#");let o=Yut(n,e);return new Gre(t,n,r,o)},Zut=(n,e)=>{throw new e(n)},Jh=(n,e,t)=>$re(n)?n?Jh.isNotRelative(n)?t(`path should be a \`path.relative()\`d string, but got "${e}"`,RangeError):!0:t("path must not be empty",TypeError):t(`path must be a string, but got \`${e}\``,TypeError),dRe=n=>Vut.test(n);Jh.isNotRelative=dRe;Jh.convert=n=>n;var zre=class{constructor({ignorecase:e=!0,ignoreCase:t=e,allowRelativePaths:r=!1}={}){Gut(this,sRe,!0),this._rules=[],this._ignoreCase=t,this._allowRelativePaths=r,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern(e){if(e&&e[sRe]){this._rules=this._rules.concat(e._rules),this._added=!0;return}if(Qut(e)){let t=Jut(e,this._ignoreCase);this._added=!0,this._rules.push(t)}}add(e){return this._added=!1,iRe($re(e)?Xut(e):e).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(e){return this.add(e)}_testOne(e,t){let r=!1,o=!1;return this._rules.forEach(s=>{let{negative:a}=s;if(o===a&&r!==o||a&&!r&&!o&&!t)return;s.regex.test(e)&&(r=!a,o=a)}),{ignored:r,unignored:o}}_test(e,t,r,o){let s=e&&Jh.convert(e);return Jh(s,e,this._allowRelativePaths?uRe:Zut),this._t(s,t,r,o)}_t(e,t,r,o){if(e in t)return t[e];if(o||(o=e.split(Vre)),o.pop(),!o.length)return t[e]=this._testOne(e,r);let s=this._t(o.join(Vre)+Vre,t,r,o);return t[e]=s.ignored?s:this._testOne(e,r)}ignores(e){return this._test(e,this._ignoreCache,!1).ignored}createFilter(){return e=>!this.ignores(e)}filter(e){return iRe(e).filter(this.createFilter())}test(e){return this._test(e,this._testCache,!0)}},dq=n=>new zre(n),edt=n=>Jh(n&&Jh.convert(n),n,uRe);dq.isPathValid=edt;dq.default=dq;pRe.exports=dq;if(typeof process<"u"&&(process.env&&process.env.IGNORE_TEST_WIN32||process.platform==="win32")){let n=t=>/^\\\\\?\\/.test(t)||/["<>|\u0000-\u001F]+/u.test(t)?t:t.replace(/\\/g,"/");Jh.convert=n;let e=/^[a-z]:\//i;Jh.isNotRelative=t=>e.test(t)||dRe(t)}});var _Re=P((RGn,bRe)=>{"use strict";bRe.exports=vRe;function vRe(n,e,t){n instanceof RegExp&&(n=gRe(n,t)),e instanceof RegExp&&(e=gRe(e,t));var r=yRe(n,e,t);return r&&{start:r[0],end:r[1],pre:t.slice(0,r[0]),body:t.slice(r[0]+n.length,r[1]),post:t.slice(r[1]+e.length)}}function gRe(n,e){var t=e.match(n);return t?t[0]:null}vRe.range=yRe;function yRe(n,e,t){var r,o,s,a,c,l=t.indexOf(n),u=t.indexOf(e,l+1),d=l;if(l>=0&&u>0){if(n===e)return[l,u];for(r=[],s=t.length;d>=0&&!c;)d==l?(r.push(d),l=t.indexOf(n,d+1)):r.length==1?c=[r.pop(),u]:(o=r.pop(),o<s&&(s=o,a=u),u=t.indexOf(e,d+1)),d=l<u&&l>=0?l:u;r.length&&(c=[s,a])}return c}});var kRe=P((PGn,wRe)=>{var xRe=_Re();wRe.exports=rdt;var SRe="\0SLASH"+Math.random()+"\0",IRe="\0OPEN"+Math.random()+"\0",Kre="\0CLOSE"+Math.random()+"\0",TRe="\0COMMA"+Math.random()+"\0",CRe="\0PERIOD"+Math.random()+"\0";function Wre(n){return parseInt(n,10)==n?parseInt(n,10):n.charCodeAt(0)}function tdt(n){return n.split("\\\\").join(SRe).split("\\{").join(IRe).split("\\}").join(Kre).split("\\,").join(TRe).split("\\.").join(CRe)}function ndt(n){return n.split(SRe).join("\\").split(IRe).join("{").split(Kre).join("}").split(TRe).join(",").split(CRe).join(".")}function ERe(n){if(!n)return[""];var e=[],t=xRe("{","}",n);if(!t)return n.split(",");var r=t.pre,o=t.body,s=t.post,a=r.split(",");a[a.length-1]+="{"+o+"}";var c=ERe(s);return s.length&&(a[a.length-1]+=c.shift(),a.push.apply(a,c)),e.push.apply(e,a),e}function rdt(n){return n?(n.substr(0,2)==="{}"&&(n="\\{\\}"+n.substr(2)),UO(tdt(n),!0).map(ndt)):[]}function idt(n){return"{"+n+"}"}function odt(n){return/^-?0\d/.test(n)}function sdt(n,e){return n<=e}function adt(n,e){return n>=e}function UO(n,e){var t=[],r=xRe("{","}",n);if(!r)return[n];var o=r.pre,s=r.post.length?UO(r.post,!1):[""];if(/\$$/.test(r.pre))for(var a=0;a<s.length;a++){var c=o+"{"+r.body+"}"+s[a];t.push(c)}else{var l=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),u=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),d=l||u,p=r.body.indexOf(",")>=0;if(!d&&!p)return r.post.match(/,.*\}/)?(n=r.pre+"{"+r.body+Kre+r.post,UO(n)):[n];var f;if(d)f=r.body.split(/\.\./);else if(f=ERe(r.body),f.length===1&&(f=UO(f[0],!1).map(idt),f.length===1))return s.map(function(F){return r.pre+f[0]+F});var m;if(d){var h=Wre(f[0]),g=Wre(f[1]),y=Math.max(f[0].length,f[1].length),b=f.length==3?Math.abs(Wre(f[2])):1,_=sdt,x=g<h;x&&(b*=-1,_=adt);var I=f.some(odt);m=[];for(var S=h;_(S,g);S+=b){var w;if(u)w=String.fromCharCode(S),w==="\\"&&(w="");else if(w=String(S),I){var R=y-w.length;if(R>0){var k=new Array(R+1).join("0");S<0?w="-"+k+w.slice(1):w=k+w}}m.push(w)}}else{m=[];for(var V=0;V<f.length;V++)m.push.apply(m,UO(f[V],!1))}for(var V=0;V<m.length;V++)for(var a=0;a<s.length;a++){var c=o+m[V]+s[a];(!e||d||c)&&t.push(c)}}return t}});var kq=P((exports,module)=>{var Module=Module!==void 0?Module:{},TreeSitter=function(){var initPromise,document=typeof window=="object"?{currentScript:window.document.currentScript}:null;class Parser{constructor(){this.initialize()}initialize(){throw new Error("cannot construct a Parser before calling `init()`")}static init(moduleOptions){return initPromise||(Module=Object.assign({},Module,moduleOptions),initPromise=new Promise(resolveInitPromise=>{var moduleOverrides=Object.assign({},Module),arguments_=[],thisProgram="./this.program",quit_=(n,e)=>{throw e},ENVIRONMENT_IS_WEB=typeof window=="object",ENVIRONMENT_IS_WORKER=typeof importScripts=="function",ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",scriptDirectory="",read_,readAsync,readBinary;function locateFile(n){return Module.locateFile?Module.locateFile(n,scriptDirectory):scriptDirectory+n}if(ENVIRONMENT_IS_NODE){var fs=require("fs"),nodePath=require("path");scriptDirectory=ENVIRONMENT_IS_WORKER?nodePath.dirname(scriptDirectory)+"/":__dirname+"/",read_=(n,e)=>(n=isFileURI(n)?new URL(n):nodePath.normalize(n),fs.readFileSync(n,e?void 0:"utf8")),readBinary=n=>{var e=read_(n,!0);return e.buffer||(e=new Uint8Array(e)),e},readAsync=(n,e,t,r=!0)=>{n=isFileURI(n)?new URL(n):nodePath.normalize(n),fs.readFile(n,r?void 0:"utf8",(o,s)=>{o?t(o):e(r?s.buffer:s)})},!Module.thisProgram&&process.argv.length>1&&(thisProgram=process.argv[1].replace(/\\/g,"/")),arguments_=process.argv.slice(2),typeof module<"u"&&(module.exports=Module),quit_=(n,e)=>{throw process.exitCode=n,e}}else(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)&&(ENVIRONMENT_IS_WORKER?scriptDirectory=self.location.href:document!==void 0&&document.currentScript&&(scriptDirectory=document.currentScript.src),scriptDirectory=scriptDirectory.startsWith("blob:")?"":scriptDirectory.substr(0,scriptDirectory.replace(/[?#].*/,"").lastIndexOf("/")+1),read_=n=>{var e=new XMLHttpRequest;return e.open("GET",n,!1),e.send(null),e.responseText},ENVIRONMENT_IS_WORKER&&(readBinary=n=>{var e=new XMLHttpRequest;return e.open("GET",n,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),readAsync=(n,e,t)=>{var r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType="arraybuffer",r.onload=()=>{r.status==200||r.status==0&&r.response?e(r.response):t()},r.onerror=t,r.send(null)});var out=Module.print||console.log.bind(console),err=Module.printErr||console.error.bind(console);Object.assign(Module,moduleOverrides),moduleOverrides=null,Module.arguments&&(arguments_=Module.arguments),Module.thisProgram&&(thisProgram=Module.thisProgram),Module.quit&&(quit_=Module.quit);var dynamicLibraries=Module.dynamicLibraries||[],wasmBinary,wasmMemory;Module.wasmBinary&&(wasmBinary=Module.wasmBinary),typeof WebAssembly!="object"&&abort("no native wasm support detected");var ABORT=!1,EXITSTATUS,HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64;function updateMemoryViews(){var n=wasmMemory.buffer;Module.HEAP8=HEAP8=new Int8Array(n),Module.HEAP16=HEAP16=new Int16Array(n),Module.HEAPU8=HEAPU8=new Uint8Array(n),Module.HEAPU16=HEAPU16=new Uint16Array(n),Module.HEAP32=HEAP32=new Int32Array(n),Module.HEAPU32=HEAPU32=new Uint32Array(n),Module.HEAPF32=HEAPF32=new Float32Array(n),Module.HEAPF64=HEAPF64=new Float64Array(n)}var INITIAL_MEMORY=Module.INITIAL_MEMORY||33554432;wasmMemory=Module.wasmMemory?Module.wasmMemory:new WebAssembly.Memory({initial:INITIAL_MEMORY/65536,maximum:32768}),updateMemoryViews(),INITIAL_MEMORY=wasmMemory.buffer.byteLength;var __ATPRERUN__=[],__ATINIT__=[],__ATMAIN__=[],__ATPOSTRUN__=[],__RELOC_FUNCS__=[],runtimeInitialized=!1;function preRun(){if(Module.preRun)for(typeof Module.preRun=="function"&&(Module.preRun=[Module.preRun]);Module.preRun.length;)addOnPreRun(Module.preRun.shift());callRuntimeCallbacks(__ATPRERUN__)}function initRuntime(){runtimeInitialized=!0,callRuntimeCallbacks(__RELOC_FUNCS__),callRuntimeCallbacks(__ATINIT__)}function preMain(){callRuntimeCallbacks(__ATMAIN__)}function postRun(){if(Module.postRun)for(typeof Module.postRun=="function"&&(Module.postRun=[Module.postRun]);Module.postRun.length;)addOnPostRun(Module.postRun.shift());callRuntimeCallbacks(__ATPOSTRUN__)}function addOnPreRun(n){__ATPRERUN__.unshift(n)}function addOnInit(n){__ATINIT__.unshift(n)}function addOnPostRun(n){__ATPOSTRUN__.unshift(n)}var runDependencies=0,runDependencyWatcher=null,dependenciesFulfilled=null;function getUniqueRunDependency(n){return n}function addRunDependency(n){runDependencies++,Module.monitorRunDependencies?.(runDependencies)}function removeRunDependency(n){if(runDependencies--,Module.monitorRunDependencies?.(runDependencies),runDependencies==0&&(runDependencyWatcher!==null&&(clearInterval(runDependencyWatcher),runDependencyWatcher=null),dependenciesFulfilled)){var e=dependenciesFulfilled;dependenciesFulfilled=null,e()}}function abort(n){throw Module.onAbort?.(n),err(n="Aborted("+n+")"),ABORT=!0,EXITSTATUS=1,n+=". Build with -sASSERTIONS for more info.",new WebAssembly.RuntimeError(n)}var dataURIPrefix="data:application/octet-stream;base64,",isDataURI=n=>n.startsWith(dataURIPrefix),isFileURI=n=>n.startsWith("file://"),wasmBinaryFile;function getBinarySync(n){if(n==wasmBinaryFile&&wasmBinary)return new Uint8Array(wasmBinary);if(readBinary)return readBinary(n);throw"both async and sync fetching of the wasm failed"}function getBinaryPromise(n){if(!wasmBinary&&(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)){if(typeof fetch=="function"&&!isFileURI(n))return fetch(n,{credentials:"same-origin"}).then(e=>{if(!e.ok)throw`failed to load wasm binary file at '${n}'`;return e.arrayBuffer()}).catch(()=>getBinarySync(n));if(readAsync)return new Promise((e,t)=>{readAsync(n,r=>e(new Uint8Array(r)),t)})}return Promise.resolve().then(()=>getBinarySync(n))}function instantiateArrayBuffer(n,e,t){return getBinaryPromise(n).then(r=>WebAssembly.instantiate(r,e)).then(t,r=>{err(`failed to asynchronously prepare wasm: ${r}`),abort(r)})}function instantiateAsync(n,e,t,r){return n||typeof WebAssembly.instantiateStreaming!="function"||isDataURI(e)||isFileURI(e)||ENVIRONMENT_IS_NODE||typeof fetch!="function"?instantiateArrayBuffer(e,t,r):fetch(e,{credentials:"same-origin"}).then(o=>WebAssembly.instantiateStreaming(o,t).then(r,function(s){return err(`wasm streaming compile failed: ${s}`),err("falling back to ArrayBuffer instantiation"),instantiateArrayBuffer(e,t,r)}))}function createWasm(){var n={env:wasmImports,wasi_snapshot_preview1:wasmImports,"GOT.mem":new Proxy(wasmImports,GOTHandler),"GOT.func":new Proxy(wasmImports,GOTHandler)};function e(t,r){wasmExports=t.exports,wasmExports=relocateExports(wasmExports,1024);var o=getDylinkMetadata(r);return o.neededDynlibs&&(dynamicLibraries=o.neededDynlibs.concat(dynamicLibraries)),mergeLibSymbols(wasmExports,"main"),LDSO.init(),loadDylibs(),addOnInit(wasmExports.__wasm_call_ctors),__RELOC_FUNCS__.push(wasmExports.__wasm_apply_data_relocs),removeRunDependency("wasm-instantiate"),wasmExports}if(addRunDependency("wasm-instantiate"),Module.instantiateWasm)try{return Module.instantiateWasm(n,e)}catch(t){return err(`Module.instantiateWasm callback failed with error: ${t}`),!1}return instantiateAsync(wasmBinary,wasmBinaryFile,n,function(t){e(t.instance,t.module)}),{}}wasmBinaryFile="tree-sitter.wasm",isDataURI(wasmBinaryFile)||(wasmBinaryFile=locateFile(wasmBinaryFile));var ASM_CONSTS={};function ExitStatus(n){this.name="ExitStatus",this.message=`Program terminated with exit(${n})`,this.status=n}var GOT={},currentModuleWeakSymbols=new Set([]),GOTHandler={get(n,e){var t=GOT[e];return t||(t=GOT[e]=new WebAssembly.Global({value:"i32",mutable:!0})),currentModuleWeakSymbols.has(e)||(t.required=!0),t}},callRuntimeCallbacks=n=>{for(;n.length>0;)n.shift()(Module)},UTF8Decoder=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,UTF8ArrayToString=(n,e,t)=>{for(var r=e+t,o=e;n[o]&&!(o>=r);)++o;if(o-e>16&&n.buffer&&UTF8Decoder)return UTF8Decoder.decode(n.subarray(e,o));for(var s="";e<o;){var a=n[e++];if(128&a){var c=63&n[e++];if((224&a)!=192){var l=63&n[e++];if((a=(240&a)==224?(15&a)<<12|c<<6|l:(7&a)<<18|c<<12|l<<6|63&n[e++])<65536)s+=String.fromCharCode(a);else{var u=a-65536;s+=String.fromCharCode(55296|u>>10,56320|1023&u)}}else s+=String.fromCharCode((31&a)<<6|c)}else s+=String.fromCharCode(a)}return s},getDylinkMetadata=n=>{var e=0,t=0;function r(){for(var b=0,_=1;;){var x=n[e++];if(b+=(127&x)*_,_*=128,!(128&x))break}return b}function o(){var b=r();return UTF8ArrayToString(n,(e+=b)-b,b)}function s(b,_){if(b)throw new Error(_)}var a="dylink.0";if(n instanceof WebAssembly.Module){var c=WebAssembly.Module.customSections(n,a);c.length===0&&(a="dylink",c=WebAssembly.Module.customSections(n,a)),s(c.length===0,"need dylink section"),t=(n=new Uint8Array(c[0])).length}else{s(new Uint32Array(new Uint8Array(n.subarray(0,24)).buffer)[0]!=1836278016,"need to see wasm magic number"),s(n[8]!==0,"need the dylink section to be first"),e=9;var l=r();t=e+l,a=o()}var u={neededDynlibs:[],tlsExports:new Set,weakImports:new Set};if(a=="dylink"){u.memorySize=r(),u.memoryAlign=r(),u.tableSize=r(),u.tableAlign=r();for(var d=r(),p=0;p<d;++p){var f=o();u.neededDynlibs.push(f)}}else for(s(a!=="dylink.0");e<t;){var m=n[e++],h=r();if(m===1)u.memorySize=r(),u.memoryAlign=r(),u.tableSize=r(),u.tableAlign=r();else if(m===2)for(d=r(),p=0;p<d;++p)f=o(),u.neededDynlibs.push(f);else if(m===3)for(var g=r();g--;){var y=o();256&r()&&u.tlsExports.add(y)}else if(m===4)for(g=r();g--;)o(),y=o(),(3&r())==1&&u.weakImports.add(y);else e+=h}return u};function getValue(n,e="i8"){switch(e.endsWith("*")&&(e="*"),e){case"i1":case"i8":return HEAP8[n];case"i16":return HEAP16[n>>1];case"i32":return HEAP32[n>>2];case"i64":abort("to do getValue(i64) use WASM_BIGINT");case"float":return HEAPF32[n>>2];case"double":return HEAPF64[n>>3];case"*":return HEAPU32[n>>2];default:abort(`invalid type for getValue: ${e}`)}}var newDSO=(n,e,t)=>{var r={refcount:1/0,name:n,exports:t,global:!0};return LDSO.loadedLibsByName[n]=r,e!=null&&(LDSO.loadedLibsByHandle[e]=r),r},LDSO={loadedLibsByName:{},loadedLibsByHandle:{},init(){newDSO("__main__",0,wasmImports)}},___heap_base=78096,zeroMemory=(n,e)=>(HEAPU8.fill(0,n,n+e),n),alignMemory=(n,e)=>Math.ceil(n/e)*e,getMemory=n=>{if(runtimeInitialized)return zeroMemory(_malloc(n),n);var e=___heap_base,t=e+alignMemory(n,16);return ___heap_base=t,GOT.__heap_base.value=t,e},isInternalSym=n=>["__cpp_exception","__c_longjmp","__wasm_apply_data_relocs","__dso_handle","__tls_size","__tls_align","__set_stack_limits","_emscripten_tls_init","__wasm_init_tls","__wasm_call_ctors","__start_em_asm","__stop_em_asm","__start_em_js","__stop_em_js"].includes(n)||n.startsWith("__em_js__"),uleb128Encode=(n,e)=>{n<128?e.push(n):e.push(n%128|128,n>>7)},sigToWasmTypes=n=>{for(var e={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},t={parameters:[],results:n[0]=="v"?[]:[e[n[0]]]},r=1;r<n.length;++r)t.parameters.push(e[n[r]]);return t},generateFuncType=(n,e)=>{var t=n.slice(0,1),r=n.slice(1),o={i:127,p:127,j:126,f:125,d:124,e:111};e.push(96),uleb128Encode(r.length,e);for(var s=0;s<r.length;++s)e.push(o[r[s]]);t=="v"?e.push(0):e.push(1,o[t])},convertJsFunctionToWasm=(n,e)=>{if(typeof WebAssembly.Function=="function")return new WebAssembly.Function(sigToWasmTypes(e),n);var t=[1];generateFuncType(e,t);var r=[0,97,115,109,1,0,0,0,1];uleb128Encode(t.length,r),r.push(...t),r.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);var o=new WebAssembly.Module(new Uint8Array(r));return new WebAssembly.Instance(o,{e:{f:n}}).exports.f},wasmTableMirror=[],wasmTable=new WebAssembly.Table({initial:27,element:"anyfunc"}),getWasmTableEntry=n=>{var e=wasmTableMirror[n];return e||(n>=wasmTableMirror.length&&(wasmTableMirror.length=n+1),wasmTableMirror[n]=e=wasmTable.get(n)),e},updateTableMap=(n,e)=>{if(functionsInTableMap)for(var t=n;t<n+e;t++){var r=getWasmTableEntry(t);r&&functionsInTableMap.set(r,t)}},functionsInTableMap,getFunctionAddress=n=>(functionsInTableMap||(functionsInTableMap=new WeakMap,updateTableMap(0,wasmTable.length)),functionsInTableMap.get(n)||0),freeTableIndexes=[],getEmptyTableSlot=()=>{if(freeTableIndexes.length)return freeTableIndexes.pop();try{wasmTable.grow(1)}catch(n){throw n instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":n}return wasmTable.length-1},setWasmTableEntry=(n,e)=>{wasmTable.set(n,e),wasmTableMirror[n]=wasmTable.get(n)},addFunction=(n,e)=>{var t=getFunctionAddress(n);if(t)return t;var r=getEmptyTableSlot();try{setWasmTableEntry(r,n)}catch(s){if(!(s instanceof TypeError))throw s;var o=convertJsFunctionToWasm(n,e);setWasmTableEntry(r,o)}return functionsInTableMap.set(n,r),r},updateGOT=(n,e)=>{for(var t in n)if(!isInternalSym(t)){var r=n[t];t.startsWith("orig$")&&(t=t.split("$")[1],e=!0),GOT[t]||=new WebAssembly.Global({value:"i32",mutable:!0}),(e||GOT[t].value==0)&&(typeof r=="function"?GOT[t].value=addFunction(r):typeof r=="number"?GOT[t].value=r:err(`unhandled export type for '${t}': ${typeof r}`))}},relocateExports=(n,e,t)=>{var r={};for(var o in n){var s=n[o];typeof s=="object"&&(s=s.value),typeof s=="number"&&(s+=e),r[o]=s}return updateGOT(r,t),r},isSymbolDefined=n=>{var e=wasmImports[n];return!(!e||e.stub)},dynCallLegacy=(n,e,t)=>(0,Module["dynCall_"+n])(e,...t),dynCall=(n,e,t=[])=>n.includes("j")?dynCallLegacy(n,e,t):getWasmTableEntry(e)(...t),createInvokeFunction=n=>function(){var e=stackSave();try{return dynCall(n,arguments[0],Array.prototype.slice.call(arguments,1))}catch(t){if(stackRestore(e),t!==t+0)throw t;_setThrew(1,0)}},resolveGlobalSymbol=(n,e=!1)=>{var t;return e&&"orig$"+n in wasmImports&&(n="orig$"+n),isSymbolDefined(n)?t=wasmImports[n]:n.startsWith("invoke_")&&(t=wasmImports[n]=createInvokeFunction(n.split("_")[1])),{sym:t,name:n}},UTF8ToString=(n,e)=>n?UTF8ArrayToString(HEAPU8,n,e):"",loadWebAssemblyModule=(binary,flags,libName,localScope,handle)=>{var metadata=getDylinkMetadata(binary);function loadModule(){var firstLoad=!handle||!HEAP8[handle+8];if(firstLoad){var memAlign=Math.pow(2,metadata.memoryAlign),memoryBase=metadata.memorySize?alignMemory(getMemory(metadata.memorySize+memAlign),memAlign):0,tableBase=metadata.tableSize?wasmTable.length:0;handle&&(HEAP8[handle+8]=1,HEAPU32[handle+12>>2]=memoryBase,HEAP32[handle+16>>2]=metadata.memorySize,HEAPU32[handle+20>>2]=tableBase,HEAP32[handle+24>>2]=metadata.tableSize)}else memoryBase=HEAPU32[handle+12>>2],tableBase=HEAPU32[handle+20>>2];var tableGrowthNeeded=tableBase+metadata.tableSize-wasmTable.length,moduleExports;function resolveSymbol(n){var e=resolveGlobalSymbol(n).sym;return!e&&localScope&&(e=localScope[n]),e||(e=moduleExports[n]),e}tableGrowthNeeded>0&&wasmTable.grow(tableGrowthNeeded);var proxyHandler={get(n,e){switch(e){case"__memory_base":return memoryBase;case"__table_base":return tableBase}if(e in wasmImports&&!wasmImports[e].stub)return wasmImports[e];var t;return e in n||(n[e]=(...r)=>(t||=resolveSymbol(e),t(...r))),n[e]}},proxy=new Proxy({},proxyHandler),info={"GOT.mem":new Proxy({},GOTHandler),"GOT.func":new Proxy({},GOTHandler),env:proxy,wasi_snapshot_preview1:proxy};function postInstantiation(module,instance){function addEmAsm(addr,body){for(var args=[],arity=0;arity<16&&body.indexOf("$"+arity)!=-1;arity++)args.push("$"+arity);args=args.join(",");var func=`(${args}) => { ${body} };`;ASM_CONSTS[start]=eval(func)}if(updateTableMap(tableBase,metadata.tableSize),moduleExports=relocateExports(instance.exports,memoryBase),flags.allowUndefined||reportUndefinedSymbols(),"__start_em_asm"in moduleExports)for(var start=moduleExports.__start_em_asm,stop=moduleExports.__stop_em_asm;start<stop;){var jsString=UTF8ToString(start);addEmAsm(start,jsString),start=HEAPU8.indexOf(0,start)+1}function addEmJs(name,cSig,body){var jsArgs=[];if(cSig=cSig.slice(1,-1),cSig!="void")for(var i in cSig=cSig.split(","),cSig){var jsArg=cSig[i].split(" ").pop();jsArgs.push(jsArg.replace("*",""))}var func=`(${jsArgs}) => ${body};`;moduleExports[name]=eval(func)}for(var name in moduleExports)if(name.startsWith("__em_js__")){var start=moduleExports[name],jsString=UTF8ToString(start),parts=jsString.split("<::>");addEmJs(name.replace("__em_js__",""),parts[0],parts[1]),delete moduleExports[name]}var applyRelocs=moduleExports.__wasm_apply_data_relocs;applyRelocs&&(runtimeInitialized?applyRelocs():__RELOC_FUNCS__.push(applyRelocs));var init=moduleExports.__wasm_call_ctors;return init&&(runtimeInitialized?init():__ATINIT__.push(init)),moduleExports}if(flags.loadAsync){if(binary instanceof WebAssembly.Module){var instance=new WebAssembly.Instance(binary,info);return Promise.resolve(postInstantiation(binary,instance))}return WebAssembly.instantiate(binary,info).then(n=>postInstantiation(n.module,n.instance))}var module=binary instanceof WebAssembly.Module?binary:new WebAssembly.Module(binary),instance=new WebAssembly.Instance(module,info);return postInstantiation(module,instance)}return currentModuleWeakSymbols=metadata.weakImports,flags.loadAsync?metadata.neededDynlibs.reduce((n,e)=>n.then(()=>loadDynamicLibrary(e,flags)),Promise.resolve()).then(loadModule):(metadata.neededDynlibs.forEach(n=>loadDynamicLibrary(n,flags,localScope)),loadModule())},mergeLibSymbols=(n,e)=>{for(var[t,r]of Object.entries(n)){let o=a=>{isSymbolDefined(a)||(wasmImports[a]=r)};o(t);let s="__main_argc_argv";t=="main"&&o(s),t==s&&o("main"),t.startsWith("dynCall_")&&!Module.hasOwnProperty(t)&&(Module[t]=r)}},asyncLoad=(n,e,t,r)=>{var o=r?"":`al ${n}`;readAsync(n,s=>{e(new Uint8Array(s)),o&&removeRunDependency(o)},s=>{if(!t)throw`Loading data file "${n}" failed.`;t()}),o&&addRunDependency(o)};function loadDynamicLibrary(n,e={global:!0,nodelete:!0},t,r){var o=LDSO.loadedLibsByName[n];if(o)return e.global?o.global||(o.global=!0,mergeLibSymbols(o.exports,n)):t&&Object.assign(t,o.exports),e.nodelete&&o.refcount!==1/0&&(o.refcount=1/0),o.refcount++,r&&(LDSO.loadedLibsByHandle[r]=o),!e.loadAsync||Promise.resolve(!0);function s(){if(r){var l=HEAPU32[r+28>>2],u=HEAPU32[r+32>>2];if(l&&u){var d=HEAP8.slice(l,l+u);return e.loadAsync?Promise.resolve(d):d}}var p=locateFile(n);if(e.loadAsync)return new Promise(function(f,m){asyncLoad(p,f,m)});if(!readBinary)throw new Error(`${p}: file not found, and synchronous loading of external files is not available`);return readBinary(p)}function a(){return e.loadAsync?s().then(l=>loadWebAssemblyModule(l,e,n,t,r)):loadWebAssemblyModule(s(),e,n,t,r)}function c(l){o.global?mergeLibSymbols(l,n):t&&Object.assign(t,l),o.exports=l}return(o=newDSO(n,r,"loading")).refcount=e.nodelete?1/0:1,o.global=e.global,e.loadAsync?a().then(l=>(c(l),!0)):(c(a()),!0)}var reportUndefinedSymbols=()=>{for(var[n,e]of Object.entries(GOT))if(e.value==0){var t=resolveGlobalSymbol(n,!0).sym;if(!t&&!e.required)continue;if(typeof t=="function")e.value=addFunction(t,t.sig);else{if(typeof t!="number")throw new Error(`bad export type for '${n}': ${typeof t}`);e.value=t}}},loadDylibs=()=>{dynamicLibraries.length?(addRunDependency("loadDylibs"),dynamicLibraries.reduce((n,e)=>n.then(()=>loadDynamicLibrary(e,{loadAsync:!0,global:!0,nodelete:!0,allowUndefined:!0})),Promise.resolve()).then(()=>{reportUndefinedSymbols(),removeRunDependency("loadDylibs")})):reportUndefinedSymbols()},noExitRuntime=Module.noExitRuntime||!0;function setValue(n,e,t="i8"){switch(t.endsWith("*")&&(t="*"),t){case"i1":case"i8":HEAP8[n]=e;break;case"i16":HEAP16[n>>1]=e;break;case"i32":HEAP32[n>>2]=e;break;case"i64":abort("to do setValue(i64) use WASM_BIGINT");case"float":HEAPF32[n>>2]=e;break;case"double":HEAPF64[n>>3]=e;break;case"*":HEAPU32[n>>2]=e;break;default:abort(`invalid type for setValue: ${t}`)}}var ___memory_base=new WebAssembly.Global({value:"i32",mutable:!1},1024),___stack_pointer=new WebAssembly.Global({value:"i32",mutable:!0},78096),___table_base=new WebAssembly.Global({value:"i32",mutable:!1},1),nowIsMonotonic=1,__emscripten_get_now_is_monotonic=()=>nowIsMonotonic;__emscripten_get_now_is_monotonic.sig="i";var _abort=()=>{abort("")};_abort.sig="v";var _emscripten_date_now=()=>Date.now(),_emscripten_get_now;_emscripten_date_now.sig="d",_emscripten_get_now=()=>performance.now(),_emscripten_get_now.sig="d";var _emscripten_memcpy_js=(n,e,t)=>HEAPU8.copyWithin(n,e,e+t);_emscripten_memcpy_js.sig="vppp";var getHeapMax=()=>2147483648,growMemory=n=>{var e=(n-wasmMemory.buffer.byteLength+65535)/65536;try{return wasmMemory.grow(e),updateMemoryViews(),1}catch{}},_emscripten_resize_heap=n=>{var e=HEAPU8.length;n>>>=0;var t=getHeapMax();if(n>t)return!1;for(var r,o,s=1;s<=4;s*=2){var a=e*(1+.2/s);a=Math.min(a,n+100663296);var c=Math.min(t,(r=Math.max(n,a))+((o=65536)-r%o)%o);if(growMemory(c))return!0}return!1};_emscripten_resize_heap.sig="ip";var _fd_close=n=>52;_fd_close.sig="ii";var convertI32PairToI53Checked=(n,e)=>e+2097152>>>0<4194305-!!n?(n>>>0)+4294967296*e:NaN;function _fd_seek(n,e,t,r,o){return convertI32PairToI53Checked(e,t),70}_fd_seek.sig="iiiiip";var printCharBuffers=[null,[],[]],printChar=(n,e)=>{var t=printCharBuffers[n];e===0||e===10?((n===1?out:err)(UTF8ArrayToString(t,0)),t.length=0):t.push(e)},SYSCALLS={varargs:void 0,get(){var n=HEAP32[+SYSCALLS.varargs>>2];return SYSCALLS.varargs+=4,n},getp:()=>SYSCALLS.get(),getStr:n=>UTF8ToString(n)},_fd_write=(n,e,t,r)=>{for(var o=0,s=0;s<t;s++){var a=HEAPU32[e>>2],c=HEAPU32[e+4>>2];e+=8;for(var l=0;l<c;l++)printChar(n,HEAPU8[a+l]);o+=c}return HEAPU32[r>>2]=o,0};function _tree_sitter_log_callback(n,e){if(currentLogCallback){let t=UTF8ToString(e);currentLogCallback(t,n!==0)}}function _tree_sitter_parse_callback(n,e,t,r,o){let s=currentParseCallback(e,{row:t,column:r});typeof s=="string"?(setValue(o,s.length,"i32"),stringToUTF16(s,n,10240)):setValue(o,0,"i32")}_fd_write.sig="iippp";var runtimeKeepaliveCounter=0,keepRuntimeAlive=()=>noExitRuntime||runtimeKeepaliveCounter>0,_proc_exit=n=>{EXITSTATUS=n,keepRuntimeAlive()||(Module.onExit?.(n),ABORT=!0),quit_(n,new ExitStatus(n))};_proc_exit.sig="vi";var exitJS=(n,e)=>{EXITSTATUS=n,_proc_exit(n)},handleException=n=>{if(n instanceof ExitStatus||n=="unwind")return EXITSTATUS;quit_(1,n)},lengthBytesUTF8=n=>{for(var e=0,t=0;t<n.length;++t){var r=n.charCodeAt(t);r<=127?e++:r<=2047?e+=2:r>=55296&&r<=57343?(e+=4,++t):e+=3}return e},stringToUTF8Array=(n,e,t,r)=>{if(!(r>0))return 0;for(var o=t,s=t+r-1,a=0;a<n.length;++a){var c=n.charCodeAt(a);if(c>=55296&&c<=57343&&(c=65536+((1023&c)<<10)|1023&n.charCodeAt(++a)),c<=127){if(t>=s)break;e[t++]=c}else if(c<=2047){if(t+1>=s)break;e[t++]=192|c>>6,e[t++]=128|63&c}else if(c<=65535){if(t+2>=s)break;e[t++]=224|c>>12,e[t++]=128|c>>6&63,e[t++]=128|63&c}else{if(t+3>=s)break;e[t++]=240|c>>18,e[t++]=128|c>>12&63,e[t++]=128|c>>6&63,e[t++]=128|63&c}}return e[t]=0,t-o},stringToUTF8=(n,e,t)=>stringToUTF8Array(n,HEAPU8,e,t),stringToUTF8OnStack=n=>{var e=lengthBytesUTF8(n)+1,t=stackAlloc(e);return stringToUTF8(n,t,e),t},stringToUTF16=(n,e,t)=>{if(t??=2147483647,t<2)return 0;for(var r=e,o=(t-=2)<2*n.length?t/2:n.length,s=0;s<o;++s){var a=n.charCodeAt(s);HEAP16[e>>1]=a,e+=2}return HEAP16[e>>1]=0,e-r},AsciiToString=n=>{for(var e="";;){var t=HEAPU8[n++];if(!t)return e;e+=String.fromCharCode(t)}},wasmImports={__heap_base:___heap_base,__indirect_function_table:wasmTable,__memory_base:___memory_base,__stack_pointer:___stack_pointer,__table_base:___table_base,_emscripten_get_now_is_monotonic:__emscripten_get_now_is_monotonic,abort:_abort,emscripten_get_now:_emscripten_get_now,emscripten_memcpy_js:_emscripten_memcpy_js,emscripten_resize_heap:_emscripten_resize_heap,fd_close:_fd_close,fd_seek:_fd_seek,fd_write:_fd_write,memory:wasmMemory,tree_sitter_log_callback:_tree_sitter_log_callback,tree_sitter_parse_callback:_tree_sitter_parse_callback},wasmExports=createWasm(),___wasm_call_ctors=()=>(___wasm_call_ctors=wasmExports.__wasm_call_ctors)(),___wasm_apply_data_relocs=()=>(___wasm_apply_data_relocs=wasmExports.__wasm_apply_data_relocs)(),_malloc=Module._malloc=n=>(_malloc=Module._malloc=wasmExports.malloc)(n),_calloc=Module._calloc=(n,e)=>(_calloc=Module._calloc=wasmExports.calloc)(n,e),_realloc=Module._realloc=(n,e)=>(_realloc=Module._realloc=wasmExports.realloc)(n,e),_free=Module._free=n=>(_free=Module._free=wasmExports.free)(n),_ts_language_symbol_count=Module._ts_language_symbol_count=n=>(_ts_language_symbol_count=Module._ts_language_symbol_count=wasmExports.ts_language_symbol_count)(n),_ts_language_state_count=Module._ts_language_state_count=n=>(_ts_language_state_count=Module._ts_language_state_count=wasmExports.ts_language_state_count)(n),_ts_language_version=Module._ts_language_version=n=>(_ts_language_version=Module._ts_language_version=wasmExports.ts_language_version)(n),_ts_language_field_count=Module._ts_language_field_count=n=>(_ts_language_field_count=Module._ts_language_field_count=wasmExports.ts_language_field_count)(n),_ts_language_next_state=Module._ts_language_next_state=(n,e,t)=>(_ts_language_next_state=Module._ts_language_next_state=wasmExports.ts_language_next_state)(n,e,t),_ts_language_symbol_name=Module._ts_language_symbol_name=(n,e)=>(_ts_language_symbol_name=Module._ts_language_symbol_name=wasmExports.ts_language_symbol_name)(n,e),_ts_language_symbol_for_name=Module._ts_language_symbol_for_name=(n,e,t,r)=>(_ts_language_symbol_for_name=Module._ts_language_symbol_for_name=wasmExports.ts_language_symbol_for_name)(n,e,t,r),_strncmp=Module._strncmp=(n,e,t)=>(_strncmp=Module._strncmp=wasmExports.strncmp)(n,e,t),_ts_language_symbol_type=Module._ts_language_symbol_type=(n,e)=>(_ts_language_symbol_type=Module._ts_language_symbol_type=wasmExports.ts_language_symbol_type)(n,e),_ts_language_field_name_for_id=Module._ts_language_field_name_for_id=(n,e)=>(_ts_language_field_name_for_id=Module._ts_language_field_name_for_id=wasmExports.ts_language_field_name_for_id)(n,e),_ts_lookahead_iterator_new=Module._ts_lookahead_iterator_new=(n,e)=>(_ts_lookahead_iterator_new=Module._ts_lookahead_iterator_new=wasmExports.ts_lookahead_iterator_new)(n,e),_ts_lookahead_iterator_delete=Module._ts_lookahead_iterator_delete=n=>(_ts_lookahead_iterator_delete=Module._ts_lookahead_iterator_delete=wasmExports.ts_lookahead_iterator_delete)(n),_ts_lookahead_iterator_reset_state=Module._ts_lookahead_iterator_reset_state=(n,e)=>(_ts_lookahead_iterator_reset_state=Module._ts_lookahead_iterator_reset_state=wasmExports.ts_lookahead_iterator_reset_state)(n,e),_ts_lookahead_iterator_reset=Module._ts_lookahead_iterator_reset=(n,e,t)=>(_ts_lookahead_iterator_reset=Module._ts_lookahead_iterator_reset=wasmExports.ts_lookahead_iterator_reset)(n,e,t),_ts_lookahead_iterator_next=Module._ts_lookahead_iterator_next=n=>(_ts_lookahead_iterator_next=Module._ts_lookahead_iterator_next=wasmExports.ts_lookahead_iterator_next)(n),_ts_lookahead_iterator_current_symbol=Module._ts_lookahead_iterator_current_symbol=n=>(_ts_lookahead_iterator_current_symbol=Module._ts_lookahead_iterator_current_symbol=wasmExports.ts_lookahead_iterator_current_symbol)(n),_memset=Module._memset=(n,e,t)=>(_memset=Module._memset=wasmExports.memset)(n,e,t),_memcpy=Module._memcpy=(n,e,t)=>(_memcpy=Module._memcpy=wasmExports.memcpy)(n,e,t),_ts_parser_delete=Module._ts_parser_delete=n=>(_ts_parser_delete=Module._ts_parser_delete=wasmExports.ts_parser_delete)(n),_ts_parser_reset=Module._ts_parser_reset=n=>(_ts_parser_reset=Module._ts_parser_reset=wasmExports.ts_parser_reset)(n),_ts_parser_set_language=Module._ts_parser_set_language=(n,e)=>(_ts_parser_set_language=Module._ts_parser_set_language=wasmExports.ts_parser_set_language)(n,e),_ts_parser_timeout_micros=Module._ts_parser_timeout_micros=n=>(_ts_parser_timeout_micros=Module._ts_parser_timeout_micros=wasmExports.ts_parser_timeout_micros)(n),_ts_parser_set_timeout_micros=Module._ts_parser_set_timeout_micros=(n,e,t)=>(_ts_parser_set_timeout_micros=Module._ts_parser_set_timeout_micros=wasmExports.ts_parser_set_timeout_micros)(n,e,t),_ts_parser_set_included_ranges=Module._ts_parser_set_included_ranges=(n,e,t)=>(_ts_parser_set_included_ranges=Module._ts_parser_set_included_ranges=wasmExports.ts_parser_set_included_ranges)(n,e,t),_memmove=Module._memmove=(n,e,t)=>(_memmove=Module._memmove=wasmExports.memmove)(n,e,t),_memcmp=Module._memcmp=(n,e,t)=>(_memcmp=Module._memcmp=wasmExports.memcmp)(n,e,t),_ts_query_new=Module._ts_query_new=(n,e,t,r,o)=>(_ts_query_new=Module._ts_query_new=wasmExports.ts_query_new)(n,e,t,r,o),_ts_query_delete=Module._ts_query_delete=n=>(_ts_query_delete=Module._ts_query_delete=wasmExports.ts_query_delete)(n),_iswspace=Module._iswspace=n=>(_iswspace=Module._iswspace=wasmExports.iswspace)(n),_iswalnum=Module._iswalnum=n=>(_iswalnum=Module._iswalnum=wasmExports.iswalnum)(n),_ts_query_pattern_count=Module._ts_query_pattern_count=n=>(_ts_query_pattern_count=Module._ts_query_pattern_count=wasmExports.ts_query_pattern_count)(n),_ts_query_capture_count=Module._ts_query_capture_count=n=>(_ts_query_capture_count=Module._ts_query_capture_count=wasmExports.ts_query_capture_count)(n),_ts_query_string_count=Module._ts_query_string_count=n=>(_ts_query_string_count=Module._ts_query_string_count=wasmExports.ts_query_string_count)(n),_ts_query_capture_name_for_id=Module._ts_query_capture_name_for_id=(n,e,t)=>(_ts_query_capture_name_for_id=Module._ts_query_capture_name_for_id=wasmExports.ts_query_capture_name_for_id)(n,e,t),_ts_query_string_value_for_id=Module._ts_query_string_value_for_id=(n,e,t)=>(_ts_query_string_value_for_id=Module._ts_query_string_value_for_id=wasmExports.ts_query_string_value_for_id)(n,e,t),_ts_query_predicates_for_pattern=Module._ts_query_predicates_for_pattern=(n,e,t)=>(_ts_query_predicates_for_pattern=Module._ts_query_predicates_for_pattern=wasmExports.ts_query_predicates_for_pattern)(n,e,t),_ts_query_disable_capture=Module._ts_query_disable_capture=(n,e,t)=>(_ts_query_disable_capture=Module._ts_query_disable_capture=wasmExports.ts_query_disable_capture)(n,e,t),_ts_tree_copy=Module._ts_tree_copy=n=>(_ts_tree_copy=Module._ts_tree_copy=wasmExports.ts_tree_copy)(n),_ts_tree_delete=Module._ts_tree_delete=n=>(_ts_tree_delete=Module._ts_tree_delete=wasmExports.ts_tree_delete)(n),_ts_init=Module._ts_init=()=>(_ts_init=Module._ts_init=wasmExports.ts_init)(),_ts_parser_new_wasm=Module._ts_parser_new_wasm=()=>(_ts_parser_new_wasm=Module._ts_parser_new_wasm=wasmExports.ts_parser_new_wasm)(),_ts_parser_enable_logger_wasm=Module._ts_parser_enable_logger_wasm=(n,e)=>(_ts_parser_enable_logger_wasm=Module._ts_parser_enable_logger_wasm=wasmExports.ts_parser_enable_logger_wasm)(n,e),_ts_parser_parse_wasm=Module._ts_parser_parse_wasm=(n,e,t,r,o)=>(_ts_parser_parse_wasm=Module._ts_parser_parse_wasm=wasmExports.ts_parser_parse_wasm)(n,e,t,r,o),_ts_parser_included_ranges_wasm=Module._ts_parser_included_ranges_wasm=n=>(_ts_parser_included_ranges_wasm=Module._ts_parser_included_ranges_wasm=wasmExports.ts_parser_included_ranges_wasm)(n),_ts_language_type_is_named_wasm=Module._ts_language_type_is_named_wasm=(n,e)=>(_ts_language_type_is_named_wasm=Module._ts_language_type_is_named_wasm=wasmExports.ts_language_type_is_named_wasm)(n,e),_ts_language_type_is_visible_wasm=Module._ts_language_type_is_visible_wasm=(n,e)=>(_ts_language_type_is_visible_wasm=Module._ts_language_type_is_visible_wasm=wasmExports.ts_language_type_is_visible_wasm)(n,e),_ts_tree_root_node_wasm=Module._ts_tree_root_node_wasm=n=>(_ts_tree_root_node_wasm=Module._ts_tree_root_node_wasm=wasmExports.ts_tree_root_node_wasm)(n),_ts_tree_root_node_with_offset_wasm=Module._ts_tree_root_node_with_offset_wasm=n=>(_ts_tree_root_node_with_offset_wasm=Module._ts_tree_root_node_with_offset_wasm=wasmExports.ts_tree_root_node_with_offset_wasm)(n),_ts_tree_edit_wasm=Module._ts_tree_edit_wasm=n=>(_ts_tree_edit_wasm=Module._ts_tree_edit_wasm=wasmExports.ts_tree_edit_wasm)(n),_ts_tree_included_ranges_wasm=Module._ts_tree_included_ranges_wasm=n=>(_ts_tree_included_ranges_wasm=Module._ts_tree_included_ranges_wasm=wasmExports.ts_tree_included_ranges_wasm)(n),_ts_tree_get_changed_ranges_wasm=Module._ts_tree_get_changed_ranges_wasm=(n,e)=>(_ts_tree_get_changed_ranges_wasm=Module._ts_tree_get_changed_ranges_wasm=wasmExports.ts_tree_get_changed_ranges_wasm)(n,e),_ts_tree_cursor_new_wasm=Module._ts_tree_cursor_new_wasm=n=>(_ts_tree_cursor_new_wasm=Module._ts_tree_cursor_new_wasm=wasmExports.ts_tree_cursor_new_wasm)(n),_ts_tree_cursor_delete_wasm=Module._ts_tree_cursor_delete_wasm=n=>(_ts_tree_cursor_delete_wasm=Module._ts_tree_cursor_delete_wasm=wasmExports.ts_tree_cursor_delete_wasm)(n),_ts_tree_cursor_reset_wasm=Module._ts_tree_cursor_reset_wasm=n=>(_ts_tree_cursor_reset_wasm=Module._ts_tree_cursor_reset_wasm=wasmExports.ts_tree_cursor_reset_wasm)(n),_ts_tree_cursor_reset_to_wasm=Module._ts_tree_cursor_reset_to_wasm=(n,e)=>(_ts_tree_cursor_reset_to_wasm=Module._ts_tree_cursor_reset_to_wasm=wasmExports.ts_tree_cursor_reset_to_wasm)(n,e),_ts_tree_cursor_goto_first_child_wasm=Module._ts_tree_cursor_goto_first_child_wasm=n=>(_ts_tree_cursor_goto_first_child_wasm=Module._ts_tree_cursor_goto_first_child_wasm=wasmExports.ts_tree_cursor_goto_first_child_wasm)(n),_ts_tree_cursor_goto_last_child_wasm=Module._ts_tree_cursor_goto_last_child_wasm=n=>(_ts_tree_cursor_goto_last_child_wasm=Module._ts_tree_cursor_goto_last_child_wasm=wasmExports.ts_tree_cursor_goto_last_child_wasm)(n),_ts_tree_cursor_goto_first_child_for_index_wasm=Module._ts_tree_cursor_goto_first_child_for_index_wasm=n=>(_ts_tree_cursor_goto_first_child_for_index_wasm=Module._ts_tree_cursor_goto_first_child_for_index_wasm=wasmExports.ts_tree_cursor_goto_first_child_for_index_wasm)(n),_ts_tree_cursor_goto_first_child_for_position_wasm=Module._ts_tree_cursor_goto_first_child_for_position_wasm=n=>(_ts_tree_cursor_goto_first_child_for_position_wasm=Module._ts_tree_cursor_goto_first_child_for_position_wasm=wasmExports.ts_tree_cursor_goto_first_child_for_position_wasm)(n),_ts_tree_cursor_goto_next_sibling_wasm=Module._ts_tree_cursor_goto_next_sibling_wasm=n=>(_ts_tree_cursor_goto_next_sibling_wasm=Module._ts_tree_cursor_goto_next_sibling_wasm=wasmExports.ts_tree_cursor_goto_next_sibling_wasm)(n),_ts_tree_cursor_goto_previous_sibling_wasm=Module._ts_tree_cursor_goto_previous_sibling_wasm=n=>(_ts_tree_cursor_goto_previous_sibling_wasm=Module._ts_tree_cursor_goto_previous_sibling_wasm=wasmExports.ts_tree_cursor_goto_previous_sibling_wasm)(n),_ts_tree_cursor_goto_descendant_wasm=Module._ts_tree_cursor_goto_descendant_wasm=(n,e)=>(_ts_tree_cursor_goto_descendant_wasm=Module._ts_tree_cursor_goto_descendant_wasm=wasmExports.ts_tree_cursor_goto_descendant_wasm)(n,e),_ts_tree_cursor_goto_parent_wasm=Module._ts_tree_cursor_goto_parent_wasm=n=>(_ts_tree_cursor_goto_parent_wasm=Module._ts_tree_cursor_goto_parent_wasm=wasmExports.ts_tree_cursor_goto_parent_wasm)(n),_ts_tree_cursor_current_node_type_id_wasm=Module._ts_tree_cursor_current_node_type_id_wasm=n=>(_ts_tree_cursor_current_node_type_id_wasm=Module._ts_tree_cursor_current_node_type_id_wasm=wasmExports.ts_tree_cursor_current_node_type_id_wasm)(n),_ts_tree_cursor_current_node_state_id_wasm=Module._ts_tree_cursor_current_node_state_id_wasm=n=>(_ts_tree_cursor_current_node_state_id_wasm=Module._ts_tree_cursor_current_node_state_id_wasm=wasmExports.ts_tree_cursor_current_node_state_id_wasm)(n),_ts_tree_cursor_current_node_is_named_wasm=Module._ts_tree_cursor_current_node_is_named_wasm=n=>(_ts_tree_cursor_current_node_is_named_wasm=Module._ts_tree_cursor_current_node_is_named_wasm=wasmExports.ts_tree_cursor_current_node_is_named_wasm)(n),_ts_tree_cursor_current_node_is_missing_wasm=Module._ts_tree_cursor_current_node_is_missing_wasm=n=>(_ts_tree_cursor_current_node_is_missing_wasm=Module._ts_tree_cursor_current_node_is_missing_wasm=wasmExports.ts_tree_cursor_current_node_is_missing_wasm)(n),_ts_tree_cursor_current_node_id_wasm=Module._ts_tree_cursor_current_node_id_wasm=n=>(_ts_tree_cursor_current_node_id_wasm=Module._ts_tree_cursor_current_node_id_wasm=wasmExports.ts_tree_cursor_current_node_id_wasm)(n),_ts_tree_cursor_start_position_wasm=Module._ts_tree_cursor_start_position_wasm=n=>(_ts_tree_cursor_start_position_wasm=Module._ts_tree_cursor_start_position_wasm=wasmExports.ts_tree_cursor_start_position_wasm)(n),_ts_tree_cursor_end_position_wasm=Module._ts_tree_cursor_end_position_wasm=n=>(_ts_tree_cursor_end_position_wasm=Module._ts_tree_cursor_end_position_wasm=wasmExports.ts_tree_cursor_end_position_wasm)(n),_ts_tree_cursor_start_index_wasm=Module._ts_tree_cursor_start_index_wasm=n=>(_ts_tree_cursor_start_index_wasm=Module._ts_tree_cursor_start_index_wasm=wasmExports.ts_tree_cursor_start_index_wasm)(n),_ts_tree_cursor_end_index_wasm=Module._ts_tree_cursor_end_index_wasm=n=>(_ts_tree_cursor_end_index_wasm=Module._ts_tree_cursor_end_index_wasm=wasmExports.ts_tree_cursor_end_index_wasm)(n),_ts_tree_cursor_current_field_id_wasm=Module._ts_tree_cursor_current_field_id_wasm=n=>(_ts_tree_cursor_current_field_id_wasm=Module._ts_tree_cursor_current_field_id_wasm=wasmExports.ts_tree_cursor_current_field_id_wasm)(n),_ts_tree_cursor_current_depth_wasm=Module._ts_tree_cursor_current_depth_wasm=n=>(_ts_tree_cursor_current_depth_wasm=Module._ts_tree_cursor_current_depth_wasm=wasmExports.ts_tree_cursor_current_depth_wasm)(n),_ts_tree_cursor_current_descendant_index_wasm=Module._ts_tree_cursor_current_descendant_index_wasm=n=>(_ts_tree_cursor_current_descendant_index_wasm=Module._ts_tree_cursor_current_descendant_index_wasm=wasmExports.ts_tree_cursor_current_descendant_index_wasm)(n),_ts_tree_cursor_current_node_wasm=Module._ts_tree_cursor_current_node_wasm=n=>(_ts_tree_cursor_current_node_wasm=Module._ts_tree_cursor_current_node_wasm=wasmExports.ts_tree_cursor_current_node_wasm)(n),_ts_node_symbol_wasm=Module._ts_node_symbol_wasm=n=>(_ts_node_symbol_wasm=Module._ts_node_symbol_wasm=wasmExports.ts_node_symbol_wasm)(n),_ts_node_field_name_for_child_wasm=Module._ts_node_field_name_for_child_wasm=(n,e)=>(_ts_node_field_name_for_child_wasm=Module._ts_node_field_name_for_child_wasm=wasmExports.ts_node_field_name_for_child_wasm)(n,e),_ts_node_children_by_field_id_wasm=Module._ts_node_children_by_field_id_wasm=(n,e)=>(_ts_node_children_by_field_id_wasm=Module._ts_node_children_by_field_id_wasm=wasmExports.ts_node_children_by_field_id_wasm)(n,e),_ts_node_first_child_for_byte_wasm=Module._ts_node_first_child_for_byte_wasm=n=>(_ts_node_first_child_for_byte_wasm=Module._ts_node_first_child_for_byte_wasm=wasmExports.ts_node_first_child_for_byte_wasm)(n),_ts_node_first_named_child_for_byte_wasm=Module._ts_node_first_named_child_for_byte_wasm=n=>(_ts_node_first_named_child_for_byte_wasm=Module._ts_node_first_named_child_for_byte_wasm=wasmExports.ts_node_first_named_child_for_byte_wasm)(n),_ts_node_grammar_symbol_wasm=Module._ts_node_grammar_symbol_wasm=n=>(_ts_node_grammar_symbol_wasm=Module._ts_node_grammar_symbol_wasm=wasmExports.ts_node_grammar_symbol_wasm)(n),_ts_node_child_count_wasm=Module._ts_node_child_count_wasm=n=>(_ts_node_child_count_wasm=Module._ts_node_child_count_wasm=wasmExports.ts_node_child_count_wasm)(n),_ts_node_named_child_count_wasm=Module._ts_node_named_child_count_wasm=n=>(_ts_node_named_child_count_wasm=Module._ts_node_named_child_count_wasm=wasmExports.ts_node_named_child_count_wasm)(n),_ts_node_child_wasm=Module._ts_node_child_wasm=(n,e)=>(_ts_node_child_wasm=Module._ts_node_child_wasm=wasmExports.ts_node_child_wasm)(n,e),_ts_node_named_child_wasm=Module._ts_node_named_child_wasm=(n,e)=>(_ts_node_named_child_wasm=Module._ts_node_named_child_wasm=wasmExports.ts_node_named_child_wasm)(n,e),_ts_node_child_by_field_id_wasm=Module._ts_node_child_by_field_id_wasm=(n,e)=>(_ts_node_child_by_field_id_wasm=Module._ts_node_child_by_field_id_wasm=wasmExports.ts_node_child_by_field_id_wasm)(n,e),_ts_node_next_sibling_wasm=Module._ts_node_next_sibling_wasm=n=>(_ts_node_next_sibling_wasm=Module._ts_node_next_sibling_wasm=wasmExports.ts_node_next_sibling_wasm)(n),_ts_node_prev_sibling_wasm=Module._ts_node_prev_sibling_wasm=n=>(_ts_node_prev_sibling_wasm=Module._ts_node_prev_sibling_wasm=wasmExports.ts_node_prev_sibling_wasm)(n),_ts_node_next_named_sibling_wasm=Module._ts_node_next_named_sibling_wasm=n=>(_ts_node_next_named_sibling_wasm=Module._ts_node_next_named_sibling_wasm=wasmExports.ts_node_next_named_sibling_wasm)(n),_ts_node_prev_named_sibling_wasm=Module._ts_node_prev_named_sibling_wasm=n=>(_ts_node_prev_named_sibling_wasm=Module._ts_node_prev_named_sibling_wasm=wasmExports.ts_node_prev_named_sibling_wasm)(n),_ts_node_descendant_count_wasm=Module._ts_node_descendant_count_wasm=n=>(_ts_node_descendant_count_wasm=Module._ts_node_descendant_count_wasm=wasmExports.ts_node_descendant_count_wasm)(n),_ts_node_parent_wasm=Module._ts_node_parent_wasm=n=>(_ts_node_parent_wasm=Module._ts_node_parent_wasm=wasmExports.ts_node_parent_wasm)(n),_ts_node_descendant_for_index_wasm=Module._ts_node_descendant_for_index_wasm=n=>(_ts_node_descendant_for_index_wasm=Module._ts_node_descendant_for_index_wasm=wasmExports.ts_node_descendant_for_index_wasm)(n),_ts_node_named_descendant_for_index_wasm=Module._ts_node_named_descendant_for_index_wasm=n=>(_ts_node_named_descendant_for_index_wasm=Module._ts_node_named_descendant_for_index_wasm=wasmExports.ts_node_named_descendant_for_index_wasm)(n),_ts_node_descendant_for_position_wasm=Module._ts_node_descendant_for_position_wasm=n=>(_ts_node_descendant_for_position_wasm=Module._ts_node_descendant_for_position_wasm=wasmExports.ts_node_descendant_for_position_wasm)(n),_ts_node_named_descendant_for_position_wasm=Module._ts_node_named_descendant_for_position_wasm=n=>(_ts_node_named_descendant_for_position_wasm=Module._ts_node_named_descendant_for_position_wasm=wasmExports.ts_node_named_descendant_for_position_wasm)(n),_ts_node_start_point_wasm=Module._ts_node_start_point_wasm=n=>(_ts_node_start_point_wasm=Module._ts_node_start_point_wasm=wasmExports.ts_node_start_point_wasm)(n),_ts_node_end_point_wasm=Module._ts_node_end_point_wasm=n=>(_ts_node_end_point_wasm=Module._ts_node_end_point_wasm=wasmExports.ts_node_end_point_wasm)(n),_ts_node_start_index_wasm=Module._ts_node_start_index_wasm=n=>(_ts_node_start_index_wasm=Module._ts_node_start_index_wasm=wasmExports.ts_node_start_index_wasm)(n),_ts_node_end_index_wasm=Module._ts_node_end_index_wasm=n=>(_ts_node_end_index_wasm=Module._ts_node_end_index_wasm=wasmExports.ts_node_end_index_wasm)(n),_ts_node_to_string_wasm=Module._ts_node_to_string_wasm=n=>(_ts_node_to_string_wasm=Module._ts_node_to_string_wasm=wasmExports.ts_node_to_string_wasm)(n),_ts_node_children_wasm=Module._ts_node_children_wasm=n=>(_ts_node_children_wasm=Module._ts_node_children_wasm=wasmExports.ts_node_children_wasm)(n),_ts_node_named_children_wasm=Module._ts_node_named_children_wasm=n=>(_ts_node_named_children_wasm=Module._ts_node_named_children_wasm=wasmExports.ts_node_named_children_wasm)(n),_ts_node_descendants_of_type_wasm=Module._ts_node_descendants_of_type_wasm=(n,e,t,r,o,s,a)=>(_ts_node_descendants_of_type_wasm=Module._ts_node_descendants_of_type_wasm=wasmExports.ts_node_descendants_of_type_wasm)(n,e,t,r,o,s,a),_ts_node_is_named_wasm=Module._ts_node_is_named_wasm=n=>(_ts_node_is_named_wasm=Module._ts_node_is_named_wasm=wasmExports.ts_node_is_named_wasm)(n),_ts_node_has_changes_wasm=Module._ts_node_has_changes_wasm=n=>(_ts_node_has_changes_wasm=Module._ts_node_has_changes_wasm=wasmExports.ts_node_has_changes_wasm)(n),_ts_node_has_error_wasm=Module._ts_node_has_error_wasm=n=>(_ts_node_has_error_wasm=Module._ts_node_has_error_wasm=wasmExports.ts_node_has_error_wasm)(n),_ts_node_is_error_wasm=Module._ts_node_is_error_wasm=n=>(_ts_node_is_error_wasm=Module._ts_node_is_error_wasm=wasmExports.ts_node_is_error_wasm)(n),_ts_node_is_missing_wasm=Module._ts_node_is_missing_wasm=n=>(_ts_node_is_missing_wasm=Module._ts_node_is_missing_wasm=wasmExports.ts_node_is_missing_wasm)(n),_ts_node_is_extra_wasm=Module._ts_node_is_extra_wasm=n=>(_ts_node_is_extra_wasm=Module._ts_node_is_extra_wasm=wasmExports.ts_node_is_extra_wasm)(n),_ts_node_parse_state_wasm=Module._ts_node_parse_state_wasm=n=>(_ts_node_parse_state_wasm=Module._ts_node_parse_state_wasm=wasmExports.ts_node_parse_state_wasm)(n),_ts_node_next_parse_state_wasm=Module._ts_node_next_parse_state_wasm=n=>(_ts_node_next_parse_state_wasm=Module._ts_node_next_parse_state_wasm=wasmExports.ts_node_next_parse_state_wasm)(n),_ts_query_matches_wasm=Module._ts_query_matches_wasm=(n,e,t,r,o,s,a,c,l,u)=>(_ts_query_matches_wasm=Module._ts_query_matches_wasm=wasmExports.ts_query_matches_wasm)(n,e,t,r,o,s,a,c,l,u),_ts_query_captures_wasm=Module._ts_query_captures_wasm=(n,e,t,r,o,s,a,c,l,u)=>(_ts_query_captures_wasm=Module._ts_query_captures_wasm=wasmExports.ts_query_captures_wasm)(n,e,t,r,o,s,a,c,l,u),_iswalpha=Module._iswalpha=n=>(_iswalpha=Module._iswalpha=wasmExports.iswalpha)(n),_iswblank=Module._iswblank=n=>(_iswblank=Module._iswblank=wasmExports.iswblank)(n),_iswdigit=Module._iswdigit=n=>(_iswdigit=Module._iswdigit=wasmExports.iswdigit)(n),_iswlower=Module._iswlower=n=>(_iswlower=Module._iswlower=wasmExports.iswlower)(n),_iswupper=Module._iswupper=n=>(_iswupper=Module._iswupper=wasmExports.iswupper)(n),_iswxdigit=Module._iswxdigit=n=>(_iswxdigit=Module._iswxdigit=wasmExports.iswxdigit)(n),_memchr=Module._memchr=(n,e,t)=>(_memchr=Module._memchr=wasmExports.memchr)(n,e,t),_strlen=Module._strlen=n=>(_strlen=Module._strlen=wasmExports.strlen)(n),_strcmp=Module._strcmp=(n,e)=>(_strcmp=Module._strcmp=wasmExports.strcmp)(n,e),_strncat=Module._strncat=(n,e,t)=>(_strncat=Module._strncat=wasmExports.strncat)(n,e,t),_strncpy=Module._strncpy=(n,e,t)=>(_strncpy=Module._strncpy=wasmExports.strncpy)(n,e,t),_towlower=Module._towlower=n=>(_towlower=Module._towlower=wasmExports.towlower)(n),_towupper=Module._towupper=n=>(_towupper=Module._towupper=wasmExports.towupper)(n),_setThrew=(n,e)=>(_setThrew=wasmExports.setThrew)(n,e),stackSave=()=>(stackSave=wasmExports.stackSave)(),stackRestore=n=>(stackRestore=wasmExports.stackRestore)(n),stackAlloc=n=>(stackAlloc=wasmExports.stackAlloc)(n),dynCall_jiji=Module.dynCall_jiji=(n,e,t,r,o)=>(dynCall_jiji=Module.dynCall_jiji=wasmExports.dynCall_jiji)(n,e,t,r,o),_orig$ts_parser_timeout_micros=Module._orig$ts_parser_timeout_micros=n=>(_orig$ts_parser_timeout_micros=Module._orig$ts_parser_timeout_micros=wasmExports.orig$ts_parser_timeout_micros)(n),_orig$ts_parser_set_timeout_micros=Module._orig$ts_parser_set_timeout_micros=(n,e)=>(_orig$ts_parser_set_timeout_micros=Module._orig$ts_parser_set_timeout_micros=wasmExports.orig$ts_parser_set_timeout_micros)(n,e),calledRun;function callMain(n=[]){var e=resolveGlobalSymbol("main").sym;if(e){n.unshift(thisProgram);var t=n.length,r=stackAlloc(4*(t+1)),o=r;n.forEach(a=>{HEAPU32[o>>2]=stringToUTF8OnStack(a),o+=4}),HEAPU32[o>>2]=0;try{var s=e(t,r);return exitJS(s,!0),s}catch(a){return handleException(a)}}}function run(n=arguments_){function e(){calledRun||(calledRun=!0,Module.calledRun=!0,ABORT||(initRuntime(),preMain(),Module.onRuntimeInitialized&&Module.onRuntimeInitialized(),shouldRunNow&&callMain(n),postRun()))}runDependencies>0||(preRun(),runDependencies>0||(Module.setStatus?(Module.setStatus("Running..."),setTimeout(function(){setTimeout(function(){Module.setStatus("")},1),e()},1)):e()))}if(Module.AsciiToString=AsciiToString,Module.stringToUTF16=stringToUTF16,dependenciesFulfilled=function n(){calledRun||run(),calledRun||(dependenciesFulfilled=n)},Module.preInit)for(typeof Module.preInit=="function"&&(Module.preInit=[Module.preInit]);Module.preInit.length>0;)Module.preInit.pop()();var shouldRunNow=!0;Module.noInitialRun&&(shouldRunNow=!1),run();let C=Module,INTERNAL={},SIZE_OF_INT=4,SIZE_OF_CURSOR=4*SIZE_OF_INT,SIZE_OF_NODE=5*SIZE_OF_INT,SIZE_OF_POINT=2*SIZE_OF_INT,SIZE_OF_RANGE=2*SIZE_OF_INT+2*SIZE_OF_POINT,ZERO_POINT={row:0,column:0},QUERY_WORD_REGEX=/[\w-.]*/g,PREDICATE_STEP_TYPE_CAPTURE=1,PREDICATE_STEP_TYPE_STRING=2,LANGUAGE_FUNCTION_REGEX=/^_?tree_sitter_\w+/,VERSION,MIN_COMPATIBLE_VERSION,TRANSFER_BUFFER,currentParseCallback,currentLogCallback;class ParserImpl{static init(){TRANSFER_BUFFER=C._ts_init(),VERSION=getValue(TRANSFER_BUFFER,"i32"),MIN_COMPATIBLE_VERSION=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32")}initialize(){C._ts_parser_new_wasm(),this[0]=getValue(TRANSFER_BUFFER,"i32"),this[1]=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32")}delete(){C._ts_parser_delete(this[0]),C._free(this[1]),this[0]=0,this[1]=0}setLanguage(e){let t;if(e){if(e.constructor!==Language)throw new Error("Argument must be a Language");{t=e[0];let r=C._ts_language_version(t);if(r<MIN_COMPATIBLE_VERSION||VERSION<r)throw new Error(`Incompatible language version ${r}. Compatibility range ${MIN_COMPATIBLE_VERSION} through ${VERSION}.`)}}else t=0,e=null;return this.language=e,C._ts_parser_set_language(this[0],t),this}getLanguage(){return this.language}parse(e,t,r){if(typeof e=="string")currentParseCallback=(l,u)=>e.slice(l);else{if(typeof e!="function")throw new Error("Argument must be a string or a function");currentParseCallback=e}this.logCallback?(currentLogCallback=this.logCallback,C._ts_parser_enable_logger_wasm(this[0],1)):(currentLogCallback=null,C._ts_parser_enable_logger_wasm(this[0],0));let o=0,s=0;if(r?.includedRanges){o=r.includedRanges.length,s=C._calloc(o,SIZE_OF_RANGE);let l=s;for(let u=0;u<o;u++)marshalRange(l,r.includedRanges[u]),l+=SIZE_OF_RANGE}let a=C._ts_parser_parse_wasm(this[0],this[1],t?t[0]:0,s,o);if(!a)throw currentParseCallback=null,currentLogCallback=null,new Error("Parsing failed");let c=new Tree(INTERNAL,a,this.language,currentParseCallback);return currentParseCallback=null,currentLogCallback=null,c}reset(){C._ts_parser_reset(this[0])}getIncludedRanges(){C._ts_parser_included_ranges_wasm(this[0]);let e=getValue(TRANSFER_BUFFER,"i32"),t=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),r=new Array(e);if(e>0){let o=t;for(let s=0;s<e;s++)r[s]=unmarshalRange(o),o+=SIZE_OF_RANGE;C._free(t)}return r}getTimeoutMicros(){return C._ts_parser_timeout_micros(this[0])}setTimeoutMicros(e){C._ts_parser_set_timeout_micros(this[0],e)}setLogger(e){if(e){if(typeof e!="function")throw new Error("Logger callback must be a function")}else e=null;return this.logCallback=e,this}getLogger(){return this.logCallback}}class Tree{constructor(e,t,r,o){assertInternal(e),this[0]=t,this.language=r,this.textCallback=o}copy(){let e=C._ts_tree_copy(this[0]);return new Tree(INTERNAL,e,this.language,this.textCallback)}delete(){C._ts_tree_delete(this[0]),this[0]=0}edit(e){marshalEdit(e),C._ts_tree_edit_wasm(this[0])}get rootNode(){return C._ts_tree_root_node_wasm(this[0]),unmarshalNode(this)}rootNodeWithOffset(e,t){let r=TRANSFER_BUFFER+SIZE_OF_NODE;return setValue(r,e,"i32"),marshalPoint(r+SIZE_OF_INT,t),C._ts_tree_root_node_with_offset_wasm(this[0]),unmarshalNode(this)}getLanguage(){return this.language}walk(){return this.rootNode.walk()}getChangedRanges(e){if(e.constructor!==Tree)throw new TypeError("Argument must be a Tree");C._ts_tree_get_changed_ranges_wasm(this[0],e[0]);let t=getValue(TRANSFER_BUFFER,"i32"),r=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),o=new Array(t);if(t>0){let s=r;for(let a=0;a<t;a++)o[a]=unmarshalRange(s),s+=SIZE_OF_RANGE;C._free(r)}return o}getIncludedRanges(){C._ts_tree_included_ranges_wasm(this[0]);let e=getValue(TRANSFER_BUFFER,"i32"),t=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),r=new Array(e);if(e>0){let o=t;for(let s=0;s<e;s++)r[s]=unmarshalRange(o),o+=SIZE_OF_RANGE;C._free(t)}return r}}class Node{constructor(e,t){assertInternal(e),this.tree=t}get typeId(){return marshalNode(this),C._ts_node_symbol_wasm(this.tree[0])}get grammarId(){return marshalNode(this),C._ts_node_grammar_symbol_wasm(this.tree[0])}get type(){return this.tree.language.types[this.typeId]||"ERROR"}get grammarType(){return this.tree.language.types[this.grammarId]||"ERROR"}get endPosition(){return marshalNode(this),C._ts_node_end_point_wasm(this.tree[0]),unmarshalPoint(TRANSFER_BUFFER)}get endIndex(){return marshalNode(this),C._ts_node_end_index_wasm(this.tree[0])}get text(){return getText(this.tree,this.startIndex,this.endIndex)}get parseState(){return marshalNode(this),C._ts_node_parse_state_wasm(this.tree[0])}get nextParseState(){return marshalNode(this),C._ts_node_next_parse_state_wasm(this.tree[0])}get isNamed(){return marshalNode(this),C._ts_node_is_named_wasm(this.tree[0])===1}get hasError(){return marshalNode(this),C._ts_node_has_error_wasm(this.tree[0])===1}get hasChanges(){return marshalNode(this),C._ts_node_has_changes_wasm(this.tree[0])===1}get isError(){return marshalNode(this),C._ts_node_is_error_wasm(this.tree[0])===1}get isMissing(){return marshalNode(this),C._ts_node_is_missing_wasm(this.tree[0])===1}get isExtra(){return marshalNode(this),C._ts_node_is_extra_wasm(this.tree[0])===1}equals(e){return this.id===e.id}child(e){return marshalNode(this),C._ts_node_child_wasm(this.tree[0],e),unmarshalNode(this.tree)}namedChild(e){return marshalNode(this),C._ts_node_named_child_wasm(this.tree[0],e),unmarshalNode(this.tree)}childForFieldId(e){return marshalNode(this),C._ts_node_child_by_field_id_wasm(this.tree[0],e),unmarshalNode(this.tree)}childForFieldName(e){let t=this.tree.language.fields.indexOf(e);return t!==-1?this.childForFieldId(t):null}fieldNameForChild(e){marshalNode(this);let t=C._ts_node_field_name_for_child_wasm(this.tree[0],e);return t?AsciiToString(t):null}childrenForFieldName(e){let t=this.tree.language.fields.indexOf(e);return t!==-1&&t!==0?this.childrenForFieldId(t):[]}childrenForFieldId(e){marshalNode(this),C._ts_node_children_by_field_id_wasm(this.tree[0],e);let t=getValue(TRANSFER_BUFFER,"i32"),r=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),o=new Array(t);if(t>0){let s=r;for(let a=0;a<t;a++)o[a]=unmarshalNode(this.tree,s),s+=SIZE_OF_NODE;C._free(r)}return o}firstChildForIndex(e){return marshalNode(this),setValue(TRANSFER_BUFFER+SIZE_OF_NODE,e,"i32"),C._ts_node_first_child_for_byte_wasm(this.tree[0]),unmarshalNode(this.tree)}firstNamedChildForIndex(e){return marshalNode(this),setValue(TRANSFER_BUFFER+SIZE_OF_NODE,e,"i32"),C._ts_node_first_named_child_for_byte_wasm(this.tree[0]),unmarshalNode(this.tree)}get childCount(){return marshalNode(this),C._ts_node_child_count_wasm(this.tree[0])}get namedChildCount(){return marshalNode(this),C._ts_node_named_child_count_wasm(this.tree[0])}get firstChild(){return this.child(0)}get firstNamedChild(){return this.namedChild(0)}get lastChild(){return this.child(this.childCount-1)}get lastNamedChild(){return this.namedChild(this.namedChildCount-1)}get children(){if(!this._children){marshalNode(this),C._ts_node_children_wasm(this.tree[0]);let e=getValue(TRANSFER_BUFFER,"i32"),t=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32");if(this._children=new Array(e),e>0){let r=t;for(let o=0;o<e;o++)this._children[o]=unmarshalNode(this.tree,r),r+=SIZE_OF_NODE;C._free(t)}}return this._children}get namedChildren(){if(!this._namedChildren){marshalNode(this),C._ts_node_named_children_wasm(this.tree[0]);let e=getValue(TRANSFER_BUFFER,"i32"),t=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32");if(this._namedChildren=new Array(e),e>0){let r=t;for(let o=0;o<e;o++)this._namedChildren[o]=unmarshalNode(this.tree,r),r+=SIZE_OF_NODE;C._free(t)}}return this._namedChildren}descendantsOfType(e,t,r){Array.isArray(e)||(e=[e]),t||(t=ZERO_POINT),r||(r=ZERO_POINT);let o=[],s=this.tree.language.types;for(let d=0,p=s.length;d<p;d++)e.includes(s[d])&&o.push(d);let a=C._malloc(SIZE_OF_INT*o.length);for(let d=0,p=o.length;d<p;d++)setValue(a+d*SIZE_OF_INT,o[d],"i32");marshalNode(this),C._ts_node_descendants_of_type_wasm(this.tree[0],a,o.length,t.row,t.column,r.row,r.column);let c=getValue(TRANSFER_BUFFER,"i32"),l=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),u=new Array(c);if(c>0){let d=l;for(let p=0;p<c;p++)u[p]=unmarshalNode(this.tree,d),d+=SIZE_OF_NODE}return C._free(l),C._free(a),u}get nextSibling(){return marshalNode(this),C._ts_node_next_sibling_wasm(this.tree[0]),unmarshalNode(this.tree)}get previousSibling(){return marshalNode(this),C._ts_node_prev_sibling_wasm(this.tree[0]),unmarshalNode(this.tree)}get nextNamedSibling(){return marshalNode(this),C._ts_node_next_named_sibling_wasm(this.tree[0]),unmarshalNode(this.tree)}get previousNamedSibling(){return marshalNode(this),C._ts_node_prev_named_sibling_wasm(this.tree[0]),unmarshalNode(this.tree)}get descendantCount(){return marshalNode(this),C._ts_node_descendant_count_wasm(this.tree[0])}get parent(){return marshalNode(this),C._ts_node_parent_wasm(this.tree[0]),unmarshalNode(this.tree)}descendantForIndex(e,t=e){if(typeof e!="number"||typeof t!="number")throw new Error("Arguments must be numbers");marshalNode(this);let r=TRANSFER_BUFFER+SIZE_OF_NODE;return setValue(r,e,"i32"),setValue(r+SIZE_OF_INT,t,"i32"),C._ts_node_descendant_for_index_wasm(this.tree[0]),unmarshalNode(this.tree)}namedDescendantForIndex(e,t=e){if(typeof e!="number"||typeof t!="number")throw new Error("Arguments must be numbers");marshalNode(this);let r=TRANSFER_BUFFER+SIZE_OF_NODE;return setValue(r,e,"i32"),setValue(r+SIZE_OF_INT,t,"i32"),C._ts_node_named_descendant_for_index_wasm(this.tree[0]),unmarshalNode(this.tree)}descendantForPosition(e,t=e){if(!isPoint(e)||!isPoint(t))throw new Error("Arguments must be {row, column} objects");marshalNode(this);let r=TRANSFER_BUFFER+SIZE_OF_NODE;return marshalPoint(r,e),marshalPoint(r+SIZE_OF_POINT,t),C._ts_node_descendant_for_position_wasm(this.tree[0]),unmarshalNode(this.tree)}namedDescendantForPosition(e,t=e){if(!isPoint(e)||!isPoint(t))throw new Error("Arguments must be {row, column} objects");marshalNode(this);let r=TRANSFER_BUFFER+SIZE_OF_NODE;return marshalPoint(r,e),marshalPoint(r+SIZE_OF_POINT,t),C._ts_node_named_descendant_for_position_wasm(this.tree[0]),unmarshalNode(this.tree)}walk(){return marshalNode(this),C._ts_tree_cursor_new_wasm(this.tree[0]),new TreeCursor(INTERNAL,this.tree)}toString(){marshalNode(this);let e=C._ts_node_to_string_wasm(this.tree[0]),t=AsciiToString(e);return C._free(e),t}}class TreeCursor{constructor(e,t){assertInternal(e),this.tree=t,unmarshalTreeCursor(this)}delete(){marshalTreeCursor(this),C._ts_tree_cursor_delete_wasm(this.tree[0]),this[0]=this[1]=this[2]=0}reset(e){marshalNode(e),marshalTreeCursor(this,TRANSFER_BUFFER+SIZE_OF_NODE),C._ts_tree_cursor_reset_wasm(this.tree[0]),unmarshalTreeCursor(this)}resetTo(e){marshalTreeCursor(this,TRANSFER_BUFFER),marshalTreeCursor(e,TRANSFER_BUFFER+SIZE_OF_CURSOR),C._ts_tree_cursor_reset_to_wasm(this.tree[0],e.tree[0]),unmarshalTreeCursor(this)}get nodeType(){return this.tree.language.types[this.nodeTypeId]||"ERROR"}get nodeTypeId(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_type_id_wasm(this.tree[0])}get nodeStateId(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_state_id_wasm(this.tree[0])}get nodeId(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_id_wasm(this.tree[0])}get nodeIsNamed(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_is_named_wasm(this.tree[0])===1}get nodeIsMissing(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_is_missing_wasm(this.tree[0])===1}get nodeText(){marshalTreeCursor(this);let e=C._ts_tree_cursor_start_index_wasm(this.tree[0]),t=C._ts_tree_cursor_end_index_wasm(this.tree[0]);return getText(this.tree,e,t)}get startPosition(){return marshalTreeCursor(this),C._ts_tree_cursor_start_position_wasm(this.tree[0]),unmarshalPoint(TRANSFER_BUFFER)}get endPosition(){return marshalTreeCursor(this),C._ts_tree_cursor_end_position_wasm(this.tree[0]),unmarshalPoint(TRANSFER_BUFFER)}get startIndex(){return marshalTreeCursor(this),C._ts_tree_cursor_start_index_wasm(this.tree[0])}get endIndex(){return marshalTreeCursor(this),C._ts_tree_cursor_end_index_wasm(this.tree[0])}get currentNode(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_wasm(this.tree[0]),unmarshalNode(this.tree)}get currentFieldId(){return marshalTreeCursor(this),C._ts_tree_cursor_current_field_id_wasm(this.tree[0])}get currentFieldName(){return this.tree.language.fields[this.currentFieldId]}get currentDepth(){return marshalTreeCursor(this),C._ts_tree_cursor_current_depth_wasm(this.tree[0])}get currentDescendantIndex(){return marshalTreeCursor(this),C._ts_tree_cursor_current_descendant_index_wasm(this.tree[0])}gotoFirstChild(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_first_child_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}gotoLastChild(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_last_child_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}gotoFirstChildForIndex(e){marshalTreeCursor(this),setValue(TRANSFER_BUFFER+SIZE_OF_CURSOR,e,"i32");let t=C._ts_tree_cursor_goto_first_child_for_index_wasm(this.tree[0]);return unmarshalTreeCursor(this),t===1}gotoFirstChildForPosition(e){marshalTreeCursor(this),marshalPoint(TRANSFER_BUFFER+SIZE_OF_CURSOR,e);let t=C._ts_tree_cursor_goto_first_child_for_position_wasm(this.tree[0]);return unmarshalTreeCursor(this),t===1}gotoNextSibling(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_next_sibling_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}gotoPreviousSibling(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_previous_sibling_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}gotoDescendant(e){marshalTreeCursor(this),C._ts_tree_cursor_goto_descendant_wasm(this.tree[0],e),unmarshalTreeCursor(this)}gotoParent(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_parent_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}}class Language{constructor(e,t){assertInternal(e),this[0]=t,this.types=new Array(C._ts_language_symbol_count(this[0]));for(let r=0,o=this.types.length;r<o;r++)C._ts_language_symbol_type(this[0],r)<2&&(this.types[r]=UTF8ToString(C._ts_language_symbol_name(this[0],r)));this.fields=new Array(C._ts_language_field_count(this[0])+1);for(let r=0,o=this.fields.length;r<o;r++){let s=C._ts_language_field_name_for_id(this[0],r);this.fields[r]=s!==0?UTF8ToString(s):null}}get version(){return C._ts_language_version(this[0])}get fieldCount(){return this.fields.length-1}get stateCount(){return C._ts_language_state_count(this[0])}fieldIdForName(e){let t=this.fields.indexOf(e);return t!==-1?t:null}fieldNameForId(e){return this.fields[e]||null}idForNodeType(e,t){let r=lengthBytesUTF8(e),o=C._malloc(r+1);stringToUTF8(e,o,r+1);let s=C._ts_language_symbol_for_name(this[0],o,r,t);return C._free(o),s||null}get nodeTypeCount(){return C._ts_language_symbol_count(this[0])}nodeTypeForId(e){let t=C._ts_language_symbol_name(this[0],e);return t?UTF8ToString(t):null}nodeTypeIsNamed(e){return!!C._ts_language_type_is_named_wasm(this[0],e)}nodeTypeIsVisible(e){return!!C._ts_language_type_is_visible_wasm(this[0],e)}nextState(e,t){return C._ts_language_next_state(this[0],e,t)}lookaheadIterator(e){let t=C._ts_lookahead_iterator_new(this[0],e);return t?new LookaheadIterable(INTERNAL,t,this):null}query(e){let t=lengthBytesUTF8(e),r=C._malloc(t+1);stringToUTF8(e,r,t+1);let o=C._ts_query_new(this[0],r,t,TRANSFER_BUFFER,TRANSFER_BUFFER+SIZE_OF_INT);if(!o){let g=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),y=getValue(TRANSFER_BUFFER,"i32"),b=UTF8ToString(r,y).length,_=e.substr(b,100).split(`
`)[0],x,I=_.match(QUERY_WORD_REGEX)[0];switch(g){case 2:x=new RangeError(`Bad node name '${I}'`);break;case 3:x=new RangeError(`Bad field name '${I}'`);break;case 4:x=new RangeError(`Bad capture name @${I}`);break;case 5:x=new TypeError(`Bad pattern structure at offset ${b}: '${_}'...`),I="";break;default:x=new SyntaxError(`Bad syntax at offset ${b}: '${_}'...`),I=""}throw x.index=b,x.length=I.length,C._free(r),x}let s=C._ts_query_string_count(o),a=C._ts_query_capture_count(o),c=C._ts_query_pattern_count(o),l=new Array(a),u=new Array(s);for(let g=0;g<a;g++){let y=C._ts_query_capture_name_for_id(o,g,TRANSFER_BUFFER),b=getValue(TRANSFER_BUFFER,"i32");l[g]=UTF8ToString(y,b)}for(let g=0;g<s;g++){let y=C._ts_query_string_value_for_id(o,g,TRANSFER_BUFFER),b=getValue(TRANSFER_BUFFER,"i32");u[g]=UTF8ToString(y,b)}let d=new Array(c),p=new Array(c),f=new Array(c),m=new Array(c),h=new Array(c);for(let g=0;g<c;g++){let y=C._ts_query_predicates_for_pattern(o,g,TRANSFER_BUFFER),b=getValue(TRANSFER_BUFFER,"i32");m[g]=[],h[g]=[];let _=[],x=y;for(let I=0;I<b;I++){let S=getValue(x,"i32");x+=SIZE_OF_INT;let w=getValue(x,"i32");if(x+=SIZE_OF_INT,S===PREDICATE_STEP_TYPE_CAPTURE)_.push({type:"capture",name:l[w]});else if(S===PREDICATE_STEP_TYPE_STRING)_.push({type:"string",value:u[w]});else if(_.length>0){if(_[0].type!=="string")throw new Error("Predicates must begin with a literal value");let R=_[0].value,k,V=!0,F=!0;switch(R){case"any-not-eq?":case"not-eq?":V=!1;case"any-eq?":case"eq?":if(_.length!==3)throw new Error(`Wrong number of arguments to \`#${R}\` predicate. Expected 2, got ${_.length-1}`);if(_[1].type!=="capture")throw new Error(`First argument of \`#${R}\` predicate must be a capture. Got "${_[1].value}"`);if(F=!R.startsWith("any-"),_[2].type==="capture"){let D=_[1].name,A=_[2].name;h[g].push(B=>{let U=[],W=[];for(let Y of B)Y.name===D&&U.push(Y.node),Y.name===A&&W.push(Y.node);let ae=(Y,X,Se)=>Se?Y.text===X.text:Y.text!==X.text;return F?U.every(Y=>W.some(X=>ae(Y,X,V))):U.some(Y=>W.some(X=>ae(Y,X,V)))})}else{k=_[1].name;let D=_[2].value,A=U=>U.text===D,B=U=>U.text!==D;h[g].push(U=>{let W=[];for(let Y of U)Y.name===k&&W.push(Y.node);let ae=V?A:B;return F?W.every(ae):W.some(ae)})}break;case"any-not-match?":case"not-match?":V=!1;case"any-match?":case"match?":if(_.length!==3)throw new Error(`Wrong number of arguments to \`#${R}\` predicate. Expected 2, got ${_.length-1}.`);if(_[1].type!=="capture")throw new Error(`First argument of \`#${R}\` predicate must be a capture. Got "${_[1].value}".`);if(_[2].type!=="string")throw new Error(`Second argument of \`#${R}\` predicate must be a string. Got @${_[2].value}.`);k=_[1].name;let K=new RegExp(_[2].value);F=!R.startsWith("any-"),h[g].push(D=>{let A=[];for(let U of D)U.name===k&&A.push(U.node.text);let B=(U,W)=>W?K.test(U):!K.test(U);return A.length===0?!V:F?A.every(U=>B(U,V)):A.some(U=>B(U,V))});break;case"set!":if(_.length<2||_.length>3)throw new Error(`Wrong number of arguments to \`#set!\` predicate. Expected 1 or 2. Got ${_.length-1}.`);if(_.some(D=>D.type!=="string"))throw new Error('Arguments to `#set!` predicate must be a strings.".');d[g]||(d[g]={}),d[g][_[1].value]=_[2]?_[2].value:null;break;case"is?":case"is-not?":if(_.length<2||_.length>3)throw new Error(`Wrong number of arguments to \`#${R}\` predicate. Expected 1 or 2. Got ${_.length-1}.`);if(_.some(D=>D.type!=="string"))throw new Error(`Arguments to \`#${R}\` predicate must be a strings.".`);let $=R==="is?"?p:f;$[g]||($[g]={}),$[g][_[1].value]=_[2]?_[2].value:null;break;case"not-any-of?":V=!1;case"any-of?":if(_.length<2)throw new Error(`Wrong number of arguments to \`#${R}\` predicate. Expected at least 1. Got ${_.length-1}.`);if(_[1].type!=="capture")throw new Error(`First argument of \`#${R}\` predicate must be a capture. Got "${_[1].value}".`);for(let D=2;D<_.length;D++)if(_[D].type!=="string")throw new Error(`Arguments to \`#${R}\` predicate must be a strings.".`);k=_[1].name;let j=_.slice(2).map(D=>D.value);h[g].push(D=>{let A=[];for(let B of D)B.name===k&&A.push(B.node.text);return A.length===0?!V:A.every(B=>j.includes(B))===V});break;default:m[g].push({operator:R,operands:_.slice(1)})}_.length=0}}Object.freeze(d[g]),Object.freeze(p[g]),Object.freeze(f[g])}return C._free(r),new Query(INTERNAL,o,l,h,m,Object.freeze(d),Object.freeze(p),Object.freeze(f))}static load(e){let t;if(e instanceof Uint8Array)t=Promise.resolve(e);else{let r=e;if(typeof process<"u"&&process.versions&&process.versions.node){let o=require("fs");t=Promise.resolve(o.readFileSync(r))}else t=fetch(r).then(o=>o.arrayBuffer().then(s=>{if(o.ok)return new Uint8Array(s);{let a=new TextDecoder("utf-8").decode(s);throw new Error(`Language.load failed with status ${o.status}.

${a}`)}}))}return t.then(r=>loadWebAssemblyModule(r,{loadAsync:!0})).then(r=>{let o=Object.keys(r),s=o.find(c=>LANGUAGE_FUNCTION_REGEX.test(c)&&!c.includes("external_scanner_"));s||console.log(`Couldn't find language function in WASM file. Symbols:
${JSON.stringify(o,null,2)}`);let a=r[s]();return new Language(INTERNAL,a)})}}class LookaheadIterable{constructor(e,t,r){assertInternal(e),this[0]=t,this.language=r}get currentTypeId(){return C._ts_lookahead_iterator_current_symbol(this[0])}get currentType(){return this.language.types[this.currentTypeId]||"ERROR"}delete(){C._ts_lookahead_iterator_delete(this[0]),this[0]=0}resetState(e){return C._ts_lookahead_iterator_reset_state(this[0],e)}reset(e,t){return!!C._ts_lookahead_iterator_reset(this[0],e[0],t)&&(this.language=e,!0)}[Symbol.iterator](){let e=this;return{next:()=>C._ts_lookahead_iterator_next(e[0])?{done:!1,value:e.currentType}:{done:!0,value:""}}}}class Query{constructor(e,t,r,o,s,a,c,l){assertInternal(e),this[0]=t,this.captureNames=r,this.textPredicates=o,this.predicates=s,this.setProperties=a,this.assertedProperties=c,this.refutedProperties=l,this.exceededMatchLimit=!1}delete(){C._ts_query_delete(this[0]),this[0]=0}matches(e,{startPosition:t=ZERO_POINT,endPosition:r=ZERO_POINT,startIndex:o=0,endIndex:s=0,matchLimit:a=4294967295,maxStartDepth:c=4294967295}={}){if(typeof a!="number")throw new Error("Arguments must be numbers");marshalNode(e),C._ts_query_matches_wasm(this[0],e.tree[0],t.row,t.column,r.row,r.column,o,s,a,c);let l=getValue(TRANSFER_BUFFER,"i32"),u=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),d=getValue(TRANSFER_BUFFER+2*SIZE_OF_INT,"i32"),p=new Array(l);this.exceededMatchLimit=!!d;let f=0,m=u;for(let h=0;h<l;h++){let g=getValue(m,"i32");m+=SIZE_OF_INT;let y=getValue(m,"i32");m+=SIZE_OF_INT;let b=new Array(y);if(m=unmarshalCaptures(this,e.tree,m,b),this.textPredicates[g].every(_=>_(b))){p[f]={pattern:g,captures:b};let _=this.setProperties[g];_&&(p[f].setProperties=_);let x=this.assertedProperties[g];x&&(p[f].assertedProperties=x);let I=this.refutedProperties[g];I&&(p[f].refutedProperties=I),f++}}return p.length=f,C._free(u),p}captures(e,{startPosition:t=ZERO_POINT,endPosition:r=ZERO_POINT,startIndex:o=0,endIndex:s=0,matchLimit:a=4294967295,maxStartDepth:c=4294967295}={}){if(typeof a!="number")throw new Error("Arguments must be numbers");marshalNode(e),C._ts_query_captures_wasm(this[0],e.tree[0],t.row,t.column,r.row,r.column,o,s,a,c);let l=getValue(TRANSFER_BUFFER,"i32"),u=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),d=getValue(TRANSFER_BUFFER+2*SIZE_OF_INT,"i32"),p=[];this.exceededMatchLimit=!!d;let f=[],m=u;for(let h=0;h<l;h++){let g=getValue(m,"i32");m+=SIZE_OF_INT;let y=getValue(m,"i32");m+=SIZE_OF_INT;let b=getValue(m,"i32");if(m+=SIZE_OF_INT,f.length=y,m=unmarshalCaptures(this,e.tree,m,f),this.textPredicates[g].every(_=>_(f))){let _=f[b],x=this.setProperties[g];x&&(_.setProperties=x);let I=this.assertedProperties[g];I&&(_.assertedProperties=I);let S=this.refutedProperties[g];S&&(_.refutedProperties=S),p.push(_)}}return C._free(u),p}predicatesForPattern(e){return this.predicates[e]}disableCapture(e){let t=lengthBytesUTF8(e),r=C._malloc(t+1);stringToUTF8(e,r,t+1),C._ts_query_disable_capture(this[0],r,t),C._free(r)}didExceedMatchLimit(){return this.exceededMatchLimit}}function getText(n,e,t){let r=t-e,o=n.textCallback(e,null,t);for(e+=o.length;e<t;){let s=n.textCallback(e,null,t);if(!(s&&s.length>0))break;e+=s.length,o+=s}return e>t&&(o=o.slice(0,r)),o}function unmarshalCaptures(n,e,t,r){for(let o=0,s=r.length;o<s;o++){let a=getValue(t,"i32"),c=unmarshalNode(e,t+=SIZE_OF_INT);t+=SIZE_OF_NODE,r[o]={name:n.captureNames[a],node:c}}return t}function assertInternal(n){if(n!==INTERNAL)throw new Error("Illegal constructor")}function isPoint(n){return n&&typeof n.row=="number"&&typeof n.column=="number"}function marshalNode(n){let e=TRANSFER_BUFFER;setValue(e,n.id,"i32"),e+=SIZE_OF_INT,setValue(e,n.startIndex,"i32"),e+=SIZE_OF_INT,setValue(e,n.startPosition.row,"i32"),e+=SIZE_OF_INT,setValue(e,n.startPosition.column,"i32"),e+=SIZE_OF_INT,setValue(e,n[0],"i32")}function unmarshalNode(n,e=TRANSFER_BUFFER){let t=getValue(e,"i32");if(t===0)return null;let r=getValue(e+=SIZE_OF_INT,"i32"),o=getValue(e+=SIZE_OF_INT,"i32"),s=getValue(e+=SIZE_OF_INT,"i32"),a=getValue(e+=SIZE_OF_INT,"i32"),c=new Node(INTERNAL,n);return c.id=t,c.startIndex=r,c.startPosition={row:o,column:s},c[0]=a,c}function marshalTreeCursor(n,e=TRANSFER_BUFFER){setValue(e+0*SIZE_OF_INT,n[0],"i32"),setValue(e+1*SIZE_OF_INT,n[1],"i32"),setValue(e+2*SIZE_OF_INT,n[2],"i32"),setValue(e+3*SIZE_OF_INT,n[3],"i32")}function unmarshalTreeCursor(n){n[0]=getValue(TRANSFER_BUFFER+0*SIZE_OF_INT,"i32"),n[1]=getValue(TRANSFER_BUFFER+1*SIZE_OF_INT,"i32"),n[2]=getValue(TRANSFER_BUFFER+2*SIZE_OF_INT,"i32"),n[3]=getValue(TRANSFER_BUFFER+3*SIZE_OF_INT,"i32")}function marshalPoint(n,e){setValue(n,e.row,"i32"),setValue(n+SIZE_OF_INT,e.column,"i32")}function unmarshalPoint(n){return{row:getValue(n,"i32")>>>0,column:getValue(n+SIZE_OF_INT,"i32")>>>0}}function marshalRange(n,e){marshalPoint(n,e.startPosition),marshalPoint(n+=SIZE_OF_POINT,e.endPosition),setValue(n+=SIZE_OF_POINT,e.startIndex,"i32"),setValue(n+=SIZE_OF_INT,e.endIndex,"i32"),n+=SIZE_OF_INT}function unmarshalRange(n){let e={};return e.startPosition=unmarshalPoint(n),n+=SIZE_OF_POINT,e.endPosition=unmarshalPoint(n),n+=SIZE_OF_POINT,e.startIndex=getValue(n,"i32")>>>0,n+=SIZE_OF_INT,e.endIndex=getValue(n,"i32")>>>0,e}function marshalEdit(n){let e=TRANSFER_BUFFER;marshalPoint(e,n.startPosition),e+=SIZE_OF_POINT,marshalPoint(e,n.oldEndPosition),e+=SIZE_OF_POINT,marshalPoint(e,n.newEndPosition),e+=SIZE_OF_POINT,setValue(e,n.startIndex,"i32"),e+=SIZE_OF_INT,setValue(e,n.oldEndIndex,"i32"),e+=SIZE_OF_INT,setValue(e,n.newEndIndex,"i32"),e+=SIZE_OF_INT}for(let n of Object.getOwnPropertyNames(ParserImpl.prototype))Object.defineProperty(Parser.prototype,n,{value:ParserImpl.prototype[n],enumerable:!1,writable:!1});Parser.Language=Language,Module.onRuntimeInitialized=()=>{ParserImpl.init(),resolveInitPromise()}}))}}return Parser}();typeof exports=="object"&&(module.exports=TreeSitter)});var hie=P(Un=>{"use strict";var fie=Un&&Un.__awaiter||function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function c(d){try{u(r.next(d))}catch(p){a(p)}}function l(d){try{u(r.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((r=r.apply(n,e||[])).next())})},mie=Un&&Un.__generator||function(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,o=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(d){u=[6,d],o=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(Un,"__esModule",{value:!0});Un.getShallowFileSize=Un.getShallowDirectorySizeSync=Un.getShallowDirectorySize=Un.confirmDirExists=Un.unlinkAsync=Un.readdirAsync=Un.readFileAsync=Un.writeFileAsync=Un.appendFileAsync=Un.accessAsync=Un.mkdirAsync=Un.lstatAsync=Un.statAsync=void 0;var ep=require("fs"),DPe=require("path"),eg=require("util");Un.statAsync=eg.promisify(ep.stat);Un.lstatAsync=eg.promisify(ep.lstat);Un.mkdirAsync=eg.promisify(ep.mkdir);Un.accessAsync=eg.promisify(ep.access);Un.appendFileAsync=eg.promisify(ep.appendFile);Un.writeFileAsync=eg.promisify(ep.writeFile);Un.readFileAsync=eg.promisify(ep.readFile);Un.readdirAsync=eg.promisify(ep.readdir);Un.unlinkAsync=eg.promisify(ep.unlink);var Vpt=function(n){return fie(void 0,void 0,void 0,function(){var e,t,r;return mie(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,7]),[4,Un.lstatAsync(n)];case 1:if(e=o.sent(),!e.isDirectory())throw new Error("Path existed but was not a directory");return[3,7];case 2:if(t=o.sent(),!(t&&t.code==="ENOENT"))return[3,6];o.label=3;case 3:return o.trys.push([3,5,,6]),[4,Un.mkdirAsync(n)];case 4:return o.sent(),[3,6];case 5:if(r=o.sent(),r&&r.code!=="EEXIST")throw r;return[3,6];case 6:return[3,7];case 7:return[2]}})})};Un.confirmDirExists=Vpt;var Gpt=function(n){return fie(void 0,void 0,void 0,function(){var e,t,r,o,s,a;return mie(this,function(c){switch(c.label){case 0:return[4,Un.readdirAsync(n)];case 1:e=c.sent(),t=0,r=0,o=e,c.label=2;case 2:return r<o.length?(s=o[r],[4,Un.statAsync(DPe.join(n,s))]):[3,5];case 3:a=c.sent(),a.isFile()&&(t+=a.size),c.label=4;case 4:return r++,[3,2];case 5:return[2,t]}})})};Un.getShallowDirectorySize=Gpt;var zpt=function(n){for(var e=ep.readdirSync(n),t=0,r=0;r<e.length;r++)t+=ep.statSync(DPe.join(n,e[r])).size;return t};Un.getShallowDirectorySizeSync=zpt;var $pt=function(n){return fie(void 0,void 0,void 0,function(){var e;return mie(this,function(t){switch(t.label){case 0:return[4,Un.statAsync(n)];case 1:return e=t.sent(),e.isFile()?[2,e.size]:[2]}})})};Un.getShallowFileSize=$pt});var OPe=P((kS,LPe)=>{"use strict";var gie=kS&&kS.__awaiter||function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function c(d){try{u(r.next(d))}catch(p){a(p)}}function l(d){try{u(r.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((r=r.apply(n,e||[])).next())})},vie=kS&&kS.__generator||function(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,o=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(d){u=[6,d],o=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},NPe=kS&&kS.__spreadArrays||function(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),o=0,e=0;e<t;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,o++)r[o]=s[a];return r},Wpt=require("fs"),Kpt=require("os"),wS=require("path"),Wf=hie(),Ypt=function(){function n(){var e=this;this.TAG="Logger",this._cleanupTimeOut=60*30*1e3,this._tempDir="",this._logFileName="",this._fileFullPath="",this._backUpNameFormat="",this._logToFile=!1,this._logToConsole=!0;var t=process.env.APPLICATIONINSIGHTS_LOG_DESTINATION;t=="file+console"&&(this._logToFile=!0),t=="file"&&(this._logToFile=!0,this._logToConsole=!1),this.maxSizeBytes=5e4,this.maxHistory=1,this._logFileName="applicationinsights.log";var r=process.env.APPLICATIONINSIGHTS_LOGDIR;r?wS.isAbsolute(r)?this._tempDir=r:this._tempDir=wS.join(process.cwd(),r):this._tempDir=wS.join(Kpt.tmpdir(),"appInsights-node"),this._fileFullPath=wS.join(this._tempDir,this._logFileName),this._backUpNameFormat="."+this._logFileName,this._logToFile&&(n._fileCleanupTimer||(n._fileCleanupTimer=setInterval(function(){e._fileCleanupTask()},this._cleanupTimeOut),n._fileCleanupTimer.unref()))}return n.prototype.info=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var o=e?NPe([e],t):t;this._logToFile&&this._storeToDisk(o),this._logToConsole&&console.info.apply(console,o)},n.prototype.warning=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var o=e?NPe([e],t):t;this._logToFile&&this._storeToDisk(o),this._logToConsole&&console.warn.apply(console,o)},n.getInstance=function(){return n._instance||(n._instance=new n),n._instance},n.prototype._storeToDisk=function(e){return gie(this,void 0,void 0,function(){var t,r,o,s,a,c;return vie(this,function(l){switch(l.label){case 0:t=e+`\r
`,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,Wf.confirmDirExists(this._tempDir)];case 2:return l.sent(),[3,4];case 3:return r=l.sent(),console.log(this.TAG,"Failed to create directory for log file: "+(r&&r.message)),[2];case 4:return l.trys.push([4,6,,11]),[4,Wf.accessAsync(this._fileFullPath,Wpt.constants.F_OK)];case 5:return l.sent(),[3,11];case 6:o=l.sent(),l.label=7;case 7:return l.trys.push([7,9,,10]),[4,Wf.appendFileAsync(this._fileFullPath,t)];case 8:return l.sent(),[2];case 9:return s=l.sent(),console.log(this.TAG,"Failed to put log into file: "+(o&&o.message)),[2];case 10:return[3,11];case 11:return l.trys.push([11,17,,18]),[4,Wf.getShallowFileSize(this._fileFullPath)];case 12:return a=l.sent(),a>this.maxSizeBytes?[4,this._createBackupFile(t)]:[3,14];case 13:return l.sent(),[3,16];case 14:return[4,Wf.appendFileAsync(this._fileFullPath,t)];case 15:l.sent(),l.label=16;case 16:return[3,18];case 17:return c=l.sent(),console.log(this.TAG,"Failed to create backup file: "+(c&&c.message)),[3,18];case 18:return[2]}})})},n.prototype._createBackupFile=function(e){return gie(this,void 0,void 0,function(){var t,r,o;return vie(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,4,5]),[4,Wf.readFileAsync(this._fileFullPath)];case 1:return t=s.sent(),r=wS.join(this._tempDir,new Date().getTime()+"."+this._logFileName),[4,Wf.writeFileAsync(r,t)];case 2:return s.sent(),[3,5];case 3:return o=s.sent(),console.log("Failed to generate backup log file",o),[3,5];case 4:return Wf.writeFileAsync(this._fileFullPath,e),[7];case 5:return[2]}})})},n.prototype._fileCleanupTask=function(){return gie(this,void 0,void 0,function(){var e,t,r,o,s,a=this;return vie(this,function(c){switch(c.label){case 0:return c.trys.push([0,6,,7]),[4,Wf.readdirAsync(this._tempDir)];case 1:e=c.sent(),e=e.filter(function(l){return wS.basename(l).indexOf(a._backUpNameFormat)>-1}),e.sort(function(l,u){var d=new Date(parseInt(l.split(a._backUpNameFormat)[0])),p=new Date(parseInt(u.split(a._backUpNameFormat)[0]));if(d<p)return-1;if(d>=p)return 1}),t=e.length,r=0,c.label=2;case 2:return r<t-this.maxHistory?(o=wS.join(this._tempDir,e[r]),[4,Wf.unlinkAsync(o)]):[3,5];case 3:c.sent(),c.label=4;case 4:return r++,[3,2];case 5:return[3,7];case 6:return s=c.sent(),console.log(this.TAG,"Failed to cleanup log files: "+(s&&s.message)),[3,7];case 7:return[2]}})})},n._fileCleanupTimer=null,n}();LPe.exports=Ypt});var li=P((jKn,FPe)=>{"use strict";var MPe=OPe(),Qpt="APPLICATION_INSIGHTS_ENABLE_DEBUG_LOGS",Xpt="APPLICATION_INSIGHTS_DISABLE_WARNING_LOGS",Jpt=function(){function n(){}return n.info=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.enableDebug&&MPe.getInstance().info(this.TAG+e,t)},n.warn=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.disableWarnings||MPe.getInstance().warning(this.TAG+e,t)},n.enableDebug=!!process.env[Qpt],n.disableWarnings=!!process.env[Xpt],n.TAG="ApplicationInsights:",n}();FPe.exports=Jpt});var Vq=P(Hq=>{"use strict";Object.defineProperty(Hq,"__esModule",{value:!0});Hq.JsonConfig=void 0;var Zpt=require("fs"),jq=require("path"),yie=li(),eft="APPLICATIONINSIGHTS_CONFIGURATION_FILE",tft="APPLICATIONINSIGHTS_CONNECTION_STRING",UPe="APPSETTING_",BPe="APPINSIGHTS_INSTRUMENTATIONKEY",qPe="APPINSIGHTS_INSTRUMENTATION_KEY",nft="APPLICATION_INSIGHTS_DISABLE_EXTENDED_METRIC",rft="APPLICATION_INSIGHTS_DISABLE_ALL_EXTENDED_METRICS",ift="http_proxy",oft="https_proxy",sft="APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL",aft="APPLICATION_INSIGHTS_NO_STATSBEAT",cft="APPLICATION_INSIGHTS_NO_HTTP_AGENT_KEEP_ALIVE",lft="APPLICATION_INSIGHTS_NO_PATCH_MODULES",uft="APPLICATIONINSIGHTS_WEB_INSTRUMENTATION_ENABLED",dft="APPLICATIONINSIGHTS_WEB_INSTRUMENTATION_CONNECTION_STRING",pft="APPLICATIONINSIGHTS_WEB_INSTRUMENTATION_SOURCE",fft="APPLICATIONINSIGHTS_WEB_SNIPPET_ENABLED",mft="APPLICATIONINSIGHTS_WEB_SNIPPET_CONNECTION_STRING",hft=function(){function n(){this.connectionString=process.env[tft],this.instrumentationKey=process.env[BPe]||process.env[UPe+BPe]||process.env[qPe]||process.env[UPe+qPe],!this.connectionString&&this.instrumentationKey&&yie.warn("APPINSIGHTS_INSTRUMENTATIONKEY is in path of deprecation, please use APPLICATIONINSIGHTS_CONNECTION_STRING env variable to setup the SDK."),this.disableAllExtendedMetrics=!!process.env[rft],this.extendedMetricDisablers=process.env[nft],this.proxyHttpUrl=process.env[ift],this.proxyHttpsUrl=process.env[oft],this.noDiagnosticChannel=!!process.env[sft],this.disableStatsbeat=!!process.env[aft],this.noHttpAgentKeepAlive=!!process.env[cft],this.noPatchModules=process.env[lft]||"",this.enableWebInstrumentation=!!process.env[uft]||!!process.env[fft],this.webInstrumentationSrc=process.env[pft]||"",this.webInstrumentationConnectionString=process.env[dft]||process.env[mft]||"",this.enableAutoWebSnippetInjection=this.enableWebInstrumentation,this.webSnippetConnectionString=this.webInstrumentationConnectionString,this._loadJsonFile()}return n.getInstance=function(){return n._instance||(n._instance=new n),n._instance},n.prototype._loadJsonFile=function(){var e="",t="{}";if(t)e=t;else{var r="applicationinsights.json",o=jq.join(__dirname,"../../"),s=jq.join(o,r),a=process.env[eft];a&&(jq.isAbsolute(a)?s=a:s=jq.join(o,a));try{e=Zpt.readFileSync(s,"utf8")}catch(l){yie.warn("Failed to read JSON config file: ",l)}}try{var c=JSON.parse(e);c.disableStatsbeat!=null&&(this.disableStatsbeat=c.disableStatsbeat),c.disableAllExtendedMetrics!=null&&(this.disableAllExtendedMetrics=c.disableStatsbeat),c.noDiagnosticChannel!=null&&(this.noDiagnosticChannel=c.noDiagnosticChannel),c.noHttpAgentKeepAlive!=null&&(this.noHttpAgentKeepAlive=c.noHttpAgentKeepAlive),c.connectionString!=null&&(this.connectionString=c.connectionString),c.extendedMetricDisablers!=null&&(this.extendedMetricDisablers=c.extendedMetricDisablers),c.noDiagnosticChannel!=null&&(this.noDiagnosticChannel=c.noDiagnosticChannel),c.proxyHttpUrl!=null&&(this.proxyHttpUrl=c.proxyHttpUrl),c.proxyHttpsUrl!=null&&(this.proxyHttpsUrl=c.proxyHttpsUrl),c.proxyHttpsUrl!=null&&(this.proxyHttpsUrl=c.proxyHttpsUrl),c.noPatchModules!=null&&(this.noPatchModules=c.noPatchModules),c.enableAutoWebSnippetInjection!=null&&(this.enableWebInstrumentation=c.enableAutoWebSnippetInjection,this.enableAutoWebSnippetInjection=this.enableWebInstrumentation),c.enableWebInstrumentation!=null&&(this.enableWebInstrumentation=c.enableWebInstrumentation,this.enableAutoWebSnippetInjection=this.enableWebInstrumentation),c.webSnippetConnectionString!=null&&(this.webInstrumentationConnectionString=c.webSnippetConnectionString,this.webSnippetConnectionString=this.webInstrumentationConnectionString),c.webInstrumentationConnectionString!=null&&(this.webInstrumentationConnectionString=c.webInstrumentationConnectionString,this.webSnippetConnectionString=this.webInstrumentationConnectionString),c.webInstrumentationConfig!=null&&(this.webInstrumentationConfig=c.webInstrumentationConfig),c.webInstrumentationSrc!=null&&(this.webInstrumentationSrc=c.webInstrumentationSrc),c.enableLoggerErrorToTrace!=null&&(this.enableLoggerErrorToTrace=c.enableLoggerErrorToTrace),this.endpointUrl=c.endpointUrl,this.maxBatchSize=c.maxBatchSize,this.maxBatchIntervalMs=c.maxBatchIntervalMs,this.disableAppInsights=c.disableAppInsights,this.samplingPercentage=c.samplingPercentage,this.correlationIdRetryIntervalMs=c.correlationIdRetryIntervalMs,this.correlationHeaderExcludedDomains=c.correlationHeaderExcludedDomains,this.ignoreLegacyHeaders=c.ignoreLegacyHeaders,this.distributedTracingMode=c.distributedTracingMode,this.enableAutoCollectExternalLoggers=c.enableAutoCollectExternalLoggers,this.enableAutoCollectConsole=c.enableAutoCollectConsole,this.enableLoggerErrorToTrace=c.enableLoggerErrorToTrace,this.enableAutoCollectExceptions=c.enableAutoCollectExceptions,this.enableAutoCollectPerformance=c.enableAutoCollectPerformance,this.enableAutoCollectExtendedMetrics=c.enableAutoCollectExtendedMetrics,this.enableAutoCollectPreAggregatedMetrics=c.enableAutoCollectPreAggregatedMetrics,this.enableAutoCollectHeartbeat=c.enableAutoCollectHeartbeat,this.enableAutoCollectRequests=c.enableAutoCollectRequests,this.enableAutoCollectDependencies=c.enableAutoCollectDependencies,this.enableAutoDependencyCorrelation=c.enableAutoDependencyCorrelation,this.enableAutoCollectIncomingRequestAzureFunctions=c.enableAutoCollectIncomingRequestAzureFunctions,this.enableUseAsyncHooks=c.enableUseAsyncHooks,this.enableUseDiskRetryCaching=c.enableUseDiskRetryCaching,this.enableResendInterval=c.enableResendInterval,this.enableMaxBytesOnDisk=c.enableMaxBytesOnDisk,this.enableInternalDebugLogging=c.enableInternalDebugLogging,this.enableInternalWarningLogging=c.enableInternalWarningLogging,this.enableSendLiveMetrics=c.enableSendLiveMetrics,this.quickPulseHost=c.quickPulseHost}catch(l){yie.warn("Invalid JSON config file: ",l)}},n}();Hq.JsonConfig=hft});var YO=P((VKn,jPe)=>{var gft="2.0.0",vft=Number.MAX_SAFE_INTEGER||9007199254740991,yft=16,bft=250,_ft=["major","premajor","minor","preminor","patch","prepatch","prerelease"];jPe.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:yft,MAX_SAFE_BUILD_LENGTH:bft,MAX_SAFE_INTEGER:vft,RELEASE_TYPES:_ft,SEMVER_SPEC_VERSION:gft,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var QO=P((GKn,HPe)=>{var xft=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...n)=>console.error("SEMVER",...n):()=>{};HPe.exports=xft});var cR=P((tg,VPe)=>{var{MAX_SAFE_COMPONENT_LENGTH:bie,MAX_SAFE_BUILD_LENGTH:Sft,MAX_LENGTH:Ift}=YO(),Tft=QO();tg=VPe.exports={};var Cft=tg.re=[],Eft=tg.safeRe=[],vt=tg.src=[],yt=tg.t={},wft=0,_ie="[a-zA-Z0-9-]",kft=[["\\s",1],["\\d",Ift],[_ie,Sft]],Rft=n=>{for(let[e,t]of kft)n=n.split(`${e}*`).join(`${e}{0,${t}}`).split(`${e}+`).join(`${e}{1,${t}}`);return n},un=(n,e,t)=>{let r=Rft(e),o=wft++;Tft(n,o,e),yt[n]=o,vt[o]=e,Cft[o]=new RegExp(e,t?"g":void 0),Eft[o]=new RegExp(r,t?"g":void 0)};un("NUMERICIDENTIFIER","0|[1-9]\\d*");un("NUMERICIDENTIFIERLOOSE","\\d+");un("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${_ie}*`);un("MAINVERSION",`(${vt[yt.NUMERICIDENTIFIER]})\\.(${vt[yt.NUMERICIDENTIFIER]})\\.(${vt[yt.NUMERICIDENTIFIER]})`);un("MAINVERSIONLOOSE",`(${vt[yt.NUMERICIDENTIFIERLOOSE]})\\.(${vt[yt.NUMERICIDENTIFIERLOOSE]})\\.(${vt[yt.NUMERICIDENTIFIERLOOSE]})`);un("PRERELEASEIDENTIFIER",`(?:${vt[yt.NUMERICIDENTIFIER]}|${vt[yt.NONNUMERICIDENTIFIER]})`);un("PRERELEASEIDENTIFIERLOOSE",`(?:${vt[yt.NUMERICIDENTIFIERLOOSE]}|${vt[yt.NONNUMERICIDENTIFIER]})`);un("PRERELEASE",`(?:-(${vt[yt.PRERELEASEIDENTIFIER]}(?:\\.${vt[yt.PRERELEASEIDENTIFIER]})*))`);un("PRERELEASELOOSE",`(?:-?(${vt[yt.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${vt[yt.PRERELEASEIDENTIFIERLOOSE]})*))`);un("BUILDIDENTIFIER",`${_ie}+`);un("BUILD",`(?:\\+(${vt[yt.BUILDIDENTIFIER]}(?:\\.${vt[yt.BUILDIDENTIFIER]})*))`);un("FULLPLAIN",`v?${vt[yt.MAINVERSION]}${vt[yt.PRERELEASE]}?${vt[yt.BUILD]}?`);un("FULL",`^${vt[yt.FULLPLAIN]}$`);un("LOOSEPLAIN",`[v=\\s]*${vt[yt.MAINVERSIONLOOSE]}${vt[yt.PRERELEASELOOSE]}?${vt[yt.BUILD]}?`);un("LOOSE",`^${vt[yt.LOOSEPLAIN]}$`);un("GTLT","((?:<|>)?=?)");un("XRANGEIDENTIFIERLOOSE",`${vt[yt.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);un("XRANGEIDENTIFIER",`${vt[yt.NUMERICIDENTIFIER]}|x|X|\\*`);un("XRANGEPLAIN",`[v=\\s]*(${vt[yt.XRANGEIDENTIFIER]})(?:\\.(${vt[yt.XRANGEIDENTIFIER]})(?:\\.(${vt[yt.XRANGEIDENTIFIER]})(?:${vt[yt.PRERELEASE]})?${vt[yt.BUILD]}?)?)?`);un("XRANGEPLAINLOOSE",`[v=\\s]*(${vt[yt.XRANGEIDENTIFIERLOOSE]})(?:\\.(${vt[yt.XRANGEIDENTIFIERLOOSE]})(?:\\.(${vt[yt.XRANGEIDENTIFIERLOOSE]})(?:${vt[yt.PRERELEASELOOSE]})?${vt[yt.BUILD]}?)?)?`);un("XRANGE",`^${vt[yt.GTLT]}\\s*${vt[yt.XRANGEPLAIN]}$`);un("XRANGELOOSE",`^${vt[yt.GTLT]}\\s*${vt[yt.XRANGEPLAINLOOSE]}$`);un("COERCEPLAIN",`(^|[^\\d])(\\d{1,${bie}})(?:\\.(\\d{1,${bie}}))?(?:\\.(\\d{1,${bie}}))?`);un("COERCE",`${vt[yt.COERCEPLAIN]}(?:$|[^\\d])`);un("COERCEFULL",vt[yt.COERCEPLAIN]+`(?:${vt[yt.PRERELEASE]})?(?:${vt[yt.BUILD]})?(?:$|[^\\d])`);un("COERCERTL",vt[yt.COERCE],!0);un("COERCERTLFULL",vt[yt.COERCEFULL],!0);un("LONETILDE","(?:~>?)");un("TILDETRIM",`(\\s*)${vt[yt.LONETILDE]}\\s+`,!0);tg.tildeTrimReplace="$1~";un("TILDE",`^${vt[yt.LONETILDE]}${vt[yt.XRANGEPLAIN]}$`);un("TILDELOOSE",`^${vt[yt.LONETILDE]}${vt[yt.XRANGEPLAINLOOSE]}$`);un("LONECARET","(?:\\^)");un("CARETTRIM",`(\\s*)${vt[yt.LONECARET]}\\s+`,!0);tg.caretTrimReplace="$1^";un("CARET",`^${vt[yt.LONECARET]}${vt[yt.XRANGEPLAIN]}$`);un("CARETLOOSE",`^${vt[yt.LONECARET]}${vt[yt.XRANGEPLAINLOOSE]}$`);un("COMPARATORLOOSE",`^${vt[yt.GTLT]}\\s*(${vt[yt.LOOSEPLAIN]})$|^$`);un("COMPARATOR",`^${vt[yt.GTLT]}\\s*(${vt[yt.FULLPLAIN]})$|^$`);un("COMPARATORTRIM",`(\\s*)${vt[yt.GTLT]}\\s*(${vt[yt.LOOSEPLAIN]}|${vt[yt.XRANGEPLAIN]})`,!0);tg.comparatorTrimReplace="$1$2$3";un("HYPHENRANGE",`^\\s*(${vt[yt.XRANGEPLAIN]})\\s+-\\s+(${vt[yt.XRANGEPLAIN]})\\s*$`);un("HYPHENRANGELOOSE",`^\\s*(${vt[yt.XRANGEPLAINLOOSE]})\\s+-\\s+(${vt[yt.XRANGEPLAINLOOSE]})\\s*$`);un("STAR","(<|>)?=?\\s*\\*");un("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");un("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var Gq=P((zKn,GPe)=>{var Pft=Object.freeze({loose:!0}),Aft=Object.freeze({}),Dft=n=>n?typeof n!="object"?Pft:n:Aft;GPe.exports=Dft});var xie=P(($Kn,WPe)=>{var zPe=/^[0-9]+$/,$Pe=(n,e)=>{let t=zPe.test(n),r=zPe.test(e);return t&&r&&(n=+n,e=+e),n===e?0:t&&!r?-1:r&&!t?1:n<e?-1:1},Nft=(n,e)=>$Pe(e,n);WPe.exports={compareIdentifiers:$Pe,rcompareIdentifiers:Nft}});var Ia=P((WKn,XPe)=>{var zq=QO(),{MAX_LENGTH:KPe,MAX_SAFE_INTEGER:$q}=YO(),{safeRe:YPe,t:QPe}=cR(),Lft=Gq(),{compareIdentifiers:lR}=xie(),Sie=class n{constructor(e,t){if(t=Lft(t),e instanceof n){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>KPe)throw new TypeError(`version is longer than ${KPe} characters`);zq("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let r=e.trim().match(t.loose?YPe[QPe.LOOSE]:YPe[QPe.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>$q||this.major<0)throw new TypeError("Invalid major version");if(this.minor>$q||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>$q||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(o=>{if(/^[0-9]+$/.test(o)){let s=+o;if(s>=0&&s<$q)return s}return o}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(zq("SemVer.compare",this.version,this.options,e),!(e instanceof n)){if(typeof e=="string"&&e===this.version)return 0;e=new n(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof n||(e=new n(e,this.options)),lR(this.major,e.major)||lR(this.minor,e.minor)||lR(this.patch,e.patch)}comparePre(e){if(e instanceof n||(e=new n(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let r=this.prerelease[t],o=e.prerelease[t];if(zq("prerelease compare",t,r,o),r===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(r===void 0)return-1;if(r===o)continue;return lR(r,o)}while(++t)}compareBuild(e){e instanceof n||(e=new n(e,this.options));let t=0;do{let r=this.build[t],o=e.build[t];if(zq("build compare",t,r,o),r===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(r===void 0)return-1;if(r===o)continue;return lR(r,o)}while(++t)}inc(e,t,r){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let o=Number(r)?1:0;if(!t&&r===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[o];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(t===this.prerelease.join(".")&&r===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(o)}}if(t){let s=[t,o];r===!1&&(s=[t]),lR(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};XPe.exports=Sie});var RS=P((KKn,ZPe)=>{var JPe=Ia(),Oft=(n,e,t=!1)=>{if(n instanceof JPe)return n;try{return new JPe(n,e)}catch(r){if(!t)return null;throw r}};ZPe.exports=Oft});var tAe=P((YKn,eAe)=>{var Mft=RS(),Fft=(n,e)=>{let t=Mft(n,e);return t?t.version:null};eAe.exports=Fft});var rAe=P((QKn,nAe)=>{var Uft=RS(),Bft=(n,e)=>{let t=Uft(n.trim().replace(/^[=v]+/,""),e);return t?t.version:null};nAe.exports=Bft});var sAe=P((XKn,oAe)=>{var iAe=Ia(),qft=(n,e,t,r,o)=>{typeof t=="string"&&(o=r,r=t,t=void 0);try{return new iAe(n instanceof iAe?n.version:n,t).inc(e,r,o).version}catch{return null}};oAe.exports=qft});var lAe=P((JKn,cAe)=>{var aAe=RS(),jft=(n,e)=>{let t=aAe(n,null,!0),r=aAe(e,null,!0),o=t.compare(r);if(o===0)return null;let s=o>0,a=s?t:r,c=s?r:t,l=!!a.prerelease.length;if(!!c.prerelease.length&&!l)return!c.patch&&!c.minor?"major":a.patch?"patch":a.minor?"minor":"major";let d=l?"pre":"";return t.major!==r.major?d+"major":t.minor!==r.minor?d+"minor":t.patch!==r.patch?d+"patch":"prerelease"};cAe.exports=jft});var dAe=P((ZKn,uAe)=>{var Hft=Ia(),Vft=(n,e)=>new Hft(n,e).major;uAe.exports=Vft});var fAe=P((eYn,pAe)=>{var Gft=Ia(),zft=(n,e)=>new Gft(n,e).minor;pAe.exports=zft});var hAe=P((tYn,mAe)=>{var $ft=Ia(),Wft=(n,e)=>new $ft(n,e).patch;mAe.exports=Wft});var vAe=P((nYn,gAe)=>{var Kft=RS(),Yft=(n,e)=>{let t=Kft(n,e);return t&&t.prerelease.length?t.prerelease:null};gAe.exports=Yft});var Mu=P((rYn,bAe)=>{var yAe=Ia(),Qft=(n,e,t)=>new yAe(n,t).compare(new yAe(e,t));bAe.exports=Qft});var xAe=P((iYn,_Ae)=>{var Xft=Mu(),Jft=(n,e,t)=>Xft(e,n,t);_Ae.exports=Jft});var IAe=P((oYn,SAe)=>{var Zft=Mu(),emt=(n,e)=>Zft(n,e,!0);SAe.exports=emt});var Wq=P((sYn,CAe)=>{var TAe=Ia(),tmt=(n,e,t)=>{let r=new TAe(n,t),o=new TAe(e,t);return r.compare(o)||r.compareBuild(o)};CAe.exports=tmt});var wAe=P((aYn,EAe)=>{var nmt=Wq(),rmt=(n,e)=>n.sort((t,r)=>nmt(t,r,e));EAe.exports=rmt});var RAe=P((cYn,kAe)=>{var imt=Wq(),omt=(n,e)=>n.sort((t,r)=>imt(r,t,e));kAe.exports=omt});var XO=P((lYn,PAe)=>{var smt=Mu(),amt=(n,e,t)=>smt(n,e,t)>0;PAe.exports=amt});var Kq=P((uYn,AAe)=>{var cmt=Mu(),lmt=(n,e,t)=>cmt(n,e,t)<0;AAe.exports=lmt});var Iie=P((dYn,DAe)=>{var umt=Mu(),dmt=(n,e,t)=>umt(n,e,t)===0;DAe.exports=dmt});var Tie=P((pYn,NAe)=>{var pmt=Mu(),fmt=(n,e,t)=>pmt(n,e,t)!==0;NAe.exports=fmt});var Yq=P((fYn,LAe)=>{var mmt=Mu(),hmt=(n,e,t)=>mmt(n,e,t)>=0;LAe.exports=hmt});var Qq=P((mYn,OAe)=>{var gmt=Mu(),vmt=(n,e,t)=>gmt(n,e,t)<=0;OAe.exports=vmt});var Cie=P((hYn,MAe)=>{var ymt=Iie(),bmt=Tie(),_mt=XO(),xmt=Yq(),Smt=Kq(),Imt=Qq(),Tmt=(n,e,t,r)=>{switch(e){case"===":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n===t;case"!==":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n!==t;case"":case"=":case"==":return ymt(n,t,r);case"!=":return bmt(n,t,r);case">":return _mt(n,t,r);case">=":return xmt(n,t,r);case"<":return Smt(n,t,r);case"<=":return Imt(n,t,r);default:throw new TypeError(`Invalid operator: ${e}`)}};MAe.exports=Tmt});var UAe=P((gYn,FAe)=>{var Cmt=Ia(),Emt=RS(),{safeRe:Xq,t:Jq}=cR(),wmt=(n,e)=>{if(n instanceof Cmt)return n;if(typeof n=="number"&&(n=String(n)),typeof n!="string")return null;e=e||{};let t=null;if(!e.rtl)t=n.match(e.includePrerelease?Xq[Jq.COERCEFULL]:Xq[Jq.COERCE]);else{let l=e.includePrerelease?Xq[Jq.COERCERTLFULL]:Xq[Jq.COERCERTL],u;for(;(u=l.exec(n))&&(!t||t.index+t[0].length!==n.length);)(!t||u.index+u[0].length!==t.index+t[0].length)&&(t=u),l.lastIndex=u.index+u[1].length+u[2].length;l.lastIndex=-1}if(t===null)return null;let r=t[2],o=t[3]||"0",s=t[4]||"0",a=e.includePrerelease&&t[5]?`-${t[5]}`:"",c=e.includePrerelease&&t[6]?`+${t[6]}`:"";return Emt(`${r}.${o}.${s}${a}${c}`,e)};FAe.exports=wmt});var qAe=P((vYn,BAe)=>{var Eie=class{constructor(){this.max=1e3,this.map=new Map}get(e){let t=this.map.get(e);if(t!==void 0)return this.map.delete(e),this.map.set(e,t),t}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&t!==void 0){if(this.map.size>=this.max){let o=this.map.keys().next().value;this.delete(o)}this.map.set(e,t)}return this}};BAe.exports=Eie});var Fu=P((yYn,GAe)=>{var wie=class n{constructor(e,t){if(t=Rmt(t),e instanceof n)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new n(e.raw,t);if(e instanceof kie)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(r=>this.parseRange(r.trim())).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let r=this.set[0];if(this.set=this.set.filter(o=>!HAe(o[0])),this.set.length===0)this.set=[r];else if(this.set.length>1){for(let o of this.set)if(o.length===1&&Mmt(o[0])){this.set=[o];break}}}this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){let r=((this.options.includePrerelease&&Lmt)|(this.options.loose&&Omt))+":"+e,o=jAe.get(r);if(o)return o;let s=this.options.loose,a=s?qc[Qa.HYPHENRANGELOOSE]:qc[Qa.HYPHENRANGE];e=e.replace(a,$mt(this.options.includePrerelease)),ui("hyphen replace",e),e=e.replace(qc[Qa.COMPARATORTRIM],Amt),ui("comparator trim",e),e=e.replace(qc[Qa.TILDETRIM],Dmt),ui("tilde trim",e),e=e.replace(qc[Qa.CARETTRIM],Nmt),ui("caret trim",e);let c=e.split(" ").map(p=>Fmt(p,this.options)).join(" ").split(/\s+/).map(p=>zmt(p,this.options));s&&(c=c.filter(p=>(ui("loose invalid filter",p,this.options),!!p.match(qc[Qa.COMPARATORLOOSE])))),ui("range list",c);let l=new Map,u=c.map(p=>new kie(p,this.options));for(let p of u){if(HAe(p))return[p];l.set(p.value,p)}l.size>1&&l.has("")&&l.delete("");let d=[...l.values()];return jAe.set(r,d),d}intersects(e,t){if(!(e instanceof n))throw new TypeError("a Range is required");return this.set.some(r=>VAe(r,t)&&e.set.some(o=>VAe(o,t)&&r.every(s=>o.every(a=>s.intersects(a,t)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new Pmt(e,this.options)}catch{return!1}for(let t=0;t<this.set.length;t++)if(Wmt(this.set[t],e,this.options))return!0;return!1}};GAe.exports=wie;var kmt=qAe(),jAe=new kmt,Rmt=Gq(),kie=JO(),ui=QO(),Pmt=Ia(),{safeRe:qc,t:Qa,comparatorTrimReplace:Amt,tildeTrimReplace:Dmt,caretTrimReplace:Nmt}=cR(),{FLAG_INCLUDE_PRERELEASE:Lmt,FLAG_LOOSE:Omt}=YO(),HAe=n=>n.value==="<0.0.0-0",Mmt=n=>n.value==="",VAe=(n,e)=>{let t=!0,r=n.slice(),o=r.pop();for(;t&&r.length;)t=r.every(s=>o.intersects(s,e)),o=r.pop();return t},Fmt=(n,e)=>(ui("comp",n,e),n=qmt(n,e),ui("caret",n),n=Umt(n,e),ui("tildes",n),n=Hmt(n,e),ui("xrange",n),n=Gmt(n,e),ui("stars",n),n),Xa=n=>!n||n.toLowerCase()==="x"||n==="*",Umt=(n,e)=>n.trim().split(/\s+/).map(t=>Bmt(t,e)).join(" "),Bmt=(n,e)=>{let t=e.loose?qc[Qa.TILDELOOSE]:qc[Qa.TILDE];return n.replace(t,(r,o,s,a,c)=>{ui("tilde",n,r,o,s,a,c);let l;return Xa(o)?l="":Xa(s)?l=`>=${o}.0.0 <${+o+1}.0.0-0`:Xa(a)?l=`>=${o}.${s}.0 <${o}.${+s+1}.0-0`:c?(ui("replaceTilde pr",c),l=`>=${o}.${s}.${a}-${c} <${o}.${+s+1}.0-0`):l=`>=${o}.${s}.${a} <${o}.${+s+1}.0-0`,ui("tilde return",l),l})},qmt=(n,e)=>n.trim().split(/\s+/).map(t=>jmt(t,e)).join(" "),jmt=(n,e)=>{ui("caret",n,e);let t=e.loose?qc[Qa.CARETLOOSE]:qc[Qa.CARET],r=e.includePrerelease?"-0":"";return n.replace(t,(o,s,a,c,l)=>{ui("caret",n,o,s,a,c,l);let u;return Xa(s)?u="":Xa(a)?u=`>=${s}.0.0${r} <${+s+1}.0.0-0`:Xa(c)?s==="0"?u=`>=${s}.${a}.0${r} <${s}.${+a+1}.0-0`:u=`>=${s}.${a}.0${r} <${+s+1}.0.0-0`:l?(ui("replaceCaret pr",l),s==="0"?a==="0"?u=`>=${s}.${a}.${c}-${l} <${s}.${a}.${+c+1}-0`:u=`>=${s}.${a}.${c}-${l} <${s}.${+a+1}.0-0`:u=`>=${s}.${a}.${c}-${l} <${+s+1}.0.0-0`):(ui("no pr"),s==="0"?a==="0"?u=`>=${s}.${a}.${c}${r} <${s}.${a}.${+c+1}-0`:u=`>=${s}.${a}.${c}${r} <${s}.${+a+1}.0-0`:u=`>=${s}.${a}.${c} <${+s+1}.0.0-0`),ui("caret return",u),u})},Hmt=(n,e)=>(ui("replaceXRanges",n,e),n.split(/\s+/).map(t=>Vmt(t,e)).join(" ")),Vmt=(n,e)=>{n=n.trim();let t=e.loose?qc[Qa.XRANGELOOSE]:qc[Qa.XRANGE];return n.replace(t,(r,o,s,a,c,l)=>{ui("xRange",n,r,o,s,a,c,l);let u=Xa(s),d=u||Xa(a),p=d||Xa(c),f=p;return o==="="&&f&&(o=""),l=e.includePrerelease?"-0":"",u?o===">"||o==="<"?r="<0.0.0-0":r="*":o&&f?(d&&(a=0),c=0,o===">"?(o=">=",d?(s=+s+1,a=0,c=0):(a=+a+1,c=0)):o==="<="&&(o="<",d?s=+s+1:a=+a+1),o==="<"&&(l="-0"),r=`${o+s}.${a}.${c}${l}`):d?r=`>=${s}.0.0${l} <${+s+1}.0.0-0`:p&&(r=`>=${s}.${a}.0${l} <${s}.${+a+1}.0-0`),ui("xRange return",r),r})},Gmt=(n,e)=>(ui("replaceStars",n,e),n.trim().replace(qc[Qa.STAR],"")),zmt=(n,e)=>(ui("replaceGTE0",n,e),n.trim().replace(qc[e.includePrerelease?Qa.GTE0PRE:Qa.GTE0],"")),$mt=n=>(e,t,r,o,s,a,c,l,u,d,p,f)=>(Xa(r)?t="":Xa(o)?t=`>=${r}.0.0${n?"-0":""}`:Xa(s)?t=`>=${r}.${o}.0${n?"-0":""}`:a?t=`>=${t}`:t=`>=${t}${n?"-0":""}`,Xa(u)?l="":Xa(d)?l=`<${+u+1}.0.0-0`:Xa(p)?l=`<${u}.${+d+1}.0-0`:f?l=`<=${u}.${d}.${p}-${f}`:n?l=`<${u}.${d}.${+p+1}-0`:l=`<=${l}`,`${t} ${l}`.trim()),Wmt=(n,e,t)=>{for(let r=0;r<n.length;r++)if(!n[r].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(let r=0;r<n.length;r++)if(ui(n[r].semver),n[r].semver!==kie.ANY&&n[r].semver.prerelease.length>0){let o=n[r].semver;if(o.major===e.major&&o.minor===e.minor&&o.patch===e.patch)return!0}return!1}return!0}});var JO=P((bYn,QAe)=>{var ZO=Symbol("SemVer ANY"),Aie=class n{static get ANY(){return ZO}constructor(e,t){if(t=zAe(t),e instanceof n){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),Pie("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===ZO?this.value="":this.value=this.operator+this.semver.version,Pie("comp",this)}parse(e){let t=this.options.loose?$Ae[WAe.COMPARATORLOOSE]:$Ae[WAe.COMPARATOR],r=e.match(t);if(!r)throw new TypeError(`Invalid comparator: ${e}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new KAe(r[2],this.options.loose):this.semver=ZO}toString(){return this.value}test(e){if(Pie("Comparator.test",e,this.options.loose),this.semver===ZO||e===ZO)return!0;if(typeof e=="string")try{e=new KAe(e,this.options)}catch{return!1}return Rie(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof n))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new YAe(e.value,t).test(this.value):e.operator===""?e.value===""?!0:new YAe(this.value,t).test(e.semver):(t=zAe(t),t.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||Rie(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||Rie(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};QAe.exports=Aie;var zAe=Gq(),{safeRe:$Ae,t:WAe}=cR(),Rie=Cie(),Pie=QO(),KAe=Ia(),YAe=Fu()});var e4=P((_Yn,XAe)=>{var Kmt=Fu(),Ymt=(n,e,t)=>{try{e=new Kmt(e,t)}catch{return!1}return e.test(n)};XAe.exports=Ymt});var ZAe=P((xYn,JAe)=>{var Qmt=Fu(),Xmt=(n,e)=>new Qmt(n,e).set.map(t=>t.map(r=>r.value).join(" ").trim().split(" "));JAe.exports=Xmt});var t2e=P((SYn,e2e)=>{var Jmt=Ia(),Zmt=Fu(),eht=(n,e,t)=>{let r=null,o=null,s=null;try{s=new Zmt(e,t)}catch{return null}return n.forEach(a=>{s.test(a)&&(!r||o.compare(a)===-1)&&(r=a,o=new Jmt(r,t))}),r};e2e.exports=eht});var r2e=P((IYn,n2e)=>{var tht=Ia(),nht=Fu(),rht=(n,e,t)=>{let r=null,o=null,s=null;try{s=new nht(e,t)}catch{return null}return n.forEach(a=>{s.test(a)&&(!r||o.compare(a)===1)&&(r=a,o=new tht(r,t))}),r};n2e.exports=rht});var s2e=P((TYn,o2e)=>{var Die=Ia(),iht=Fu(),i2e=XO(),oht=(n,e)=>{n=new iht(n,e);let t=new Die("0.0.0");if(n.test(t)||(t=new Die("0.0.0-0"),n.test(t)))return t;t=null;for(let r=0;r<n.set.length;++r){let o=n.set[r],s=null;o.forEach(a=>{let c=new Die(a.semver.version);switch(a.operator){case">":c.prerelease.length===0?c.patch++:c.prerelease.push(0),c.raw=c.format();case"":case">=":(!s||i2e(c,s))&&(s=c);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),s&&(!t||i2e(t,s))&&(t=s)}return t&&n.test(t)?t:null};o2e.exports=oht});var c2e=P((CYn,a2e)=>{var sht=Fu(),aht=(n,e)=>{try{return new sht(n,e).range||"*"}catch{return null}};a2e.exports=aht});var Zq=P((EYn,p2e)=>{var cht=Ia(),d2e=JO(),{ANY:lht}=d2e,uht=Fu(),dht=e4(),l2e=XO(),u2e=Kq(),pht=Qq(),fht=Yq(),mht=(n,e,t,r)=>{n=new cht(n,r),e=new uht(e,r);let o,s,a,c,l;switch(t){case">":o=l2e,s=pht,a=u2e,c=">",l=">=";break;case"<":o=u2e,s=fht,a=l2e,c="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(dht(n,e,r))return!1;for(let u=0;u<e.set.length;++u){let d=e.set[u],p=null,f=null;if(d.forEach(m=>{m.semver===lht&&(m=new d2e(">=0.0.0")),p=p||m,f=f||m,o(m.semver,p.semver,r)?p=m:a(m.semver,f.semver,r)&&(f=m)}),p.operator===c||p.operator===l||(!f.operator||f.operator===c)&&s(n,f.semver))return!1;if(f.operator===l&&a(n,f.semver))return!1}return!0};p2e.exports=mht});var m2e=P((wYn,f2e)=>{var hht=Zq(),ght=(n,e,t)=>hht(n,e,">",t);f2e.exports=ght});var g2e=P((kYn,h2e)=>{var vht=Zq(),yht=(n,e,t)=>vht(n,e,"<",t);h2e.exports=yht});var b2e=P((RYn,y2e)=>{var v2e=Fu(),bht=(n,e,t)=>(n=new v2e(n,t),e=new v2e(e,t),n.intersects(e,t));y2e.exports=bht});var x2e=P((PYn,_2e)=>{var _ht=e4(),xht=Mu();_2e.exports=(n,e,t)=>{let r=[],o=null,s=null,a=n.sort((d,p)=>xht(d,p,t));for(let d of a)_ht(d,e,t)?(s=d,o||(o=d)):(s&&r.push([o,s]),s=null,o=null);o&&r.push([o,null]);let c=[];for(let[d,p]of r)d===p?c.push(d):!p&&d===a[0]?c.push("*"):p?d===a[0]?c.push(`<=${p}`):c.push(`${d} - ${p}`):c.push(`>=${d}`);let l=c.join(" || "),u=typeof e.raw=="string"?e.raw:String(e);return l.length<u.length?l:e}});var w2e=P((AYn,E2e)=>{var S2e=Fu(),Lie=JO(),{ANY:Nie}=Lie,t4=e4(),Oie=Mu(),Sht=(n,e,t={})=>{if(n===e)return!0;n=new S2e(n,t),e=new S2e(e,t);let r=!1;e:for(let o of n.set){for(let s of e.set){let a=Tht(o,s,t);if(r=r||a!==null,a)continue e}if(r)return!1}return!0},Iht=[new Lie(">=0.0.0-0")],I2e=[new Lie(">=0.0.0")],Tht=(n,e,t)=>{if(n===e)return!0;if(n.length===1&&n[0].semver===Nie){if(e.length===1&&e[0].semver===Nie)return!0;t.includePrerelease?n=Iht:n=I2e}if(e.length===1&&e[0].semver===Nie){if(t.includePrerelease)return!0;e=I2e}let r=new Set,o,s;for(let m of n)m.operator===">"||m.operator===">="?o=T2e(o,m,t):m.operator==="<"||m.operator==="<="?s=C2e(s,m,t):r.add(m.semver);if(r.size>1)return null;let a;if(o&&s){if(a=Oie(o.semver,s.semver,t),a>0)return null;if(a===0&&(o.operator!==">="||s.operator!=="<="))return null}for(let m of r){if(o&&!t4(m,String(o),t)||s&&!t4(m,String(s),t))return null;for(let h of e)if(!t4(m,String(h),t))return!1;return!0}let c,l,u,d,p=s&&!t.includePrerelease&&s.semver.prerelease.length?s.semver:!1,f=o&&!t.includePrerelease&&o.semver.prerelease.length?o.semver:!1;p&&p.prerelease.length===1&&s.operator==="<"&&p.prerelease[0]===0&&(p=!1);for(let m of e){if(d=d||m.operator===">"||m.operator===">=",u=u||m.operator==="<"||m.operator==="<=",o){if(f&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===f.major&&m.semver.minor===f.minor&&m.semver.patch===f.patch&&(f=!1),m.operator===">"||m.operator===">="){if(c=T2e(o,m,t),c===m&&c!==o)return!1}else if(o.operator===">="&&!t4(o.semver,String(m),t))return!1}if(s){if(p&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===p.major&&m.semver.minor===p.minor&&m.semver.patch===p.patch&&(p=!1),m.operator==="<"||m.operator==="<="){if(l=C2e(s,m,t),l===m&&l!==s)return!1}else if(s.operator==="<="&&!t4(s.semver,String(m),t))return!1}if(!m.operator&&(s||o)&&a!==0)return!1}return!(o&&u&&!s&&a!==0||s&&d&&!o&&a!==0||f||p)},T2e=(n,e,t)=>{if(!n)return e;let r=Oie(n.semver,e.semver,t);return r>0?n:r<0||e.operator===">"&&n.operator===">="?e:n},C2e=(n,e,t)=>{if(!n)return e;let r=Oie(n.semver,e.semver,t);return r<0?n:r>0||e.operator==="<"&&n.operator==="<="?e:n};E2e.exports=Sht});var A2e=P((DYn,P2e)=>{var Mie=cR(),k2e=YO(),Cht=Ia(),R2e=xie(),Eht=RS(),wht=tAe(),kht=rAe(),Rht=sAe(),Pht=lAe(),Aht=dAe(),Dht=fAe(),Nht=hAe(),Lht=vAe(),Oht=Mu(),Mht=xAe(),Fht=IAe(),Uht=Wq(),Bht=wAe(),qht=RAe(),jht=XO(),Hht=Kq(),Vht=Iie(),Ght=Tie(),zht=Yq(),$ht=Qq(),Wht=Cie(),Kht=UAe(),Yht=JO(),Qht=Fu(),Xht=e4(),Jht=ZAe(),Zht=t2e(),egt=r2e(),tgt=s2e(),ngt=c2e(),rgt=Zq(),igt=m2e(),ogt=g2e(),sgt=b2e(),agt=x2e(),cgt=w2e();P2e.exports={parse:Eht,valid:wht,clean:kht,inc:Rht,diff:Pht,major:Aht,minor:Dht,patch:Nht,prerelease:Lht,compare:Oht,rcompare:Mht,compareLoose:Fht,compareBuild:Uht,sort:Bht,rsort:qht,gt:jht,lt:Hht,eq:Vht,neq:Ght,gte:zht,lte:$ht,cmp:Wht,coerce:Kht,Comparator:Yht,Range:Qht,satisfies:Xht,toComparators:Jht,maxSatisfying:Zht,minSatisfying:egt,minVersion:tgt,validRange:ngt,outside:rgt,gtr:igt,ltr:ogt,intersects:sgt,simplifyRange:agt,subset:cgt,SemVer:Cht,re:Mie.re,src:Mie.src,tokens:Mie.t,SEMVER_SPEC_VERSION:k2e.SEMVER_SPEC_VERSION,RELEASE_TYPES:k2e.RELEASE_TYPES,compareIdentifiers:R2e.compareIdentifiers,rcompareIdentifiers:R2e.rcompareIdentifiers}});var Fie=P(ej=>{"use strict";Object.defineProperty(ej,"__esModule",{value:!0});ej.makePatchingRequire=void 0;var lgt=require("path"),ugt=A2e(),D2e=no(),L2e=require("module"),dgt=Object.keys(process.binding("natives")),N2e=L2e.prototype.require;function pgt(n){var e={};return function(r){var o=N2e.apply(this,arguments);if(n[r]){var s=L2e._resolveFilename(r,this);if(e.hasOwnProperty(s))return e[s];var a=void 0;if(dgt.indexOf(r)<0)try{a=N2e.call(this,lgt.join(r,"package.json")).version}catch{return o}else a=process.version.substring(1);var c=a.indexOf("-");c>=0&&(a=a.substring(0,c));for(var l=o,u=0,d=n[r];u<d.length;u++){var p=d[u];if(ugt.satisfies(a,p.versionSpecifier)&&(l=p.patch(l,s),D2e.channel)){var f=p.publisherName||r;D2e.channel.addPatchedModule(f,a)}}return e[s]=l}return o}}ej.makePatchingRequire=pgt});var O2e=P((LYn,fgt)=>{fgt.exports={name:"diagnostic-channel",version:"1.1.1",main:"./dist/src/channel.js",types:"./dist/src/channel.d.ts",scripts:{build:"tsc",lint:"eslint ./ --fix",clean:"rimraf ./dist",test:"mocha ./dist/tests/**/*.js",debug:"mocha --inspect-brk ./dist/tests/**/*.js"},homepage:"https://github.com/Microsoft/node-diagnostic-channel",bugs:{url:"https://github.com/Microsoft/node-diagnostic-channel/issues"},repository:{type:"git",url:"https://github.com/Microsoft/node-diagnostic-channel.git"},description:"Provides a context-saving pub/sub channel to connect diagnostic event publishers and subscribers",dependencies:{semver:"^7.5.3"},devDependencies:{"@types/mocha":"^2.2.40","@types/node":"~8.0.0",mocha:"^3.2.0",rimraf:"^2.6.1",sinon:"1.17.6",typescript:"4.1.2"},files:["dist/src/**/*.d.ts","dist/src/**/*.js","LICENSE","README.md","package.json"],license:"MIT"}});var no=P(Uu=>{"use strict";Object.defineProperty(Uu,"__esModule",{value:!0});Uu.channel=Uu.ContextPreservingEventEmitter=Uu.trueFilter=Uu.makePatchingRequire=void 0;var mgt=Fie(),hgt=Fie();Object.defineProperty(Uu,"makePatchingRequire",{enumerable:!0,get:function(){return hgt.makePatchingRequire}});var ggt=function(n){return!0};Uu.trueFilter=ggt;var F2e=function(){function n(){this.version=O2e().version,this.subscribers={},this.contextPreservationFunction=function(e){return e},this.knownPatches={},this.modulesPatched=[],this.currentlyPublishing=!1}return n.prototype.shouldPublish=function(e){var t=this.subscribers[e];return t?t.some(function(r){var o=r.filter;return!o||o(!1)}):!1},n.prototype.publish=function(e,t){if(!this.currentlyPublishing){var r=this.subscribers[e];if(r){var o={timestamp:Date.now(),data:t};this.currentlyPublishing=!0,r.forEach(function(s){var a=s.listener,c=s.filter;try{c&&c(!0)&&a(o)}catch{}}),this.currentlyPublishing=!1}}},n.prototype.subscribe=function(e,t,r,o){r===void 0&&(r=Uu.trueFilter),this.subscribers[e]||(this.subscribers[e]=[]),this.subscribers[e].push({listener:t,filter:r,patchCallback:o});var s=this.checkIfModuleIsAlreadyPatched(e);s&&o&&o(s.name,s.version)},n.prototype.unsubscribe=function(e,t,r){r===void 0&&(r=Uu.trueFilter);var o=this.subscribers[e];if(o){for(var s=0;s<o.length;++s)if(o[s].listener===t&&o[s].filter===r)return o.splice(s,1),!0}return!1},n.prototype.reset=function(){var e=this;this.subscribers={},this.contextPreservationFunction=function(t){return t},Object.getOwnPropertyNames(this.knownPatches).forEach(function(t){return delete e.knownPatches[t]})},n.prototype.bindToContext=function(e){return this.contextPreservationFunction(e)},n.prototype.addContextPreservation=function(e){var t=this.contextPreservationFunction;this.contextPreservationFunction=function(r){return e(t(r))}},n.prototype.registerMonkeyPatch=function(e,t){this.knownPatches[e]||(this.knownPatches[e]=[]),this.knownPatches[e].push(t)},n.prototype.getPatchesObject=function(){return this.knownPatches},n.prototype.addPatchedModule=function(e,t){for(var r=0,o=this.modulesPatched;r<o.length;r++){var s=o[r];if(s.name===e)return}this.modulesPatched.push({name:e,version:t});var a=this.subscribers[e];a&&a.forEach(function(c){c.patchCallback&&c.patchCallback(e,t)})},n.prototype.checkIfModuleIsAlreadyPatched=function(e){for(var t=0,r=this.modulesPatched;t<r.length;t++){var o=r[t];if(o.name===e)return o}return null},n}();Uu.ContextPreservingEventEmitter=F2e;global.diagnosticsSource||(global.diagnosticsSource=new F2e,M2e=require("module"),M2e.prototype.require=mgt.makePatchingRequire(global.diagnosticsSource.getPatchesObject()));var M2e;Uu.channel=global.diagnosticsSource});var U2e,B2e=N(()=>{U2e=typeof globalThis=="object"?globalThis:global});var q2e=N(()=>{B2e()});var j2e=N(()=>{q2e()});var ng,Uie=N(()=>{ng="1.6.0"});function vgt(n){var e=new Set([n]),t=new Set,r=n.match(H2e);if(!r)return function(){return!1};var o={major:+r[1],minor:+r[2],patch:+r[3],prerelease:r[4]};if(o.prerelease!=null)return function(l){return l===n};function s(c){return t.add(c),!1}function a(c){return e.add(c),!0}return function(l){if(e.has(l))return!0;if(t.has(l))return!1;var u=l.match(H2e);if(!u)return s(l);var d={major:+u[1],minor:+u[2],patch:+u[3],prerelease:u[4]};return d.prerelease!=null||o.major!==d.major?s(l):o.major===0?o.minor===d.minor&&o.patch<=d.patch?a(l):s(l):o.minor<=d.minor?a(l):s(l)}}var H2e,V2e,G2e=N(()=>{Uie();H2e=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;V2e=vgt(ng)});function Kf(n,e,t,r){var o;r===void 0&&(r=!1);var s=r4[n4]=(o=r4[n4])!==null&&o!==void 0?o:{version:ng};if(!r&&s[n]){var a=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+n);return t.error(a.stack||a.message),!1}if(s.version!==ng){var a=new Error("@opentelemetry/api: Registration of version v"+s.version+" for "+n+" does not match previously registered API v"+ng);return t.error(a.stack||a.message),!1}return s[n]=e,t.debug("@opentelemetry/api: Registered a global for "+n+" v"+ng+"."),!0}function Dl(n){var e,t,r=(e=r4[n4])===null||e===void 0?void 0:e.version;if(!(!r||!V2e(r)))return(t=r4[n4])===null||t===void 0?void 0:t[n]}function Yf(n,e){e.debug("@opentelemetry/api: Unregistering a global for "+n+" v"+ng+".");var t=r4[n4];t&&delete t[n]}var ygt,n4,r4,PS=N(()=>{j2e();Uie();G2e();ygt=ng.split(".")[0],n4=Symbol.for("opentelemetry.js.api."+ygt),r4=U2e});function i4(n,e,t){var r=Dl("diag");if(r)return t.unshift(e),r[n].apply(r,_gt([],bgt(t),!1))}var bgt,_gt,z2e,$2e=N(()=>{PS();bgt=function(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return s},_gt=function(n,e,t){if(t||arguments.length===2)for(var r=0,o=e.length,s;r<o;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))},z2e=function(){function n(e){this._namespace=e.namespace||"DiagComponentLogger"}return n.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i4("debug",this._namespace,e)},n.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i4("error",this._namespace,e)},n.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i4("info",this._namespace,e)},n.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i4("warn",this._namespace,e)},n.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i4("verbose",this._namespace,e)},n}()});var Yr,tj=N(()=>{(function(n){n[n.NONE=0]="NONE",n[n.ERROR=30]="ERROR",n[n.WARN=50]="WARN",n[n.INFO=60]="INFO",n[n.DEBUG=70]="DEBUG",n[n.VERBOSE=80]="VERBOSE",n[n.ALL=9999]="ALL"})(Yr||(Yr={}))});function W2e(n,e){n<Yr.NONE?n=Yr.NONE:n>Yr.ALL&&(n=Yr.ALL),e=e||{};function t(r,o){var s=e[r];return typeof s=="function"&&n>=o?s.bind(e):function(){}}return{error:t("error",Yr.ERROR),warn:t("warn",Yr.WARN),info:t("info",Yr.INFO),debug:t("debug",Yr.DEBUG),verbose:t("verbose",Yr.VERBOSE)}}var K2e=N(()=>{tj()});var xgt,Sgt,Igt,Ta,AS=N(()=>{$2e();K2e();tj();PS();xgt=function(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return s},Sgt=function(n,e,t){if(t||arguments.length===2)for(var r=0,o=e.length,s;r<o;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))},Igt="diag",Ta=function(){function n(){function e(o){return function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];var c=Dl("diag");if(c)return c[o].apply(c,Sgt([],xgt(s),!1))}}var t=this,r=function(o,s){var a,c,l;if(s===void 0&&(s={logLevel:Yr.INFO}),o===t){var u=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error((a=u.stack)!==null&&a!==void 0?a:u.message),!1}typeof s=="number"&&(s={logLevel:s});var d=Dl("diag"),p=W2e((c=s.logLevel)!==null&&c!==void 0?c:Yr.INFO,o);if(d&&!s.suppressOverrideMessage){var f=(l=new Error().stack)!==null&&l!==void 0?l:"<failed to generate stacktrace>";d.warn("Current logger will be overwritten from "+f),p.warn("Current logger will overwrite one already registered from "+f)}return Kf("diag",p,t,!0)};t.setLogger=r,t.disable=function(){Yf(Igt,t)},t.createComponentLogger=function(o){return new z2e(o)},t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}return n.instance=function(){return this._instance||(this._instance=new n),this._instance},n}()});var Tgt,Cgt,Y2e,Q2e=N(()=>{Tgt=function(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return s},Cgt=function(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Y2e=function(){function n(e){this._entries=e?new Map(e):new Map}return n.prototype.getEntry=function(e){var t=this._entries.get(e);if(t)return Object.assign({},t)},n.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map(function(e){var t=Tgt(e,2),r=t[0],o=t[1];return[r,o]})},n.prototype.setEntry=function(e,t){var r=new n(this._entries);return r._entries.set(e,t),r},n.prototype.removeEntry=function(e){var t=new n(this._entries);return t._entries.delete(e),t},n.prototype.removeEntries=function(){for(var e,t,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var s=new n(this._entries);try{for(var a=Cgt(r),c=a.next();!c.done;c=a.next()){var l=c.value;s._entries.delete(l)}}catch(u){e={error:u}}finally{try{c&&!c.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return s},n.prototype.clear=function(){return new n},n}()});var X2e,J2e=N(()=>{X2e=Symbol("BaggageEntryMetadata")});function Z2e(n){return n===void 0&&(n={}),new Y2e(new Map(Object.entries(n)))}function nj(n){return typeof n!="string"&&(Egt.error("Cannot create baggage metadata from unknown type: "+typeof n),n=""),{__TYPE__:X2e,toString:function(){return n}}}var Egt,Bie=N(()=>{AS();Q2e();J2e();Egt=Ta.instance()});function Qf(n){return Symbol.for(n)}var wgt,rj,o4=N(()=>{wgt=function(){function n(e){var t=this;t._currentContext=e?new Map(e):new Map,t.getValue=function(r){return t._currentContext.get(r)},t.setValue=function(r,o){var s=new n(t._currentContext);return s._currentContext.set(r,o),s},t.deleteValue=function(r){var o=new n(t._currentContext);return o._currentContext.delete(r),o}}return n}(),rj=new wgt});var qie,eDe,tDe=N(()=>{qie=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}],eDe=function(){function n(){function e(r){return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];if(console){var a=console[r];if(typeof a!="function"&&(a=console.log),typeof a=="function")return a.apply(console,o)}}}for(var t=0;t<qie.length;t++)this[qie[t].n]=e(qie[t].c)}return n}()});function nDe(){return Vie}var uR,kgt,jie,Rgt,Pgt,Agt,Hie,Dgt,Ngt,Lgt,Vie,Ogt,Mgt,Fgt,Ugt,Bgt,qgt,Gie=N(()=>{uR=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),kgt=function(){function n(){}return n.prototype.createHistogram=function(e,t){return Mgt},n.prototype.createCounter=function(e,t){return Ogt},n.prototype.createUpDownCounter=function(e,t){return Fgt},n.prototype.createObservableGauge=function(e,t){return Bgt},n.prototype.createObservableCounter=function(e,t){return Ugt},n.prototype.createObservableUpDownCounter=function(e,t){return qgt},n.prototype.addBatchObservableCallback=function(e,t){},n.prototype.removeBatchObservableCallback=function(e){},n}(),jie=function(){function n(){}return n}(),Rgt=function(n){uR(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.add=function(t,r){},e}(jie),Pgt=function(n){uR(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.add=function(t,r){},e}(jie),Agt=function(n){uR(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.record=function(t,r){},e}(jie),Hie=function(){function n(){}return n.prototype.addCallback=function(e){},n.prototype.removeCallback=function(e){},n}(),Dgt=function(n){uR(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(Hie),Ngt=function(n){uR(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(Hie),Lgt=function(n){uR(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(Hie),Vie=new kgt,Ogt=new Rgt,Mgt=new Agt,Fgt=new Pgt,Ugt=new Dgt,Bgt=new Ngt,qgt=new Lgt});var ij,rDe=N(()=>{(function(n){n[n.INT=0]="INT",n[n.DOUBLE=1]="DOUBLE"})(ij||(ij={}))});var oj,sj,zie=N(()=>{oj={get:function(n,e){if(n!=null)return n[e]},keys:function(n){return n==null?[]:Object.keys(n)}},sj={set:function(n,e,t){n!=null&&(n[e]=t)}}});var jgt,Hgt,iDe,oDe=N(()=>{o4();jgt=function(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return s},Hgt=function(n,e,t){if(t||arguments.length===2)for(var r=0,o=e.length,s;r<o;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))},iDe=function(){function n(){}return n.prototype.active=function(){return rj},n.prototype.with=function(e,t,r){for(var o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return t.call.apply(t,Hgt([r],jgt(o),!1))},n.prototype.bind=function(e,t){return t},n.prototype.enable=function(){return this},n.prototype.disable=function(){return this},n}()});var Vgt,Ggt,$ie,zgt,Wy,s4=N(()=>{oDe();PS();AS();Vgt=function(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return s},Ggt=function(n,e,t){if(t||arguments.length===2)for(var r=0,o=e.length,s;r<o;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))},$ie="context",zgt=new iDe,Wy=function(){function n(){}return n.getInstance=function(){return this._instance||(this._instance=new n),this._instance},n.prototype.setGlobalContextManager=function(e){return Kf($ie,e,Ta.instance())},n.prototype.active=function(){return this._getContextManager().active()},n.prototype.with=function(e,t,r){for(var o,s=[],a=3;a<arguments.length;a++)s[a-3]=arguments[a];return(o=this._getContextManager()).with.apply(o,Ggt([e,t,r],Vgt(s),!1))},n.prototype.bind=function(e,t){return this._getContextManager().bind(e,t)},n.prototype._getContextManager=function(){return Dl($ie)||zgt},n.prototype.disable=function(){this._getContextManager().disable(),Yf($ie,Ta.instance())},n}()});var vo,Wie=N(()=>{(function(n){n[n.NONE=0]="NONE",n[n.SAMPLED=1]="SAMPLED"})(vo||(vo={}))});var a4,c4,dR,aj=N(()=>{Wie();a4="0000000000000000",c4="00000000000000000000000000000000",dR={traceId:c4,spanId:a4,traceFlags:vo.NONE}});var Ky,cj=N(()=>{aj();Ky=function(){function n(e){e===void 0&&(e=dR),this._spanContext=e}return n.prototype.spanContext=function(){return this._spanContext},n.prototype.setAttribute=function(e,t){return this},n.prototype.setAttributes=function(e){return this},n.prototype.addEvent=function(e,t){return this},n.prototype.setStatus=function(e){return this},n.prototype.updateName=function(e){return this},n.prototype.end=function(e){},n.prototype.isRecording=function(){return!1},n.prototype.recordException=function(e,t){},n}()});function lj(n){return n.getValue(Kie)||void 0}function sDe(){return lj(Wy.getInstance().active())}function l4(n,e){return n.setValue(Kie,e)}function aDe(n){return n.deleteValue(Kie)}function cDe(n,e){return l4(n,new Ky(e))}function uj(n){var e;return(e=lj(n))===null||e===void 0?void 0:e.spanContext()}var Kie,Yie=N(()=>{o4();cj();s4();Kie=Qf("OpenTelemetry Context Key SPAN")});function DS(n){return $gt.test(n)&&n!==c4}function Qie(n){return Wgt.test(n)&&n!==a4}function Bu(n){return DS(n.traceId)&&Qie(n.spanId)}function lDe(n){return new Ky(n)}var $gt,Wgt,dj=N(()=>{aj();cj();$gt=/^([0-9a-f]{32})$/i,Wgt=/^[0-9a-f]{16}$/i});function Kgt(n){return typeof n=="object"&&typeof n.spanId=="string"&&typeof n.traceId=="string"&&typeof n.traceFlags=="number"}var Xie,pj,Jie=N(()=>{s4();Yie();cj();dj();Xie=Wy.getInstance(),pj=function(){function n(){}return n.prototype.startSpan=function(e,t,r){r===void 0&&(r=Xie.active());var o=!!t?.root;if(o)return new Ky;var s=r&&uj(r);return Kgt(s)&&Bu(s)?new Ky(s):new Ky},n.prototype.startActiveSpan=function(e,t,r,o){var s,a,c;if(!(arguments.length<2)){arguments.length===2?c=t:arguments.length===3?(s=t,c=r):(s=t,a=r,c=o);var l=a??Xie.active(),u=this.startSpan(e,s,l),d=l4(l,u);return Xie.with(d,c,void 0,u)}},n}()});var Ygt,fj,Zie=N(()=>{Jie();Ygt=new pj,fj=function(){function n(e,t,r,o){this._provider=e,this.name=t,this.version=r,this.options=o}return n.prototype.startSpan=function(e,t,r){return this._getTracer().startSpan(e,t,r)},n.prototype.startActiveSpan=function(e,t,r,o){var s=this._getTracer();return Reflect.apply(s.startActiveSpan,s,arguments)},n.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):Ygt},n}()});var uDe,dDe=N(()=>{Jie();uDe=function(){function n(){}return n.prototype.getTracer=function(e,t,r){return new pj},n}()});var Qgt,u4,eoe=N(()=>{Zie();dDe();Qgt=new uDe,u4=function(){function n(){}return n.prototype.getTracer=function(e,t,r){var o;return(o=this.getDelegateTracer(e,t,r))!==null&&o!==void 0?o:new fj(this,e,t,r)},n.prototype.getDelegate=function(){var e;return(e=this._delegate)!==null&&e!==void 0?e:Qgt},n.prototype.setDelegate=function(e){this._delegate=e},n.prototype.getDelegateTracer=function(e,t,r){var o;return(o=this._delegate)===null||o===void 0?void 0:o.getTracer(e,t,r)},n}()});var jc,pDe=N(()=>{(function(n){n[n.NOT_RECORD=0]="NOT_RECORD",n[n.RECORD=1]="RECORD",n[n.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(jc||(jc={}))});var pR,fDe=N(()=>{(function(n){n[n.INTERNAL=0]="INTERNAL",n[n.SERVER=1]="SERVER",n[n.CLIENT=2]="CLIENT",n[n.PRODUCER=3]="PRODUCER",n[n.CONSUMER=4]="CONSUMER"})(pR||(pR={}))});var fR,mDe=N(()=>{(function(n){n[n.UNSET=0]="UNSET",n[n.OK=1]="OK",n[n.ERROR=2]="ERROR"})(fR||(fR={}))});function hDe(n){return Zgt.test(n)}function gDe(n){return evt.test(n)&&!tvt.test(n)}var toe,Xgt,Jgt,Zgt,evt,tvt,vDe=N(()=>{toe="[_0-9a-z-*/]",Xgt="[a-z]"+toe+"{0,255}",Jgt="[a-z0-9]"+toe+"{0,240}@[a-z]"+toe+"{0,13}",Zgt=new RegExp("^(?:"+Xgt+"|"+Jgt+")$"),evt=/^[ -~]{0,255}[!-~]$/,tvt=/,|=/});var yDe,nvt,bDe,_De,xDe,SDe=N(()=>{vDe();yDe=32,nvt=512,bDe=",",_De="=",xDe=function(){function n(e){this._internalState=new Map,e&&this._parse(e)}return n.prototype.set=function(e,t){var r=this._clone();return r._internalState.has(e)&&r._internalState.delete(e),r._internalState.set(e,t),r},n.prototype.unset=function(e){var t=this._clone();return t._internalState.delete(e),t},n.prototype.get=function(e){return this._internalState.get(e)},n.prototype.serialize=function(){var e=this;return this._keys().reduce(function(t,r){return t.push(r+_De+e.get(r)),t},[]).join(bDe)},n.prototype._parse=function(e){e.length>nvt||(this._internalState=e.split(bDe).reverse().reduce(function(t,r){var o=r.trim(),s=o.indexOf(_De);if(s!==-1){var a=o.slice(0,s),c=o.slice(s+1,r.length);hDe(a)&&gDe(c)&&t.set(a,c)}return t},new Map),this._internalState.size>yDe&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,yDe))))},n.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},n.prototype._clone=function(){var e=new n;return e._internalState=new Map(this._internalState),e},n}()});function IDe(n){return new xDe(n)}var TDe=N(()=>{SDe()});var Ja,CDe=N(()=>{s4();Ja=Wy.getInstance()});var Pt,EDe=N(()=>{AS();Pt=Ta.instance()});var rvt,wDe,kDe=N(()=>{Gie();rvt=function(){function n(){}return n.prototype.getMeter=function(e,t,r){return Vie},n}(),wDe=new rvt});var noe,RDe,PDe=N(()=>{kDe();PS();AS();noe="metrics",RDe=function(){function n(){}return n.getInstance=function(){return this._instance||(this._instance=new n),this._instance},n.prototype.setGlobalMeterProvider=function(e){return Kf(noe,e,Ta.instance())},n.prototype.getMeterProvider=function(){return Dl(noe)||wDe},n.prototype.getMeter=function(e,t,r){return this.getMeterProvider().getMeter(e,t,r)},n.prototype.disable=function(){Yf(noe,Ta.instance())},n}()});var roe,ADe=N(()=>{PDe();roe=RDe.getInstance()});var DDe,NDe=N(()=>{DDe=function(){function n(){}return n.prototype.inject=function(e,t){},n.prototype.extract=function(e,t){return e},n.prototype.fields=function(){return[]},n}()});function ooe(n){return n.getValue(ioe)||void 0}function LDe(){return ooe(Wy.getInstance().active())}function ODe(n,e){return n.setValue(ioe,e)}function MDe(n){return n.deleteValue(ioe)}var ioe,FDe=N(()=>{s4();o4();ioe=Qf("OpenTelemetry Baggage Key")});var soe,ivt,UDe,BDe=N(()=>{PS();NDe();zie();FDe();Bie();AS();soe="propagation",ivt=new DDe,UDe=function(){function n(){this.createBaggage=Z2e,this.getBaggage=ooe,this.getActiveBaggage=LDe,this.setBaggage=ODe,this.deleteBaggage=MDe}return n.getInstance=function(){return this._instance||(this._instance=new n),this._instance},n.prototype.setGlobalPropagator=function(e){return Kf(soe,e,Ta.instance())},n.prototype.inject=function(e,t,r){return r===void 0&&(r=sj),this._getGlobalPropagator().inject(e,t,r)},n.prototype.extract=function(e,t,r){return r===void 0&&(r=oj),this._getGlobalPropagator().extract(e,t,r)},n.prototype.fields=function(){return this._getGlobalPropagator().fields()},n.prototype.disable=function(){Yf(soe,Ta.instance())},n.prototype._getGlobalPropagator=function(){return Dl(soe)||ivt},n}()});var rg,qDe=N(()=>{BDe();rg=UDe.getInstance()});var aoe,jDe,HDe=N(()=>{PS();eoe();dj();Yie();AS();aoe="trace",jDe=function(){function n(){this._proxyTracerProvider=new u4,this.wrapSpanContext=lDe,this.isSpanContextValid=Bu,this.deleteSpan=aDe,this.getSpan=lj,this.getActiveSpan=sDe,this.getSpanContext=uj,this.setSpan=l4,this.setSpanContext=cDe}return n.getInstance=function(){return this._instance||(this._instance=new n),this._instance},n.prototype.setGlobalTracerProvider=function(e){var t=Kf(aoe,this._proxyTracerProvider,Ta.instance());return t&&this._proxyTracerProvider.setDelegate(e),t},n.prototype.getTracerProvider=function(){return Dl(aoe)||this._proxyTracerProvider},n.prototype.getTracer=function(e,t){return this.getTracerProvider().getTracer(e,t)},n.prototype.disable=function(){Yf(aoe,Ta.instance()),this._proxyTracerProvider=new u4},n}()});var ss,VDe=N(()=>{HDe();ss=jDe.getInstance()});var mR={};Dr(mR,{DiagConsoleLogger:()=>eDe,DiagLogLevel:()=>Yr,INVALID_SPANID:()=>a4,INVALID_SPAN_CONTEXT:()=>dR,INVALID_TRACEID:()=>c4,ProxyTracer:()=>fj,ProxyTracerProvider:()=>u4,ROOT_CONTEXT:()=>rj,SamplingDecision:()=>jc,SpanKind:()=>pR,SpanStatusCode:()=>fR,TraceFlags:()=>vo,ValueType:()=>ij,baggageEntryMetadataFromString:()=>nj,context:()=>Ja,createContextKey:()=>Qf,createNoopMeter:()=>nDe,createTraceState:()=>IDe,default:()=>ovt,defaultTextMapGetter:()=>oj,defaultTextMapSetter:()=>sj,diag:()=>Pt,isSpanContextValid:()=>Bu,isValidSpanId:()=>Qie,isValidTraceId:()=>DS,metrics:()=>roe,propagation:()=>rg,trace:()=>ss});var ovt,Hn=N(()=>{Bie();o4();tDe();tj();Gie();rDe();zie();Zie();eoe();pDe();fDe();mDe();Wie();TDe();dj();aj();CDe();EDe();ADe();qDe();VDe();ovt={context:Ja,diag:Pt,metrics:roe,propagation:rg,trace:ss}});function d4(n){return n.setValue(coe,!0)}function svt(n){return n.deleteValue(coe)}function NS(n){return n.getValue(coe)===!0}var coe,p4=N(()=>{Hn();coe=Qf("OpenTelemetry SDK Context Key SUPPRESS_TRACING")});var GDe,mj,hR,hj,zDe,$De,WDe,loe=N(()=>{GDe="=",mj=";",hR=",",hj="baggage",zDe=180,$De=4096,WDe=8192});var poe={};Dr(poe,{getKeyPairs:()=>doe,parseKeyPairsIntoRecord:()=>cvt,parsePairKeyValue:()=>gj,serializeKeyPairs:()=>uoe});function uoe(n){return n.reduce(function(e,t){var r=""+e+(e!==""?hR:"")+t;return r.length>WDe?e:r},"")}function doe(n){return n.getAllEntries().map(function(e){var t=avt(e,2),r=t[0],o=t[1],s=encodeURIComponent(r)+"="+encodeURIComponent(o.value);return o.metadata!==void 0&&(s+=mj+o.metadata.toString()),s})}function gj(n){var e=n.split(mj);if(!(e.length<=0)){var t=e.shift();if(t){var r=t.indexOf(GDe);if(!(r<=0)){var o=decodeURIComponent(t.substring(0,r).trim()),s=decodeURIComponent(t.substring(r+1).trim()),a;return e.length>0&&(a=nj(e.join(mj))),{key:o,value:s,metadata:a}}}}}function cvt(n){return typeof n!="string"||n.length===0?{}:n.split(hR).map(function(e){return gj(e)}).filter(function(e){return e!==void 0&&e.value.length>0}).reduce(function(e,t){return e[t.key]=t.value,e},{})}var avt,foe=N(()=>{Hn();loe();avt=function(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return s}});var moe,KDe=N(()=>{Hn();p4();loe();foe();moe=function(){function n(){}return n.prototype.inject=function(e,t,r){var o=rg.getBaggage(e);if(!(!o||NS(e))){var s=doe(o).filter(function(c){return c.length<=$De}).slice(0,zDe),a=uoe(s);a.length>0&&r.set(t,hj,a)}},n.prototype.extract=function(e,t,r){var o=r.get(t,hj),s=Array.isArray(o)?o.join(hR):o;if(!s)return e;var a={};if(s.length===0)return e;var c=s.split(hR);return c.forEach(function(l){var u=gj(l);if(u){var d={value:u.value};u.metadata&&(d.metadata=u.metadata),a[u.key]=d}}),Object.entries(a).length===0?e:rg.setBaggage(e,rg.createBaggage(a))},n.prototype.fields=function(){return[hj]},n}()});var lvt,YDe=N(()=>{lvt=function(){function n(e,t){this._monotonicClock=t,this._epochMillis=e.now(),this._performanceMillis=t.now()}return n.prototype.now=function(){var e=this._monotonicClock.now()-this._performanceMillis;return this._epochMillis+e},n}()});function LS(n){var e,t,r={};if(typeof n!="object"||n==null)return r;try{for(var o=QDe(Object.entries(n)),s=o.next();!s.done;s=o.next()){var a=uvt(s.value,2),c=a[0],l=a[1];if(!XDe(c)){Pt.warn("Invalid attribute key: "+c);continue}if(!vj(l)){Pt.warn("Invalid attribute value set for key: "+c);continue}Array.isArray(l)?r[c]=l.slice():r[c]=l}}catch(u){e={error:u}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return r}function XDe(n){return typeof n=="string"&&n.length>0}function vj(n){return n==null?!0:Array.isArray(n)?dvt(n):JDe(n)}function dvt(n){var e,t,r;try{for(var o=QDe(n),s=o.next();!s.done;s=o.next()){var a=s.value;if(a!=null){if(!r){if(JDe(a)){r=typeof a;continue}return!1}if(typeof a!==r)return!1}}}catch(c){e={error:c}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return!0}function JDe(n){switch(typeof n){case"number":case"boolean":case"string":return!0}return!1}var QDe,uvt,ZDe=N(()=>{Hn();QDe=function(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},uvt=function(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return s}});function hoe(){return function(n){Pt.error(pvt(n))}}function pvt(n){return typeof n=="string"?n:JSON.stringify(fvt(n))}function fvt(n){for(var e={},t=n;t!==null;)Object.getOwnPropertyNames(t).forEach(function(r){if(!e[r]){var o=t[r];o&&(e[r]=String(o))}}),t=Object.getPrototypeOf(t);return e}var goe=N(()=>{Hn()});function mvt(n){eNe=n}function Hc(n){try{eNe(n)}catch{}}var eNe,voe=N(()=>{goe();eNe=hoe()});var Nl,yoe=N(()=>{(function(n){n.AlwaysOff="always_off",n.AlwaysOn="always_on",n.ParentBasedAlwaysOff="parentbased_always_off",n.ParentBasedAlwaysOn="parentbased_always_on",n.ParentBasedTraceIdRatio="parentbased_traceidratio",n.TraceIdRatio="traceidratio"})(Nl||(Nl={}))});var tNe,nNe=N(()=>{tNe=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof global=="object"?global:{}});function vvt(n){return gvt.indexOf(n)>-1}function bvt(n){return yvt.indexOf(n)>-1}function xvt(n){return _vt.indexOf(n)>-1}function Svt(n,e,t){if(!(typeof t[n]>"u")){var r=String(t[n]);e[n]=r.toLowerCase()==="true"}}function Ivt(n,e,t,r,o){if(r===void 0&&(r=-1/0),o===void 0&&(o=1/0),typeof t[n]<"u"){var s=Number(t[n]);isNaN(s)||(s<r?e[n]=r:s>o?e[n]=o:e[n]=s)}}function Tvt(n,e,t,r){r===void 0&&(r=hvt);var o=t[n];typeof o=="string"&&(e[n]=o.split(r).map(function(s){return s.trim()}))}function Evt(n,e,t){var r=t[n];if(typeof r=="string"){var o=Cvt[r.toUpperCase()];o!=null&&(e[n]=o)}}function f4(n){var e={};for(var t in yj){var r=t;switch(r){case"OTEL_LOG_LEVEL":Evt(r,e,n);break;default:if(vvt(r))Svt(r,e,n);else if(bvt(r))Ivt(r,e,n);else if(xvt(r))Tvt(r,e,n);else{var o=n[r];typeof o<"u"&&o!==null&&(e[r]=String(o))}}}return e}function boe(){return typeof process<"u"&&process&&process.env?f4(process.env):f4(tNe)}var hvt,gvt,yvt,_vt,gR,vR,rNe,iNe,yj,Cvt,_oe=N(()=>{Hn();yoe();nNe();hvt=",",gvt=["OTEL_SDK_DISABLED"];yvt=["OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_BLRP_EXPORT_TIMEOUT","OTEL_BLRP_MAX_EXPORT_BATCH_SIZE","OTEL_BLRP_MAX_QUEUE_SIZE","OTEL_BLRP_SCHEDULE_DELAY","OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT","OTEL_EXPORTER_OTLP_TIMEOUT","OTEL_EXPORTER_OTLP_TRACES_TIMEOUT","OTEL_EXPORTER_OTLP_METRICS_TIMEOUT","OTEL_EXPORTER_OTLP_LOGS_TIMEOUT","OTEL_EXPORTER_JAEGER_AGENT_PORT"];_vt=["OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS"];gR=1/0,vR=128,rNe=128,iNe=128,yj={OTEL_SDK_DISABLED:!1,CONTAINER_NAME:"",ECS_CONTAINER_METADATA_URI_V4:"",ECS_CONTAINER_METADATA_URI:"",HOSTNAME:"",KUBERNETES_SERVICE_HOST:"",NAMESPACE:"",OTEL_BSP_EXPORT_TIMEOUT:3e4,OTEL_BSP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BSP_MAX_QUEUE_SIZE:2048,OTEL_BSP_SCHEDULE_DELAY:5e3,OTEL_BLRP_EXPORT_TIMEOUT:3e4,OTEL_BLRP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BLRP_MAX_QUEUE_SIZE:2048,OTEL_BLRP_SCHEDULE_DELAY:5e3,OTEL_EXPORTER_JAEGER_AGENT_HOST:"",OTEL_EXPORTER_JAEGER_AGENT_PORT:6832,OTEL_EXPORTER_JAEGER_ENDPOINT:"",OTEL_EXPORTER_JAEGER_PASSWORD:"",OTEL_EXPORTER_JAEGER_USER:"",OTEL_EXPORTER_OTLP_ENDPOINT:"",OTEL_EXPORTER_OTLP_TRACES_ENDPOINT:"",OTEL_EXPORTER_OTLP_METRICS_ENDPOINT:"",OTEL_EXPORTER_OTLP_LOGS_ENDPOINT:"",OTEL_EXPORTER_OTLP_HEADERS:"",OTEL_EXPORTER_OTLP_TRACES_HEADERS:"",OTEL_EXPORTER_OTLP_METRICS_HEADERS:"",OTEL_EXPORTER_OTLP_LOGS_HEADERS:"",OTEL_EXPORTER_OTLP_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_TRACES_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_METRICS_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_LOGS_TIMEOUT:1e4,OTEL_EXPORTER_ZIPKIN_ENDPOINT:"http://localhost:9411/api/v2/spans",OTEL_LOG_LEVEL:Yr.INFO,OTEL_NO_PATCH_MODULES:[],OTEL_PROPAGATORS:["tracecontext","baggage"],OTEL_RESOURCE_ATTRIBUTES:"",OTEL_SERVICE_NAME:"",OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT:gR,OTEL_ATTRIBUTE_COUNT_LIMIT:vR,OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT:gR,OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT:vR,OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT:gR,OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT:vR,OTEL_SPAN_EVENT_COUNT_LIMIT:128,OTEL_SPAN_LINK_COUNT_LIMIT:128,OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT:rNe,OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT:iNe,OTEL_TRACES_EXPORTER:"",OTEL_TRACES_SAMPLER:Nl.ParentBasedAlwaysOn,OTEL_TRACES_SAMPLER_ARG:"",OTEL_LOGS_EXPORTER:"",OTEL_EXPORTER_OTLP_INSECURE:"",OTEL_EXPORTER_OTLP_TRACES_INSECURE:"",OTEL_EXPORTER_OTLP_METRICS_INSECURE:"",OTEL_EXPORTER_OTLP_LOGS_INSECURE:"",OTEL_EXPORTER_OTLP_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_COMPRESSION:"",OTEL_EXPORTER_OTLP_TRACES_COMPRESSION:"",OTEL_EXPORTER_OTLP_METRICS_COMPRESSION:"",OTEL_EXPORTER_OTLP_LOGS_COMPRESSION:"",OTEL_EXPORTER_OTLP_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_TRACES_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_LOGS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE:"cumulative"};Cvt={ALL:Yr.ALL,VERBOSE:Yr.VERBOSE,DEBUG:Yr.DEBUG,INFO:Yr.INFO,WARN:Yr.WARN,ERROR:Yr.ERROR,NONE:Yr.NONE}});function as(){var n=f4(process.env);return Object.assign({HOSTNAME:oNe.hostname()},yj,n)}var oNe,sNe=N(()=>{oNe=q(require("os"));_oe()});var wvt,aNe=N(()=>{wvt=typeof globalThis=="object"?globalThis:global});function cNe(n){return n>=48&&n<=57?n-48:n>=97&&n<=102?n-87:n-55}function Pvt(n){var e;n.length===16?e=kvt:n.length===32?e=Rvt:e=Buffer.alloc(n.length/2);for(var t=0,r=0;r<n.length;r+=2){var o=cNe(n.charCodeAt(r)),s=cNe(n.charCodeAt(r+1));e.writeUInt8(o<<4|s,t++)}return e.toString("base64")}var kvt,Rvt,lNe=N(()=>{kvt=Buffer.alloc(8),Rvt=Buffer.alloc(16)});function uNe(n){return function(){for(var t=0;t<n/4;t++)bj.writeUInt32BE(Math.random()*Math.pow(2,32)>>>0,t*4);for(var t=0;t<n&&!(bj[t]>0);t++)t===n-1&&(bj[n-1]=1);return bj.toString("hex",0,n)}}var Avt,dNe,Dvt,bj,pNe=N(()=>{Avt=8,dNe=16,Dvt=function(){function n(){this.generateTraceId=uNe(dNe),this.generateSpanId=uNe(Avt)}return n}(),bj=Buffer.allocUnsafe(dNe)});var fNe,ig,mNe=N(()=>{fNe=require("perf_hooks"),ig=fNe.performance});var xoe,_j=N(()=>{xoe="1.17.0"});var og,Nvt,Lvt,Ovt,Mvt,Fvt,Uvt,Bvt,qvt,jvt,Hvt,Vvt,Gvt,zvt,hNe=N(()=>{og={AWS_LAMBDA_INVOKED_ARN:"aws.lambda.invoked_arn",DB_SYSTEM:"db.system",DB_CONNECTION_STRING:"db.connection_string",DB_USER:"db.user",DB_JDBC_DRIVER_CLASSNAME:"db.jdbc.driver_classname",DB_NAME:"db.name",DB_STATEMENT:"db.statement",DB_OPERATION:"db.operation",DB_MSSQL_INSTANCE_NAME:"db.mssql.instance_name",DB_CASSANDRA_KEYSPACE:"db.cassandra.keyspace",DB_CASSANDRA_PAGE_SIZE:"db.cassandra.page_size",DB_CASSANDRA_CONSISTENCY_LEVEL:"db.cassandra.consistency_level",DB_CASSANDRA_TABLE:"db.cassandra.table",DB_CASSANDRA_IDEMPOTENCE:"db.cassandra.idempotence",DB_CASSANDRA_SPECULATIVE_EXECUTION_COUNT:"db.cassandra.speculative_execution_count",DB_CASSANDRA_COORDINATOR_ID:"db.cassandra.coordinator.id",DB_CASSANDRA_COORDINATOR_DC:"db.cassandra.coordinator.dc",DB_HBASE_NAMESPACE:"db.hbase.namespace",DB_REDIS_DATABASE_INDEX:"db.redis.database_index",DB_MONGODB_COLLECTION:"db.mongodb.collection",DB_SQL_TABLE:"db.sql.table",EXCEPTION_TYPE:"exception.type",EXCEPTION_MESSAGE:"exception.message",EXCEPTION_STACKTRACE:"exception.stacktrace",EXCEPTION_ESCAPED:"exception.escaped",FAAS_TRIGGER:"faas.trigger",FAAS_EXECUTION:"faas.execution",FAAS_DOCUMENT_COLLECTION:"faas.document.collection",FAAS_DOCUMENT_OPERATION:"faas.document.operation",FAAS_DOCUMENT_TIME:"faas.document.time",FAAS_DOCUMENT_NAME:"faas.document.name",FAAS_TIME:"faas.time",FAAS_CRON:"faas.cron",FAAS_COLDSTART:"faas.coldstart",FAAS_INVOKED_NAME:"faas.invoked_name",FAAS_INVOKED_PROVIDER:"faas.invoked_provider",FAAS_INVOKED_REGION:"faas.invoked_region",NET_TRANSPORT:"net.transport",NET_PEER_IP:"net.peer.ip",NET_PEER_PORT:"net.peer.port",NET_PEER_NAME:"net.peer.name",NET_HOST_IP:"net.host.ip",NET_HOST_PORT:"net.host.port",NET_HOST_NAME:"net.host.name",NET_HOST_CONNECTION_TYPE:"net.host.connection.type",NET_HOST_CONNECTION_SUBTYPE:"net.host.connection.subtype",NET_HOST_CARRIER_NAME:"net.host.carrier.name",NET_HOST_CARRIER_MCC:"net.host.carrier.mcc",NET_HOST_CARRIER_MNC:"net.host.carrier.mnc",NET_HOST_CARRIER_ICC:"net.host.carrier.icc",PEER_SERVICE:"peer.service",ENDUSER_ID:"enduser.id",ENDUSER_ROLE:"enduser.role",ENDUSER_SCOPE:"enduser.scope",THREAD_ID:"thread.id",THREAD_NAME:"thread.name",CODE_FUNCTION:"code.function",CODE_NAMESPACE:"code.namespace",CODE_FILEPATH:"code.filepath",CODE_LINENO:"code.lineno",HTTP_METHOD:"http.method",HTTP_URL:"http.url",HTTP_TARGET:"http.target",HTTP_HOST:"http.host",HTTP_SCHEME:"http.scheme",HTTP_STATUS_CODE:"http.status_code",HTTP_FLAVOR:"http.flavor",HTTP_USER_AGENT:"http.user_agent",HTTP_REQUEST_CONTENT_LENGTH:"http.request_content_length",HTTP_REQUEST_CONTENT_LENGTH_UNCOMPRESSED:"http.request_content_length_uncompressed",HTTP_RESPONSE_CONTENT_LENGTH:"http.response_content_length",HTTP_RESPONSE_CONTENT_LENGTH_UNCOMPRESSED:"http.response_content_length_uncompressed",HTTP_SERVER_NAME:"http.server_name",HTTP_ROUTE:"http.route",HTTP_CLIENT_IP:"http.client_ip",AWS_DYNAMODB_TABLE_NAMES:"aws.dynamodb.table_names",AWS_DYNAMODB_CONSUMED_CAPACITY:"aws.dynamodb.consumed_capacity",AWS_DYNAMODB_ITEM_COLLECTION_METRICS:"aws.dynamodb.item_collection_metrics",AWS_DYNAMODB_PROVISIONED_READ_CAPACITY:"aws.dynamodb.provisioned_read_capacity",AWS_DYNAMODB_PROVISIONED_WRITE_CAPACITY:"aws.dynamodb.provisioned_write_capacity",AWS_DYNAMODB_CONSISTENT_READ:"aws.dynamodb.consistent_read",AWS_DYNAMODB_PROJECTION:"aws.dynamodb.projection",AWS_DYNAMODB_LIMIT:"aws.dynamodb.limit",AWS_DYNAMODB_ATTRIBUTES_TO_GET:"aws.dynamodb.attributes_to_get",AWS_DYNAMODB_INDEX_NAME:"aws.dynamodb.index_name",AWS_DYNAMODB_SELECT:"aws.dynamodb.select",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEXES:"aws.dynamodb.global_secondary_indexes",AWS_DYNAMODB_LOCAL_SECONDARY_INDEXES:"aws.dynamodb.local_secondary_indexes",AWS_DYNAMODB_EXCLUSIVE_START_TABLE:"aws.dynamodb.exclusive_start_table",AWS_DYNAMODB_TABLE_COUNT:"aws.dynamodb.table_count",AWS_DYNAMODB_SCAN_FORWARD:"aws.dynamodb.scan_forward",AWS_DYNAMODB_SEGMENT:"aws.dynamodb.segment",AWS_DYNAMODB_TOTAL_SEGMENTS:"aws.dynamodb.total_segments",AWS_DYNAMODB_COUNT:"aws.dynamodb.count",AWS_DYNAMODB_SCANNED_COUNT:"aws.dynamodb.scanned_count",AWS_DYNAMODB_ATTRIBUTE_DEFINITIONS:"aws.dynamodb.attribute_definitions",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEX_UPDATES:"aws.dynamodb.global_secondary_index_updates",MESSAGING_SYSTEM:"messaging.system",MESSAGING_DESTINATION:"messaging.destination",MESSAGING_DESTINATION_KIND:"messaging.destination_kind",MESSAGING_TEMP_DESTINATION:"messaging.temp_destination",MESSAGING_PROTOCOL:"messaging.protocol",MESSAGING_PROTOCOL_VERSION:"messaging.protocol_version",MESSAGING_URL:"messaging.url",MESSAGING_MESSAGE_ID:"messaging.message_id",MESSAGING_CONVERSATION_ID:"messaging.conversation_id",MESSAGING_MESSAGE_PAYLOAD_SIZE_BYTES:"messaging.message_payload_size_bytes",MESSAGING_MESSAGE_PAYLOAD_COMPRESSED_SIZE_BYTES:"messaging.message_payload_compressed_size_bytes",MESSAGING_OPERATION:"messaging.operation",MESSAGING_CONSUMER_ID:"messaging.consumer_id",MESSAGING_RABBITMQ_ROUTING_KEY:"messaging.rabbitmq.routing_key",MESSAGING_KAFKA_MESSAGE_KEY:"messaging.kafka.message_key",MESSAGING_KAFKA_CONSUMER_GROUP:"messaging.kafka.consumer_group",MESSAGING_KAFKA_CLIENT_ID:"messaging.kafka.client_id",MESSAGING_KAFKA_PARTITION:"messaging.kafka.partition",MESSAGING_KAFKA_TOMBSTONE:"messaging.kafka.tombstone",RPC_SYSTEM:"rpc.system",RPC_SERVICE:"rpc.service",RPC_METHOD:"rpc.method",RPC_GRPC_STATUS_CODE:"rpc.grpc.status_code",RPC_JSONRPC_VERSION:"rpc.jsonrpc.version",RPC_JSONRPC_REQUEST_ID:"rpc.jsonrpc.request_id",RPC_JSONRPC_ERROR_CODE:"rpc.jsonrpc.error_code",RPC_JSONRPC_ERROR_MESSAGE:"rpc.jsonrpc.error_message",MESSAGE_TYPE:"message.type",MESSAGE_ID:"message.id",MESSAGE_COMPRESSED_SIZE:"message.compressed_size",MESSAGE_UNCOMPRESSED_SIZE:"message.uncompressed_size"},Nvt={OTHER_SQL:"other_sql",MSSQL:"mssql",MYSQL:"mysql",ORACLE:"oracle",DB2:"db2",POSTGRESQL:"postgresql",REDSHIFT:"redshift",HIVE:"hive",CLOUDSCAPE:"cloudscape",HSQLDB:"hsqldb",PROGRESS:"progress",MAXDB:"maxdb",HANADB:"hanadb",INGRES:"ingres",FIRSTSQL:"firstsql",EDB:"edb",CACHE:"cache",ADABAS:"adabas",FIREBIRD:"firebird",DERBY:"derby",FILEMAKER:"filemaker",INFORMIX:"informix",INSTANTDB:"instantdb",INTERBASE:"interbase",MARIADB:"mariadb",NETEZZA:"netezza",PERVASIVE:"pervasive",POINTBASE:"pointbase",SQLITE:"sqlite",SYBASE:"sybase",TERADATA:"teradata",VERTICA:"vertica",H2:"h2",COLDFUSION:"coldfusion",CASSANDRA:"cassandra",HBASE:"hbase",MONGODB:"mongodb",REDIS:"redis",COUCHBASE:"couchbase",COUCHDB:"couchdb",COSMOSDB:"cosmosdb",DYNAMODB:"dynamodb",NEO4J:"neo4j",GEODE:"geode",ELASTICSEARCH:"elasticsearch",MEMCACHED:"memcached",COCKROACHDB:"cockroachdb"},Lvt={ALL:"all",EACH_QUORUM:"each_quorum",QUORUM:"quorum",LOCAL_QUORUM:"local_quorum",ONE:"one",TWO:"two",THREE:"three",LOCAL_ONE:"local_one",ANY:"any",SERIAL:"serial",LOCAL_SERIAL:"local_serial"},Ovt={DATASOURCE:"datasource",HTTP:"http",PUBSUB:"pubsub",TIMER:"timer",OTHER:"other"},Mvt={INSERT:"insert",EDIT:"edit",DELETE:"delete"},Fvt={ALIBABA_CLOUD:"alibaba_cloud",AWS:"aws",AZURE:"azure",GCP:"gcp"},Uvt={IP_TCP:"ip_tcp",IP_UDP:"ip_udp",IP:"ip",UNIX:"unix",PIPE:"pipe",INPROC:"inproc",OTHER:"other"},Bvt={WIFI:"wifi",WIRED:"wired",CELL:"cell",UNAVAILABLE:"unavailable",UNKNOWN:"unknown"},qvt={GPRS:"gprs",EDGE:"edge",UMTS:"umts",CDMA:"cdma",EVDO_0:"evdo_0",EVDO_A:"evdo_a",CDMA2000_1XRTT:"cdma2000_1xrtt",HSDPA:"hsdpa",HSUPA:"hsupa",HSPA:"hspa",IDEN:"iden",EVDO_B:"evdo_b",LTE:"lte",EHRPD:"ehrpd",HSPAP:"hspap",GSM:"gsm",TD_SCDMA:"td_scdma",IWLAN:"iwlan",NR:"nr",NRNSA:"nrnsa",LTE_CA:"lte_ca"},jvt={HTTP_1_0:"1.0",HTTP_1_1:"1.1",HTTP_2_0:"2.0",SPDY:"SPDY",QUIC:"QUIC"},Hvt={QUEUE:"queue",TOPIC:"topic"},Vvt={RECEIVE:"receive",PROCESS:"process"},Gvt={OK:0,CANCELLED:1,UNKNOWN:2,INVALID_ARGUMENT:3,DEADLINE_EXCEEDED:4,NOT_FOUND:5,ALREADY_EXISTS:6,PERMISSION_DENIED:7,RESOURCE_EXHAUSTED:8,FAILED_PRECONDITION:9,ABORTED:10,OUT_OF_RANGE:11,UNIMPLEMENTED:12,INTERNAL:13,UNAVAILABLE:14,DATA_LOSS:15,UNAUTHENTICATED:16},zvt={SENT:"SENT",RECEIVED:"RECEIVED"}});var gNe=N(()=>{hNe()});var An,$vt,Wvt,Kvt,Yvt,Qvt,Soe,vNe=N(()=>{An={CLOUD_PROVIDER:"cloud.provider",CLOUD_ACCOUNT_ID:"cloud.account.id",CLOUD_REGION:"cloud.region",CLOUD_AVAILABILITY_ZONE:"cloud.availability_zone",CLOUD_PLATFORM:"cloud.platform",AWS_ECS_CONTAINER_ARN:"aws.ecs.container.arn",AWS_ECS_CLUSTER_ARN:"aws.ecs.cluster.arn",AWS_ECS_LAUNCHTYPE:"aws.ecs.launchtype",AWS_ECS_TASK_ARN:"aws.ecs.task.arn",AWS_ECS_TASK_FAMILY:"aws.ecs.task.family",AWS_ECS_TASK_REVISION:"aws.ecs.task.revision",AWS_EKS_CLUSTER_ARN:"aws.eks.cluster.arn",AWS_LOG_GROUP_NAMES:"aws.log.group.names",AWS_LOG_GROUP_ARNS:"aws.log.group.arns",AWS_LOG_STREAM_NAMES:"aws.log.stream.names",AWS_LOG_STREAM_ARNS:"aws.log.stream.arns",CONTAINER_NAME:"container.name",CONTAINER_ID:"container.id",CONTAINER_RUNTIME:"container.runtime",CONTAINER_IMAGE_NAME:"container.image.name",CONTAINER_IMAGE_TAG:"container.image.tag",DEPLOYMENT_ENVIRONMENT:"deployment.environment",DEVICE_ID:"device.id",DEVICE_MODEL_IDENTIFIER:"device.model.identifier",DEVICE_MODEL_NAME:"device.model.name",FAAS_NAME:"faas.name",FAAS_ID:"faas.id",FAAS_VERSION:"faas.version",FAAS_INSTANCE:"faas.instance",FAAS_MAX_MEMORY:"faas.max_memory",HOST_ID:"host.id",HOST_NAME:"host.name",HOST_TYPE:"host.type",HOST_ARCH:"host.arch",HOST_IMAGE_NAME:"host.image.name",HOST_IMAGE_ID:"host.image.id",HOST_IMAGE_VERSION:"host.image.version",K8S_CLUSTER_NAME:"k8s.cluster.name",K8S_NODE_NAME:"k8s.node.name",K8S_NODE_UID:"k8s.node.uid",K8S_NAMESPACE_NAME:"k8s.namespace.name",K8S_POD_UID:"k8s.pod.uid",K8S_POD_NAME:"k8s.pod.name",K8S_CONTAINER_NAME:"k8s.container.name",K8S_REPLICASET_UID:"k8s.replicaset.uid",K8S_REPLICASET_NAME:"k8s.replicaset.name",K8S_DEPLOYMENT_UID:"k8s.deployment.uid",K8S_DEPLOYMENT_NAME:"k8s.deployment.name",K8S_STATEFULSET_UID:"k8s.statefulset.uid",K8S_STATEFULSET_NAME:"k8s.statefulset.name",K8S_DAEMONSET_UID:"k8s.daemonset.uid",K8S_DAEMONSET_NAME:"k8s.daemonset.name",K8S_JOB_UID:"k8s.job.uid",K8S_JOB_NAME:"k8s.job.name",K8S_CRONJOB_UID:"k8s.cronjob.uid",K8S_CRONJOB_NAME:"k8s.cronjob.name",OS_TYPE:"os.type",OS_DESCRIPTION:"os.description",OS_NAME:"os.name",OS_VERSION:"os.version",PROCESS_PID:"process.pid",PROCESS_EXECUTABLE_NAME:"process.executable.name",PROCESS_EXECUTABLE_PATH:"process.executable.path",PROCESS_COMMAND:"process.command",PROCESS_COMMAND_LINE:"process.command_line",PROCESS_COMMAND_ARGS:"process.command_args",PROCESS_OWNER:"process.owner",PROCESS_RUNTIME_NAME:"process.runtime.name",PROCESS_RUNTIME_VERSION:"process.runtime.version",PROCESS_RUNTIME_DESCRIPTION:"process.runtime.description",SERVICE_NAME:"service.name",SERVICE_NAMESPACE:"service.namespace",SERVICE_INSTANCE_ID:"service.instance.id",SERVICE_VERSION:"service.version",TELEMETRY_SDK_NAME:"telemetry.sdk.name",TELEMETRY_SDK_LANGUAGE:"telemetry.sdk.language",TELEMETRY_SDK_VERSION:"telemetry.sdk.version",TELEMETRY_AUTO_VERSION:"telemetry.auto.version",WEBENGINE_NAME:"webengine.name",WEBENGINE_VERSION:"webengine.version",WEBENGINE_DESCRIPTION:"webengine.description"},$vt={ALIBABA_CLOUD:"alibaba_cloud",AWS:"aws",AZURE:"azure",GCP:"gcp"},Wvt={ALIBABA_CLOUD_ECS:"alibaba_cloud_ecs",ALIBABA_CLOUD_FC:"alibaba_cloud_fc",AWS_EC2:"aws_ec2",AWS_ECS:"aws_ecs",AWS_EKS:"aws_eks",AWS_LAMBDA:"aws_lambda",AWS_ELASTIC_BEANSTALK:"aws_elastic_beanstalk",AZURE_VM:"azure_vm",AZURE_CONTAINER_INSTANCES:"azure_container_instances",AZURE_AKS:"azure_aks",AZURE_FUNCTIONS:"azure_functions",AZURE_APP_SERVICE:"azure_app_service",GCP_COMPUTE_ENGINE:"gcp_compute_engine",GCP_CLOUD_RUN:"gcp_cloud_run",GCP_KUBERNETES_ENGINE:"gcp_kubernetes_engine",GCP_CLOUD_FUNCTIONS:"gcp_cloud_functions",GCP_APP_ENGINE:"gcp_app_engine"},Kvt={EC2:"ec2",FARGATE:"fargate"},Yvt={AMD64:"amd64",ARM32:"arm32",ARM64:"arm64",IA64:"ia64",PPC32:"ppc32",PPC64:"ppc64",X86:"x86"},Qvt={WINDOWS:"windows",LINUX:"linux",DARWIN:"darwin",FREEBSD:"freebsd",NETBSD:"netbsd",OPENBSD:"openbsd",DRAGONFLYBSD:"dragonflybsd",HPUX:"hpux",AIX:"aix",SOLARIS:"solaris",Z_OS:"z_os"},Soe={CPP:"cpp",DOTNET:"dotnet",ERLANG:"erlang",GO:"go",JAVA:"java",NODEJS:"nodejs",PHP:"php",PYTHON:"python",RUBY:"ruby",WEBJS:"webjs"}});var yNe=N(()=>{vNe()});var Ioe={};Dr(Ioe,{AwsEcsLaunchtypeValues:()=>Kvt,CloudPlatformValues:()=>Wvt,CloudProviderValues:()=>$vt,DbCassandraConsistencyLevelValues:()=>Lvt,DbSystemValues:()=>Nvt,FaasDocumentOperationValues:()=>Mvt,FaasInvokedProviderValues:()=>Fvt,FaasTriggerValues:()=>Ovt,HostArchValues:()=>Yvt,HttpFlavorValues:()=>jvt,MessageTypeValues:()=>zvt,MessagingDestinationKindValues:()=>Hvt,MessagingOperationValues:()=>Vvt,NetHostConnectionSubtypeValues:()=>qvt,NetHostConnectionTypeValues:()=>Bvt,NetTransportValues:()=>Uvt,OsTypeValues:()=>Qvt,RpcGrpcStatusCodeValues:()=>Gvt,SemanticAttributes:()=>og,SemanticResourceAttributes:()=>An,TelemetrySdkLanguageValues:()=>Soe});var tp=N(()=>{gNe();yNe()});var yR,m4,bNe=N(()=>{_j();tp();m4=(yR={},yR[An.TELEMETRY_SDK_NAME]="opentelemetry",yR[An.PROCESS_RUNTIME_NAME]="node",yR[An.TELEMETRY_SDK_LANGUAGE]=Soe.NODEJS,yR[An.TELEMETRY_SDK_VERSION]=xoe,yR)});function Toe(n){n.unref()}var _Ne=N(()=>{});var xNe=N(()=>{sNe();aNe();lNe();pNe();mNe();bNe();_Ne()});var Coe=N(()=>{xNe()});function Xf(n){var e=n/1e3,t=Math.trunc(e),r=Math.round(n%1e3*Jvt);return[t,r]}function h4(){var n=ig.timeOrigin;if(typeof n!="number"){var e=ig;n=e.timing&&e.timing.fetchStart}return n}function Sj(n){var e=Xf(h4()),t=Xf(typeof n=="number"?n:ig.now());return Cj(e,t)}function Zvt(n){if(g4(n))return n;if(typeof n=="number")return n<h4()?Sj(n):Xf(n);if(n instanceof Date)return Xf(n.getTime());throw TypeError("Invalid input type")}function Eoe(n,e){var t=e[0]-n[0],r=e[1]-n[1];return r<0&&(t-=1,r+=xj),[t,r]}function e0t(n){var e=SNe,t=""+"0".repeat(e)+n[1]+"Z",r=t.substr(t.length-e-1),o=new Date(n[0]*1e3).toISOString();return o.replace("000Z",r)}function t0t(n){return n[0]*xj+n[1]}function n0t(n){return n[0]*1e3+n[1]/1e6}function Ij(n){return n[0]*1e6+n[1]/1e3}function g4(n){return Array.isArray(n)&&n.length===2&&typeof n[0]=="number"&&typeof n[1]=="number"}function Tj(n){return g4(n)||typeof n=="number"||n instanceof Date}function Cj(n,e){var t=[n[0]+e[0],n[1]+e[1]];return t[1]>=xj&&(t[1]-=xj,t[0]+=1),t}var SNe,Xvt,Jvt,xj,INe=N(()=>{Coe();SNe=9,Xvt=6,Jvt=Math.pow(10,Xvt),xj=Math.pow(10,SNe)});var TNe=N(()=>{});var qu,CNe=N(()=>{(function(n){n[n.SUCCESS=0]="SUCCESS",n[n.FAILED=1]="FAILED"})(qu||(qu={}))});var r0t,woe,ENe=N(()=>{Hn();r0t=function(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},woe=function(){function n(e){e===void 0&&(e={});var t;this._propagators=(t=e.propagators)!==null&&t!==void 0?t:[],this._fields=Array.from(new Set(this._propagators.map(function(r){return typeof r.fields=="function"?r.fields():[]}).reduce(function(r,o){return r.concat(o)},[])))}return n.prototype.inject=function(e,t,r){var o,s;try{for(var a=r0t(this._propagators),c=a.next();!c.done;c=a.next()){var l=c.value;try{l.inject(e,t,r)}catch(u){Pt.warn("Failed to inject with "+l.constructor.name+". Err: "+u.message)}}}catch(u){o={error:u}}finally{try{c&&!c.done&&(s=a.return)&&s.call(a)}finally{if(o)throw o.error}}},n.prototype.extract=function(e,t,r){return this._propagators.reduce(function(o,s){try{return s.extract(o,t,r)}catch(a){Pt.warn("Failed to inject with "+s.constructor.name+". Err: "+a.message)}return o},e)},n.prototype.fields=function(){return this._fields.slice()},n}()});function wNe(n){return s0t.test(n)}function kNe(n){return a0t.test(n)&&!c0t.test(n)}var koe,i0t,o0t,s0t,a0t,c0t,RNe=N(()=>{koe="[_0-9a-z-*/]",i0t="[a-z]"+koe+"{0,255}",o0t="[a-z0-9]"+koe+"{0,240}@[a-z]"+koe+"{0,13}",s0t=new RegExp("^(?:"+i0t+"|"+o0t+")$"),a0t=/^[ -~]{0,255}[!-~]$/,c0t=/,|=/});var PNe,l0t,ANe,DNe,Roe,Poe=N(()=>{RNe();PNe=32,l0t=512,ANe=",",DNe="=",Roe=function(){function n(e){this._internalState=new Map,e&&this._parse(e)}return n.prototype.set=function(e,t){var r=this._clone();return r._internalState.has(e)&&r._internalState.delete(e),r._internalState.set(e,t),r},n.prototype.unset=function(e){var t=this._clone();return t._internalState.delete(e),t},n.prototype.get=function(e){return this._internalState.get(e)},n.prototype.serialize=function(){var e=this;return this._keys().reduce(function(t,r){return t.push(r+DNe+e.get(r)),t},[]).join(ANe)},n.prototype._parse=function(e){e.length>l0t||(this._internalState=e.split(ANe).reverse().reduce(function(t,r){var o=r.trim(),s=o.indexOf(DNe);if(s!==-1){var a=o.slice(0,s),c=o.slice(s+1,r.length);wNe(a)&&kNe(c)&&t.set(a,c)}return t},new Map),this._internalState.size>PNe&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,PNe))))},n.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},n.prototype._clone=function(){var e=new n;return e._internalState=new Map(this._internalState),e},n}()});function NNe(n){var e=h0t.exec(n);return!e||e[1]==="00"&&e[5]?null:{traceId:e[2],spanId:e[3],traceFlags:parseInt(e[4],16)}}var Ej,wj,u0t,d0t,p0t,f0t,m0t,h0t,Aoe,LNe=N(()=>{Hn();p4();Poe();Ej="traceparent",wj="tracestate",u0t="00",d0t="(?!ff)[\\da-f]{2}",p0t="(?![0]{32})[\\da-f]{32}",f0t="(?![0]{16})[\\da-f]{16}",m0t="[\\da-f]{2}",h0t=new RegExp("^\\s?("+d0t+")-("+p0t+")-("+f0t+")-("+m0t+")(-.*)?\\s?$");Aoe=function(){function n(){}return n.prototype.inject=function(e,t,r){var o=ss.getSpanContext(e);if(!(!o||NS(e)||!Bu(o))){var s=u0t+"-"+o.traceId+"-"+o.spanId+"-0"+Number(o.traceFlags||vo.NONE).toString(16);r.set(t,Ej,s),o.traceState&&r.set(t,wj,o.traceState.serialize())}},n.prototype.extract=function(e,t,r){var o=r.get(t,Ej);if(!o)return e;var s=Array.isArray(o)?o[0]:o;if(typeof s!="string")return e;var a=NNe(s);if(!a)return e;a.isRemote=!0;var c=r.get(t,wj);if(c){var l=Array.isArray(c)?c.join(","):c;a.traceState=new Roe(typeof l=="string"?l:void 0)}return ss.setSpanContext(e,a)},n.prototype.fields=function(){return[Ej,wj]},n}()});var ONe=N(()=>{});function g0t(n,e){return n.setValue(Noe,e)}function v0t(n){return n.deleteValue(Noe)}function y0t(n){return n.getValue(Noe)}var Noe,Doe,MNe=N(()=>{Hn();Noe=Qf("OpenTelemetry SDK Context Key RPC_METADATA");(function(n){n.HTTP="http"})(Doe||(Doe={}))});var kj,Loe=N(()=>{Hn();kj=function(){function n(){}return n.prototype.shouldSample=function(){return{decision:jc.NOT_RECORD}},n.prototype.toString=function(){return"AlwaysOffSampler"},n}()});var v4,Ooe=N(()=>{Hn();v4=function(){function n(){}return n.prototype.shouldSample=function(){return{decision:jc.RECORD_AND_SAMPLED}},n.prototype.toString=function(){return"AlwaysOnSampler"},n}()});var b0t,FNe=N(()=>{Hn();voe();Loe();Ooe();b0t=function(){function n(e){var t,r,o,s;this._root=e.root,this._root||(Hc(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new v4),this._remoteParentSampled=(t=e.remoteParentSampled)!==null&&t!==void 0?t:new v4,this._remoteParentNotSampled=(r=e.remoteParentNotSampled)!==null&&r!==void 0?r:new kj,this._localParentSampled=(o=e.localParentSampled)!==null&&o!==void 0?o:new v4,this._localParentNotSampled=(s=e.localParentNotSampled)!==null&&s!==void 0?s:new kj}return n.prototype.shouldSample=function(e,t,r,o,s,a){var c=ss.getSpanContext(e);return!c||!Bu(c)?this._root.shouldSample(e,t,r,o,s,a):c.isRemote?c.traceFlags&vo.SAMPLED?this._remoteParentSampled.shouldSample(e,t,r,o,s,a):this._remoteParentNotSampled.shouldSample(e,t,r,o,s,a):c.traceFlags&vo.SAMPLED?this._localParentSampled.shouldSample(e,t,r,o,s,a):this._localParentNotSampled.shouldSample(e,t,r,o,s,a)},n.prototype.toString=function(){return"ParentBased{root="+this._root.toString()+", remoteParentSampled="+this._remoteParentSampled.toString()+", remoteParentNotSampled="+this._remoteParentNotSampled.toString()+", localParentSampled="+this._localParentSampled.toString()+", localParentNotSampled="+this._localParentNotSampled.toString()+"}"},n}()});var _0t,UNe=N(()=>{Hn();_0t=function(){function n(e){e===void 0&&(e=0),this._ratio=e,this._ratio=this._normalize(e),this._upperBound=Math.floor(this._ratio*4294967295)}return n.prototype.shouldSample=function(e,t){return{decision:DS(t)&&this._accumulate(t)<this._upperBound?jc.RECORD_AND_SAMPLED:jc.NOT_RECORD}},n.prototype.toString=function(){return"TraceIdRatioBased{"+this._ratio+"}"},n.prototype._normalize=function(e){return typeof e!="number"||isNaN(e)?0:e>=1?1:e<=0?0:e},n.prototype._accumulate=function(e){for(var t=0,r=0;r<e.length/8;r++){var o=r*8,s=parseInt(e.slice(o,o+8),16);t=(t^s)>>>0}return t},n}()});function w0t(n,e){return function(t){return n(e(t))}}function Moe(n){if(!k0t(n)||R0t(n)!==x0t)return!1;var e=E0t(n);if(e===null)return!0;var t=jNe.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&BNe.call(t)===C0t}function k0t(n){return n!=null&&typeof n=="object"}function R0t(n){return n==null?n===void 0?I0t:S0t:OS&&OS in Object(n)?P0t(n):A0t(n)}function P0t(n){var e=jNe.call(n,OS),t=n[OS],r=!1;try{n[OS]=void 0,r=!0}catch{}var o=HNe.call(n);return r&&(e?n[OS]=t:delete n[OS]),o}function A0t(n){return HNe.call(n)}var x0t,S0t,I0t,T0t,BNe,C0t,E0t,qNe,jNe,OS,HNe,VNe=N(()=>{x0t="[object Object]",S0t="[object Null]",I0t="[object Undefined]",T0t=Function.prototype,BNe=T0t.toString,C0t=BNe.call(Object),E0t=w0t(Object.getPrototypeOf,Object),qNe=Object.prototype,jNe=qNe.hasOwnProperty,OS=Symbol?Symbol.toStringTag:void 0,HNe=qNe.toString});function Uoe(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];for(var t=n.shift(),r=new WeakMap;n.length>0;)t=zNe(t,n.shift(),0,r);return t}function Foe(n){return Pj(n)?n.slice():n}function zNe(n,e,t,r){t===void 0&&(t=0);var o;if(!(t>D0t)){if(t++,Rj(n)||Rj(e)||$Ne(e))o=Foe(e);else if(Pj(n)){if(o=n.slice(),Pj(e))for(var s=0,a=e.length;s<a;s++)o.push(Foe(e[s]));else if(y4(e))for(var c=Object.keys(e),s=0,a=c.length;s<a;s++){var l=c[s];o[l]=Foe(e[l])}}else if(y4(n))if(y4(e)){if(!N0t(n,e))return e;o=Object.assign({},n);for(var c=Object.keys(e),s=0,a=c.length;s<a;s++){var l=c[s],u=e[l];if(Rj(u))typeof u>"u"?delete o[l]:o[l]=u;else{var d=o[l],p=u;if(GNe(n,l,r)||GNe(e,l,r))delete o[l];else{if(y4(d)&&y4(p)){var f=r.get(d)||[],m=r.get(p)||[];f.push({obj:n,key:l}),m.push({obj:e,key:l}),r.set(d,f),r.set(p,m)}o[l]=zNe(o[l],u,t,r)}}}}else o=e;return o}}function GNe(n,e,t){for(var r=t.get(n[e])||[],o=0,s=r.length;o<s;o++){var a=r[o];if(a.key===e&&a.obj===n)return!0}return!1}function Pj(n){return Array.isArray(n)}function $Ne(n){return typeof n=="function"}function y4(n){return!Rj(n)&&!Pj(n)&&!$Ne(n)&&typeof n=="object"}function Rj(n){return typeof n=="string"||typeof n=="number"||typeof n=="boolean"||typeof n>"u"||n instanceof Date||n instanceof RegExp||n===null}function N0t(n,e){return!(!Moe(n)||!Moe(e))}var D0t,WNe=N(()=>{VNe();D0t=20});function O0t(n,e){var t,r=new Promise(function(s,a){t=setTimeout(function(){a(new KNe("Operation timed out."))},e)});return Promise.race([n,r]).then(function(o){return clearTimeout(t),o},function(o){throw clearTimeout(t),o})}var L0t,KNe,YNe=N(()=>{L0t=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),KNe=function(n){L0t(e,n);function e(t){var r=n.call(this,t)||this;return Object.setPrototypeOf(r,e.prototype),r}return e}(Error)});function QNe(n,e){return typeof e=="string"?n===e:!!n.match(e)}function F0t(n,e){var t,r;if(!e)return!1;try{for(var o=M0t(e),s=o.next();!s.done;s=o.next()){var a=s.value;if(QNe(n,a))return!0}}catch(c){t={error:c}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return!1}var M0t,XNe=N(()=>{M0t=function(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}});function U0t(n){return typeof n=="function"&&typeof n.__original=="function"&&typeof n.__unwrap=="function"&&n.__wrapped===!0}var JNe=N(()=>{});var ZNe,eLe=N(()=>{ZNe=function(){function n(){var e=this;this._promise=new Promise(function(t,r){e._resolve=t,e._reject=r})}return Object.defineProperty(n.prototype,"promise",{get:function(){return this._promise},enumerable:!1,configurable:!0}),n.prototype.resolve=function(e){this._resolve(e)},n.prototype.reject=function(e){this._reject(e)},n}()});var B0t,q0t,b4,tLe=N(()=>{eLe();B0t=function(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return s},q0t=function(n,e,t){if(t||arguments.length===2)for(var r=0,o=e.length,s;r<o;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))},b4=function(){function n(e,t){this._callback=e,this._that=t,this._isCalled=!1,this._deferred=new ZNe}return Object.defineProperty(n.prototype,"isCalled",{get:function(){return this._isCalled},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"promise",{get:function(){return this._deferred.promise},enumerable:!1,configurable:!0}),n.prototype.call=function(){for(var e,t=this,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];if(!this._isCalled){this._isCalled=!0;try{Promise.resolve((e=this._callback).call.apply(e,q0t([this._that],B0t(r),!1))).then(function(s){return t._deferred.resolve(s)},function(s){return t._deferred.reject(s)})}catch(s){this._deferred.reject(s)}}return this._deferred.promise},n}()});function nLe(n,e){return new Promise(function(t){Ja.with(d4(Ja.active()),function(){n.export(e,function(r){t(r)})})})}var rLe=N(()=>{Hn();p4()});var iLe={};Dr(iLe,{AlwaysOffSampler:()=>kj,AlwaysOnSampler:()=>v4,AnchoredClock:()=>lvt,BindOnceFuture:()=>b4,CompositePropagator:()=>woe,DEFAULT_ATTRIBUTE_COUNT_LIMIT:()=>vR,DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT:()=>gR,DEFAULT_ENVIRONMENT:()=>yj,DEFAULT_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT:()=>rNe,DEFAULT_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT:()=>iNe,ExportResultCode:()=>qu,ParentBasedSampler:()=>b0t,RPCType:()=>Doe,RandomIdGenerator:()=>Dvt,SDK_INFO:()=>m4,TRACE_PARENT_HEADER:()=>Ej,TRACE_STATE_HEADER:()=>wj,TimeoutError:()=>KNe,TraceIdRatioBasedSampler:()=>_0t,TraceState:()=>Roe,TracesSamplerValues:()=>Nl,VERSION:()=>xoe,W3CBaggagePropagator:()=>moe,W3CTraceContextPropagator:()=>Aoe,_globalThis:()=>wvt,addHrTimes:()=>Cj,baggageUtils:()=>poe,callWithTimeout:()=>O0t,deleteRPCMetadata:()=>v0t,getEnv:()=>as,getEnvWithoutDefaults:()=>boe,getRPCMetadata:()=>y0t,getTimeOrigin:()=>h4,globalErrorHandler:()=>Hc,hexToBase64:()=>Pvt,hrTime:()=>Sj,hrTimeDuration:()=>Eoe,hrTimeToMicroseconds:()=>Ij,hrTimeToMilliseconds:()=>n0t,hrTimeToNanoseconds:()=>t0t,hrTimeToTimeStamp:()=>e0t,internal:()=>Boe,isAttributeKey:()=>XDe,isAttributeValue:()=>vj,isTimeInput:()=>Tj,isTimeInputHrTime:()=>g4,isTracingSuppressed:()=>NS,isUrlIgnored:()=>F0t,isWrapped:()=>U0t,loggingErrorHandler:()=>hoe,merge:()=>Uoe,millisToHrTime:()=>Xf,otperformance:()=>ig,parseEnvironment:()=>f4,parseTraceParent:()=>NNe,sanitizeAttributes:()=>LS,setGlobalErrorHandler:()=>mvt,setRPCMetadata:()=>g0t,suppressTracing:()=>d4,timeInputToHrTime:()=>Zvt,unrefTimer:()=>Toe,unsuppressTracing:()=>svt,urlMatches:()=>QNe});var Boe,Za=N(()=>{KDe();YDe();ZDe();voe();goe();INe();TNe();CNe();_j();foe();Coe();ENe();LNe();ONe();MNe();Loe();Ooe();FNe();UNe();p4();Poe();_oe();WNe();yoe();YNe();XNe();JNe();tLe();_j();rLe();Boe={_export:nLe}});var oLe,sLe=N(()=>{oLe="exception"});var j0t,H0t,qoe,joe=N(()=>{Hn();Za();tp();sLe();j0t=function(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},H0t=function(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return s},qoe=function(){function n(e,t,r,o,s,a,c,l,u){c===void 0&&(c=[]),this.attributes={},this.links=[],this.events=[],this._droppedAttributesCount=0,this._droppedEventsCount=0,this._droppedLinksCount=0,this.status={code:fR.UNSET},this.endTime=[0,0],this._ended=!1,this._duration=[-1,-1],this.name=r,this._spanContext=o,this.parentSpanId=a,this.kind=s,this.links=c;var d=Date.now();this._performanceStartTime=ig.now(),this._performanceOffset=d-(this._performanceStartTime+h4()),this._startTimeProvided=l!=null,this.startTime=this._getTime(l??d),this.resource=e.resource,this.instrumentationLibrary=e.instrumentationLibrary,this._spanLimits=e.getSpanLimits(),this._spanProcessor=e.getActiveSpanProcessor(),this._spanProcessor.onStart(this,t),this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0}return n.prototype.spanContext=function(){return this._spanContext},n.prototype.setAttribute=function(e,t){return t==null||this._isSpanEnded()?this:e.length===0?(Pt.warn("Invalid attribute key: "+e),this):vj(t)?Object.keys(this.attributes).length>=this._spanLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,e)?(this._droppedAttributesCount++,this):(this.attributes[e]=this._truncateToSize(t),this):(Pt.warn("Invalid attribute value set for key: "+e),this)},n.prototype.setAttributes=function(e){var t,r;try{for(var o=j0t(Object.entries(e)),s=o.next();!s.done;s=o.next()){var a=H0t(s.value,2),c=a[0],l=a[1];this.setAttribute(c,l)}}catch(u){t={error:u}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return this},n.prototype.addEvent=function(e,t,r){if(this._isSpanEnded())return this;if(this._spanLimits.eventCountLimit===0)return Pt.warn("No events allowed."),this._droppedEventsCount++,this;this.events.length>=this._spanLimits.eventCountLimit&&(Pt.warn("Dropping extra events."),this.events.shift(),this._droppedEventsCount++),Tj(t)&&(Tj(r)||(r=t),t=void 0);var o=LS(t);return this.events.push({name:e,attributes:o,time:this._getTime(r),droppedAttributesCount:0}),this},n.prototype.setStatus=function(e){return this._isSpanEnded()?this:(this.status=e,this)},n.prototype.updateName=function(e){return this._isSpanEnded()?this:(this.name=e,this)},n.prototype.end=function(e){if(this._isSpanEnded()){Pt.error(this.name+" "+this._spanContext.traceId+"-"+this._spanContext.spanId+" - You can only call end() on a span once.");return}this._ended=!0,this.endTime=this._getTime(e),this._duration=Eoe(this.startTime,this.endTime),this._duration[0]<0&&(Pt.warn("Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.",this.startTime,this.endTime),this.endTime=this.startTime.slice(),this._duration=[0,0]),this._spanProcessor.onEnd(this)},n.prototype._getTime=function(e){if(typeof e=="number"&&e<ig.now())return Sj(e+this._performanceOffset);if(typeof e=="number")return Xf(e);if(e instanceof Date)return Xf(e.getTime());if(g4(e))return e;if(this._startTimeProvided)return Xf(Date.now());var t=ig.now()-this._performanceStartTime;return Cj(this.startTime,Xf(t))},n.prototype.isRecording=function(){return this._ended===!1},n.prototype.recordException=function(e,t){var r={};typeof e=="string"?r[og.EXCEPTION_MESSAGE]=e:e&&(e.code?r[og.EXCEPTION_TYPE]=e.code.toString():e.name&&(r[og.EXCEPTION_TYPE]=e.name),e.message&&(r[og.EXCEPTION_MESSAGE]=e.message),e.stack&&(r[og.EXCEPTION_STACKTRACE]=e.stack)),r[og.EXCEPTION_TYPE]||r[og.EXCEPTION_MESSAGE]?this.addEvent(oLe,r,t):Pt.warn("Failed to record an exception "+e)},Object.defineProperty(n.prototype,"duration",{get:function(){return this._duration},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ended",{get:function(){return this._ended},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"droppedAttributesCount",{get:function(){return this._droppedAttributesCount},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"droppedEventsCount",{get:function(){return this._droppedEventsCount},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"droppedLinksCount",{get:function(){return this._droppedLinksCount},enumerable:!1,configurable:!0}),n.prototype._isSpanEnded=function(){return this._ended&&Pt.warn("Can not execute the operation on ended Span {traceId: "+this._spanContext.traceId+", spanId: "+this._spanContext.spanId+"}"),this._ended},n.prototype._truncateToLimitUtil=function(e,t){return e.length<=t?e:e.substr(0,t)},n.prototype._truncateToSize=function(e){var t=this,r=this._attributeValueLengthLimit;return r<=0?(Pt.warn("Attribute value limit must be positive, got "+r),e):typeof e=="string"?this._truncateToLimitUtil(e,r):Array.isArray(e)?e.map(function(o){return typeof o=="string"?t._truncateToLimitUtil(o,r):o}):e},n}()});var Jf,_4=N(()=>{(function(n){n[n.NOT_RECORD=0]="NOT_RECORD",n[n.RECORD=1]="RECORD",n[n.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(Jf||(Jf={}))});var MS,Aj=N(()=>{_4();MS=function(){function n(){}return n.prototype.shouldSample=function(){return{decision:Jf.NOT_RECORD}},n.prototype.toString=function(){return"AlwaysOffSampler"},n}()});var sg,Dj=N(()=>{_4();sg=function(){function n(){}return n.prototype.shouldSample=function(){return{decision:Jf.RECORD_AND_SAMPLED}},n.prototype.toString=function(){return"AlwaysOnSampler"},n}()});var x4,Hoe=N(()=>{Hn();Za();Aj();Dj();x4=function(){function n(e){var t,r,o,s;this._root=e.root,this._root||(Hc(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new sg),this._remoteParentSampled=(t=e.remoteParentSampled)!==null&&t!==void 0?t:new sg,this._remoteParentNotSampled=(r=e.remoteParentNotSampled)!==null&&r!==void 0?r:new MS,this._localParentSampled=(o=e.localParentSampled)!==null&&o!==void 0?o:new sg,this._localParentNotSampled=(s=e.localParentNotSampled)!==null&&s!==void 0?s:new MS}return n.prototype.shouldSample=function(e,t,r,o,s,a){var c=ss.getSpanContext(e);return!c||!Bu(c)?this._root.shouldSample(e,t,r,o,s,a):c.isRemote?c.traceFlags&vo.SAMPLED?this._remoteParentSampled.shouldSample(e,t,r,o,s,a):this._remoteParentNotSampled.shouldSample(e,t,r,o,s,a):c.traceFlags&vo.SAMPLED?this._localParentSampled.shouldSample(e,t,r,o,s,a):this._localParentNotSampled.shouldSample(e,t,r,o,s,a)},n.prototype.toString=function(){return"ParentBased{root="+this._root.toString()+", remoteParentSampled="+this._remoteParentSampled.toString()+", remoteParentNotSampled="+this._remoteParentNotSampled.toString()+", localParentSampled="+this._localParentSampled.toString()+", localParentNotSampled="+this._localParentNotSampled.toString()+"}"},n}()});var Nj,Voe=N(()=>{Hn();_4();Nj=function(){function n(e){e===void 0&&(e=0),this._ratio=e,this._ratio=this._normalize(e),this._upperBound=Math.floor(this._ratio*4294967295)}return n.prototype.shouldSample=function(e,t){return{decision:DS(t)&&this._accumulate(t)<this._upperBound?Jf.RECORD_AND_SAMPLED:Jf.NOT_RECORD}},n.prototype.toString=function(){return"TraceIdRatioBased{"+this._ratio+"}"},n.prototype._normalize=function(e){return typeof e!="number"||isNaN(e)?0:e>=1?1:e<=0?0:e},n.prototype._accumulate=function(e){for(var t=0,r=0;r<e.length/8;r++){var o=r*8,s=parseInt(e.slice(o,o+8),16);t=(t^s)>>>0}return t},n}()});function Lj(){return{sampler:Goe(V0t),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:as().OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:as().OTEL_ATTRIBUTE_COUNT_LIMIT},spanLimits:{attributeValueLengthLimit:as().OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:as().OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT,linkCountLimit:as().OTEL_SPAN_LINK_COUNT_LIMIT,eventCountLimit:as().OTEL_SPAN_EVENT_COUNT_LIMIT,attributePerEventCountLimit:as().OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT,attributePerLinkCountLimit:as().OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT}}}function Goe(n){switch(n===void 0&&(n=as()),n.OTEL_TRACES_SAMPLER){case Nl.AlwaysOn:return new sg;case Nl.AlwaysOff:return new MS;case Nl.ParentBasedAlwaysOn:return new x4({root:new sg});case Nl.ParentBasedAlwaysOff:return new x4({root:new MS});case Nl.TraceIdRatio:return new Nj(aLe(n));case Nl.ParentBasedTraceIdRatio:return new x4({root:new Nj(aLe(n))});default:return Pt.error('OTEL_TRACES_SAMPLER value "'+n.OTEL_TRACES_SAMPLER+" invalid, defaulting to "+G0t+'".'),new sg}}function aLe(n){if(n.OTEL_TRACES_SAMPLER_ARG===void 0||n.OTEL_TRACES_SAMPLER_ARG==="")return Pt.error("OTEL_TRACES_SAMPLER_ARG is blank, defaulting to "+bR+"."),bR;var e=Number(n.OTEL_TRACES_SAMPLER_ARG);return isNaN(e)?(Pt.error("OTEL_TRACES_SAMPLER_ARG="+n.OTEL_TRACES_SAMPLER_ARG+" was given, but it is invalid, defaulting to "+bR+"."),bR):e<0||e>1?(Pt.error("OTEL_TRACES_SAMPLER_ARG="+n.OTEL_TRACES_SAMPLER_ARG+" was given, but it is out of range ([0..1]), defaulting to "+bR+"."),bR):e}var V0t,G0t,bR,zoe=N(()=>{Hn();Za();Aj();Dj();Hoe();Voe();V0t=as(),G0t=Nl.AlwaysOn,bR=1});function cLe(n){var e={sampler:Goe()},t=Lj(),r=Object.assign({},t,e,n);return r.generalLimits=Object.assign({},t.generalLimits,n.generalLimits||{}),r.spanLimits=Object.assign({},t.spanLimits,n.spanLimits||{}),r}function lLe(n){var e,t,r,o,s,a,c,l,u,d,p,f,m=Object.assign({},n.spanLimits),h=boe();return m.attributeCountLimit=(a=(s=(o=(t=(e=n.spanLimits)===null||e===void 0?void 0:e.attributeCountLimit)!==null&&t!==void 0?t:(r=n.generalLimits)===null||r===void 0?void 0:r.attributeCountLimit)!==null&&o!==void 0?o:h.OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT)!==null&&s!==void 0?s:h.OTEL_ATTRIBUTE_COUNT_LIMIT)!==null&&a!==void 0?a:vR,m.attributeValueLengthLimit=(f=(p=(d=(l=(c=n.spanLimits)===null||c===void 0?void 0:c.attributeValueLengthLimit)!==null&&l!==void 0?l:(u=n.generalLimits)===null||u===void 0?void 0:u.attributeValueLengthLimit)!==null&&d!==void 0?d:h.OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT)!==null&&p!==void 0?p:h.OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT)!==null&&f!==void 0?f:gR,Object.assign({},n,{spanLimits:m})}var $oe=N(()=>{zoe();Za()});var uLe,dLe=N(()=>{Hn();Za();uLe=function(){function n(e,t){this._exporter=e,this._finishedSpans=[],this._droppedSpansCount=0;var r=as();this._maxExportBatchSize=typeof t?.maxExportBatchSize=="number"?t.maxExportBatchSize:r.OTEL_BSP_MAX_EXPORT_BATCH_SIZE,this._maxQueueSize=typeof t?.maxQueueSize=="number"?t.maxQueueSize:r.OTEL_BSP_MAX_QUEUE_SIZE,this._scheduledDelayMillis=typeof t?.scheduledDelayMillis=="number"?t.scheduledDelayMillis:r.OTEL_BSP_SCHEDULE_DELAY,this._exportTimeoutMillis=typeof t?.exportTimeoutMillis=="number"?t.exportTimeoutMillis:r.OTEL_BSP_EXPORT_TIMEOUT,this._shutdownOnce=new b4(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(Pt.warn("BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}return n.prototype.forceFlush=function(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()},n.prototype.onStart=function(e,t){},n.prototype.onEnd=function(e){this._shutdownOnce.isCalled||e.spanContext().traceFlags&vo.SAMPLED&&this._addToBuffer(e)},n.prototype.shutdown=function(){return this._shutdownOnce.call()},n.prototype._shutdown=function(){var e=this;return Promise.resolve().then(function(){return e.onShutdown()}).then(function(){return e._flushAll()}).then(function(){return e._exporter.shutdown()})},n.prototype._addToBuffer=function(e){if(this._finishedSpans.length>=this._maxQueueSize){this._droppedSpansCount===0&&Pt.debug("maxQueueSize reached, dropping spans"),this._droppedSpansCount++;return}this._droppedSpansCount>0&&(Pt.warn("Dropped "+this._droppedSpansCount+" spans because maxQueueSize reached"),this._droppedSpansCount=0),this._finishedSpans.push(e),this._maybeStartTimer()},n.prototype._flushAll=function(){var e=this;return new Promise(function(t,r){for(var o=[],s=Math.ceil(e._finishedSpans.length/e._maxExportBatchSize),a=0,c=s;a<c;a++)o.push(e._flushOneBatch());Promise.all(o).then(function(){t()}).catch(r)})},n.prototype._flushOneBatch=function(){var e=this;return this._clearTimer(),this._finishedSpans.length===0?Promise.resolve():new Promise(function(t,r){var o=setTimeout(function(){r(new Error("Timeout"))},e._exportTimeoutMillis);Ja.with(d4(Ja.active()),function(){var s=e._finishedSpans.splice(0,e._maxExportBatchSize),a=function(){return e._exporter.export(s,function(l){var u;clearTimeout(o),l.code===qu.SUCCESS?t():r((u=l.error)!==null&&u!==void 0?u:new Error("BatchSpanProcessor: span export failed"))})},c=s.map(function(l){return l.resource}).filter(function(l){return l.asyncAttributesPending});c.length===0?a():Promise.all(c.map(function(l){var u;return(u=l.waitForAsyncAttributes)===null||u===void 0?void 0:u.call(l)})).then(a,function(l){Hc(l),r(l)})})})},n.prototype._maybeStartTimer=function(){var e=this;this._timer===void 0&&(this._timer=setTimeout(function(){e._flushOneBatch().then(function(){e._finishedSpans.length>0&&(e._clearTimer(),e._maybeStartTimer())}).catch(function(t){Hc(t)})},this._scheduledDelayMillis),Toe(this._timer))},n.prototype._clearTimer=function(){this._timer!==void 0&&(clearTimeout(this._timer),this._timer=void 0)},n}()});var z0t,Woe,pLe=N(()=>{dLe();z0t=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Woe=function(n){z0t(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.onShutdown=function(){},e}(uLe)});function fLe(n){return function(){for(var t=0;t<n/4;t++)Oj.writeUInt32BE(Math.random()*Math.pow(2,32)>>>0,t*4);for(var t=0;t<n&&!(Oj[t]>0);t++)t===n-1&&(Oj[n-1]=1);return Oj.toString("hex",0,n)}}var $0t,mLe,Koe,Oj,hLe=N(()=>{$0t=8,mLe=16,Koe=function(){function n(){this.generateTraceId=fLe(mLe),this.generateSpanId=fLe($0t)}return n}(),Oj=Buffer.allocUnsafe(mLe)});var gLe=N(()=>{pLe();hLe()});var Mj=N(()=>{gLe()});var Yoe,vLe=N(()=>{Hn();Za();joe();$oe();Mj();Yoe=function(){function n(e,t,r){this._tracerProvider=r;var o=cLe(t);this._sampler=o.sampler,this._generalLimits=o.generalLimits,this._spanLimits=o.spanLimits,this._idGenerator=t.idGenerator||new Koe,this.resource=r.resource,this.instrumentationLibrary=e}return n.prototype.startSpan=function(e,t,r){var o,s,a;t===void 0&&(t={}),r===void 0&&(r=Ja.active()),t.root&&(r=ss.deleteSpan(r));var c=ss.getSpan(r);if(NS(r)){Pt.debug("Instrumentation suppressed, returning Noop Span");var l=ss.wrapSpanContext(dR);return l}var u=c?.spanContext(),d=this._idGenerator.generateSpanId(),p,f,m;!u||!ss.isSpanContextValid(u)?p=this._idGenerator.generateTraceId():(p=u.traceId,f=u.traceState,m=u.spanId);var h=(o=t.kind)!==null&&o!==void 0?o:pR.INTERNAL,g=((s=t.links)!==null&&s!==void 0?s:[]).map(function(w){return{context:w.context,attributes:LS(w.attributes)}}),y=LS(t.attributes),b=this._sampler.shouldSample(r,p,e,h,y,g);f=(a=b.traceState)!==null&&a!==void 0?a:f;var _=b.decision===jc.RECORD_AND_SAMPLED?vo.SAMPLED:vo.NONE,x={traceId:p,spanId:d,traceFlags:_,traceState:f};if(b.decision===jc.NOT_RECORD){Pt.debug("Recording is off, propagating context in a non-recording span");var l=ss.wrapSpanContext(x);return l}var I=new qoe(this,r,e,x,h,m,g,t.startTime),S=LS(Object.assign(y,b.attributes));return I.setAttributes(S),I},n.prototype.startActiveSpan=function(e,t,r,o){var s,a,c;if(!(arguments.length<2)){arguments.length===2?c=t:arguments.length===3?(s=t,c=r):(s=t,a=r,c=o);var l=a??Ja.active(),u=this.startSpan(e,s,l),d=ss.setSpan(l,u);return Ja.with(d,c,void 0,u)}},n.prototype.getGeneralLimits=function(){return this._generalLimits},n.prototype.getSpanLimits=function(){return this._spanLimits},n.prototype.getActiveSpanProcessor=function(){return this._tracerProvider.getActiveSpanProcessor()},n}()});function yLe(){return"unknown_service:"+process.argv0}var bLe=N(()=>{});var _Le,xLe,Qoe=N(()=>{_Le=function(n){switch(n){case"arm":return"arm32";case"ppc":return"ppc32";case"x64":return"amd64";default:return n}},xLe=function(n){switch(n){case"sunos":return"solaris";case"win32":return"windows";default:return n}}});var SLe,ILe,_R,Fj=N(()=>{SLe=q(require("child_process")),ILe=q(require("util")),_R=ILe.promisify(SLe.exec)});var TLe={};Dr(TLe,{getMachineId:()=>Y0t});function Y0t(){return W0t(this,void 0,void 0,function(){var n,e,t,r;return K0t(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,_R('ioreg -rd1 -c "IOPlatformExpertDevice"')];case 1:return n=o.sent(),e=n.stdout.split(`
`).find(function(s){return s.includes("IOPlatformUUID")}),e?(t=e.split('" = "'),t.length===2?[2,t[1].slice(0,-1)]:[3,3]):[2,""];case 2:return r=o.sent(),Pt.debug("error reading machine id: "+r),[3,3];case 3:return[2,""]}})})}var W0t,K0t,CLe=N(()=>{Fj();Hn();W0t=function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function c(d){try{u(r.next(d))}catch(p){a(p)}}function l(d){try{u(r.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((r=r.apply(n,e||[])).next())})},K0t=function(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,o=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(d){u=[6,d],o=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}});var wLe={};Dr(wLe,{getMachineId:()=>Z0t});function Z0t(){return Q0t(this,void 0,void 0,function(){var n,e,t,r,o,s,a,c,l;return X0t(this,function(u){switch(u.label){case 0:n=["/etc/machine-id","/var/lib/dbus/machine-id"],u.label=1;case 1:u.trys.push([1,8,9,10]),e=J0t(n),t=e.next(),u.label=2;case 2:if(t.done)return[3,7];r=t.value,u.label=3;case 3:return u.trys.push([3,5,,6]),[4,ELe.promises.readFile(r,{encoding:"utf8"})];case 4:return o=u.sent(),[2,o.trim()];case 5:return s=u.sent(),Pt.debug("error reading machine id: "+s),[3,6];case 6:return t=e.next(),[3,2];case 7:return[3,10];case 8:return a=u.sent(),c={error:a},[3,10];case 9:try{t&&!t.done&&(l=e.return)&&l.call(e)}finally{if(c)throw c.error}return[7];case 10:return[2,""]}})})}var ELe,Q0t,X0t,J0t,kLe=N(()=>{ELe=require("fs");Hn();Q0t=function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function c(d){try{u(r.next(d))}catch(p){a(p)}}function l(d){try{u(r.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((r=r.apply(n,e||[])).next())})},X0t=function(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,o=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(d){u=[6,d],o=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},J0t=function(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}});var PLe={};Dr(PLe,{getMachineId:()=>nyt});function nyt(){return eyt(this,void 0,void 0,function(){var e,n,e,t;return tyt(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,RLe.promises.readFile("/etc/hostid",{encoding:"utf8"})];case 1:return e=r.sent(),[2,e.trim()];case 2:return n=r.sent(),Pt.debug("error reading machine id: "+n),[3,3];case 3:return r.trys.push([3,5,,6]),[4,_R("kenv -q smbios.system.uuid")];case 4:return e=r.sent(),[2,e.stdout.trim()];case 5:return t=r.sent(),Pt.debug("error reading machine id: "+t),[3,6];case 6:return[2,""]}})})}var RLe,eyt,tyt,ALe=N(()=>{RLe=require("fs");Fj();Hn();eyt=function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function c(d){try{u(r.next(d))}catch(p){a(p)}}function l(d){try{u(r.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((r=r.apply(n,e||[])).next())})},tyt=function(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,o=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(d){u=[6,d],o=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}});var DLe={};Dr(DLe,{getMachineId:()=>oyt});function oyt(){return ryt(this,void 0,void 0,function(){var n,e,t,r,o;return iyt(this,function(s){switch(s.label){case 0:n="QUERY HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography /v MachineGuid",e="%windir%\\System32\\REG.exe",Uj.arch==="ia32"&&"PROCESSOR_ARCHITEW6432"in Uj.env&&(e="%windir%\\sysnative\\cmd.exe /c "+e),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,_R(e+" "+n)];case 2:return t=s.sent(),r=t.stdout.split("REG_SZ"),r.length===2?[2,r[1].trim()]:[3,4];case 3:return o=s.sent(),Pt.debug("error reading machine id: "+o),[3,4];case 4:return[2,""]}})})}var Uj,ryt,iyt,NLe=N(()=>{Uj=q(require("process"));Fj();Hn();ryt=function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function c(d){try{u(r.next(d))}catch(p){a(p)}}function l(d){try{u(r.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((r=r.apply(n,e||[])).next())})},iyt=function(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,o=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(d){u=[6,d],o=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}});var LLe={};Dr(LLe,{getMachineId:()=>cyt});function cyt(){return syt(this,void 0,void 0,function(){return ayt(this,function(n){return Pt.debug("could not read machine-id: unsupported platform"),[2,""]})})}var syt,ayt,OLe=N(()=>{Hn();syt=function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function c(d){try{u(r.next(d))}catch(p){a(p)}}function l(d){try{u(r.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((r=r.apply(n,e||[])).next())})},ayt=function(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,o=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(d){u=[6,d],o=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}});var MLe,FS,FLe=N(()=>{MLe=q(require("process"));switch(MLe.platform){case"darwin":FS=(CLe(),Eo(TLe)).getMachineId;break;case"linux":FS=(kLe(),Eo(wLe)).getMachineId;break;case"freebsd":FS=(ALe(),Eo(PLe)).getMachineId;break;case"win32":FS=(NLe(),Eo(DLe)).getMachineId;break;default:FS=(OLe(),Eo(LLe)).getMachineId}});var Bj,lyt,ULe,Xoe=N(()=>{tp();xR();Bj=require("os");Qoe();FLe();lyt=function(){function n(){}return n.prototype.detect=function(e){var t,r=(t={},t[An.HOST_NAME]=(0,Bj.hostname)(),t[An.HOST_ARCH]=_Le((0,Bj.arch)()),t);return new ec(r,this._getAsyncAttributes())},n.prototype._getAsyncAttributes=function(){return FS().then(function(e){var t={};return e&&(t[An.HOST_ID]=e),t})},n}(),ULe=new lyt});var uyt,ytr,BLe=N(()=>{Xoe();uyt=function(){function n(){}return n.prototype.detect=function(e){return Promise.resolve(ULe.detect(e))},n}(),ytr=new uyt});var qj,dyt,qLe,Joe=N(()=>{tp();xR();qj=require("os");Qoe();dyt=function(){function n(){}return n.prototype.detect=function(e){var t,r=(t={},t[An.OS_TYPE]=xLe((0,qj.platform)()),t[An.OS_VERSION]=(0,qj.release)(),t);return new ec(r)},n}(),qLe=new dyt});var pyt,Ctr,jLe=N(()=>{Joe();pyt=function(){function n(){}return n.prototype.detect=function(e){return Promise.resolve(qLe.detect(e))},n}(),Ctr=new pyt});var GLe,HLe,VLe,fyt,zLe,Zoe=N(()=>{Hn();tp();xR();GLe=q(require("os")),HLe=function(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return s},VLe=function(n,e,t){if(t||arguments.length===2)for(var r=0,o=e.length,s;r<o;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))},fyt=function(){function n(){}return n.prototype.detect=function(e){var t,r=(t={},t[An.PROCESS_PID]=process.pid,t[An.PROCESS_EXECUTABLE_NAME]=process.title,t[An.PROCESS_EXECUTABLE_PATH]=process.execPath,t[An.PROCESS_COMMAND_ARGS]=VLe(VLe([process.argv[0]],HLe(process.execArgv),!1),HLe(process.argv.slice(1)),!1),t[An.PROCESS_RUNTIME_VERSION]=process.versions.node,t[An.PROCESS_RUNTIME_NAME]="nodejs",t[An.PROCESS_RUNTIME_DESCRIPTION]="Node.js",t);process.argv.length>1&&(r[An.PROCESS_COMMAND]=process.argv[1]);try{var o=GLe.userInfo();r[An.PROCESS_OWNER]=o.username}catch(s){Pt.debug("error obtaining process owner: "+s)}return new ec(r)},n}(),zLe=new fyt});var myt,Dtr,$Le=N(()=>{Zoe();myt=function(){function n(){}return n.prototype.detect=function(e){return Promise.resolve(zLe.detect(e))},n}(),Dtr=new myt});var WLe=N(()=>{bLe();BLe();jLe();Xoe();Joe();$Le();Zoe()});var ese=N(()=>{WLe()});var Yy,hyt,gyt,vyt,ec,xR=N(()=>{Hn();tp();Za();ese();Yy=function(){return Yy=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o])}return n},Yy.apply(this,arguments)},hyt=function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function c(d){try{u(r.next(d))}catch(p){a(p)}}function l(d){try{u(r.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((r=r.apply(n,e||[])).next())})},gyt=function(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,o=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(d){u=[6,d],o=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},vyt=function(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return s},ec=function(){function n(e,t){var r=this,o;this._attributes=e,this.asyncAttributesPending=t!=null,this._syncAttributes=(o=this._attributes)!==null&&o!==void 0?o:{},this._asyncAttributesPromise=t?.then(function(s){return r._attributes=Object.assign({},r._attributes,s),r.asyncAttributesPending=!1,s},function(s){return Pt.debug("a resource's async attributes promise rejected: %s",s),r.asyncAttributesPending=!1,{}})}return n.empty=function(){return n.EMPTY},n.default=function(){var e;return new n((e={},e[An.SERVICE_NAME]=yLe(),e[An.TELEMETRY_SDK_LANGUAGE]=m4[An.TELEMETRY_SDK_LANGUAGE],e[An.TELEMETRY_SDK_NAME]=m4[An.TELEMETRY_SDK_NAME],e[An.TELEMETRY_SDK_VERSION]=m4[An.TELEMETRY_SDK_VERSION],e))},Object.defineProperty(n.prototype,"attributes",{get:function(){var e;return this.asyncAttributesPending&&Pt.error("Accessing resource attributes before async attributes settled"),(e=this._attributes)!==null&&e!==void 0?e:{}},enumerable:!1,configurable:!0}),n.prototype.waitForAsyncAttributes=function(){return hyt(this,void 0,void 0,function(){return gyt(this,function(e){switch(e.label){case 0:return this.asyncAttributesPending?[4,this._asyncAttributesPromise]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},n.prototype.merge=function(e){var t=this,r;if(!e)return this;var o=Yy(Yy({},this._syncAttributes),(r=e._syncAttributes)!==null&&r!==void 0?r:e.attributes);if(!this._asyncAttributesPromise&&!e._asyncAttributesPromise)return new n(o);var s=Promise.all([this._asyncAttributesPromise,e._asyncAttributesPromise]).then(function(a){var c,l=vyt(a,2),u=l[0],d=l[1];return Yy(Yy(Yy(Yy({},t._syncAttributes),u),(c=e._syncAttributes)!==null&&c!==void 0?c:e.attributes),d)});return new n(o,s)},n.EMPTY=new n({}),n}()});var KLe=N(()=>{});var YLe=N(()=>{});var QLe=N(()=>{});var yyt,Qtr,XLe=N(()=>{jj();yyt=function(){function n(){}return n.prototype.detect=function(e){return Promise.resolve(JLe.detect(e))},n}(),Qtr=new yyt});var byt,_yt,xyt,ZLe,tse=N(()=>{Hn();Za();tp();xR();byt=function(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},_yt=function(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return s},xyt=function(){function n(){this._MAX_LENGTH=255,this._COMMA_SEPARATOR=",",this._LABEL_KEY_VALUE_SPLITTER="=",this._ERROR_MESSAGE_INVALID_CHARS="should be a ASCII string with a length greater than 0 and not exceed "+this._MAX_LENGTH+" characters.",this._ERROR_MESSAGE_INVALID_VALUE="should be a ASCII string with a length not exceed "+this._MAX_LENGTH+" characters."}return n.prototype.detect=function(e){var t={},r=as(),o=r.OTEL_RESOURCE_ATTRIBUTES,s=r.OTEL_SERVICE_NAME;if(o)try{var a=this._parseResourceAttributes(o);Object.assign(t,a)}catch(c){Pt.debug("EnvDetector failed: "+c.message)}return s&&(t[An.SERVICE_NAME]=s),new ec(t)},n.prototype._parseResourceAttributes=function(e){var t,r;if(!e)return{};var o={},s=e.split(this._COMMA_SEPARATOR,-1);try{for(var a=byt(s),c=a.next();!c.done;c=a.next()){var l=c.value,u=l.split(this._LABEL_KEY_VALUE_SPLITTER,-1);if(u.length===2){var d=_yt(u,2),p=d[0],f=d[1];if(p=p.trim(),f=f.trim().split(/^"|"$/).join(""),!this._isValidAndNotEmpty(p))throw new Error("Attribute key "+this._ERROR_MESSAGE_INVALID_CHARS);if(!this._isValid(f))throw new Error("Attribute value "+this._ERROR_MESSAGE_INVALID_VALUE);o[p]=decodeURIComponent(f)}}}catch(m){t={error:m}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return o},n.prototype._isValid=function(e){return e.length<=this._MAX_LENGTH&&this._isBaggageOctetString(e)},n.prototype._isBaggageOctetString=function(e){for(var t=0;t<e.length;t++){var r=e.charCodeAt(t);if(r<33||r===44||r===59||r===92||r>126)return!1}return!0},n.prototype._isValidAndNotEmpty=function(e){return e.length>0&&this._isValid(e)},n}(),ZLe=new xyt});var Syt,inr,eOe=N(()=>{tse();Syt=function(){function n(){}return n.prototype.detect=function(e){return Promise.resolve(ZLe.detect(e))},n}(),inr=new Syt});var nse,Iyt,JLe,tOe=N(()=>{tp();jj();Hn();nse=function(){return nse=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o])}return n},nse.apply(this,arguments)},Iyt=function(){function n(){}return n.prototype.detect=function(e){var t,r=typeof navigator<"u";if(!r)return ec.empty();var o=(t={},t[An.PROCESS_RUNTIME_NAME]="browser",t[An.PROCESS_RUNTIME_DESCRIPTION]="Web Browser",t[An.PROCESS_RUNTIME_VERSION]=navigator.userAgent,t);return this._getResourceAttributes(o,e)},n.prototype._getResourceAttributes=function(e,t){return e[An.PROCESS_RUNTIME_VERSION]===""?(Pt.debug("BrowserDetector failed: Unable to find required browser resources. "),ec.empty()):new ec(nse({},e))},n}(),JLe=new Iyt});var nOe=N(()=>{XLe();eOe();tOe();tse()});var rOe=N(()=>{});var jj=N(()=>{xR();KLe();ese();YLe();QLe();nOe();rOe()});var Hj,iOe,oOe=N(()=>{Za();Hj=function(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},iOe=function(){function n(e){this._spanProcessors=e}return n.prototype.forceFlush=function(){var e,t,r=[];try{for(var o=Hj(this._spanProcessors),s=o.next();!s.done;s=o.next()){var a=s.value;r.push(a.forceFlush())}}catch(c){e={error:c}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return new Promise(function(c){Promise.all(r).then(function(){c()}).catch(function(l){Hc(l||new Error("MultiSpanProcessor: forceFlush failed")),c()})})},n.prototype.onStart=function(e,t){var r,o;try{for(var s=Hj(this._spanProcessors),a=s.next();!a.done;a=s.next()){var c=a.value;c.onStart(e,t)}}catch(l){r={error:l}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}},n.prototype.onEnd=function(e){var t,r;try{for(var o=Hj(this._spanProcessors),s=o.next();!s.done;s=o.next()){var a=s.value;a.onEnd(e)}}catch(c){t={error:c}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}},n.prototype.shutdown=function(){var e,t,r=[];try{for(var o=Hj(this._spanProcessors),s=o.next();!s.done;s=o.next()){var a=s.value;r.push(a.shutdown())}}catch(c){e={error:c}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return new Promise(function(c,l){Promise.all(r).then(function(){c()},l)})},n}()});var rse,ise=N(()=>{rse=function(){function n(){}return n.prototype.onStart=function(e,t){},n.prototype.onEnd=function(e){},n.prototype.shutdown=function(){return Promise.resolve()},n.prototype.forceFlush=function(){return Promise.resolve()},n}()});var Qy,Tyt,sOe=N(()=>{Hn();Za();jj();ose();zoe();oOe();ise();Mj();$oe();(function(n){n[n.resolved=0]="resolved",n[n.timeout=1]="timeout",n[n.error=2]="error",n[n.unresolved=3]="unresolved"})(Qy||(Qy={}));Tyt=function(){function n(e){e===void 0&&(e={});var t;this._registeredSpanProcessors=[],this._tracers=new Map;var r=Uoe({},Lj(),lLe(e));this.resource=(t=r.resource)!==null&&t!==void 0?t:ec.empty(),this.resource=ec.default().merge(this.resource),this._config=Object.assign({},r,{resource:this.resource});var o=this._buildExporterFromEnv();if(o!==void 0){var s=new Woe(o);this.activeSpanProcessor=s}else this.activeSpanProcessor=new rse}return n.prototype.getTracer=function(e,t,r){var o=e+"@"+(t||"")+":"+(r?.schemaUrl||"");return this._tracers.has(o)||this._tracers.set(o,new Yoe({name:e,version:t,schemaUrl:r?.schemaUrl},this._config,this)),this._tracers.get(o)},n.prototype.addSpanProcessor=function(e){this._registeredSpanProcessors.length===0&&this.activeSpanProcessor.shutdown().catch(function(t){return Pt.error("Error while trying to shutdown current span processor",t)}),this._registeredSpanProcessors.push(e),this.activeSpanProcessor=new iOe(this._registeredSpanProcessors)},n.prototype.getActiveSpanProcessor=function(){return this.activeSpanProcessor},n.prototype.register=function(e){e===void 0&&(e={}),ss.setGlobalTracerProvider(this),e.propagator===void 0&&(e.propagator=this._buildPropagatorFromEnv()),e.contextManager&&Ja.setGlobalContextManager(e.contextManager),e.propagator&&rg.setGlobalPropagator(e.propagator)},n.prototype.forceFlush=function(){var e=this._config.forceFlushTimeoutMillis,t=this._registeredSpanProcessors.map(function(r){return new Promise(function(o){var s,a=setTimeout(function(){o(new Error("Span processor did not completed within timeout period of "+e+" ms")),s=Qy.timeout},e);r.forceFlush().then(function(){clearTimeout(a),s!==Qy.timeout&&(s=Qy.resolved,o(s))}).catch(function(c){clearTimeout(a),s=Qy.error,o(c)})})});return new Promise(function(r,o){Promise.all(t).then(function(s){var a=s.filter(function(c){return c!==Qy.resolved});a.length>0?o(a):r()}).catch(function(s){return o([s])})})},n.prototype.shutdown=function(){return this.activeSpanProcessor.shutdown()},n.prototype._getPropagator=function(e){var t;return(t=this.constructor._registeredPropagators.get(e))===null||t===void 0?void 0:t()},n.prototype._getSpanExporter=function(e){var t;return(t=this.constructor._registeredExporters.get(e))===null||t===void 0?void 0:t()},n.prototype._buildPropagatorFromEnv=function(){var e=this,t=Array.from(new Set(as().OTEL_PROPAGATORS)),r=t.map(function(s){var a=e._getPropagator(s);return a||Pt.warn('Propagator "'+s+'" requested through environment variable is unavailable.'),a}),o=r.reduce(function(s,a){return a&&s.push(a),s},[]);if(o.length!==0)return t.length===1?o[0]:new woe({propagators:o})},n.prototype._buildExporterFromEnv=function(){var e=as().OTEL_TRACES_EXPORTER;if(!(e==="none"||e==="")){var t=this._getSpanExporter(e);return t||Pt.error('Exporter "'+e+'" requested through environment variable is unavailable.'),t}},n._registeredPropagators=new Map([["tracecontext",function(){return new Aoe}],["baggage",function(){return new moe}]]),n._registeredExporters=new Map,n}()});var Cyt,Eyt,aOe=N(()=>{Za();Cyt=function(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Eyt=function(){function n(){}return n.prototype.export=function(e,t){return this._sendSpans(e,t)},n.prototype.shutdown=function(){return this._sendSpans([]),this.forceFlush()},n.prototype.forceFlush=function(){return Promise.resolve()},n.prototype._exportInfo=function(e){var t;return{traceId:e.spanContext().traceId,parentId:e.parentSpanId,traceState:(t=e.spanContext().traceState)===null||t===void 0?void 0:t.serialize(),name:e.name,id:e.spanContext().spanId,kind:e.kind,timestamp:Ij(e.startTime),duration:Ij(e.duration),attributes:e.attributes,status:e.status,events:e.events,links:e.links}},n.prototype._sendSpans=function(e,t){var r,o;try{for(var s=Cyt(e),a=s.next();!a.done;a=s.next()){var c=a.value;console.dir(this._exportInfo(c),{depth:3})}}catch(l){r={error:l}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}if(t)return t({code:qu.SUCCESS})},n}()});var wyt,kyt,Ryt,cOe=N(()=>{Za();wyt=function(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return s},kyt=function(n,e,t){if(t||arguments.length===2)for(var r=0,o=e.length,s;r<o;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))},Ryt=function(){function n(){this._finishedSpans=[],this._stopped=!1}return n.prototype.export=function(e,t){var r;if(this._stopped)return t({code:qu.FAILED,error:new Error("Exporter has been stopped")});(r=this._finishedSpans).push.apply(r,kyt([],wyt(e),!1)),setTimeout(function(){return t({code:qu.SUCCESS})},0)},n.prototype.shutdown=function(){return this._stopped=!0,this._finishedSpans=[],this.forceFlush()},n.prototype.forceFlush=function(){return Promise.resolve()},n.prototype.reset=function(){this._finishedSpans=[]},n.prototype.getFinishedSpans=function(){return this._finishedSpans},n}()});var lOe=N(()=>{});var Pyt,Ayt,Dyt,uOe=N(()=>{Hn();Za();Pyt=function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function c(d){try{u(r.next(d))}catch(p){a(p)}}function l(d){try{u(r.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((r=r.apply(n,e||[])).next())})},Ayt=function(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,o=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(d){u=[6,d],o=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},Dyt=function(){function n(e){this._exporter=e,this._shutdownOnce=new b4(this._shutdown,this),this._unresolvedExports=new Set}return n.prototype.forceFlush=function(){return Pyt(this,void 0,void 0,function(){return Ayt(this,function(e){switch(e.label){case 0:return[4,Promise.all(Array.from(this._unresolvedExports))];case 1:return e.sent(),this._exporter.forceFlush?[4,this._exporter.forceFlush()]:[3,3];case 2:e.sent(),e.label=3;case 3:return[2]}})})},n.prototype.onStart=function(e,t){},n.prototype.onEnd=function(e){var t=this,r,o;if(!this._shutdownOnce.isCalled&&e.spanContext().traceFlags&vo.SAMPLED){var s=function(){return Boe._export(t._exporter,[e]).then(function(c){var l;c.code!==qu.SUCCESS&&Hc((l=c.error)!==null&&l!==void 0?l:new Error("SimpleSpanProcessor: span export failed (status "+c+")"))}).catch(function(c){Hc(c)})};if(e.resource.asyncAttributesPending){var a=(o=(r=e.resource).waitForAsyncAttributes)===null||o===void 0?void 0:o.call(r).then(function(){return a!=null&&t._unresolvedExports.delete(a),s()},function(c){return Hc(c)});a!=null&&this._unresolvedExports.add(a)}else s()}},n.prototype.shutdown=function(){return this._shutdownOnce.call()},n.prototype._shutdown=function(){return this._exporter.shutdown()},n}()});var dOe=N(()=>{});var pOe=N(()=>{});var fOe=N(()=>{});var mOe=N(()=>{});var hOe=N(()=>{});var gOe={};Dr(gOe,{AlwaysOffSampler:()=>MS,AlwaysOnSampler:()=>sg,BasicTracerProvider:()=>Tyt,BatchSpanProcessor:()=>Woe,ConsoleSpanExporter:()=>Eyt,ForceFlushState:()=>Qy,InMemorySpanExporter:()=>Ryt,NoopSpanProcessor:()=>rse,ParentBasedSampler:()=>x4,RandomIdGenerator:()=>Koe,SamplingDecision:()=>Jf,SimpleSpanProcessor:()=>Dyt,Span:()=>qoe,TraceIdRatioBasedSampler:()=>Nj,Tracer:()=>Yoe});var ose=N(()=>{vLe();sOe();Mj();aOe();cOe();lOe();uOe();dOe();ise();Aj();Dj();Hoe();Voe();_4();joe();pOe();fOe();mOe();hOe()});var yOe=P(ju=>{"use strict";Object.defineProperty(ju,"__esModule",{value:!0});ju.enable=ju.azureCoreTracing=ju.AzureMonitorSymbol=void 0;var sse=no();ju.AzureMonitorSymbol="Azure_Monitor_Tracer";var ase="azure-coretracing",vOe=!1,Nyt=function(n){if(vOe)return n;try{var e=(ose(),Eo(gOe)),t=(Hn(),Eo(mR)),r=new e.BasicTracerProvider,o=r.getTracer("applicationinsights tracer");if(n.setTracer){var s=n.setTracer;n.setTracer=function(u){var d=u.startSpan;u.startSpan=function(p,f,m){var h=d.call(this,p,f,m),g=h.end;return h.end=function(){var y=g.apply(this,arguments);return sse.channel.publish(ase,h),y},h},u[ju.AzureMonitorSymbol]=!0,s.call(this,u)},t.trace.getSpan(t.context.active()),n.setTracer(o)}else{var a=t.trace.setGlobalTracerProvider;t.trace.setGlobalTracerProvider=function(u){var d=u.getTracer;return u.getTracer=function(p,f){var m=d.call(this,p,f);if(!m[ju.AzureMonitorSymbol]){var h=m.startSpan;m.startSpan=function(g,y,b){var _=h.call(this,g,y,b),x=_.end;return _.end=function(){var I=x.apply(this,arguments);return sse.channel.publish(ase,_),I},_},m[ju.AzureMonitorSymbol]=!0}return m},a.call(this,u)},r.register(),t.trace.getSpan(t.context.active());var c=require("@opentelemetry/instrumentation"),l=require("@azure/opentelemetry-instrumentation-azure-sdk");c.registerInstrumentations({instrumentations:[l.createAzureSdkInstrumentation()]})}vOe=!0}catch{}return n};ju.azureCoreTracing={versionSpecifier:">= 1.0.0 < 2.0.0",patch:Nyt,publisherName:ase};function Lyt(){sse.channel.registerMonkeyPatch("@azure/core-tracing",ju.azureCoreTracing)}ju.enable=Lyt});var _Oe=P(US=>{"use strict";Object.defineProperty(US,"__esModule",{value:!0});US.enable=US.bunyan=void 0;var bOe=no(),Oyt=function(n){var e=n.prototype._emit;return n.prototype._emit=function(t,r){var o=e.apply(this,arguments);if(!r){var s=o;s||(s=e.call(this,t,!0)),bOe.channel.publish("bunyan",{level:t.level,result:s})}return o},n};US.bunyan={versionSpecifier:">= 1.0.0 < 2.0.0",patch:Oyt};function Myt(){bOe.channel.registerMonkeyPatch("bunyan",US.bunyan)}US.enable=Myt});var SOe=P(BS=>{"use strict";Object.defineProperty(BS,"__esModule",{value:!0});BS.enable=BS.console=void 0;var cse=no(),xOe=require("stream"),Fyt=function(n){var e=new xOe.Writable,t=new xOe.Writable;e.write=function(u){if(!u)return!0;var d=u.toString();return cse.channel.publish("console",{message:d}),!0},t.write=function(u){if(!u)return!0;var d=u.toString();return cse.channel.publish("console",{message:d,stderr:!0}),!0};for(var r=new n.Console(e,t),o=["log","info","warn","error","dir","time","timeEnd","trace","assert"],s=function(u){var d=n[u];d&&(n[u]=function(){if(r[u])try{r[u].apply(r,arguments)}catch{}return d.apply(n,arguments)})},a=0,c=o;a<c.length;a++){var l=c[a];s(l)}return n};BS.console={versionSpecifier:">= 4.0.0",patch:Fyt};function Uyt(){cse.channel.registerMonkeyPatch("console",BS.console),require("console")}BS.enable=Uyt});var IOe=P(qS=>{"use strict";Object.defineProperty(qS,"__esModule",{value:!0});qS.enable=qS.mongoCore=void 0;var lse=no(),Byt=function(n){var e=n.Server.prototype.connect;return n.Server.prototype.connect=function(){var r=e.apply(this,arguments),o=this.s.pool.write;this.s.pool.write=function(){var c=typeof arguments[1]=="function"?1:2;return typeof arguments[c]=="function"&&(arguments[c]=lse.channel.bindToContext(arguments[c])),o.apply(this,arguments)};var s=this.s.pool.logout;return this.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=lse.channel.bindToContext(arguments[1])),s.apply(this,arguments)},r},n};qS.mongoCore={versionSpecifier:">= 2.0.0 < 4.0.0",patch:Byt};function qyt(){lse.channel.registerMonkeyPatch("mongodb-core",qS.mongoCore)}qS.enable=qyt});var TOe=P(tc=>{"use strict";var SR=tc&&tc.__assign||function(){return SR=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o])}return n},SR.apply(this,arguments)};Object.defineProperty(tc,"__esModule",{value:!0});tc.enable=tc.mongo330=tc.mongo3=tc.mongo2=void 0;var Ca=no(),jyt=function(n){var e=n.instrument({operationIdGenerator:{next:function(){return Ca.channel.bindToContext(function(r){return r()})}}}),t={};return e.on("started",function(r){t[r.requestId]||(t[r.requestId]=SR(SR({},r),{time:new Date}))}),e.on("succeeded",function(r){var o=t[r.requestId];o&&delete t[r.requestId],typeof r.operationId=="function"?r.operationId(function(){return Ca.channel.publish("mongodb",{startedData:o,event:r,succeeded:!0})}):Ca.channel.publish("mongodb",{startedData:o,event:r,succeeded:!0})}),e.on("failed",function(r){var o=t[r.requestId];o&&delete t[r.requestId],typeof r.operationId=="function"?r.operationId(function(){return Ca.channel.publish("mongodb",{startedData:o,event:r,succeeded:!1})}):Ca.channel.publish("mongodb",{startedData:o,event:r,succeeded:!1})}),n},Hyt=function(n){var e=n.instrument(),t={},r={};return e.on("started",function(o){t[o.requestId]||(r[o.requestId]=Ca.channel.bindToContext(function(s){return s()}),t[o.requestId]=SR(SR({},o),{time:new Date}))}),e.on("succeeded",function(o){var s=t[o.requestId];s&&delete t[o.requestId],typeof o=="object"&&typeof r[o.requestId]=="function"&&(r[o.requestId](function(){return Ca.channel.publish("mongodb",{startedData:s,event:o,succeeded:!0})}),delete r[o.requestId])}),e.on("failed",function(o){var s=t[o.requestId];s&&delete t[o.requestId],typeof o=="object"&&typeof r[o.requestId]=="function"&&(r[o.requestId](function(){return Ca.channel.publish("mongodb",{startedData:s,event:o,succeeded:!1})}),delete r[o.requestId])}),n},Vyt=function(n){var e=n.Server.prototype.connect;return n.Server.prototype.connect=function(){var r=e.apply(this,arguments),o=this.s.coreTopology.s.pool.write;this.s.coreTopology.s.pool.write=function(){var c=typeof arguments[1]=="function"?1:2;return typeof arguments[c]=="function"&&(arguments[c]=Ca.channel.bindToContext(arguments[c])),o.apply(this,arguments)};var s=this.s.coreTopology.s.pool.logout;return this.s.coreTopology.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=Ca.channel.bindToContext(arguments[1])),s.apply(this,arguments)},r},n},Gyt=function(n){Vyt(n);var e=n.instrument(),t={},r={};return e.on("started",function(o){t[o.requestId]||(r[o.requestId]=Ca.channel.bindToContext(function(s){return s()}),t[o.requestId]=o)}),e.on("succeeded",function(o){var s=t[o.requestId];s&&delete t[o.requestId],typeof o=="object"&&typeof r[o.requestId]=="function"&&(r[o.requestId](function(){return Ca.channel.publish("mongodb",{startedData:s,event:o,succeeded:!0})}),delete r[o.requestId])}),e.on("failed",function(o){var s=t[o.requestId];s&&delete t[o.requestId],typeof o=="object"&&typeof r[o.requestId]=="function"&&(r[o.requestId](function(){return Ca.channel.publish("mongodb",{startedData:s,event:o,succeeded:!1})}),delete r[o.requestId])}),n};tc.mongo2={versionSpecifier:">= 2.0.0 <= 3.0.5",patch:jyt};tc.mongo3={versionSpecifier:"> 3.0.5 < 3.3.0",patch:Hyt};tc.mongo330={versionSpecifier:">= 3.3.0 < 4.0.0",patch:Gyt};function zyt(){Ca.channel.registerMonkeyPatch("mongodb",tc.mongo2),Ca.channel.registerMonkeyPatch("mongodb",tc.mongo3),Ca.channel.registerMonkeyPatch("mongodb",tc.mongo330)}tc.enable=zyt});var EOe=P(jS=>{"use strict";Object.defineProperty(jS,"__esModule",{value:!0});jS.enable=jS.mysql=void 0;var Vj=no(),COe=require("path"),$yt=function(n,e){var t=function(l,u){return function(d,p){var f=l[d];f&&(l[d]=function(){for(var h=arguments.length-1,g=arguments.length-1;g>=0;--g)if(typeof arguments[g]=="function"){h=g;break}else if(typeof arguments[g]<"u")break;var y=arguments[h],b={result:null,startTime:null,startDate:null};typeof y=="function"&&(p?(b.startTime=process.hrtime(),b.startDate=new Date,arguments[h]=Vj.channel.bindToContext(p(b,y))):arguments[h]=Vj.channel.bindToContext(y));var _=f.apply(this,arguments);return b.result=_,_})}},r=function(l,u){return t(l.prototype,u+".prototype")},o=["connect","changeUser","ping","statistics","end"],s=require(COe.dirname(e)+"/lib/Connection");o.forEach(function(l){return r(s,"Connection")(l)}),t(s,"Connection")("createQuery",function(l,u){return function(d){var p=process.hrtime(l.startTime),f=p[0]*1e3+p[1]/1e6|0;Vj.channel.publish("mysql",{query:l.result,callbackArgs:arguments,err:d,duration:f,time:l.startDate}),u.apply(this,arguments)}});var a=["_enqueueCallback"],c=require(COe.dirname(e)+"/lib/Pool");return a.forEach(function(l){return r(c,"Pool")(l)}),n};jS.mysql={versionSpecifier:">= 2.0.0 < 3.0.0",patch:$yt};function Wyt(){Vj.channel.registerMonkeyPatch("mysql",jS.mysql)}jS.enable=Wyt});var kOe=P(HS=>{"use strict";Object.defineProperty(HS,"__esModule",{value:!0});HS.enable=HS.postgresPool1=void 0;var wOe=no();function Kyt(n){var e=n.prototype.connect;return n.prototype.connect=function(r){return r&&(arguments[0]=wOe.channel.bindToContext(r)),e.apply(this,arguments)},n}HS.postgresPool1={versionSpecifier:">= 1.0.0 < 3.0.0",patch:Kyt};function Yyt(){wOe.channel.registerMonkeyPatch("pg-pool",HS.postgresPool1)}HS.enable=Yyt});var POe=P(Zf=>{"use strict";Object.defineProperty(Zf,"__esModule",{value:!0});Zf.enable=Zf.postgres=Zf.postgres6=void 0;var IR=no(),ROe=require("events"),use="postgres";function Qyt(n,e){var t=n.Client.prototype.query,r="__diagnosticOriginalFunc";return n.Client.prototype.query=function(s,a,c){var l={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},u=process.hrtime(),d;function p(f){f&&f[r]&&(f=f[r]);var m=IR.channel.bindToContext(function(h,g){var y=process.hrtime(u);if(l.result=g&&{rowCount:g.rowCount,command:g.command},l.error=h,l.duration=Math.ceil(y[0]*1e3+y[1]/1e6),IR.channel.publish(use,l),h){if(f)return f.apply(this,arguments);d&&d instanceof ROe.EventEmitter&&d.emit("error",h)}else f&&f.apply(this,arguments)});try{return Object.defineProperty(m,r,{value:f}),m}catch{return f}}try{typeof s=="string"?a instanceof Array?(l.query.preparable={text:s,args:a},c=p(c)):(l.query.text=s,c?c=p(c):a=p(a)):(typeof s.name=="string"?l.query.plan=s.name:s.values instanceof Array?l.query.preparable={text:s.text,args:s.values}:l.query.text=s.text,c?c=p(c):a?a=p(a):s.callback=p(s.callback))}catch{return t.apply(this,arguments)}return arguments[0]=s,arguments[1]=a,arguments[2]=c,arguments.length=arguments.length>3?arguments.length:3,d=t.apply(this,arguments),d},n}function Xyt(n,e){var t=n.Client.prototype.query,r="__diagnosticOriginalFunc";return n.Client.prototype.query=function(s,a,c){var l=this,u,d,p=!!c,f={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},m,h=process.hrtime();function g(_){_&&_[r]&&(_=_[r]);var x=IR.channel.bindToContext(function(I,S){var w=process.hrtime(h);if(f.result=S&&{rowCount:S.rowCount,command:S.command},f.error=I,f.duration=Math.ceil(w[0]*1e3+w[1]/1e6),IR.channel.publish(use,f),I){if(_)return _.apply(this,arguments);m&&m instanceof ROe.EventEmitter&&m.emit("error",I)}else _&&_.apply(this,arguments)});try{return Object.defineProperty(x,r,{value:_}),x}catch{return _}}try{typeof s=="string"?a instanceof Array?(f.query.preparable={text:s,args:a},p=typeof c=="function",c=p?g(c):c):(f.query.text=s,c?(p=typeof c=="function",c=p?g(c):c):(p=typeof a=="function",a=p?g(a):a)):(typeof s.name=="string"?f.query.plan=s.name:s.values instanceof Array?f.query.preparable={text:s.text,args:s.values}:s.cursor?f.query.text=(u=s.cursor)===null||u===void 0?void 0:u.text:f.query.text=s.text,c?(p=typeof c=="function",c=g(c)):a?(p=typeof a=="function",a=p?g(a):a):(p=typeof s.callback=="function",s.callback=p?g(s.callback):s.callback))}catch{return t.apply(this,arguments)}arguments[0]=s,arguments[1]=a,arguments[2]=c,arguments.length=arguments.length>3?arguments.length:3;try{m=t.apply(this,arguments)}catch(_){throw g()(_,void 0),_}if(!p){if(m instanceof Promise)return m.then(function(_){return g()(void 0,_),new l._Promise(function(x,I){x(_)})}).catch(function(_){return g()(_,void 0),new l._Promise(function(x,I){I(_)})});var y=m.text?m.text:"";if(m.cursor&&(y=(d=m.cursor)===null||d===void 0?void 0:d.text),y){var b={command:y,rowCount:0};g()(void 0,b)}}return m},n}Zf.postgres6={versionSpecifier:"6.*",patch:Qyt};Zf.postgres={versionSpecifier:">=7.* <=8.*",patch:Xyt,publisherName:use};function Jyt(){IR.channel.registerMonkeyPatch("pg",Zf.postgres6),IR.channel.registerMonkeyPatch("pg",Zf.postgres)}Zf.enable=Jyt});var AOe=P(VS=>{"use strict";Object.defineProperty(VS,"__esModule",{value:!0});VS.enable=VS.redis=void 0;var dse=no(),Zyt=function(n){var e=n.RedisClient.prototype.internal_send_command;return n.RedisClient.prototype.internal_send_command=function(t){if(t){var r=t.callback;if(!r||!r.pubsubBound){var o=this.address,s=process.hrtime(),a=new Date;t.callback=dse.channel.bindToContext(function(c,l){var u=process.hrtime(s),d=u[0]*1e3+u[1]/1e6|0;dse.channel.publish("redis",{duration:d,address:o,commandObj:t,err:c,result:l,time:a}),typeof r=="function"&&r.apply(this,arguments)}),t.callback.pubsubBound=!0}}return e.call(this,t)},n};VS.redis={versionSpecifier:">= 2.0.0 < 4.0.0",patch:Zyt};function ebt(){dse.channel.registerMonkeyPatch("redis",VS.redis)}VS.enable=ebt});var DOe=P(ag=>{"use strict";var Gj=ag&&ag.__assign||function(){return Gj=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o])}return n},Gj.apply(this,arguments)};Object.defineProperty(ag,"__esModule",{value:!0});ag.enable=ag.tedious=void 0;var pse=no(),tbt=function(n){var e=n.Connection.prototype.makeRequest;return n.Connection.prototype.makeRequest=function(){function r(s){var a=process.hrtime(),c={query:{},database:{host:null,port:null},result:null,error:null,duration:0};return pse.channel.bindToContext(function(l,u,d){var p=process.hrtime(a);c=Gj(Gj({},c),{database:{host:this.connection.config.server,port:this.connection.config.options.port},result:!l&&{rowCount:u,rows:d},query:{text:this.parametersByName.statement.value},error:l,duration:Math.ceil(p[0]*1e3+p[1]/1e6)}),pse.channel.publish("tedious",c),s.call(this,l,u,d)})}var o=arguments[0];arguments[0].callback=r(o.callback),e.apply(this,arguments)},n};ag.tedious={versionSpecifier:">= 6.0.0 < 9.0.0",patch:tbt};function nbt(){pse.channel.registerMonkeyPatch("tedious",ag.tedious)}ag.enable=nbt});var NOe=P(Vc=>{"use strict";var rbt=Vc&&Vc.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),ibt=Vc&&Vc.__rest||function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]]);return t};Object.defineProperty(Vc,"__esModule",{value:!0});Vc.enable=Vc.winston2=Vc.winston3=void 0;var zj=no(),obt=function(n){var e=n.Logger.prototype.log,t,r=function(o,s,a){var c;return t===n.config.npm.levels?c="npm":t===n.config.syslog.levels?c="syslog":c="unknown",zj.channel.publish("winston",{level:o,message:s,meta:a,levelKind:c}),s};return n.Logger.prototype.log=function(){return t=this.levels,!this.filters||this.filters.length===0?this.filters=[r]:this.filters[this.filters.length-1]!==r&&(this.filters=this.filters.filter(function(s){return s!==r}),this.filters.push(r)),e.apply(this,arguments)},n},sbt=function(n){var e=function(a,c){var l;return a.config.npm.levels[c]!=null?l="npm":a.config.syslog.levels[c]!=null?l="syslog":l="unknown",l},t=function(a){rbt(c,a);function c(l,u){var d=a.call(this,u)||this;return d.winston=l,d}return c.prototype.log=function(l,u){var d=l.message,p=l.level,f=l.meta,m=ibt(l,["message","level","meta"]);p=typeof Symbol.for=="function"?l[Symbol.for("level")]:p,d=l instanceof Error?l:d;var h=e(this.winston,p);f=f||{};for(var g in m)m.hasOwnProperty(g)&&(f[g]=m[g]);zj.channel.publish("winston",{message:d,level:p,levelKind:h,meta:f}),u()},c}(n.Transport);function r(){var a=n.config.npm.levels;arguments&&arguments[0]&&arguments[0].levels&&(a=arguments[0].levels);var c;for(var l in a)a.hasOwnProperty(l)&&(c=c===void 0||a[l]>a[c]?l:c);this.add(new t(n,{level:c}))}var o=n.createLogger;n.createLogger=function(){var c=n.config.npm.levels;arguments&&arguments[0]&&arguments[0].levels&&(c=arguments[0].levels);var l;for(var u in c)c.hasOwnProperty(u)&&(l=l===void 0||c[u]>c[l]?u:l);var d=o.apply(this,arguments);d.add(new t(n,{level:l}));var p=d.configure;return d.configure=function(){p.apply(this,arguments),r.apply(this,arguments)},d};var s=n.configure;return n.configure=function(){s.apply(this,arguments),r.apply(this,arguments)},n.add(new t(n)),n};Vc.winston3={versionSpecifier:"3.x",patch:sbt};Vc.winston2={versionSpecifier:"2.x",patch:obt};function abt(){zj.channel.registerMonkeyPatch("winston",Vc.winston2),zj.channel.registerMonkeyPatch("winston",Vc.winston3)}Vc.enable=abt});var zOe=P(Qr=>{"use strict";Object.defineProperty(Qr,"__esModule",{value:!0});Qr.enable=Qr.tedious=Qr.pgPool=Qr.pg=Qr.winston=Qr.redis=Qr.mysql=Qr.mongodb=Qr.mongodbCore=Qr.console=Qr.bunyan=Qr.azuresdk=void 0;var LOe=yOe();Qr.azuresdk=LOe;var OOe=_Oe();Qr.bunyan=OOe;var MOe=SOe();Qr.console=MOe;var FOe=IOe();Qr.mongodbCore=FOe;var UOe=TOe();Qr.mongodb=UOe;var BOe=EOe();Qr.mysql=BOe;var qOe=kOe();Qr.pgPool=qOe;var jOe=POe();Qr.pg=jOe;var HOe=AOe();Qr.redis=HOe;var VOe=DOe();Qr.tedious=VOe;var GOe=NOe();Qr.winston=GOe;function cbt(){OOe.enable(),MOe.enable(),FOe.enable(),UOe.enable(),BOe.enable(),jOe.enable(),qOe.enable(),HOe.enable(),GOe.enable(),LOe.enable(),VOe.enable()}Qr.enable=cbt});var Kj=P(Xy=>{"use strict";Object.defineProperty(Xy,"__esModule",{value:!0});Xy.registerContextPreservation=Xy.IsInitialized=void 0;var fse=li(),WOe=Vq();Xy.IsInitialized=!WOe.JsonConfig.getInstance().noDiagnosticChannel;var mse="DiagnosticChannel";if(Xy.IsInitialized){np=zOe(),$Oe=WOe.JsonConfig.getInstance().noPatchModules,$j=$Oe.split(","),hse={bunyan:np.bunyan,console:np.console,mongodb:np.mongodb,mongodbCore:np.mongodbCore,mysql:np.mysql,redis:np.redis,pg:np.pg,pgPool:np.pgPool,winston:np.winston,azuresdk:np.azuresdk};for(Wj in hse)$j.indexOf(Wj)===-1&&(hse[Wj].enable(),fse.info(mse,"Subscribed to "+Wj+" events"));$j.length>0&&fse.info(mse,"Some modules will not be patched",$j)}else fse.info(mse,"Not subscribing to dependency autocollection because APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL was set");var np,$Oe,$j,hse,Wj;function lbt(n){if(Xy.IsInitialized){var e=no();e.channel.addContextPreservation(n)}}Xy.registerContextPreservation=lbt});var TR=P((Irr,KOe)=>{"use strict";KOe.exports={requestContextHeader:"request-context",requestContextSourceKey:"appId",requestContextTargetKey:"appId",requestIdHeader:"request-id",parentIdHeader:"x-ms-request-id",rootIdHeader:"x-ms-request-root-id",correlationContextHeader:"correlation-context",traceparentHeader:"traceparent",traceStateHeader:"tracestate"}});var ra=P((yse,YOe)=>{"use strict";var Zy=yse&&yse.__assign||function(){return Zy=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o])}return n},Zy.apply(this,arguments)},ubt=require("http"),gse=require("https"),vse=require("url"),Jy=require("constants"),GS=li(),CR=TR(),dbt=Vq(),pbt=function(){function n(){n._addCloseHandler()}return n.getCookie=function(e,t){var r="";if(e&&e.length&&typeof t=="string")for(var o=e+"=",s=t.split(";"),a=0;a<s.length;a++){var t=s[a];if(t=n.trim(t),t&&t.indexOf(o)===0){r=t.substring(o.length,s[a].length);break}}return r},n.trim=function(e){return typeof e=="string"?e.replace(/^\s+|\s+$/g,""):""},n.int32ArrayToBase64=function(e){var t=function(c,l){return String.fromCharCode(c>>l&255)},r=function(c){return t(c,24)+t(c,16)+t(c,8)+t(c,0)},o=e.map(r).join(""),s=Buffer.from?Buffer.from(o,"binary"):new Buffer(o,"binary"),a=s.toString("base64");return a.substr(0,a.indexOf("="))},n.random32=function(){return 4294967296*Math.random()|0},n.randomu32=function(){return n.random32()+2147483648},n.w3cTraceId=function(){for(var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],t="",r,o=0;o<4;o++)r=n.random32(),t+=e[r&15]+e[r>>4&15]+e[r>>8&15]+e[r>>12&15]+e[r>>16&15]+e[r>>20&15]+e[r>>24&15]+e[r>>28&15];var s=e[8+Math.random()*4|0];return t.substr(0,8)+t.substr(9,4)+"4"+t.substr(13,3)+s+t.substr(16,3)+t.substr(19,12)},n.w3cSpanId=function(){return n.w3cTraceId().substring(16)},n.isValidW3CId=function(e){return e.length===32&&e!=="00000000000000000000000000000000"},n.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"},n.isError=function(e){return Object.prototype.toString.call(e)==="[object Error]"},n.isPrimitive=function(e){var t=typeof e;return t==="string"||t==="number"||t==="boolean"},n.isDate=function(e){return Object.prototype.toString.call(e)==="[object Date]"},n.msToTimeSpan=function(e){(isNaN(e)||e<0)&&(e=0);var t=(e/1e3%60).toFixed(7).replace(/0{0,4}$/,""),r=""+Math.floor(e/(1e3*60))%60,o=""+Math.floor(e/(1e3*60*60))%24,s=Math.floor(e/(1e3*60*60*24));t=t.indexOf(".")<2?"0"+t:t,r=r.length<2?"0"+r:r,o=o.length<2?"0"+o:o;var a=s>0?s+".":"";return a+o+":"+r+":"+t},n.extractError=function(e){var t=e;return{message:e.message,code:t.code||t.id||""}},n.extractObject=function(e){return e instanceof Error?n.extractError(e):typeof e.toJSON=="function"?e.toJSON():e},n.validateStringMap=function(e){if(typeof e!="object"){GS.info("Invalid properties dropped from payload");return}var t={};for(var r in e){var o="",s=e[r],a=typeof s;if(n.isPrimitive(s))o=s.toString();else if(s===null||a==="undefined")o="";else if(a==="function"){GS.info("key: "+r+" was function; will not serialize");continue}else{var c=n.isArray(s)?s:n.extractObject(s);try{n.isPrimitive(c)?o=c:o=JSON.stringify(c)}catch(l){o=s.constructor.name.toString()+" (Error: "+l.message+")",GS.info("key: "+r+", could not be serialized")}}t[r]=o.substring(0,n.MAX_PROPERTY_LENGTH)}return t},n.canIncludeCorrelationHeader=function(e,t){var r=e&&e.config&&e.config.correlationHeaderExcludedDomains;if(!r||r.length==0||!t)return!0;for(var o=0;o<r.length;o++){var s=new RegExp(r[o].replace(/\./g,".").replace(/\*/g,".*"));try{if(s.test(new vse.URL(t).hostname))return!1}catch{}}return!0},n.getCorrelationContextTarget=function(e,t){var r=e.headers&&e.headers[CR.requestContextHeader];if(r)for(var o=r.split(","),s=0;s<o.length;++s){var a=o[s].split("=");if(a.length==2&&a[0]==t)return a[1]}},n.makeRequest=function(e,t,r,o,s,a){s===void 0&&(s=!0),a===void 0&&(a=!0),t&&t.indexOf("//")===0&&(t="https:"+t);var c=new vse.URL(t),l=Zy(Zy({},r),{host:c.hostname,port:c.port,path:c.pathname}),u=void 0;if(s&&(c.protocol==="https:"&&(u=e.proxyHttpsUrl||void 0),c.protocol==="http:"&&(u=e.proxyHttpUrl||void 0),u)){u.indexOf("//")===0&&(u="http:"+u);try{var d=new vse.URL(u);d.protocol==="https:"?(GS.info("Proxies that use HTTPS are not supported"),u=void 0):l=Zy(Zy({},l),{host:d.hostname,port:d.port||"80",path:t,headers:Zy(Zy({},l.headers),{Host:c.hostname})})}catch{GS.warn("Wrong proxy URL provided")}}var p=c.protocol==="https:"&&!u;return a&&(p&&e.httpsAgent!==void 0?l.agent=e.httpsAgent:!p&&e.httpAgent!==void 0?l.agent=e.httpAgent:p&&(l.agent=n._useKeepAlive?n.keepAliveAgent:n.tlsRestrictedAgent)),p?gse.request(l,o):ubt.request(l,o)},n.safeIncludeCorrelationHeader=function(e,t,r){var o;if(typeof r=="string")o=r;else if(r instanceof Array)o=r.join(",");else if(r&&typeof r.toString=="function")try{o=r.toString()}catch(s){GS.warn("Outgoing request-context header could not be read. Correlation of requests may be lost.",s,r)}o?n.addCorrelationIdHeaderFromString(e,t,o):t.setHeader(CR.requestContextHeader,CR.requestContextSourceKey+"="+e.config.correlationId)},n.dumpObj=function(e){if(e)try{var t=Object.prototype.toString.call(e),r="";return t==="[object Error]"?r="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":r=this.stringify(e),t+r}catch{return e.toString()}},n.stringify=function(e){try{return JSON.stringify(e)}catch(t){GS.warn("Failed to serialize payload",t,e)}},n.addCorrelationIdHeaderFromString=function(e,t,r){var o=r.split(","),s=CR.requestContextSourceKey+"=",a=o.some(function(c){return c.substring(0,s.length)===s});a||t.setHeader(CR.requestContextHeader,r+","+CR.requestContextSourceKey+"="+e.config.correlationId)},n._addCloseHandler=function(){n._listenerAttached||(process.on("exit",function(){n.isNodeExit=!0,n._useKeepAlive=!1}),n._listenerAttached=!0)},n._useKeepAlive=!dbt.JsonConfig.getInstance().noHttpAgentKeepAlive,n._listenerAttached=!1,n.MAX_PROPERTY_LENGTH=8192,n.keepAliveAgent=new gse.Agent({keepAlive:!0,maxSockets:25,secureOptions:Jy.SSL_OP_NO_SSLv2|Jy.SSL_OP_NO_SSLv3|Jy.SSL_OP_NO_TLSv1|Jy.SSL_OP_NO_TLSv1_1}),n.tlsRestrictedAgent=new gse.Agent({secureOptions:Jy.SSL_OP_NO_SSLv2|Jy.SSL_OP_NO_SSLv3|Jy.SSL_OP_NO_TLSv1|Jy.SSL_OP_NO_TLSv1_1}),n.isNodeExit=!1,n}();YOe.exports=pbt});var zS=P((Trr,QOe)=>{"use strict";var bse=ra(),fbt=function(){function n(){}return n.queryCorrelationId=function(e,t){},n.cancelCorrelationIdQuery=function(e,t){},n.generateRequestId=function(e){if(e){e=e[0]=="|"?e:"|"+e,e[e.length-1]!=="."&&(e+=".");var t=(n.currentRootId++).toString(16);return n.appendSuffix(e,t,"_")}else return n.generateRootId()},n.getRootId=function(e){var t=e.indexOf(".");t<0&&(t=e.length);var r=e[0]==="|"?1:0;return e.substring(r,t)},n.generateRootId=function(){return"|"+bse.w3cTraceId()+"."},n.appendSuffix=function(e,t,r){if(e.length+t.length<n.requestIdMaxLength)return e+t+r;var o=n.requestIdMaxLength-9;if(e.length>o)for(;o>1;--o){var s=e[o-1];if(s==="."||s==="_")break}if(o<=1)return n.generateRootId();for(t=bse.randomu32().toString(16);t.length<8;)t="0"+t;return e.substring(0,o)+t+"#"},n.correlationIdPrefix="cid-v1:",n.w3cEnabled=!0,n.HTTP_TIMEOUT=2500,n.requestIdMaxLength=1024,n.currentRootId=bse.randomu32(),n}();QOe.exports=fbt});var Yj=P((Crr,XOe)=>{"use strict";var ia=ra(),mbt=zS(),hbt=function(){function n(e,t){if(this.traceFlag=n.DEFAULT_TRACE_FLAG,this.version=n.DEFAULT_VERSION,e&&typeof e=="string")if(e.split(",").length>1)this.traceId=ia.w3cTraceId(),this.spanId=ia.w3cTraceId().substr(0,16);else{var r=e.trim().split("-"),o=r.length;o>=4?(this.version=r[0],this.traceId=r[1],this.spanId=r[2],this.traceFlag=r[3]):(this.traceId=ia.w3cTraceId(),this.spanId=ia.w3cTraceId().substr(0,16)),this.version.match(/^[0-9a-f]{2}$/g)||(this.version=n.DEFAULT_VERSION,this.traceId=ia.w3cTraceId()),this.version==="00"&&o!==4&&(this.traceId=ia.w3cTraceId(),this.spanId=ia.w3cTraceId().substr(0,16)),this.version==="ff"&&(this.version=n.DEFAULT_VERSION,this.traceId=ia.w3cTraceId(),this.spanId=ia.w3cTraceId().substr(0,16)),this.version.match(/^0[0-9a-f]$/g)||(this.version=n.DEFAULT_VERSION),this.traceFlag.match(/^[0-9a-f]{2}$/g)||(this.traceFlag=n.DEFAULT_TRACE_FLAG,this.traceId=ia.w3cTraceId()),n.isValidTraceId(this.traceId)||(this.traceId=ia.w3cTraceId()),n.isValidSpanId(this.spanId)||(this.spanId=ia.w3cTraceId().substr(0,16),this.traceId=ia.w3cTraceId()),this.parentId=this.getBackCompatRequestId()}else if(t){this.parentId=t.slice();var s=mbt.getRootId(t);n.isValidTraceId(s)||(this.legacyRootId=s,s=ia.w3cTraceId()),t.indexOf("|")!==-1&&(t=t.substring(1+t.substring(0,t.length-1).lastIndexOf("."),t.length-1)),this.traceId=s,this.spanId=t}else this.traceId=ia.w3cTraceId(),this.spanId=ia.w3cTraceId().substr(0,16)}return n.isValidTraceId=function(e){return e.match(/^[0-9a-f]{32}$/)&&e!=="00000000000000000000000000000000"},n.isValidSpanId=function(e){return e.match(/^[0-9a-f]{16}$/)&&e!=="0000000000000000"},n.formatOpenTelemetryTraceFlags=function(e){var t="0"+e.toString(16);return t.substring(t.length-2)},n.prototype.getBackCompatRequestId=function(){return"|"+this.traceId+"."+this.spanId+"."},n.prototype.toString=function(){return this.version+"-"+this.traceId+"-"+this.spanId+"-"+this.traceFlag},n.prototype.updateSpanId=function(){this.spanId=ia.w3cTraceId().substr(0,16)},n.DEFAULT_TRACE_FLAG="01",n.DEFAULT_VERSION="00",n}();XOe.exports=hbt});var _se=P((Err,JOe)=>{"use strict";var gbt=function(){function n(e){this.fieldmap=[],e&&(this.fieldmap=this.parseHeader(e))}return n.prototype.toString=function(){var e=this.fieldmap;return!e||e.length==0?null:e.join(", ")},n.validateKeyChars=function(e){var t=e.split("@");if(t.length==2){var r=t[0].trim(),o=t[1].trim(),s=!!r.match(/^[\ ]?[a-z0-9\*\-\_/]{1,241}$/),a=!!o.match(/^[\ ]?[a-z0-9\*\-\_/]{1,14}$/);return s&&a}else if(t.length==1)return!!e.match(/^[\ ]?[a-z0-9\*\-\_/]{1,256}$/);return!1},n.prototype.parseHeader=function(e){var t=[],r={},o=e.split(",");if(o.length>32)return null;for(var s=0,a=o;s<a.length;s++){var c=a[s],l=c.trim();if(l.length!==0){var u=l.split("=");if(u.length!==2||!n.validateKeyChars(u[0])||r[u[0]])return null;r[u[0]]=!0,t.push(l)}}return t},n.strict=!0,n}();JOe.exports=gbt});var cg=P((wrr,ZOe)=>{"use strict";var vbt=function(){function n(){}return n}();ZOe.exports=vbt});var t4e=P((xse,e4e)=>{"use strict";var ybt=xse&&xse.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),bbt=cg(),_bt=function(n){ybt(e,n);function e(){var t=n.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return e}(bbt);e4e.exports=_bt});var Sse=P((krr,n4e)=>{"use strict";var xbt=function(){function n(){}return n}();n4e.exports=xbt});var i4e=P((Rrr,r4e)=>{"use strict";var Sbt=function(){function n(){this.applicationVersion="ai.application.ver",this.deviceId="ai.device.id",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceOEMName="ai.device.oemName",this.deviceOSVersion="ai.device.osVersion",this.deviceType="ai.device.type",this.locationIp="ai.location.ip",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.userAccountId="ai.user.accountId",this.userId="ai.user.id",this.userAuthUserId="ai.user.authUserId",this.cloudRole="ai.cloud.role",this.cloudRoleInstance="ai.cloud.roleInstance",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion",this.internalNodeName="ai.internal.nodeName"}return n}();r4e.exports=Sbt});var s4e=P((Ise,o4e)=>{"use strict";var Ibt=Ise&&Ise.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Tbt=Sse(),Cbt=function(n){Ibt(e,n);function e(){return n.call(this)||this}return e}(Tbt);o4e.exports=Cbt});var Cse=P((Prr,a4e)=>{"use strict";var Tse;(function(n){n[n.Measurement=0]="Measurement",n[n.Aggregation=1]="Aggregation"})(Tse||(Tse={}));a4e.exports=Tse});var l4e=P((Arr,c4e)=>{"use strict";var Ebt=Cse(),wbt=function(){function n(){this.kind=Ebt.Measurement}return n}();c4e.exports=wbt});var d4e=P((Drr,u4e)=>{"use strict";var kbt=function(){function n(){this.ver=1,this.sampleRate=100,this.tags={}}return n}();u4e.exports=kbt});var wse=P((Ese,p4e)=>{"use strict";var Rbt=Ese&&Ese.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Pbt=cg(),Abt=function(n){Rbt(e,n);function e(){var t=n.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return e}(Pbt);p4e.exports=Abt});var m4e=P((kse,f4e)=>{"use strict";var Dbt=kse&&kse.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Nbt=cg(),Lbt=function(n){Dbt(e,n);function e(){var t=n.call(this)||this;return t.ver=2,t.exceptions=[],t.properties={},t.measurements={},t}return e}(Nbt);f4e.exports=Lbt});var g4e=P((Nrr,h4e)=>{"use strict";var Obt=function(){function n(){this.hasFullStack=!0,this.parsedStack=[]}return n}();h4e.exports=Obt});var y4e=P((Rse,v4e)=>{"use strict";var Mbt=Rse&&Rse.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Fbt=cg(),Ubt=function(n){Mbt(e,n);function e(){var t=n.call(this)||this;return t.ver=2,t.properties={},t}return e}(Fbt);v4e.exports=Ubt});var _4e=P((Pse,b4e)=>{"use strict";var Bbt=Pse&&Pse.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),qbt=cg(),jbt=function(n){Bbt(e,n);function e(){var t=n.call(this)||this;return t.ver=2,t.metrics=[],t.properties={},t}return e}(qbt);b4e.exports=jbt});var S4e=P((Ase,x4e)=>{"use strict";var Hbt=Ase&&Ase.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Vbt=wse(),Gbt=function(n){Hbt(e,n);function e(){var t=n.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return e}(Vbt);x4e.exports=Gbt});var T4e=P((Dse,I4e)=>{"use strict";var zbt=Dse&&Dse.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),$bt=cg(),Wbt=function(n){zbt(e,n);function e(){var t=n.call(this)||this;return t.ver=2,t.success=!0,t.properties={},t.measurements={},t}return e}($bt);I4e.exports=Wbt});var E4e=P((Nse,C4e)=>{"use strict";var Kbt=Nse&&Nse.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Ybt=cg(),Qbt=function(n){Kbt(e,n);function e(){var t=n.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return e}(Ybt);C4e.exports=Qbt});var k4e=P((Lrr,w4e)=>{"use strict";var Lse;(function(n){n[n.Verbose=0]="Verbose",n[n.Information=1]="Information",n[n.Warning=2]="Warning",n[n.Error=3]="Error",n[n.Critical=4]="Critical"})(Lse||(Lse={}));w4e.exports=Lse});var P4e=P((Orr,R4e)=>{"use strict";var Xbt=function(){function n(){}return n}();R4e.exports=Xbt});var Ose=P(qo=>{"use strict";Object.defineProperty(qo,"__esModule",{value:!0});qo.AvailabilityData=t4e();qo.Base=Sse();qo.ContextTagKeys=i4e();qo.Data=s4e();qo.DataPoint=l4e();qo.DataPointType=Cse();qo.Domain=cg();qo.Envelope=d4e();qo.EventData=wse();qo.ExceptionData=m4e();qo.ExceptionDetails=g4e();qo.MessageData=y4e();qo.MetricData=_4e();qo.PageViewData=S4e();qo.RemoteDependencyData=T4e();qo.RequestData=E4e();qo.SeverityLevel=k4e();qo.StackFrame=P4e()});var A4e=P(ER=>{"use strict";Object.defineProperty(ER,"__esModule",{value:!0});ER.domainSupportsProperties=ER.RemoteDependencyDataConstants=void 0;var $S=Ose(),Jbt=function(){function n(){}return n.TYPE_HTTP="Http",n.TYPE_AI="Http (tracked component)",n}();ER.RemoteDependencyDataConstants=Jbt;function Zbt(n){return"properties"in n||n instanceof $S.EventData||n instanceof $S.ExceptionData||n instanceof $S.MessageData||n instanceof $S.MetricData||n instanceof $S.PageViewData||n instanceof $S.RemoteDependencyData||n instanceof $S.RequestData}ER.domainSupportsProperties=Zbt});var N4e=P(D4e=>{"use strict";Object.defineProperty(D4e,"__esModule",{value:!0})});var O4e=P(L4e=>{"use strict";Object.defineProperty(L4e,"__esModule",{value:!0})});var F4e=P(M4e=>{"use strict";Object.defineProperty(M4e,"__esModule",{value:!0})});var B4e=P(U4e=>{"use strict";Object.defineProperty(U4e,"__esModule",{value:!0})});var j4e=P(q4e=>{"use strict";Object.defineProperty(q4e,"__esModule",{value:!0})});var V4e=P(H4e=>{"use strict";Object.defineProperty(H4e,"__esModule",{value:!0})});var z4e=P(G4e=>{"use strict";Object.defineProperty(G4e,"__esModule",{value:!0})});var W4e=P($4e=>{"use strict";Object.defineProperty($4e,"__esModule",{value:!0})});var Y4e=P(K4e=>{"use strict";Object.defineProperty(K4e,"__esModule",{value:!0})});var X4e=P(Q4e=>{"use strict";Object.defineProperty(Q4e,"__esModule",{value:!0})});var Z4e=P(J4e=>{"use strict";Object.defineProperty(J4e,"__esModule",{value:!0})});var tMe=P(eMe=>{"use strict";Object.defineProperty(eMe,"__esModule",{value:!0})});var nMe=P(rp=>{"use strict";Object.defineProperty(rp,"__esModule",{value:!0});rp.TelemetryType=rp.TelemetryTypeString=rp.baseTypeToTelemetryType=rp.telemetryTypeToBaseType=void 0;function e_t(n){switch(n){case oa.Event:return"EventData";case oa.Exception:return"ExceptionData";case oa.Trace:return"MessageData";case oa.Metric:return"MetricData";case oa.Request:return"RequestData";case oa.Dependency:return"RemoteDependencyData";case oa.Availability:return"AvailabilityData";case oa.PageView:return"PageViewData"}}rp.telemetryTypeToBaseType=e_t;function t_t(n){switch(n){case"EventData":return oa.Event;case"ExceptionData":return oa.Exception;case"MessageData":return oa.Trace;case"MetricData":return oa.Metric;case"RequestData":return oa.Request;case"RemoteDependencyData":return oa.Dependency;case"AvailabilityData":return oa.Availability;case"PageViewData":return oa.PageView}}rp.baseTypeToTelemetryType=t_t;rp.TelemetryTypeString={Event:"EventData",Exception:"ExceptionData",Trace:"MessageData",Metric:"MetricData",Request:"RequestData",Dependency:"RemoteDependencyData",Availability:"AvailabilityData",PageView:"PageViewData"};var oa;(function(n){n[n.Event=0]="Event",n[n.Exception=1]="Exception",n[n.Trace=2]="Trace",n[n.Metric=3]="Metric",n[n.Request=4]="Request",n[n.Dependency=5]="Dependency",n[n.Availability=6]="Availability",n[n.PageView=7]="PageView"})(oa=rp.TelemetryType||(rp.TelemetryType={}))});var rMe=P(cs=>{"use strict";var n_t=cs&&cs.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Ll=cs&&cs.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&n_t(e,n,t)};Object.defineProperty(cs,"__esModule",{value:!0});Ll(N4e(),cs);Ll(O4e(),cs);Ll(F4e(),cs);Ll(B4e(),cs);Ll(j4e(),cs);Ll(V4e(),cs);Ll(z4e(),cs);Ll(W4e(),cs);Ll(Y4e(),cs);Ll(X4e(),cs);Ll(Z4e(),cs);Ll(tMe(),cs);Ll(nMe(),cs)});var oMe=P(iMe=>{"use strict";Object.defineProperty(iMe,"__esModule",{value:!0})});var aMe=P(sMe=>{"use strict";Object.defineProperty(sMe,"__esModule",{value:!0})});var lMe=P(cMe=>{"use strict";Object.defineProperty(cMe,"__esModule",{value:!0})});var dMe=P(uMe=>{"use strict";Object.defineProperty(uMe,"__esModule",{value:!0})});var fMe=P(pMe=>{"use strict";Object.defineProperty(pMe,"__esModule",{value:!0})});var hMe=P(mMe=>{"use strict";Object.defineProperty(mMe,"__esModule",{value:!0})});var vMe=P(gMe=>{"use strict";Object.defineProperty(gMe,"__esModule",{value:!0})});var bMe=P(yMe=>{"use strict";Object.defineProperty(yMe,"__esModule",{value:!0})});var _Me=P(Gc=>{"use strict";var r_t=Gc&&Gc.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),eb=Gc&&Gc.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&r_t(e,n,t)};Object.defineProperty(Gc,"__esModule",{value:!0});eb(oMe(),Gc);eb(aMe(),Gc);eb(lMe(),Gc);eb(dMe(),Gc);eb(fMe(),Gc);eb(hMe(),Gc);eb(vMe(),Gc);eb(bMe(),Gc)});var Ea=P(em=>{"use strict";var i_t=em&&em.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Qj=em&&em.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&i_t(e,n,t)};Object.defineProperty(em,"__esModule",{value:!0});Qj(A4e(),em);Qj(Ose(),em);Qj(rMe(),em);Qj(_Me(),em)});var Mse=P((cir,xMe)=>{"use strict";var o_t=function(){function n(){}return n.prototype.getUrl=function(){return this.url},n.prototype.RequestParser=function(){this.startTime=+new Date},n.prototype._setStatus=function(e,t){var r=+new Date;this.duration=r-this.startTime,this.statusCode=e;var o=this.properties||{};if(t){if(typeof t=="string")o.error=t;else if(t instanceof Error)o.error=t.message;else if(typeof t=="object")for(var s in t)o[s]=t[s]&&t[s].toString&&t[s].toString()}this.properties=o},n.prototype._isSuccess=function(){return 0<this.statusCode&&this.statusCode<400},n}();xMe.exports=o_t});var Oi=P(We=>{"use strict";var ip;Object.defineProperty(We,"__esModule",{value:!0});We.WEB_INSTRUMENTATION_DEPRECATED_SOURCE=We.WEB_INSTRUMENTATION_DEFAULT_SOURCE=We.TIME_SINCE_ENQUEUED=We.ENQUEUED_TIME=We.MessageBusDestination=We.MicrosoftEventHub=We.AzNamespace=We.HttpRequestCookieNames=We.StatsbeatNetworkCategory=We.StatsbeatFeatureType=We.StatsbeatInstrumentation=We.StatsbeatFeature=We.StatsbeatCounter=We.StatsbeatAttach=We.StatsbeatResourceProvider=We.StatsbeatTelemetryName=We.HeartBeatMetricName=We.DependencyTypeName=We.TelemetryTypeStringToQuickPulseDocumentType=We.TelemetryTypeStringToQuickPulseType=We.QuickPulseType=We.QuickPulseDocumentType=We.PerformanceToQuickPulseCounter=We.MetricId=We.PerformanceCounter=We.QuickPulseCounter=We.DEFAULT_LIVEMETRICS_HOST=We.DEFAULT_LIVEMETRICS_ENDPOINT=We.DEFAULT_BREEZE_ENDPOINT=We.APPLICATION_INSIGHTS_SDK_VERSION=void 0;We.APPLICATION_INSIGHTS_SDK_VERSION="2.9.1";We.DEFAULT_BREEZE_ENDPOINT="https://dc.services.visualstudio.com";We.DEFAULT_LIVEMETRICS_ENDPOINT="https://rt.services.visualstudio.com";We.DEFAULT_LIVEMETRICS_HOST="rt.services.visualstudio.com";var wa;(function(n){n.COMMITTED_BYTES="\\Memory\\Committed Bytes",n.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",n.REQUEST_RATE="\\ApplicationInsights\\Requests/Sec",n.REQUEST_FAILURE_RATE="\\ApplicationInsights\\Requests Failed/Sec",n.REQUEST_DURATION="\\ApplicationInsights\\Request Duration",n.DEPENDENCY_RATE="\\ApplicationInsights\\Dependency Calls/Sec",n.DEPENDENCY_FAILURE_RATE="\\ApplicationInsights\\Dependency Calls Failed/Sec",n.DEPENDENCY_DURATION="\\ApplicationInsights\\Dependency Call Duration",n.EXCEPTION_RATE="\\ApplicationInsights\\Exceptions/Sec"})(wa=We.QuickPulseCounter||(We.QuickPulseCounter={}));var Xj;(function(n){n.PRIVATE_BYTES="\\Process(??APP_WIN32_PROC??)\\Private Bytes",n.AVAILABLE_BYTES="\\Memory\\Available Bytes",n.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",n.PROCESS_TIME="\\Process(??APP_WIN32_PROC??)\\% Processor Time",n.REQUEST_RATE="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Requests/Sec",n.REQUEST_DURATION="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Request Execution Time"})(Xj=We.PerformanceCounter||(We.PerformanceCounter={}));var s_t;(function(n){n.REQUESTS_DURATION="requests/duration",n.DEPENDENCIES_DURATION="dependencies/duration",n.EXCEPTIONS_COUNT="exceptions/count",n.TRACES_COUNT="traces/count"})(s_t=We.MetricId||(We.MetricId={}));We.PerformanceToQuickPulseCounter=(ip={},ip[Xj.PROCESSOR_TIME]=wa.PROCESSOR_TIME,ip[Xj.REQUEST_RATE]=wa.REQUEST_RATE,ip[Xj.REQUEST_DURATION]=wa.REQUEST_DURATION,ip[wa.COMMITTED_BYTES]=wa.COMMITTED_BYTES,ip[wa.REQUEST_FAILURE_RATE]=wa.REQUEST_FAILURE_RATE,ip[wa.DEPENDENCY_RATE]=wa.DEPENDENCY_RATE,ip[wa.DEPENDENCY_FAILURE_RATE]=wa.DEPENDENCY_FAILURE_RATE,ip[wa.DEPENDENCY_DURATION]=wa.DEPENDENCY_DURATION,ip[wa.EXCEPTION_RATE]=wa.EXCEPTION_RATE,ip);We.QuickPulseDocumentType={Event:"Event",Exception:"Exception",Trace:"Trace",Metric:"Metric",Request:"Request",Dependency:"RemoteDependency",Availability:"Availability",PageView:"PageView"};We.QuickPulseType={Event:"EventTelemetryDocument",Exception:"ExceptionTelemetryDocument",Trace:"TraceTelemetryDocument",Metric:"MetricTelemetryDocument",Request:"RequestTelemetryDocument",Dependency:"DependencyTelemetryDocument",Availability:"AvailabilityTelemetryDocument",PageView:"PageViewTelemetryDocument"};We.TelemetryTypeStringToQuickPulseType={EventData:We.QuickPulseType.Event,ExceptionData:We.QuickPulseType.Exception,MessageData:We.QuickPulseType.Trace,MetricData:We.QuickPulseType.Metric,RequestData:We.QuickPulseType.Request,RemoteDependencyData:We.QuickPulseType.Dependency,AvailabilityData:We.QuickPulseType.Availability,PageViewData:We.QuickPulseType.PageView};We.TelemetryTypeStringToQuickPulseDocumentType={EventData:We.QuickPulseDocumentType.Event,ExceptionData:We.QuickPulseDocumentType.Exception,MessageData:We.QuickPulseDocumentType.Trace,MetricData:We.QuickPulseDocumentType.Metric,RequestData:We.QuickPulseDocumentType.Request,RemoteDependencyData:We.QuickPulseDocumentType.Dependency,AvailabilityData:We.QuickPulseDocumentType.Availability,PageViewData:We.QuickPulseDocumentType.PageView};We.DependencyTypeName={Grpc:"GRPC",Http:"HTTP",InProc:"InProc",Sql:"SQL",QueueMessage:"Queue Message"};We.HeartBeatMetricName="HeartbeatState";We.StatsbeatTelemetryName="Statsbeat";We.StatsbeatResourceProvider={appsvc:"appsvc",aks:"aks",functions:"functions",vm:"vm",unknown:"unknown"};We.StatsbeatAttach={codeless:"codeless",sdk:"sdk"};We.StatsbeatCounter={REQUEST_SUCCESS:"Request Success Count",REQUEST_FAILURE:"Request Failure Count",REQUEST_DURATION:"Request Duration",RETRY_COUNT:"Retry Count",THROTTLE_COUNT:"Throttle Count",EXCEPTION_COUNT:"Exception Count",ATTACH:"Attach",FEATURE:"Feature"};var a_t;(function(n){n[n.NONE=0]="NONE",n[n.DISK_RETRY=1]="DISK_RETRY",n[n.AAD_HANDLING=2]="AAD_HANDLING",n[n.WEB_SNIPPET=4]="WEB_SNIPPET"})(a_t=We.StatsbeatFeature||(We.StatsbeatFeature={}));var c_t;(function(n){n[n.NONE=0]="NONE",n[n.AZURE_CORE_TRACING=1]="AZURE_CORE_TRACING",n[n.MONGODB=2]="MONGODB",n[n.MYSQL=4]="MYSQL",n[n.REDIS=8]="REDIS",n[n.POSTGRES=16]="POSTGRES",n[n.BUNYAN=32]="BUNYAN",n[n.WINSTON=64]="WINSTON",n[n.CONSOLE=128]="CONSOLE"})(c_t=We.StatsbeatInstrumentation||(We.StatsbeatInstrumentation={}));var l_t;(function(n){n[n.Feature=0]="Feature",n[n.Instrumentation=1]="Instrumentation"})(l_t=We.StatsbeatFeatureType||(We.StatsbeatFeatureType={}));var u_t;(function(n){n[n.Breeze=0]="Breeze",n[n.Quickpulse=1]="Quickpulse"})(u_t=We.StatsbeatNetworkCategory||(We.StatsbeatNetworkCategory={}));var d_t;(function(n){n.SESSION="ai_session",n.USER="ai_user",n.AUTH_USER="ai_authUser"})(d_t=We.HttpRequestCookieNames||(We.HttpRequestCookieNames={}));We.AzNamespace="az.namespace";We.MicrosoftEventHub="Microsoft.EventHub";We.MessageBusDestination="message_bus.destination";We.ENQUEUED_TIME="enqueuedTime";We.TIME_SINCE_ENQUEUED="timeSinceEnqueued";We.WEB_INSTRUMENTATION_DEFAULT_SOURCE="https://js.monitor.azure.com/scripts/b/ai";We.WEB_INSTRUMENTATION_DEPRECATED_SOURCE="https://az416426.vo.msecnd.net/scripts/b/ai"});var qse=P((Bse,SMe)=>{"use strict";var p_t=Bse&&Bse.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Jj=require("url"),f_t=Ea(),Fse=ra(),Ol=TR(),m_t=Mse(),tb=zS(),h_t=_se(),Use=Yj(),g_t=li(),Zj=Oi(),v_t=function(n){p_t(e,n);function e(t,r){var o=n.call(this)||this;return t&&(o.method=t.method,o.url=o._getAbsoluteUrl(t),o.startTime=+new Date,o.socketRemoteAddress=t.socket&&t.socket.remoteAddress,o.parseHeaders(t,r),t.connection&&(o.connectionRemoteAddress=t.connection.remoteAddress,o.legacySocketRemoteAddress=t.connection.socket&&t.connection.socket.remoteAddress)),o}return e.prototype.onError=function(t,r){this._setStatus(void 0,t),r&&(this.duration=r)},e.prototype.onResponse=function(t,r){this._setStatus(t.statusCode,void 0),r&&(this.duration=r)},e.prototype.getRequestTelemetry=function(t){var r=this.method;try{r+=" "+new Jj.URL(this.url).pathname}catch{}var o={id:this.requestId,name:r,url:this.url,source:this.sourceCorrelationId,duration:this.duration,resultCode:this.statusCode?this.statusCode.toString():null,success:this._isSuccess(),properties:this.properties};if(t&&t.time?o.time=t.time:this.startTime&&(o.time=new Date(this.startTime)),t){for(var s in t)o[s]||(o[s]=t[s]);if(t.properties)for(var s in t.properties)o.properties[s]=t.properties[s]}return o},e.prototype.getRequestTags=function(t){var r={};for(var o in t)r[o]=t[o];return r[e.keys.locationIp]=t[e.keys.locationIp]||this._getIp(),r[e.keys.sessionId]=t[e.keys.sessionId]||this._getId(Zj.HttpRequestCookieNames.SESSION),r[e.keys.userId]=t[e.keys.userId]||this._getId(Zj.HttpRequestCookieNames.USER),r[e.keys.userAuthUserId]=t[e.keys.userAuthUserId]||this._getId(Zj.HttpRequestCookieNames.AUTH_USER),r[e.keys.operationName]=this.getOperationName(t),r[e.keys.operationParentId]=this.getOperationParentId(t),r[e.keys.operationId]=this.getOperationId(t),r},e.prototype.getOperationId=function(t){return t[e.keys.operationId]||this.operationId},e.prototype.getOperationParentId=function(t){return t[e.keys.operationParentId]||this.parentId||this.getOperationId(t)},e.prototype.getOperationName=function(t){if(t[e.keys.operationName])return t[e.keys.operationName];var r="";try{r=new Jj.URL(this.url).pathname}catch{}var o=this.method;return r&&(o+=" "+r),o},e.prototype.getRequestId=function(){return this.requestId},e.prototype.getCorrelationContextHeader=function(){return this.correlationContextHeader},e.prototype.getTraceparent=function(){return this.traceparent},e.prototype.getTracestate=function(){return this.tracestate},e.prototype.getLegacyRootId=function(){return this.legacyRootId},e.prototype._getAbsoluteUrl=function(t){if(!t.headers)return t.url;var r=t.connection?t.connection.encrypted:null,o=r||t.headers["x-forwarded-proto"]=="https"?"https":"http",s=o+"://"+t.headers.host+"/",a="",c="";try{var l=new Jj.URL(t.url,s);a=l.pathname,c=l.search}catch{}var u=Jj.format({protocol:o,host:t.headers.host,pathname:a,search:c});return u},e.prototype._getIp=function(){var t=/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/,r=function(s){var a=t.exec(s);if(a)return a[0]},o=r(this.rawHeaders["x-forwarded-for"])||r(this.rawHeaders["x-client-ip"])||r(this.rawHeaders["x-real-ip"])||r(this.connectionRemoteAddress)||r(this.socketRemoteAddress)||r(this.legacySocketRemoteAddress);return!o&&this.connectionRemoteAddress&&this.connectionRemoteAddress.substr&&this.connectionRemoteAddress.substr(0,2)==="::"&&(o="127.0.0.1"),o},e.prototype._getId=function(t){var r=this.rawHeaders&&this.rawHeaders.cookie&&typeof this.rawHeaders.cookie=="string"&&this.rawHeaders.cookie||"";if(t===Zj.HttpRequestCookieNames.AUTH_USER)try{r=decodeURI(r)}catch(s){r="",g_t.warn("Could not decode the auth cookie with error: ",Fse.dumpObj(s))}var o=e.parseId(Fse.getCookie(t,r));return o},e.prototype.setBackCompatFromThisTraceContext=function(){this.operationId=this.traceparent.traceId,this.traceparent.legacyRootId&&(this.legacyRootId=this.traceparent.legacyRootId),this.parentId=this.traceparent.parentId,this.traceparent.updateSpanId(),this.requestId=this.traceparent.getBackCompatRequestId()},e.prototype.parseHeaders=function(t,r){if(this.rawHeaders=t.headers||t.rawHeaders,this.userAgent=t.headers&&t.headers["user-agent"],this.sourceCorrelationId=Fse.getCorrelationContextTarget(t,Ol.requestContextSourceKey),t.headers){var o=t.headers[Ol.traceStateHeader]?t.headers[Ol.traceStateHeader].toString():null,s=t.headers[Ol.traceparentHeader]?t.headers[Ol.traceparentHeader].toString():null,a=t.headers[Ol.requestIdHeader]?t.headers[Ol.requestIdHeader].toString():null,c=t.headers[Ol.parentIdHeader]?t.headers[Ol.parentIdHeader].toString():null,l=t.headers[Ol.rootIdHeader]?t.headers[Ol.rootIdHeader].toString():null;this.correlationContextHeader=t.headers[Ol.correlationContextHeader]?t.headers[Ol.correlationContextHeader].toString():null,tb.w3cEnabled&&(s||o)?(this.traceparent=new Use(s?s.toString():null),this.tracestate=s&&o&&new h_t(o?o.toString():null),this.setBackCompatFromThisTraceContext()):a?tb.w3cEnabled?(this.traceparent=new Use(null,a),this.setBackCompatFromThisTraceContext()):(this.parentId=a,this.requestId=tb.generateRequestId(this.parentId),this.operationId=tb.getRootId(this.requestId)):tb.w3cEnabled?(this.traceparent=new Use,this.traceparent.parentId=c,this.traceparent.legacyRootId=l||c,this.setBackCompatFromThisTraceContext()):(this.parentId=c,this.requestId=tb.generateRequestId(l||this.parentId),this.correlationContextHeader=null,this.operationId=tb.getRootId(this.requestId)),r&&(this.requestId=r,this.operationId=tb.getRootId(this.requestId))}},e.parseId=function(t){var r=t.split("|");return r.length>0?r[0]:""},e.keys=new f_t.ContextTagKeys,e}(m_t);SMe.exports=v_t});var BMe=P((nn,UMe)=>{nn=UMe.exports=Wn;var Tr;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?Tr=function(){var n=Array.prototype.slice.call(arguments,0);n.unshift("SEMVER"),console.log.apply(console,n)}:Tr=function(){};nn.SEMVER_SPEC_VERSION="2.0.0";var S4=256,eH=Number.MAX_SAFE_INTEGER||9007199254740991,jse=16,y_t=S4-6,I4=nn.re=[],Xr=nn.safeRe=[],Le=nn.src=[],Vn=0,$se="[a-zA-Z0-9-]",Hse=[["\\s",1],["\\d",S4],[$se,y_t]];function sH(n){for(var e=0;e<Hse.length;e++){var t=Hse[e][0],r=Hse[e][1];n=n.split(t+"*").join(t+"{0,"+r+"}").split(t+"+").join(t+"{1,"+r+"}")}return n}var wR=Vn++;Le[wR]="0|[1-9]\\d*";var kR=Vn++;Le[kR]="\\d+";var Wse=Vn++;Le[Wse]="\\d*[a-zA-Z-]"+$se+"*";var TMe=Vn++;Le[TMe]="("+Le[wR]+")\\.("+Le[wR]+")\\.("+Le[wR]+")";var CMe=Vn++;Le[CMe]="("+Le[kR]+")\\.("+Le[kR]+")\\.("+Le[kR]+")";var Vse=Vn++;Le[Vse]="(?:"+Le[wR]+"|"+Le[Wse]+")";var Gse=Vn++;Le[Gse]="(?:"+Le[kR]+"|"+Le[Wse]+")";var Kse=Vn++;Le[Kse]="(?:-("+Le[Vse]+"(?:\\."+Le[Vse]+")*))";var Yse=Vn++;Le[Yse]="(?:-?("+Le[Gse]+"(?:\\."+Le[Gse]+")*))";var zse=Vn++;Le[zse]=$se+"+";var C4=Vn++;Le[C4]="(?:\\+("+Le[zse]+"(?:\\."+Le[zse]+")*))";var Qse=Vn++,EMe="v?"+Le[TMe]+Le[Kse]+"?"+Le[C4]+"?";Le[Qse]="^"+EMe+"$";var Xse="[v=\\s]*"+Le[CMe]+Le[Yse]+"?"+Le[C4]+"?",Jse=Vn++;Le[Jse]="^"+Xse+"$";var NR=Vn++;Le[NR]="((?:<|>)?=?)";var tH=Vn++;Le[tH]=Le[kR]+"|x|X|\\*";var nH=Vn++;Le[nH]=Le[wR]+"|x|X|\\*";var WS=Vn++;Le[WS]="[v=\\s]*("+Le[nH]+")(?:\\.("+Le[nH]+")(?:\\.("+Le[nH]+")(?:"+Le[Kse]+")?"+Le[C4]+"?)?)?";var PR=Vn++;Le[PR]="[v=\\s]*("+Le[tH]+")(?:\\.("+Le[tH]+")(?:\\.("+Le[tH]+")(?:"+Le[Yse]+")?"+Le[C4]+"?)?)?";var wMe=Vn++;Le[wMe]="^"+Le[NR]+"\\s*"+Le[WS]+"$";var kMe=Vn++;Le[kMe]="^"+Le[NR]+"\\s*"+Le[PR]+"$";var RMe=Vn++;Le[RMe]="(?:^|[^\\d])(\\d{1,"+jse+"})(?:\\.(\\d{1,"+jse+"}))?(?:\\.(\\d{1,"+jse+"}))?(?:$|[^\\d])";var aH=Vn++;Le[aH]="(?:~>?)";var AR=Vn++;Le[AR]="(\\s*)"+Le[aH]+"\\s+";I4[AR]=new RegExp(Le[AR],"g");Xr[AR]=new RegExp(sH(Le[AR]),"g");var b_t="$1~",PMe=Vn++;Le[PMe]="^"+Le[aH]+Le[WS]+"$";var AMe=Vn++;Le[AMe]="^"+Le[aH]+Le[PR]+"$";var cH=Vn++;Le[cH]="(?:\\^)";var DR=Vn++;Le[DR]="(\\s*)"+Le[cH]+"\\s+";I4[DR]=new RegExp(Le[DR],"g");Xr[DR]=new RegExp(sH(Le[DR]),"g");var __t="$1^",DMe=Vn++;Le[DMe]="^"+Le[cH]+Le[WS]+"$";var NMe=Vn++;Le[NMe]="^"+Le[cH]+Le[PR]+"$";var Zse=Vn++;Le[Zse]="^"+Le[NR]+"\\s*("+Xse+")$|^$";var eae=Vn++;Le[eae]="^"+Le[NR]+"\\s*("+EMe+")$|^$";var KS=Vn++;Le[KS]="(\\s*)"+Le[NR]+"\\s*("+Xse+"|"+Le[WS]+")";I4[KS]=new RegExp(Le[KS],"g");Xr[KS]=new RegExp(sH(Le[KS]),"g");var x_t="$1$2$3",LMe=Vn++;Le[LMe]="^\\s*("+Le[WS]+")\\s+-\\s+("+Le[WS]+")\\s*$";var OMe=Vn++;Le[OMe]="^\\s*("+Le[PR]+")\\s+-\\s+("+Le[PR]+")\\s*$";var MMe=Vn++;Le[MMe]="(<|>)?=?\\s*\\*";for(tm=0;tm<Vn;tm++)Tr(tm,Le[tm]),I4[tm]||(I4[tm]=new RegExp(Le[tm]),Xr[tm]=new RegExp(sH(Le[tm])));var tm;nn.parse=YS;function YS(n,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),n instanceof Wn)return n;if(typeof n!="string"||n.length>S4)return null;var t=e.loose?Xr[Jse]:Xr[Qse];if(!t.test(n))return null;try{return new Wn(n,e)}catch{return null}}nn.valid=S_t;function S_t(n,e){var t=YS(n,e);return t?t.version:null}nn.clean=I_t;function I_t(n,e){var t=YS(n.trim().replace(/^[=v]+/,""),e);return t?t.version:null}nn.SemVer=Wn;function Wn(n,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),n instanceof Wn){if(n.loose===e.loose)return n;n=n.version}else if(typeof n!="string")throw new TypeError("Invalid Version: "+n);if(n.length>S4)throw new TypeError("version is longer than "+S4+" characters");if(!(this instanceof Wn))return new Wn(n,e);Tr("SemVer",n,e),this.options=e,this.loose=!!e.loose;var t=n.trim().match(e.loose?Xr[Jse]:Xr[Qse]);if(!t)throw new TypeError("Invalid Version: "+n);if(this.raw=n,this.major=+t[1],this.minor=+t[2],this.patch=+t[3],this.major>eH||this.major<0)throw new TypeError("Invalid major version");if(this.minor>eH||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>eH||this.patch<0)throw new TypeError("Invalid patch version");t[4]?this.prerelease=t[4].split(".").map(function(r){if(/^[0-9]+$/.test(r)){var o=+r;if(o>=0&&o<eH)return o}return r}):this.prerelease=[],this.build=t[5]?t[5].split("."):[],this.format()}Wn.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};Wn.prototype.toString=function(){return this.version};Wn.prototype.compare=function(n){return Tr("SemVer.compare",this.version,this.options,n),n instanceof Wn||(n=new Wn(n,this.options)),this.compareMain(n)||this.comparePre(n)};Wn.prototype.compareMain=function(n){return n instanceof Wn||(n=new Wn(n,this.options)),RR(this.major,n.major)||RR(this.minor,n.minor)||RR(this.patch,n.patch)};Wn.prototype.comparePre=function(n){if(n instanceof Wn||(n=new Wn(n,this.options)),this.prerelease.length&&!n.prerelease.length)return-1;if(!this.prerelease.length&&n.prerelease.length)return 1;if(!this.prerelease.length&&!n.prerelease.length)return 0;var e=0;do{var t=this.prerelease[e],r=n.prerelease[e];if(Tr("prerelease compare",e,t,r),t===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(t===void 0)return-1;if(t===r)continue;return RR(t,r)}while(++e)};Wn.prototype.inc=function(n,e){switch(n){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",e),this.inc("pre",e);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var t=this.prerelease.length;--t>=0;)typeof this.prerelease[t]=="number"&&(this.prerelease[t]++,t=-2);t===-1&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+n)}return this.format(),this.raw=this.version,this};nn.inc=T_t;function T_t(n,e,t,r){typeof t=="string"&&(r=t,t=void 0);try{return new Wn(n,t).inc(e,r).version}catch{return null}}nn.diff=C_t;function C_t(n,e){if(tae(n,e))return null;var t=YS(n),r=YS(e),o="";if(t.prerelease.length||r.prerelease.length){o="pre";var s="prerelease"}for(var a in t)if((a==="major"||a==="minor"||a==="patch")&&t[a]!==r[a])return o+a;return s}nn.compareIdentifiers=RR;var IMe=/^[0-9]+$/;function RR(n,e){var t=IMe.test(n),r=IMe.test(e);return t&&r&&(n=+n,e=+e),n===e?0:t&&!r?-1:r&&!t?1:n<e?-1:1}nn.rcompareIdentifiers=E_t;function E_t(n,e){return RR(e,n)}nn.major=w_t;function w_t(n,e){return new Wn(n,e).major}nn.minor=k_t;function k_t(n,e){return new Wn(n,e).minor}nn.patch=R_t;function R_t(n,e){return new Wn(n,e).patch}nn.compare=lg;function lg(n,e,t){return new Wn(n,t).compare(new Wn(e,t))}nn.compareLoose=P_t;function P_t(n,e){return lg(n,e,!0)}nn.rcompare=A_t;function A_t(n,e,t){return lg(e,n,t)}nn.sort=D_t;function D_t(n,e){return n.sort(function(t,r){return nn.compare(t,r,e)})}nn.rsort=N_t;function N_t(n,e){return n.sort(function(t,r){return nn.rcompare(t,r,e)})}nn.gt=T4;function T4(n,e,t){return lg(n,e,t)>0}nn.lt=rH;function rH(n,e,t){return lg(n,e,t)<0}nn.eq=tae;function tae(n,e,t){return lg(n,e,t)===0}nn.neq=FMe;function FMe(n,e,t){return lg(n,e,t)!==0}nn.gte=nae;function nae(n,e,t){return lg(n,e,t)>=0}nn.lte=rae;function rae(n,e,t){return lg(n,e,t)<=0}nn.cmp=iH;function iH(n,e,t,r){switch(e){case"===":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n===t;case"!==":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n!==t;case"":case"=":case"==":return tae(n,t,r);case"!=":return FMe(n,t,r);case">":return T4(n,t,r);case">=":return nae(n,t,r);case"<":return rH(n,t,r);case"<=":return rae(n,t,r);default:throw new TypeError("Invalid operator: "+e)}}nn.Comparator=Hu;function Hu(n,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),n instanceof Hu){if(n.loose===!!e.loose)return n;n=n.value}if(!(this instanceof Hu))return new Hu(n,e);n=n.trim().split(/\s+/).join(" "),Tr("comparator",n,e),this.options=e,this.loose=!!e.loose,this.parse(n),this.semver===E4?this.value="":this.value=this.operator+this.semver.version,Tr("comp",this)}var E4={};Hu.prototype.parse=function(n){var e=this.options.loose?Xr[Zse]:Xr[eae],t=n.match(e);if(!t)throw new TypeError("Invalid comparator: "+n);this.operator=t[1],this.operator==="="&&(this.operator=""),t[2]?this.semver=new Wn(t[2],this.options.loose):this.semver=E4};Hu.prototype.toString=function(){return this.value};Hu.prototype.test=function(n){return Tr("Comparator.test",n,this.options.loose),this.semver===E4?!0:(typeof n=="string"&&(n=new Wn(n,this.options)),iH(n,this.operator,this.semver,this.options))};Hu.prototype.intersects=function(n,e){if(!(n instanceof Hu))throw new TypeError("a Comparator is required");(!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1});var t;if(this.operator==="")return t=new Mi(n.value,e),oH(this.value,t,e);if(n.operator==="")return t=new Mi(this.value,e),oH(n.semver,t,e);var r=(this.operator===">="||this.operator===">")&&(n.operator===">="||n.operator===">"),o=(this.operator==="<="||this.operator==="<")&&(n.operator==="<="||n.operator==="<"),s=this.semver.version===n.semver.version,a=(this.operator===">="||this.operator==="<=")&&(n.operator===">="||n.operator==="<="),c=iH(this.semver,"<",n.semver,e)&&(this.operator===">="||this.operator===">")&&(n.operator==="<="||n.operator==="<"),l=iH(this.semver,">",n.semver,e)&&(this.operator==="<="||this.operator==="<")&&(n.operator===">="||n.operator===">");return r||o||s&&a||c||l};nn.Range=Mi;function Mi(n,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),n instanceof Mi)return n.loose===!!e.loose&&n.includePrerelease===!!e.includePrerelease?n:new Mi(n.raw,e);if(n instanceof Hu)return new Mi(n.value,e);if(!(this instanceof Mi))return new Mi(n,e);if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=n.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(function(t){return this.parseRange(t.trim())},this).filter(function(t){return t.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);this.format()}Mi.prototype.format=function(){return this.range=this.set.map(function(n){return n.join(" ").trim()}).join("||").trim(),this.range};Mi.prototype.toString=function(){return this.range};Mi.prototype.parseRange=function(n){var e=this.options.loose,t=e?Xr[OMe]:Xr[LMe];n=n.replace(t,V_t),Tr("hyphen replace",n),n=n.replace(Xr[KS],x_t),Tr("comparator trim",n,Xr[KS]),n=n.replace(Xr[AR],b_t),n=n.replace(Xr[DR],__t);var r=e?Xr[Zse]:Xr[eae],o=n.split(" ").map(function(s){return O_t(s,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(o=o.filter(function(s){return!!s.match(r)})),o=o.map(function(s){return new Hu(s,this.options)},this),o};Mi.prototype.intersects=function(n,e){if(!(n instanceof Mi))throw new TypeError("a Range is required");return this.set.some(function(t){return t.every(function(r){return n.set.some(function(o){return o.every(function(s){return r.intersects(s,e)})})})})};nn.toComparators=L_t;function L_t(n,e){return new Mi(n,e).set.map(function(t){return t.map(function(r){return r.value}).join(" ").trim().split(" ")})}function O_t(n,e){return Tr("comp",n,e),n=U_t(n,e),Tr("caret",n),n=M_t(n,e),Tr("tildes",n),n=q_t(n,e),Tr("xrange",n),n=H_t(n,e),Tr("stars",n),n}function nc(n){return!n||n.toLowerCase()==="x"||n==="*"}function M_t(n,e){return n.trim().split(/\s+/).map(function(t){return F_t(t,e)}).join(" ")}function F_t(n,e){var t=e.loose?Xr[AMe]:Xr[PMe];return n.replace(t,function(r,o,s,a,c){Tr("tilde",n,r,o,s,a,c);var l;return nc(o)?l="":nc(s)?l=">="+o+".0.0 <"+(+o+1)+".0.0":nc(a)?l=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0":c?(Tr("replaceTilde pr",c),l=">="+o+"."+s+"."+a+"-"+c+" <"+o+"."+(+s+1)+".0"):l=">="+o+"."+s+"."+a+" <"+o+"."+(+s+1)+".0",Tr("tilde return",l),l})}function U_t(n,e){return n.trim().split(/\s+/).map(function(t){return B_t(t,e)}).join(" ")}function B_t(n,e){Tr("caret",n,e);var t=e.loose?Xr[NMe]:Xr[DMe];return n.replace(t,function(r,o,s,a,c){Tr("caret",n,r,o,s,a,c);var l;return nc(o)?l="":nc(s)?l=">="+o+".0.0 <"+(+o+1)+".0.0":nc(a)?o==="0"?l=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0":l=">="+o+"."+s+".0 <"+(+o+1)+".0.0":c?(Tr("replaceCaret pr",c),o==="0"?s==="0"?l=">="+o+"."+s+"."+a+"-"+c+" <"+o+"."+s+"."+(+a+1):l=">="+o+"."+s+"."+a+"-"+c+" <"+o+"."+(+s+1)+".0":l=">="+o+"."+s+"."+a+"-"+c+" <"+(+o+1)+".0.0"):(Tr("no pr"),o==="0"?s==="0"?l=">="+o+"."+s+"."+a+" <"+o+"."+s+"."+(+a+1):l=">="+o+"."+s+"."+a+" <"+o+"."+(+s+1)+".0":l=">="+o+"."+s+"."+a+" <"+(+o+1)+".0.0"),Tr("caret return",l),l})}function q_t(n,e){return Tr("replaceXRanges",n,e),n.split(/\s+/).map(function(t){return j_t(t,e)}).join(" ")}function j_t(n,e){n=n.trim();var t=e.loose?Xr[kMe]:Xr[wMe];return n.replace(t,function(r,o,s,a,c,l){Tr("xRange",n,r,o,s,a,c,l);var u=nc(s),d=u||nc(a),p=d||nc(c),f=p;return o==="="&&f&&(o=""),u?o===">"||o==="<"?r="<0.0.0":r="*":o&&f?(d&&(a=0),c=0,o===">"?(o=">=",d?(s=+s+1,a=0,c=0):(a=+a+1,c=0)):o==="<="&&(o="<",d?s=+s+1:a=+a+1),r=o+s+"."+a+"."+c):d?r=">="+s+".0.0 <"+(+s+1)+".0.0":p&&(r=">="+s+"."+a+".0 <"+s+"."+(+a+1)+".0"),Tr("xRange return",r),r})}function H_t(n,e){return Tr("replaceStars",n,e),n.trim().replace(Xr[MMe],"")}function V_t(n,e,t,r,o,s,a,c,l,u,d,p,f){return nc(t)?e="":nc(r)?e=">="+t+".0.0":nc(o)?e=">="+t+"."+r+".0":e=">="+e,nc(l)?c="":nc(u)?c="<"+(+l+1)+".0.0":nc(d)?c="<"+l+"."+(+u+1)+".0":p?c="<="+l+"."+u+"."+d+"-"+p:c="<="+c,(e+" "+c).trim()}Mi.prototype.test=function(n){if(!n)return!1;typeof n=="string"&&(n=new Wn(n,this.options));for(var e=0;e<this.set.length;e++)if(G_t(this.set[e],n,this.options))return!0;return!1};function G_t(n,e,t){for(var r=0;r<n.length;r++)if(!n[r].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(r=0;r<n.length;r++)if(Tr(n[r].semver),n[r].semver!==E4&&n[r].semver.prerelease.length>0){var o=n[r].semver;if(o.major===e.major&&o.minor===e.minor&&o.patch===e.patch)return!0}return!1}return!0}nn.satisfies=oH;function oH(n,e,t){try{e=new Mi(e,t)}catch{return!1}return e.test(n)}nn.maxSatisfying=z_t;function z_t(n,e,t){var r=null,o=null;try{var s=new Mi(e,t)}catch{return null}return n.forEach(function(a){s.test(a)&&(!r||o.compare(a)===-1)&&(r=a,o=new Wn(r,t))}),r}nn.minSatisfying=$_t;function $_t(n,e,t){var r=null,o=null;try{var s=new Mi(e,t)}catch{return null}return n.forEach(function(a){s.test(a)&&(!r||o.compare(a)===1)&&(r=a,o=new Wn(r,t))}),r}nn.minVersion=W_t;function W_t(n,e){n=new Mi(n,e);var t=new Wn("0.0.0");if(n.test(t)||(t=new Wn("0.0.0-0"),n.test(t)))return t;t=null;for(var r=0;r<n.set.length;++r){var o=n.set[r];o.forEach(function(s){var a=new Wn(s.semver.version);switch(s.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!t||T4(t,a))&&(t=a);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+s.operator)}})}return t&&n.test(t)?t:null}nn.validRange=K_t;function K_t(n,e){try{return new Mi(n,e).range||"*"}catch{return null}}nn.ltr=Y_t;function Y_t(n,e,t){return iae(n,e,"<",t)}nn.gtr=Q_t;function Q_t(n,e,t){return iae(n,e,">",t)}nn.outside=iae;function iae(n,e,t,r){n=new Wn(n,r),e=new Mi(e,r);var o,s,a,c,l;switch(t){case">":o=T4,s=rae,a=rH,c=">",l=">=";break;case"<":o=rH,s=nae,a=T4,c="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(oH(n,e,r))return!1;for(var u=0;u<e.set.length;++u){var d=e.set[u],p=null,f=null;if(d.forEach(function(m){m.semver===E4&&(m=new Hu(">=0.0.0")),p=p||m,f=f||m,o(m.semver,p.semver,r)?p=m:a(m.semver,f.semver,r)&&(f=m)}),p.operator===c||p.operator===l||(!f.operator||f.operator===c)&&s(n,f.semver))return!1;if(f.operator===l&&a(n,f.semver))return!1}return!0}nn.prerelease=X_t;function X_t(n,e){var t=YS(n,e);return t&&t.prerelease.length?t.prerelease:null}nn.intersects=J_t;function J_t(n,e,t){return n=new Mi(n,t),e=new Mi(e,t),n.intersects(e)}nn.coerce=Z_t;function Z_t(n){if(n instanceof Wn)return n;if(typeof n!="string")return null;var e=n.match(Xr[RMe]);return e==null?null:YS(e[1]+"."+(e[2]||"0")+"."+(e[3]||"0"))}});var lH=P((uir,HMe)=>{"use strict";function oae(n){return typeof n=="function"}var rc=console.error.bind(console);function w4(n,e,t){var r=!!n[e]&&n.propertyIsEnumerable(e);Object.defineProperty(n,e,{configurable:!0,enumerable:r,writable:!0,value:t})}function k4(n){n&&n.logger&&(oae(n.logger)?rc=n.logger:rc("new logger isn't a function, not replacing"))}function qMe(n,e,t){if(!n||!n[e]){rc("no original function "+e+" to wrap");return}if(!t){rc("no wrapper function"),rc(new Error().stack);return}if(!oae(n[e])||!oae(t)){rc("original object and wrapper must be functions");return}var r=n[e],o=t(r,e);return w4(o,"__original",r),w4(o,"__unwrap",function(){n[e]===o&&w4(n,e,r)}),w4(o,"__wrapped",!0),w4(n,e,o),o}function ext(n,e,t){if(n)Array.isArray(n)||(n=[n]);else{rc("must provide one or more modules to patch"),rc(new Error().stack);return}if(!(e&&Array.isArray(e))){rc("must provide one or more functions to wrap on modules");return}n.forEach(function(r){e.forEach(function(o){qMe(r,o,t)})})}function jMe(n,e){if(!n||!n[e]){rc("no function to unwrap."),rc(new Error().stack);return}if(!n[e].__unwrap)rc("no original to unwrap to -- has "+e+" already been unwrapped?");else return n[e].__unwrap()}function txt(n,e){if(n)Array.isArray(n)||(n=[n]);else{rc("must provide one or more modules to patch"),rc(new Error().stack);return}if(!(e&&Array.isArray(e))){rc("must provide one or more functions to unwrap on modules");return}n.forEach(function(t){e.forEach(function(r){jMe(t,r)})})}k4.wrap=qMe;k4.massWrap=ext;k4.unwrap=jMe;k4.massUnwrap=txt;HMe.exports=k4});var pH=P((dir,$Me)=>{"use strict";var GMe=lH(),LR=GMe.wrap,uH=GMe.unwrap,ug="wrap@before";function dH(n,e,t){var r=!!n[e]&&n.propertyIsEnumerable(e);Object.defineProperty(n,e,{configurable:!0,enumerable:r,writable:!0,value:t})}function nxt(n,e){for(var t=e.length,r=0;r<t;r++){var o=e[r],s=n[ug];if(typeof s=="function")s(o);else if(Array.isArray(s))for(var a=s.length,c=0;c<a;c++)s[c](o)}}function zMe(n,e){var t;return t=n._events&&n._events[e],Array.isArray(t)||(t?t=[t]:t=[]),t}function rxt(n,e,t){var r=zMe(n,e),o=r.filter(function(s){return t.indexOf(s)===-1});o.length>0&&nxt(n,o)}function VMe(n,e){if(n){var t=n;if(typeof n=="function")t=e(n);else if(Array.isArray(n)){t=[];for(var r=0;r<n.length;r++)t[r]=e(n[r])}return t}}$Me.exports=function(e,t,r){if(!e||!e.on||!e.addListener||!e.removeListener||!e.emit)throw new Error("can only wrap real EEs");if(!t)throw new Error("must have function to run on listener addition");if(!r)throw new Error("must have function to wrap listeners when emitting");function o(a){return function(l,u){var d=zMe(this,l).slice();try{var p=a.call(this,l,u);return rxt(this,l,d),p}finally{this.on.__wrapped||LR(this,"on",o),this.addListener.__wrapped||LR(this,"addListener",o)}}}function s(a){return function(l){if(!this._events||!this._events[l])return a.apply(this,arguments);var u=this._events[l];function d(p){return function(){this._events[l]=u;try{return p.apply(this,arguments)}finally{u=this._events[l],this._events[l]=VMe(u,r)}}}LR(this,"removeListener",d);try{return this._events[l]=VMe(u,r),a.apply(this,arguments)}finally{uH(this,"removeListener"),this._events[l]=u}}}e[ug]?typeof e[ug]=="function"?dH(e,ug,[e[ug],t]):Array.isArray(e[ug])&&e[ug].push(t):dH(e,ug,t),e.__wrapped||(LR(e,"addListener",o),LR(e,"on",o),LR(e,"emit",s),dH(e,"__unwrap",function(){uH(e,"addListener"),uH(e,"on"),uH(e,"emit"),delete e[ug],delete e.__wrapped}),dH(e,"__wrapped",!0))}});var QMe=P((pir,YMe)=>{"use strict";var hr=require("util"),dg=require("assert"),ixt=pH(),di=require("async_hooks"),R4="cls@contexts",P4="error@context",Fi=process.env.DEBUG_CLS_HOOKED,mr=-1;YMe.exports={getNamespace:WMe,createNamespace:oxt,destroyNamespace:KMe,reset:sxt,ERROR_SYMBOL:P4};function Vu(n){this.name=n,this.active=null,this._set=[],this.id=null,this._contexts=new Map,this._indent=0}Vu.prototype.set=function(e,t){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");if(this.active[e]=t,Fi){let r=" ".repeat(this._indent<0?0:this._indent);_i(r+"CONTEXT-SET KEY:"+e+"="+t+" in ns:"+this.name+" currentUid:"+mr+" active:"+hr.inspect(this.active,{showHidden:!0,depth:2,colors:!0}))}return t};Vu.prototype.get=function(e){if(!this.active){if(Fi){let t=di.currentId(),r=di.triggerAsyncId(),o=" ".repeat(this._indent<0?0:this._indent);_i(`${o}CONTEXT-GETTING KEY NO ACTIVE NS: (${this.name}) ${e}=undefined currentUid:${mr} asyncHooksCurrentId:${t} triggerId:${r} len:${this._set.length}`)}return}if(Fi){let t=di.executionAsyncId(),r=di.triggerAsyncId(),o=" ".repeat(this._indent<0?0:this._indent);_i(o+"CONTEXT-GETTING KEY:"+e+"="+this.active[e]+" ("+this.name+") currentUid:"+mr+" active:"+hr.inspect(this.active,{showHidden:!0,depth:2,colors:!0})),_i(`${o}CONTEXT-GETTING KEY: (${this.name}) ${e}=${this.active[e]} currentUid:${mr} asyncHooksCurrentId:${t} triggerId:${r} len:${this._set.length} active:${hr.inspect(this.active)}`)}return this.active[e]};Vu.prototype.createContext=function(){let e=Object.create(this.active?this.active:Object.prototype);if(e._ns_name=this.name,e.id=mr,Fi){let t=di.executionAsyncId(),r=di.triggerAsyncId(),o=" ".repeat(this._indent<0?0:this._indent);_i(`${o}CONTEXT-CREATED Context: (${this.name}) currentUid:${mr} asyncHooksCurrentId:${t} triggerId:${r} len:${this._set.length} context:${hr.inspect(e,{showHidden:!0,depth:2,colors:!0})}`)}return e};Vu.prototype.run=function(e){let t=this.createContext();this.enter(t);try{if(Fi){let r=di.triggerAsyncId(),o=di.executionAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);_i(`${s}CONTEXT-RUN BEGIN: (${this.name}) currentUid:${mr} triggerId:${r} asyncHooksCurrentId:${o} len:${this._set.length} context:${hr.inspect(t)}`)}return e(t),t}catch(r){throw r&&(r[P4]=t),r}finally{if(Fi){let r=di.triggerAsyncId(),o=di.executionAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);_i(`${s}CONTEXT-RUN END: (${this.name}) currentUid:${mr} triggerId:${r} asyncHooksCurrentId:${o} len:${this._set.length} ${hr.inspect(t)}`)}this.exit(t)}};Vu.prototype.runAndReturn=function(e){let t;return this.run(function(r){t=e(r)}),t};Vu.prototype.runPromise=function(e){let t=this.createContext();this.enter(t);let r=e(t);if(!r||!r.then||!r.catch)throw new Error("fn must return a promise.");return Fi&&_i("CONTEXT-runPromise BEFORE: ("+this.name+") currentUid:"+mr+" len:"+this._set.length+" "+hr.inspect(t)),r.then(o=>(Fi&&_i("CONTEXT-runPromise AFTER then: ("+this.name+") currentUid:"+mr+" len:"+this._set.length+" "+hr.inspect(t)),this.exit(t),o)).catch(o=>{throw o[P4]=t,Fi&&_i("CONTEXT-runPromise AFTER catch: ("+this.name+") currentUid:"+mr+" len:"+this._set.length+" "+hr.inspect(t)),this.exit(t),o})};Vu.prototype.bind=function(e,t){t||(this.active?t=this.active:t=this.createContext());let r=this;return function(){r.enter(t);try{return e.apply(this,arguments)}catch(s){throw s&&(s[P4]=t),s}finally{r.exit(t)}}};Vu.prototype.enter=function(e){if(dg.ok(e,"context must be provided for entering"),Fi){let t=di.executionAsyncId(),r=di.triggerAsyncId(),o=" ".repeat(this._indent<0?0:this._indent);_i(`${o}CONTEXT-ENTER: (${this.name}) currentUid:${mr} triggerId:${r} asyncHooksCurrentId:${t} len:${this._set.length} ${hr.inspect(e)}`)}this._set.push(this.active),this.active=e};Vu.prototype.exit=function(e){if(dg.ok(e,"context must be provided for exiting"),Fi){let r=di.executionAsyncId(),o=di.triggerAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);_i(`${s}CONTEXT-EXIT: (${this.name}) currentUid:${mr} triggerId:${o} asyncHooksCurrentId:${r} len:${this._set.length} ${hr.inspect(e)}`)}if(this.active===e){dg.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let t=this._set.lastIndexOf(e);t<0?(Fi&&_i("??ERROR?? context exiting but not entered - ignoring: "+hr.inspect(e)),dg.ok(t>=0,`context not currently entered; can't exit. 
`+hr.inspect(this)+`
`+hr.inspect(e))):(dg.ok(t,"can't remove top context"),this._set.splice(t,1))};Vu.prototype.bindEmitter=function(e){dg.ok(e.on&&e.addListener&&e.emit,"can only bind real EEs");let t=this,r="context@"+this.name;function o(a){a&&(a[R4]||(a[R4]=Object.create(null)),a[R4][r]={namespace:t,context:t.active})}function s(a){if(!(a&&a[R4]))return a;let c=a,l=a[R4];return Object.keys(l).forEach(function(u){let d=l[u];c=d.namespace.bind(c,d.context)}),c}ixt(e,o,s)};Vu.prototype.fromException=function(e){return e[P4]};function WMe(n){return process.namespaces[n]}function oxt(n){dg.ok(n,"namespace must be given a name."),Fi&&_i(`NS-CREATING NAMESPACE (${n})`);let e=new Vu(n);return e.id=mr,di.createHook({init(r,o,s,a){if(mr=di.executionAsyncId(),e.active){if(e._contexts.set(r,e.active),Fi){let c=" ".repeat(e._indent<0?0:e._indent);_i(`${c}INIT [${o}] (${n}) asyncId:${r} currentUid:${mr} triggerId:${s} active:${hr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}}else if(mr===0){let c=di.triggerAsyncId(),l=e._contexts.get(c);if(l){if(e._contexts.set(r,l),Fi){let u=" ".repeat(e._indent<0?0:e._indent);_i(`${u}INIT USING CONTEXT FROM TRIGGERID [${o}] (${n}) asyncId:${r} currentUid:${mr} triggerId:${c} active:${hr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}}else if(Fi){let u=" ".repeat(e._indent<0?0:e._indent);_i(`${u}INIT MISSING CONTEXT [${o}] (${n}) asyncId:${r} currentUid:${mr} triggerId:${c} active:${hr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}}if(Fi&&o==="PROMISE"){_i(hr.inspect(a,{showHidden:!0}));let c=a.parentId,l=" ".repeat(e._indent<0?0:e._indent);_i(`${l}INIT RESOURCE-PROMISE [${o}] (${n}) parentId:${c} asyncId:${r} currentUid:${mr} triggerId:${s} active:${hr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}},before(r){mr=di.executionAsyncId();let o;if(o=e._contexts.get(r)||e._contexts.get(mr),o){if(Fi){let s=di.triggerAsyncId(),a=" ".repeat(e._indent<0?0:e._indent);_i(`${a}BEFORE (${n}) asyncId:${r} currentUid:${mr} triggerId:${s} active:${hr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} context:${hr.inspect(o)}`),e._indent+=2}e.enter(o)}else if(Fi){let s=di.triggerAsyncId(),a=" ".repeat(e._indent<0?0:e._indent);_i(`${a}BEFORE MISSING CONTEXT (${n}) asyncId:${r} currentUid:${mr} triggerId:${s} active:${hr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} namespace._contexts:${hr.inspect(e._contexts,{showHidden:!0,depth:2,colors:!0})}`),e._indent+=2}},after(r){mr=di.executionAsyncId();let o;if(o=e._contexts.get(r)||e._contexts.get(mr),o){if(Fi){let s=di.triggerAsyncId();e._indent-=2;let a=" ".repeat(e._indent<0?0:e._indent);_i(`${a}AFTER (${n}) asyncId:${r} currentUid:${mr} triggerId:${s} active:${hr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} context:${hr.inspect(o)}`)}e.exit(o)}else if(Fi){let s=di.triggerAsyncId();e._indent-=2;let a=" ".repeat(e._indent<0?0:e._indent);_i(`${a}AFTER MISSING CONTEXT (${n}) asyncId:${r} currentUid:${mr} triggerId:${s} active:${hr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} context:${hr.inspect(o)}`)}},destroy(r){if(mr=di.executionAsyncId(),Fi){let o=di.triggerAsyncId(),s=" ".repeat(e._indent<0?0:e._indent);_i(`${s}DESTROY (${n}) currentUid:${mr} asyncId:${r} triggerId:${o} active:${hr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} context:${hr.inspect(e._contexts.get(mr))}`)}e._contexts.delete(r)}}).enable(),process.namespaces[n]=e,e}function KMe(n){let e=WMe(n);dg.ok(e,`can't delete nonexistent namespace! "`+n+'"'),dg.ok(e.id,"don't assign to process.namespaces directly! "+hr.inspect(e)),process.namespaces[n]=null}function sxt(){process.namespaces&&Object.keys(process.namespaces).forEach(function(n){KMe(n)}),process.namespaces=Object.create(null)}process.namespaces={};function _i(...n){Fi&&process._rawDebug(`${hr.format(...n)}`)}});var JMe=P((fir,XMe)=>{"use strict";function axt(){}XMe.exports=function(){let e=this._hooks,t=this._state,r=process.nextTick;process.nextTick=function(){if(!t.enabled)return r.apply(process,arguments);let o=new Array(arguments.length);for(let l=0;l<arguments.length;l++)o[l]=arguments[l];let s=o[0];if(typeof s!="function")throw new TypeError("callback is not a function");let a=new axt,c=--t.counter;return e.init.call(a,c,0,null,null),o[0]=function(){e.pre.call(a,c);let l=!0;try{s.apply(this,arguments),l=!1}finally{l&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){e.post.call(a,c,!0),e.destroy.call(null,c)})}e.post.call(a,c,!1),e.destroy.call(null,c)},r.apply(process,o)}}});var e3e=P((mir,ZMe)=>{"use strict";function cxt(){}ZMe.exports=function(){let e=this._hooks,t=this._state,r=global.Promise,o=r.prototype.then;r.prototype.then=l;function s(u,d,p,f){return typeof u!="function"?f?a(p):c(p):function(){e.pre.call(d,p);try{return u.apply(this,arguments)}finally{e.post.call(d,p,!1),e.destroy.call(null,p)}}}function a(u){return function(p){return e.destroy.call(null,u),p}}function c(u){return function(p){throw e.destroy.call(null,u),p}}function l(u,d){if(!t.enabled)return o.call(this,u,d);let p=new cxt,f=--t.counter;return e.init.call(p,f,0,null,null),o.call(this,s(u,p,f,!0),s(d,p,f,!1))}}});var n3e=P((hir,t3e)=>{"use strict";var Ml=require("timers");function lxt(){}function uxt(){}function dxt(){}var pxt=new Map,fxt=new Map,mxt=new Map,sae=null,aae=!1;t3e.exports=function(){cae(this._hooks,this._state,"setTimeout","clearTimeout",lxt,pxt,!0),cae(this._hooks,this._state,"setInterval","clearInterval",uxt,fxt,!1),cae(this._hooks,this._state,"setImmediate","clearImmediate",dxt,mxt,!0),global.setTimeout=Ml.setTimeout,global.setInterval=Ml.setInterval,global.setImmediate=Ml.setImmediate,global.clearTimeout=Ml.clearTimeout,global.clearInterval=Ml.clearInterval,global.clearImmediate=Ml.clearImmediate};function cae(n,e,t,r,o,s,a){let c=Ml[t],l=Ml[r];Ml[t]=function(){if(!e.enabled)return c.apply(Ml,arguments);let u=new Array(arguments.length);for(let h=0;h<arguments.length;h++)u[h]=arguments[h];let d=u[0];if(typeof d!="function")throw new TypeError('"callback" argument must be a function');let p=new o,f=--e.counter,m;return n.init.call(p,f,0,null,null),u[0]=function(){sae=m,n.pre.call(p,f);let h=!0;try{d.apply(this,arguments),h=!1}finally{h&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){n.post.call(p,f,!0),s.delete(m),n.destroy.call(null,f)})}n.post.call(p,f,!1),sae=null,(a||aae)&&(aae=!1,s.delete(m),n.destroy.call(null,f))},m=c.apply(Ml,u),s.set(m,f),m},Ml[r]=function(u){if(sae===u&&u!==null)aae=!0;else if(s.has(u)){let d=s.get(u);s.delete(u),n.destroy.call(null,d)}l.apply(Ml,arguments)}}});var o3e=P((gir,i3e)=>{"use strict";var D4=process.binding("async_wrap"),hxt=D4.Providers.TIMERWRAP,r3e={nextTick:JMe(),promise:e3e(),timers:n3e()},A4=new Set;function gxt(){this.enabled=!1,this.counter=0}function lae(){let n=this.initFns=[],e=this.preFns=[],t=this.postFns=[],r=this.destroyFns=[];this.init=function(o,s,a,c){if(s===hxt){A4.add(o);return}for(let l of n)l(o,this,s,a,c)},this.pre=function(o){if(!A4.has(o))for(let s of e)s(o,this)},this.post=function(o,s){if(!A4.has(o))for(let a of t)a(o,this,s)},this.destroy=function(o){if(A4.has(o)){A4.delete(o);return}for(let s of r)s(o)}}lae.prototype.add=function(n){n.init&&this.initFns.push(n.init),n.pre&&this.preFns.push(n.pre),n.post&&this.postFns.push(n.post),n.destroy&&this.destroyFns.push(n.destroy)};function fH(n,e){let t=n.indexOf(e);t!==-1&&n.splice(t,1)}lae.prototype.remove=function(n){n.init&&fH(this.initFns,n.init),n.pre&&fH(this.preFns,n.pre),n.post&&fH(this.postFns,n.post),n.destroy&&fH(this.destroyFns,n.destroy)};function N4(){this._state=new gxt,this._hooks=new lae,this.version=require("./package.json").version,this.providers=D4.Providers;for(let n of Object.keys(r3e))r3e[n].call(this);process.env.hasOwnProperty("NODE_ASYNC_HOOK_WARNING")&&console.warn("warning: you are using async-hook-jl which is unstable."),D4.setupHooks({init:this._hooks.init,pre:this._hooks.pre,post:this._hooks.post,destroy:this._hooks.destroy})}i3e.exports=N4;N4.prototype.addHooks=function(n){this._hooks.add(n)};N4.prototype.removeHooks=function(n){this._hooks.remove(n)};N4.prototype.enable=function(){this._state.enabled=!0,D4.enable()};N4.prototype.disable=function(){this._state.enabled=!1,D4.disable()}});var a3e=P((vir,s3e)=>{function vxt(n){try{return Error.prototype.toString.call(n)}catch(e){try{return"<error: "+e+">"}catch{return"<error>"}}}s3e.exports=function(e,t){var r=[];r.push(vxt(e));for(var o=0;o<t.length;o++){var s=t[o],a;try{a=s.toString()}catch(c){try{a="<error: "+c+">"}catch{a="<error>"}}r.push("    at "+a)}return r.join(`
`)}});var d3e=P((yir,u3e)=>{var mH=a3e();function l3e(){this.extend=new L4,this.filter=new L4,this.format=new O4,this.version=require("./package.json").version}var dae=!1;l3e.prototype.callSite=function n(e){e||(e={}),dae=!0;var t={};Error.captureStackTrace(t,n);var r=t.stack;return dae=!1,r=r.slice(e.slice||0),e.extend&&(r=this.extend._modify(t,r)),e.filter&&(r=this.filter._modify(t,r)),r};var nb=new l3e;function L4(){this._modifiers=[]}L4.prototype._modify=function(n,e){for(var t=0,r=this._modifiers.length;t<r;t++)e=this._modifiers[t](n,e);return e};L4.prototype.attach=function(n){this._modifiers.push(n)};L4.prototype.deattach=function(n){var e=this._modifiers.indexOf(n);return e===-1?!1:(this._modifiers.splice(e,1),!0)};function O4(){this._formater=mH,this._previous=void 0}O4.prototype.replace=function(n){n?this._formater=n:this.restore()};O4.prototype.restore=function(){this._formater=mH,this._previous=void 0};O4.prototype._backup=function(){this._previous=this._formater};O4.prototype._roolback=function(){this._previous===mH?this.replace(void 0):this.replace(this._previous),this._previous=void 0};Error.prepareStackTrace&&nb.format.replace(Error.prepareStackTrace);var uae=!1;function c3e(n,e){if(dae)return e;if(uae)return mH(n,e);var t=e.concat();t=nb.extend._modify(n,t),t=nb.filter._modify(n,t),t=t.slice(0,Error.stackTraceLimit),Object.isExtensible(n)&&Object.getOwnPropertyDescriptor(n,"callSite")===void 0&&(n.callSite={original:e,mutated:t}),uae=!0;var r=nb.format._formater(n,t);return uae=!1,r}Object.defineProperty(Error,"prepareStackTrace",{get:function(){return c3e},set:function(n){n===c3e?nb.format._roolback():(nb.format._backup(),nb.format.replace(n))}});function yxt(){return this.stack,this.callSite}Object.defineProperty(Error.prototype,"callSite",{get:yxt,set:function(n){Object.defineProperty(this,"callSite",{value:n,writable:!0,configurable:!0})},configurable:!0});u3e.exports=nb});var fae=P((bir,pae)=>{if(global._stackChain)if(global._stackChain.version===require("./package.json").version)pae.exports=global._stackChain;else throw new Error("Conflicting version of stack-chain found");else pae.exports=global._stackChain=d3e()});var p3e=P((_ir,mae)=>{"use strict";var bxt=o3e();if(global._asyncHook)if(global._asyncHook.version===require("./package.json").version)mae.exports=global._asyncHook;else throw new Error("Conflicting version of async-hook-jl found");else fae().filter.attach(function(e,t){return t.filter(function(r){let o=r.getFileName();return!(o&&o.slice(0,__dirname.length)===__dirname)})}),mae.exports=global._asyncHook=new bxt});var y3e=P((xir,v3e)=>{"use strict";var bo=require("util"),pg=require("assert"),_xt=pH(),OR=p3e(),M4="cls@contexts",F4="error@context",m3e=[];for(let n in OR.providers)m3e[OR.providers[n]]=n;var ro=process.env.DEBUG_CLS_HOOKED,jo=-1;v3e.exports={getNamespace:h3e,createNamespace:xxt,destroyNamespace:g3e,reset:Sxt,ERROR_SYMBOL:F4};function Gu(n){this.name=n,this.active=null,this._set=[],this.id=null,this._contexts=new Map}Gu.prototype.set=function(e,t){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return ro&&yo("    SETTING KEY:"+e+"="+t+" in ns:"+this.name+" uid:"+jo+" active:"+bo.inspect(this.active,!0)),this.active[e]=t,t};Gu.prototype.get=function(e){if(!this.active){ro&&yo("    GETTING KEY:"+e+"=undefined "+this.name+" uid:"+jo+" active:"+bo.inspect(this.active,!0));return}return ro&&yo("    GETTING KEY:"+e+"="+this.active[e]+" "+this.name+" uid:"+jo+" active:"+bo.inspect(this.active,!0)),this.active[e]};Gu.prototype.createContext=function(){ro&&yo("   CREATING Context: "+this.name+" uid:"+jo+" len:"+this._set.length+"  active:"+bo.inspect(this.active,!0,2,!0));let e=Object.create(this.active?this.active:Object.prototype);return e._ns_name=this.name,e.id=jo,ro&&yo("   CREATED Context: "+this.name+" uid:"+jo+" len:"+this._set.length+"  context:"+bo.inspect(e,!0,2,!0)),e};Gu.prototype.run=function(e){let t=this.createContext();this.enter(t);try{return ro&&yo(" BEFORE RUN: "+this.name+" uid:"+jo+" len:"+this._set.length+" "+bo.inspect(t)),e(t),t}catch(r){throw r&&(r[F4]=t),r}finally{ro&&yo(" AFTER RUN: "+this.name+" uid:"+jo+" len:"+this._set.length+" "+bo.inspect(t)),this.exit(t)}};Gu.prototype.runAndReturn=function(e){var t;return this.run(function(r){t=e(r)}),t};Gu.prototype.runPromise=function(e){let t=this.createContext();this.enter(t);let r=e(t);if(!r||!r.then||!r.catch)throw new Error("fn must return a promise.");return ro&&yo(" BEFORE runPromise: "+this.name+" uid:"+jo+" len:"+this._set.length+" "+bo.inspect(t)),r.then(o=>(ro&&yo(" AFTER runPromise: "+this.name+" uid:"+jo+" len:"+this._set.length+" "+bo.inspect(t)),this.exit(t),o)).catch(o=>{throw o[F4]=t,ro&&yo(" AFTER runPromise: "+this.name+" uid:"+jo+" len:"+this._set.length+" "+bo.inspect(t)),this.exit(t),o})};Gu.prototype.bind=function(e,t){t||(this.active?t=this.active:t=this.createContext());let r=this;return function(){r.enter(t);try{return e.apply(this,arguments)}catch(s){throw s&&(s[F4]=t),s}finally{r.exit(t)}}};Gu.prototype.enter=function(e){pg.ok(e,"context must be provided for entering"),ro&&yo("  ENTER "+this.name+" uid:"+jo+" len:"+this._set.length+" context: "+bo.inspect(e)),this._set.push(this.active),this.active=e};Gu.prototype.exit=function(e){if(pg.ok(e,"context must be provided for exiting"),ro&&yo("  EXIT "+this.name+" uid:"+jo+" len:"+this._set.length+" context: "+bo.inspect(e)),this.active===e){pg.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let t=this._set.lastIndexOf(e);t<0?(ro&&yo("??ERROR?? context exiting but not entered - ignoring: "+bo.inspect(e)),pg.ok(t>=0,`context not currently entered; can't exit. 
`+bo.inspect(this)+`
`+bo.inspect(e))):(pg.ok(t,"can't remove top context"),this._set.splice(t,1))};Gu.prototype.bindEmitter=function(e){pg.ok(e.on&&e.addListener&&e.emit,"can only bind real EEs");let t=this,r="context@"+this.name;function o(a){a&&(a[M4]||(a[M4]=Object.create(null)),a[M4][r]={namespace:t,context:t.active})}function s(a){if(!(a&&a[M4]))return a;let c=a,l=a[M4];return Object.keys(l).forEach(function(u){let d=l[u];c=d.namespace.bind(c,d.context)}),c}_xt(e,o,s)};Gu.prototype.fromException=function(e){return e[F4]};function h3e(n){return process.namespaces[n]}function xxt(n){pg.ok(n,"namespace must be given a name."),ro&&yo("CREATING NAMESPACE "+n);let e=new Gu(n);return e.id=jo,OR.addHooks({init(t,r,o,s,a){jo=t,s?(e._contexts.set(t,e._contexts.get(s)),ro&&yo("PARENTID: "+n+" uid:"+t+" parent:"+s+" provider:"+o)):e._contexts.set(jo,e.active),ro&&yo("INIT "+n+" uid:"+t+" parent:"+s+" provider:"+m3e[o]+" active:"+bo.inspect(e.active,!0))},pre(t,r){jo=t;let o=e._contexts.get(t);o?(ro&&yo(" PRE "+n+" uid:"+t+" handle:"+hH(r)+" context:"+bo.inspect(o)),e.enter(o)):ro&&yo(" PRE MISSING CONTEXT "+n+" uid:"+t+" handle:"+hH(r))},post(t,r){jo=t;let o=e._contexts.get(t);o?(ro&&yo(" POST "+n+" uid:"+t+" handle:"+hH(r)+" context:"+bo.inspect(o)),e.exit(o)):ro&&yo(" POST MISSING CONTEXT "+n+" uid:"+t+" handle:"+hH(r))},destroy(t){jo=t,ro&&yo("DESTROY "+n+" uid:"+t+" context:"+bo.inspect(e._contexts.get(jo))+" active:"+bo.inspect(e.active,!0)),e._contexts.delete(t)}}),process.namespaces[n]=e,e}function g3e(n){let e=h3e(n);pg.ok(e,`can't delete nonexistent namespace! "`+n+'"'),pg.ok(e.id,"don't assign to process.namespaces directly! "+bo.inspect(e)),process.namespaces[n]=null}function Sxt(){process.namespaces&&Object.keys(process.namespaces).forEach(function(n){g3e(n)}),process.namespaces=Object.create(null)}process.namespaces={};OR._state&&!OR._state.enabled&&OR.enable();function yo(n){process.env.DEBUG&&process._rawDebug(n)}function hH(n){if(!n)return n;if(typeof n=="function")return n.name?n.name:(n.toString().trim().match(/^function\s*([^\s(]+)/)||[])[1];if(n.constructor&&n.constructor.name)return n.constructor.name}if(ro){hae=fae();for(f3e in hae.filter._modifiers)hae.filter.deattach(f3e)}var hae,f3e});var b3e=P((Sir,gae)=>{"use strict";var Ixt=BMe();process&&Ixt.gte(process.versions.node,"8.0.0")?gae.exports=QMe():gae.exports=y3e()});var M3e=P((rn,O3e)=>{rn=O3e.exports=Kn;var Cr;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?Cr=function(){var n=Array.prototype.slice.call(arguments,0);n.unshift("SEMVER"),console.log.apply(console,n)}:Cr=function(){};rn.SEMVER_SPEC_VERSION="2.0.0";var U4=256,gH=Number.MAX_SAFE_INTEGER||9007199254740991,vae=16,Txt=U4-6,B4=rn.re=[],Jr=rn.safeRe=[],Oe=rn.src=[],Gn=0,Sae="[a-zA-Z0-9-]",yae=[["\\s",1],["\\d",U4],[Sae,Txt]];function SH(n){for(var e=0;e<yae.length;e++){var t=yae[e][0],r=yae[e][1];n=n.split(t+"*").join(t+"{0,"+r+"}").split(t+"+").join(t+"{1,"+r+"}")}return n}var MR=Gn++;Oe[MR]="0|[1-9]\\d*";var FR=Gn++;Oe[FR]="\\d+";var Iae=Gn++;Oe[Iae]="\\d*[a-zA-Z-]"+Sae+"*";var x3e=Gn++;Oe[x3e]="("+Oe[MR]+")\\.("+Oe[MR]+")\\.("+Oe[MR]+")";var S3e=Gn++;Oe[S3e]="("+Oe[FR]+")\\.("+Oe[FR]+")\\.("+Oe[FR]+")";var bae=Gn++;Oe[bae]="(?:"+Oe[MR]+"|"+Oe[Iae]+")";var _ae=Gn++;Oe[_ae]="(?:"+Oe[FR]+"|"+Oe[Iae]+")";var Tae=Gn++;Oe[Tae]="(?:-("+Oe[bae]+"(?:\\."+Oe[bae]+")*))";var Cae=Gn++;Oe[Cae]="(?:-?("+Oe[_ae]+"(?:\\."+Oe[_ae]+")*))";var xae=Gn++;Oe[xae]=Sae+"+";var j4=Gn++;Oe[j4]="(?:\\+("+Oe[xae]+"(?:\\."+Oe[xae]+")*))";var Eae=Gn++,I3e="v?"+Oe[x3e]+Oe[Tae]+"?"+Oe[j4]+"?";Oe[Eae]="^"+I3e+"$";var wae="[v=\\s]*"+Oe[S3e]+Oe[Cae]+"?"+Oe[j4]+"?",kae=Gn++;Oe[kae]="^"+wae+"$";var HR=Gn++;Oe[HR]="((?:<|>)?=?)";var vH=Gn++;Oe[vH]=Oe[FR]+"|x|X|\\*";var yH=Gn++;Oe[yH]=Oe[MR]+"|x|X|\\*";var QS=Gn++;Oe[QS]="[v=\\s]*("+Oe[yH]+")(?:\\.("+Oe[yH]+")(?:\\.("+Oe[yH]+")(?:"+Oe[Tae]+")?"+Oe[j4]+"?)?)?";var BR=Gn++;Oe[BR]="[v=\\s]*("+Oe[vH]+")(?:\\.("+Oe[vH]+")(?:\\.("+Oe[vH]+")(?:"+Oe[Cae]+")?"+Oe[j4]+"?)?)?";var T3e=Gn++;Oe[T3e]="^"+Oe[HR]+"\\s*"+Oe[QS]+"$";var C3e=Gn++;Oe[C3e]="^"+Oe[HR]+"\\s*"+Oe[BR]+"$";var E3e=Gn++;Oe[E3e]="(?:^|[^\\d])(\\d{1,"+vae+"})(?:\\.(\\d{1,"+vae+"}))?(?:\\.(\\d{1,"+vae+"}))?(?:$|[^\\d])";var IH=Gn++;Oe[IH]="(?:~>?)";var qR=Gn++;Oe[qR]="(\\s*)"+Oe[IH]+"\\s+";B4[qR]=new RegExp(Oe[qR],"g");Jr[qR]=new RegExp(SH(Oe[qR]),"g");var Cxt="$1~",w3e=Gn++;Oe[w3e]="^"+Oe[IH]+Oe[QS]+"$";var k3e=Gn++;Oe[k3e]="^"+Oe[IH]+Oe[BR]+"$";var TH=Gn++;Oe[TH]="(?:\\^)";var jR=Gn++;Oe[jR]="(\\s*)"+Oe[TH]+"\\s+";B4[jR]=new RegExp(Oe[jR],"g");Jr[jR]=new RegExp(SH(Oe[jR]),"g");var Ext="$1^",R3e=Gn++;Oe[R3e]="^"+Oe[TH]+Oe[QS]+"$";var P3e=Gn++;Oe[P3e]="^"+Oe[TH]+Oe[BR]+"$";var Rae=Gn++;Oe[Rae]="^"+Oe[HR]+"\\s*("+wae+")$|^$";var Pae=Gn++;Oe[Pae]="^"+Oe[HR]+"\\s*("+I3e+")$|^$";var XS=Gn++;Oe[XS]="(\\s*)"+Oe[HR]+"\\s*("+wae+"|"+Oe[QS]+")";B4[XS]=new RegExp(Oe[XS],"g");Jr[XS]=new RegExp(SH(Oe[XS]),"g");var wxt="$1$2$3",A3e=Gn++;Oe[A3e]="^\\s*("+Oe[QS]+")\\s+-\\s+("+Oe[QS]+")\\s*$";var D3e=Gn++;Oe[D3e]="^\\s*("+Oe[BR]+")\\s+-\\s+("+Oe[BR]+")\\s*$";var N3e=Gn++;Oe[N3e]="(<|>)?=?\\s*\\*";for(nm=0;nm<Gn;nm++)Cr(nm,Oe[nm]),B4[nm]||(B4[nm]=new RegExp(Oe[nm]),Jr[nm]=new RegExp(SH(Oe[nm])));var nm;rn.parse=JS;function JS(n,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),n instanceof Kn)return n;if(typeof n!="string"||n.length>U4)return null;var t=e.loose?Jr[kae]:Jr[Eae];if(!t.test(n))return null;try{return new Kn(n,e)}catch{return null}}rn.valid=kxt;function kxt(n,e){var t=JS(n,e);return t?t.version:null}rn.clean=Rxt;function Rxt(n,e){var t=JS(n.trim().replace(/^[=v]+/,""),e);return t?t.version:null}rn.SemVer=Kn;function Kn(n,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),n instanceof Kn){if(n.loose===e.loose)return n;n=n.version}else if(typeof n!="string")throw new TypeError("Invalid Version: "+n);if(n.length>U4)throw new TypeError("version is longer than "+U4+" characters");if(!(this instanceof Kn))return new Kn(n,e);Cr("SemVer",n,e),this.options=e,this.loose=!!e.loose;var t=n.trim().match(e.loose?Jr[kae]:Jr[Eae]);if(!t)throw new TypeError("Invalid Version: "+n);if(this.raw=n,this.major=+t[1],this.minor=+t[2],this.patch=+t[3],this.major>gH||this.major<0)throw new TypeError("Invalid major version");if(this.minor>gH||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>gH||this.patch<0)throw new TypeError("Invalid patch version");t[4]?this.prerelease=t[4].split(".").map(function(r){if(/^[0-9]+$/.test(r)){var o=+r;if(o>=0&&o<gH)return o}return r}):this.prerelease=[],this.build=t[5]?t[5].split("."):[],this.format()}Kn.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};Kn.prototype.toString=function(){return this.version};Kn.prototype.compare=function(n){return Cr("SemVer.compare",this.version,this.options,n),n instanceof Kn||(n=new Kn(n,this.options)),this.compareMain(n)||this.comparePre(n)};Kn.prototype.compareMain=function(n){return n instanceof Kn||(n=new Kn(n,this.options)),UR(this.major,n.major)||UR(this.minor,n.minor)||UR(this.patch,n.patch)};Kn.prototype.comparePre=function(n){if(n instanceof Kn||(n=new Kn(n,this.options)),this.prerelease.length&&!n.prerelease.length)return-1;if(!this.prerelease.length&&n.prerelease.length)return 1;if(!this.prerelease.length&&!n.prerelease.length)return 0;var e=0;do{var t=this.prerelease[e],r=n.prerelease[e];if(Cr("prerelease compare",e,t,r),t===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(t===void 0)return-1;if(t===r)continue;return UR(t,r)}while(++e)};Kn.prototype.inc=function(n,e){switch(n){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",e),this.inc("pre",e);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var t=this.prerelease.length;--t>=0;)typeof this.prerelease[t]=="number"&&(this.prerelease[t]++,t=-2);t===-1&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+n)}return this.format(),this.raw=this.version,this};rn.inc=Pxt;function Pxt(n,e,t,r){typeof t=="string"&&(r=t,t=void 0);try{return new Kn(n,t).inc(e,r).version}catch{return null}}rn.diff=Axt;function Axt(n,e){if(Aae(n,e))return null;var t=JS(n),r=JS(e),o="";if(t.prerelease.length||r.prerelease.length){o="pre";var s="prerelease"}for(var a in t)if((a==="major"||a==="minor"||a==="patch")&&t[a]!==r[a])return o+a;return s}rn.compareIdentifiers=UR;var _3e=/^[0-9]+$/;function UR(n,e){var t=_3e.test(n),r=_3e.test(e);return t&&r&&(n=+n,e=+e),n===e?0:t&&!r?-1:r&&!t?1:n<e?-1:1}rn.rcompareIdentifiers=Dxt;function Dxt(n,e){return UR(e,n)}rn.major=Nxt;function Nxt(n,e){return new Kn(n,e).major}rn.minor=Lxt;function Lxt(n,e){return new Kn(n,e).minor}rn.patch=Oxt;function Oxt(n,e){return new Kn(n,e).patch}rn.compare=fg;function fg(n,e,t){return new Kn(n,t).compare(new Kn(e,t))}rn.compareLoose=Mxt;function Mxt(n,e){return fg(n,e,!0)}rn.rcompare=Fxt;function Fxt(n,e,t){return fg(e,n,t)}rn.sort=Uxt;function Uxt(n,e){return n.sort(function(t,r){return rn.compare(t,r,e)})}rn.rsort=Bxt;function Bxt(n,e){return n.sort(function(t,r){return rn.rcompare(t,r,e)})}rn.gt=q4;function q4(n,e,t){return fg(n,e,t)>0}rn.lt=bH;function bH(n,e,t){return fg(n,e,t)<0}rn.eq=Aae;function Aae(n,e,t){return fg(n,e,t)===0}rn.neq=L3e;function L3e(n,e,t){return fg(n,e,t)!==0}rn.gte=Dae;function Dae(n,e,t){return fg(n,e,t)>=0}rn.lte=Nae;function Nae(n,e,t){return fg(n,e,t)<=0}rn.cmp=_H;function _H(n,e,t,r){switch(e){case"===":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n===t;case"!==":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n!==t;case"":case"=":case"==":return Aae(n,t,r);case"!=":return L3e(n,t,r);case">":return q4(n,t,r);case">=":return Dae(n,t,r);case"<":return bH(n,t,r);case"<=":return Nae(n,t,r);default:throw new TypeError("Invalid operator: "+e)}}rn.Comparator=zu;function zu(n,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),n instanceof zu){if(n.loose===!!e.loose)return n;n=n.value}if(!(this instanceof zu))return new zu(n,e);n=n.trim().split(/\s+/).join(" "),Cr("comparator",n,e),this.options=e,this.loose=!!e.loose,this.parse(n),this.semver===H4?this.value="":this.value=this.operator+this.semver.version,Cr("comp",this)}var H4={};zu.prototype.parse=function(n){var e=this.options.loose?Jr[Rae]:Jr[Pae],t=n.match(e);if(!t)throw new TypeError("Invalid comparator: "+n);this.operator=t[1],this.operator==="="&&(this.operator=""),t[2]?this.semver=new Kn(t[2],this.options.loose):this.semver=H4};zu.prototype.toString=function(){return this.value};zu.prototype.test=function(n){return Cr("Comparator.test",n,this.options.loose),this.semver===H4?!0:(typeof n=="string"&&(n=new Kn(n,this.options)),_H(n,this.operator,this.semver,this.options))};zu.prototype.intersects=function(n,e){if(!(n instanceof zu))throw new TypeError("a Comparator is required");(!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1});var t;if(this.operator==="")return t=new Ui(n.value,e),xH(this.value,t,e);if(n.operator==="")return t=new Ui(this.value,e),xH(n.semver,t,e);var r=(this.operator===">="||this.operator===">")&&(n.operator===">="||n.operator===">"),o=(this.operator==="<="||this.operator==="<")&&(n.operator==="<="||n.operator==="<"),s=this.semver.version===n.semver.version,a=(this.operator===">="||this.operator==="<=")&&(n.operator===">="||n.operator==="<="),c=_H(this.semver,"<",n.semver,e)&&(this.operator===">="||this.operator===">")&&(n.operator==="<="||n.operator==="<"),l=_H(this.semver,">",n.semver,e)&&(this.operator==="<="||this.operator==="<")&&(n.operator===">="||n.operator===">");return r||o||s&&a||c||l};rn.Range=Ui;function Ui(n,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),n instanceof Ui)return n.loose===!!e.loose&&n.includePrerelease===!!e.includePrerelease?n:new Ui(n.raw,e);if(n instanceof zu)return new Ui(n.value,e);if(!(this instanceof Ui))return new Ui(n,e);if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=n.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(function(t){return this.parseRange(t.trim())},this).filter(function(t){return t.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);this.format()}Ui.prototype.format=function(){return this.range=this.set.map(function(n){return n.join(" ").trim()}).join("||").trim(),this.range};Ui.prototype.toString=function(){return this.range};Ui.prototype.parseRange=function(n){var e=this.options.loose,t=e?Jr[D3e]:Jr[A3e];n=n.replace(t,Yxt),Cr("hyphen replace",n),n=n.replace(Jr[XS],wxt),Cr("comparator trim",n,Jr[XS]),n=n.replace(Jr[qR],Cxt),n=n.replace(Jr[jR],Ext);var r=e?Jr[Rae]:Jr[Pae],o=n.split(" ").map(function(s){return jxt(s,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(o=o.filter(function(s){return!!s.match(r)})),o=o.map(function(s){return new zu(s,this.options)},this),o};Ui.prototype.intersects=function(n,e){if(!(n instanceof Ui))throw new TypeError("a Range is required");return this.set.some(function(t){return t.every(function(r){return n.set.some(function(o){return o.every(function(s){return r.intersects(s,e)})})})})};rn.toComparators=qxt;function qxt(n,e){return new Ui(n,e).set.map(function(t){return t.map(function(r){return r.value}).join(" ").trim().split(" ")})}function jxt(n,e){return Cr("comp",n,e),n=Gxt(n,e),Cr("caret",n),n=Hxt(n,e),Cr("tildes",n),n=$xt(n,e),Cr("xrange",n),n=Kxt(n,e),Cr("stars",n),n}function ic(n){return!n||n.toLowerCase()==="x"||n==="*"}function Hxt(n,e){return n.trim().split(/\s+/).map(function(t){return Vxt(t,e)}).join(" ")}function Vxt(n,e){var t=e.loose?Jr[k3e]:Jr[w3e];return n.replace(t,function(r,o,s,a,c){Cr("tilde",n,r,o,s,a,c);var l;return ic(o)?l="":ic(s)?l=">="+o+".0.0 <"+(+o+1)+".0.0":ic(a)?l=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0":c?(Cr("replaceTilde pr",c),l=">="+o+"."+s+"."+a+"-"+c+" <"+o+"."+(+s+1)+".0"):l=">="+o+"."+s+"."+a+" <"+o+"."+(+s+1)+".0",Cr("tilde return",l),l})}function Gxt(n,e){return n.trim().split(/\s+/).map(function(t){return zxt(t,e)}).join(" ")}function zxt(n,e){Cr("caret",n,e);var t=e.loose?Jr[P3e]:Jr[R3e];return n.replace(t,function(r,o,s,a,c){Cr("caret",n,r,o,s,a,c);var l;return ic(o)?l="":ic(s)?l=">="+o+".0.0 <"+(+o+1)+".0.0":ic(a)?o==="0"?l=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0":l=">="+o+"."+s+".0 <"+(+o+1)+".0.0":c?(Cr("replaceCaret pr",c),o==="0"?s==="0"?l=">="+o+"."+s+"."+a+"-"+c+" <"+o+"."+s+"."+(+a+1):l=">="+o+"."+s+"."+a+"-"+c+" <"+o+"."+(+s+1)+".0":l=">="+o+"."+s+"."+a+"-"+c+" <"+(+o+1)+".0.0"):(Cr("no pr"),o==="0"?s==="0"?l=">="+o+"."+s+"."+a+" <"+o+"."+s+"."+(+a+1):l=">="+o+"."+s+"."+a+" <"+o+"."+(+s+1)+".0":l=">="+o+"."+s+"."+a+" <"+(+o+1)+".0.0"),Cr("caret return",l),l})}function $xt(n,e){return Cr("replaceXRanges",n,e),n.split(/\s+/).map(function(t){return Wxt(t,e)}).join(" ")}function Wxt(n,e){n=n.trim();var t=e.loose?Jr[C3e]:Jr[T3e];return n.replace(t,function(r,o,s,a,c,l){Cr("xRange",n,r,o,s,a,c,l);var u=ic(s),d=u||ic(a),p=d||ic(c),f=p;return o==="="&&f&&(o=""),u?o===">"||o==="<"?r="<0.0.0":r="*":o&&f?(d&&(a=0),c=0,o===">"?(o=">=",d?(s=+s+1,a=0,c=0):(a=+a+1,c=0)):o==="<="&&(o="<",d?s=+s+1:a=+a+1),r=o+s+"."+a+"."+c):d?r=">="+s+".0.0 <"+(+s+1)+".0.0":p&&(r=">="+s+"."+a+".0 <"+s+"."+(+a+1)+".0"),Cr("xRange return",r),r})}function Kxt(n,e){return Cr("replaceStars",n,e),n.trim().replace(Jr[N3e],"")}function Yxt(n,e,t,r,o,s,a,c,l,u,d,p,f){return ic(t)?e="":ic(r)?e=">="+t+".0.0":ic(o)?e=">="+t+"."+r+".0":e=">="+e,ic(l)?c="":ic(u)?c="<"+(+l+1)+".0.0":ic(d)?c="<"+l+"."+(+u+1)+".0":p?c="<="+l+"."+u+"."+d+"-"+p:c="<="+c,(e+" "+c).trim()}Ui.prototype.test=function(n){if(!n)return!1;typeof n=="string"&&(n=new Kn(n,this.options));for(var e=0;e<this.set.length;e++)if(Qxt(this.set[e],n,this.options))return!0;return!1};function Qxt(n,e,t){for(var r=0;r<n.length;r++)if(!n[r].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(r=0;r<n.length;r++)if(Cr(n[r].semver),n[r].semver!==H4&&n[r].semver.prerelease.length>0){var o=n[r].semver;if(o.major===e.major&&o.minor===e.minor&&o.patch===e.patch)return!0}return!1}return!0}rn.satisfies=xH;function xH(n,e,t){try{e=new Ui(e,t)}catch{return!1}return e.test(n)}rn.maxSatisfying=Xxt;function Xxt(n,e,t){var r=null,o=null;try{var s=new Ui(e,t)}catch{return null}return n.forEach(function(a){s.test(a)&&(!r||o.compare(a)===-1)&&(r=a,o=new Kn(r,t))}),r}rn.minSatisfying=Jxt;function Jxt(n,e,t){var r=null,o=null;try{var s=new Ui(e,t)}catch{return null}return n.forEach(function(a){s.test(a)&&(!r||o.compare(a)===1)&&(r=a,o=new Kn(r,t))}),r}rn.minVersion=Zxt;function Zxt(n,e){n=new Ui(n,e);var t=new Kn("0.0.0");if(n.test(t)||(t=new Kn("0.0.0-0"),n.test(t)))return t;t=null;for(var r=0;r<n.set.length;++r){var o=n.set[r];o.forEach(function(s){var a=new Kn(s.semver.version);switch(s.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!t||q4(t,a))&&(t=a);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+s.operator)}})}return t&&n.test(t)?t:null}rn.validRange=eSt;function eSt(n,e){try{return new Ui(n,e).range||"*"}catch{return null}}rn.ltr=tSt;function tSt(n,e,t){return Lae(n,e,"<",t)}rn.gtr=nSt;function nSt(n,e,t){return Lae(n,e,">",t)}rn.outside=Lae;function Lae(n,e,t,r){n=new Kn(n,r),e=new Ui(e,r);var o,s,a,c,l;switch(t){case">":o=q4,s=Nae,a=bH,c=">",l=">=";break;case"<":o=bH,s=Dae,a=q4,c="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(xH(n,e,r))return!1;for(var u=0;u<e.set.length;++u){var d=e.set[u],p=null,f=null;if(d.forEach(function(m){m.semver===H4&&(m=new zu(">=0.0.0")),p=p||m,f=f||m,o(m.semver,p.semver,r)?p=m:a(m.semver,f.semver,r)&&(f=m)}),p.operator===c||p.operator===l||(!f.operator||f.operator===c)&&s(n,f.semver))return!1;if(f.operator===l&&a(n,f.semver))return!1}return!0}rn.prerelease=rSt;function rSt(n,e){var t=JS(n,e);return t&&t.prerelease.length?t.prerelease:null}rn.intersects=iSt;function iSt(n,e,t){return n=new Ui(n,t),e=new Ui(e,t),n.intersects(e)}rn.coerce=oSt;function oSt(n){if(n instanceof Kn)return n;if(typeof n!="string")return null;var e=n.match(Jr[E3e]);return e==null?null:JS(e[1]+"."+(e[2]||"0")+"."+(e[3]||"0"))}});var B3e=P((Iir,U3e)=>{var sSt=lH().wrap,Mae=1,Fae=2,Uae=4,EH=8,Hr=[],aSt=0,ka=!1,rb=[],VR,Bae;function qae(n,e){var t=n.length,r=e.length,o=[];if(t===0&&r===0)return o;for(var s=0;s<t;s++)o[s]=n[s];if(r===0)return o;for(var a=0;a<r;a++){var c=!0;for(s=0;s<t;s++)if(n[s].uid===e[a].uid){c=!1;break}c&&o.push(e[a])}return o}process._fatalException?(CH=!1,VR=function(e){var t=Hr.length;if(CH||t===0)return!1;var r=!1;CH=!0;for(var o=0;o<t;++o){var s=Hr[o];if(s.flags&EH){var a=GR&&GR[s.uid];r=s.error(a,e)||r}}return CH=!1,rb.length>0&&(Hr=rb.pop()),GR=void 0,r&&!ka},Bae=function(e,t,r){var o=[];ka=!0;for(var s=0;s<r;++s){var a=t[s];if(o[a.uid]=a.data,!!(a.flags&Mae)){var c=a.create(a.data);c!==void 0&&(o[a.uid]=c)}}return ka=!1,function(){GR=o,rb.push(Hr),Hr=qae(t,Hr),ka=!0;for(var l=0;l<r;++l)(t[l].flags&Fae)>0&&t[l].before(this,o[t[l].uid]);ka=!1;var u=e.apply(this,arguments);for(ka=!0,l=0;l<r;++l)(t[l].flags&Uae)>0&&t[l].after(this,o[t[l].uid]);return ka=!1,Hr=rb.pop(),GR=void 0,u}},sSt(process,"_fatalException",function(n){return function(t){return VR(t)||n(t)}})):(Oae=!1,VR=function(e){if(Oae)throw e;for(var t=!1,r=Hr.length,o=0;o<r;++o){var s=Hr[o];s.flags&EH&&(t=s.error(null,e)||t)}if(!t&&ka)throw e},Bae=function(e,t,r){var o=[];ka=!0;for(var s=0;s<r;++s){var a=t[s];if(o[a.uid]=a.data,!!(a.flags&Mae)){var c=a.create(a.data);c!==void 0&&(o[a.uid]=c)}}return ka=!1,function(){var l=!1,u=!1;rb.push(Hr),Hr=qae(t,Hr),ka=!0;for(var d=0;d<r;++d)(t[d].flags&Fae)>0&&t[d].before(this,o[t[d].uid]);ka=!1;var p;try{p=e.apply(this,arguments)}catch(f){l=!0;for(var d=0;d<r;++d)if(Hr[d].flags&EH)try{u=Hr[d].error(o[t[d].uid],f)||u}catch(h){throw Oae=!0,h}if(!u)throw process.removeListener("uncaughtException",VR),process._originalNextTick(function(){process.addListener("uncaughtException",VR)}),f}finally{if(!l||u){for(ka=!0,d=0;d<r;++d)(t[d].flags&Uae)>0&&t[d].after(this,o[t[d].uid]);ka=!1}Hr=rb.pop()}return p}},process.addListener("uncaughtException",VR));var CH,GR,Oae;function cSt(n,e,t){ka=!0;for(var r=0;r<t;++r){var o=e[r];o.create&&o.create(o.data)}return ka=!1,function(){rb.push(Hr),Hr=qae(e,Hr);var s=n.apply(this,arguments);return Hr=rb.pop(),s}}function lSt(n){var e=Hr.length;if(e===0)return n;for(var t=Hr.slice(),r=0;r<e;++r)if(t[r].flags>0)return Bae(n,t,e);return cSt(n,t,e)}function rm(n,e){typeof n.create=="function"&&(this.create=n.create,this.flags|=Mae),typeof n.before=="function"&&(this.before=n.before,this.flags|=Fae),typeof n.after=="function"&&(this.after=n.after,this.flags|=Uae),typeof n.error=="function"&&(this.error=n.error,this.flags|=EH),this.uid=++aSt,this.data=e===void 0?null:e}rm.prototype.create=void 0;rm.prototype.before=void 0;rm.prototype.after=void 0;rm.prototype.error=void 0;rm.prototype.data=void 0;rm.prototype.uid=0;rm.prototype.flags=0;function F3e(n,e){if(typeof n!="object"||!n)throw new TypeError("callbacks argument must be an object");return n instanceof rm?n:new rm(n,e)}function uSt(n,e){var t;n instanceof rm?t=n:t=F3e(n,e);for(var r=!1,o=0;o<Hr.length;o++)if(t===Hr[o]){r=!0;break}return r||Hr.push(t),t}function dSt(n){for(var e=0;e<Hr.length;e++)if(n===Hr[e]){Hr.splice(e,1);break}}process.createAsyncListener=F3e;process.addAsyncListener=uSt;process.removeAsyncListener=dSt;U3e.exports=lSt});var j3e=P((Cir,q3e)=>{"use strict";q3e.exports=(n,e)=>class extends n{constructor(r){var o,s;super(c);var a=this;try{r.apply(o,s)}catch(l){s[1](l)}return a;function c(l,u){o=this,s=[d,p];function d(f){return e(a,!1),l(f)}function p(f){return e(a,!1),u(f)}}}}});var K3e=P(()=>{"use strict";if(process.addAsyncListener)throw new Error("Don't require polyfill unless needed");var z3e=lH(),kH=M3e(),zc=z3e.wrap,ib=z3e.massWrap,Bi=B3e(),pSt=require("util"),fSt=kH.gte(process.version,"6.0.0"),Vae=kH.gte(process.version,"7.0.0"),mSt=kH.gte(process.version,"8.0.0"),hSt=kH.gte(process.version,"11.0.0"),im=require("net");Vae&&!im._normalizeArgs?im._normalizeArgs=function(n){if(n.length===0)return[{},null];var e=n[0],t={};typeof e=="object"&&e!==null?t=e:_St(e)?t.path=e:(t.port=e,n.length>1&&typeof n[1]=="string"&&(t.host=n[1]));var r=n[n.length-1];return typeof r!="function"?[t,null]:[t,r]}:!Vae&&!im._normalizeConnectArgs&&(im._normalizeConnectArgs=function(n){var e={};function t(o){return(o=Number(o))>=0?o:!1}typeof n[0]=="object"&&n[0]!==null?e=n[0]:typeof n[0]=="string"&&t(n[0])===!1?e.path=n[0]:(e.port=n[0],typeof n[1]=="string"&&(e.host=n[1]));var r=n[n.length-1];return typeof r=="function"?[e,r]:[e]});"_setUpListenHandle"in im.Server.prototype?zc(im.Server.prototype,"_setUpListenHandle",H3e):zc(im.Server.prototype,"_listen2",H3e);function H3e(n){return function(){this.on("connection",function(e){e._handle&&(e._handle.onread=Bi(e._handle.onread))});try{return n.apply(this,arguments)}finally{this._handle&&this._handle.onconnection&&(this._handle.onconnection=Bi(this._handle.onconnection))}}}function $3e(n){if(n&&n._handle){var e=n._handle;e._originalOnread||(e._originalOnread=e.onread),e.onread=Bi(e._originalOnread)}}zc(im.Socket.prototype,"connect",function(n){return function(){var e;mSt&&Array.isArray(arguments[0])&&Object.getOwnPropertySymbols(arguments[0]).length>0?e=arguments[0]:e=Vae?im._normalizeArgs(arguments):im._normalizeConnectArgs(arguments),e[1]&&(e[1]=Bi(e[1]));var t=n.apply(this,e);return $3e(this),t}});var gSt=require("http");zc(gSt.Agent.prototype,"addRequest",function(n){return function(e){var t=e.onSocket;return e.onSocket=Bi(function(r){return $3e(r),t.apply(this,arguments)}),n.apply(this,arguments)}});var jae=require("child_process");function V3e(n){Array.isArray(n.stdio)&&n.stdio.forEach(function(e){e&&e._handle&&(e._handle.onread=Bi(e._handle.onread),zc(e._handle,"close",RH))}),n._handle&&(n._handle.onexit=Bi(n._handle.onexit))}jae.ChildProcess?zc(jae.ChildProcess.prototype,"spawn",function(n){return function(){var e=n.apply(this,arguments);return V3e(this),e}}):ib(jae,["execFile","fork","spawn"],function(n){return function(){var e=n.apply(this,arguments);return V3e(e),e}});process._fatalException||(process._originalNextTick=process.nextTick);var $ae=[];process._nextDomainTick&&$ae.push("_nextDomainTick");process._tickDomainCallback&&$ae.push("_tickDomainCallback");ib(process,$ae,om);zc(process,"nextTick",RH);var Wae=["setTimeout","setInterval"];global.setImmediate&&Wae.push("setImmediate");var W3e=require("timers"),vSt=global.setTimeout===W3e.setTimeout;ib(W3e,Wae,RH);vSt&&ib(global,Wae,RH);var Gae=require("dns");ib(Gae,["lookup","resolve","resolve4","resolve6","resolveCname","resolveMx","resolveNs","resolveTxt","resolveSrv","reverse"],om);Gae.resolveNaptr&&zc(Gae,"resolveNaptr",om);var eI=require("fs");ib(eI,["watch","rename","truncate","chown","fchown","chmod","fchmod","stat","lstat","fstat","link","symlink","readlink","realpath","unlink","rmdir","mkdir","readdir","close","open","utimes","futimes","fsync","write","read","readFile","writeFile","appendFile","watchFile","unwatchFile","exists"],om);eI.lchown&&zc(eI,"lchown",om);eI.lchmod&&zc(eI,"lchmod",om);eI.ftruncate&&zc(eI,"ftruncate",om);var V4;try{V4=require("zlib")}catch{}V4&&V4.Deflate&&V4.Deflate.prototype&&(ZS=Object.getPrototypeOf(V4.Deflate.prototype),ZS._transform?zc(ZS,"_transform",om):ZS.write&&ZS.flush&&ZS.end&&ib(ZS,["write","flush","end"],om));var ZS,zae;try{zae=require("crypto")}catch{}zae&&(Hae=["pbkdf2","randomBytes"],hSt||Hae.push("pseudoRandomBytes"),ib(zae,Hae,om));var Hae,wH=!!global.Promise&&Promise.toString()==="function Promise() { [native code] }"&&Promise.toString.toString()==="function toString() { [native code] }";wH&&(G3e=process.addAsyncListener({create:function(){wH=!1}}),global.Promise.resolve(!0).then(function(){wH=!1}),process.removeAsyncListener(G3e));var G3e;wH&&ySt();function ySt(){var n=global.Promise;function e(a){if(!(this instanceof e))return n(a);if(typeof a!="function")return new n(a);var c,l,u=new n(d);u.__proto__=e.prototype;try{a.apply(c,l)}catch(p){l[1](p)}return u;function d(p,f){c=this,l=[m,h];function m(g){return r(u,!1),p(g)}function h(g){return r(u,!1),f(g)}}}if(pSt.inherits(e,n),zc(n.prototype,"then",s),n.prototype.chain&&zc(n.prototype,"chain",s),fSt)global.Promise=j3e()(n,r);else{var t=["all","race","reject","resolve","accept","defer"];t.forEach(function(a){typeof n[a]=="function"&&(e[a]=n[a])}),global.Promise=e}function r(a,c){(!a.__asl_wrapper||c)&&(a.__asl_wrapper=Bi(o))}function o(a,c,l,u){var d;try{return d=c.call(a,l),{returnVal:d,error:!1}}catch(p){return{errorVal:p,error:!0}}finally{d instanceof n?u.__asl_wrapper=function(){var f=d.__asl_wrapper||o;return f.apply(this,arguments)}:r(u,!0)}}function s(a){return function(){var l=this,u=a.apply(l,Array.prototype.map.call(arguments,d));return u.__asl_wrapper=function(f,m,h,g){return l.__asl_wrapper?(l.__asl_wrapper(f,function(){},null,u),u.__asl_wrapper(f,m,h,g)):o(f,m,h,g)},u;function d(p){return typeof p!="function"?p:Bi(function(f){var m=(l.__asl_wrapper||o)(this,p,f,u);if(m.error)throw m.errorVal;return m.returnVal})}}}}function om(n){var e=function(){var t,r=arguments.length-1;if(typeof arguments[r]=="function"){t=Array(arguments.length);for(var o=0;o<arguments.length-1;o++)t[o]=arguments[o];t[r]=Bi(arguments[r])}return n.apply(this,t||arguments)};switch(n.length){case 1:return function(t){return arguments.length!==1?e.apply(this,arguments):(typeof t=="function"&&(t=Bi(t)),n.call(this,t))};case 2:return function(t,r){return arguments.length!==2?e.apply(this,arguments):(typeof r=="function"&&(r=Bi(r)),n.call(this,t,r))};case 3:return function(t,r,o){return arguments.length!==3?e.apply(this,arguments):(typeof o=="function"&&(o=Bi(o)),n.call(this,t,r,o))};case 4:return function(t,r,o,s){return arguments.length!==4?e.apply(this,arguments):(typeof s=="function"&&(s=Bi(s)),n.call(this,t,r,o,s))};case 5:return function(t,r,o,s,a){return arguments.length!==5?e.apply(this,arguments):(typeof a=="function"&&(a=Bi(a)),n.call(this,t,r,o,s,a))};case 6:return function(t,r,o,s,a,c){return arguments.length!==6?e.apply(this,arguments):(typeof c=="function"&&(c=Bi(c)),n.call(this,t,r,o,s,a,c))};default:return e}}function RH(n){var e=function(){var t;if(typeof arguments[0]=="function"){t=Array(arguments.length),t[0]=Bi(arguments[0]);for(var r=1;r<arguments.length;r++)t[r]=arguments[r]}return n.apply(this,t||arguments)};switch(n.length){case 1:return function(t){return arguments.length!==1?e.apply(this,arguments):(typeof t=="function"&&(t=Bi(t)),n.call(this,t))};case 2:return function(t,r){return arguments.length!==2?e.apply(this,arguments):(typeof t=="function"&&(t=Bi(t)),n.call(this,t,r))};case 3:return function(t,r,o){return arguments.length!==3?e.apply(this,arguments):(typeof t=="function"&&(t=Bi(t)),n.call(this,t,r,o))};case 4:return function(t,r,o,s){return arguments.length!==4?e.apply(this,arguments):(typeof t=="function"&&(t=Bi(t)),n.call(this,t,r,o,s))};case 5:return function(t,r,o,s,a){return arguments.length!==5?e.apply(this,arguments):(typeof t=="function"&&(t=Bi(t)),n.call(this,t,r,o,s,a))};case 6:return function(t,r,o,s,a,c){return arguments.length!==6?e.apply(this,arguments):(typeof t=="function"&&(t=Bi(t)),n.call(this,t,r,o,s,a,c))};default:return e}}function bSt(n){return(n=Number(n))>=0?n:!1}function _St(n){return typeof n=="string"&&bSt(n)===!1}});var Z3e=P((kir,J3e)=>{"use strict";var mg=require("assert"),xSt=pH(),G4="cls@contexts",Kae="error@context";process.addAsyncListener||K3e();function op(n){this.name=n,this.active=null,this._set=[],this.id=null}op.prototype.set=function(n,e){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return this.active[n]=e,e};op.prototype.get=function(n){if(this.active)return this.active[n]};op.prototype.createContext=function(){return Object.create(this.active)};op.prototype.run=function(n){var e=this.createContext();this.enter(e);try{return n(e),e}catch(t){throw t&&(t[Kae]=e),t}finally{this.exit(e)}};op.prototype.runAndReturn=function(n){var e;return this.run(function(t){e=n(t)}),e};op.prototype.bind=function(n,e){e||(this.active?e=this.active:e=this.createContext());var t=this;return function(){t.enter(e);try{return n.apply(this,arguments)}catch(r){throw r&&(r[Kae]=e),r}finally{t.exit(e)}}};op.prototype.enter=function(n){mg.ok(n,"context must be provided for entering"),this._set.push(this.active),this.active=n};op.prototype.exit=function(n){if(mg.ok(n,"context must be provided for exiting"),this.active===n){mg.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}var e=this._set.lastIndexOf(n);mg.ok(e>=0,"context not currently entered; can't exit"),mg.ok(e,"can't remove top context"),this._set.splice(e,1)};op.prototype.bindEmitter=function(n){mg.ok(n.on&&n.addListener&&n.emit,"can only bind real EEs");var e=this,t="context@"+this.name;function r(s){s&&(s[G4]||(s[G4]=Object.create(null)),s[G4][t]={namespace:e,context:e.active})}function o(s){if(!(s&&s[G4]))return s;var a=s,c=s[G4];return Object.keys(c).forEach(function(l){var u=c[l];a=u.namespace.bind(a,u.context)}),a}xSt(n,r,o)};op.prototype.fromException=function(n){return n[Kae]};function Y3e(n){return process.namespaces[n]}function SSt(n){mg.ok(n,"namespace must be given a name!");var e=new op(n);return e.id=process.addAsyncListener({create:function(){return e.active},before:function(t,r){r&&e.enter(r)},after:function(t,r){r&&e.exit(r)},error:function(t){t&&e.exit(t)}}),process.namespaces[n]=e,e}function Q3e(n){var e=Y3e(n);mg.ok(e,"can't delete nonexistent namespace!"),mg.ok(e.id,"don't assign to process.namespaces directly!"),process.removeAsyncListener(e.id),process.namespaces[n]=null}function X3e(){process.namespaces&&Object.keys(process.namespaces).forEach(function(n){Q3e(n)}),process.namespaces=Object.create(null)}process.namespaces||X3e();J3e.exports={getNamespace:Y3e,createNamespace:SSt,destroyNamespace:Q3e,reset:X3e}});var ob=P(AH=>{"use strict";Object.defineProperty(AH,"__esModule",{value:!0});AH.CorrelationContextManager=void 0;var zR=li(),ISt=Kj(),tI=Yj(),Yae=_se(),eFe=qse(),PH=ra(),TSt=function(){function n(){}return n.getCurrentContext=function(){if(!n.enabled)return null;var e=n.session.get(n.CONTEXT_NAME);return e===void 0?null:e},n.generateContextObject=function(e,t,r,o,s,a){return t=t||e,this.enabled?{operation:{name:r,id:e,parentId:t,traceparent:s,tracestate:a},customProperties:new CSt(o)}:null},n.spanToContextObject=function(e,t,r){var o=new tI;return o.traceId=e.traceId,o.spanId=e.spanId,o.traceFlag=tI.formatOpenTelemetryTraceFlags(e.traceFlags)||tI.DEFAULT_TRACE_FLAG,o.parentId=t,n.generateContextObject(o.traceId,o.parentId,r,null,o)},n.runWithContext=function(e,t){var r;if(n.enabled)try{return n.session.bind(t,(r={},r[n.CONTEXT_NAME]=e,r))()}catch(o){zR.warn("Error binding to session context",PH.dumpObj(o))}return t()},n.wrapEmitter=function(e){if(n.enabled)try{n.session.bindEmitter(e)}catch(t){zR.warn("Error binding to session context",PH.dumpObj(t))}},n.wrapCallback=function(e,t){var r;if(n.enabled)try{return n.session.bind(e,t?(r={},r[n.CONTEXT_NAME]=t,r):void 0)}catch(o){zR.warn("Error binding to session context",PH.dumpObj(o))}return e},n.enable=function(e){if(!this.enabled){if(!this.isNodeVersionCompatible()){this.enabled=!1;return}n.hasEverEnabled||(this.forceClsHooked=e,this.hasEverEnabled=!0,typeof this.cls>"u"&&(n.forceClsHooked===!0||n.forceClsHooked===void 0&&n.shouldUseClsHooked()?this.cls=b3e():this.cls=Z3e()),n.session=this.cls.createNamespace("AI-CLS-Session"),ISt.registerContextPreservation(function(t){try{return n.session.bind(t)}catch(r){zR.warn("Error binding to session context",PH.dumpObj(r))}})),this.enabled=!0}},n.startOperation=function(e,t){var r=e&&e.traceContext||null,o=e&&e.spanContext?e:null,s=e&&e.traceId?e:null,a=e&&e.headers;if(o)return this.spanToContextObject(o.spanContext(),o.parentSpanId,o.name);if(s)return this.spanToContextObject(s,"|"+s.traceId+"."+s.spanId+".",typeof t=="string"?t:"");var c=typeof t=="string"?t:"";if(r){var l=null,u=null;if(c=r.attributes.OperationName||c,t){var d=t;d.headers&&(d.headers.traceparent?l=new tI(d.headers.traceparent):d.headers["request-id"]&&(l=new tI(null,d.headers["request-id"])),d.headers.tracestate&&(u=new Yae(d.headers.tracestate)))}l||(l=new tI(r.traceParent||r.traceparent)),u||(u=new Yae(r.traceState||r.tracestate));var p=void 0;if(typeof t=="object"){var f=new eFe(t);p=f.getCorrelationContextHeader(),c=f.getOperationName({})}var m=n.generateContextObject(l.traceId,l.parentId,c,p,l,u);return m}if(a){var l=new tI(a.traceparent?a.traceparent.toString():null),u=new Yae(a.tracestate?a.tracestate.toString():null),f=new eFe(e),m=n.generateContextObject(l.traceId,l.parentId,f.getOperationName({}),f.getCorrelationContextHeader(),l,u);return m}return zR.warn("startOperation was called with invalid arguments",arguments),null},n.disable=function(){this.enabled=!1},n.reset=function(){n.hasEverEnabled&&(n.session=null,n.session=this.cls.createNamespace("AI-CLS-Session"))},n.isNodeVersionCompatible=function(){var e=process.versions.node.split(".");return parseInt(e[0])>3||parseInt(e[0])>2&&parseInt(e[1])>2},n.shouldUseClsHooked=function(){var e=process.versions.node.split(".");return parseInt(e[0])>8||parseInt(e[0])>=8&&parseInt(e[1])>=2},n.canUseClsHooked=function(){var e=process.versions.node.split("."),t=parseInt(e[0])>8||parseInt(e[0])>=8&&parseInt(e[1])>=0,r=parseInt(e[0])<8||parseInt(e[0])<=8&&parseInt(e[1])<2,o=parseInt(e[0])>4||parseInt(e[0])>=4&&parseInt(e[1])>=7;return!(t&&r)&&o},n.enabled=!1,n.hasEverEnabled=!1,n.forceClsHooked=void 0,n.CONTEXT_NAME="ApplicationInsights-Context",n}();AH.CorrelationContextManager=TSt;var CSt=function(){function n(e){this.props=[],this.addHeaderData(e)}return n.prototype.addHeaderData=function(e){var t=e?e.split(", "):[];this.props=t.map(function(r){var o=r.split("=");return{key:o[0],value:o[1]}}).concat(this.props)},n.prototype.serializeToHeader=function(){return this.props.map(function(e){return e.key+"="+e.value}).join(", ")},n.prototype.getProperty=function(e){for(var t=0;t<this.props.length;++t){var r=this.props[t];if(r.key===e)return r.value}},n.prototype.setProperty=function(e,t){if(n.bannedCharacters.test(e)||n.bannedCharacters.test(t)){zR.warn("Correlation context property keys and values must not contain ',' or '='. setProperty was called with key: "+e+" and value: "+t);return}for(var r=0;r<this.props.length;++r){var o=this.props[r];if(o.key===e){o.value=t;return}}this.props.push({key:e,value:t})},n.bannedCharacters=/[,=]/,n}()});var tFe=P($R=>{"use strict";Object.defineProperty($R,"__esModule",{value:!0});$R.dispose=$R.enable=void 0;var DH=Ea(),ESt=Oi(),NH=no(),sb=[],Qae=function(n){var e=n.data.message;sb.forEach(function(t){e instanceof Error&&!t.config.enableLoggerErrorToTrace?t.trackException({exception:e}):e instanceof Error?t.trackTrace({message:e.toString(),severity:n.data.stderr?DH.SeverityLevel.Error:DH.SeverityLevel.Information}):(e.lastIndexOf(`
`)==e.length-1&&(e=e.substring(0,e.length-1)),t.trackTrace({message:e,severity:n.data.stderr?DH.SeverityLevel.Warning:DH.SeverityLevel.Information}))})};function wSt(n,e){if(n){var t=sb.find(function(r){return r==e});if(t)return;sb.length===0&&NH.channel.subscribe("console",Qae,NH.trueFilter,function(r,o){var s=e.getStatsbeat();s&&s.addInstrumentation(ESt.StatsbeatInstrumentation.CONSOLE)}),sb.push(e)}else sb=sb.filter(function(r){return r!=e}),sb.length===0&&NH.channel.unsubscribe("console",Qae)}$R.enable=wSt;function kSt(){NH.channel.unsubscribe("console",Qae),sb=[]}$R.dispose=kSt});var nFe=P(KR=>{"use strict";Object.defineProperty(KR,"__esModule",{value:!0});KR.dispose=KR.enable=void 0;var WR=Ea(),RSt=Oi(),LH=no(),ab=[],PSt={10:WR.SeverityLevel.Verbose,20:WR.SeverityLevel.Verbose,30:WR.SeverityLevel.Information,40:WR.SeverityLevel.Warning,50:WR.SeverityLevel.Error,60:WR.SeverityLevel.Critical},Xae=function(n){var e=n.data.result,t=PSt[n.data.level];ab.forEach(function(r){try{var o=JSON.parse(e);if(o.err){var s=new Error(o.err.message);if(s.name=o.err.name,s.stack=o.err.stack,r.config.enableLoggerErrorToTrace){r.trackTrace({message:e,severity:t});return}r.trackException({exception:s});return}}catch{}r.trackTrace({message:e,severity:t})})};function ASt(n,e){if(n){var t=ab.find(function(r){return r==e});if(t)return;ab.length===0&&LH.channel.subscribe("bunyan",Xae,LH.trueFilter,function(r,o){var s=e.getStatsbeat();s&&s.addInstrumentation(RSt.StatsbeatInstrumentation.BUNYAN)}),ab.push(e)}else ab=ab.filter(function(r){return r!=e}),ab.length===0&&LH.channel.unsubscribe("bunyan",Xae)}KR.enable=ASt;function DSt(){LH.channel.unsubscribe("bunyan",Xae),ab=[]}KR.dispose=DSt});var rFe=P(YR=>{"use strict";Object.defineProperty(YR,"__esModule",{value:!0});YR.dispose=YR.enable=void 0;var NSt=Oi(),sa=Ea(),OH=no(),cb=[],LSt={syslog:function(n){var e={emerg:sa.SeverityLevel.Critical,alert:sa.SeverityLevel.Critical,crit:sa.SeverityLevel.Critical,error:sa.SeverityLevel.Error,warning:sa.SeverityLevel.Warning,notice:sa.SeverityLevel.Information,info:sa.SeverityLevel.Information,debug:sa.SeverityLevel.Verbose};return e[n]===void 0?sa.SeverityLevel.Information:e[n]},npm:function(n){var e={error:sa.SeverityLevel.Error,warn:sa.SeverityLevel.Warning,info:sa.SeverityLevel.Information,verbose:sa.SeverityLevel.Verbose,debug:sa.SeverityLevel.Verbose,silly:sa.SeverityLevel.Verbose};return e[n]===void 0?sa.SeverityLevel.Information:e[n]},unknown:function(n){return sa.SeverityLevel.Information}},Jae=function(n){var e=n.data.message,t=LSt[n.data.levelKind](n.data.level);cb.forEach(function(r){e instanceof Error&&!r.config.enableLoggerErrorToTrace?r.trackException({exception:e,properties:n.data.meta}):e instanceof Error?r.trackTrace({message:e.toString(),severity:t,properties:n.data.meta}):r.trackTrace({message:e,severity:t,properties:n.data.meta})})};function OSt(n,e){if(n){var t=cb.find(function(r){return r==e});if(t)return;cb.length===0&&OH.channel.subscribe("winston",Jae,OH.trueFilter,function(r,o){var s=e.getStatsbeat();s&&s.addInstrumentation(NSt.StatsbeatInstrumentation.WINSTON)}),cb.push(e)}else cb=cb.filter(function(r){return r!=e}),cb.length===0&&OH.channel.unsubscribe("winston",Jae)}YR.enable=OSt;function MSt(){OH.channel.unsubscribe("winston",Jae),cb=[]}YR.dispose=MSt});var oFe=P((Nir,iFe)=>{"use strict";var FSt=Kj(),USt=function(){function n(e){if(n.INSTANCE)throw new Error("Console logging adapter tracking should be configured from the applicationInsights object");this._client=e,n.INSTANCE=this}return n.prototype.enable=function(e,t){FSt.IsInitialized&&(tFe().enable(e&&t,this._client),nFe().enable(e,this._client),rFe().enable(e,this._client))},n.prototype.isInitialized=function(){return this._isInitialized},n.prototype.dispose=function(){n.INSTANCE=null,this.enable(!1,!1)},n._methodNames=["debug","info","log","warn","error"],n}();iFe.exports=USt});var aFe=P((Lir,sFe)=>{"use strict";var BSt=function(){function n(e){if(n.INSTANCE)throw new Error("Exception tracking should be configured from the applicationInsights object");n.INSTANCE=this,this._client=e;var t=process.versions.node.split(".");n._canUseUncaughtExceptionMonitor=parseInt(t[0])>13||parseInt(t[0])===13&&parseInt(t[1])>=7}return n.prototype.isInitialized=function(){return this._isInitialized},n.prototype.enable=function(e){var t=this;if(e){if(this._isInitialized=!0,!this._exceptionListenerHandle){var r=function(o,s,a){a===void 0&&(a=new Error(n._FALLBACK_ERROR_MESSAGE));var c={exception:a};c.contextObjects={},c.contextObjects.Error=a,t._client.trackException(c),t._client.flush({isAppCrashing:!0}),o&&s&&process.listeners(s).length===1&&(console.error(a),process.exit(1))};n._canUseUncaughtExceptionMonitor?(this._exceptionListenerHandle=r.bind(this,!1,void 0),process.on(n.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle)):(this._exceptionListenerHandle=r.bind(this,!0,n.UNCAUGHT_EXCEPTION_HANDLER_NAME),this._rejectionListenerHandle=r.bind(this,!1,void 0),process.on(n.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.on(n.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle))}}else this._exceptionListenerHandle&&(n._canUseUncaughtExceptionMonitor?process.removeListener(n.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle):(process.removeListener(n.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.removeListener(n.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle)),this._exceptionListenerHandle=void 0,this._rejectionListenerHandle=void 0,delete this._exceptionListenerHandle,delete this._rejectionListenerHandle)},n.prototype.dispose=function(){n.INSTANCE=null,this.enable(!1),this._isInitialized=!1},n.INSTANCE=null,n.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME="uncaughtExceptionMonitor",n.UNCAUGHT_EXCEPTION_HANDLER_NAME="uncaughtException",n.UNHANDLED_REJECTION_HANDLER_NAME="unhandledRejection",n._RETHROW_EXIT_MESSAGE="Application Insights Rethrow Exception Handler",n._FALLBACK_ERROR_MESSAGE="A promise was rejected without providing an error. Application Insights generated this error stack for you.",n._canUseUncaughtExceptionMonitor=!1,n}();sFe.exports=BSt});var FH=P((Oir,cFe)=>{"use strict";var MH=require("os"),$u=Oi(),qSt=function(){function n(e,t,r){t===void 0&&(t=6e4),r===void 0&&(r=!1),this._lastIntervalRequestExecutionTime=0,this._lastIntervalDependencyExecutionTime=0,n.INSTANCE||(n.INSTANCE=this),this._lastRequests={totalRequestCount:0,totalFailedRequestCount:0,time:0},this._lastDependencies={totalDependencyCount:0,totalFailedDependencyCount:0,time:0},this._lastExceptions={totalExceptionCount:0,time:0},this._isInitialized=!1,this._client=e,this._collectionInterval=t,this._enableLiveMetricsCounters=r}return n.prototype.enable=function(e,t){var r=this;this._isEnabled=e,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),e?this._handle||(this._lastCpus=MH.cpus(),this._lastRequests={totalRequestCount:n._totalRequestCount,totalFailedRequestCount:n._totalFailedRequestCount,time:+new Date},this._lastDependencies={totalDependencyCount:n._totalDependencyCount,totalFailedDependencyCount:n._totalFailedDependencyCount,time:+new Date},this._lastExceptions={totalExceptionCount:n._totalExceptionCount,time:+new Date},typeof process.cpuUsage=="function"&&(this._lastAppCpuUsage=process.cpuUsage()),this._lastHrtime=process.hrtime(),this._collectionInterval=t||this._collectionInterval,this._handle=setInterval(function(){return r.trackPerformance()},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},n.countRequest=function(e,t){var r;if(n.isEnabled()){if(typeof e=="string")r=+new Date("1970-01-01T"+e+"Z");else if(typeof e=="number")r=e;else return;n._intervalRequestExecutionTime+=r,t===!1&&n._totalFailedRequestCount++,n._totalRequestCount++}},n.countException=function(){n._totalExceptionCount++},n.countDependency=function(e,t){var r;if(n.isEnabled()){if(typeof e=="string")r=+new Date("1970-01-01T"+e+"Z");else if(typeof e=="number")r=e;else return;n._intervalDependencyExecutionTime+=r,t===!1&&n._totalFailedDependencyCount++,n._totalDependencyCount++}},n.prototype.isInitialized=function(){return this._isInitialized},n.isEnabled=function(){return n.INSTANCE&&n.INSTANCE._isEnabled},n.prototype.trackPerformance=function(){this._trackCpu(),this._trackMemory(),this._trackNetwork(),this._trackDependencyRate(),this._trackExceptionRate()},n.prototype._trackCpu=function(){var e=MH.cpus();if(e&&e.length&&this._lastCpus&&e.length===this._lastCpus.length){for(var t=0,r=0,o=0,s=0,a=0,c=0;e&&c<e.length;c++){var l=e[c],u=this._lastCpus[c],d="% cpu("+c+") ",p=l.model,f=l.speed,m=l.times,h=u.times,g=m.user-h.user||0;t+=g;var y=m.sys-h.sys||0;r+=y;var b=m.nice-h.nice||0;o+=b;var _=m.idle-h.idle||0;s+=_;var x=m.irq-h.irq||0;a+=x}var I=void 0;if(typeof process.cpuUsage=="function"){var S=process.cpuUsage(),w=process.hrtime(),R=S.user-this._lastAppCpuUsage.user+(S.system-this._lastAppCpuUsage.system)||0;if(typeof this._lastHrtime<"u"&&this._lastHrtime.length===2){var k=(w[0]-this._lastHrtime[0])*1e6+(w[1]-this._lastHrtime[1])/1e3||0;I=100*R/(k*e.length)}this._lastAppCpuUsage=S,this._lastHrtime=w}var V=t+r+o+s+a||1;this._client.trackMetric({name:$u.PerformanceCounter.PROCESSOR_TIME,value:(V-s)/V*100}),this._client.trackMetric({name:$u.PerformanceCounter.PROCESS_TIME,value:I||t/V*100})}this._lastCpus=e},n.prototype._trackMemory=function(){var e=MH.freemem(),t=process.memoryUsage().rss,r=MH.totalmem()-e;this._client.trackMetric({name:$u.PerformanceCounter.PRIVATE_BYTES,value:t}),this._client.trackMetric({name:$u.PerformanceCounter.AVAILABLE_BYTES,value:e}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:$u.QuickPulseCounter.COMMITTED_BYTES,value:r})},n.prototype._trackNetwork=function(){var e=this._lastRequests,t={totalRequestCount:n._totalRequestCount,totalFailedRequestCount:n._totalFailedRequestCount,time:+new Date},r=t.totalRequestCount-e.totalRequestCount||0,o=t.totalFailedRequestCount-e.totalFailedRequestCount||0,s=t.time-e.time,a=s/1e3,c=(n._intervalRequestExecutionTime-this._lastIntervalRequestExecutionTime)/r||0;if(this._lastIntervalRequestExecutionTime=n._intervalRequestExecutionTime,s>0){var l=r/a,u=o/a;this._client.trackMetric({name:$u.PerformanceCounter.REQUEST_RATE,value:l}),(!this._enableLiveMetricsCounters||r>0)&&this._client.trackMetric({name:$u.PerformanceCounter.REQUEST_DURATION,value:c}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:$u.QuickPulseCounter.REQUEST_FAILURE_RATE,value:u})}this._lastRequests=t},n.prototype._trackDependencyRate=function(){if(this._enableLiveMetricsCounters){var e=this._lastDependencies,t={totalDependencyCount:n._totalDependencyCount,totalFailedDependencyCount:n._totalFailedDependencyCount,time:+new Date},r=t.totalDependencyCount-e.totalDependencyCount||0,o=t.totalFailedDependencyCount-e.totalFailedDependencyCount||0,s=t.time-e.time,a=s/1e3,c=(n._intervalDependencyExecutionTime-this._lastIntervalDependencyExecutionTime)/r||0;if(this._lastIntervalDependencyExecutionTime=n._intervalDependencyExecutionTime,s>0){var l=r/a,u=o/a;this._client.trackMetric({name:$u.QuickPulseCounter.DEPENDENCY_RATE,value:l}),this._client.trackMetric({name:$u.QuickPulseCounter.DEPENDENCY_FAILURE_RATE,value:u}),(!this._enableLiveMetricsCounters||r>0)&&this._client.trackMetric({name:$u.QuickPulseCounter.DEPENDENCY_DURATION,value:c})}this._lastDependencies=t}},n.prototype._trackExceptionRate=function(){if(this._enableLiveMetricsCounters){var e=this._lastExceptions,t={totalExceptionCount:n._totalExceptionCount,time:+new Date},r=t.totalExceptionCount-e.totalExceptionCount||0,o=t.time-e.time,s=o/1e3;if(o>0){var a=r/s;this._client.trackMetric({name:$u.QuickPulseCounter.EXCEPTION_RATE,value:a})}this._lastExceptions=t}},n.prototype.dispose=function(){n.INSTANCE=null,this.enable(!1),this._isInitialized=!1},n._totalRequestCount=0,n._totalFailedRequestCount=0,n._totalDependencyCount=0,n._totalFailedDependencyCount=0,n._totalExceptionCount=0,n._intervalDependencyExecutionTime=0,n._intervalRequestExecutionTime=0,n}();cFe.exports=qSt});var lFe=P(UH=>{"use strict";Object.defineProperty(UH,"__esModule",{value:!0});UH.AggregatedMetricCounter=void 0;var jSt=function(){function n(e){this.dimensions=e,this.totalCount=0,this.lastTotalCount=0,this.intervalExecutionTime=0,this.lastTime=+new Date,this.lastIntervalExecutionTime=0}return n}();UH.AggregatedMetricCounter=jSt});var uFe=P(BH=>{"use strict";Object.defineProperty(BH,"__esModule",{value:!0});BH.PreaggregatedMetricPropertyNames=void 0;BH.PreaggregatedMetricPropertyNames={cloudRoleInstance:"cloud/roleInstance",cloudRoleName:"cloud/roleName",operationSynthetic:"operation/synthetic",requestSuccess:"Request.Success",requestResultCode:"request/resultCode",dependencyType:"Dependency.Type",dependencyTarget:"dependency/target",dependencySuccess:"Dependency.Success",dependencyResultCode:"dependency/resultCode",traceSeverityLevel:"trace/severityLevel"}});var ece=P((Zae,dFe)=>{"use strict";var jH=Zae&&Zae.__assign||function(){return jH=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o])}return n},jH.apply(this,arguments)},qH=Oi(),HSt=lFe(),VSt=uFe(),GSt=function(){function n(e,t){t===void 0&&(t=6e4),n.INSTANCE||(n.INSTANCE=this),this._isInitialized=!1,n._dependencyCountersCollection=[],n._requestCountersCollection=[],n._exceptionCountersCollection=[],n._traceCountersCollection=[],this._client=e,this._collectionInterval=t}return n.prototype.enable=function(e,t){var r=this;this._isEnabled=e,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),e?this._handle||(this._collectionInterval=t||this._collectionInterval,this._handle=setInterval(function(){return r.trackPreAggregatedMetrics()},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},n.countException=function(e){if(n.isEnabled()){var t=n._getAggregatedCounter(e,this._exceptionCountersCollection);t.totalCount++}},n.countTrace=function(e){if(n.isEnabled()){var t=n._getAggregatedCounter(e,this._traceCountersCollection);t.totalCount++}},n.countRequest=function(e,t){if(n.isEnabled()){var r,o=n._getAggregatedCounter(t,this._requestCountersCollection);if(typeof e=="string")r=+new Date("1970-01-01T"+e+"Z");else if(typeof e=="number")r=e;else return;o.intervalExecutionTime+=r,o.totalCount++}},n.countDependency=function(e,t){if(n.isEnabled()){var r=n._getAggregatedCounter(t,this._dependencyCountersCollection),o;if(typeof e=="string")o=+new Date("1970-01-01T"+e+"Z");else if(typeof e=="number")o=e;else return;r.intervalExecutionTime+=o,r.totalCount++}},n.prototype.isInitialized=function(){return this._isInitialized},n.isEnabled=function(){return n.INSTANCE&&n.INSTANCE._isEnabled},n.prototype.trackPreAggregatedMetrics=function(){this._trackRequestMetrics(),this._trackDependencyMetrics(),this._trackExceptionMetrics(),this._trackTraceMetrics()},n._getAggregatedCounter=function(e,t){for(var r=!1,o=0;o<t.length;o++){if(e===t[o].dimensions)return t[o];if(Object.keys(e).length===Object.keys(t[o].dimensions).length){for(var s in e)if(e[s]!=t[o].dimensions[s]){r=!0;break}if(!r)return t[o];r=!1}}var a=new HSt.AggregatedMetricCounter(e);return t.push(a),a},n.prototype._trackRequestMetrics=function(){for(var e=0;e<n._requestCountersCollection.length;e++){var t=n._requestCountersCollection[e];t.time=+new Date;var r=t.totalCount-t.lastTotalCount||0,o=t.time-t.lastTime,s=(t.intervalExecutionTime-t.lastIntervalExecutionTime)/r||0;t.lastIntervalExecutionTime=t.intervalExecutionTime,o>0&&r>0&&this._trackPreAggregatedMetric({name:"Server response time",dimensions:t.dimensions,value:s,count:r,aggregationInterval:o,metricType:qH.MetricId.REQUESTS_DURATION}),t.lastTotalCount=t.totalCount,t.lastTime=t.time}},n.prototype._trackDependencyMetrics=function(){for(var e=0;e<n._dependencyCountersCollection.length;e++){var t=n._dependencyCountersCollection[e];t.time=+new Date;var r=t.totalCount-t.lastTotalCount||0,o=t.time-t.lastTime,s=(t.intervalExecutionTime-t.lastIntervalExecutionTime)/r||0;t.lastIntervalExecutionTime=t.intervalExecutionTime,o>0&&r>0&&this._trackPreAggregatedMetric({name:"Dependency duration",dimensions:t.dimensions,value:s,count:r,aggregationInterval:o,metricType:qH.MetricId.DEPENDENCIES_DURATION}),t.lastTotalCount=t.totalCount,t.lastTime=t.time}},n.prototype._trackExceptionMetrics=function(){for(var e=0;e<n._exceptionCountersCollection.length;e++){var t=n._exceptionCountersCollection[e];t.time=+new Date;var r=t.totalCount-t.lastTotalCount||0,o=t.time-t.lastTime;o>0&&r>0&&this._trackPreAggregatedMetric({name:"Exceptions",dimensions:t.dimensions,value:r,count:r,aggregationInterval:o,metricType:qH.MetricId.EXCEPTIONS_COUNT}),t.lastTotalCount=t.totalCount,t.lastTime=t.time}},n.prototype._trackTraceMetrics=function(){for(var e=0;e<n._traceCountersCollection.length;e++){var t=n._traceCountersCollection[e];t.time=+new Date;var r=t.totalCount-t.lastTotalCount||0,o=t.time-t.lastTime;o>0&&r>0&&this._trackPreAggregatedMetric({name:"Traces",dimensions:t.dimensions,value:r,count:r,aggregationInterval:o,metricType:qH.MetricId.TRACES_COUNT}),t.lastTotalCount=t.totalCount,t.lastTime=t.time}},n.prototype._trackPreAggregatedMetric=function(e){var t={};for(var r in e.dimensions)t[VSt.PreaggregatedMetricPropertyNames[r]]=e.dimensions[r];t=jH(jH({},t),{"_MS.MetricId":e.metricType,"_MS.AggregationIntervalMs":String(e.aggregationInterval),"_MS.IsAutocollected":"True"});var o={name:e.name,value:e.value,count:e.count,properties:t,kind:"Aggregation"};this._client.trackMetric(o)},n.prototype.dispose=function(){n.INSTANCE=null,this.enable(!1),this._isInitialized=!1},n}();dFe.exports=GSt});var QR=P((Uir,pFe)=>{"use strict";var hg=require("os"),zSt=require("fs"),$St=require("path"),WSt=Ea(),KSt=Oi(),YSt=li(),QSt=function(){function n(e){this.keys=new WSt.ContextTagKeys,this.tags={},this._loadApplicationContext(e),this._loadDeviceContext(),this._loadInternalContext()}return n.prototype._loadApplicationContext=function(e){try{if(e=e||$St.resolve(__dirname,"../../../../package.json"),!n.appVersion[e]){n.appVersion[e]="unknown";var t=JSON.parse(zSt.readFileSync(e,"utf8"));t&&typeof t.version=="string"&&(n.appVersion[e]=t.version)}this.tags[this.keys.applicationVersion]=n.appVersion[e]}catch(r){YSt.info("Failed to read app version: ",r)}},n.prototype._loadDeviceContext=function(){var e=hg&&hg.hostname(),t=n.DefaultRoleName;process.env.WEBSITE_SITE_NAME&&(t=process.env.WEBSITE_SITE_NAME),process.env.WEBSITE_INSTANCE_ID&&(e=process.env.WEBSITE_INSTANCE_ID),this.tags[this.keys.deviceId]="",this.tags[this.keys.cloudRoleInstance]=e,this.tags[this.keys.deviceOSVersion]=hg&&hg.type()+" "+hg.release(),this.tags[this.keys.cloudRole]=t,this.tags["ai.device.osArchitecture"]=hg&&hg.arch(),this.tags["ai.device.osPlatform"]=hg&&hg.platform()},n.prototype._loadInternalContext=function(){n.sdkVersion=KSt.APPLICATION_INSIGHTS_SDK_VERSION,this.tags[this.keys.internalSdkVersion]="node:"+n.sdkVersion},n.DefaultRoleName="Web",n.appVersion={},n.sdkVersion=null,n}();pFe.exports=QSt});var hFe=P((Bir,mFe)=>{"use strict";var XSt=require("crypto"),fFe=require("os"),JSt=Oi(),ZSt=QR(),eIt=function(){function n(e){this._collectionInterval=9e5,n.INSTANCE||(n.INSTANCE=this),this._isInitialized=!1,this._client=e}return n.prototype.enable=function(e){var t=this;this._isEnabled=e,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),e?this._handle||(this._handle=setInterval(function(){return t.trackHeartBeat(t._client.config,function(){})},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=null)},n.prototype.isInitialized=function(){return this._isInitialized},n.isEnabled=function(){return n.INSTANCE&&n.INSTANCE._isEnabled},n.prototype.trackHeartBeat=function(e,t){var r={},o=ZSt.sdkVersion;r.sdkVersion=o,r.osType=fFe.type(),r.osVersion=fFe.release(),this._uniqueProcessId||(this._uniqueProcessId=XSt.randomBytes(16).toString("hex")),r.processSessionId=this._uniqueProcessId,process.env.WEBSITE_SITE_NAME&&(r.appSrv_SiteName=process.env.WEBSITE_SITE_NAME),process.env.WEBSITE_HOME_STAMPNAME&&(r.appSrv_wsStamp=process.env.WEBSITE_HOME_STAMPNAME),process.env.WEBSITE_HOSTNAME&&(r.appSrv_wsHost=process.env.WEBSITE_HOSTNAME),process.env.WEBSITE_OWNER_NAME&&(r.appSrv_wsOwner=process.env.WEBSITE_OWNER_NAME),process.env.WEBSITE_RESOURCE_GROUP&&(r.appSrv_ResourceGroup=process.env.WEBSITE_RESOURCE_GROUP),process.env.WEBSITE_SLOT_NAME&&(r.appSrv_SlotName=process.env.WEBSITE_SLOT_NAME),this._client.trackMetric({name:JSt.HeartBeatMetricName,value:0,properties:r}),t()},n.prototype.dispose=function(){n.INSTANCE=null,this.enable(!1),this._isInitialized=!1},n}();mFe.exports=eIt});var gFe=P(on=>{"use strict";Object.defineProperty(on,"__esModule",{value:!0});on.isContentTypeHeaderHtml=on.insertSnippetByIndex=on.getContentEncodingFromHeaders=on.isSupportedContentEncoding=on.findBufferEncodingType=on.isBufferType=on.getBrotliDecompressSync=on.getBrotliDecompressAsync=on.getBrotliCompressSync=on.getBrotliCompressAsync=on.inflateAsync=on.deflateAsync=on.gunzipAsync=on.gzipAsync=on.isBrotliSupperted=on.bufferEncodingTypes=on.contentEncodingMethod=void 0;var VH=require("zlib"),XR=require("util"),HH;(function(n){n.GZIP="gzip",n.DEFLATE="deflate",n.BR="br"})(HH=on.contentEncodingMethod||(on.contentEncodingMethod={}));on.bufferEncodingTypes=["utf8","utf16le","latin1","base64","hex","ascii","binary","ucs2"];var tIt=function(){var n=process.versions.node.split(".")[0];return parseInt(n)>=10};on.isBrotliSupperted=tIt;on.gzipAsync=XR.promisify(VH.gzip);on.gunzipAsync=XR.promisify(VH.gunzip);on.deflateAsync=XR.promisify(VH.deflate);on.inflateAsync=XR.promisify(VH.inflate);var nIt=function(n){var e=on.isBrotliSupperted();return e&&typeof n.brotliCompress=="function"?XR.promisify(n.brotliCompress):null};on.getBrotliCompressAsync=nIt;var rIt=function(n){var e=on.isBrotliSupperted();return e&&typeof n.brotliCompressSync=="function"?n.brotliCompressSync:null};on.getBrotliCompressSync=rIt;var iIt=function(n){var e=on.isBrotliSupperted();return e&&typeof n.brotliDecompress=="function"?XR.promisify(n.brotliDecompress):null};on.getBrotliDecompressAsync=iIt;var oIt=function(n){var e=on.isBrotliSupperted();return e&&typeof n.brotliDecompressSync=="function"?n.brotliDecompressSync:null};on.getBrotliDecompressSync=oIt;var sIt=function(n,e){var t=e||"utf8",r=!1;if(Buffer.isEncoding(t)){var o=Buffer.from(n.toString(t),t);r=o.toJSON().data.toString()===n.toJSON().data.toString()}return r};on.isBufferType=sIt;var aIt=function(n){var e=null;for(var t in on.bufferEncodingTypes){var r=on.bufferEncodingTypes[t];if(Buffer.isEncoding(r)&&on.isBufferType(n,r)){e=r;break}}return e};on.findBufferEncodingType=aIt;var cIt=function(n){var e=null;switch(n){case"gzip":e=HH.GZIP;break;case"br":e=HH.BR;break;case"deflate":e=HH.DEFLATE;break;default:}return e};on.isSupportedContentEncoding=cIt;var lIt=function(n){var e=[],t=n.getHeader("Content-Encoding");if(!t)return null;if(typeof t=="string"){var r=on.isSupportedContentEncoding(t);r&&e.push(r)}return e};on.getContentEncodingFromHeaders=lIt;var uIt=function(n,e,t){if(n<0)return null;var r=null,o=e.substring(0,n),s=e.substring(n);return r=o+'<script type="text/javascript">'+t+"</script>"+s,r};on.insertSnippetByIndex=uIt;var dIt=function(n){var e=!1,t=n.getHeader("Content-Type");return t&&(typeof t=="string"?e=t.indexOf("html")>=0:e=t.toString().indexOf("html")>=0),e};on.isContentTypeHeaderHtml=dIt});var vFe=P(Ms=>{"use strict";Object.defineProperty(Ms,"__esModule",{value:!0});Ms.getResourceProvider=Ms.getOsPrefix=Ms.isFunctionApp=Ms.isWebApp=Ms.isLinux=Ms.isWindows=void 0;var pIt=function(){return process.platform==="win32"};Ms.isWindows=pIt;var fIt=function(){return process.platform==="linux"};Ms.isLinux=fIt;var mIt=function(){return!!process.env.WEBSITE_SITE_NAME};Ms.isWebApp=mIt;var hIt=function(){return!!process.env.FUNCTIONS_WORKER_RUNTIME};Ms.isFunctionApp=hIt;var gIt=function(){return Ms.isWindows()?"w":Ms.isLinux()?"l":"u"};Ms.getOsPrefix=gIt;var vIt=function(){return Ms.isWebApp()?"a":Ms.isFunctionApp()?"f":"u"};Ms.getResourceProvider=vIt});var tce=P((Hir,bFe)=>{"use strict";var yFe=Oi(),yIt=function(){function n(){}return n.parse=function(e){if(!e)return{};var t=e.split(n._FIELDS_SEPARATOR),r=t.reduce(function(s,a){var c=a.split(n._FIELD_KEY_VALUE_SEPARATOR);if(c.length===2){var l=c[0].toLowerCase(),u=c[1];s[l]=u}return s},{});if(Object.keys(r).length>0){if(r.endpointsuffix){var o=r.location?r.location+".":"";r.ingestionendpoint=r.ingestionendpoint||"https://"+o+"dc."+r.endpointsuffix,r.liveendpoint=r.liveendpoint||"https://"+o+"live."+r.endpointsuffix}r.ingestionendpoint=r.ingestionendpoint||yFe.DEFAULT_BREEZE_ENDPOINT,r.liveendpoint=r.liveendpoint||yFe.DEFAULT_LIVEMETRICS_ENDPOINT}return r},n.isIkeyValid=function(e){if(!e||e=="")return!1;var t="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",r=new RegExp(t);return r.test(e)},n._FIELDS_SEPARATOR=";",n._FIELD_KEY_VALUE_SEPARATOR="=",n}();bFe.exports=yIt});var _Fe={};Dr(_Fe,{webSnippet:()=>bIt});var bIt,xFe=N(()=>{bIt=`!function(T,l,y){var S=T.location,k="script",D="instrumentationKey",C="ingestionendpoint",I="disableExceptionTracking",E="ai.device.",b="toLowerCase",w="crossOrigin",N="POST",e="appInsightsSDK",t=y.name||"appInsights";(y.name||T[e])&&(T[e]=t);var n=T[t]||function(d){var g=!1,f=!1,m={initialize:!0,queue:[],sv:"5",version:2,config:d};function v(e,t){var n={},a="Browser";return n[E+"id"]=a[b](),n[E+"type"]=a,n["ai.operation.name"]=S&&S.pathname||"_unknown_",n["ai.internal.sdkVersion"]="javascript:snippet_"+(m.sv||m.version),{time:function(){var e=new Date;function t(e){var t=""+e;return 1===t.length&&(t="0"+t),t}return e.getUTCFullYear()+"-"+t(1+e.getUTCMonth())+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+((e.getUTCMilliseconds()/1e3).toFixed(3)+"").slice(2,5)+"Z"}(),iKey:e,name:"Microsoft.ApplicationInsights."+e.replace(/-/g,"")+"."+t,sampleRate:100,tags:n,data:{baseData:{ver:2}}}}var h=d.url||y.src;if(h){function a(e){var t,n,a,i,r,o,s,c,u,p,l;g=!0,m.queue=[],f||(f=!0,t=h,s=function(){var e={},t=d.connectionString;if(t)for(var n=t.split(";"),a=0;a<n.length;a++){var i=n[a].split("=");2===i.length&&(e[i[0][b]()]=i[1])}if(!e[C]){var r=e.endpointsuffix,o=r?e.location:null;e[C]="https://"+(o?o+".":"")+"dc."+(r||"services.visualstudio.com")}return e}(),c=s[D]||d[D]||"",u=s[C],p=u?u+"/v2/track":d.endpointUrl,(l=[]).push((n="SDK LOAD Failure: Failed to load Application Insights SDK script (See stack for details)",a=t,i=p,(o=(r=v(c,"Exception")).data).baseType="ExceptionData",o.baseData.exceptions=[{typeName:"SDKLoadFailed",message:n.replace(/\\./g,"-"),hasFullStack:!1,stack:n+"\\nSnippet failed to load ["+a+"] -- Telemetry is disabled\\nHelp Link: https://go.microsoft.com/fwlink/?linkid=2128109\\nHost: "+(S&&S.pathname||"_unknown_")+"\\nEndpoint: "+i,parsedStack:[]}],r)),l.push(function(e,t,n,a){var i=v(c,"Message"),r=i.data;r.baseType="MessageData";var o=r.baseData;return o.message='AI (Internal): 99 message:"'+("SDK LOAD Failure: Failed to load Application Insights SDK script (See stack for details) ("+n+")").replace(/\\"/g,"")+'"',o.properties={endpoint:a},i}(0,0,t,p)),function(e,t){if(JSON){var n=T.fetch;if(n&&!y.useXhr)n(t,{method:N,body:JSON.stringify(e),mode:"cors"});else if(XMLHttpRequest){var a=new XMLHttpRequest;a.open(N,t),a.setRequestHeader("Content-type","application/json"),a.send(JSON.stringify(e))}}}(l,p))}function i(e,t){f||setTimeout(function(){!t&&m.core||a()},500)}var e=function(){var n=l.createElement(k);n.src=h;var e=y[w];return!e&&""!==e||"undefined"==n[w]||(n[w]=e),n.onload=i,n.onerror=a,n.onreadystatechange=function(e,t){"loaded"!==n.readyState&&"complete"!==n.readyState||i(0,t)},n}();y.ld<0?l.getElementsByTagName("head")[0].appendChild(e):setTimeout(function(){l.getElementsByTagName(k)[0].parentNode.appendChild(e)},y.ld||0)}try{m.cookie=l.cookie}catch(p){}function t(e){for(;e.length;)!function(t){m[t]=function(){var e=arguments;g||m.queue.push(function(){m[t].apply(m,e)})}}(e.pop())}var n="track",r="TrackPage",o="TrackEvent";t([n+"Event",n+"PageView",n+"Exception",n+"Trace",n+"DependencyData",n+"Metric",n+"PageViewPerformance","start"+r,"stop"+r,"start"+o,"stop"+o,"addTelemetryInitializer","setAuthenticatedUserContext","clearAuthenticatedUserContext","flush"]),m.SeverityLevel={Verbose:0,Information:1,Warning:2,Error:3,Critical:4};var s=(d.extensionConfig||{}).ApplicationInsightsAnalytics||{};if(!0!==d[I]&&!0!==s[I]){var c="onerror";t(["_"+c]);var u=T[c];T[c]=function(e,t,n,a,i){var r=u&&u(e,t,n,a,i);return!0!==r&&m["_"+c]({message:e,url:t,lineNumber:n,columnNumber:a,error:i}),r},d.autoExceptionInstrumented=!0}return m}(y.cfg);function a(){y.onInit&&y.onInit(n)}(T[t]=n).queue&&0===n.queue.length?(n.queue.push(a),n.trackPageView({})):a()}(window,document,{\r
src: "https://js.monitor.azure.com/scripts/b/ai.2.min.js", // The SDK URL Source\r
// name: "appInsights", // Global SDK Instance name defaults to "appInsights" when not supplied\r
// ld: 0, // Defines the load delay (in ms) before attempting to load the sdk. -1 = block page load and add to head. (default) = 0ms load after timeout,\r
// useXhr: 1, // Use XHR instead of fetch to report failures (if available),\r
// crossOrigin: "anonymous", // When supplied this will add the provided value as the cross origin attribute on the script tag\r
// onInit: null, // Once the application insights instance has loaded and initialized this callback function will be called with 1 argument -- the sdk instance (DO NOT ADD anything to the sdk.queue -- As they won't get called)\r
cfg: { // Application Insights Configuration\r
    instrumentationKey: "INSTRUMENTATION_KEY"\r
}});`});var wFe=P((Vir,EFe)=>{"use strict";var SFe=require("http"),IFe=require("https"),JR=require("zlib"),sm=li(),Wu=gFe(),TFe=vFe(),z4=Oi(),CFe=tce(),_It=(xFe(),Eo(_Fe)),xIt=function(){function n(e){var t;if(this._isIkeyValid=!0,n.INSTANCE)throw new Error("Web snippet injection should be configured from the applicationInsights object");n.INSTANCE=this,n._aiUrl=z4.WEB_INSTRUMENTATION_DEFAULT_SOURCE,n._aiDeprecatedUrl=z4.WEB_INSTRUMENTATION_DEPRECATED_SOURCE;var r=this._getWebSnippetIkey((t=e.config)===null||t===void 0?void 0:t.webInstrumentationConnectionString);this._webInstrumentationIkey=r||e.config.instrumentationKey,this._clientWebInstrumentationConfig=e.config.webInstrumentationConfig,this._clientWebInstrumentationSrc=e.config.webInstrumentationSrc,this._statsbeat=e.getStatsbeat()}return n.prototype.enable=function(e,t){this._isEnabled=e,this._webInstrumentationIkey=this._getWebSnippetIkey(t)||this._webInstrumentationIkey,n._snippet=this._getWebInstrumentationReplacedStr(),this._isEnabled&&!this._isInitialized&&this._isIkeyValid?(this._statsbeat&&this._statsbeat.addFeature(z4.StatsbeatFeature.WEB_SNIPPET),this._initialize()):this._isEnabled||this._statsbeat&&this._statsbeat.removeFeature(z4.StatsbeatFeature.WEB_SNIPPET)},n.prototype.isInitialized=function(){return this._isInitialized},n.prototype._getWebSnippetIkey=function(e){var t=null;try{var r=CFe.parse(e),o=r.instrumentationkey||"";CFe.isIkeyValid(o)?(this._isIkeyValid=!0,t=o):(this._isIkeyValid=!1,sm.info("Invalid web Instrumentation connection string, web Instrumentation is not enabled."))}catch(s){sm.info("get web snippet ikey error: "+s)}return t},n.prototype._getWebInstrumentationReplacedStr=function(){var e=this._getClientWebInstrumentationConfigStr(this._clientWebInstrumentationConfig),t=TFe.getOsPrefix(),r=TFe.getResourceProvider(),o=this._webInstrumentationIkey+`",\r
`+e+` disableIkeyDeprecationMessage: true,\r
 sdkExtension: "`+r+t+"d_n_",s=_It.webSnippet.replace("INSTRUMENTATION_KEY",o);return this._clientWebInstrumentationSrc?s.replace(z4.WEB_INSTRUMENTATION_DEFAULT_SOURCE+".2.min.js",this._clientWebInstrumentationSrc):s},n.prototype._getClientWebInstrumentationConfigStr=function(e){var t="";try{e!=null&&e.length>0&&e.forEach(function(r){var o=r.name;if(o!==void 0){var s=r.value,a="";switch(typeof s){case"function":break;case"object":break;case"string":a=" "+o+': "'+s+`",\r
`,t+=a;break;default:a=" "+o+": "+s+`,\r
`,t+=a;break}}})}catch{this._isEnabled=!1,sm.info("Parse client web instrumentation error. Web Instrumentation is disabled")}return t},n.prototype._initialize=function(){this._isInitialized=!0;var e=SFe.createServer,t=IFe.createServer,r=this._isEnabled;SFe.createServer=function(o){var s=o;return s&&(o=function(a,c){var l=c.write,u=a.method=="GET";c.write=function(f,m,h){try{if(r&&u){var g=Wu.getContentEncodingFromHeaders(c),y=void 0;if(typeof m=="string"&&(y=m),g==null)n.INSTANCE.ValidateInjection(c,f)&&(arguments[0]=n.INSTANCE.InjectWebSnippet(c,f,void 0,y));else if(g.length){var b=g[0];arguments[0]=n.INSTANCE.InjectWebSnippet(c,f,b)}}}catch(_){sm.warn("Inject snippet error: "+_)}return l.apply(c,arguments)};var d=c.end;return c.end=function(f,m,h){if(r&&u)try{if(r&&u){var g=Wu.getContentEncodingFromHeaders(c),y=void 0;if(typeof m=="string"&&(y=m),g==null)n.INSTANCE.ValidateInjection(c,f)&&(arguments[0]=n.INSTANCE.InjectWebSnippet(c,f,void 0,y));else if(g.length){var b=g[0];arguments[0]=n.INSTANCE.InjectWebSnippet(c,f,b)}}}catch(_){sm.warn("Inject snipet error: "+_)}return d.apply(c,arguments)},s(a,c)}),e(o)},IFe.createServer=function(o,s){var a=s;if(a)return s=function(c,l){var u=c.method=="GET",d=l.write,p=l.end;return l.write=function(m,h,g){try{if(r&&u){var y=Wu.getContentEncodingFromHeaders(l),b=void 0;if(typeof h=="string"&&(b=h),y==null)n.INSTANCE.ValidateInjection(l,m)&&(arguments[0]=this.InjectWebSnippet(l,m,void 0,b));else if(y.length){var _=y[0];arguments[0]=n.INSTANCE.InjectWebSnippet(l,m,_)}}}catch(x){sm.warn("Inject snippet error: "+x)}return d.apply(l,arguments)},l.end=function(m,h,g){try{if(r&&u){var y=Wu.getContentEncodingFromHeaders(l),b=void 0;if(typeof h=="string"&&(b=h),y==null)n.INSTANCE.ValidateInjection(l,m)&&(arguments[0]=n.INSTANCE.InjectWebSnippet(l,m,void 0,b));else if(y.length){var _=y[0];arguments[0]=n.INSTANCE.InjectWebSnippet(l,m,_)}}}catch(x){sm.warn("Inject snippet error: "+x)}return p.apply(l,arguments)},a(c,l)},t(o,s)}},n.prototype.ValidateInjection=function(e,t){try{if(!e||!t||e.statusCode!=200)return!1;var r=Wu.isContentTypeHeaderHtml(e);if(!r)return!1;var o=t.slice().toString();if(o.indexOf("<head>")>=0&&o.indexOf("</head>")>=0&&o.indexOf(n._aiUrl)<0&&o.indexOf(n._aiDeprecatedUrl)<0)return!0}catch(s){sm.info("validate injections error: "+s)}return!1},n.prototype.InjectWebSnippet=function(e,t,r,o){try{var s=!!r;if(s)e.removeHeader("Content-Length"),t=this._getInjectedCompressBuffer(e,t,r),e.setHeader("Content-Length",t.length);else{var a=t.toString(),c=a.indexOf("</head>");if(c<0)return t;var l=Wu.insertSnippetByIndex(c,a,n._snippet);if(typeof t=="string")e.removeHeader("Content-Length"),t=l,e.setHeader("Content-Length",Buffer.byteLength(t));else if(Buffer.isBuffer(t)){var u=o||"utf8",d=Wu.isBufferType(t,u);if(d){e.removeHeader("Content-Length");var p=Buffer.from(l).toString(u);t=Buffer.from(p,u),e.setHeader("Content-Length",t.length)}}}}catch(f){sm.warn("Failed to inject web snippet and change content-lenght headers. Exception:"+f)}return t},n.prototype._getInjectedCompressBuffer=function(e,t,r){try{switch(r){case Wu.contentEncodingMethod.GZIP:var o=JR.gunzipSync(t);if(this.ValidateInjection(e,o)){var s=this.InjectWebSnippet(e,o);t=JR.gzipSync(s)}break;case Wu.contentEncodingMethod.DEFLATE:var a=JR.inflateSync(t);if(this.ValidateInjection(e,a)){var c=this.InjectWebSnippet(e,a);t=JR.deflateSync(c)}break;case Wu.contentEncodingMethod.BR:var l=Wu.getBrotliDecompressSync(JR),u=Wu.getBrotliCompressSync(JR);if(l&&u){var d=l(t);if(this.ValidateInjection(e,d)){var p=this.InjectWebSnippet(e,d);t=u(p)}break}}}catch(f){sm.info("get web injection compress buffer error: "+f)}return t},n.prototype.dispose=function(){n.INSTANCE=null,this.enable(!1),this._isInitialized=!1},n}();EFe.exports=xIt});var RFe=P((rce,kFe)=>{"use strict";var SIt=rce&&rce.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Ku=require("url"),nce=Ea(),IIt=ra(),TIt=TR(),CIt=Mse(),EIt=zS(),wIt=function(n){SIt(e,n);function e(t,r){var o=n.call(this)||this;return r&&r.method&&t&&(o.method=r.method,o.url=e._getUrlFromRequestOptions(t,r),o.startTime=+new Date),o}return e.prototype.onError=function(t){this._setStatus(void 0,t)},e.prototype.onResponse=function(t){this._setStatus(t.statusCode,void 0),this.correlationId=IIt.getCorrelationContextTarget(t,TIt.requestContextTargetKey)},e.prototype.getDependencyTelemetry=function(t,r){var o=this.method.toUpperCase(),s=nce.RemoteDependencyDataConstants.TYPE_HTTP,a="";try{var c=new Ku.URL(this.url);c.search=void 0,c.hash=void 0,o+=" "+c.pathname,a=c.hostname,c.port&&(a+=":"+c.port)}catch{}this.correlationId?(s=nce.RemoteDependencyDataConstants.TYPE_AI,this.correlationId!==EIt.correlationIdPrefix&&(a+=" | "+this.correlationId)):s=nce.RemoteDependencyDataConstants.TYPE_HTTP;var l={id:r,name:o,data:this.url,duration:this.duration,success:this._isSuccess(),resultCode:this.statusCode?this.statusCode.toString():null,properties:this.properties||{},dependencyTypeName:s,target:a};if(t&&t.time?l.time=t.time:this.startTime&&(l.time=new Date(this.startTime)),t){for(var u in t)l[u]||(l[u]=t[u]);if(t.properties)for(var u in t.properties)l.properties[u]=t.properties[u]}return l},e._getUrlFromRequestOptions=function(t,r){if(typeof t=="string")if(t.indexOf("http://")===0||t.indexOf("https://")===0)try{t=new Ku.URL(t)}catch{}else try{var o=new Ku.URL("http://"+t);o.port==="443"?t=new Ku.URL("https://"+t):t=new Ku.URL("http://"+t)}catch{}else{if(t&&typeof Ku.URL=="function"&&t instanceof Ku.URL)return Ku.format(t);var s=t;t={},s&&Object.keys(s).forEach(function(l){t[l]=s[l]})}if(t.path&&t.host)try{var a=new Ku.URL(t.path,"http://"+t.host+t.path);t.pathname=a.pathname,t.search=a.search}catch{}if(t.path&&t.hostname&&!t.host)try{var a=new Ku.URL(t.path,"http://"+t.hostname+t.path);t.pathname=a.pathname,t.search=a.search}catch{}if(t.host&&t.port)try{var c=new Ku.URL("http://"+t.host);!c.port&&t.port&&(t.hostname=t.host,delete t.host)}catch{}return t.protocol=t.protocol||r.agent&&r.agent.protocol||r.protocol||void 0,t.hostname=t.hostname||"localhost",Ku.format(t)},e}(CIt);kFe.exports=wIt});var PFe=P(ZR=>{"use strict";var GH=ZR&&ZR.__assign||function(){return GH=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o])}return n},GH.apply(this,arguments)};Object.defineProperty(ZR,"__esModule",{value:!0});ZR.parseEventHubSpan=void 0;var ice=(Hn(),Eo(mR)),kIt=(Za(),Eo(iLe)),RIt=(tp(),Eo(Ioe)),$4=Oi(),PIt=function(n){var e=0,t=0,r=kIt.hrTimeToMilliseconds(n.startTime);return n.links.forEach(function(o){var s=o.attributes,a=s?.[$4.ENQUEUED_TIME];a&&(e+=1,t+=r-(parseFloat(a.toString())||0))}),Math.max(t/(e||1),0)},AIt=function(n,e){var t,r=n.attributes[$4.AzNamespace],o=(n.attributes[RIt.SemanticAttributes.NET_PEER_NAME]||n.attributes["peer.address"]||"unknown").replace(/\/$/g,""),s=n.attributes[$4.MessageBusDestination]||"unknown";switch(n.kind){case ice.SpanKind.CLIENT:e.dependencyTypeName=r,e.target=o+"/"+s;break;case ice.SpanKind.PRODUCER:e.dependencyTypeName=$4.DependencyTypeName.QueueMessage+" | "+r,e.target=o+"/"+s;break;case ice.SpanKind.CONSUMER:e.source=o+"/"+s,e.measurements=GH(GH({},e.measurements),(t={},t[$4.TIME_SINCE_ENQUEUED]=PIt(n),t));break;default:}};ZR.parseEventHubSpan=AIt});var NFe=P(zH=>{"use strict";Object.defineProperty(zH,"__esModule",{value:!0});zH.spanToTelemetryContract=void 0;var AFe=require("url"),sp=(Hn(),Eo(mR)),Cn=(tp(),Eo(Ioe)),gg=Oi(),DIt=PFe(),NIt=ra();function LIt(n){for(var e={},t=0,r=Object.keys(n.attributes);t<r.length;t++){var o=r[t];o.startsWith("http.")||o.startsWith("rpc.")||o.startsWith("db.")||o.startsWith("peer.")||o.startsWith("net.")||(e[o]=n.attributes[o])}var s=n.links.map(function(a){return{operation_Id:a.context.traceId,id:a.context.spanId}});return s.length>0&&(e["_MS.links"]=NIt.stringify(s)),e}function OIt(n){return n===Cn.DbSystemValues.DB2||n===Cn.DbSystemValues.DERBY||n===Cn.DbSystemValues.MARIADB||n===Cn.DbSystemValues.MSSQL||n===Cn.DbSystemValues.ORACLE||n===Cn.DbSystemValues.SQLITE||n===Cn.DbSystemValues.OTHER_SQL||n===Cn.DbSystemValues.HSQLDB||n===Cn.DbSystemValues.H2}function DFe(n){var e=n.attributes[Cn.SemanticAttributes.HTTP_METHOD];if(e){var t=n.attributes[Cn.SemanticAttributes.HTTP_URL];if(t)return String(t);var r=n.attributes[Cn.SemanticAttributes.HTTP_SCHEME],o=n.attributes[Cn.SemanticAttributes.HTTP_TARGET];if(r&&o){var s=n.attributes[Cn.SemanticAttributes.HTTP_HOST];if(s)return r+"://"+s+o;var a=n.attributes[Cn.SemanticAttributes.NET_PEER_PORT];if(a){var c=n.attributes[Cn.SemanticAttributes.NET_PEER_NAME];if(c)return r+"://"+c+":"+a+o;var l=n.attributes[Cn.SemanticAttributes.NET_PEER_IP];if(l)return r+"://"+l+":"+a+o}}}return""}function oce(n){var e=n.attributes[Cn.SemanticAttributes.PEER_SERVICE],t=n.attributes[Cn.SemanticAttributes.HTTP_HOST],r=n.attributes[Cn.SemanticAttributes.HTTP_URL],o=n.attributes[Cn.SemanticAttributes.NET_PEER_NAME],s=n.attributes[Cn.SemanticAttributes.NET_PEER_IP];return e?String(e):t?String(t):r?String(r):o?String(o):s?String(s):""}function MIt(n){var e={name:n.name,success:n.status.code!=sp.SpanStatusCode.ERROR,resultCode:"0",duration:0,data:"",dependencyTypeName:""};n.kind===sp.SpanKind.PRODUCER&&(e.dependencyTypeName=gg.DependencyTypeName.QueueMessage),n.kind===sp.SpanKind.INTERNAL&&n.parentSpanId&&(e.dependencyTypeName=gg.DependencyTypeName.InProc);var t=n.attributes[Cn.SemanticAttributes.HTTP_METHOD],r=n.attributes[Cn.SemanticAttributes.DB_SYSTEM],o=n.attributes[Cn.SemanticAttributes.RPC_SYSTEM];if(t){e.dependencyTypeName=gg.DependencyTypeName.Http;var s=n.attributes[Cn.SemanticAttributes.HTTP_URL];if(s){var a="";try{var c=new AFe.URL(String(s));a=c.pathname}catch{}e.name=t+" "+a}e.data=DFe(n);var l=n.attributes[Cn.SemanticAttributes.HTTP_STATUS_CODE];l&&(e.resultCode=String(l));var u=oce(n);if(u){try{var d=new RegExp(/(https?)(:\/\/.*)(:\d+)(\S*)/),p=d.exec(u);if(p!=null){var f=p[1],m=p[3];(f=="https"&&m==":443"||f=="http"&&m==":80")&&(u=p[1]+p[2]+p[4])}}catch{}e.target=""+u}}else if(r){String(r)===Cn.DbSystemValues.MYSQL?e.dependencyTypeName="mysql":String(r)===Cn.DbSystemValues.POSTGRESQL?e.dependencyTypeName="postgresql":String(r)===Cn.DbSystemValues.MONGODB?e.dependencyTypeName="mongodb":String(r)===Cn.DbSystemValues.REDIS?e.dependencyTypeName="redis":OIt(String(r))?e.dependencyTypeName="SQL":e.dependencyTypeName=String(r);var h=n.attributes[Cn.SemanticAttributes.DB_STATEMENT],g=n.attributes[Cn.SemanticAttributes.DB_OPERATION];h?e.data=String(h):g&&(e.data=String(g));var u=oce(n),y=n.attributes[Cn.SemanticAttributes.DB_NAME];u?e.target=y?u+"|"+y:""+u:e.target=y?""+y:""+r}else if(o){e.dependencyTypeName=gg.DependencyTypeName.Grpc;var b=n.attributes[Cn.SemanticAttributes.RPC_GRPC_STATUS_CODE];b&&(e.resultCode=String(b));var u=oce(n);u?e.target=""+u:o&&(e.target=String(o))}return e}function FIt(n){var e={name:n.name,success:n.status.code!=sp.SpanStatusCode.ERROR,resultCode:"0",duration:0,url:"",source:void 0},t=n.attributes[Cn.SemanticAttributes.HTTP_METHOD],r=n.attributes[Cn.SemanticAttributes.RPC_GRPC_STATUS_CODE];if(t){if(n.kind==sp.SpanKind.SERVER){var o=n.attributes[Cn.SemanticAttributes.HTTP_ROUTE],s=n.attributes[Cn.SemanticAttributes.HTTP_URL];if(o)e.name=t+" "+o;else if(s)try{var a=new AFe.URL(String(s));e.name=t+" "+a.pathname}catch{}}e.url=DFe(n);var c=n.attributes[Cn.SemanticAttributes.HTTP_STATUS_CODE];c&&(e.resultCode=String(c))}else r&&(e.resultCode=String(r));return e}function UIt(n){var e;switch(n.kind){case sp.SpanKind.CLIENT:case sp.SpanKind.PRODUCER:case sp.SpanKind.INTERNAL:e=MIt(n);break;case sp.SpanKind.SERVER:case sp.SpanKind.CONSUMER:e=FIt(n);break}var t=n.spanContext?n.spanContext():n.context(),r=""+t.spanId,o=Math.round(n.duration[0]*1e3+n.duration[1]/1e6);return e.id=r,e.duration=o,e.properties=LIt(n),n.attributes[gg.AzNamespace]&&(n.kind===sp.SpanKind.INTERNAL&&(e.dependencyTypeName=gg.DependencyTypeName.InProc+" | "+n.attributes[gg.AzNamespace]),n.attributes[gg.AzNamespace]===gg.MicrosoftEventHub&&DIt.parseEventHubSpan(n,e)),e}zH.spanToTelemetryContract=UIt});var OFe=P(ub=>{"use strict";var eP=ub&&ub.__assign||function(){return eP=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o])}return n},eP.apply(this,arguments)};Object.defineProperty(ub,"__esModule",{value:!0});ub.AsyncScopeManager=ub.OpenTelemetryScopeManagerWrapper=void 0;var lb=ob(),BIt=require("events"),LFe=function(){function n(){}return n.prototype.active=function(){var e=this,t=lb.CorrelationContextManager.getCurrentContext();return eP(eP({},t),{getValue:function(r){return e._activeSymbol?r===e._activeSymbol?t:!1:(e._activeSymbol=r,t)},setValue:function(){}})},n.prototype.with=function(e,t){var r=e.parentSpanId,o=e.name,s=n._spanToContext(e,r,o);return lb.CorrelationContextManager.runWithContext(s,t)()},n.prototype.bind=function(e){return typeof e=="function"?lb.CorrelationContextManager.wrapCallback(e):(e instanceof BIt.EventEmitter&&lb.CorrelationContextManager.wrapEmitter(e),e)},n.prototype.enable=function(){return lb.CorrelationContextManager.enable(),this},n.prototype.disable=function(){return lb.CorrelationContextManager.disable(),this},n._spanToContext=function(e,t,r){var o=e.spanContext?e.spanContext():e.context(),s=eP(eP({},e.spanContext()),{traceFlags:e.spanContext().traceFlags}),a=t?"|"+o.traceId+"."+t+".":o.traceId,c=lb.CorrelationContextManager.getCurrentContext();c&&(s.traceId=c.operation.id,t||(a=c.operation.parentId));var l=lb.CorrelationContextManager.spanToContextObject(s,a,r);return l},n}();ub.OpenTelemetryScopeManagerWrapper=LFe;ub.AsyncScopeManager=new LFe});var MFe=P(db=>{"use strict";Object.defineProperty(db,"__esModule",{value:!0});db.enable=db.subscriber=void 0;var W4=(Hn(),Eo(mR)),qIt=Oi(),sce=no(),jIt=NFe(),HIt=OFe(),nI=[],VIt=function(n){try{var e=n.data,t=jIt.spanToTelemetryContract(e);HIt.AsyncScopeManager.with(e,function(){nI.forEach(function(r){e.kind===W4.SpanKind.SERVER||e.kind===W4.SpanKind.CONSUMER?r.trackRequest(t):(e.kind===W4.SpanKind.CLIENT||e.kind===W4.SpanKind.INTERNAL||e.kind===W4.SpanKind.PRODUCER)&&r.trackDependency(t)})})}catch{}};db.subscriber=VIt;function GIt(n,e){if(n){var t=nI.find(function(r){return r==e});if(t)return;nI.length===0&&sce.channel.subscribe("azure-coretracing",db.subscriber,sce.trueFilter,function(r,o){var s=e.getStatsbeat();s&&s.addInstrumentation(qIt.StatsbeatInstrumentation.AZURE_CORE_TRACING)}),nI.push(e)}else nI=nI.filter(function(r){return r!=e}),nI.length===0&&sce.channel.unsubscribe("azure-coretracing",db.subscriber)}db.enable=GIt});var FFe=P(pb=>{"use strict";Object.defineProperty(pb,"__esModule",{value:!0});pb.enable=pb.subscriber=void 0;var zIt=Oi(),ace=no(),rI=[],$It=function(n){n.data.event.commandName!=="ismaster"&&rI.forEach(function(e){var t=n.data.startedData&&n.data.startedData.databaseName||"Unknown database";e.trackDependency({target:t,data:n.data.event.commandName,name:n.data.event.commandName,duration:n.data.event.duration,success:n.data.succeeded,resultCode:n.data.succeeded?"0":"1",time:n.data.startedData.time,dependencyTypeName:"mongodb"})})};pb.subscriber=$It;function WIt(n,e){if(n){var t=rI.find(function(r){return r==e});if(t)return;rI.length===0&&ace.channel.subscribe("mongodb",pb.subscriber,ace.trueFilter,function(r,o){var s=e.getStatsbeat();s&&s.addInstrumentation(zIt.StatsbeatInstrumentation.MONGODB)}),rI.push(e)}else rI=rI.filter(function(r){return r!=e}),rI.length===0&&ace.channel.unsubscribe("mongodb",pb.subscriber)}pb.enable=WIt});var UFe=P(fb=>{"use strict";Object.defineProperty(fb,"__esModule",{value:!0});fb.enable=fb.subscriber=void 0;var KIt=Oi(),cce=no(),iI=[],YIt=function(n){iI.forEach(function(e){var t=n.data.query||{},r=t.sql||"Unknown query",o=!n.data.err,s=t._connection||{},a=s.config||{},c=a.socketPath?a.socketPath:(a.host||"localhost")+":"+a.port;e.trackDependency({target:c,data:r,name:r,duration:n.data.duration,success:o,resultCode:o?"0":"1",time:n.data.time,dependencyTypeName:"mysql"})})};fb.subscriber=YIt;function QIt(n,e){if(n){var t=iI.find(function(r){return r==e});if(t)return;iI.length===0&&cce.channel.subscribe("mysql",fb.subscriber,cce.trueFilter,function(r,o){var s=e.getStatsbeat();s&&s.addInstrumentation(KIt.StatsbeatInstrumentation.MYSQL)}),iI.push(e)}else iI=iI.filter(function(r){return r!=e}),iI.length===0&&cce.channel.unsubscribe("mysql",fb.subscriber)}fb.enable=QIt});var BFe=P(mb=>{"use strict";Object.defineProperty(mb,"__esModule",{value:!0});mb.enable=mb.subscriber=void 0;var XIt=Oi(),lce=no(),oI=[],JIt=function(n){oI.forEach(function(e){n.data.commandObj.command!=="info"&&e.trackDependency({target:n.data.address,name:n.data.commandObj.command,data:n.data.commandObj.command,duration:n.data.duration,success:!n.data.err,resultCode:n.data.err?"1":"0",time:n.data.time,dependencyTypeName:"redis"})})};mb.subscriber=JIt;function ZIt(n,e){if(n){var t=oI.find(function(r){return r==e});if(t)return;oI.length===0&&lce.channel.subscribe("redis",mb.subscriber,lce.trueFilter,function(r,o){var s=e.getStatsbeat();s&&s.addInstrumentation(XIt.StatsbeatInstrumentation.REDIS)}),oI.push(e)}else oI=oI.filter(function(r){return r!=e}),oI.length===0&&lce.channel.unsubscribe("redis",mb.subscriber)}mb.enable=ZIt});var qFe=P(hb=>{"use strict";Object.defineProperty(hb,"__esModule",{value:!0});hb.enable=hb.subscriber=void 0;var e1t=Oi(),uce=no(),sI=[],t1t=function(n){sI.forEach(function(e){var t=n.data.query,r=t.preparable&&t.preparable.text||t.plan||t.text||"unknown query",o=!n.data.error,s=n.data.database.host+":"+n.data.database.port;e.trackDependency({target:s,data:r,name:r,duration:n.data.duration,success:o,resultCode:o?"0":"1",time:n.data.time,dependencyTypeName:"postgres"})})};hb.subscriber=t1t;function n1t(n,e){if(n){var t=sI.find(function(r){return r==e});if(t)return;sI.length===0&&uce.channel.subscribe("postgres",hb.subscriber,uce.trueFilter,function(r,o){var s=e.getStatsbeat();s&&s.addInstrumentation(e1t.StatsbeatInstrumentation.POSTGRES)}),sI.push(e)}else sI=sI.filter(function(r){return r!=e}),sI.length===0&&uce.channel.unsubscribe("postgres",hb.subscriber)}hb.enable=n1t});var rP=P((pce,jFe)=>{"use strict";var $H=pce&&pce.__spreadArrays||function(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),o=0,e=0;e<t;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,o++)r[o]=s[a];return r},tP=require("http"),nP=require("https"),WH=li(),dce=ra(),gb=TR(),r1t=RFe(),K4=ob(),KH=Yj(),i1t=Kj(),Y4=zS(),o1t=function(){function n(e){if(n.INSTANCE)throw new Error("Client request tracking should be configured from the applicationInsights object");n.INSTANCE=this,this._client=e}return n.prototype.enable=function(e){this._isEnabled=e,this._isEnabled&&!this._isInitialized&&this._initialize(),i1t.IsInitialized&&(MFe().enable(e,this._client),FFe().enable(e,this._client),UFe().enable(e,this._client),BFe().enable(e,this._client),qFe().enable(e,this._client))},n.prototype.isInitialized=function(){return this._isInitialized},n.prototype._initialize=function(){var e=this;this._isInitialized=!0;var t=tP.request,r=nP.request,o=function(s,a){try{var c=!a[n.disableCollectionRequestOption]&&!s[n.alreadyAutoCollectedFlag],l=null;if(a.headers&&(l=a.headers["User-Agent"]||a.headers["user-agent"],l&&l.toString().indexOf("azsdk-js")!==-1&&(c=!1)),s&&a&&c&&(K4.CorrelationContextManager.wrapEmitter(s),e._isEnabled))if(s[n.alreadyAutoCollectedFlag]=!0,K4.CorrelationContextManager.getCurrentContext())n.trackRequest(e._client,{options:a,request:s});else{var u=null;if(Y4.w3cEnabled){var d=new KH;u=d.traceId}else{var p=Y4.generateRequestId(null);u=Y4.getRootId(p)}var f=K4.CorrelationContextManager.generateContextObject(u);K4.CorrelationContextManager.runWithContext(f,function(){n.trackRequest(e._client,{options:a,request:s})})}}catch(m){WH.warn("Failed to generate dependency telemetry.",dce.dumpObj(m))}};tP.request=function(s){for(var a=[],c=1;c<arguments.length;c++)a[c-1]=arguments[c];var l=t.call.apply(t,$H([tP,s],a));return o(l,s),l},nP.request=function(s){for(var a=[],c=1;c<arguments.length;c++)a[c-1]=arguments[c];var l=r.call.apply(r,$H([nP,s],a));return o(l,s),l},tP.get=function(s){for(var a,c=[],l=1;l<arguments.length;l++)c[l-1]=arguments[l];var u=(a=tP.request).call.apply(a,$H([tP,s],c));return u.end(),u},nP.get=function(s){for(var a,c=[],l=1;l<arguments.length;l++)c[l-1]=arguments[l];var u=(a=nP.request).call.apply(a,$H([nP,s],c));return u.end(),u}},n.trackRequest=function(e,t){if(!t.options||!t.request||!e){WH.info("AutoCollectHttpDependencies.trackRequest was called with invalid parameters: ",!t.options,!t.request,!e);return}var r=new r1t(t.options,t.request),o=K4.CorrelationContextManager.getCurrentContext(),s,a;if(o&&o.operation&&o.operation.traceparent&&KH.isValidTraceId(o.operation.traceparent.traceId))o.operation.traceparent.updateSpanId(),s=o.operation.traceparent.getBackCompatRequestId();else if(Y4.w3cEnabled){var c=new KH;a=c.toString(),s=c.getBackCompatRequestId()}else s=o&&o.operation&&o.operation.parentId+n.requestNumber+++".";if(dce.canIncludeCorrelationHeader(e,r.getUrl())&&t.request.getHeader&&t.request.setHeader&&e.config&&e.config.correlationId){var l=t.request.getHeader(gb.requestContextHeader);try{dce.safeIncludeCorrelationHeader(e,t.request,l)}catch(p){WH.warn("Request-Context header could not be set. Correlation of requests may be lost",p)}if(o&&o.operation)try{if(t.request.setHeader(gb.requestIdHeader,s),e.config.ignoreLegacyHeaders||(t.request.setHeader(gb.parentIdHeader,o.operation.id),t.request.setHeader(gb.rootIdHeader,s)),a||o.operation.traceparent)t.request.setHeader(gb.traceparentHeader,a||o.operation.traceparent.toString());else if(Y4.w3cEnabled){var c=new KH().toString();t.request.setHeader(gb.traceparentHeader,c)}if(o.operation.tracestate){var u=o.operation.tracestate.toString();u&&t.request.setHeader(gb.traceStateHeader,u)}var d=o.customProperties.serializeToHeader();d&&t.request.setHeader(gb.correlationContextHeader,d)}catch(p){WH.warn("Correlation headers could not be set. Correlation of requests may be lost.",p)}}t.request.on&&(t.request.on("response",function(p){if(!t.isProcessed){t.isProcessed=!0,r.onResponse(p);var f=r.getDependencyTelemetry(t,s);f.contextObjects=f.contextObjects||{},f.contextObjects["http.RequestOptions"]=t.options,f.contextObjects["http.ClientRequest"]=t.request,f.contextObjects["http.ClientResponse"]=p,e.trackDependency(f)}}),t.request.on("error",function(p){if(!t.isProcessed){t.isProcessed=!0,r.onError(p);var f=r.getDependencyTelemetry(t,s);f.contextObjects=f.contextObjects||{},f.contextObjects["http.RequestOptions"]=t.options,f.contextObjects["http.ClientRequest"]=t.request,f.contextObjects.Error=p,e.trackDependency(f)}}),t.request.on("abort",function(){if(!t.isProcessed){t.isProcessed=!0,r.onError(new Error("The request has been aborted and the network socket has closed."));var p=r.getDependencyTelemetry(t,s);p.contextObjects=p.contextObjects||{},p.contextObjects["http.RequestOptions"]=t.options,p.contextObjects["http.ClientRequest"]=t.request,e.trackDependency(p)}}))},n.prototype.dispose=function(){n.INSTANCE=null,this.enable(!1),this._isInitialized=!1},n.disableCollectionRequestOption="disableAppInsightsAutoCollection",n.requestNumber=1,n.alreadyAutoCollectedFlag="_appInsightsAutoCollected",n}();jFe.exports=o1t});var mce=P((Jir,$Fe)=>{"use strict";var HFe=require("http"),VFe=require("https"),GFe=li(),zFe=ra(),s1t=TR(),fce=qse(),vg=ob(),a1t=FH(),c1t=function(){function n(e){if(n.INSTANCE)throw new Error("Server request tracking should be configured from the applicationInsights object");n.INSTANCE=this,this._client=e}return n.prototype.enable=function(e){this._isEnabled=e,(this._isAutoCorrelating||this._isEnabled||a1t.isEnabled())&&!this._isInitialized&&(this.useAutoCorrelation(this._isAutoCorrelating),this._initialize())},n.prototype.useAutoCorrelation=function(e,t){e&&!this._isAutoCorrelating?vg.CorrelationContextManager.enable(t):!e&&this._isAutoCorrelating&&vg.CorrelationContextManager.disable(),this._isAutoCorrelating=e},n.prototype.isInitialized=function(){return this._isInitialized},n.prototype.isAutoCorrelating=function(){return this._isAutoCorrelating},n.prototype._generateCorrelationContext=function(e){if(this._isAutoCorrelating)return vg.CorrelationContextManager.generateContextObject(e.getOperationId(this._client.context.tags),e.getRequestId(),e.getOperationName(this._client.context.tags),e.getCorrelationContextHeader(),e.getTraceparent(),e.getTracestate())},n.prototype._registerRequest=function(e,t,r){var o=this,s=new fce(e),a=this._generateCorrelationContext(s);vg.CorrelationContextManager.runWithContext(a,function(){o._isEnabled&&(e[n.alreadyAutoCollectedFlag]=!0,n.trackRequest(o._client,{request:e,response:t},s)),typeof r=="function"&&r(e,t)})},n.prototype._initialize=function(){if(this._isInitialized=!0,!n.HANDLER_READY){n.HANDLER_READY=!0;var e=function(s){if(s){if(typeof s!="function")throw new Error("onRequest handler must be a function");return function(a,c){vg.CorrelationContextManager.wrapEmitter(a),vg.CorrelationContextManager.wrapEmitter(c);var l=a&&!a[n.alreadyAutoCollectedFlag];a&&l&&n.INSTANCE?n.INSTANCE._registerRequest(a,c,s):s(a,c)}}},t=function(s){var a=s.addListener.bind(s);s.addListener=function(c,l){switch(c){case"request":case"checkContinue":return a(c,e(l));default:return a(c,l)}},s.on=s.addListener},r=HFe.createServer;HFe.createServer=function(s,a){if(a&&typeof a=="function"){var c=r(s,e(a));return t(c),c}else{var c=r(e(s));return t(c),c}};var o=VFe.createServer;VFe.createServer=function(s,a){var c=o(s,e(a));return t(c),c}}},n.trackRequestSync=function(e,t){if(!t.request||!t.response||!e){GFe.info("AutoCollectHttpRequests.trackRequestSync was called with invalid parameters: ",!t.request,!t.response,!e);return}t.isProcessed=!1,n.addResponseCorrelationIdHeader(e,t.response);var r=vg.CorrelationContextManager.getCurrentContext(),o=new fce(t.request,r&&r.operation.parentId);r&&(r.operation.id=o.getOperationId(e.context.tags)||r.operation.id,r.operation.name=o.getOperationName(e.context.tags)||r.operation.name,r.operation.parentId=o.getRequestId()||r.operation.parentId,r.customProperties.addHeaderData(o.getCorrelationContextHeader())),n.endRequest(e,o,t,t.duration,t.error)},n.trackRequest=function(e,t,r){if(!t.request||!t.response||!e){GFe.info("AutoCollectHttpRequests.trackRequest was called with invalid parameters: ",!t.request,!t.response,!e);return}t.isProcessed=!1;var o=vg.CorrelationContextManager.getCurrentContext(),s=r||new fce(t.request,o&&o.operation.parentId);zFe.canIncludeCorrelationHeader(e,s.getUrl())&&n.addResponseCorrelationIdHeader(e,t.response),o&&!r&&(o.operation.id=s.getOperationId(e.context.tags)||o.operation.id,o.operation.name=s.getOperationName(e.context.tags)||o.operation.name,o.operation.parentId=s.getOperationParentId(e.context.tags)||o.operation.parentId,o.customProperties.addHeaderData(s.getCorrelationContextHeader())),t.response.once&&t.response.once("finish",function(){n.endRequest(e,s,t,null,null)}),t.request.on&&t.request.on("error",function(a){n.endRequest(e,s,t,null,a)}),t.request.on&&t.request.on("aborted",function(){var a="The request has been aborted and the network socket has closed.";n.endRequest(e,s,t,null,a)})},n.addResponseCorrelationIdHeader=function(e,t){if(e.config&&e.config.correlationId&&t.getHeader&&t.setHeader&&!t.headersSent){var r=t.getHeader(s1t.requestContextHeader);zFe.safeIncludeCorrelationHeader(e,t,r)}},n.endRequest=function(e,t,r,o,s){if(!r.isProcessed){r.isProcessed=!0,s?t.onError(s,o):t.onResponse(r.response,o);var a=t.getRequestTelemetry(r);if(a.tagOverrides=t.getRequestTags(e.context.tags),r.tagOverrides)for(var c in r.tagOverrides)a.tagOverrides[c]=r.tagOverrides[c];var l=t.getLegacyRootId();l&&(a.properties.ai_legacyRootId=l),a.contextObjects=a.contextObjects||{},a.contextObjects["http.ServerRequest"]=r.request,a.contextObjects["http.ServerResponse"]=r.response,e.trackRequest(a)}},n.prototype.dispose=function(){n.INSTANCE=null,this.enable(!1),this._isInitialized=!1,vg.CorrelationContextManager.disable(),this._isAutoCorrelating=!1},n.HANDLER_READY=!1,n.alreadyAutoCollectedFlag="_appInsightsAutoCollected",n}();$Fe.exports=c1t});var YFe=P((gce,KFe)=>{"use strict";var Yu=gce&&gce.__assign||function(){return Yu=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o])}return n},Yu.apply(this,arguments)},hce=require("os"),aI=Ea(),WFe=Oi(),l1t=ra(),u1t=li(),d1t=l1t.w3cTraceId(),p1t=function(){function n(){}return n.createQuickPulseEnvelope=function(e,t,r,o){var s=hce&&typeof hce.hostname=="function"&&hce.hostname()||"Unknown",a=o.tags&&o.keys&&o.keys.cloudRoleInstance&&o.tags[o.keys.cloudRoleInstance]||s,c=o.tags&&o.keys&&o.keys.cloudRole&&o.tags[o.keys.cloudRole]||null,l={Documents:t.length>0?t:null,InstrumentationKey:r.instrumentationKey||"",Metrics:e.length>0?e:null,InvariantVersion:1,Timestamp:"/Date("+Date.now()+")/",Version:o.tags[o.keys.internalSdkVersion],StreamId:d1t,MachineName:s,Instance:a,RoleName:c};return l},n.createQuickPulseMetric=function(e){var t;return t={Name:e.name,Value:e.value,Weight:e.count||1},t},n.telemetryEnvelopeToQuickPulseDocument=function(e){switch(e.data.baseType){case aI.TelemetryTypeString.Event:return n.createQuickPulseEventDocument(e);case aI.TelemetryTypeString.Exception:return n.createQuickPulseExceptionDocument(e);case aI.TelemetryTypeString.Trace:return n.createQuickPulseTraceDocument(e);case aI.TelemetryTypeString.Dependency:return n.createQuickPulseDependencyDocument(e);case aI.TelemetryTypeString.Request:return n.createQuickPulseRequestDocument(e)}return null},n.createQuickPulseEventDocument=function(e){var t=n.createQuickPulseDocument(e),r=e.data.baseData.name,o=Yu(Yu({},t),{Name:r});return o},n.createQuickPulseTraceDocument=function(e){var t=n.createQuickPulseDocument(e),r=e.data.baseData.severityLevel||0,o=Yu(Yu({},t),{Message:e.data.baseData.message,SeverityLevel:aI.SeverityLevel[r]});return o},n.createQuickPulseExceptionDocument=function(e){var t=n.createQuickPulseDocument(e),r=e.data.baseData.exceptions,o="",s="",a="";r&&r.length>0&&(r[0].parsedStack&&r[0].parsedStack.length>0?r[0].parsedStack.forEach(function(l){o+=l.assembly+`
`}):r[0].stack&&r[0].stack.length>0&&(o=r[0].stack),s=r[0].message,a=r[0].typeName);var c=Yu(Yu({},t),{Exception:o,ExceptionMessage:s,ExceptionType:a});return c},n.createQuickPulseRequestDocument=function(e){var t=n.createQuickPulseDocument(e),r=e.data.baseData,o=Yu(Yu({},t),{Name:r.name,Success:r.success,Duration:r.duration,ResponseCode:r.responseCode,OperationName:r.name});return o},n.createQuickPulseDependencyDocument=function(e){var t=n.createQuickPulseDocument(e),r=e.data.baseData,o=Yu(Yu({},t),{Name:r.name,Target:r.target,Success:r.success,Duration:r.duration,ResultCode:r.resultCode,CommandName:r.data,OperationName:t.OperationId,DependencyTypeName:r.type});return o},n.createQuickPulseDocument=function(e){var t,r,o,s;e.data.baseType?(r=WFe.TelemetryTypeStringToQuickPulseType[e.data.baseType],t=WFe.TelemetryTypeStringToQuickPulseDocumentType[e.data.baseType]):u1t.warn("Document type invalid; not sending live metric document",e.data.baseType),o=e.tags[n.keys.operationId],s=n.aggregateProperties(e);var a={DocumentType:t,__type:r,OperationId:o,Version:"1.0",Properties:s};return a},n.aggregateProperties=function(e){var t=[],r=e.data.baseData.measurements||{};for(var o in r)if(r.hasOwnProperty(o)){var s=r[o],a={key:o,value:s};t.push(a)}var c=e.data.baseData.properties||{};for(var o in c)if(c.hasOwnProperty(o)){var s=c[o],a={key:o,value:s};t.push(a)}return t},n.keys=new aI.ContextTagKeys,n}();KFe.exports=p1t});var XFe=P((Zir,QFe)=>{"use strict";var f1t=function(){return(Date.now()+621355968e5)*1e4};QFe.exports={getTransmissionTime:f1t}});var t5e=P((Q4,e5e)=>{"use strict";var JFe=Q4&&Q4.__awaiter||function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function c(d){try{u(r.next(d))}catch(p){a(p)}}function l(d){try{u(r.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((r=r.apply(n,e||[])).next())})},ZFe=Q4&&Q4.__generator||function(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,o=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(d){u=[6,d],o=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},m1t=require("https"),h1t=rP(),vce=li(),g1t=XFe(),yce=ra(),v1t=require("url"),Qu={method:"POST",time:"x-ms-qps-transmission-time",pollingIntervalHint:"x-ms-qps-service-polling-interval-hint",endpointRedirect:"x-ms-qps-service-endpoint-redirect-v2",instanceName:"x-ms-qps-instance-name",streamId:"x-ms-qps-stream-id",machineName:"x-ms-qps-machine-name",roleName:"x-ms-qps-role-name",streamid:"x-ms-qps-stream-id",invariantVersion:"x-ms-qps-invariant-version",subscribed:"x-ms-qps-subscribed"},y1t=function(){function n(e,t){this._config=e,this._consecutiveErrors=0,this._getAuthorizationHandler=t}return n.prototype.ping=function(e,t,r){var o=[{name:Qu.streamId,value:e.StreamId},{name:Qu.machineName,value:e.MachineName},{name:Qu.roleName,value:e.RoleName},{name:Qu.instanceName,value:e.Instance},{name:Qu.invariantVersion,value:e.InvariantVersion.toString()}];this._submitData(e,t,r,"ping",o)},n.prototype.post=function(e,t,r){return JFe(this,void 0,void 0,function(){return ZFe(this,function(o){switch(o.label){case 0:return[4,this._submitData([e],t,r,"post")];case 1:return o.sent(),[2]}})})},n.prototype._submitData=function(e,t,r,o,s){return JFe(this,void 0,void 0,function(){var a,c,l,u,d,p,f,m,h=this;return ZFe(this,function(g){switch(g.label){case 0:if(a=yce.stringify(e),c=(f={},f[h1t.disableCollectionRequestOption]=!0,f.host=t&&t.length>0?t:this._config.quickPulseHost,f.method=Qu.method,f.path="/QuickPulseService.svc/"+o+"?ikey="+this._config.instrumentationKey,f.headers=(m={Expect:"100-continue"},m[Qu.time]=g1t.getTransmissionTime(),m["Content-Type"]="application/json",m["Content-Length"]=Buffer.byteLength(a),m),f),s&&s.length>0&&s.forEach(function(y){return c.headers[y.name]=y.value}),o!=="post")return[3,4];if(l=this._getAuthorizationHandler?this._getAuthorizationHandler(this._config):null,!l)return[3,4];g.label=1;case 1:return g.trys.push([1,3,,4]),[4,l.addAuthorizationHeader(c)];case 2:return g.sent(),[3,4];case 3:return u=g.sent(),d="Failed to get AAD bearer token for the Application. Error:",vce.info(n.TAG,d,u),[2];case 4:return this._config.httpsAgent?c.agent=this._config.httpsAgent:c.agent=yce.tlsRestrictedAgent,p=m1t.request(c,function(y){if(y.statusCode==200){var b=y.headers[Qu.subscribed]==="true",_=null;try{_=y.headers[Qu.endpointRedirect]?new v1t.URL(y.headers[Qu.endpointRedirect].toString()).host:null}catch(I){h._onError("Failed to parse redirect header from QuickPulse: "+yce.dumpObj(I))}var x=y.headers[Qu.pollingIntervalHint]?parseInt(y.headers[Qu.pollingIntervalHint].toString()):null;h._consecutiveErrors=0,r(b,y,_,x)}else h._onError("StatusCode:"+y.statusCode+" StatusMessage:"+y.statusMessage),r()}),p.on("error",function(y){h._onError(y),r()}),p.write(a),p.end(),[2]}})})},n.prototype._onError=function(e){this._consecutiveErrors++;var t="Transient error connecting to the Live Metrics endpoint. This packet will not appear in your Live Metrics Stream. Error:";this._consecutiveErrors%n.MAX_QPS_FAILURES_BEFORE_WARN===0?(t="Live Metrics endpoint could not be reached "+this._consecutiveErrors+" consecutive times. Most recent error:",vce.warn(n.TAG,t,e)):vce.info(n.TAG,t,e)},n.TAG="QuickPulseSender",n.MAX_QPS_FAILURES_BEFORE_WARN=25,n}();e5e.exports=y1t});var s5e=P((X4,o5e)=>{"use strict";var n5e=X4&&X4.__awaiter||function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function c(d){try{u(r.next(d))}catch(p){a(p)}}function l(d){try{u(r.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((r=r.apply(n,e||[])).next())})},r5e=X4&&X4.__generator||function(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,o=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(d){u=[6,d],o=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},i5e=li(),bce=YFe(),b1t=t5e(),_1t=Oi(),x1t=QR(),S1t=function(){function n(e,t,r){this._isCollectingData=!1,this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0,this._metrics={},this._documents=[],this._collectors=[],this._redirectedHost=null,this._pollingIntervalHint=-1,this.config=e,this.context=t||new x1t,this._sender=new b1t(this.config,r),this._isEnabled=!1}return n.prototype.addCollector=function(e){this._collectors.push(e)},n.prototype.trackMetric=function(e){this._addMetric(e)},n.prototype.addDocument=function(e){if(this._isCollectingData){var t=bce.telemetryEnvelopeToQuickPulseDocument(e);t&&this._documents.push(t)}},n.prototype.enable=function(e){e&&!this._isEnabled?(this._isEnabled=!0,this._goQuickPulse()):!e&&this._isEnabled&&(this._isEnabled=!1,clearTimeout(this._handle),this._handle=void 0)},n.prototype.enableCollectors=function(e){this._collectors.forEach(function(t){t.enable(e)})},n.prototype._addMetric=function(e){var t=e.value,r=e.count||1,o=_1t.PerformanceToQuickPulseCounter[e.name];o&&(this._metrics[o]?(this._metrics[o].Value=(this._metrics[o].Value*this._metrics[o].Weight+t*r)/(this._metrics[o].Weight+r),this._metrics[o].Weight+=r):(this._metrics[o]=bce.createQuickPulseMetric(e),this._metrics[o].Name=o,this._metrics[o].Weight=1))},n.prototype._resetQuickPulseBuffer=function(){delete this._metrics,this._metrics={},this._documents.length=0},n.prototype._goQuickPulse=function(){return n5e(this,void 0,void 0,function(){var e,t,r,o,s=this;return r5e(this,function(a){switch(a.label){case 0:return e=Object.keys(this._metrics).map(function(c){return s._metrics[c]}),t=bce.createQuickPulseEnvelope(e,this._documents.slice(),this.config,this.context),this._resetQuickPulseBuffer(),this._isCollectingData?[4,this._post(t)]:[3,2];case 1:return a.sent(),[3,3];case 2:this._ping(t),a.label=3;case 3:return r=this._pollingIntervalHint>0?this._pollingIntervalHint:n.PING_INTERVAL,o=this._isCollectingData?n.POST_INTERVAL:r,this._isCollectingData&&Date.now()-this._lastSuccessTime>=n.MAX_POST_WAIT_TIME&&!this._lastSendSucceeded?(this._isCollectingData=!1,o=n.FALLBACK_INTERVAL):!this._isCollectingData&&Date.now()-this._lastSuccessTime>=n.MAX_PING_WAIT_TIME&&!this._lastSendSucceeded&&(o=n.FALLBACK_INTERVAL),this._lastSendSucceeded=null,this._handle=setTimeout(this._goQuickPulse.bind(this),o),this._handle.unref(),[2]}})})},n.prototype._ping=function(e){this._sender.ping(e,this._redirectedHost,this._quickPulseDone.bind(this))},n.prototype._post=function(e){return n5e(this,void 0,void 0,function(){return r5e(this,function(t){switch(t.label){case 0:return[4,this._sender.post(e,this._redirectedHost,this._quickPulseDone.bind(this))];case 1:return t.sent(),[2]}})})},n.prototype._quickPulseDone=function(e,t,r,o){e!=null?(this._isCollectingData!==e&&(i5e.info("Live Metrics sending data",e),this.enableCollectors(e)),this._isCollectingData=e,r&&r.length>0&&(this._redirectedHost=r,i5e.info("Redirecting endpoint to: ",r)),o&&o>0&&(this._pollingIntervalHint=o),t&&t.statusCode<300&&t.statusCode>=200?(this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0):this._lastSendSucceeded=!1):this._lastSendSucceeded=!1},n.MAX_POST_WAIT_TIME=2e4,n.MAX_PING_WAIT_TIME=6e4,n.FALLBACK_INTERVAL=6e4,n.PING_INTERVAL=5e3,n.POST_INTERVAL=1e3,n}();o5e.exports=S1t});var a5e=P(iP=>{"use strict";var YH=iP&&iP.__assign||function(){return YH=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o])}return n},YH.apply(this,arguments)};Object.defineProperty(iP,"__esModule",{value:!0});iP.AutoCollectNativePerformance=void 0;var J4=QR(),I1t=li(),T1t=function(){function n(e){this._disabledMetrics={},n.INSTANCE&&n.INSTANCE.dispose(),n.INSTANCE=this,this._client=e}return n.prototype.enable=function(e,t,r){var o=this;if(t===void 0&&(t={}),r===void 0&&(r=6e4),n._metricsAvailable==null&&e&&!this._isInitialized)try{var s=require("applicationinsights-native-metrics");n._emitter=new s,n._metricsAvailable=!0,I1t.info("Native metrics module successfully loaded!")}catch{n._metricsAvailable=!1;return}this._isEnabled=e,this._disabledMetrics=t,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),this._isEnabled&&n._emitter?(n._emitter.enable(!0,r),this._handle||(this._handle=setInterval(function(){return o._trackNativeMetrics()},r),this._handle.unref())):n._emitter&&(n._emitter.enable(!1),this._handle&&(clearInterval(this._handle),this._handle=void 0))},n.prototype.dispose=function(){this.enable(!1)},n.parseEnabled=function(e,t){var r=t.disableAllExtendedMetrics,o=t.extendedMetricDisablers;if(r)return{isEnabled:!1,disabledMetrics:{}};if(o){var s=o.split(","),a={};if(s.length>0)for(var c=0,l=s;c<l.length;c++){var u=l[c];a[u]=!0}return typeof e=="object"?{isEnabled:!0,disabledMetrics:YH(YH({},e),a)}:{isEnabled:e,disabledMetrics:a}}return typeof e=="boolean"?{isEnabled:e,disabledMetrics:{}}:{isEnabled:!0,disabledMetrics:e}},n.prototype._trackNativeMetrics=function(){var e=!0;typeof this._isEnabled!="object"&&(e=this._isEnabled),e&&(this._trackGarbageCollection(),this._trackEventLoop(),this._trackHeapUsage())},n.prototype._trackGarbageCollection=function(){var e;if(!this._disabledMetrics.gc){var t=n._emitter.getGCData();for(var r in t){var o=t[r].metrics,s=r+" Garbage Collection Duration",a=Math.sqrt(o.sumSquares/o.count-Math.pow(o.total/o.count,2))||0;this._client.trackMetric({name:s,value:o.total,count:o.count,max:o.max,min:o.min,stdDev:a,tagOverrides:(e={},e[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+J4.sdkVersion,e)})}}},n.prototype._trackEventLoop=function(){var e;if(!this._disabledMetrics.loop){var t=n._emitter.getLoopData(),r=t.loopUsage;if(r.count!=0){var o="Event Loop CPU Time",s=Math.sqrt(r.sumSquares/r.count-Math.pow(r.total/r.count,2))||0;this._client.trackMetric({name:o,value:r.total,count:r.count,min:r.min,max:r.max,stdDev:s,tagOverrides:(e={},e[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+J4.sdkVersion,e)})}}},n.prototype._trackHeapUsage=function(){var e,t,r;if(!this._disabledMetrics.heap){var o=process.memoryUsage(),s=o.heapUsed,a=o.heapTotal,c=o.rss;this._client.trackMetric({name:"Memory Usage (Heap)",value:s,count:1,tagOverrides:(e={},e[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+J4.sdkVersion,e)}),this._client.trackMetric({name:"Memory Total (Heap)",value:a,count:1,tagOverrides:(t={},t[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+J4.sdkVersion,t)}),this._client.trackMetric({name:"Memory Usage (Non-Heap)",value:c-a,count:1,tagOverrides:(r={},r[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+J4.sdkVersion,r)})}},n}();iP.AutoCollectNativePerformance=T1t});var u5e=P(vb=>{"use strict";var c5e=vb&&vb.__awaiter||function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function c(d){try{u(r.next(d))}catch(p){a(p)}}function l(d){try{u(r.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((r=r.apply(n,e||[])).next())})},l5e=vb&&vb.__generator||function(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,o=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(d){u=[6,d],o=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(vb,"__esModule",{value:!0});vb.AzureFunctionsHook=void 0;var QH=li(),_ce=ob(),C1t=function(){function n(e){this._client=e,this._autoGenerateIncomingRequests=!1;try{this._functionsCoreModule=require("@azure/functions-core"),this._addPreInvocationHook(),this._addPostInvocationHook()}catch{QH.info("AzureFunctionsHook failed to load, not running in Azure Functions")}}return n.prototype._getFuncModelHelper=function(){if(this._cachedModelHelper===void 0){var e=this._functionsCoreModule.getProgrammingModel();e.name==="@azure/functions"&&(e.version.startsWith("3.")?this._cachedModelHelper=new E1t:e.version.startsWith("4.")&&(this._cachedModelHelper=new w1t)),this._cachedModelHelper||(this._cachedModelHelper=null,QH.warn('AzureFunctionsHook does not support model "'+e.name+'" version "'+e.version+'"'))}return this._cachedModelHelper},n.prototype.enable=function(e){this._autoGenerateIncomingRequests=e},n.prototype.dispose=function(){this.enable(!1),this._removeInvocationHooks(),this._functionsCoreModule=void 0},n.prototype._addPreInvocationHook=function(){var e=this;this._preInvocationHook||(this._preInvocationHook=this._functionsCoreModule.registerHook("preInvocation",function(t){return c5e(e,void 0,void 0,function(){var r,o,s,a;return l5e(this,function(c){try{r=this._getFuncModelHelper(),r&&(o=t.invocationContext,s=_ce.CorrelationContextManager.startOperation(o),s&&(s.customProperties.setProperty("InvocationId",o.invocationId),a=o.traceContext,a.attributes&&(s.customProperties.setProperty("ProcessId",a.attributes.ProcessId),s.customProperties.setProperty("LogLevel",a.attributes.LogLevel),s.customProperties.setProperty("Category",a.attributes.Category),s.customProperties.setProperty("HostInstanceId",a.attributes.HostInstanceId),s.customProperties.setProperty("AzFuncLiveLogsSessionId",a.attributes["#AzFuncLiveLogsSessionId"])),t.functionCallback=_ce.CorrelationContextManager.wrapCallback(t.functionCallback,s),r.isHttpTrigger(t)&&this._autoGenerateIncomingRequests&&(t.hookData.appInsightsExtractedContext=s,t.hookData.appInsightsStartTime=Date.now())))}catch(l){return QH.warn("Failed to propagate context in Azure Functions",l),[2]}return[2]})})}))},n.prototype._addPostInvocationHook=function(){var e=this;this._postInvocationHook||(this._postInvocationHook=this._functionsCoreModule.registerHook("postInvocation",function(t){return c5e(e,void 0,void 0,function(){var r,o,s,a,c=this;return l5e(this,function(l){try{r=this._getFuncModelHelper(),r&&this._autoGenerateIncomingRequests&&r.isHttpTrigger(t)&&(o=t.inputs[0],o&&(s=t.hookData.appInsightsStartTime||Date.now(),a=t.hookData.appInsightsExtractedContext,a?_ce.CorrelationContextManager.runWithContext(a,function(){c._createIncomingRequestTelemetry(o,t,s,a.operation.parentId)}):this._createIncomingRequestTelemetry(o,t,s,null)))}catch(u){QH.warn("Error creating automatic incoming request in Azure Functions",u)}return[2]})})}))},n.prototype._createIncomingRequestTelemetry=function(e,t,r,o){var s=this._getFuncModelHelper().getStatusCodes(t),a=200;if(s)for(var c=0,l=s;c<l.length;c++){var u=l[c];if(typeof u=="number"&&Number.isInteger(u)){a=u;break}else if(typeof u=="string"){var d=parseInt(u);if(!isNaN(d)){a=d;break}}}else a=void 0;this._client.trackRequest({name:e.method+" "+e.url,resultCode:a,success:typeof a=="number"?0<a&&a<400:void 0,url:e.url,time:new Date(r),duration:Date.now()-r,id:o}),this._client.flush()},n.prototype._removeInvocationHooks=function(){this._preInvocationHook&&(this._preInvocationHook.dispose(),this._preInvocationHook=void 0),this._postInvocationHook&&(this._postInvocationHook.dispose(),this._postInvocationHook=void 0)},n}();vb.AzureFunctionsHook=C1t;var E1t=function(){function n(){}return n.prototype._getInvocationContext=function(e){return e.invocationContext},n.prototype.getStatusCodes=function(e){var t=this._getInvocationContext(e),r,o=t.bindingDefinitions.find(function(s){return s.direction==="out"&&s.type.toLowerCase()==="http"});return o?.name==="$return"?r=e.result:o&&t.bindings&&t.bindings[o.name]!==void 0?r=t.bindings[o.name]:r=t.res,r?[r.statusCode,r.status]:void 0},n.prototype.isHttpTrigger=function(e){var t=this._getInvocationContext(e);return!!t.bindingDefinitions.find(function(r){var o;return((o=r.type)===null||o===void 0?void 0:o.toLowerCase())==="httptrigger"})},n}(),w1t=function(){function n(){}return n.prototype._getInvocationContext=function(e){return e.invocationContext},n.prototype.getStatusCodes=function(e){var t=e.result;return t?[t.status]:void 0},n.prototype.isHttpTrigger=function(e){var t=this._getInvocationContext(e);return t.options.trigger.type.toLowerCase()==="httptrigger"},n}()});var xce=P((nor,f5e)=>{"use strict";var k1t=zS(),d5e=tce(),R1t=li(),p5e=Oi(),P1t=require("url"),A1t=Vq(),D1t=function(){function n(e){this._endpointBase=p5e.DEFAULT_BREEZE_ENDPOINT,this._mergeConfig();var t=this._connectionString,r=d5e.parse(e),o=d5e.parse(t),s=!r.instrumentationkey&&Object.keys(r).length>0?null:e,a=this._instrumentationKey;this.instrumentationKey=r.instrumentationkey||s||o.instrumentationkey||a;var c=""+(this.endpointUrl||r.ingestionendpoint||o.ingestionendpoint||this._endpointBase);c.endsWith("/")&&(c=c.slice(0,-1)),this.endpointUrl=c+"/v2.1/track",this.maxBatchSize=this.maxBatchSize||250,this.maxBatchIntervalMs=this.maxBatchIntervalMs||15e3,this.disableAppInsights=this.disableAppInsights||!1,this.samplingPercentage=this.samplingPercentage||100,this.correlationIdRetryIntervalMs=this.correlationIdRetryIntervalMs||30*1e3,this.enableWebInstrumentation=this.enableWebInstrumentation||this.enableAutoWebSnippetInjection||!1,this.webInstrumentationConfig=this.webInstrumentationConfig||null,this.enableAutoWebSnippetInjection=this.enableWebInstrumentation,this.correlationHeaderExcludedDomains=this.correlationHeaderExcludedDomains||["*.core.windows.net","*.core.chinacloudapi.cn","*.core.cloudapi.de","*.core.usgovcloudapi.net","*.core.microsoft.scloud","*.core.eaglex.ic.gov"],this.ignoreLegacyHeaders=this.ignoreLegacyHeaders||!1,this.profileQueryEndpoint=r.ingestionendpoint||o.ingestionendpoint||process.env[n.ENV_profileQueryEndpoint]||this._endpointBase,this.quickPulseHost=this.quickPulseHost||r.liveendpoint||o.liveendpoint||process.env[n.ENV_quickPulseHost]||p5e.DEFAULT_LIVEMETRICS_HOST,this.webInstrumentationConnectionString=this.webInstrumentationConnectionString||this._webInstrumentationConnectionString||"",this.webSnippetConnectionString=this.webInstrumentationConnectionString,this.quickPulseHost.match(/^https?:\/\//)&&(this.quickPulseHost=new P1t.URL(this.quickPulseHost).host),this.aadAudience=r.aadaudience||o.aadaudience}return Object.defineProperty(n.prototype,"profileQueryEndpoint",{get:function(){return this._profileQueryEndpoint},set:function(e){this._profileQueryEndpoint=e,this.correlationId=k1t.correlationIdPrefix},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"instrumentationKey",{get:function(){return this._instrumentationKey},set:function(e){n._validateInstrumentationKey(e)||R1t.warn("An invalid instrumentation key was provided. There may be resulting telemetry loss",this.instrumentationKey),this._instrumentationKey=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"webSnippetConnectionString",{get:function(){return this._webInstrumentationConnectionString},set:function(e){this._webInstrumentationConnectionString=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"webInstrumentationConnectionString",{get:function(){return this._webInstrumentationConnectionString},set:function(e){this._webInstrumentationConnectionString=e},enumerable:!1,configurable:!0}),n.prototype._mergeConfig=function(){var e=A1t.JsonConfig.getInstance();this._connectionString=e.connectionString,this._instrumentationKey=e.instrumentationKey,this.correlationHeaderExcludedDomains=e.correlationHeaderExcludedDomains,this.correlationIdRetryIntervalMs=e.correlationIdRetryIntervalMs,this.disableAllExtendedMetrics=e.disableAllExtendedMetrics,this.disableAppInsights=e.disableAppInsights,this.disableStatsbeat=e.disableStatsbeat,this.distributedTracingMode=e.distributedTracingMode,this.enableAutoCollectConsole=e.enableAutoCollectConsole,this.enableLoggerErrorToTrace=e.enableLoggerErrorToTrace,this.enableAutoCollectDependencies=e.enableAutoCollectDependencies,this.enableAutoCollectIncomingRequestAzureFunctions=e.enableAutoCollectIncomingRequestAzureFunctions,this.enableAutoCollectExceptions=e.enableAutoCollectExceptions,this.enableAutoCollectExtendedMetrics=e.enableAutoCollectExtendedMetrics,this.enableAutoCollectExternalLoggers=e.enableAutoCollectExternalLoggers,this.enableAutoCollectHeartbeat=e.enableAutoCollectHeartbeat,this.enableAutoCollectPerformance=e.enableAutoCollectPerformance,this.enableAutoCollectPreAggregatedMetrics=e.enableAutoCollectPreAggregatedMetrics,this.enableAutoCollectRequests=e.enableAutoCollectRequests,this.enableAutoDependencyCorrelation=e.enableAutoDependencyCorrelation,this.enableInternalDebugLogging=e.enableInternalDebugLogging,this.enableInternalWarningLogging=e.enableInternalWarningLogging,this.enableResendInterval=e.enableResendInterval,this.enableMaxBytesOnDisk=e.enableMaxBytesOnDisk,this.enableSendLiveMetrics=e.enableSendLiveMetrics,this.enableUseAsyncHooks=e.enableUseAsyncHooks,this.enableUseDiskRetryCaching=e.enableUseDiskRetryCaching,this.endpointUrl=e.endpointUrl,this.extendedMetricDisablers=e.extendedMetricDisablers,this.ignoreLegacyHeaders=e.ignoreLegacyHeaders,this.maxBatchIntervalMs=e.maxBatchIntervalMs,this.maxBatchSize=e.maxBatchSize,this.proxyHttpUrl=e.proxyHttpUrl,this.proxyHttpsUrl=e.proxyHttpsUrl,this.quickPulseHost=e.quickPulseHost,this.samplingPercentage=e.samplingPercentage,this.enableWebInstrumentation=e.enableWebInstrumentation,this._webInstrumentationConnectionString=e.webInstrumentationConnectionString,this.webInstrumentationConfig=e.webInstrumentationConfig,this.webInstrumentationSrc=e.webInstrumentationSrc},n._validateInstrumentationKey=function(e){var t="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",r=new RegExp(t);return r.test(e)},n.ENV_azurePrefix="APPSETTING_",n.ENV_iKey="APPINSIGHTS_INSTRUMENTATIONKEY",n.legacy_ENV_iKey="APPINSIGHTS_INSTRUMENTATION_KEY",n.ENV_profileQueryEndpoint="APPINSIGHTS_PROFILE_QUERY_ENDPOINT",n.ENV_quickPulseHost="APPINSIGHTS_QUICKPULSE_HOST",n}();f5e.exports=D1t});function XH(){return Sce.create()}var m5e,Sce,Ice=N(()=>{m5e=new Set(["Deserialize","Serialize","Retry","Sign"]),Sce=class n{constructor(e){var t;this._policies=[],this._policies=(t=e?.slice(0))!==null&&t!==void 0?t:[],this._orderedPolicies=void 0}addPolicy(e,t={}){if(t.phase&&t.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(t.phase&&!m5e.has(t.phase))throw new Error(`Invalid phase name: ${t.phase}`);if(t.afterPhase&&!m5e.has(t.afterPhase))throw new Error(`Invalid afterPhase name: ${t.afterPhase}`);this._policies.push({policy:e,options:t}),this._orderedPolicies=void 0}removePolicy(e){let t=[];return this._policies=this._policies.filter(r=>e.name&&r.policy.name===e.name||e.phase&&r.options.phase===e.phase?(t.push(r.policy),!1):!0),this._orderedPolicies=void 0,t}sendRequest(e,t){return this.getOrderedPolicies().reduceRight((s,a)=>c=>a.sendRequest(c,s),s=>e.sendRequest(s))(t)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new n(this._policies)}static create(){return new n}orderPolicies(){let e=[],t=new Map;function r(h){return{name:h,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}let o=r("Serialize"),s=r("None"),a=r("Deserialize"),c=r("Retry"),l=r("Sign"),u=[o,s,a,c,l];function d(h){return h==="Retry"?c:h==="Serialize"?o:h==="Deserialize"?a:h==="Sign"?l:s}for(let h of this._policies){let g=h.policy,y=h.options,b=g.name;if(t.has(b))throw new Error("Duplicate policy names not allowed in pipeline");let _={policy:g,dependsOn:new Set,dependants:new Set};y.afterPhase&&(_.afterPhase=d(y.afterPhase),_.afterPhase.hasAfterPolicies=!0),t.set(b,_),d(y.phase).policies.add(_)}for(let h of this._policies){let{policy:g,options:y}=h,b=g.name,_=t.get(b);if(!_)throw new Error(`Missing node for policy ${b}`);if(y.afterPolicies)for(let x of y.afterPolicies){let I=t.get(x);I&&(_.dependsOn.add(I),I.dependants.add(_))}if(y.beforePolicies)for(let x of y.beforePolicies){let I=t.get(x);I&&(I.dependsOn.add(_),_.dependants.add(I))}}function p(h){h.hasRun=!0;for(let g of h.policies)if(!(g.afterPhase&&(!g.afterPhase.hasRun||g.afterPhase.policies.size))&&g.dependsOn.size===0){e.push(g.policy);for(let y of g.dependants)y.dependsOn.delete(g);t.delete(g.policy.name),h.policies.delete(g)}}function f(){for(let h of u){if(p(h),h.policies.size>0&&h!==s){s.hasRun||p(s);return}h.hasAfterPolicies&&p(s)}}let m=0;for(;t.size>0;){m++;let h=e.length;if(f(),e.length<=h&&m>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}}});function v5e(n,...e){process.stderr.write(`${g5e.default.format(n,...e)}${h5e.EOL}`)}var h5e,g5e,y5e=N(()=>{h5e=require("os"),g5e=q(require("util"))});function Ece(n){_5e=n,Tce=[],Cce=[];let e=/\*/g,t=n.split(",").map(r=>r.trim().replace(e,".*?"));for(let r of t)r.startsWith("-")?Cce.push(new RegExp(`^${r.substr(1)}$`)):Tce.push(new RegExp(`^${r}$`));for(let r of JH)r.enabled=wce(r.namespace)}function wce(n){if(n.endsWith("*"))return!0;for(let e of Cce)if(e.test(n))return!1;for(let e of Tce)if(e.test(n))return!0;return!1}function N1t(){let n=_5e||"";return Ece(""),n}function S5e(n){let e=Object.assign(t,{enabled:wce(n),destroy:L1t,log:x5e.log,namespace:n,extend:O1t});function t(...r){e.enabled&&(r.length>0&&(r[0]=`${n} ${r[0]}`),e.log(...r))}return JH.push(e),e}function L1t(){let n=JH.indexOf(this);return n>=0?(JH.splice(n,1),!0):!1}function O1t(n){let e=S5e(`${this.namespace}:${n}`);return e.log=this.log,e}var b5e,_5e,Tce,Cce,JH,x5e,oP,I5e=N(()=>{y5e();b5e=typeof process<"u"&&process.env&&process.env.DEBUG||void 0,Tce=[],Cce=[],JH=[];b5e&&Ece(b5e);x5e=Object.assign(n=>S5e(n),{enable:Ece,enabled:wce,disable:N1t,log:v5e});oP=x5e});function M1t(n){if(n&&!k5e(n))throw new Error(`Unknown log level '${n}'. Acceptable values: ${Pce.join(",")}`);kce=n;let e=[];for(let t of C5e)w5e(t)&&e.push(t.namespace);oP.enable(e.join(","))}function tV(n){let e=Rce.extend(n);return E5e(Rce,e),{error:eV(e,"error"),warning:eV(e,"warning"),info:eV(e,"info"),verbose:eV(e,"verbose")}}function E5e(n,e){e.log=(...t)=>{n.log(...t)}}function eV(n,e){let t=Object.assign(n.extend(e),{level:e});if(E5e(n,t),w5e(t)){let r=oP.disable();oP.enable(r+","+t.namespace)}return C5e.add(t),t}function w5e(n){return!!(kce&&T5e[n.level]<=T5e[kce])}function k5e(n){return Pce.includes(n)}var C5e,ZH,kce,Rce,Pce,T5e,Ace=N(()=>{I5e();C5e=new Set,ZH=typeof process<"u"&&process.env&&process.env.AZURE_LOG_LEVEL||void 0,Rce=oP("azure");Rce.log=(...n)=>{oP.log(...n)};Pce=["verbose","info","warning","error"];ZH&&(k5e(ZH)?M1t(ZH):console.error(`AZURE_LOG_LEVEL set to unknown log level '${ZH}'; logging is not enabled. Acceptable values: ${Pce.join(", ")}.`));T5e={verbose:400,info:300,warning:200,error:100}});var aa,sP=N(()=>{Ace();aa=tV("core-rest-pipeline")});var Dce,nV,R5e=N(()=>{nV=typeof process<"u"&&!!process.version&&!!(!((Dce=process.versions)===null||Dce===void 0)&&Dce.node)});function Nce(n){if(n.aborted)return;n.onabort&&n.onabort.call(n);let e=aP.get(n);e&&e.slice().forEach(t=>{t.call(n,{type:"abort"})}),rV.set(n,!0)}var aP,rV,Z4,P5e=N(()=>{aP=new WeakMap,rV=new WeakMap,Z4=class n{constructor(){this.onabort=null,aP.set(this,[]),rV.set(this,!1)}get aborted(){if(!rV.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");return rV.get(this)}static get none(){return new n}addEventListener(e,t){if(!aP.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");aP.get(this).push(t)}removeEventListener(e,t){if(!aP.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");let r=aP.get(this),o=r.indexOf(t);o>-1&&r.splice(o,1)}dispatchEvent(e){throw new Error("This is a stub dispatchEvent implementation that should not be used.  It only exists for type-checking purposes.")}}});var am,eM,A5e=N(()=>{P5e();am=class extends Error{constructor(e){super(e),this.name="AbortError"}},eM=class{constructor(e){if(this._signal=new Z4,!!e){Array.isArray(e)||(e=arguments);for(let t of e)t.aborted?this.abort():t.addEventListener("abort",()=>{this.abort()})}}get signal(){return this._signal}abort(){Nce(this._signal)}static timeout(e){let t=new Z4,r=setTimeout(Nce,e,t);return typeof r.unref=="function"&&r.unref(),t}}});var iV=N(()=>{A5e()});function Lce(n,e){return n=Math.ceil(n),e=Math.floor(e),Math.floor(Math.random()*(e-n+1))+n}var D5e=N(()=>{});function tM(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)&&!(n instanceof RegExp)&&!(n instanceof Date)}var Oce=N(()=>{});function cP(n){if(tM(n)){let e=typeof n.name=="string",t=typeof n.message=="string";return e&&t}return!1}function lP(n){if(cP(n))return n.message;{let e;try{typeof n=="object"&&n?e=JSON.stringify(n):e=String(n)}catch{e="[unable to stringify input]"}return`Unknown error ${e}`}}var N5e=N(()=>{Oce()});var uP=N(()=>{R5e();D5e();Oce();N5e()});var Mce,F1t,U1t,dP,Fce=N(()=>{uP();Mce="REDACTED",F1t=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],U1t=["api-version"],dP=class{constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:t=[]}={}){e=F1t.concat(e),t=U1t.concat(t),this.allowedHeaderNames=new Set(e.map(r=>r.toLowerCase())),this.allowedQueryParameters=new Set(t.map(r=>r.toLowerCase()))}sanitize(e){let t=new Set;return JSON.stringify(e,(r,o)=>{if(o instanceof Error)return Object.assign(Object.assign({},o),{name:o.name,message:o.message});if(r==="headers")return this.sanitizeHeaders(o);if(r==="url")return this.sanitizeUrl(o);if(r==="query")return this.sanitizeQuery(o);if(r==="body")return;if(r==="response")return;if(r==="operationSpec")return;if(Array.isArray(o)||tM(o)){if(t.has(o))return"[Circular]";t.add(o)}return o},2)}sanitizeHeaders(e){let t={};for(let r of Object.keys(e))this.allowedHeaderNames.has(r.toLowerCase())?t[r]=e[r]:t[r]=Mce;return t}sanitizeQuery(e){if(typeof e!="object"||e===null)return e;let t={};for(let r of Object.keys(e))this.allowedQueryParameters.has(r.toLowerCase())?t[r]=e[r]:t[r]=Mce;return t}sanitizeUrl(e){if(typeof e!="string"||e===null)return e;let t=new URL(e);if(!t.search)return e;for(let[r]of t.searchParams)this.allowedQueryParameters.has(r.toLowerCase())||t.searchParams.set(r,Mce);return t.toString()}}});function oV(n={}){var e;let t=(e=n.logger)!==null&&e!==void 0?e:aa.info,r=new dP({additionalAllowedHeaderNames:n.additionalAllowedHeaderNames,additionalAllowedQueryParameters:n.additionalAllowedQueryParameters});return{name:Uce,async sendRequest(o,s){if(!t.enabled)return s(o);t(`Request: ${r.sanitize(o)}`);let a=await s(o);return t(`Response status code: ${a.status}`),t(`Headers: ${r.sanitize(a.headers)}`),a}}}var Uce,Bce=N(()=>{sP();Fce();Uce="logPolicy"});function sV(n={}){let{maxRetries:e=20}=n;return{name:qce,async sendRequest(t,r){let o=await r(t);return O5e(r,o,e)}}}async function O5e(n,e,t,r=0){let{request:o,status:s,headers:a}=e,c=a.get("location");if(c&&(s===300||s===301&&L5e.includes(o.method)||s===302&&L5e.includes(o.method)||s===303&&o.method==="POST"||s===307)&&r<t){let l=new URL(c,o.url);o.url=l.toString(),s===303&&(o.method="GET",o.headers.delete("Content-Length"),delete o.body),o.headers.delete("Authorization");let u=await n(o);return O5e(n,u,t,r+1)}return e}var qce,L5e,jce=N(()=>{qce="redirectPolicy",L5e=["GET","HEAD"]});function M5e(){return"User-Agent"}function F5e(n){n.set("Node",process.version),n.set("OS",`(${pP.arch()}-${pP.type()}-${pP.release()})`)}var pP,U5e=N(()=>{pP=q(require("os"))});var aV,Hce=N(()=>{aV="1.10.1"});function B1t(n){let e=[];for(let[t,r]of n){let o=r?`${t}/${r}`:t;e.push(o)}return e.join(" ")}function B5e(){return M5e()}function cV(n){let e=new Map;e.set("core-rest-pipeline",aV),F5e(e);let t=B1t(e);return n?`${n} ${t}`:t}var Vce=N(()=>{U5e();Hce()});function lV(n={}){let e=cV(n.userAgentPrefix);return{name:Gce,async sendRequest(t,r){return t.headers.has(q5e)||t.headers.set(q5e,e),r(t)}}}var q5e,Gce,zce=N(()=>{Vce();q5e=B5e(),Gce="userAgentPolicy"});function uV(){return{name:$ce,async sendRequest(n,e){return n.method!=="HEAD"&&n.headers.set("Accept-Encoding","gzip,deflate"),e(n)}}}var $ce,Wce=N(()=>{$ce="decompressResponsePolicy"});function dV(n,e,t){return new Promise((r,o)=>{let s,a,c=()=>o(new am(t?.abortErrorMsg?t?.abortErrorMsg:q1t)),l=()=>{t?.abortSignal&&a&&t.abortSignal.removeEventListener("abort",a)};if(a=()=>(s&&clearTimeout(s),l(),c()),t?.abortSignal&&t.abortSignal.aborted)return c();s=setTimeout(()=>{l(),r(e)},n),t?.abortSignal&&t.abortSignal.addEventListener("abort",a)})}function j5e(n,e){let t=n.headers.get(e);if(!t)return;let r=Number(t);if(!Number.isNaN(r))return r}var q1t,pV=N(()=>{iV();q1t="The operation was aborted."});function H5e(n){if(n&&[429,503].includes(n.status))try{for(let o of j1t){let s=j5e(n,o);if(s===0||s)return s*(o===Kce?1e3:1)}let e=n.headers.get(Kce);if(!e)return;let r=Date.parse(e)-Date.now();return Number.isFinite(r)?Math.max(0,r):void 0}catch{return}}function V5e(n){return Number.isFinite(H5e(n))}function fV(){return{name:"throttlingRetryStrategy",retry({response:n}){let e=H5e(n);return Number.isFinite(e)?{retryAfterInMs:e}:{skipStrategy:!0}}}}var Kce,j1t,mV=N(()=>{pV();Kce="Retry-After",j1t=["retry-after-ms","x-ms-retry-after-ms",Kce]});function fP(n={}){var e,t;let r=(e=n.retryDelayInMs)!==null&&e!==void 0?e:H1t,o=(t=n.maxRetryDelayInMs)!==null&&t!==void 0?t:V1t,s=r;return{name:"exponentialRetryStrategy",retry({retryCount:a,response:c,responseError:l}){let u=z1t(l),d=u&&n.ignoreSystemErrors,p=G1t(c),f=p&&n.ignoreHttpStatusCodes;if(c&&(V5e(c)||!p)||f||d)return{skipStrategy:!0};if(l&&!u&&!p)return{errorToThrow:l};let h=s*Math.pow(2,a),g=Math.min(o,h);return s=g/2+Lce(0,g/2),{retryAfterInMs:s}}}}function G1t(n){return!!(n&&n.status!==void 0&&(n.status>=500||n.status===408)&&n.status!==501&&n.status!==505)}function z1t(n){return n?n.code==="ETIMEDOUT"||n.code==="ESOCKETTIMEDOUT"||n.code==="ECONNREFUSED"||n.code==="ECONNRESET"||n.code==="ENOENT":!1}var H1t,V1t,hV=N(()=>{uP();mV();H1t=1e3,V1t=1e3*64});function cm(n,e={maxRetries:3}){let t=e.logger||G5e;return{name:$1t,async sendRequest(r,o){var s,a;let c,l,u=-1;e:for(;;){u+=1,c=void 0,l=void 0;try{t.info(`Retry ${u}: Attempting to send request`,r.requestId),c=await o(r),t.info(`Retry ${u}: Received a response from request`,r.requestId)}catch(d){if(t.error(`Retry ${u}: Received an error from request`,r.requestId),l=d,!d||l.name!=="RestError")throw d;c=l.response}if(!((s=r.abortSignal)===null||s===void 0)&&s.aborted)throw t.error(`Retry ${u}: Request aborted.`),new am;if(u>=((a=e.maxRetries)!==null&&a!==void 0?a:3)){if(t.info(`Retry ${u}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),l)throw l;if(c)return c;throw new Error("Maximum retries reached with no response or error to throw")}t.info(`Retry ${u}: Processing ${n.length} retry strategies.`);t:for(let d of n){let p=d.logger||G5e;p.info(`Retry ${u}: Processing retry strategy ${d.name}.`);let f=d.retry({retryCount:u,response:c,responseError:l});if(f.skipStrategy){p.info(`Retry ${u}: Skipped.`);continue t}let{errorToThrow:m,retryAfterInMs:h,redirectTo:g}=f;if(m)throw p.error(`Retry ${u}: Retry strategy ${d.name} throws error:`,m),m;if(h||h===0){p.info(`Retry ${u}: Retry strategy ${d.name} retries after ${h}`),await dV(h,void 0,{abortSignal:r.abortSignal});continue e}if(g){p.info(`Retry ${u}: Retry strategy ${d.name} redirects to ${g}`),r.url=g;continue e}}if(l)throw t.info("None of the retry strategies could work with the received error. Throwing it."),l;if(c)return t.info("None of the retry strategies could work with the received response. Returning it."),c}}}}var G5e,$1t,mP=N(()=>{pV();Ace();iV();G5e=tV("core-rest-pipeline retryPolicy"),$1t="retryPolicy"});function gV(n={}){var e;return{name:W1t,sendRequest:cm([fV(),fP(n)],{maxRetries:(e=n.maxRetries)!==null&&e!==void 0?e:3}).sendRequest}}var W1t,Yce=N(()=>{hV();mV();mP();W1t="defaultRetryPolicy"});var W5e=P((nsr,$5e)=>{var z5e=require("stream").Stream,K1t=require("util");$5e.exports=ap;function ap(){this.source=null,this.dataSize=0,this.maxDataSize=1024*1024,this.pauseStream=!0,this._maxDataSizeExceeded=!1,this._released=!1,this._bufferedEvents=[]}K1t.inherits(ap,z5e);ap.create=function(n,e){var t=new this;e=e||{};for(var r in e)t[r]=e[r];t.source=n;var o=n.emit;return n.emit=function(){return t._handleEmit(arguments),o.apply(n,arguments)},n.on("error",function(){}),t.pauseStream&&n.pause(),t};Object.defineProperty(ap.prototype,"readable",{configurable:!0,enumerable:!0,get:function(){return this.source.readable}});ap.prototype.setEncoding=function(){return this.source.setEncoding.apply(this.source,arguments)};ap.prototype.resume=function(){this._released||this.release(),this.source.resume()};ap.prototype.pause=function(){this.source.pause()};ap.prototype.release=function(){this._released=!0,this._bufferedEvents.forEach(function(n){this.emit.apply(this,n)}.bind(this)),this._bufferedEvents=[]};ap.prototype.pipe=function(){var n=z5e.prototype.pipe.apply(this,arguments);return this.resume(),n};ap.prototype._handleEmit=function(n){if(this._released){this.emit.apply(this,n);return}n[0]==="data"&&(this.dataSize+=n[1].length,this._checkIfMaxDataSizeExceeded()),this._bufferedEvents.push(n)};ap.prototype._checkIfMaxDataSizeExceeded=function(){if(!this._maxDataSizeExceeded&&!(this.dataSize<=this.maxDataSize)){this._maxDataSizeExceeded=!0;var n="DelayedStream#maxDataSize of "+this.maxDataSize+" bytes exceeded.";this.emit("error",new Error(n))}}});var X5e=P((rsr,Q5e)=>{var Y1t=require("util"),Y5e=require("stream").Stream,K5e=W5e();Q5e.exports=io;function io(){this.writable=!1,this.readable=!0,this.dataSize=0,this.maxDataSize=2*1024*1024,this.pauseStreams=!0,this._released=!1,this._streams=[],this._currentStream=null,this._insideLoop=!1,this._pendingNext=!1}Y1t.inherits(io,Y5e);io.create=function(n){var e=new this;n=n||{};for(var t in n)e[t]=n[t];return e};io.isStreamLike=function(n){return typeof n!="function"&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"&&!Buffer.isBuffer(n)};io.prototype.append=function(n){var e=io.isStreamLike(n);if(e){if(!(n instanceof K5e)){var t=K5e.create(n,{maxDataSize:1/0,pauseStream:this.pauseStreams});n.on("data",this._checkDataSize.bind(this)),n=t}this._handleErrors(n),this.pauseStreams&&n.pause()}return this._streams.push(n),this};io.prototype.pipe=function(n,e){return Y5e.prototype.pipe.call(this,n,e),this.resume(),n};io.prototype._getNext=function(){if(this._currentStream=null,this._insideLoop){this._pendingNext=!0;return}this._insideLoop=!0;try{do this._pendingNext=!1,this._realGetNext();while(this._pendingNext)}finally{this._insideLoop=!1}};io.prototype._realGetNext=function(){var n=this._streams.shift();if(typeof n>"u"){this.end();return}if(typeof n!="function"){this._pipeNext(n);return}var e=n;e(function(t){var r=io.isStreamLike(t);r&&(t.on("data",this._checkDataSize.bind(this)),this._handleErrors(t)),this._pipeNext(t)}.bind(this))};io.prototype._pipeNext=function(n){this._currentStream=n;var e=io.isStreamLike(n);if(e){n.on("end",this._getNext.bind(this)),n.pipe(this,{end:!1});return}var t=n;this.write(t),this._getNext()};io.prototype._handleErrors=function(n){var e=this;n.on("error",function(t){e._emitError(t)})};io.prototype.write=function(n){this.emit("data",n)};io.prototype.pause=function(){this.pauseStreams&&(this.pauseStreams&&this._currentStream&&typeof this._currentStream.pause=="function"&&this._currentStream.pause(),this.emit("pause"))};io.prototype.resume=function(){this._released||(this._released=!0,this.writable=!0,this._getNext()),this.pauseStreams&&this._currentStream&&typeof this._currentStream.resume=="function"&&this._currentStream.resume(),this.emit("resume")};io.prototype.end=function(){this._reset(),this.emit("end")};io.prototype.destroy=function(){this._reset(),this.emit("close")};io.prototype._reset=function(){this.writable=!1,this._streams=[],this._currentStream=null};io.prototype._checkDataSize=function(){if(this._updateDataSize(),!(this.dataSize<=this.maxDataSize)){var n="DelayedStream#maxDataSize of "+this.maxDataSize+" bytes exceeded.";this._emitError(new Error(n))}};io.prototype._updateDataSize=function(){this.dataSize=0;var n=this;this._streams.forEach(function(e){e.dataSize&&(n.dataSize+=e.dataSize)}),this._currentStream&&this._currentStream.dataSize&&(this.dataSize+=this._currentStream.dataSize)};io.prototype._emitError=function(n){this._reset(),this.emit("error",n)}});var J5e=P((isr,Q1t)=>{Q1t.exports={"application/1d-interleaved-parityfec":{source:"iana"},"application/3gpdash-qoe-report+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/3gpp-ims+xml":{source:"iana",compressible:!0},"application/3gpphal+json":{source:"iana",compressible:!0},"application/3gpphalforms+json":{source:"iana",compressible:!0},"application/a2l":{source:"iana"},"application/ace+cbor":{source:"iana"},"application/activemessage":{source:"iana"},"application/activity+json":{source:"iana",compressible:!0},"application/alto-costmap+json":{source:"iana",compressible:!0},"application/alto-costmapfilter+json":{source:"iana",compressible:!0},"application/alto-directory+json":{source:"iana",compressible:!0},"application/alto-endpointcost+json":{source:"iana",compressible:!0},"application/alto-endpointcostparams+json":{source:"iana",compressible:!0},"application/alto-endpointprop+json":{source:"iana",compressible:!0},"application/alto-endpointpropparams+json":{source:"iana",compressible:!0},"application/alto-error+json":{source:"iana",compressible:!0},"application/alto-networkmap+json":{source:"iana",compressible:!0},"application/alto-networkmapfilter+json":{source:"iana",compressible:!0},"application/alto-updatestreamcontrol+json":{source:"iana",compressible:!0},"application/alto-updatestreamparams+json":{source:"iana",compressible:!0},"application/aml":{source:"iana"},"application/andrew-inset":{source:"iana",extensions:["ez"]},"application/applefile":{source:"iana"},"application/applixware":{source:"apache",extensions:["aw"]},"application/at+jwt":{source:"iana"},"application/atf":{source:"iana"},"application/atfx":{source:"iana"},"application/atom+xml":{source:"iana",compressible:!0,extensions:["atom"]},"application/atomcat+xml":{source:"iana",compressible:!0,extensions:["atomcat"]},"application/atomdeleted+xml":{source:"iana",compressible:!0,extensions:["atomdeleted"]},"application/atomicmail":{source:"iana"},"application/atomsvc+xml":{source:"iana",compressible:!0,extensions:["atomsvc"]},"application/atsc-dwd+xml":{source:"iana",compressible:!0,extensions:["dwd"]},"application/atsc-dynamic-event-message":{source:"iana"},"application/atsc-held+xml":{source:"iana",compressible:!0,extensions:["held"]},"application/atsc-rdt+json":{source:"iana",compressible:!0},"application/atsc-rsat+xml":{source:"iana",compressible:!0,extensions:["rsat"]},"application/atxml":{source:"iana"},"application/auth-policy+xml":{source:"iana",compressible:!0},"application/bacnet-xdd+zip":{source:"iana",compressible:!1},"application/batch-smtp":{source:"iana"},"application/bdoc":{compressible:!1,extensions:["bdoc"]},"application/beep+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/calendar+json":{source:"iana",compressible:!0},"application/calendar+xml":{source:"iana",compressible:!0,extensions:["xcs"]},"application/call-completion":{source:"iana"},"application/cals-1840":{source:"iana"},"application/captive+json":{source:"iana",compressible:!0},"application/cbor":{source:"iana"},"application/cbor-seq":{source:"iana"},"application/cccex":{source:"iana"},"application/ccmp+xml":{source:"iana",compressible:!0},"application/ccxml+xml":{source:"iana",compressible:!0,extensions:["ccxml"]},"application/cdfx+xml":{source:"iana",compressible:!0,extensions:["cdfx"]},"application/cdmi-capability":{source:"iana",extensions:["cdmia"]},"application/cdmi-container":{source:"iana",extensions:["cdmic"]},"application/cdmi-domain":{source:"iana",extensions:["cdmid"]},"application/cdmi-object":{source:"iana",extensions:["cdmio"]},"application/cdmi-queue":{source:"iana",extensions:["cdmiq"]},"application/cdni":{source:"iana"},"application/cea":{source:"iana"},"application/cea-2018+xml":{source:"iana",compressible:!0},"application/cellml+xml":{source:"iana",compressible:!0},"application/cfw":{source:"iana"},"application/city+json":{source:"iana",compressible:!0},"application/clr":{source:"iana"},"application/clue+xml":{source:"iana",compressible:!0},"application/clue_info+xml":{source:"iana",compressible:!0},"application/cms":{source:"iana"},"application/cnrp+xml":{source:"iana",compressible:!0},"application/coap-group+json":{source:"iana",compressible:!0},"application/coap-payload":{source:"iana"},"application/commonground":{source:"iana"},"application/conference-info+xml":{source:"iana",compressible:!0},"application/cose":{source:"iana"},"application/cose-key":{source:"iana"},"application/cose-key-set":{source:"iana"},"application/cpl+xml":{source:"iana",compressible:!0,extensions:["cpl"]},"application/csrattrs":{source:"iana"},"application/csta+xml":{source:"iana",compressible:!0},"application/cstadata+xml":{source:"iana",compressible:!0},"application/csvm+json":{source:"iana",compressible:!0},"application/cu-seeme":{source:"apache",extensions:["cu"]},"application/cwt":{source:"iana"},"application/cybercash":{source:"iana"},"application/dart":{compressible:!0},"application/dash+xml":{source:"iana",compressible:!0,extensions:["mpd"]},"application/dash-patch+xml":{source:"iana",compressible:!0,extensions:["mpp"]},"application/dashdelta":{source:"iana"},"application/davmount+xml":{source:"iana",compressible:!0,extensions:["davmount"]},"application/dca-rft":{source:"iana"},"application/dcd":{source:"iana"},"application/dec-dx":{source:"iana"},"application/dialog-info+xml":{source:"iana",compressible:!0},"application/dicom":{source:"iana"},"application/dicom+json":{source:"iana",compressible:!0},"application/dicom+xml":{source:"iana",compressible:!0},"application/dii":{source:"iana"},"application/dit":{source:"iana"},"application/dns":{source:"iana"},"application/dns+json":{source:"iana",compressible:!0},"application/dns-message":{source:"iana"},"application/docbook+xml":{source:"apache",compressible:!0,extensions:["dbk"]},"application/dots+cbor":{source:"iana"},"application/dskpp+xml":{source:"iana",compressible:!0},"application/dssc+der":{source:"iana",extensions:["dssc"]},"application/dssc+xml":{source:"iana",compressible:!0,extensions:["xdssc"]},"application/dvcs":{source:"iana"},"application/ecmascript":{source:"iana",compressible:!0,extensions:["es","ecma"]},"application/edi-consent":{source:"iana"},"application/edi-x12":{source:"iana",compressible:!1},"application/edifact":{source:"iana",compressible:!1},"application/efi":{source:"iana"},"application/elm+json":{source:"iana",charset:"UTF-8",compressible:!0},"application/elm+xml":{source:"iana",compressible:!0},"application/emergencycalldata.cap+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/emergencycalldata.comment+xml":{source:"iana",compressible:!0},"application/emergencycalldata.control+xml":{source:"iana",compressible:!0},"application/emergencycalldata.deviceinfo+xml":{source:"iana",compressible:!0},"application/emergencycalldata.ecall.msd":{source:"iana"},"application/emergencycalldata.providerinfo+xml":{source:"iana",compressible:!0},"application/emergencycalldata.serviceinfo+xml":{source:"iana",compressible:!0},"application/emergencycalldata.subscriberinfo+xml":{source:"iana",compressible:!0},"application/emergencycalldata.veds+xml":{source:"iana",compressible:!0},"application/emma+xml":{source:"iana",compressible:!0,extensions:["emma"]},"application/emotionml+xml":{source:"iana",compressible:!0,extensions:["emotionml"]},"application/encaprtp":{source:"iana"},"application/epp+xml":{source:"iana",compressible:!0},"application/epub+zip":{source:"iana",compressible:!1,extensions:["epub"]},"application/eshop":{source:"iana"},"application/exi":{source:"iana",extensions:["exi"]},"application/expect-ct-report+json":{source:"iana",compressible:!0},"application/express":{source:"iana",extensions:["exp"]},"application/fastinfoset":{source:"iana"},"application/fastsoap":{source:"iana"},"application/fdt+xml":{source:"iana",compressible:!0,extensions:["fdt"]},"application/fhir+json":{source:"iana",charset:"UTF-8",compressible:!0},"application/fhir+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/fido.trusted-apps+json":{compressible:!0},"application/fits":{source:"iana"},"application/flexfec":{source:"iana"},"application/font-sfnt":{source:"iana"},"application/font-tdpfr":{source:"iana",extensions:["pfr"]},"application/font-woff":{source:"iana",compressible:!1},"application/framework-attributes+xml":{source:"iana",compressible:!0},"application/geo+json":{source:"iana",compressible:!0,extensions:["geojson"]},"application/geo+json-seq":{source:"iana"},"application/geopackage+sqlite3":{source:"iana"},"application/geoxacml+xml":{source:"iana",compressible:!0},"application/gltf-buffer":{source:"iana"},"application/gml+xml":{source:"iana",compressible:!0,extensions:["gml"]},"application/gpx+xml":{source:"apache",compressible:!0,extensions:["gpx"]},"application/gxf":{source:"apache",extensions:["gxf"]},"application/gzip":{source:"iana",compressible:!1,extensions:["gz"]},"application/h224":{source:"iana"},"application/held+xml":{source:"iana",compressible:!0},"application/hjson":{extensions:["hjson"]},"application/http":{source:"iana"},"application/hyperstudio":{source:"iana",extensions:["stk"]},"application/ibe-key-request+xml":{source:"iana",compressible:!0},"application/ibe-pkg-reply+xml":{source:"iana",compressible:!0},"application/ibe-pp-data":{source:"iana"},"application/iges":{source:"iana"},"application/im-iscomposing+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/index":{source:"iana"},"application/index.cmd":{source:"iana"},"application/index.obj":{source:"iana"},"application/index.response":{source:"iana"},"application/index.vnd":{source:"iana"},"application/inkml+xml":{source:"iana",compressible:!0,extensions:["ink","inkml"]},"application/iotp":{source:"iana"},"application/ipfix":{source:"iana",extensions:["ipfix"]},"application/ipp":{source:"iana"},"application/isup":{source:"iana"},"application/its+xml":{source:"iana",compressible:!0,extensions:["its"]},"application/java-archive":{source:"apache",compressible:!1,extensions:["jar","war","ear"]},"application/java-serialized-object":{source:"apache",compressible:!1,extensions:["ser"]},"application/java-vm":{source:"apache",compressible:!1,extensions:["class"]},"application/javascript":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["js","mjs"]},"application/jf2feed+json":{source:"iana",compressible:!0},"application/jose":{source:"iana"},"application/jose+json":{source:"iana",compressible:!0},"application/jrd+json":{source:"iana",compressible:!0},"application/jscalendar+json":{source:"iana",compressible:!0},"application/json":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["json","map"]},"application/json-patch+json":{source:"iana",compressible:!0},"application/json-seq":{source:"iana"},"application/json5":{extensions:["json5"]},"application/jsonml+json":{source:"apache",compressible:!0,extensions:["jsonml"]},"application/jwk+json":{source:"iana",compressible:!0},"application/jwk-set+json":{source:"iana",compressible:!0},"application/jwt":{source:"iana"},"application/kpml-request+xml":{source:"iana",compressible:!0},"application/kpml-response+xml":{source:"iana",compressible:!0},"application/ld+json":{source:"iana",compressible:!0,extensions:["jsonld"]},"application/lgr+xml":{source:"iana",compressible:!0,extensions:["lgr"]},"application/link-format":{source:"iana"},"application/load-control+xml":{source:"iana",compressible:!0},"application/lost+xml":{source:"iana",compressible:!0,extensions:["lostxml"]},"application/lostsync+xml":{source:"iana",compressible:!0},"application/lpf+zip":{source:"iana",compressible:!1},"application/lxf":{source:"iana"},"application/mac-binhex40":{source:"iana",extensions:["hqx"]},"application/mac-compactpro":{source:"apache",extensions:["cpt"]},"application/macwriteii":{source:"iana"},"application/mads+xml":{source:"iana",compressible:!0,extensions:["mads"]},"application/manifest+json":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["webmanifest"]},"application/marc":{source:"iana",extensions:["mrc"]},"application/marcxml+xml":{source:"iana",compressible:!0,extensions:["mrcx"]},"application/mathematica":{source:"iana",extensions:["ma","nb","mb"]},"application/mathml+xml":{source:"iana",compressible:!0,extensions:["mathml"]},"application/mathml-content+xml":{source:"iana",compressible:!0},"application/mathml-presentation+xml":{source:"iana",compressible:!0},"application/mbms-associated-procedure-description+xml":{source:"iana",compressible:!0},"application/mbms-deregister+xml":{source:"iana",compressible:!0},"application/mbms-envelope+xml":{source:"iana",compressible:!0},"application/mbms-msk+xml":{source:"iana",compressible:!0},"application/mbms-msk-response+xml":{source:"iana",compressible:!0},"application/mbms-protection-description+xml":{source:"iana",compressible:!0},"application/mbms-reception-report+xml":{source:"iana",compressible:!0},"application/mbms-register+xml":{source:"iana",compressible:!0},"application/mbms-register-response+xml":{source:"iana",compressible:!0},"application/mbms-schedule+xml":{source:"iana",compressible:!0},"application/mbms-user-service-description+xml":{source:"iana",compressible:!0},"application/mbox":{source:"iana",extensions:["mbox"]},"application/media-policy-dataset+xml":{source:"iana",compressible:!0,extensions:["mpf"]},"application/media_control+xml":{source:"iana",compressible:!0},"application/mediaservercontrol+xml":{source:"iana",compressible:!0,extensions:["mscml"]},"application/merge-patch+json":{source:"iana",compressible:!0},"application/metalink+xml":{source:"apache",compressible:!0,extensions:["metalink"]},"application/metalink4+xml":{source:"iana",compressible:!0,extensions:["meta4"]},"application/mets+xml":{source:"iana",compressible:!0,extensions:["mets"]},"application/mf4":{source:"iana"},"application/mikey":{source:"iana"},"application/mipc":{source:"iana"},"application/missing-blocks+cbor-seq":{source:"iana"},"application/mmt-aei+xml":{source:"iana",compressible:!0,extensions:["maei"]},"application/mmt-usd+xml":{source:"iana",compressible:!0,extensions:["musd"]},"application/mods+xml":{source:"iana",compressible:!0,extensions:["mods"]},"application/moss-keys":{source:"iana"},"application/moss-signature":{source:"iana"},"application/mosskey-data":{source:"iana"},"application/mosskey-request":{source:"iana"},"application/mp21":{source:"iana",extensions:["m21","mp21"]},"application/mp4":{source:"iana",extensions:["mp4s","m4p"]},"application/mpeg4-generic":{source:"iana"},"application/mpeg4-iod":{source:"iana"},"application/mpeg4-iod-xmt":{source:"iana"},"application/mrb-consumer+xml":{source:"iana",compressible:!0},"application/mrb-publish+xml":{source:"iana",compressible:!0},"application/msc-ivr+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/msc-mixer+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/msword":{source:"iana",compressible:!1,extensions:["doc","dot"]},"application/mud+json":{source:"iana",compressible:!0},"application/multipart-core":{source:"iana"},"application/mxf":{source:"iana",extensions:["mxf"]},"application/n-quads":{source:"iana",extensions:["nq"]},"application/n-triples":{source:"iana",extensions:["nt"]},"application/nasdata":{source:"iana"},"application/news-checkgroups":{source:"iana",charset:"US-ASCII"},"application/news-groupinfo":{source:"iana",charset:"US-ASCII"},"application/news-transmission":{source:"iana"},"application/nlsml+xml":{source:"iana",compressible:!0},"application/node":{source:"iana",extensions:["cjs"]},"application/nss":{source:"iana"},"application/oauth-authz-req+jwt":{source:"iana"},"application/oblivious-dns-message":{source:"iana"},"application/ocsp-request":{source:"iana"},"application/ocsp-response":{source:"iana"},"application/octet-stream":{source:"iana",compressible:!1,extensions:["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"]},"application/oda":{source:"iana",extensions:["oda"]},"application/odm+xml":{source:"iana",compressible:!0},"application/odx":{source:"iana"},"application/oebps-package+xml":{source:"iana",compressible:!0,extensions:["opf"]},"application/ogg":{source:"iana",compressible:!1,extensions:["ogx"]},"application/omdoc+xml":{source:"apache",compressible:!0,extensions:["omdoc"]},"application/onenote":{source:"apache",extensions:["onetoc","onetoc2","onetmp","onepkg"]},"application/opc-nodeset+xml":{source:"iana",compressible:!0},"application/oscore":{source:"iana"},"application/oxps":{source:"iana",extensions:["oxps"]},"application/p21":{source:"iana"},"application/p21+zip":{source:"iana",compressible:!1},"application/p2p-overlay+xml":{source:"iana",compressible:!0,extensions:["relo"]},"application/parityfec":{source:"iana"},"application/passport":{source:"iana"},"application/patch-ops-error+xml":{source:"iana",compressible:!0,extensions:["xer"]},"application/pdf":{source:"iana",compressible:!1,extensions:["pdf"]},"application/pdx":{source:"iana"},"application/pem-certificate-chain":{source:"iana"},"application/pgp-encrypted":{source:"iana",compressible:!1,extensions:["pgp"]},"application/pgp-keys":{source:"iana",extensions:["asc"]},"application/pgp-signature":{source:"iana",extensions:["asc","sig"]},"application/pics-rules":{source:"apache",extensions:["prf"]},"application/pidf+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/pidf-diff+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/pkcs10":{source:"iana",extensions:["p10"]},"application/pkcs12":{source:"iana"},"application/pkcs7-mime":{source:"iana",extensions:["p7m","p7c"]},"application/pkcs7-signature":{source:"iana",extensions:["p7s"]},"application/pkcs8":{source:"iana",extensions:["p8"]},"application/pkcs8-encrypted":{source:"iana"},"application/pkix-attr-cert":{source:"iana",extensions:["ac"]},"application/pkix-cert":{source:"iana",extensions:["cer"]},"application/pkix-crl":{source:"iana",extensions:["crl"]},"application/pkix-pkipath":{source:"iana",extensions:["pkipath"]},"application/pkixcmp":{source:"iana",extensions:["pki"]},"application/pls+xml":{source:"iana",compressible:!0,extensions:["pls"]},"application/poc-settings+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/postscript":{source:"iana",compressible:!0,extensions:["ai","eps","ps"]},"application/ppsp-tracker+json":{source:"iana",compressible:!0},"application/problem+json":{source:"iana",compressible:!0},"application/problem+xml":{source:"iana",compressible:!0},"application/provenance+xml":{source:"iana",compressible:!0,extensions:["provx"]},"application/prs.alvestrand.titrax-sheet":{source:"iana"},"application/prs.cww":{source:"iana",extensions:["cww"]},"application/prs.cyn":{source:"iana",charset:"7-BIT"},"application/prs.hpub+zip":{source:"iana",compressible:!1},"application/prs.nprend":{source:"iana"},"application/prs.plucker":{source:"iana"},"application/prs.rdf-xml-crypt":{source:"iana"},"application/prs.xsf+xml":{source:"iana",compressible:!0},"application/pskc+xml":{source:"iana",compressible:!0,extensions:["pskcxml"]},"application/pvd+json":{source:"iana",compressible:!0},"application/qsig":{source:"iana"},"application/raml+yaml":{compressible:!0,extensions:["raml"]},"application/raptorfec":{source:"iana"},"application/rdap+json":{source:"iana",compressible:!0},"application/rdf+xml":{source:"iana",compressible:!0,extensions:["rdf","owl"]},"application/reginfo+xml":{source:"iana",compressible:!0,extensions:["rif"]},"application/relax-ng-compact-syntax":{source:"iana",extensions:["rnc"]},"application/remote-printing":{source:"iana"},"application/reputon+json":{source:"iana",compressible:!0},"application/resource-lists+xml":{source:"iana",compressible:!0,extensions:["rl"]},"application/resource-lists-diff+xml":{source:"iana",compressible:!0,extensions:["rld"]},"application/rfc+xml":{source:"iana",compressible:!0},"application/riscos":{source:"iana"},"application/rlmi+xml":{source:"iana",compressible:!0},"application/rls-services+xml":{source:"iana",compressible:!0,extensions:["rs"]},"application/route-apd+xml":{source:"iana",compressible:!0,extensions:["rapd"]},"application/route-s-tsid+xml":{source:"iana",compressible:!0,extensions:["sls"]},"application/route-usd+xml":{source:"iana",compressible:!0,extensions:["rusd"]},"application/rpki-ghostbusters":{source:"iana",extensions:["gbr"]},"application/rpki-manifest":{source:"iana",extensions:["mft"]},"application/rpki-publication":{source:"iana"},"application/rpki-roa":{source:"iana",extensions:["roa"]},"application/rpki-updown":{source:"iana"},"application/rsd+xml":{source:"apache",compressible:!0,extensions:["rsd"]},"application/rss+xml":{source:"apache",compressible:!0,extensions:["rss"]},"application/rtf":{source:"iana",compressible:!0,extensions:["rtf"]},"application/rtploopback":{source:"iana"},"application/rtx":{source:"iana"},"application/samlassertion+xml":{source:"iana",compressible:!0},"application/samlmetadata+xml":{source:"iana",compressible:!0},"application/sarif+json":{source:"iana",compressible:!0},"application/sarif-external-properties+json":{source:"iana",compressible:!0},"application/sbe":{source:"iana"},"application/sbml+xml":{source:"iana",compressible:!0,extensions:["sbml"]},"application/scaip+xml":{source:"iana",compressible:!0},"application/scim+json":{source:"iana",compressible:!0},"application/scvp-cv-request":{source:"iana",extensions:["scq"]},"application/scvp-cv-response":{source:"iana",extensions:["scs"]},"application/scvp-vp-request":{source:"iana",extensions:["spq"]},"application/scvp-vp-response":{source:"iana",extensions:["spp"]},"application/sdp":{source:"iana",extensions:["sdp"]},"application/secevent+jwt":{source:"iana"},"application/senml+cbor":{source:"iana"},"application/senml+json":{source:"iana",compressible:!0},"application/senml+xml":{source:"iana",compressible:!0,extensions:["senmlx"]},"application/senml-etch+cbor":{source:"iana"},"application/senml-etch+json":{source:"iana",compressible:!0},"application/senml-exi":{source:"iana"},"application/sensml+cbor":{source:"iana"},"application/sensml+json":{source:"iana",compressible:!0},"application/sensml+xml":{source:"iana",compressible:!0,extensions:["sensmlx"]},"application/sensml-exi":{source:"iana"},"application/sep+xml":{source:"iana",compressible:!0},"application/sep-exi":{source:"iana"},"application/session-info":{source:"iana"},"application/set-payment":{source:"iana"},"application/set-payment-initiation":{source:"iana",extensions:["setpay"]},"application/set-registration":{source:"iana"},"application/set-registration-initiation":{source:"iana",extensions:["setreg"]},"application/sgml":{source:"iana"},"application/sgml-open-catalog":{source:"iana"},"application/shf+xml":{source:"iana",compressible:!0,extensions:["shf"]},"application/sieve":{source:"iana",extensions:["siv","sieve"]},"application/simple-filter+xml":{source:"iana",compressible:!0},"application/simple-message-summary":{source:"iana"},"application/simplesymbolcontainer":{source:"iana"},"application/sipc":{source:"iana"},"application/slate":{source:"iana"},"application/smil":{source:"iana"},"application/smil+xml":{source:"iana",compressible:!0,extensions:["smi","smil"]},"application/smpte336m":{source:"iana"},"application/soap+fastinfoset":{source:"iana"},"application/soap+xml":{source:"iana",compressible:!0},"application/sparql-query":{source:"iana",extensions:["rq"]},"application/sparql-results+xml":{source:"iana",compressible:!0,extensions:["srx"]},"application/spdx+json":{source:"iana",compressible:!0},"application/spirits-event+xml":{source:"iana",compressible:!0},"application/sql":{source:"iana"},"application/srgs":{source:"iana",extensions:["gram"]},"application/srgs+xml":{source:"iana",compressible:!0,extensions:["grxml"]},"application/sru+xml":{source:"iana",compressible:!0,extensions:["sru"]},"application/ssdl+xml":{source:"apache",compressible:!0,extensions:["ssdl"]},"application/ssml+xml":{source:"iana",compressible:!0,extensions:["ssml"]},"application/stix+json":{source:"iana",compressible:!0},"application/swid+xml":{source:"iana",compressible:!0,extensions:["swidtag"]},"application/tamp-apex-update":{source:"iana"},"application/tamp-apex-update-confirm":{source:"iana"},"application/tamp-community-update":{source:"iana"},"application/tamp-community-update-confirm":{source:"iana"},"application/tamp-error":{source:"iana"},"application/tamp-sequence-adjust":{source:"iana"},"application/tamp-sequence-adjust-confirm":{source:"iana"},"application/tamp-status-query":{source:"iana"},"application/tamp-status-response":{source:"iana"},"application/tamp-update":{source:"iana"},"application/tamp-update-confirm":{source:"iana"},"application/tar":{compressible:!0},"application/taxii+json":{source:"iana",compressible:!0},"application/td+json":{source:"iana",compressible:!0},"application/tei+xml":{source:"iana",compressible:!0,extensions:["tei","teicorpus"]},"application/tetra_isi":{source:"iana"},"application/thraud+xml":{source:"iana",compressible:!0,extensions:["tfi"]},"application/timestamp-query":{source:"iana"},"application/timestamp-reply":{source:"iana"},"application/timestamped-data":{source:"iana",extensions:["tsd"]},"application/tlsrpt+gzip":{source:"iana"},"application/tlsrpt+json":{source:"iana",compressible:!0},"application/tnauthlist":{source:"iana"},"application/token-introspection+jwt":{source:"iana"},"application/toml":{compressible:!0,extensions:["toml"]},"application/trickle-ice-sdpfrag":{source:"iana"},"application/trig":{source:"iana",extensions:["trig"]},"application/ttml+xml":{source:"iana",compressible:!0,extensions:["ttml"]},"application/tve-trigger":{source:"iana"},"application/tzif":{source:"iana"},"application/tzif-leap":{source:"iana"},"application/ubjson":{compressible:!1,extensions:["ubj"]},"application/ulpfec":{source:"iana"},"application/urc-grpsheet+xml":{source:"iana",compressible:!0},"application/urc-ressheet+xml":{source:"iana",compressible:!0,extensions:["rsheet"]},"application/urc-targetdesc+xml":{source:"iana",compressible:!0,extensions:["td"]},"application/urc-uisocketdesc+xml":{source:"iana",compressible:!0},"application/vcard+json":{source:"iana",compressible:!0},"application/vcard+xml":{source:"iana",compressible:!0},"application/vemmi":{source:"iana"},"application/vividence.scriptfile":{source:"apache"},"application/vnd.1000minds.decision-model+xml":{source:"iana",compressible:!0,extensions:["1km"]},"application/vnd.3gpp-prose+xml":{source:"iana",compressible:!0},"application/vnd.3gpp-prose-pc3ch+xml":{source:"iana",compressible:!0},"application/vnd.3gpp-v2x-local-service-information":{source:"iana"},"application/vnd.3gpp.5gnas":{source:"iana"},"application/vnd.3gpp.access-transfer-events+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.bsf+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.gmop+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.gtpc":{source:"iana"},"application/vnd.3gpp.interworking-data":{source:"iana"},"application/vnd.3gpp.lpp":{source:"iana"},"application/vnd.3gpp.mc-signalling-ear":{source:"iana"},"application/vnd.3gpp.mcdata-affiliation-command+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcdata-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcdata-payload":{source:"iana"},"application/vnd.3gpp.mcdata-service-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcdata-signalling":{source:"iana"},"application/vnd.3gpp.mcdata-ue-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcdata-user-profile+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-affiliation-command+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-floor-request+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-location-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-mbms-usage-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-service-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-signed+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-ue-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-ue-init-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-user-profile+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-affiliation-command+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-affiliation-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-location-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-mbms-usage-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-service-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-transmission-request+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-ue-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-user-profile+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mid-call+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.ngap":{source:"iana"},"application/vnd.3gpp.pfcp":{source:"iana"},"application/vnd.3gpp.pic-bw-large":{source:"iana",extensions:["plb"]},"application/vnd.3gpp.pic-bw-small":{source:"iana",extensions:["psb"]},"application/vnd.3gpp.pic-bw-var":{source:"iana",extensions:["pvb"]},"application/vnd.3gpp.s1ap":{source:"iana"},"application/vnd.3gpp.sms":{source:"iana"},"application/vnd.3gpp.sms+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.srvcc-ext+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.srvcc-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.state-and-event-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.ussd+xml":{source:"iana",compressible:!0},"application/vnd.3gpp2.bcmcsinfo+xml":{source:"iana",compressible:!0},"application/vnd.3gpp2.sms":{source:"iana"},"application/vnd.3gpp2.tcap":{source:"iana",extensions:["tcap"]},"application/vnd.3lightssoftware.imagescal":{source:"iana"},"application/vnd.3m.post-it-notes":{source:"iana",extensions:["pwn"]},"application/vnd.accpac.simply.aso":{source:"iana",extensions:["aso"]},"application/vnd.accpac.simply.imp":{source:"iana",extensions:["imp"]},"application/vnd.acucobol":{source:"iana",extensions:["acu"]},"application/vnd.acucorp":{source:"iana",extensions:["atc","acutc"]},"application/vnd.adobe.air-application-installer-package+zip":{source:"apache",compressible:!1,extensions:["air"]},"application/vnd.adobe.flash.movie":{source:"iana"},"application/vnd.adobe.formscentral.fcdt":{source:"iana",extensions:["fcdt"]},"application/vnd.adobe.fxp":{source:"iana",extensions:["fxp","fxpl"]},"application/vnd.adobe.partial-upload":{source:"iana"},"application/vnd.adobe.xdp+xml":{source:"iana",compressible:!0,extensions:["xdp"]},"application/vnd.adobe.xfdf":{source:"iana",extensions:["xfdf"]},"application/vnd.aether.imp":{source:"iana"},"application/vnd.afpc.afplinedata":{source:"iana"},"application/vnd.afpc.afplinedata-pagedef":{source:"iana"},"application/vnd.afpc.cmoca-cmresource":{source:"iana"},"application/vnd.afpc.foca-charset":{source:"iana"},"application/vnd.afpc.foca-codedfont":{source:"iana"},"application/vnd.afpc.foca-codepage":{source:"iana"},"application/vnd.afpc.modca":{source:"iana"},"application/vnd.afpc.modca-cmtable":{source:"iana"},"application/vnd.afpc.modca-formdef":{source:"iana"},"application/vnd.afpc.modca-mediummap":{source:"iana"},"application/vnd.afpc.modca-objectcontainer":{source:"iana"},"application/vnd.afpc.modca-overlay":{source:"iana"},"application/vnd.afpc.modca-pagesegment":{source:"iana"},"application/vnd.age":{source:"iana",extensions:["age"]},"application/vnd.ah-barcode":{source:"iana"},"application/vnd.ahead.space":{source:"iana",extensions:["ahead"]},"application/vnd.airzip.filesecure.azf":{source:"iana",extensions:["azf"]},"application/vnd.airzip.filesecure.azs":{source:"iana",extensions:["azs"]},"application/vnd.amadeus+json":{source:"iana",compressible:!0},"application/vnd.amazon.ebook":{source:"apache",extensions:["azw"]},"application/vnd.amazon.mobi8-ebook":{source:"iana"},"application/vnd.americandynamics.acc":{source:"iana",extensions:["acc"]},"application/vnd.amiga.ami":{source:"iana",extensions:["ami"]},"application/vnd.amundsen.maze+xml":{source:"iana",compressible:!0},"application/vnd.android.ota":{source:"iana"},"application/vnd.android.package-archive":{source:"apache",compressible:!1,extensions:["apk"]},"application/vnd.anki":{source:"iana"},"application/vnd.anser-web-certificate-issue-initiation":{source:"iana",extensions:["cii"]},"application/vnd.anser-web-funds-transfer-initiation":{source:"apache",extensions:["fti"]},"application/vnd.antix.game-component":{source:"iana",extensions:["atx"]},"application/vnd.apache.arrow.file":{source:"iana"},"application/vnd.apache.arrow.stream":{source:"iana"},"application/vnd.apache.thrift.binary":{source:"iana"},"application/vnd.apache.thrift.compact":{source:"iana"},"application/vnd.apache.thrift.json":{source:"iana"},"application/vnd.api+json":{source:"iana",compressible:!0},"application/vnd.aplextor.warrp+json":{source:"iana",compressible:!0},"application/vnd.apothekende.reservation+json":{source:"iana",compressible:!0},"application/vnd.apple.installer+xml":{source:"iana",compressible:!0,extensions:["mpkg"]},"application/vnd.apple.keynote":{source:"iana",extensions:["key"]},"application/vnd.apple.mpegurl":{source:"iana",extensions:["m3u8"]},"application/vnd.apple.numbers":{source:"iana",extensions:["numbers"]},"application/vnd.apple.pages":{source:"iana",extensions:["pages"]},"application/vnd.apple.pkpass":{compressible:!1,extensions:["pkpass"]},"application/vnd.arastra.swi":{source:"iana"},"application/vnd.aristanetworks.swi":{source:"iana",extensions:["swi"]},"application/vnd.artisan+json":{source:"iana",compressible:!0},"application/vnd.artsquare":{source:"iana"},"application/vnd.astraea-software.iota":{source:"iana",extensions:["iota"]},"application/vnd.audiograph":{source:"iana",extensions:["aep"]},"application/vnd.autopackage":{source:"iana"},"application/vnd.avalon+json":{source:"iana",compressible:!0},"application/vnd.avistar+xml":{source:"iana",compressible:!0},"application/vnd.balsamiq.bmml+xml":{source:"iana",compressible:!0,extensions:["bmml"]},"application/vnd.balsamiq.bmpr":{source:"iana"},"application/vnd.banana-accounting":{source:"iana"},"application/vnd.bbf.usp.error":{source:"iana"},"application/vnd.bbf.usp.msg":{source:"iana"},"application/vnd.bbf.usp.msg+json":{source:"iana",compressible:!0},"application/vnd.bekitzur-stech+json":{source:"iana",compressible:!0},"application/vnd.bint.med-content":{source:"iana"},"application/vnd.biopax.rdf+xml":{source:"iana",compressible:!0},"application/vnd.blink-idb-value-wrapper":{source:"iana"},"application/vnd.blueice.multipass":{source:"iana",extensions:["mpm"]},"application/vnd.bluetooth.ep.oob":{source:"iana"},"application/vnd.bluetooth.le.oob":{source:"iana"},"application/vnd.bmi":{source:"iana",extensions:["bmi"]},"application/vnd.bpf":{source:"iana"},"application/vnd.bpf3":{source:"iana"},"application/vnd.businessobjects":{source:"iana",extensions:["rep"]},"application/vnd.byu.uapi+json":{source:"iana",compressible:!0},"application/vnd.cab-jscript":{source:"iana"},"application/vnd.canon-cpdl":{source:"iana"},"application/vnd.canon-lips":{source:"iana"},"application/vnd.capasystems-pg+json":{source:"iana",compressible:!0},"application/vnd.cendio.thinlinc.clientconf":{source:"iana"},"application/vnd.century-systems.tcp_stream":{source:"iana"},"application/vnd.chemdraw+xml":{source:"iana",compressible:!0,extensions:["cdxml"]},"application/vnd.chess-pgn":{source:"iana"},"application/vnd.chipnuts.karaoke-mmd":{source:"iana",extensions:["mmd"]},"application/vnd.ciedi":{source:"iana"},"application/vnd.cinderella":{source:"iana",extensions:["cdy"]},"application/vnd.cirpack.isdn-ext":{source:"iana"},"application/vnd.citationstyles.style+xml":{source:"iana",compressible:!0,extensions:["csl"]},"application/vnd.claymore":{source:"iana",extensions:["cla"]},"application/vnd.cloanto.rp9":{source:"iana",extensions:["rp9"]},"application/vnd.clonk.c4group":{source:"iana",extensions:["c4g","c4d","c4f","c4p","c4u"]},"application/vnd.cluetrust.cartomobile-config":{source:"iana",extensions:["c11amc"]},"application/vnd.cluetrust.cartomobile-config-pkg":{source:"iana",extensions:["c11amz"]},"application/vnd.coffeescript":{source:"iana"},"application/vnd.collabio.xodocuments.document":{source:"iana"},"application/vnd.collabio.xodocuments.document-template":{source:"iana"},"application/vnd.collabio.xodocuments.presentation":{source:"iana"},"application/vnd.collabio.xodocuments.presentation-template":{source:"iana"},"application/vnd.collabio.xodocuments.spreadsheet":{source:"iana"},"application/vnd.collabio.xodocuments.spreadsheet-template":{source:"iana"},"application/vnd.collection+json":{source:"iana",compressible:!0},"application/vnd.collection.doc+json":{source:"iana",compressible:!0},"application/vnd.collection.next+json":{source:"iana",compressible:!0},"application/vnd.comicbook+zip":{source:"iana",compressible:!1},"application/vnd.comicbook-rar":{source:"iana"},"application/vnd.commerce-battelle":{source:"iana"},"application/vnd.commonspace":{source:"iana",extensions:["csp"]},"application/vnd.contact.cmsg":{source:"iana",extensions:["cdbcmsg"]},"application/vnd.coreos.ignition+json":{source:"iana",compressible:!0},"application/vnd.cosmocaller":{source:"iana",extensions:["cmc"]},"application/vnd.crick.clicker":{source:"iana",extensions:["clkx"]},"application/vnd.crick.clicker.keyboard":{source:"iana",extensions:["clkk"]},"application/vnd.crick.clicker.palette":{source:"iana",extensions:["clkp"]},"application/vnd.crick.clicker.template":{source:"iana",extensions:["clkt"]},"application/vnd.crick.clicker.wordbank":{source:"iana",extensions:["clkw"]},"application/vnd.criticaltools.wbs+xml":{source:"iana",compressible:!0,extensions:["wbs"]},"application/vnd.cryptii.pipe+json":{source:"iana",compressible:!0},"application/vnd.crypto-shade-file":{source:"iana"},"application/vnd.cryptomator.encrypted":{source:"iana"},"application/vnd.cryptomator.vault":{source:"iana"},"application/vnd.ctc-posml":{source:"iana",extensions:["pml"]},"application/vnd.ctct.ws+xml":{source:"iana",compressible:!0},"application/vnd.cups-pdf":{source:"iana"},"application/vnd.cups-postscript":{source:"iana"},"application/vnd.cups-ppd":{source:"iana",extensions:["ppd"]},"application/vnd.cups-raster":{source:"iana"},"application/vnd.cups-raw":{source:"iana"},"application/vnd.curl":{source:"iana"},"application/vnd.curl.car":{source:"apache",extensions:["car"]},"application/vnd.curl.pcurl":{source:"apache",extensions:["pcurl"]},"application/vnd.cyan.dean.root+xml":{source:"iana",compressible:!0},"application/vnd.cybank":{source:"iana"},"application/vnd.cyclonedx+json":{source:"iana",compressible:!0},"application/vnd.cyclonedx+xml":{source:"iana",compressible:!0},"application/vnd.d2l.coursepackage1p0+zip":{source:"iana",compressible:!1},"application/vnd.d3m-dataset":{source:"iana"},"application/vnd.d3m-problem":{source:"iana"},"application/vnd.dart":{source:"iana",compressible:!0,extensions:["dart"]},"application/vnd.data-vision.rdz":{source:"iana",extensions:["rdz"]},"application/vnd.datapackage+json":{source:"iana",compressible:!0},"application/vnd.dataresource+json":{source:"iana",compressible:!0},"application/vnd.dbf":{source:"iana",extensions:["dbf"]},"application/vnd.debian.binary-package":{source:"iana"},"application/vnd.dece.data":{source:"iana",extensions:["uvf","uvvf","uvd","uvvd"]},"application/vnd.dece.ttml+xml":{source:"iana",compressible:!0,extensions:["uvt","uvvt"]},"application/vnd.dece.unspecified":{source:"iana",extensions:["uvx","uvvx"]},"application/vnd.dece.zip":{source:"iana",extensions:["uvz","uvvz"]},"application/vnd.denovo.fcselayout-link":{source:"iana",extensions:["fe_launch"]},"application/vnd.desmume.movie":{source:"iana"},"application/vnd.dir-bi.plate-dl-nosuffix":{source:"iana"},"application/vnd.dm.delegation+xml":{source:"iana",compressible:!0},"application/vnd.dna":{source:"iana",extensions:["dna"]},"application/vnd.document+json":{source:"iana",compressible:!0},"application/vnd.dolby.mlp":{source:"apache",extensions:["mlp"]},"application/vnd.dolby.mobile.1":{source:"iana"},"application/vnd.dolby.mobile.2":{source:"iana"},"application/vnd.doremir.scorecloud-binary-document":{source:"iana"},"application/vnd.dpgraph":{source:"iana",extensions:["dpg"]},"application/vnd.dreamfactory":{source:"iana",extensions:["dfac"]},"application/vnd.drive+json":{source:"iana",compressible:!0},"application/vnd.ds-keypoint":{source:"apache",extensions:["kpxx"]},"application/vnd.dtg.local":{source:"iana"},"application/vnd.dtg.local.flash":{source:"iana"},"application/vnd.dtg.local.html":{source:"iana"},"application/vnd.dvb.ait":{source:"iana",extensions:["ait"]},"application/vnd.dvb.dvbisl+xml":{source:"iana",compressible:!0},"application/vnd.dvb.dvbj":{source:"iana"},"application/vnd.dvb.esgcontainer":{source:"iana"},"application/vnd.dvb.ipdcdftnotifaccess":{source:"iana"},"application/vnd.dvb.ipdcesgaccess":{source:"iana"},"application/vnd.dvb.ipdcesgaccess2":{source:"iana"},"application/vnd.dvb.ipdcesgpdd":{source:"iana"},"application/vnd.dvb.ipdcroaming":{source:"iana"},"application/vnd.dvb.iptv.alfec-base":{source:"iana"},"application/vnd.dvb.iptv.alfec-enhancement":{source:"iana"},"application/vnd.dvb.notif-aggregate-root+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-container+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-generic+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-ia-msglist+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-ia-registration-request+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-ia-registration-response+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-init+xml":{source:"iana",compressible:!0},"application/vnd.dvb.pfr":{source:"iana"},"application/vnd.dvb.service":{source:"iana",extensions:["svc"]},"application/vnd.dxr":{source:"iana"},"application/vnd.dynageo":{source:"iana",extensions:["geo"]},"application/vnd.dzr":{source:"iana"},"application/vnd.easykaraoke.cdgdownload":{source:"iana"},"application/vnd.ecdis-update":{source:"iana"},"application/vnd.ecip.rlp":{source:"iana"},"application/vnd.eclipse.ditto+json":{source:"iana",compressible:!0},"application/vnd.ecowin.chart":{source:"iana",extensions:["mag"]},"application/vnd.ecowin.filerequest":{source:"iana"},"application/vnd.ecowin.fileupdate":{source:"iana"},"application/vnd.ecowin.series":{source:"iana"},"application/vnd.ecowin.seriesrequest":{source:"iana"},"application/vnd.ecowin.seriesupdate":{source:"iana"},"application/vnd.efi.img":{source:"iana"},"application/vnd.efi.iso":{source:"iana"},"application/vnd.emclient.accessrequest+xml":{source:"iana",compressible:!0},"application/vnd.enliven":{source:"iana",extensions:["nml"]},"application/vnd.enphase.envoy":{source:"iana"},"application/vnd.eprints.data+xml":{source:"iana",compressible:!0},"application/vnd.epson.esf":{source:"iana",extensions:["esf"]},"application/vnd.epson.msf":{source:"iana",extensions:["msf"]},"application/vnd.epson.quickanime":{source:"iana",extensions:["qam"]},"application/vnd.epson.salt":{source:"iana",extensions:["slt"]},"application/vnd.epson.ssf":{source:"iana",extensions:["ssf"]},"application/vnd.ericsson.quickcall":{source:"iana"},"application/vnd.espass-espass+zip":{source:"iana",compressible:!1},"application/vnd.eszigno3+xml":{source:"iana",compressible:!0,extensions:["es3","et3"]},"application/vnd.etsi.aoc+xml":{source:"iana",compressible:!0},"application/vnd.etsi.asic-e+zip":{source:"iana",compressible:!1},"application/vnd.etsi.asic-s+zip":{source:"iana",compressible:!1},"application/vnd.etsi.cug+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvcommand+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvdiscovery+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvprofile+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvsad-bc+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvsad-cod+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvsad-npvr+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvservice+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvsync+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvueprofile+xml":{source:"iana",compressible:!0},"application/vnd.etsi.mcid+xml":{source:"iana",compressible:!0},"application/vnd.etsi.mheg5":{source:"iana"},"application/vnd.etsi.overload-control-policy-dataset+xml":{source:"iana",compressible:!0},"application/vnd.etsi.pstn+xml":{source:"iana",compressible:!0},"application/vnd.etsi.sci+xml":{source:"iana",compressible:!0},"application/vnd.etsi.simservs+xml":{source:"iana",compressible:!0},"application/vnd.etsi.timestamp-token":{source:"iana"},"application/vnd.etsi.tsl+xml":{source:"iana",compressible:!0},"application/vnd.etsi.tsl.der":{source:"iana"},"application/vnd.eu.kasparian.car+json":{source:"iana",compressible:!0},"application/vnd.eudora.data":{source:"iana"},"application/vnd.evolv.ecig.profile":{source:"iana"},"application/vnd.evolv.ecig.settings":{source:"iana"},"application/vnd.evolv.ecig.theme":{source:"iana"},"application/vnd.exstream-empower+zip":{source:"iana",compressible:!1},"application/vnd.exstream-package":{source:"iana"},"application/vnd.ezpix-album":{source:"iana",extensions:["ez2"]},"application/vnd.ezpix-package":{source:"iana",extensions:["ez3"]},"application/vnd.f-secure.mobile":{source:"iana"},"application/vnd.familysearch.gedcom+zip":{source:"iana",compressible:!1},"application/vnd.fastcopy-disk-image":{source:"iana"},"application/vnd.fdf":{source:"iana",extensions:["fdf"]},"application/vnd.fdsn.mseed":{source:"iana",extensions:["mseed"]},"application/vnd.fdsn.seed":{source:"iana",extensions:["seed","dataless"]},"application/vnd.ffsns":{source:"iana"},"application/vnd.ficlab.flb+zip":{source:"iana",compressible:!1},"application/vnd.filmit.zfc":{source:"iana"},"application/vnd.fints":{source:"iana"},"application/vnd.firemonkeys.cloudcell":{source:"iana"},"application/vnd.flographit":{source:"iana",extensions:["gph"]},"application/vnd.fluxtime.clip":{source:"iana",extensions:["ftc"]},"application/vnd.font-fontforge-sfd":{source:"iana"},"application/vnd.framemaker":{source:"iana",extensions:["fm","frame","maker","book"]},"application/vnd.frogans.fnc":{source:"iana",extensions:["fnc"]},"application/vnd.frogans.ltf":{source:"iana",extensions:["ltf"]},"application/vnd.fsc.weblaunch":{source:"iana",extensions:["fsc"]},"application/vnd.fujifilm.fb.docuworks":{source:"iana"},"application/vnd.fujifilm.fb.docuworks.binder":{source:"iana"},"application/vnd.fujifilm.fb.docuworks.container":{source:"iana"},"application/vnd.fujifilm.fb.jfi+xml":{source:"iana",compressible:!0},"application/vnd.fujitsu.oasys":{source:"iana",extensions:["oas"]},"application/vnd.fujitsu.oasys2":{source:"iana",extensions:["oa2"]},"application/vnd.fujitsu.oasys3":{source:"iana",extensions:["oa3"]},"application/vnd.fujitsu.oasysgp":{source:"iana",extensions:["fg5"]},"application/vnd.fujitsu.oasysprs":{source:"iana",extensions:["bh2"]},"application/vnd.fujixerox.art-ex":{source:"iana"},"application/vnd.fujixerox.art4":{source:"iana"},"application/vnd.fujixerox.ddd":{source:"iana",extensions:["ddd"]},"application/vnd.fujixerox.docuworks":{source:"iana",extensions:["xdw"]},"application/vnd.fujixerox.docuworks.binder":{source:"iana",extensions:["xbd"]},"application/vnd.fujixerox.docuworks.container":{source:"iana"},"application/vnd.fujixerox.hbpl":{source:"iana"},"application/vnd.fut-misnet":{source:"iana"},"application/vnd.futoin+cbor":{source:"iana"},"application/vnd.futoin+json":{source:"iana",compressible:!0},"application/vnd.fuzzysheet":{source:"iana",extensions:["fzs"]},"application/vnd.genomatix.tuxedo":{source:"iana",extensions:["txd"]},"application/vnd.gentics.grd+json":{source:"iana",compressible:!0},"application/vnd.geo+json":{source:"iana",compressible:!0},"application/vnd.geocube+xml":{source:"iana",compressible:!0},"application/vnd.geogebra.file":{source:"iana",extensions:["ggb"]},"application/vnd.geogebra.slides":{source:"iana"},"application/vnd.geogebra.tool":{source:"iana",extensions:["ggt"]},"application/vnd.geometry-explorer":{source:"iana",extensions:["gex","gre"]},"application/vnd.geonext":{source:"iana",extensions:["gxt"]},"application/vnd.geoplan":{source:"iana",extensions:["g2w"]},"application/vnd.geospace":{source:"iana",extensions:["g3w"]},"application/vnd.gerber":{source:"iana"},"application/vnd.globalplatform.card-content-mgt":{source:"iana"},"application/vnd.globalplatform.card-content-mgt-response":{source:"iana"},"application/vnd.gmx":{source:"iana",extensions:["gmx"]},"application/vnd.google-apps.document":{compressible:!1,extensions:["gdoc"]},"application/vnd.google-apps.presentation":{compressible:!1,extensions:["gslides"]},"application/vnd.google-apps.spreadsheet":{compressible:!1,extensions:["gsheet"]},"application/vnd.google-earth.kml+xml":{source:"iana",compressible:!0,extensions:["kml"]},"application/vnd.google-earth.kmz":{source:"iana",compressible:!1,extensions:["kmz"]},"application/vnd.gov.sk.e-form+xml":{source:"iana",compressible:!0},"application/vnd.gov.sk.e-form+zip":{source:"iana",compressible:!1},"application/vnd.gov.sk.xmldatacontainer+xml":{source:"iana",compressible:!0},"application/vnd.grafeq":{source:"iana",extensions:["gqf","gqs"]},"application/vnd.gridmp":{source:"iana"},"application/vnd.groove-account":{source:"iana",extensions:["gac"]},"application/vnd.groove-help":{source:"iana",extensions:["ghf"]},"application/vnd.groove-identity-message":{source:"iana",extensions:["gim"]},"application/vnd.groove-injector":{source:"iana",extensions:["grv"]},"application/vnd.groove-tool-message":{source:"iana",extensions:["gtm"]},"application/vnd.groove-tool-template":{source:"iana",extensions:["tpl"]},"application/vnd.groove-vcard":{source:"iana",extensions:["vcg"]},"application/vnd.hal+json":{source:"iana",compressible:!0},"application/vnd.hal+xml":{source:"iana",compressible:!0,extensions:["hal"]},"application/vnd.handheld-entertainment+xml":{source:"iana",compressible:!0,extensions:["zmm"]},"application/vnd.hbci":{source:"iana",extensions:["hbci"]},"application/vnd.hc+json":{source:"iana",compressible:!0},"application/vnd.hcl-bireports":{source:"iana"},"application/vnd.hdt":{source:"iana"},"application/vnd.heroku+json":{source:"iana",compressible:!0},"application/vnd.hhe.lesson-player":{source:"iana",extensions:["les"]},"application/vnd.hl7cda+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.hl7v2+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.hp-hpgl":{source:"iana",extensions:["hpgl"]},"application/vnd.hp-hpid":{source:"iana",extensions:["hpid"]},"application/vnd.hp-hps":{source:"iana",extensions:["hps"]},"application/vnd.hp-jlyt":{source:"iana",extensions:["jlt"]},"application/vnd.hp-pcl":{source:"iana",extensions:["pcl"]},"application/vnd.hp-pclxl":{source:"iana",extensions:["pclxl"]},"application/vnd.httphone":{source:"iana"},"application/vnd.hydrostatix.sof-data":{source:"iana",extensions:["sfd-hdstx"]},"application/vnd.hyper+json":{source:"iana",compressible:!0},"application/vnd.hyper-item+json":{source:"iana",compressible:!0},"application/vnd.hyperdrive+json":{source:"iana",compressible:!0},"application/vnd.hzn-3d-crossword":{source:"iana"},"application/vnd.ibm.afplinedata":{source:"iana"},"application/vnd.ibm.electronic-media":{source:"iana"},"application/vnd.ibm.minipay":{source:"iana",extensions:["mpy"]},"application/vnd.ibm.modcap":{source:"iana",extensions:["afp","listafp","list3820"]},"application/vnd.ibm.rights-management":{source:"iana",extensions:["irm"]},"application/vnd.ibm.secure-container":{source:"iana",extensions:["sc"]},"application/vnd.iccprofile":{source:"iana",extensions:["icc","icm"]},"application/vnd.ieee.1905":{source:"iana"},"application/vnd.igloader":{source:"iana",extensions:["igl"]},"application/vnd.imagemeter.folder+zip":{source:"iana",compressible:!1},"application/vnd.imagemeter.image+zip":{source:"iana",compressible:!1},"application/vnd.immervision-ivp":{source:"iana",extensions:["ivp"]},"application/vnd.immervision-ivu":{source:"iana",extensions:["ivu"]},"application/vnd.ims.imsccv1p1":{source:"iana"},"application/vnd.ims.imsccv1p2":{source:"iana"},"application/vnd.ims.imsccv1p3":{source:"iana"},"application/vnd.ims.lis.v2.result+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolconsumerprofile+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolproxy+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolproxy.id+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolsettings+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolsettings.simple+json":{source:"iana",compressible:!0},"application/vnd.informedcontrol.rms+xml":{source:"iana",compressible:!0},"application/vnd.informix-visionary":{source:"iana"},"application/vnd.infotech.project":{source:"iana"},"application/vnd.infotech.project+xml":{source:"iana",compressible:!0},"application/vnd.innopath.wamp.notification":{source:"iana"},"application/vnd.insors.igm":{source:"iana",extensions:["igm"]},"application/vnd.intercon.formnet":{source:"iana",extensions:["xpw","xpx"]},"application/vnd.intergeo":{source:"iana",extensions:["i2g"]},"application/vnd.intertrust.digibox":{source:"iana"},"application/vnd.intertrust.nncp":{source:"iana"},"application/vnd.intu.qbo":{source:"iana",extensions:["qbo"]},"application/vnd.intu.qfx":{source:"iana",extensions:["qfx"]},"application/vnd.iptc.g2.catalogitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.conceptitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.knowledgeitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.newsitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.newsmessage+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.packageitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.planningitem+xml":{source:"iana",compressible:!0},"application/vnd.ipunplugged.rcprofile":{source:"iana",extensions:["rcprofile"]},"application/vnd.irepository.package+xml":{source:"iana",compressible:!0,extensions:["irp"]},"application/vnd.is-xpr":{source:"iana",extensions:["xpr"]},"application/vnd.isac.fcs":{source:"iana",extensions:["fcs"]},"application/vnd.iso11783-10+zip":{source:"iana",compressible:!1},"application/vnd.jam":{source:"iana",extensions:["jam"]},"application/vnd.japannet-directory-service":{source:"iana"},"application/vnd.japannet-jpnstore-wakeup":{source:"iana"},"application/vnd.japannet-payment-wakeup":{source:"iana"},"application/vnd.japannet-registration":{source:"iana"},"application/vnd.japannet-registration-wakeup":{source:"iana"},"application/vnd.japannet-setstore-wakeup":{source:"iana"},"application/vnd.japannet-verification":{source:"iana"},"application/vnd.japannet-verification-wakeup":{source:"iana"},"application/vnd.jcp.javame.midlet-rms":{source:"iana",extensions:["rms"]},"application/vnd.jisp":{source:"iana",extensions:["jisp"]},"application/vnd.joost.joda-archive":{source:"iana",extensions:["joda"]},"application/vnd.jsk.isdn-ngn":{source:"iana"},"application/vnd.kahootz":{source:"iana",extensions:["ktz","ktr"]},"application/vnd.kde.karbon":{source:"iana",extensions:["karbon"]},"application/vnd.kde.kchart":{source:"iana",extensions:["chrt"]},"application/vnd.kde.kformula":{source:"iana",extensions:["kfo"]},"application/vnd.kde.kivio":{source:"iana",extensions:["flw"]},"application/vnd.kde.kontour":{source:"iana",extensions:["kon"]},"application/vnd.kde.kpresenter":{source:"iana",extensions:["kpr","kpt"]},"application/vnd.kde.kspread":{source:"iana",extensions:["ksp"]},"application/vnd.kde.kword":{source:"iana",extensions:["kwd","kwt"]},"application/vnd.kenameaapp":{source:"iana",extensions:["htke"]},"application/vnd.kidspiration":{source:"iana",extensions:["kia"]},"application/vnd.kinar":{source:"iana",extensions:["kne","knp"]},"application/vnd.koan":{source:"iana",extensions:["skp","skd","skt","skm"]},"application/vnd.kodak-descriptor":{source:"iana",extensions:["sse"]},"application/vnd.las":{source:"iana"},"application/vnd.las.las+json":{source:"iana",compressible:!0},"application/vnd.las.las+xml":{source:"iana",compressible:!0,extensions:["lasxml"]},"application/vnd.laszip":{source:"iana"},"application/vnd.leap+json":{source:"iana",compressible:!0},"application/vnd.liberty-request+xml":{source:"iana",compressible:!0},"application/vnd.llamagraphics.life-balance.desktop":{source:"iana",extensions:["lbd"]},"application/vnd.llamagraphics.life-balance.exchange+xml":{source:"iana",compressible:!0,extensions:["lbe"]},"application/vnd.logipipe.circuit+zip":{source:"iana",compressible:!1},"application/vnd.loom":{source:"iana"},"application/vnd.lotus-1-2-3":{source:"iana",extensions:["123"]},"application/vnd.lotus-approach":{source:"iana",extensions:["apr"]},"application/vnd.lotus-freelance":{source:"iana",extensions:["pre"]},"application/vnd.lotus-notes":{source:"iana",extensions:["nsf"]},"application/vnd.lotus-organizer":{source:"iana",extensions:["org"]},"application/vnd.lotus-screencam":{source:"iana",extensions:["scm"]},"application/vnd.lotus-wordpro":{source:"iana",extensions:["lwp"]},"application/vnd.macports.portpkg":{source:"iana",extensions:["portpkg"]},"application/vnd.mapbox-vector-tile":{source:"iana",extensions:["mvt"]},"application/vnd.marlin.drm.actiontoken+xml":{source:"iana",compressible:!0},"application/vnd.marlin.drm.conftoken+xml":{source:"iana",compressible:!0},"application/vnd.marlin.drm.license+xml":{source:"iana",compressible:!0},"application/vnd.marlin.drm.mdcf":{source:"iana"},"application/vnd.mason+json":{source:"iana",compressible:!0},"application/vnd.maxar.archive.3tz+zip":{source:"iana",compressible:!1},"application/vnd.maxmind.maxmind-db":{source:"iana"},"application/vnd.mcd":{source:"iana",extensions:["mcd"]},"application/vnd.medcalcdata":{source:"iana",extensions:["mc1"]},"application/vnd.mediastation.cdkey":{source:"iana",extensions:["cdkey"]},"application/vnd.meridian-slingshot":{source:"iana"},"application/vnd.mfer":{source:"iana",extensions:["mwf"]},"application/vnd.mfmp":{source:"iana",extensions:["mfm"]},"application/vnd.micro+json":{source:"iana",compressible:!0},"application/vnd.micrografx.flo":{source:"iana",extensions:["flo"]},"application/vnd.micrografx.igx":{source:"iana",extensions:["igx"]},"application/vnd.microsoft.portable-executable":{source:"iana"},"application/vnd.microsoft.windows.thumbnail-cache":{source:"iana"},"application/vnd.miele+json":{source:"iana",compressible:!0},"application/vnd.mif":{source:"iana",extensions:["mif"]},"application/vnd.minisoft-hp3000-save":{source:"iana"},"application/vnd.mitsubishi.misty-guard.trustweb":{source:"iana"},"application/vnd.mobius.daf":{source:"iana",extensions:["daf"]},"application/vnd.mobius.dis":{source:"iana",extensions:["dis"]},"application/vnd.mobius.mbk":{source:"iana",extensions:["mbk"]},"application/vnd.mobius.mqy":{source:"iana",extensions:["mqy"]},"application/vnd.mobius.msl":{source:"iana",extensions:["msl"]},"application/vnd.mobius.plc":{source:"iana",extensions:["plc"]},"application/vnd.mobius.txf":{source:"iana",extensions:["txf"]},"application/vnd.mophun.application":{source:"iana",extensions:["mpn"]},"application/vnd.mophun.certificate":{source:"iana",extensions:["mpc"]},"application/vnd.motorola.flexsuite":{source:"iana"},"application/vnd.motorola.flexsuite.adsi":{source:"iana"},"application/vnd.motorola.flexsuite.fis":{source:"iana"},"application/vnd.motorola.flexsuite.gotap":{source:"iana"},"application/vnd.motorola.flexsuite.kmr":{source:"iana"},"application/vnd.motorola.flexsuite.ttc":{source:"iana"},"application/vnd.motorola.flexsuite.wem":{source:"iana"},"application/vnd.motorola.iprm":{source:"iana"},"application/vnd.mozilla.xul+xml":{source:"iana",compressible:!0,extensions:["xul"]},"application/vnd.ms-3mfdocument":{source:"iana"},"application/vnd.ms-artgalry":{source:"iana",extensions:["cil"]},"application/vnd.ms-asf":{source:"iana"},"application/vnd.ms-cab-compressed":{source:"iana",extensions:["cab"]},"application/vnd.ms-color.iccprofile":{source:"apache"},"application/vnd.ms-excel":{source:"iana",compressible:!1,extensions:["xls","xlm","xla","xlc","xlt","xlw"]},"application/vnd.ms-excel.addin.macroenabled.12":{source:"iana",extensions:["xlam"]},"application/vnd.ms-excel.sheet.binary.macroenabled.12":{source:"iana",extensions:["xlsb"]},"application/vnd.ms-excel.sheet.macroenabled.12":{source:"iana",extensions:["xlsm"]},"application/vnd.ms-excel.template.macroenabled.12":{source:"iana",extensions:["xltm"]},"application/vnd.ms-fontobject":{source:"iana",compressible:!0,extensions:["eot"]},"application/vnd.ms-htmlhelp":{source:"iana",extensions:["chm"]},"application/vnd.ms-ims":{source:"iana",extensions:["ims"]},"application/vnd.ms-lrm":{source:"iana",extensions:["lrm"]},"application/vnd.ms-office.activex+xml":{source:"iana",compressible:!0},"application/vnd.ms-officetheme":{source:"iana",extensions:["thmx"]},"application/vnd.ms-opentype":{source:"apache",compressible:!0},"application/vnd.ms-outlook":{compressible:!1,extensions:["msg"]},"application/vnd.ms-package.obfuscated-opentype":{source:"apache"},"application/vnd.ms-pki.seccat":{source:"apache",extensions:["cat"]},"application/vnd.ms-pki.stl":{source:"apache",extensions:["stl"]},"application/vnd.ms-playready.initiator+xml":{source:"iana",compressible:!0},"application/vnd.ms-powerpoint":{source:"iana",compressible:!1,extensions:["ppt","pps","pot"]},"application/vnd.ms-powerpoint.addin.macroenabled.12":{source:"iana",extensions:["ppam"]},"application/vnd.ms-powerpoint.presentation.macroenabled.12":{source:"iana",extensions:["pptm"]},"application/vnd.ms-powerpoint.slide.macroenabled.12":{source:"iana",extensions:["sldm"]},"application/vnd.ms-powerpoint.slideshow.macroenabled.12":{source:"iana",extensions:["ppsm"]},"application/vnd.ms-powerpoint.template.macroenabled.12":{source:"iana",extensions:["potm"]},"application/vnd.ms-printdevicecapabilities+xml":{source:"iana",compressible:!0},"application/vnd.ms-printing.printticket+xml":{source:"apache",compressible:!0},"application/vnd.ms-printschematicket+xml":{source:"iana",compressible:!0},"application/vnd.ms-project":{source:"iana",extensions:["mpp","mpt"]},"application/vnd.ms-tnef":{source:"iana"},"application/vnd.ms-windows.devicepairing":{source:"iana"},"application/vnd.ms-windows.nwprinting.oob":{source:"iana"},"application/vnd.ms-windows.printerpairing":{source:"iana"},"application/vnd.ms-windows.wsd.oob":{source:"iana"},"application/vnd.ms-wmdrm.lic-chlg-req":{source:"iana"},"application/vnd.ms-wmdrm.lic-resp":{source:"iana"},"application/vnd.ms-wmdrm.meter-chlg-req":{source:"iana"},"application/vnd.ms-wmdrm.meter-resp":{source:"iana"},"application/vnd.ms-word.document.macroenabled.12":{source:"iana",extensions:["docm"]},"application/vnd.ms-word.template.macroenabled.12":{source:"iana",extensions:["dotm"]},"application/vnd.ms-works":{source:"iana",extensions:["wps","wks","wcm","wdb"]},"application/vnd.ms-wpl":{source:"iana",extensions:["wpl"]},"application/vnd.ms-xpsdocument":{source:"iana",compressible:!1,extensions:["xps"]},"application/vnd.msa-disk-image":{source:"iana"},"application/vnd.mseq":{source:"iana",extensions:["mseq"]},"application/vnd.msign":{source:"iana"},"application/vnd.multiad.creator":{source:"iana"},"application/vnd.multiad.creator.cif":{source:"iana"},"application/vnd.music-niff":{source:"iana"},"application/vnd.musician":{source:"iana",extensions:["mus"]},"application/vnd.muvee.style":{source:"iana",extensions:["msty"]},"application/vnd.mynfc":{source:"iana",extensions:["taglet"]},"application/vnd.nacamar.ybrid+json":{source:"iana",compressible:!0},"application/vnd.ncd.control":{source:"iana"},"application/vnd.ncd.reference":{source:"iana"},"application/vnd.nearst.inv+json":{source:"iana",compressible:!0},"application/vnd.nebumind.line":{source:"iana"},"application/vnd.nervana":{source:"iana"},"application/vnd.netfpx":{source:"iana"},"application/vnd.neurolanguage.nlu":{source:"iana",extensions:["nlu"]},"application/vnd.nimn":{source:"iana"},"application/vnd.nintendo.nitro.rom":{source:"iana"},"application/vnd.nintendo.snes.rom":{source:"iana"},"application/vnd.nitf":{source:"iana",extensions:["ntf","nitf"]},"application/vnd.noblenet-directory":{source:"iana",extensions:["nnd"]},"application/vnd.noblenet-sealer":{source:"iana",extensions:["nns"]},"application/vnd.noblenet-web":{source:"iana",extensions:["nnw"]},"application/vnd.nokia.catalogs":{source:"iana"},"application/vnd.nokia.conml+wbxml":{source:"iana"},"application/vnd.nokia.conml+xml":{source:"iana",compressible:!0},"application/vnd.nokia.iptv.config+xml":{source:"iana",compressible:!0},"application/vnd.nokia.isds-radio-presets":{source:"iana"},"application/vnd.nokia.landmark+wbxml":{source:"iana"},"application/vnd.nokia.landmark+xml":{source:"iana",compressible:!0},"application/vnd.nokia.landmarkcollection+xml":{source:"iana",compressible:!0},"application/vnd.nokia.n-gage.ac+xml":{source:"iana",compressible:!0,extensions:["ac"]},"application/vnd.nokia.n-gage.data":{source:"iana",extensions:["ngdat"]},"application/vnd.nokia.n-gage.symbian.install":{source:"iana",extensions:["n-gage"]},"application/vnd.nokia.ncd":{source:"iana"},"application/vnd.nokia.pcd+wbxml":{source:"iana"},"application/vnd.nokia.pcd+xml":{source:"iana",compressible:!0},"application/vnd.nokia.radio-preset":{source:"iana",extensions:["rpst"]},"application/vnd.nokia.radio-presets":{source:"iana",extensions:["rpss"]},"application/vnd.novadigm.edm":{source:"iana",extensions:["edm"]},"application/vnd.novadigm.edx":{source:"iana",extensions:["edx"]},"application/vnd.novadigm.ext":{source:"iana",extensions:["ext"]},"application/vnd.ntt-local.content-share":{source:"iana"},"application/vnd.ntt-local.file-transfer":{source:"iana"},"application/vnd.ntt-local.ogw_remote-access":{source:"iana"},"application/vnd.ntt-local.sip-ta_remote":{source:"iana"},"application/vnd.ntt-local.sip-ta_tcp_stream":{source:"iana"},"application/vnd.oasis.opendocument.chart":{source:"iana",extensions:["odc"]},"application/vnd.oasis.opendocument.chart-template":{source:"iana",extensions:["otc"]},"application/vnd.oasis.opendocument.database":{source:"iana",extensions:["odb"]},"application/vnd.oasis.opendocument.formula":{source:"iana",extensions:["odf"]},"application/vnd.oasis.opendocument.formula-template":{source:"iana",extensions:["odft"]},"application/vnd.oasis.opendocument.graphics":{source:"iana",compressible:!1,extensions:["odg"]},"application/vnd.oasis.opendocument.graphics-template":{source:"iana",extensions:["otg"]},"application/vnd.oasis.opendocument.image":{source:"iana",extensions:["odi"]},"application/vnd.oasis.opendocument.image-template":{source:"iana",extensions:["oti"]},"application/vnd.oasis.opendocument.presentation":{source:"iana",compressible:!1,extensions:["odp"]},"application/vnd.oasis.opendocument.presentation-template":{source:"iana",extensions:["otp"]},"application/vnd.oasis.opendocument.spreadsheet":{source:"iana",compressible:!1,extensions:["ods"]},"application/vnd.oasis.opendocument.spreadsheet-template":{source:"iana",extensions:["ots"]},"application/vnd.oasis.opendocument.text":{source:"iana",compressible:!1,extensions:["odt"]},"application/vnd.oasis.opendocument.text-master":{source:"iana",extensions:["odm"]},"application/vnd.oasis.opendocument.text-template":{source:"iana",extensions:["ott"]},"application/vnd.oasis.opendocument.text-web":{source:"iana",extensions:["oth"]},"application/vnd.obn":{source:"iana"},"application/vnd.ocf+cbor":{source:"iana"},"application/vnd.oci.image.manifest.v1+json":{source:"iana",compressible:!0},"application/vnd.oftn.l10n+json":{source:"iana",compressible:!0},"application/vnd.oipf.contentaccessdownload+xml":{source:"iana",compressible:!0},"application/vnd.oipf.contentaccessstreaming+xml":{source:"iana",compressible:!0},"application/vnd.oipf.cspg-hexbinary":{source:"iana"},"application/vnd.oipf.dae.svg+xml":{source:"iana",compressible:!0},"application/vnd.oipf.dae.xhtml+xml":{source:"iana",compressible:!0},"application/vnd.oipf.mippvcontrolmessage+xml":{source:"iana",compressible:!0},"application/vnd.oipf.pae.gem":{source:"iana"},"application/vnd.oipf.spdiscovery+xml":{source:"iana",compressible:!0},"application/vnd.oipf.spdlist+xml":{source:"iana",compressible:!0},"application/vnd.oipf.ueprofile+xml":{source:"iana",compressible:!0},"application/vnd.oipf.userprofile+xml":{source:"iana",compressible:!0},"application/vnd.olpc-sugar":{source:"iana",extensions:["xo"]},"application/vnd.oma-scws-config":{source:"iana"},"application/vnd.oma-scws-http-request":{source:"iana"},"application/vnd.oma-scws-http-response":{source:"iana"},"application/vnd.oma.bcast.associated-procedure-parameter+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.drm-trigger+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.imd+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.ltkm":{source:"iana"},"application/vnd.oma.bcast.notification+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.provisioningtrigger":{source:"iana"},"application/vnd.oma.bcast.sgboot":{source:"iana"},"application/vnd.oma.bcast.sgdd+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.sgdu":{source:"iana"},"application/vnd.oma.bcast.simple-symbol-container":{source:"iana"},"application/vnd.oma.bcast.smartcard-trigger+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.sprov+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.stkm":{source:"iana"},"application/vnd.oma.cab-address-book+xml":{source:"iana",compressible:!0},"application/vnd.oma.cab-feature-handler+xml":{source:"iana",compressible:!0},"application/vnd.oma.cab-pcc+xml":{source:"iana",compressible:!0},"application/vnd.oma.cab-subs-invite+xml":{source:"iana",compressible:!0},"application/vnd.oma.cab-user-prefs+xml":{source:"iana",compressible:!0},"application/vnd.oma.dcd":{source:"iana"},"application/vnd.oma.dcdc":{source:"iana"},"application/vnd.oma.dd2+xml":{source:"iana",compressible:!0,extensions:["dd2"]},"application/vnd.oma.drm.risd+xml":{source:"iana",compressible:!0},"application/vnd.oma.group-usage-list+xml":{source:"iana",compressible:!0},"application/vnd.oma.lwm2m+cbor":{source:"iana"},"application/vnd.oma.lwm2m+json":{source:"iana",compressible:!0},"application/vnd.oma.lwm2m+tlv":{source:"iana"},"application/vnd.oma.pal+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.detailed-progress-report+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.final-report+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.groups+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.invocation-descriptor+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.optimized-progress-report+xml":{source:"iana",compressible:!0},"application/vnd.oma.push":{source:"iana"},"application/vnd.oma.scidm.messages+xml":{source:"iana",compressible:!0},"application/vnd.oma.xcap-directory+xml":{source:"iana",compressible:!0},"application/vnd.omads-email+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.omads-file+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.omads-folder+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.omaloc-supl-init":{source:"iana"},"application/vnd.onepager":{source:"iana"},"application/vnd.onepagertamp":{source:"iana"},"application/vnd.onepagertamx":{source:"iana"},"application/vnd.onepagertat":{source:"iana"},"application/vnd.onepagertatp":{source:"iana"},"application/vnd.onepagertatx":{source:"iana"},"application/vnd.openblox.game+xml":{source:"iana",compressible:!0,extensions:["obgx"]},"application/vnd.openblox.game-binary":{source:"iana"},"application/vnd.openeye.oeb":{source:"iana"},"application/vnd.openofficeorg.extension":{source:"apache",extensions:["oxt"]},"application/vnd.openstreetmap.data+xml":{source:"iana",compressible:!0,extensions:["osm"]},"application/vnd.opentimestamps.ots":{source:"iana"},"application/vnd.openxmlformats-officedocument.custom-properties+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.customxmlproperties+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawing+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.chart+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.diagramcolors+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.diagramdata+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.diagramlayout+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.diagramstyle+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.extended-properties+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.commentauthors+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.comments+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.handoutmaster+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.notesmaster+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.notesslide+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{source:"iana",compressible:!1,extensions:["pptx"]},"application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.presprops+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slide":{source:"iana",extensions:["sldx"]},"application/vnd.openxmlformats-officedocument.presentationml.slide+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slidelayout+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slidemaster+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slideshow":{source:"iana",extensions:["ppsx"]},"application/vnd.openxmlformats-officedocument.presentationml.slideshow.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slideupdateinfo+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.tablestyles+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.tags+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.template":{source:"iana",extensions:["potx"]},"application/vnd.openxmlformats-officedocument.presentationml.template.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.viewprops+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.calcchain+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.externallink+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotcachedefinition+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotcacherecords+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.pivottable+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.querytable+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionheaders+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionlog+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedstrings+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{source:"iana",compressible:!1,extensions:["xlsx"]},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetmetadata+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.tablesinglecells+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.template":{source:"iana",extensions:["xltx"]},"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.usernames+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.volatiledependencies+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.theme+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.themeoverride+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.vmldrawing":{source:"iana"},"application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{source:"iana",compressible:!1,extensions:["docx"]},"application/vnd.openxmlformats-officedocument.wordprocessingml.document.glossary+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.fonttable+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.template":{source:"iana",extensions:["dotx"]},"application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.websettings+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-package.core-properties+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-package.digital-signature-xmlsignature+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-package.relationships+xml":{source:"iana",compressible:!0},"application/vnd.oracle.resource+json":{source:"iana",compressible:!0},"application/vnd.orange.indata":{source:"iana"},"application/vnd.osa.netdeploy":{source:"iana"},"application/vnd.osgeo.mapguide.package":{source:"iana",extensions:["mgp"]},"application/vnd.osgi.bundle":{source:"iana"},"application/vnd.osgi.dp":{source:"iana",extensions:["dp"]},"application/vnd.osgi.subsystem":{source:"iana",extensions:["esa"]},"application/vnd.otps.ct-kip+xml":{source:"iana",compressible:!0},"application/vnd.oxli.countgraph":{source:"iana"},"application/vnd.pagerduty+json":{source:"iana",compressible:!0},"application/vnd.palm":{source:"iana",extensions:["pdb","pqa","oprc"]},"application/vnd.panoply":{source:"iana"},"application/vnd.paos.xml":{source:"iana"},"application/vnd.patentdive":{source:"iana"},"application/vnd.patientecommsdoc":{source:"iana"},"application/vnd.pawaafile":{source:"iana",extensions:["paw"]},"application/vnd.pcos":{source:"iana"},"application/vnd.pg.format":{source:"iana",extensions:["str"]},"application/vnd.pg.osasli":{source:"iana",extensions:["ei6"]},"application/vnd.piaccess.application-licence":{source:"iana"},"application/vnd.picsel":{source:"iana",extensions:["efif"]},"application/vnd.pmi.widget":{source:"iana",extensions:["wg"]},"application/vnd.poc.group-advertisement+xml":{source:"iana",compressible:!0},"application/vnd.pocketlearn":{source:"iana",extensions:["plf"]},"application/vnd.powerbuilder6":{source:"iana",extensions:["pbd"]},"application/vnd.powerbuilder6-s":{source:"iana"},"application/vnd.powerbuilder7":{source:"iana"},"application/vnd.powerbuilder7-s":{source:"iana"},"application/vnd.powerbuilder75":{source:"iana"},"application/vnd.powerbuilder75-s":{source:"iana"},"application/vnd.preminet":{source:"iana"},"application/vnd.previewsystems.box":{source:"iana",extensions:["box"]},"application/vnd.proteus.magazine":{source:"iana",extensions:["mgz"]},"application/vnd.psfs":{source:"iana"},"application/vnd.publishare-delta-tree":{source:"iana",extensions:["qps"]},"application/vnd.pvi.ptid1":{source:"iana",extensions:["ptid"]},"application/vnd.pwg-multiplexed":{source:"iana"},"application/vnd.pwg-xhtml-print+xml":{source:"iana",compressible:!0},"application/vnd.qualcomm.brew-app-res":{source:"iana"},"application/vnd.quarantainenet":{source:"iana"},"application/vnd.quark.quarkxpress":{source:"iana",extensions:["qxd","qxt","qwd","qwt","qxl","qxb"]},"application/vnd.quobject-quoxdocument":{source:"iana"},"application/vnd.radisys.moml+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit-conf+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit-conn+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit-dialog+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit-stream+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-conf+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-base+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-fax-detect+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-fax-sendrecv+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-group+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-speech+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-transform+xml":{source:"iana",compressible:!0},"application/vnd.rainstor.data":{source:"iana"},"application/vnd.rapid":{source:"iana"},"application/vnd.rar":{source:"iana",extensions:["rar"]},"application/vnd.realvnc.bed":{source:"iana",extensions:["bed"]},"application/vnd.recordare.musicxml":{source:"iana",extensions:["mxl"]},"application/vnd.recordare.musicxml+xml":{source:"iana",compressible:!0,extensions:["musicxml"]},"application/vnd.renlearn.rlprint":{source:"iana"},"application/vnd.resilient.logic":{source:"iana"},"application/vnd.restful+json":{source:"iana",compressible:!0},"application/vnd.rig.cryptonote":{source:"iana",extensions:["cryptonote"]},"application/vnd.rim.cod":{source:"apache",extensions:["cod"]},"application/vnd.rn-realmedia":{source:"apache",extensions:["rm"]},"application/vnd.rn-realmedia-vbr":{source:"apache",extensions:["rmvb"]},"application/vnd.route66.link66+xml":{source:"iana",compressible:!0,extensions:["link66"]},"application/vnd.rs-274x":{source:"iana"},"application/vnd.ruckus.download":{source:"iana"},"application/vnd.s3sms":{source:"iana"},"application/vnd.sailingtracker.track":{source:"iana",extensions:["st"]},"application/vnd.sar":{source:"iana"},"application/vnd.sbm.cid":{source:"iana"},"application/vnd.sbm.mid2":{source:"iana"},"application/vnd.scribus":{source:"iana"},"application/vnd.sealed.3df":{source:"iana"},"application/vnd.sealed.csf":{source:"iana"},"application/vnd.sealed.doc":{source:"iana"},"application/vnd.sealed.eml":{source:"iana"},"application/vnd.sealed.mht":{source:"iana"},"application/vnd.sealed.net":{source:"iana"},"application/vnd.sealed.ppt":{source:"iana"},"application/vnd.sealed.tiff":{source:"iana"},"application/vnd.sealed.xls":{source:"iana"},"application/vnd.sealedmedia.softseal.html":{source:"iana"},"application/vnd.sealedmedia.softseal.pdf":{source:"iana"},"application/vnd.seemail":{source:"iana",extensions:["see"]},"application/vnd.seis+json":{source:"iana",compressible:!0},"application/vnd.sema":{source:"iana",extensions:["sema"]},"application/vnd.semd":{source:"iana",extensions:["semd"]},"application/vnd.semf":{source:"iana",extensions:["semf"]},"application/vnd.shade-save-file":{source:"iana"},"application/vnd.shana.informed.formdata":{source:"iana",extensions:["ifm"]},"application/vnd.shana.informed.formtemplate":{source:"iana",extensions:["itp"]},"application/vnd.shana.informed.interchange":{source:"iana",extensions:["iif"]},"application/vnd.shana.informed.package":{source:"iana",extensions:["ipk"]},"application/vnd.shootproof+json":{source:"iana",compressible:!0},"application/vnd.shopkick+json":{source:"iana",compressible:!0},"application/vnd.shp":{source:"iana"},"application/vnd.shx":{source:"iana"},"application/vnd.sigrok.session":{source:"iana"},"application/vnd.simtech-mindmapper":{source:"iana",extensions:["twd","twds"]},"application/vnd.siren+json":{source:"iana",compressible:!0},"application/vnd.smaf":{source:"iana",extensions:["mmf"]},"application/vnd.smart.notebook":{source:"iana"},"application/vnd.smart.teacher":{source:"iana",extensions:["teacher"]},"application/vnd.snesdev-page-table":{source:"iana"},"application/vnd.software602.filler.form+xml":{source:"iana",compressible:!0,extensions:["fo"]},"application/vnd.software602.filler.form-xml-zip":{source:"iana"},"application/vnd.solent.sdkm+xml":{source:"iana",compressible:!0,extensions:["sdkm","sdkd"]},"application/vnd.spotfire.dxp":{source:"iana",extensions:["dxp"]},"application/vnd.spotfire.sfs":{source:"iana",extensions:["sfs"]},"application/vnd.sqlite3":{source:"iana"},"application/vnd.sss-cod":{source:"iana"},"application/vnd.sss-dtf":{source:"iana"},"application/vnd.sss-ntf":{source:"iana"},"application/vnd.stardivision.calc":{source:"apache",extensions:["sdc"]},"application/vnd.stardivision.draw":{source:"apache",extensions:["sda"]},"application/vnd.stardivision.impress":{source:"apache",extensions:["sdd"]},"application/vnd.stardivision.math":{source:"apache",extensions:["smf"]},"application/vnd.stardivision.writer":{source:"apache",extensions:["sdw","vor"]},"application/vnd.stardivision.writer-global":{source:"apache",extensions:["sgl"]},"application/vnd.stepmania.package":{source:"iana",extensions:["smzip"]},"application/vnd.stepmania.stepchart":{source:"iana",extensions:["sm"]},"application/vnd.street-stream":{source:"iana"},"application/vnd.sun.wadl+xml":{source:"iana",compressible:!0,extensions:["wadl"]},"application/vnd.sun.xml.calc":{source:"apache",extensions:["sxc"]},"application/vnd.sun.xml.calc.template":{source:"apache",extensions:["stc"]},"application/vnd.sun.xml.draw":{source:"apache",extensions:["sxd"]},"application/vnd.sun.xml.draw.template":{source:"apache",extensions:["std"]},"application/vnd.sun.xml.impress":{source:"apache",extensions:["sxi"]},"application/vnd.sun.xml.impress.template":{source:"apache",extensions:["sti"]},"application/vnd.sun.xml.math":{source:"apache",extensions:["sxm"]},"application/vnd.sun.xml.writer":{source:"apache",extensions:["sxw"]},"application/vnd.sun.xml.writer.global":{source:"apache",extensions:["sxg"]},"application/vnd.sun.xml.writer.template":{source:"apache",extensions:["stw"]},"application/vnd.sus-calendar":{source:"iana",extensions:["sus","susp"]},"application/vnd.svd":{source:"iana",extensions:["svd"]},"application/vnd.swiftview-ics":{source:"iana"},"application/vnd.sycle+xml":{source:"iana",compressible:!0},"application/vnd.syft+json":{source:"iana",compressible:!0},"application/vnd.symbian.install":{source:"apache",extensions:["sis","sisx"]},"application/vnd.syncml+xml":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["xsm"]},"application/vnd.syncml.dm+wbxml":{source:"iana",charset:"UTF-8",extensions:["bdm"]},"application/vnd.syncml.dm+xml":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["xdm"]},"application/vnd.syncml.dm.notification":{source:"iana"},"application/vnd.syncml.dmddf+wbxml":{source:"iana"},"application/vnd.syncml.dmddf+xml":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["ddf"]},"application/vnd.syncml.dmtnds+wbxml":{source:"iana"},"application/vnd.syncml.dmtnds+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.syncml.ds.notification":{source:"iana"},"application/vnd.tableschema+json":{source:"iana",compressible:!0},"application/vnd.tao.intent-module-archive":{source:"iana",extensions:["tao"]},"application/vnd.tcpdump.pcap":{source:"iana",extensions:["pcap","cap","dmp"]},"application/vnd.think-cell.ppttc+json":{source:"iana",compressible:!0},"application/vnd.tmd.mediaflex.api+xml":{source:"iana",compressible:!0},"application/vnd.tml":{source:"iana"},"application/vnd.tmobile-livetv":{source:"iana",extensions:["tmo"]},"application/vnd.tri.onesource":{source:"iana"},"application/vnd.trid.tpt":{source:"iana",extensions:["tpt"]},"application/vnd.triscape.mxs":{source:"iana",extensions:["mxs"]},"application/vnd.trueapp":{source:"iana",extensions:["tra"]},"application/vnd.truedoc":{source:"iana"},"application/vnd.ubisoft.webplayer":{source:"iana"},"application/vnd.ufdl":{source:"iana",extensions:["ufd","ufdl"]},"application/vnd.uiq.theme":{source:"iana",extensions:["utz"]},"application/vnd.umajin":{source:"iana",extensions:["umj"]},"application/vnd.unity":{source:"iana",extensions:["unityweb"]},"application/vnd.uoml+xml":{source:"iana",compressible:!0,extensions:["uoml"]},"application/vnd.uplanet.alert":{source:"iana"},"application/vnd.uplanet.alert-wbxml":{source:"iana"},"application/vnd.uplanet.bearer-choice":{source:"iana"},"application/vnd.uplanet.bearer-choice-wbxml":{source:"iana"},"application/vnd.uplanet.cacheop":{source:"iana"},"application/vnd.uplanet.cacheop-wbxml":{source:"iana"},"application/vnd.uplanet.channel":{source:"iana"},"application/vnd.uplanet.channel-wbxml":{source:"iana"},"application/vnd.uplanet.list":{source:"iana"},"application/vnd.uplanet.list-wbxml":{source:"iana"},"application/vnd.uplanet.listcmd":{source:"iana"},"application/vnd.uplanet.listcmd-wbxml":{source:"iana"},"application/vnd.uplanet.signal":{source:"iana"},"application/vnd.uri-map":{source:"iana"},"application/vnd.valve.source.material":{source:"iana"},"application/vnd.vcx":{source:"iana",extensions:["vcx"]},"application/vnd.vd-study":{source:"iana"},"application/vnd.vectorworks":{source:"iana"},"application/vnd.vel+json":{source:"iana",compressible:!0},"application/vnd.verimatrix.vcas":{source:"iana"},"application/vnd.veritone.aion+json":{source:"iana",compressible:!0},"application/vnd.veryant.thin":{source:"iana"},"application/vnd.ves.encrypted":{source:"iana"},"application/vnd.vidsoft.vidconference":{source:"iana"},"application/vnd.visio":{source:"iana",extensions:["vsd","vst","vss","vsw"]},"application/vnd.visionary":{source:"iana",extensions:["vis"]},"application/vnd.vividence.scriptfile":{source:"iana"},"application/vnd.vsf":{source:"iana",extensions:["vsf"]},"application/vnd.wap.sic":{source:"iana"},"application/vnd.wap.slc":{source:"iana"},"application/vnd.wap.wbxml":{source:"iana",charset:"UTF-8",extensions:["wbxml"]},"application/vnd.wap.wmlc":{source:"iana",extensions:["wmlc"]},"application/vnd.wap.wmlscriptc":{source:"iana",extensions:["wmlsc"]},"application/vnd.webturbo":{source:"iana",extensions:["wtb"]},"application/vnd.wfa.dpp":{source:"iana"},"application/vnd.wfa.p2p":{source:"iana"},"application/vnd.wfa.wsc":{source:"iana"},"application/vnd.windows.devicepairing":{source:"iana"},"application/vnd.wmc":{source:"iana"},"application/vnd.wmf.bootstrap":{source:"iana"},"application/vnd.wolfram.mathematica":{source:"iana"},"application/vnd.wolfram.mathematica.package":{source:"iana"},"application/vnd.wolfram.player":{source:"iana",extensions:["nbp"]},"application/vnd.wordperfect":{source:"iana",extensions:["wpd"]},"application/vnd.wqd":{source:"iana",extensions:["wqd"]},"application/vnd.wrq-hp3000-labelled":{source:"iana"},"application/vnd.wt.stf":{source:"iana",extensions:["stf"]},"application/vnd.wv.csp+wbxml":{source:"iana"},"application/vnd.wv.csp+xml":{source:"iana",compressible:!0},"application/vnd.wv.ssp+xml":{source:"iana",compressible:!0},"application/vnd.xacml+json":{source:"iana",compressible:!0},"application/vnd.xara":{source:"iana",extensions:["xar"]},"application/vnd.xfdl":{source:"iana",extensions:["xfdl"]},"application/vnd.xfdl.webform":{source:"iana"},"application/vnd.xmi+xml":{source:"iana",compressible:!0},"application/vnd.xmpie.cpkg":{source:"iana"},"application/vnd.xmpie.dpkg":{source:"iana"},"application/vnd.xmpie.plan":{source:"iana"},"application/vnd.xmpie.ppkg":{source:"iana"},"application/vnd.xmpie.xlim":{source:"iana"},"application/vnd.yamaha.hv-dic":{source:"iana",extensions:["hvd"]},"application/vnd.yamaha.hv-script":{source:"iana",extensions:["hvs"]},"application/vnd.yamaha.hv-voice":{source:"iana",extensions:["hvp"]},"application/vnd.yamaha.openscoreformat":{source:"iana",extensions:["osf"]},"application/vnd.yamaha.openscoreformat.osfpvg+xml":{source:"iana",compressible:!0,extensions:["osfpvg"]},"application/vnd.yamaha.remote-setup":{source:"iana"},"application/vnd.yamaha.smaf-audio":{source:"iana",extensions:["saf"]},"application/vnd.yamaha.smaf-phrase":{source:"iana",extensions:["spf"]},"application/vnd.yamaha.through-ngn":{source:"iana"},"application/vnd.yamaha.tunnel-udpencap":{source:"iana"},"application/vnd.yaoweme":{source:"iana"},"application/vnd.yellowriver-custom-menu":{source:"iana",extensions:["cmp"]},"application/vnd.youtube.yt":{source:"iana"},"application/vnd.zul":{source:"iana",extensions:["zir","zirz"]},"application/vnd.zzazz.deck+xml":{source:"iana",compressible:!0,extensions:["zaz"]},"application/voicexml+xml":{source:"iana",compressible:!0,extensions:["vxml"]},"application/voucher-cms+json":{source:"iana",compressible:!0},"application/vq-rtcpxr":{source:"iana"},"application/wasm":{source:"iana",compressible:!0,extensions:["wasm"]},"application/watcherinfo+xml":{source:"iana",compressible:!0,extensions:["wif"]},"application/webpush-options+json":{source:"iana",compressible:!0},"application/whoispp-query":{source:"iana"},"application/whoispp-response":{source:"iana"},"application/widget":{source:"iana",extensions:["wgt"]},"application/winhlp":{source:"apache",extensions:["hlp"]},"application/wita":{source:"iana"},"application/wordperfect5.1":{source:"iana"},"application/wsdl+xml":{source:"iana",compressible:!0,extensions:["wsdl"]},"application/wspolicy+xml":{source:"iana",compressible:!0,extensions:["wspolicy"]},"application/x-7z-compressed":{source:"apache",compressible:!1,extensions:["7z"]},"application/x-abiword":{source:"apache",extensions:["abw"]},"application/x-ace-compressed":{source:"apache",extensions:["ace"]},"application/x-amf":{source:"apache"},"application/x-apple-diskimage":{source:"apache",extensions:["dmg"]},"application/x-arj":{compressible:!1,extensions:["arj"]},"application/x-authorware-bin":{source:"apache",extensions:["aab","x32","u32","vox"]},"application/x-authorware-map":{source:"apache",extensions:["aam"]},"application/x-authorware-seg":{source:"apache",extensions:["aas"]},"application/x-bcpio":{source:"apache",extensions:["bcpio"]},"application/x-bdoc":{compressible:!1,extensions:["bdoc"]},"application/x-bittorrent":{source:"apache",extensions:["torrent"]},"application/x-blorb":{source:"apache",extensions:["blb","blorb"]},"application/x-bzip":{source:"apache",compressible:!1,extensions:["bz"]},"application/x-bzip2":{source:"apache",compressible:!1,extensions:["bz2","boz"]},"application/x-cbr":{source:"apache",extensions:["cbr","cba","cbt","cbz","cb7"]},"application/x-cdlink":{source:"apache",extensions:["vcd"]},"application/x-cfs-compressed":{source:"apache",extensions:["cfs"]},"application/x-chat":{source:"apache",extensions:["chat"]},"application/x-chess-pgn":{source:"apache",extensions:["pgn"]},"application/x-chrome-extension":{extensions:["crx"]},"application/x-cocoa":{source:"nginx",extensions:["cco"]},"application/x-compress":{source:"apache"},"application/x-conference":{source:"apache",extensions:["nsc"]},"application/x-cpio":{source:"apache",extensions:["cpio"]},"application/x-csh":{source:"apache",extensions:["csh"]},"application/x-deb":{compressible:!1},"application/x-debian-package":{source:"apache",extensions:["deb","udeb"]},"application/x-dgc-compressed":{source:"apache",extensions:["dgc"]},"application/x-director":{source:"apache",extensions:["dir","dcr","dxr","cst","cct","cxt","w3d","fgd","swa"]},"application/x-doom":{source:"apache",extensions:["wad"]},"application/x-dtbncx+xml":{source:"apache",compressible:!0,extensions:["ncx"]},"application/x-dtbook+xml":{source:"apache",compressible:!0,extensions:["dtb"]},"application/x-dtbresource+xml":{source:"apache",compressible:!0,extensions:["res"]},"application/x-dvi":{source:"apache",compressible:!1,extensions:["dvi"]},"application/x-envoy":{source:"apache",extensions:["evy"]},"application/x-eva":{source:"apache",extensions:["eva"]},"application/x-font-bdf":{source:"apache",extensions:["bdf"]},"application/x-font-dos":{source:"apache"},"application/x-font-framemaker":{source:"apache"},"application/x-font-ghostscript":{source:"apache",extensions:["gsf"]},"application/x-font-libgrx":{source:"apache"},"application/x-font-linux-psf":{source:"apache",extensions:["psf"]},"application/x-font-pcf":{source:"apache",extensions:["pcf"]},"application/x-font-snf":{source:"apache",extensions:["snf"]},"application/x-font-speedo":{source:"apache"},"application/x-font-sunos-news":{source:"apache"},"application/x-font-type1":{source:"apache",extensions:["pfa","pfb","pfm","afm"]},"application/x-font-vfont":{source:"apache"},"application/x-freearc":{source:"apache",extensions:["arc"]},"application/x-futuresplash":{source:"apache",extensions:["spl"]},"application/x-gca-compressed":{source:"apache",extensions:["gca"]},"application/x-glulx":{source:"apache",extensions:["ulx"]},"application/x-gnumeric":{source:"apache",extensions:["gnumeric"]},"application/x-gramps-xml":{source:"apache",extensions:["gramps"]},"application/x-gtar":{source:"apache",extensions:["gtar"]},"application/x-gzip":{source:"apache"},"application/x-hdf":{source:"apache",extensions:["hdf"]},"application/x-httpd-php":{compressible:!0,extensions:["php"]},"application/x-install-instructions":{source:"apache",extensions:["install"]},"application/x-iso9660-image":{source:"apache",extensions:["iso"]},"application/x-iwork-keynote-sffkey":{extensions:["key"]},"application/x-iwork-numbers-sffnumbers":{extensions:["numbers"]},"application/x-iwork-pages-sffpages":{extensions:["pages"]},"application/x-java-archive-diff":{source:"nginx",extensions:["jardiff"]},"application/x-java-jnlp-file":{source:"apache",compressible:!1,extensions:["jnlp"]},"application/x-javascript":{compressible:!0},"application/x-keepass2":{extensions:["kdbx"]},"application/x-latex":{source:"apache",compressible:!1,extensions:["latex"]},"application/x-lua-bytecode":{extensions:["luac"]},"application/x-lzh-compressed":{source:"apache",extensions:["lzh","lha"]},"application/x-makeself":{source:"nginx",extensions:["run"]},"application/x-mie":{source:"apache",extensions:["mie"]},"application/x-mobipocket-ebook":{source:"apache",extensions:["prc","mobi"]},"application/x-mpegurl":{compressible:!1},"application/x-ms-application":{source:"apache",extensions:["application"]},"application/x-ms-shortcut":{source:"apache",extensions:["lnk"]},"application/x-ms-wmd":{source:"apache",extensions:["wmd"]},"application/x-ms-wmz":{source:"apache",extensions:["wmz"]},"application/x-ms-xbap":{source:"apache",extensions:["xbap"]},"application/x-msaccess":{source:"apache",extensions:["mdb"]},"application/x-msbinder":{source:"apache",extensions:["obd"]},"application/x-mscardfile":{source:"apache",extensions:["crd"]},"application/x-msclip":{source:"apache",extensions:["clp"]},"application/x-msdos-program":{extensions:["exe"]},"application/x-msdownload":{source:"apache",extensions:["exe","dll","com","bat","msi"]},"application/x-msmediaview":{source:"apache",extensions:["mvb","m13","m14"]},"application/x-msmetafile":{source:"apache",extensions:["wmf","wmz","emf","emz"]},"application/x-msmoney":{source:"apache",extensions:["mny"]},"application/x-mspublisher":{source:"apache",extensions:["pub"]},"application/x-msschedule":{source:"apache",extensions:["scd"]},"application/x-msterminal":{source:"apache",extensions:["trm"]},"application/x-mswrite":{source:"apache",extensions:["wri"]},"application/x-netcdf":{source:"apache",extensions:["nc","cdf"]},"application/x-ns-proxy-autoconfig":{compressible:!0,extensions:["pac"]},"application/x-nzb":{source:"apache",extensions:["nzb"]},"application/x-perl":{source:"nginx",extensions:["pl","pm"]},"application/x-pilot":{source:"nginx",extensions:["prc","pdb"]},"application/x-pkcs12":{source:"apache",compressible:!1,extensions:["p12","pfx"]},"application/x-pkcs7-certificates":{source:"apache",extensions:["p7b","spc"]},"application/x-pkcs7-certreqresp":{source:"apache",extensions:["p7r"]},"application/x-pki-message":{source:"iana"},"application/x-rar-compressed":{source:"apache",compressible:!1,extensions:["rar"]},"application/x-redhat-package-manager":{source:"nginx",extensions:["rpm"]},"application/x-research-info-systems":{source:"apache",extensions:["ris"]},"application/x-sea":{source:"nginx",extensions:["sea"]},"application/x-sh":{source:"apache",compressible:!0,extensions:["sh"]},"application/x-shar":{source:"apache",extensions:["shar"]},"application/x-shockwave-flash":{source:"apache",compressible:!1,extensions:["swf"]},"application/x-silverlight-app":{source:"apache",extensions:["xap"]},"application/x-sql":{source:"apache",extensions:["sql"]},"application/x-stuffit":{source:"apache",compressible:!1,extensions:["sit"]},"application/x-stuffitx":{source:"apache",extensions:["sitx"]},"application/x-subrip":{source:"apache",extensions:["srt"]},"application/x-sv4cpio":{source:"apache",extensions:["sv4cpio"]},"application/x-sv4crc":{source:"apache",extensions:["sv4crc"]},"application/x-t3vm-image":{source:"apache",extensions:["t3"]},"application/x-tads":{source:"apache",extensions:["gam"]},"application/x-tar":{source:"apache",compressible:!0,extensions:["tar"]},"application/x-tcl":{source:"apache",extensions:["tcl","tk"]},"application/x-tex":{source:"apache",extensions:["tex"]},"application/x-tex-tfm":{source:"apache",extensions:["tfm"]},"application/x-texinfo":{source:"apache",extensions:["texinfo","texi"]},"application/x-tgif":{source:"apache",extensions:["obj"]},"application/x-ustar":{source:"apache",extensions:["ustar"]},"application/x-virtualbox-hdd":{compressible:!0,extensions:["hdd"]},"application/x-virtualbox-ova":{compressible:!0,extensions:["ova"]},"application/x-virtualbox-ovf":{compressible:!0,extensions:["ovf"]},"application/x-virtualbox-vbox":{compressible:!0,extensions:["vbox"]},"application/x-virtualbox-vbox-extpack":{compressible:!1,extensions:["vbox-extpack"]},"application/x-virtualbox-vdi":{compressible:!0,extensions:["vdi"]},"application/x-virtualbox-vhd":{compressible:!0,extensions:["vhd"]},"application/x-virtualbox-vmdk":{compressible:!0,extensions:["vmdk"]},"application/x-wais-source":{source:"apache",extensions:["src"]},"application/x-web-app-manifest+json":{compressible:!0,extensions:["webapp"]},"application/x-www-form-urlencoded":{source:"iana",compressible:!0},"application/x-x509-ca-cert":{source:"iana",extensions:["der","crt","pem"]},"application/x-x509-ca-ra-cert":{source:"iana"},"application/x-x509-next-ca-cert":{source:"iana"},"application/x-xfig":{source:"apache",extensions:["fig"]},"application/x-xliff+xml":{source:"apache",compressible:!0,extensions:["xlf"]},"application/x-xpinstall":{source:"apache",compressible:!1,extensions:["xpi"]},"application/x-xz":{source:"apache",extensions:["xz"]},"application/x-zmachine":{source:"apache",extensions:["z1","z2","z3","z4","z5","z6","z7","z8"]},"application/x400-bp":{source:"iana"},"application/xacml+xml":{source:"iana",compressible:!0},"application/xaml+xml":{source:"apache",compressible:!0,extensions:["xaml"]},"application/xcap-att+xml":{source:"iana",compressible:!0,extensions:["xav"]},"application/xcap-caps+xml":{source:"iana",compressible:!0,extensions:["xca"]},"application/xcap-diff+xml":{source:"iana",compressible:!0,extensions:["xdf"]},"application/xcap-el+xml":{source:"iana",compressible:!0,extensions:["xel"]},"application/xcap-error+xml":{source:"iana",compressible:!0},"application/xcap-ns+xml":{source:"iana",compressible:!0,extensions:["xns"]},"application/xcon-conference-info+xml":{source:"iana",compressible:!0},"application/xcon-conference-info-diff+xml":{source:"iana",compressible:!0},"application/xenc+xml":{source:"iana",compressible:!0,extensions:["xenc"]},"application/xhtml+xml":{source:"iana",compressible:!0,extensions:["xhtml","xht"]},"application/xhtml-voice+xml":{source:"apache",compressible:!0},"application/xliff+xml":{source:"iana",compressible:!0,extensions:["xlf"]},"application/xml":{source:"iana",compressible:!0,extensions:["xml","xsl","xsd","rng"]},"application/xml-dtd":{source:"iana",compressible:!0,extensions:["dtd"]},"application/xml-external-parsed-entity":{source:"iana"},"application/xml-patch+xml":{source:"iana",compressible:!0},"application/xmpp+xml":{source:"iana",compressible:!0},"application/xop+xml":{source:"iana",compressible:!0,extensions:["xop"]},"application/xproc+xml":{source:"apache",compressible:!0,extensions:["xpl"]},"application/xslt+xml":{source:"iana",compressible:!0,extensions:["xsl","xslt"]},"application/xspf+xml":{source:"apache",compressible:!0,extensions:["xspf"]},"application/xv+xml":{source:"iana",compressible:!0,extensions:["mxml","xhvml","xvml","xvm"]},"application/yang":{source:"iana",extensions:["yang"]},"application/yang-data+json":{source:"iana",compressible:!0},"application/yang-data+xml":{source:"iana",compressible:!0},"application/yang-patch+json":{source:"iana",compressible:!0},"application/yang-patch+xml":{source:"iana",compressible:!0},"application/yin+xml":{source:"iana",compressible:!0,extensions:["yin"]},"application/zip":{source:"iana",compressible:!1,extensions:["zip"]},"application/zlib":{source:"iana"},"application/zstd":{source:"iana"},"audio/1d-interleaved-parityfec":{source:"iana"},"audio/32kadpcm":{source:"iana"},"audio/3gpp":{source:"iana",compressible:!1,extensions:["3gpp"]},"audio/3gpp2":{source:"iana"},"audio/aac":{source:"iana"},"audio/ac3":{source:"iana"},"audio/adpcm":{source:"apache",extensions:["adp"]},"audio/amr":{source:"iana",extensions:["amr"]},"audio/amr-wb":{source:"iana"},"audio/amr-wb+":{source:"iana"},"audio/aptx":{source:"iana"},"audio/asc":{source:"iana"},"audio/atrac-advanced-lossless":{source:"iana"},"audio/atrac-x":{source:"iana"},"audio/atrac3":{source:"iana"},"audio/basic":{source:"iana",compressible:!1,extensions:["au","snd"]},"audio/bv16":{source:"iana"},"audio/bv32":{source:"iana"},"audio/clearmode":{source:"iana"},"audio/cn":{source:"iana"},"audio/dat12":{source:"iana"},"audio/dls":{source:"iana"},"audio/dsr-es201108":{source:"iana"},"audio/dsr-es202050":{source:"iana"},"audio/dsr-es202211":{source:"iana"},"audio/dsr-es202212":{source:"iana"},"audio/dv":{source:"iana"},"audio/dvi4":{source:"iana"},"audio/eac3":{source:"iana"},"audio/encaprtp":{source:"iana"},"audio/evrc":{source:"iana"},"audio/evrc-qcp":{source:"iana"},"audio/evrc0":{source:"iana"},"audio/evrc1":{source:"iana"},"audio/evrcb":{source:"iana"},"audio/evrcb0":{source:"iana"},"audio/evrcb1":{source:"iana"},"audio/evrcnw":{source:"iana"},"audio/evrcnw0":{source:"iana"},"audio/evrcnw1":{source:"iana"},"audio/evrcwb":{source:"iana"},"audio/evrcwb0":{source:"iana"},"audio/evrcwb1":{source:"iana"},"audio/evs":{source:"iana"},"audio/flexfec":{source:"iana"},"audio/fwdred":{source:"iana"},"audio/g711-0":{source:"iana"},"audio/g719":{source:"iana"},"audio/g722":{source:"iana"},"audio/g7221":{source:"iana"},"audio/g723":{source:"iana"},"audio/g726-16":{source:"iana"},"audio/g726-24":{source:"iana"},"audio/g726-32":{source:"iana"},"audio/g726-40":{source:"iana"},"audio/g728":{source:"iana"},"audio/g729":{source:"iana"},"audio/g7291":{source:"iana"},"audio/g729d":{source:"iana"},"audio/g729e":{source:"iana"},"audio/gsm":{source:"iana"},"audio/gsm-efr":{source:"iana"},"audio/gsm-hr-08":{source:"iana"},"audio/ilbc":{source:"iana"},"audio/ip-mr_v2.5":{source:"iana"},"audio/isac":{source:"apache"},"audio/l16":{source:"iana"},"audio/l20":{source:"iana"},"audio/l24":{source:"iana",compressible:!1},"audio/l8":{source:"iana"},"audio/lpc":{source:"iana"},"audio/melp":{source:"iana"},"audio/melp1200":{source:"iana"},"audio/melp2400":{source:"iana"},"audio/melp600":{source:"iana"},"audio/mhas":{source:"iana"},"audio/midi":{source:"apache",extensions:["mid","midi","kar","rmi"]},"audio/mobile-xmf":{source:"iana",extensions:["mxmf"]},"audio/mp3":{compressible:!1,extensions:["mp3"]},"audio/mp4":{source:"iana",compressible:!1,extensions:["m4a","mp4a"]},"audio/mp4a-latm":{source:"iana"},"audio/mpa":{source:"iana"},"audio/mpa-robust":{source:"iana"},"audio/mpeg":{source:"iana",compressible:!1,extensions:["mpga","mp2","mp2a","mp3","m2a","m3a"]},"audio/mpeg4-generic":{source:"iana"},"audio/musepack":{source:"apache"},"audio/ogg":{source:"iana",compressible:!1,extensions:["oga","ogg","spx","opus"]},"audio/opus":{source:"iana"},"audio/parityfec":{source:"iana"},"audio/pcma":{source:"iana"},"audio/pcma-wb":{source:"iana"},"audio/pcmu":{source:"iana"},"audio/pcmu-wb":{source:"iana"},"audio/prs.sid":{source:"iana"},"audio/qcelp":{source:"iana"},"audio/raptorfec":{source:"iana"},"audio/red":{source:"iana"},"audio/rtp-enc-aescm128":{source:"iana"},"audio/rtp-midi":{source:"iana"},"audio/rtploopback":{source:"iana"},"audio/rtx":{source:"iana"},"audio/s3m":{source:"apache",extensions:["s3m"]},"audio/scip":{source:"iana"},"audio/silk":{source:"apache",extensions:["sil"]},"audio/smv":{source:"iana"},"audio/smv-qcp":{source:"iana"},"audio/smv0":{source:"iana"},"audio/sofa":{source:"iana"},"audio/sp-midi":{source:"iana"},"audio/speex":{source:"iana"},"audio/t140c":{source:"iana"},"audio/t38":{source:"iana"},"audio/telephone-event":{source:"iana"},"audio/tetra_acelp":{source:"iana"},"audio/tetra_acelp_bb":{source:"iana"},"audio/tone":{source:"iana"},"audio/tsvcis":{source:"iana"},"audio/uemclip":{source:"iana"},"audio/ulpfec":{source:"iana"},"audio/usac":{source:"iana"},"audio/vdvi":{source:"iana"},"audio/vmr-wb":{source:"iana"},"audio/vnd.3gpp.iufp":{source:"iana"},"audio/vnd.4sb":{source:"iana"},"audio/vnd.audiokoz":{source:"iana"},"audio/vnd.celp":{source:"iana"},"audio/vnd.cisco.nse":{source:"iana"},"audio/vnd.cmles.radio-events":{source:"iana"},"audio/vnd.cns.anp1":{source:"iana"},"audio/vnd.cns.inf1":{source:"iana"},"audio/vnd.dece.audio":{source:"iana",extensions:["uva","uvva"]},"audio/vnd.digital-winds":{source:"iana",extensions:["eol"]},"audio/vnd.dlna.adts":{source:"iana"},"audio/vnd.dolby.heaac.1":{source:"iana"},"audio/vnd.dolby.heaac.2":{source:"iana"},"audio/vnd.dolby.mlp":{source:"iana"},"audio/vnd.dolby.mps":{source:"iana"},"audio/vnd.dolby.pl2":{source:"iana"},"audio/vnd.dolby.pl2x":{source:"iana"},"audio/vnd.dolby.pl2z":{source:"iana"},"audio/vnd.dolby.pulse.1":{source:"iana"},"audio/vnd.dra":{source:"iana",extensions:["dra"]},"audio/vnd.dts":{source:"iana",extensions:["dts"]},"audio/vnd.dts.hd":{source:"iana",extensions:["dtshd"]},"audio/vnd.dts.uhd":{source:"iana"},"audio/vnd.dvb.file":{source:"iana"},"audio/vnd.everad.plj":{source:"iana"},"audio/vnd.hns.audio":{source:"iana"},"audio/vnd.lucent.voice":{source:"iana",extensions:["lvp"]},"audio/vnd.ms-playready.media.pya":{source:"iana",extensions:["pya"]},"audio/vnd.nokia.mobile-xmf":{source:"iana"},"audio/vnd.nortel.vbk":{source:"iana"},"audio/vnd.nuera.ecelp4800":{source:"iana",extensions:["ecelp4800"]},"audio/vnd.nuera.ecelp7470":{source:"iana",extensions:["ecelp7470"]},"audio/vnd.nuera.ecelp9600":{source:"iana",extensions:["ecelp9600"]},"audio/vnd.octel.sbc":{source:"iana"},"audio/vnd.presonus.multitrack":{source:"iana"},"audio/vnd.qcelp":{source:"iana"},"audio/vnd.rhetorex.32kadpcm":{source:"iana"},"audio/vnd.rip":{source:"iana",extensions:["rip"]},"audio/vnd.rn-realaudio":{compressible:!1},"audio/vnd.sealedmedia.softseal.mpeg":{source:"iana"},"audio/vnd.vmx.cvsd":{source:"iana"},"audio/vnd.wave":{compressible:!1},"audio/vorbis":{source:"iana",compressible:!1},"audio/vorbis-config":{source:"iana"},"audio/wav":{compressible:!1,extensions:["wav"]},"audio/wave":{compressible:!1,extensions:["wav"]},"audio/webm":{source:"apache",compressible:!1,extensions:["weba"]},"audio/x-aac":{source:"apache",compressible:!1,extensions:["aac"]},"audio/x-aiff":{source:"apache",extensions:["aif","aiff","aifc"]},"audio/x-caf":{source:"apache",compressible:!1,extensions:["caf"]},"audio/x-flac":{source:"apache",extensions:["flac"]},"audio/x-m4a":{source:"nginx",extensions:["m4a"]},"audio/x-matroska":{source:"apache",extensions:["mka"]},"audio/x-mpegurl":{source:"apache",extensions:["m3u"]},"audio/x-ms-wax":{source:"apache",extensions:["wax"]},"audio/x-ms-wma":{source:"apache",extensions:["wma"]},"audio/x-pn-realaudio":{source:"apache",extensions:["ram","ra"]},"audio/x-pn-realaudio-plugin":{source:"apache",extensions:["rmp"]},"audio/x-realaudio":{source:"nginx",extensions:["ra"]},"audio/x-tta":{source:"apache"},"audio/x-wav":{source:"apache",extensions:["wav"]},"audio/xm":{source:"apache",extensions:["xm"]},"chemical/x-cdx":{source:"apache",extensions:["cdx"]},"chemical/x-cif":{source:"apache",extensions:["cif"]},"chemical/x-cmdf":{source:"apache",extensions:["cmdf"]},"chemical/x-cml":{source:"apache",extensions:["cml"]},"chemical/x-csml":{source:"apache",extensions:["csml"]},"chemical/x-pdb":{source:"apache"},"chemical/x-xyz":{source:"apache",extensions:["xyz"]},"font/collection":{source:"iana",extensions:["ttc"]},"font/otf":{source:"iana",compressible:!0,extensions:["otf"]},"font/sfnt":{source:"iana"},"font/ttf":{source:"iana",compressible:!0,extensions:["ttf"]},"font/woff":{source:"iana",extensions:["woff"]},"font/woff2":{source:"iana",extensions:["woff2"]},"image/aces":{source:"iana",extensions:["exr"]},"image/apng":{compressible:!1,extensions:["apng"]},"image/avci":{source:"iana",extensions:["avci"]},"image/avcs":{source:"iana",extensions:["avcs"]},"image/avif":{source:"iana",compressible:!1,extensions:["avif"]},"image/bmp":{source:"iana",compressible:!0,extensions:["bmp"]},"image/cgm":{source:"iana",extensions:["cgm"]},"image/dicom-rle":{source:"iana",extensions:["drle"]},"image/emf":{source:"iana",extensions:["emf"]},"image/fits":{source:"iana",extensions:["fits"]},"image/g3fax":{source:"iana",extensions:["g3"]},"image/gif":{source:"iana",compressible:!1,extensions:["gif"]},"image/heic":{source:"iana",extensions:["heic"]},"image/heic-sequence":{source:"iana",extensions:["heics"]},"image/heif":{source:"iana",extensions:["heif"]},"image/heif-sequence":{source:"iana",extensions:["heifs"]},"image/hej2k":{source:"iana",extensions:["hej2"]},"image/hsj2":{source:"iana",extensions:["hsj2"]},"image/ief":{source:"iana",extensions:["ief"]},"image/jls":{source:"iana",extensions:["jls"]},"image/jp2":{source:"iana",compressible:!1,extensions:["jp2","jpg2"]},"image/jpeg":{source:"iana",compressible:!1,extensions:["jpeg","jpg","jpe"]},"image/jph":{source:"iana",extensions:["jph"]},"image/jphc":{source:"iana",extensions:["jhc"]},"image/jpm":{source:"iana",compressible:!1,extensions:["jpm"]},"image/jpx":{source:"iana",compressible:!1,extensions:["jpx","jpf"]},"image/jxr":{source:"iana",extensions:["jxr"]},"image/jxra":{source:"iana",extensions:["jxra"]},"image/jxrs":{source:"iana",extensions:["jxrs"]},"image/jxs":{source:"iana",extensions:["jxs"]},"image/jxsc":{source:"iana",extensions:["jxsc"]},"image/jxsi":{source:"iana",extensions:["jxsi"]},"image/jxss":{source:"iana",extensions:["jxss"]},"image/ktx":{source:"iana",extensions:["ktx"]},"image/ktx2":{source:"iana",extensions:["ktx2"]},"image/naplps":{source:"iana"},"image/pjpeg":{compressible:!1},"image/png":{source:"iana",compressible:!1,extensions:["png"]},"image/prs.btif":{source:"iana",extensions:["btif"]},"image/prs.pti":{source:"iana",extensions:["pti"]},"image/pwg-raster":{source:"iana"},"image/sgi":{source:"apache",extensions:["sgi"]},"image/svg+xml":{source:"iana",compressible:!0,extensions:["svg","svgz"]},"image/t38":{source:"iana",extensions:["t38"]},"image/tiff":{source:"iana",compressible:!1,extensions:["tif","tiff"]},"image/tiff-fx":{source:"iana",extensions:["tfx"]},"image/vnd.adobe.photoshop":{source:"iana",compressible:!0,extensions:["psd"]},"image/vnd.airzip.accelerator.azv":{source:"iana",extensions:["azv"]},"image/vnd.cns.inf2":{source:"iana"},"image/vnd.dece.graphic":{source:"iana",extensions:["uvi","uvvi","uvg","uvvg"]},"image/vnd.djvu":{source:"iana",extensions:["djvu","djv"]},"image/vnd.dvb.subtitle":{source:"iana",extensions:["sub"]},"image/vnd.dwg":{source:"iana",extensions:["dwg"]},"image/vnd.dxf":{source:"iana",extensions:["dxf"]},"image/vnd.fastbidsheet":{source:"iana",extensions:["fbs"]},"image/vnd.fpx":{source:"iana",extensions:["fpx"]},"image/vnd.fst":{source:"iana",extensions:["fst"]},"image/vnd.fujixerox.edmics-mmr":{source:"iana",extensions:["mmr"]},"image/vnd.fujixerox.edmics-rlc":{source:"iana",extensions:["rlc"]},"image/vnd.globalgraphics.pgb":{source:"iana"},"image/vnd.microsoft.icon":{source:"iana",compressible:!0,extensions:["ico"]},"image/vnd.mix":{source:"iana"},"image/vnd.mozilla.apng":{source:"iana"},"image/vnd.ms-dds":{compressible:!0,extensions:["dds"]},"image/vnd.ms-modi":{source:"iana",extensions:["mdi"]},"image/vnd.ms-photo":{source:"apache",extensions:["wdp"]},"image/vnd.net-fpx":{source:"iana",extensions:["npx"]},"image/vnd.pco.b16":{source:"iana",extensions:["b16"]},"image/vnd.radiance":{source:"iana"},"image/vnd.sealed.png":{source:"iana"},"image/vnd.sealedmedia.softseal.gif":{source:"iana"},"image/vnd.sealedmedia.softseal.jpg":{source:"iana"},"image/vnd.svf":{source:"iana"},"image/vnd.tencent.tap":{source:"iana",extensions:["tap"]},"image/vnd.valve.source.texture":{source:"iana",extensions:["vtf"]},"image/vnd.wap.wbmp":{source:"iana",extensions:["wbmp"]},"image/vnd.xiff":{source:"iana",extensions:["xif"]},"image/vnd.zbrush.pcx":{source:"iana",extensions:["pcx"]},"image/webp":{source:"apache",extensions:["webp"]},"image/wmf":{source:"iana",extensions:["wmf"]},"image/x-3ds":{source:"apache",extensions:["3ds"]},"image/x-cmu-raster":{source:"apache",extensions:["ras"]},"image/x-cmx":{source:"apache",extensions:["cmx"]},"image/x-freehand":{source:"apache",extensions:["fh","fhc","fh4","fh5","fh7"]},"image/x-icon":{source:"apache",compressible:!0,extensions:["ico"]},"image/x-jng":{source:"nginx",extensions:["jng"]},"image/x-mrsid-image":{source:"apache",extensions:["sid"]},"image/x-ms-bmp":{source:"nginx",compressible:!0,extensions:["bmp"]},"image/x-pcx":{source:"apache",extensions:["pcx"]},"image/x-pict":{source:"apache",extensions:["pic","pct"]},"image/x-portable-anymap":{source:"apache",extensions:["pnm"]},"image/x-portable-bitmap":{source:"apache",extensions:["pbm"]},"image/x-portable-graymap":{source:"apache",extensions:["pgm"]},"image/x-portable-pixmap":{source:"apache",extensions:["ppm"]},"image/x-rgb":{source:"apache",extensions:["rgb"]},"image/x-tga":{source:"apache",extensions:["tga"]},"image/x-xbitmap":{source:"apache",extensions:["xbm"]},"image/x-xcf":{compressible:!1},"image/x-xpixmap":{source:"apache",extensions:["xpm"]},"image/x-xwindowdump":{source:"apache",extensions:["xwd"]},"message/cpim":{source:"iana"},"message/delivery-status":{source:"iana"},"message/disposition-notification":{source:"iana",extensions:["disposition-notification"]},"message/external-body":{source:"iana"},"message/feedback-report":{source:"iana"},"message/global":{source:"iana",extensions:["u8msg"]},"message/global-delivery-status":{source:"iana",extensions:["u8dsn"]},"message/global-disposition-notification":{source:"iana",extensions:["u8mdn"]},"message/global-headers":{source:"iana",extensions:["u8hdr"]},"message/http":{source:"iana",compressible:!1},"message/imdn+xml":{source:"iana",compressible:!0},"message/news":{source:"iana"},"message/partial":{source:"iana",compressible:!1},"message/rfc822":{source:"iana",compressible:!0,extensions:["eml","mime"]},"message/s-http":{source:"iana"},"message/sip":{source:"iana"},"message/sipfrag":{source:"iana"},"message/tracking-status":{source:"iana"},"message/vnd.si.simp":{source:"iana"},"message/vnd.wfa.wsc":{source:"iana",extensions:["wsc"]},"model/3mf":{source:"iana",extensions:["3mf"]},"model/e57":{source:"iana"},"model/gltf+json":{source:"iana",compressible:!0,extensions:["gltf"]},"model/gltf-binary":{source:"iana",compressible:!0,extensions:["glb"]},"model/iges":{source:"iana",compressible:!1,extensions:["igs","iges"]},"model/mesh":{source:"iana",compressible:!1,extensions:["msh","mesh","silo"]},"model/mtl":{source:"iana",extensions:["mtl"]},"model/obj":{source:"iana",extensions:["obj"]},"model/step":{source:"iana"},"model/step+xml":{source:"iana",compressible:!0,extensions:["stpx"]},"model/step+zip":{source:"iana",compressible:!1,extensions:["stpz"]},"model/step-xml+zip":{source:"iana",compressible:!1,extensions:["stpxz"]},"model/stl":{source:"iana",extensions:["stl"]},"model/vnd.collada+xml":{source:"iana",compressible:!0,extensions:["dae"]},"model/vnd.dwf":{source:"iana",extensions:["dwf"]},"model/vnd.flatland.3dml":{source:"iana"},"model/vnd.gdl":{source:"iana",extensions:["gdl"]},"model/vnd.gs-gdl":{source:"apache"},"model/vnd.gs.gdl":{source:"iana"},"model/vnd.gtw":{source:"iana",extensions:["gtw"]},"model/vnd.moml+xml":{source:"iana",compressible:!0},"model/vnd.mts":{source:"iana",extensions:["mts"]},"model/vnd.opengex":{source:"iana",extensions:["ogex"]},"model/vnd.parasolid.transmit.binary":{source:"iana",extensions:["x_b"]},"model/vnd.parasolid.transmit.text":{source:"iana",extensions:["x_t"]},"model/vnd.pytha.pyox":{source:"iana"},"model/vnd.rosette.annotated-data-model":{source:"iana"},"model/vnd.sap.vds":{source:"iana",extensions:["vds"]},"model/vnd.usdz+zip":{source:"iana",compressible:!1,extensions:["usdz"]},"model/vnd.valve.source.compiled-map":{source:"iana",extensions:["bsp"]},"model/vnd.vtu":{source:"iana",extensions:["vtu"]},"model/vrml":{source:"iana",compressible:!1,extensions:["wrl","vrml"]},"model/x3d+binary":{source:"apache",compressible:!1,extensions:["x3db","x3dbz"]},"model/x3d+fastinfoset":{source:"iana",extensions:["x3db"]},"model/x3d+vrml":{source:"apache",compressible:!1,extensions:["x3dv","x3dvz"]},"model/x3d+xml":{source:"iana",compressible:!0,extensions:["x3d","x3dz"]},"model/x3d-vrml":{source:"iana",extensions:["x3dv"]},"multipart/alternative":{source:"iana",compressible:!1},"multipart/appledouble":{source:"iana"},"multipart/byteranges":{source:"iana"},"multipart/digest":{source:"iana"},"multipart/encrypted":{source:"iana",compressible:!1},"multipart/form-data":{source:"iana",compressible:!1},"multipart/header-set":{source:"iana"},"multipart/mixed":{source:"iana"},"multipart/multilingual":{source:"iana"},"multipart/parallel":{source:"iana"},"multipart/related":{source:"iana",compressible:!1},"multipart/report":{source:"iana"},"multipart/signed":{source:"iana",compressible:!1},"multipart/vnd.bint.med-plus":{source:"iana"},"multipart/voice-message":{source:"iana"},"multipart/x-mixed-replace":{source:"iana"},"text/1d-interleaved-parityfec":{source:"iana"},"text/cache-manifest":{source:"iana",compressible:!0,extensions:["appcache","manifest"]},"text/calendar":{source:"iana",extensions:["ics","ifb"]},"text/calender":{compressible:!0},"text/cmd":{compressible:!0},"text/coffeescript":{extensions:["coffee","litcoffee"]},"text/cql":{source:"iana"},"text/cql-expression":{source:"iana"},"text/cql-identifier":{source:"iana"},"text/css":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["css"]},"text/csv":{source:"iana",compressible:!0,extensions:["csv"]},"text/csv-schema":{source:"iana"},"text/directory":{source:"iana"},"text/dns":{source:"iana"},"text/ecmascript":{source:"iana"},"text/encaprtp":{source:"iana"},"text/enriched":{source:"iana"},"text/fhirpath":{source:"iana"},"text/flexfec":{source:"iana"},"text/fwdred":{source:"iana"},"text/gff3":{source:"iana"},"text/grammar-ref-list":{source:"iana"},"text/html":{source:"iana",compressible:!0,extensions:["html","htm","shtml"]},"text/jade":{extensions:["jade"]},"text/javascript":{source:"iana",compressible:!0},"text/jcr-cnd":{source:"iana"},"text/jsx":{compressible:!0,extensions:["jsx"]},"text/less":{compressible:!0,extensions:["less"]},"text/markdown":{source:"iana",compressible:!0,extensions:["markdown","md"]},"text/mathml":{source:"nginx",extensions:["mml"]},"text/mdx":{compressible:!0,extensions:["mdx"]},"text/mizar":{source:"iana"},"text/n3":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["n3"]},"text/parameters":{source:"iana",charset:"UTF-8"},"text/parityfec":{source:"iana"},"text/plain":{source:"iana",compressible:!0,extensions:["txt","text","conf","def","list","log","in","ini"]},"text/provenance-notation":{source:"iana",charset:"UTF-8"},"text/prs.fallenstein.rst":{source:"iana"},"text/prs.lines.tag":{source:"iana",extensions:["dsc"]},"text/prs.prop.logic":{source:"iana"},"text/raptorfec":{source:"iana"},"text/red":{source:"iana"},"text/rfc822-headers":{source:"iana"},"text/richtext":{source:"iana",compressible:!0,extensions:["rtx"]},"text/rtf":{source:"iana",compressible:!0,extensions:["rtf"]},"text/rtp-enc-aescm128":{source:"iana"},"text/rtploopback":{source:"iana"},"text/rtx":{source:"iana"},"text/sgml":{source:"iana",extensions:["sgml","sgm"]},"text/shaclc":{source:"iana"},"text/shex":{source:"iana",extensions:["shex"]},"text/slim":{extensions:["slim","slm"]},"text/spdx":{source:"iana",extensions:["spdx"]},"text/strings":{source:"iana"},"text/stylus":{extensions:["stylus","styl"]},"text/t140":{source:"iana"},"text/tab-separated-values":{source:"iana",compressible:!0,extensions:["tsv"]},"text/troff":{source:"iana",extensions:["t","tr","roff","man","me","ms"]},"text/turtle":{source:"iana",charset:"UTF-8",extensions:["ttl"]},"text/ulpfec":{source:"iana"},"text/uri-list":{source:"iana",compressible:!0,extensions:["uri","uris","urls"]},"text/vcard":{source:"iana",compressible:!0,extensions:["vcard"]},"text/vnd.a":{source:"iana"},"text/vnd.abc":{source:"iana"},"text/vnd.ascii-art":{source:"iana"},"text/vnd.curl":{source:"iana",extensions:["curl"]},"text/vnd.curl.dcurl":{source:"apache",extensions:["dcurl"]},"text/vnd.curl.mcurl":{source:"apache",extensions:["mcurl"]},"text/vnd.curl.scurl":{source:"apache",extensions:["scurl"]},"text/vnd.debian.copyright":{source:"iana",charset:"UTF-8"},"text/vnd.dmclientscript":{source:"iana"},"text/vnd.dvb.subtitle":{source:"iana",extensions:["sub"]},"text/vnd.esmertec.theme-descriptor":{source:"iana",charset:"UTF-8"},"text/vnd.familysearch.gedcom":{source:"iana",extensions:["ged"]},"text/vnd.ficlab.flt":{source:"iana"},"text/vnd.fly":{source:"iana",extensions:["fly"]},"text/vnd.fmi.flexstor":{source:"iana",extensions:["flx"]},"text/vnd.gml":{source:"iana"},"text/vnd.graphviz":{source:"iana",extensions:["gv"]},"text/vnd.hans":{source:"iana"},"text/vnd.hgl":{source:"iana"},"text/vnd.in3d.3dml":{source:"iana",extensions:["3dml"]},"text/vnd.in3d.spot":{source:"iana",extensions:["spot"]},"text/vnd.iptc.newsml":{source:"iana"},"text/vnd.iptc.nitf":{source:"iana"},"text/vnd.latex-z":{source:"iana"},"text/vnd.motorola.reflex":{source:"iana"},"text/vnd.ms-mediapackage":{source:"iana"},"text/vnd.net2phone.commcenter.command":{source:"iana"},"text/vnd.radisys.msml-basic-layout":{source:"iana"},"text/vnd.senx.warpscript":{source:"iana"},"text/vnd.si.uricatalogue":{source:"iana"},"text/vnd.sosi":{source:"iana"},"text/vnd.sun.j2me.app-descriptor":{source:"iana",charset:"UTF-8",extensions:["jad"]},"text/vnd.trolltech.linguist":{source:"iana",charset:"UTF-8"},"text/vnd.wap.si":{source:"iana"},"text/vnd.wap.sl":{source:"iana"},"text/vnd.wap.wml":{source:"iana",extensions:["wml"]},"text/vnd.wap.wmlscript":{source:"iana",extensions:["wmls"]},"text/vtt":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["vtt"]},"text/x-asm":{source:"apache",extensions:["s","asm"]},"text/x-c":{source:"apache",extensions:["c","cc","cxx","cpp","h","hh","dic"]},"text/x-component":{source:"nginx",extensions:["htc"]},"text/x-fortran":{source:"apache",extensions:["f","for","f77","f90"]},"text/x-gwt-rpc":{compressible:!0},"text/x-handlebars-template":{extensions:["hbs"]},"text/x-java-source":{source:"apache",extensions:["java"]},"text/x-jquery-tmpl":{compressible:!0},"text/x-lua":{extensions:["lua"]},"text/x-markdown":{compressible:!0,extensions:["mkd"]},"text/x-nfo":{source:"apache",extensions:["nfo"]},"text/x-opml":{source:"apache",extensions:["opml"]},"text/x-org":{compressible:!0,extensions:["org"]},"text/x-pascal":{source:"apache",extensions:["p","pas"]},"text/x-processing":{compressible:!0,extensions:["pde"]},"text/x-sass":{extensions:["sass"]},"text/x-scss":{extensions:["scss"]},"text/x-setext":{source:"apache",extensions:["etx"]},"text/x-sfv":{source:"apache",extensions:["sfv"]},"text/x-suse-ymp":{compressible:!0,extensions:["ymp"]},"text/x-uuencode":{source:"apache",extensions:["uu"]},"text/x-vcalendar":{source:"apache",extensions:["vcs"]},"text/x-vcard":{source:"apache",extensions:["vcf"]},"text/xml":{source:"iana",compressible:!0,extensions:["xml"]},"text/xml-external-parsed-entity":{source:"iana"},"text/yaml":{compressible:!0,extensions:["yaml","yml"]},"video/1d-interleaved-parityfec":{source:"iana"},"video/3gpp":{source:"iana",extensions:["3gp","3gpp"]},"video/3gpp-tt":{source:"iana"},"video/3gpp2":{source:"iana",extensions:["3g2"]},"video/av1":{source:"iana"},"video/bmpeg":{source:"iana"},"video/bt656":{source:"iana"},"video/celb":{source:"iana"},"video/dv":{source:"iana"},"video/encaprtp":{source:"iana"},"video/ffv1":{source:"iana"},"video/flexfec":{source:"iana"},"video/h261":{source:"iana",extensions:["h261"]},"video/h263":{source:"iana",extensions:["h263"]},"video/h263-1998":{source:"iana"},"video/h263-2000":{source:"iana"},"video/h264":{source:"iana",extensions:["h264"]},"video/h264-rcdo":{source:"iana"},"video/h264-svc":{source:"iana"},"video/h265":{source:"iana"},"video/iso.segment":{source:"iana",extensions:["m4s"]},"video/jpeg":{source:"iana",extensions:["jpgv"]},"video/jpeg2000":{source:"iana"},"video/jpm":{source:"apache",extensions:["jpm","jpgm"]},"video/jxsv":{source:"iana"},"video/mj2":{source:"iana",extensions:["mj2","mjp2"]},"video/mp1s":{source:"iana"},"video/mp2p":{source:"iana"},"video/mp2t":{source:"iana",extensions:["ts"]},"video/mp4":{source:"iana",compressible:!1,extensions:["mp4","mp4v","mpg4"]},"video/mp4v-es":{source:"iana"},"video/mpeg":{source:"iana",compressible:!1,extensions:["mpeg","mpg","mpe","m1v","m2v"]},"video/mpeg4-generic":{source:"iana"},"video/mpv":{source:"iana"},"video/nv":{source:"iana"},"video/ogg":{source:"iana",compressible:!1,extensions:["ogv"]},"video/parityfec":{source:"iana"},"video/pointer":{source:"iana"},"video/quicktime":{source:"iana",compressible:!1,extensions:["qt","mov"]},"video/raptorfec":{source:"iana"},"video/raw":{source:"iana"},"video/rtp-enc-aescm128":{source:"iana"},"video/rtploopback":{source:"iana"},"video/rtx":{source:"iana"},"video/scip":{source:"iana"},"video/smpte291":{source:"iana"},"video/smpte292m":{source:"iana"},"video/ulpfec":{source:"iana"},"video/vc1":{source:"iana"},"video/vc2":{source:"iana"},"video/vnd.cctv":{source:"iana"},"video/vnd.dece.hd":{source:"iana",extensions:["uvh","uvvh"]},"video/vnd.dece.mobile":{source:"iana",extensions:["uvm","uvvm"]},"video/vnd.dece.mp4":{source:"iana"},"video/vnd.dece.pd":{source:"iana",extensions:["uvp","uvvp"]},"video/vnd.dece.sd":{source:"iana",extensions:["uvs","uvvs"]},"video/vnd.dece.video":{source:"iana",extensions:["uvv","uvvv"]},"video/vnd.directv.mpeg":{source:"iana"},"video/vnd.directv.mpeg-tts":{source:"iana"},"video/vnd.dlna.mpeg-tts":{source:"iana"},"video/vnd.dvb.file":{source:"iana",extensions:["dvb"]},"video/vnd.fvt":{source:"iana",extensions:["fvt"]},"video/vnd.hns.video":{source:"iana"},"video/vnd.iptvforum.1dparityfec-1010":{source:"iana"},"video/vnd.iptvforum.1dparityfec-2005":{source:"iana"},"video/vnd.iptvforum.2dparityfec-1010":{source:"iana"},"video/vnd.iptvforum.2dparityfec-2005":{source:"iana"},"video/vnd.iptvforum.ttsavc":{source:"iana"},"video/vnd.iptvforum.ttsmpeg2":{source:"iana"},"video/vnd.motorola.video":{source:"iana"},"video/vnd.motorola.videop":{source:"iana"},"video/vnd.mpegurl":{source:"iana",extensions:["mxu","m4u"]},"video/vnd.ms-playready.media.pyv":{source:"iana",extensions:["pyv"]},"video/vnd.nokia.interleaved-multimedia":{source:"iana"},"video/vnd.nokia.mp4vr":{source:"iana"},"video/vnd.nokia.videovoip":{source:"iana"},"video/vnd.objectvideo":{source:"iana"},"video/vnd.radgamettools.bink":{source:"iana"},"video/vnd.radgamettools.smacker":{source:"iana"},"video/vnd.sealed.mpeg1":{source:"iana"},"video/vnd.sealed.mpeg4":{source:"iana"},"video/vnd.sealed.swf":{source:"iana"},"video/vnd.sealedmedia.softseal.mov":{source:"iana"},"video/vnd.uvvu.mp4":{source:"iana",extensions:["uvu","uvvu"]},"video/vnd.vivo":{source:"iana",extensions:["viv"]},"video/vnd.youtube.yt":{source:"iana"},"video/vp8":{source:"iana"},"video/vp9":{source:"iana"},"video/webm":{source:"apache",compressible:!1,extensions:["webm"]},"video/x-f4v":{source:"apache",extensions:["f4v"]},"video/x-fli":{source:"apache",extensions:["fli"]},"video/x-flv":{source:"apache",compressible:!1,extensions:["flv"]},"video/x-m4v":{source:"apache",extensions:["m4v"]},"video/x-matroska":{source:"apache",compressible:!1,extensions:["mkv","mk3d","mks"]},"video/x-mng":{source:"apache",extensions:["mng"]},"video/x-ms-asf":{source:"apache",extensions:["asf","asx"]},"video/x-ms-vob":{source:"apache",extensions:["vob"]},"video/x-ms-wm":{source:"apache",extensions:["wm"]},"video/x-ms-wmv":{source:"apache",compressible:!1,extensions:["wmv"]},"video/x-ms-wmx":{source:"apache",extensions:["wmx"]},"video/x-ms-wvx":{source:"apache",extensions:["wvx"]},"video/x-msvideo":{source:"apache",extensions:["avi"]},"video/x-sgi-movie":{source:"apache",extensions:["movie"]},"video/x-smv":{source:"apache",extensions:["smv"]},"x-conference/x-cooltalk":{source:"apache",extensions:["ice"]},"x-shader/x-fragment":{compressible:!0},"x-shader/x-vertex":{compressible:!0}}});var e6e=P((osr,Z5e)=>{Z5e.exports=J5e()});var r6e=P($c=>{"use strict";var vV=e6e(),X1t=require("path").extname,t6e=/^\s*([^;\s]*)(?:;|\s|$)/,J1t=/^text\//i;$c.charset=n6e;$c.charsets={lookup:n6e};$c.contentType=Z1t;$c.extension=eTt;$c.extensions=Object.create(null);$c.lookup=tTt;$c.types=Object.create(null);nTt($c.extensions,$c.types);function n6e(n){if(!n||typeof n!="string")return!1;var e=t6e.exec(n),t=e&&vV[e[1].toLowerCase()];return t&&t.charset?t.charset:e&&J1t.test(e[1])?"UTF-8":!1}function Z1t(n){if(!n||typeof n!="string")return!1;var e=n.indexOf("/")===-1?$c.lookup(n):n;if(!e)return!1;if(e.indexOf("charset")===-1){var t=$c.charset(e);t&&(e+="; charset="+t.toLowerCase())}return e}function eTt(n){if(!n||typeof n!="string")return!1;var e=t6e.exec(n),t=e&&$c.extensions[e[1].toLowerCase()];return!t||!t.length?!1:t[0]}function tTt(n){if(!n||typeof n!="string")return!1;var e=X1t("x."+n).toLowerCase().substr(1);return e&&$c.types[e]||!1}function nTt(n,e){var t=["nginx","apache",void 0,"iana"];Object.keys(vV).forEach(function(o){var s=vV[o],a=s.extensions;if(!(!a||!a.length)){n[o]=a;for(var c=0;c<a.length;c++){var l=a[c];if(e[l]){var u=t.indexOf(vV[e[l]].source),d=t.indexOf(s.source);if(e[l]!=="application/octet-stream"&&(u>d||u===d&&e[l].substr(0,12)==="application/"))continue}e[l]=o}}})}});var o6e=P((asr,i6e)=>{i6e.exports=rTt;function rTt(n){var e=typeof setImmediate=="function"?setImmediate:typeof process=="object"&&typeof process.nextTick=="function"?process.nextTick:null;e?e(n):setTimeout(n,0)}});var Qce=P((csr,a6e)=>{var s6e=o6e();a6e.exports=iTt;function iTt(n){var e=!1;return s6e(function(){e=!0}),function(r,o){e?n(r,o):s6e(function(){n(r,o)})}}});var Xce=P((lsr,c6e)=>{c6e.exports=oTt;function oTt(n){Object.keys(n.jobs).forEach(sTt.bind(n)),n.jobs={}}function sTt(n){typeof this.jobs[n]=="function"&&this.jobs[n]()}});var Jce=P((usr,u6e)=>{var l6e=Qce(),aTt=Xce();u6e.exports=cTt;function cTt(n,e,t,r){var o=t.keyedList?t.keyedList[t.index]:t.index;t.jobs[o]=lTt(e,o,n[o],function(s,a){o in t.jobs&&(delete t.jobs[o],s?aTt(t):t.results[o]=a,r(s,t.results))})}function lTt(n,e,t,r){var o;return n.length==2?o=n(t,l6e(r)):o=n(t,e,l6e(r)),o}});var Zce=P((dsr,d6e)=>{d6e.exports=uTt;function uTt(n,e){var t=!Array.isArray(n),r={index:0,keyedList:t||e?Object.keys(n):null,jobs:{},results:t?{}:[],size:t?Object.keys(n).length:n.length};return e&&r.keyedList.sort(t?e:function(o,s){return e(n[o],n[s])}),r}});var ele=P((psr,p6e)=>{var dTt=Xce(),pTt=Qce();p6e.exports=fTt;function fTt(n){Object.keys(this.jobs).length&&(this.index=this.size,dTt(this),pTt(n)(null,this.results))}});var m6e=P((fsr,f6e)=>{var mTt=Jce(),hTt=Zce(),gTt=ele();f6e.exports=vTt;function vTt(n,e,t){for(var r=hTt(n);r.index<(r.keyedList||n).length;)mTt(n,e,r,function(o,s){if(o){t(o,s);return}if(Object.keys(r.jobs).length===0){t(null,r.results);return}}),r.index++;return gTt.bind(r,t)}});var tle=P((msr,yV)=>{var h6e=Jce(),yTt=Zce(),bTt=ele();yV.exports=_Tt;yV.exports.ascending=g6e;yV.exports.descending=xTt;function _Tt(n,e,t,r){var o=yTt(n,t);return h6e(n,e,o,function s(a,c){if(a){r(a,c);return}if(o.index++,o.index<(o.keyedList||n).length){h6e(n,e,o,s);return}r(null,o.results)}),bTt.bind(o,r)}function g6e(n,e){return n<e?-1:n>e?1:0}function xTt(n,e){return-1*g6e(n,e)}});var y6e=P((hsr,v6e)=>{var STt=tle();v6e.exports=ITt;function ITt(n,e,t){return STt(n,e,null,t)}});var _6e=P((gsr,b6e)=>{b6e.exports={parallel:m6e(),serial:y6e(),serialOrdered:tle()}});var S6e=P((vsr,x6e)=>{x6e.exports=function(n,e){return Object.keys(e).forEach(function(t){n[t]=n[t]||e[t]}),n}});var C6e=P((ysr,T6e)=>{var ole=X5e(),I6e=require("util"),nle=require("path"),TTt=require("http"),CTt=require("https"),ETt=require("url").parse,wTt=require("fs"),kTt=require("stream").Stream,rle=r6e(),RTt=_6e(),ile=S6e();T6e.exports=or;I6e.inherits(or,ole);function or(n){if(!(this instanceof or))return new or(n);this._overheadLength=0,this._valueLength=0,this._valuesToMeasure=[],ole.call(this),n=n||{};for(var e in n)this[e]=n[e]}or.LINE_BREAK=`\r
`;or.DEFAULT_CONTENT_TYPE="application/octet-stream";or.prototype.append=function(n,e,t){t=t||{},typeof t=="string"&&(t={filename:t});var r=ole.prototype.append.bind(this);if(typeof e=="number"&&(e=""+e),I6e.isArray(e)){this._error(new Error("Arrays are not supported."));return}var o=this._multiPartHeader(n,e,t),s=this._multiPartFooter();r(o),r(e),r(s),this._trackLength(o,e,t)};or.prototype._trackLength=function(n,e,t){var r=0;t.knownLength!=null?r+=+t.knownLength:Buffer.isBuffer(e)?r=e.length:typeof e=="string"&&(r=Buffer.byteLength(e)),this._valueLength+=r,this._overheadLength+=Buffer.byteLength(n)+or.LINE_BREAK.length,!(!e||!e.path&&!(e.readable&&e.hasOwnProperty("httpVersion"))&&!(e instanceof kTt))&&(t.knownLength||this._valuesToMeasure.push(e))};or.prototype._lengthRetriever=function(n,e){n.hasOwnProperty("fd")?n.end!=null&&n.end!=1/0&&n.start!=null?e(null,n.end+1-(n.start?n.start:0)):wTt.stat(n.path,function(t,r){var o;if(t){e(t);return}o=r.size-(n.start?n.start:0),e(null,o)}):n.hasOwnProperty("httpVersion")?e(null,+n.headers["content-length"]):n.hasOwnProperty("httpModule")?(n.on("response",function(t){n.pause(),e(null,+t.headers["content-length"])}),n.resume()):e("Unknown stream")};or.prototype._multiPartHeader=function(n,e,t){if(typeof t.header=="string")return t.header;var r=this._getContentDisposition(e,t),o=this._getContentType(e,t),s="",a={"Content-Disposition":["form-data",'name="'+n+'"'].concat(r||[]),"Content-Type":[].concat(o||[])};typeof t.header=="object"&&ile(a,t.header);var c;for(var l in a)a.hasOwnProperty(l)&&(c=a[l],c!=null&&(Array.isArray(c)||(c=[c]),c.length&&(s+=l+": "+c.join("; ")+or.LINE_BREAK)));return"--"+this.getBoundary()+or.LINE_BREAK+s+or.LINE_BREAK};or.prototype._getContentDisposition=function(n,e){var t,r;return typeof e.filepath=="string"?t=nle.normalize(e.filepath).replace(/\\/g,"/"):e.filename||n.name||n.path?t=nle.basename(e.filename||n.name||n.path):n.readable&&n.hasOwnProperty("httpVersion")&&(t=nle.basename(n.client._httpMessage.path||"")),t&&(r='filename="'+t+'"'),r};or.prototype._getContentType=function(n,e){var t=e.contentType;return!t&&n.name&&(t=rle.lookup(n.name)),!t&&n.path&&(t=rle.lookup(n.path)),!t&&n.readable&&n.hasOwnProperty("httpVersion")&&(t=n.headers["content-type"]),!t&&(e.filepath||e.filename)&&(t=rle.lookup(e.filepath||e.filename)),!t&&typeof n=="object"&&(t=or.DEFAULT_CONTENT_TYPE),t};or.prototype._multiPartFooter=function(){return function(n){var e=or.LINE_BREAK,t=this._streams.length===0;t&&(e+=this._lastBoundary()),n(e)}.bind(this)};or.prototype._lastBoundary=function(){return"--"+this.getBoundary()+"--"+or.LINE_BREAK};or.prototype.getHeaders=function(n){var e,t={"content-type":"multipart/form-data; boundary="+this.getBoundary()};for(e in n)n.hasOwnProperty(e)&&(t[e.toLowerCase()]=n[e]);return t};or.prototype.setBoundary=function(n){this._boundary=n};or.prototype.getBoundary=function(){return this._boundary||this._generateBoundary(),this._boundary};or.prototype.getBuffer=function(){for(var n=new Buffer.alloc(0),e=this.getBoundary(),t=0,r=this._streams.length;t<r;t++)typeof this._streams[t]!="function"&&(Buffer.isBuffer(this._streams[t])?n=Buffer.concat([n,this._streams[t]]):n=Buffer.concat([n,Buffer.from(this._streams[t])]),(typeof this._streams[t]!="string"||this._streams[t].substring(2,e.length+2)!==e)&&(n=Buffer.concat([n,Buffer.from(or.LINE_BREAK)])));return Buffer.concat([n,Buffer.from(this._lastBoundary())])};or.prototype._generateBoundary=function(){for(var n="--------------------------",e=0;e<24;e++)n+=Math.floor(Math.random()*10).toString(16);this._boundary=n};or.prototype.getLengthSync=function(){var n=this._overheadLength+this._valueLength;return this._streams.length&&(n+=this._lastBoundary().length),this.hasKnownLength()||this._error(new Error("Cannot calculate proper length in synchronous way.")),n};or.prototype.hasKnownLength=function(){var n=!0;return this._valuesToMeasure.length&&(n=!1),n};or.prototype.getLength=function(n){var e=this._overheadLength+this._valueLength;if(this._streams.length&&(e+=this._lastBoundary().length),!this._valuesToMeasure.length){process.nextTick(n.bind(this,null,e));return}RTt.parallel(this._valuesToMeasure,this._lengthRetriever,function(t,r){if(t){n(t);return}r.forEach(function(o){e+=o}),n(null,e)})};or.prototype.submit=function(n,e){var t,r,o={method:"post"};return typeof n=="string"?(n=ETt(n),r=ile({port:n.port,path:n.pathname,host:n.hostname,protocol:n.protocol},o)):(r=ile(n,o),r.port||(r.port=r.protocol=="https:"?443:80)),r.headers=this.getHeaders(n.headers),r.protocol=="https:"?t=CTt.request(r):t=TTt.request(r),this.getLength(function(s,a){if(s&&s!=="Unknown stream"){this._error(s);return}if(a&&t.setHeader("Content-Length",a),this.pipe(t),e){var c,l=function(u,d){return t.removeListener("error",l),t.removeListener("response",c),e.call(this,u,d)};c=l.bind(this,null),t.on("error",l),t.on("response",c)}}.bind(this)),t};or.prototype._error=function(n){this.error||(this.error=n,this.pause(),this.emit("error",n))};or.prototype.toString=function(){return"[object FormData]"}});function bV(){return{name:sle,async sendRequest(n,e){if(n.formData){let t=n.headers.get("Content-Type");t&&t.indexOf("application/x-www-form-urlencoded")!==-1?(n.body=PTt(n.formData),n.formData=void 0):await ATt(n.formData,n)}return e(n)}}}function PTt(n){let e=new URLSearchParams;for(let[t,r]of Object.entries(n))if(Array.isArray(r))for(let o of r)e.append(t,o.toString());else e.append(t,r.toString());return e.toString()}async function ATt(n,e){let t=new E6e.default;for(let o of Object.keys(n)){let s=n[o];if(Array.isArray(s))for(let a of s)t.append(o,a);else t.append(o,s)}e.body=t,e.formData=void 0;let r=e.headers.get("Content-Type");r&&r.indexOf("multipart/form-data")!==-1&&e.headers.set("Content-Type",`multipart/form-data; boundary=${t.getBoundary()}`);try{let o=await new Promise((s,a)=>{t.getLength((c,l)=>{c?a(c):s(l)})});e.headers.set("Content-Length",o)}catch{}}var E6e,sle,ale=N(()=>{E6e=q(C6e()),sle="formDataPolicy"});var w6e=P(cle=>{"use strict";Object.defineProperty(cle,"__esModule",{value:!0});function DTt(n){return function(e,t){return new Promise((r,o)=>{n.call(this,e,t,(s,a)=>{s?o(s):r(a)})})}}cle.default=DTt});var dle=P((ule,R6e)=>{"use strict";var k6e=ule&&ule.__importDefault||function(n){return n&&n.__esModule?n:{default:n}},NTt=require("events"),LTt=k6e($d()),OTt=k6e(w6e()),rM=LTt.default("agent-base");function MTt(n){return!!n&&typeof n.addRequest=="function"}function lle(){let{stack:n}=new Error;return typeof n!="string"?!1:n.split(`
`).some(e=>e.indexOf("(https.js:")!==-1||e.indexOf("node:https:")!==-1)}function _V(n,e){return new _V.Agent(n,e)}(function(n){class e extends NTt.EventEmitter{constructor(r,o){super();let s=o;typeof r=="function"?this.callback=r:r&&(s=r),this.timeout=null,s&&typeof s.timeout=="number"&&(this.timeout=s.timeout),this.maxFreeSockets=1,this.maxSockets=1,this.maxTotalSockets=1/0,this.sockets={},this.freeSockets={},this.requests={},this.options={}}get defaultPort(){return typeof this.explicitDefaultPort=="number"?this.explicitDefaultPort:lle()?443:80}set defaultPort(r){this.explicitDefaultPort=r}get protocol(){return typeof this.explicitProtocol=="string"?this.explicitProtocol:lle()?"https:":"http:"}set protocol(r){this.explicitProtocol=r}callback(r,o,s){throw new Error('"agent-base" has no default implementation, you must subclass and override `callback()`')}addRequest(r,o){let s=Object.assign({},o);typeof s.secureEndpoint!="boolean"&&(s.secureEndpoint=lle()),s.host==null&&(s.host="localhost"),s.port==null&&(s.port=s.secureEndpoint?443:80),s.protocol==null&&(s.protocol=s.secureEndpoint?"https:":"http:"),s.host&&s.path&&delete s.path,delete s.agent,delete s.hostname,delete s._defaultAgent,delete s.defaultPort,delete s.createConnection,r._last=!0,r.shouldKeepAlive=!1;let a=!1,c=null,l=s.timeout||this.timeout,u=m=>{r._hadError||(r.emit("error",m),r._hadError=!0)},d=()=>{c=null,a=!0;let m=new Error(`A "socket" was not created for HTTP request before ${l}ms`);m.code="ETIMEOUT",u(m)},p=m=>{a||(c!==null&&(clearTimeout(c),c=null),u(m))},f=m=>{if(a)return;if(c!=null&&(clearTimeout(c),c=null),MTt(m)){rM("Callback returned another Agent instance %o",m.constructor.name),m.addRequest(r,s);return}if(m){m.once("free",()=>{this.freeSocket(m,s)}),r.onSocket(m);return}let h=new Error(`no Duplex stream was returned to agent-base for \`${r.method} ${r.path}\``);u(h)};if(typeof this.callback!="function"){u(new Error("`callback` is not defined"));return}this.promisifiedCallback||(this.callback.length>=3?(rM("Converting legacy callback function to promise"),this.promisifiedCallback=OTt.default(this.callback)):this.promisifiedCallback=this.callback),typeof l=="number"&&l>0&&(c=setTimeout(d,l)),"port"in s&&typeof s.port!="number"&&(s.port=Number(s.port));try{rM("Resolving socket for %o request: %o",s.protocol,`${r.method} ${r.path}`),Promise.resolve(this.promisifiedCallback(r,s)).then(f,p)}catch(m){Promise.reject(m).catch(p)}}freeSocket(r,o){rM("Freeing socket %o %o",r.constructor.name,o),r.destroy()}destroy(){rM("Destroying agent %o",this.constructor.name)}}n.Agent=e,n.prototype=n.Agent.prototype})(_V||(_V={}));R6e.exports=_V});var P6e=P(oM=>{"use strict";var FTt=oM&&oM.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(oM,"__esModule",{value:!0});var UTt=FTt($d()),iM=UTt.default("https-proxy-agent:parse-proxy-response");function BTt(n){return new Promise((e,t)=>{let r=0,o=[];function s(){let p=n.read();p?d(p):n.once("readable",s)}function a(){n.removeListener("end",l),n.removeListener("error",u),n.removeListener("close",c),n.removeListener("readable",s)}function c(p){iM("onclose had error %o",p)}function l(){iM("onend")}function u(p){a(),iM("onerror %o",p),t(p)}function d(p){o.push(p),r+=p.length;let f=Buffer.concat(o,r);if(f.indexOf(`\r
\r
`)===-1){iM("have not received end of HTTP headers yet..."),s();return}let h=f.toString("ascii",0,f.indexOf(`\r
`)),g=+h.split(" ")[1];iM("got proxy server response: %o",h),e({statusCode:g,buffered:f})}n.on("error",u),n.on("close",c),n.on("end",l),s()})}oM.default=BTt});var N6e=P(cI=>{"use strict";var qTt=cI&&cI.__awaiter||function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function c(d){try{u(r.next(d))}catch(p){a(p)}}function l(d){try{u(r.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((r=r.apply(n,e||[])).next())})},hP=cI&&cI.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(cI,"__esModule",{value:!0});var A6e=hP(require("net")),D6e=hP(require("tls")),jTt=hP(require("url")),HTt=hP(require("assert")),VTt=hP($d()),GTt=dle(),zTt=hP(P6e()),sM=VTt.default("https-proxy-agent:agent"),ple=class extends GTt.Agent{constructor(e){let t;if(typeof e=="string"?t=jTt.default.parse(e):t=e,!t)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");sM("creating new HttpsProxyAgent instance: %o",t),super(t);let r=Object.assign({},t);this.secureProxy=t.secureProxy||KTt(r.protocol),r.host=r.hostname||r.host,typeof r.port=="string"&&(r.port=parseInt(r.port,10)),!r.port&&r.host&&(r.port=this.secureProxy?443:80),this.secureProxy&&!("ALPNProtocols"in r)&&(r.ALPNProtocols=["http 1.1"]),r.host&&r.path&&(delete r.path,delete r.pathname),this.proxy=r}callback(e,t){return qTt(this,void 0,void 0,function*(){let{proxy:r,secureProxy:o}=this,s;o?(sM("Creating `tls.Socket`: %o",r),s=D6e.default.connect(r)):(sM("Creating `net.Socket`: %o",r),s=A6e.default.connect(r));let a=Object.assign({},r.headers),l=`CONNECT ${`${t.host}:${t.port}`} HTTP/1.1\r
`;r.auth&&(a["Proxy-Authorization"]=`Basic ${Buffer.from(r.auth).toString("base64")}`);let{host:u,port:d,secureEndpoint:p}=t;WTt(d,p)||(u+=`:${d}`),a.Host=u,a.Connection="close";for(let y of Object.keys(a))l+=`${y}: ${a[y]}\r
`;let f=zTt.default(s);s.write(`${l}\r
`);let{statusCode:m,buffered:h}=yield f;if(m===200){if(e.once("socket",$Tt),t.secureEndpoint){sM("Upgrading socket connection to TLS");let y=t.servername||t.host;return D6e.default.connect(Object.assign(Object.assign({},YTt(t,"host","hostname","path","port")),{socket:s,servername:y}))}return s}s.destroy();let g=new A6e.default.Socket({writable:!1});return g.readable=!0,e.once("socket",y=>{sM("replaying proxy buffer for failed request"),HTt.default(y.listenerCount("data")>0),y.push(h),y.push(null)}),g})}};cI.default=ple;function $Tt(n){n.resume()}function WTt(n,e){return!!(!e&&n===80||e&&n===443)}function KTt(n){return typeof n=="string"?/^https:?$/i.test(n):!1}function YTt(n,...e){let t={},r;for(r in n)e.includes(r)||(t[r]=n[r]);return t}});var O6e=P((hle,L6e)=>{"use strict";var QTt=hle&&hle.__importDefault||function(n){return n&&n.__esModule?n:{default:n}},fle=QTt(N6e());function mle(n){return new fle.default(n)}(function(n){n.HttpsProxyAgent=fle.default,n.prototype=fle.default.prototype})(mle||(mle={}));L6e.exports=mle});var M6e=P(gle=>{"use strict";Object.defineProperty(gle,"__esModule",{value:!0});function XTt(n,e,{signal:t}={}){return new Promise((r,o)=>{function s(){t?.removeEventListener("abort",s),n.removeListener(e,a),n.removeListener("error",c)}function a(...l){s(),r(l)}function c(l){s(),o(l)}t?.addEventListener("abort",s),n.on(e,a),n.on("error",c)})}gle.default=XTt});var F6e=P(lI=>{"use strict";var JTt=lI&&lI.__awaiter||function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function c(d){try{u(r.next(d))}catch(p){a(p)}}function l(d){try{u(r.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((r=r.apply(n,e||[])).next())})},aM=lI&&lI.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(lI,"__esModule",{value:!0});var ZTt=aM(require("net")),eCt=aM(require("tls")),vle=aM(require("url")),tCt=aM($d()),nCt=aM(M6e()),rCt=dle(),yb=(0,tCt.default)("http-proxy-agent");function iCt(n){return typeof n=="string"?/^https:?$/i.test(n):!1}var yle=class extends rCt.Agent{constructor(e){let t;if(typeof e=="string"?t=vle.default.parse(e):t=e,!t)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");yb("Creating new HttpProxyAgent instance: %o",t),super(t);let r=Object.assign({},t);this.secureProxy=t.secureProxy||iCt(r.protocol),r.host=r.hostname||r.host,typeof r.port=="string"&&(r.port=parseInt(r.port,10)),!r.port&&r.host&&(r.port=this.secureProxy?443:80),r.host&&r.path&&(delete r.path,delete r.pathname),this.proxy=r}callback(e,t){return JTt(this,void 0,void 0,function*(){let{proxy:r,secureProxy:o}=this,s=vle.default.parse(e.path);s.protocol||(s.protocol="http:"),s.hostname||(s.hostname=t.hostname||t.host||null),s.port==null&&typeof t.port&&(s.port=String(t.port)),s.port==="80"&&(s.port=""),e.path=vle.default.format(s),r.auth&&e.setHeader("Proxy-Authorization",`Basic ${Buffer.from(r.auth).toString("base64")}`);let a;if(o?(yb("Creating `tls.Socket`: %o",r),a=eCt.default.connect(r)):(yb("Creating `net.Socket`: %o",r),a=ZTt.default.connect(r)),e._header){let c,l;yb("Regenerating stored HTTP header string for request"),e._header=null,e._implicitHeader(),e.output&&e.output.length>0?(yb("Patching connection write() output buffer with updated header"),c=e.output[0],l=c.indexOf(`\r
\r
`)+4,e.output[0]=e._header+c.substring(l),yb("Output buffer: %o",e.output)):e.outputData&&e.outputData.length>0&&(yb("Patching connection write() output buffer with updated header"),c=e.outputData[0].data,l=c.indexOf(`\r
\r
`)+4,e.outputData[0].data=e._header+c.substring(l),yb("Output buffer: %o",e.outputData[0].data))}return yield(0,nCt.default)(a,"connect"),a})}};lI.default=yle});var B6e=P((xle,U6e)=>{"use strict";var oCt=xle&&xle.__importDefault||function(n){return n&&n.__esModule?n:{default:n}},ble=oCt(F6e());function _le(n){return new ble.default(n)}(function(n){n.HttpProxyAgent=ble.default,n.prototype=ble.default.prototype})(_le||(_le={}));U6e.exports=_le});function xV(n){if(process.env[n])return process.env[n];if(process.env[n.toLowerCase()])return process.env[n.toLowerCase()]}function dCt(){if(!process)return;let n=xV(sCt),e=xV(cCt),t=xV(aCt);return n||e||t}function pCt(n,e,t){if(e.length===0)return!1;let r=new URL(n).hostname;if(t?.has(r))return t.get(r);let o=!1;for(let s of e)s[0]==="."?(r.endsWith(s)||r.length===s.length-1&&r===s.slice(1))&&(o=!0):r===s&&(o=!0);return t?.set(r,o),o}function fCt(){let n=xV(lCt);return G6e=!0,n?n.split(",").map(e=>e.trim()).filter(e=>e.length):[]}function Ile(n){if(!n&&(n=dCt(),!n))return;let e=new URL(n);return{host:(e.protocol?e.protocol+"//":"")+e.hostname,port:Number.parseInt(e.port||"80"),username:e.username,password:e.password}}function j6e(n,{headers:e,tlsSettings:t}){let r;try{r=new URL(n.host)}catch{throw new Error(`Expecting a valid host string in proxy settings, but found "${n.host}".`)}t&&aa.warning("TLS settings are not supported in combination with custom Proxy, certificates provided to the client will be ignored.");let o={hostname:r.hostname,port:n.port,protocol:r.protocol,headers:e.toJSON()};return n.username&&n.password?o.auth=`${n.username}:${n.password}`:n.username&&(o.auth=`${n.username}`),o}function mCt(n,e){if(n.agent)return;let r=new URL(n.url).protocol!=="https:",o=n.proxySettings;if(o)if(r){if(!e.httpProxyAgent){let s=j6e(o,n);e.httpProxyAgent=new V6e.HttpProxyAgent(s)}n.agent=e.httpProxyAgent}else{if(!e.httpsProxyAgent){let s=j6e(o,n);e.httpsProxyAgent=new H6e.HttpsProxyAgent(s)}n.agent=e.httpsProxyAgent}}function SV(n=Ile(),e){G6e||q6e.push(...fCt());let t={};return{name:Sle,async sendRequest(r,o){var s;return!r.proxySettings&&!pCt(r.url,(s=e?.customNoProxyList)!==null&&s!==void 0?s:q6e,e?.customNoProxyList?void 0:uCt)&&(r.proxySettings=n),r.proxySettings&&mCt(r,t),o(r)}}}var H6e,V6e,sCt,aCt,cCt,lCt,Sle,q6e,G6e,uCt,Tle=N(()=>{H6e=q(O6e()),V6e=q(B6e());sP();sCt="HTTPS_PROXY",aCt="HTTP_PROXY",cCt="ALL_PROXY",lCt="NO_PROXY",Sle="proxyPolicy",q6e=[],G6e=!1,uCt=new Map});function IV(n="x-ms-client-request-id"){return{name:Cle,async sendRequest(e,t){return e.headers.has(n)||e.headers.set(n,e.requestId),t(e)}}}var Cle,Ele=N(()=>{Cle="setClientRequestIdPolicy"});function TV(n){return{name:wle,sendRequest:async(e,t)=>(e.tlsSettings||(e.tlsSettings=n),t(e))}}var wle,kle=N(()=>{wle="tlsPolicy"});function z6e(n={}){let e=new Rle(n.parentContext);return n.span&&(e=e.setValue(gP.span,n.span)),n.namespace&&(e=e.setValue(gP.namespace,n.namespace)),e}var gP,Rle,Ple=N(()=>{gP={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};Rle=class n{constructor(e){this._contextMap=e instanceof n?new Map(e._contextMap):new Map}setValue(e,t){let r=new n(this);return r._contextMap.set(e,t),r}getValue(e){return this._contextMap.get(e)}deleteValue(e){let t=new n(this);return t._contextMap.delete(e),t}}});function hCt(){return{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{}}}function gCt(){return{createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(n,e)=>({span:hCt(),tracingContext:z6e({parentContext:e.tracingContext})}),withContext(n,e,...t){return e(...t)}}}function cM(){return Ale||(Ale=gCt()),Ale}var Ale,$6e=N(()=>{Ple()});function Dle(n){let{namespace:e,packageName:t,packageVersion:r}=n;function o(u,d,p){var f;let m=cM().startSpan(u,Object.assign(Object.assign({},p),{packageName:t,packageVersion:r,tracingContext:(f=d?.tracingOptions)===null||f===void 0?void 0:f.tracingContext})),h=m.tracingContext,g=m.span;h.getValue(gP.namespace)||(h=h.setValue(gP.namespace,e)),g.setAttribute("az.namespace",h.getValue(gP.namespace));let y=Object.assign({},d,{tracingOptions:Object.assign(Object.assign({},d?.tracingOptions),{tracingContext:h})});return{span:g,updatedOptions:y}}async function s(u,d,p,f){let{span:m,updatedOptions:h}=o(u,d,f);try{let g=await a(h.tracingOptions.tracingContext,()=>Promise.resolve(p(h,m)));return m.setStatus({status:"success"}),g}catch(g){throw m.setStatus({status:"error",error:g}),g}finally{m.end()}}function a(u,d,...p){return cM().withContext(u,d,...p)}function c(u){return cM().parseTraceparentHeader(u)}function l(u){return cM().createRequestHeaders(u)}return{startSpan:o,withSpan:s,withContext:a,parseTraceparentHeader:c,createRequestHeaders:l}}var W6e=N(()=>{$6e();Ple()});var K6e=N(()=>{W6e()});var Y6e,Q6e,X6e=N(()=>{Y6e=require("util"),Q6e=Y6e.inspect.custom});function CV(n){return n instanceof Fl?!0:cP(n)&&n.name==="RestError"}var vCt,Fl,EV=N(()=>{uP();X6e();Fce();vCt=new dP,Fl=class n extends Error{constructor(e,t={}){super(e),this.name="RestError",this.code=t.code,this.statusCode=t.statusCode,this.request=t.request,this.response=t.response,Object.setPrototypeOf(this,n.prototype)}[Q6e](){return`RestError: ${this.message} 
 ${vCt.sanitize(this)}`}};Fl.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR";Fl.PARSE_ERROR="PARSE_ERROR"});function wV(n={}){let e=cV(n.userAgentPrefix),t=yCt();return{name:Nle,async sendRequest(r,o){var s,a;if(!t||!(!((s=r.tracingOptions)===null||s===void 0)&&s.tracingContext))return o(r);let{span:c,tracingContext:l}=(a=bCt(t,r,e))!==null&&a!==void 0?a:{};if(!c||!l)return o(r);try{let u=await t.withContext(l,o,r);return xCt(c,u),u}catch(u){throw _Ct(c,u),u}}}}function yCt(){try{return Dle({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:aV})}catch(n){aa.warning(`Error when creating the TracingClient: ${lP(n)}`);return}}function bCt(n,e,t){try{let{span:r,updatedOptions:o}=n.startSpan(`HTTP ${e.method}`,{tracingOptions:e.tracingOptions},{spanKind:"client",spanAttributes:{"http.method":e.method,"http.url":e.url,requestId:e.requestId}});if(!r.isRecording()){r.end();return}t&&r.setAttribute("http.user_agent",t);let s=n.createRequestHeaders(o.tracingOptions.tracingContext);for(let[a,c]of Object.entries(s))e.headers.set(a,c);return{span:r,tracingContext:o.tracingOptions.tracingContext}}catch(r){aa.warning(`Skipping creating a tracing span due to an error: ${lP(r)}`);return}}function _Ct(n,e){try{n.setStatus({status:"error",error:cP(e)?e:void 0}),CV(e)&&e.statusCode&&n.setAttribute("http.status_code",e.statusCode),n.end()}catch(t){aa.warning(`Skipping tracing span processing due to an error: ${lP(t)}`)}}function xCt(n,e){try{n.setAttribute("http.status_code",e.status);let t=e.headers.get("x-ms-request-id");t&&n.setAttribute("serviceRequestId",t),n.setStatus({status:"success"}),n.end()}catch(t){aa.warning(`Skipping tracing span processing due to an error: ${lP(t)}`)}}var Nle,Lle=N(()=>{K6e();Hce();Vce();sP();uP();EV();Nle="tracingPolicy"});function J6e(n){let e=XH();return nV&&(n.tlsOptions&&e.addPolicy(TV(n.tlsOptions)),e.addPolicy(SV(n.proxyOptions)),e.addPolicy(uV())),e.addPolicy(bV()),e.addPolicy(lV(n.userAgentOptions)),e.addPolicy(IV()),e.addPolicy(gV(n.retryOptions),{phase:"Retry"}),e.addPolicy(wV(n.userAgentOptions),{afterPhase:"Retry"}),nV&&e.addPolicy(sV(n.redirectOptions),{afterPhase:"Retry"}),e.addPolicy(oV(n.loggingOptions),{afterPhase:"Sign"}),e}var Z6e=N(()=>{Bce();Ice();jce();zce();Wce();Yce();ale();uP();Tle();Ele();kle();Lle()});function kV(n){return n.toLowerCase()}function*SCt(n){for(let e of n.values())yield[e.name,e.value]}function vP(n){return new Ole(n)}var Ole,RV=N(()=>{Ole=class{constructor(e){if(this._headersMap=new Map,e)for(let t of Object.keys(e))this.set(t,e[t])}set(e,t){this._headersMap.set(kV(e),{name:e,value:String(t)})}get(e){var t;return(t=this._headersMap.get(kV(e)))===null||t===void 0?void 0:t.value}has(e){return this._headersMap.has(kV(e))}delete(e){this._headersMap.delete(kV(e))}toJSON(e={}){let t={};if(e.preserveCase)for(let r of this._headersMap.values())t[r.name]=r.value;else for(let[r,o]of this._headersMap)t[r]=o.value;return t}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return SCt(this._headersMap)}}});function lM(n){return n&&typeof n.pipe=="function"}function e8e(n){return new Promise(e=>{n.on("close",e),n.on("end",e),n.on("error",e)})}function n8e(n){return n&&typeof n.byteLength=="number"}function TCt(n){let e=vP();for(let t of Object.keys(n.headers)){let r=n.headers[t];Array.isArray(r)?r.length>0&&e.set(t,r[0]):r&&e.set(t,r)}return e}function CCt(n,e){let t=e.get("Content-Encoding");if(t==="gzip"){let r=AV.createGunzip();return n.pipe(r),r}else if(t==="deflate"){let r=AV.createInflate();return n.pipe(r),r}return n}function ECt(n){return new Promise((e,t)=>{let r=[];n.on("data",o=>{Buffer.isBuffer(o)?r.push(o):r.push(Buffer.from(o))}),n.on("end",()=>{e(Buffer.concat(r).toString("utf8"))}),n.on("error",o=>{o&&o?.name==="AbortError"?t(o):t(new Fl(`Error reading response as text: ${o.message}`,{code:Fl.PARSE_ERROR}))})})}function wCt(n){return n?Buffer.isBuffer(n)?n.length:lM(n)?null:n8e(n)?n.byteLength:typeof n=="string"?Buffer.from(n).length:null:0}function r8e(){return new Mle}var yP,bP,AV,t8e,ICt,PV,Mle,i8e=N(()=>{yP=q(require("http")),bP=q(require("https")),AV=q(require("zlib")),t8e=require("stream");iV();RV();EV();sP();ICt={};PV=class extends t8e.Transform{constructor(e){super(),this.loadedBytes=0,this.progressCallback=e}_transform(e,t,r){this.push(e),this.loadedBytes+=e.length;try{this.progressCallback({loadedBytes:this.loadedBytes}),r()}catch(o){r(o)}}},Mle=class{constructor(){this.cachedHttpsAgents=new WeakMap}async sendRequest(e){var t,r,o;let s=new eM,a;if(e.abortSignal){if(e.abortSignal.aborted)throw new am("The operation was aborted.");a=p=>{p.type==="abort"&&s.abort()},e.abortSignal.addEventListener("abort",a)}e.timeout>0&&setTimeout(()=>{s.abort()},e.timeout);let c=e.headers.get("Accept-Encoding"),l=c?.includes("gzip")||c?.includes("deflate"),u=typeof e.body=="function"?e.body():e.body;if(u&&!e.headers.has("Content-Length")){let p=wCt(u);p!==null&&e.headers.set("Content-Length",p)}let d;try{if(u&&e.onUploadProgress){let y=e.onUploadProgress,b=new PV(y);b.on("error",_=>{aa.error("Error in upload progress",_)}),lM(u)?u.pipe(b):b.end(u),u=b}let p=await this.makeRequest(e,s,u),f=TCt(p),h={status:(t=p.statusCode)!==null&&t!==void 0?t:0,headers:f,request:e};if(e.method==="HEAD")return p.resume(),h;d=l?CCt(p,f):p;let g=e.onDownloadProgress;if(g){let y=new PV(g);y.on("error",b=>{aa.error("Error in download progress",b)}),d.pipe(y),d=y}return!((r=e.streamResponseStatusCodes)===null||r===void 0)&&r.has(Number.POSITIVE_INFINITY)||!((o=e.streamResponseStatusCodes)===null||o===void 0)&&o.has(h.status)?h.readableStreamBody=d:h.bodyAsText=await ECt(d),h}finally{if(e.abortSignal&&a){let p=Promise.resolve();lM(u)&&(p=e8e(u));let f=Promise.resolve();lM(d)&&(f=e8e(d)),Promise.all([p,f]).then(()=>{var m;a&&((m=e.abortSignal)===null||m===void 0||m.removeEventListener("abort",a))}).catch(m=>{aa.warning("Error when cleaning up abortListener on httpRequest",m)})}}}makeRequest(e,t,r){var o;let s=new URL(e.url),a=s.protocol!=="https:";if(a&&!e.allowInsecureConnection)throw new Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);let l={agent:(o=e.agent)!==null&&o!==void 0?o:this.getOrCreateAgent(e,a),hostname:s.hostname,path:`${s.pathname}${s.search}`,port:s.port,method:e.method,headers:e.headers.toJSON({preserveCase:!0})};return new Promise((u,d)=>{let p=a?yP.request(l,u):bP.request(l,u);p.once("error",f=>{var m;d(new Fl(f.message,{code:(m=f.code)!==null&&m!==void 0?m:Fl.REQUEST_SEND_ERROR,request:e}))}),t.signal.addEventListener("abort",()=>{let f=new am("The operation was aborted.");p.destroy(f),d(f)}),r&&lM(r)?r.pipe(p):r?typeof r=="string"||Buffer.isBuffer(r)?p.end(r):n8e(r)?p.end(ArrayBuffer.isView(r)?Buffer.from(r.buffer):Buffer.from(r)):(aa.error("Unrecognized body type",r),d(new Fl("Unrecognized body type"))):p.end()})}getOrCreateAgent(e,t){var r;let o=e.disableKeepAlive;if(t)return o?yP.globalAgent:(this.cachedHttpAgent||(this.cachedHttpAgent=new yP.Agent({keepAlive:!0})),this.cachedHttpAgent);{if(o&&!e.tlsSettings)return bP.globalAgent;let s=(r=e.tlsSettings)!==null&&r!==void 0?r:ICt,a=this.cachedHttpsAgents.get(s);return a&&a.options.keepAlive===!o||(aa.info("No cached TLS Agent exist, creating a new Agent"),a=new bP.Agent(Object.assign({keepAlive:!o},s)),this.cachedHttpsAgents.set(s,a)),a}}}});function o8e(){return r8e()}var s8e=N(()=>{i8e()});function Fle(){return DV>NV.length-16&&(a8e.default.randomFillSync(NV),DV=0),NV.slice(DV,DV+=16)}var a8e,NV,DV,c8e=N(()=>{a8e=q(require("crypto")),NV=new Uint8Array(256),DV=NV.length});var l8e,u8e=N(()=>{l8e=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i});function kCt(n){return typeof n=="string"&&l8e.test(n)}var d8e,p8e=N(()=>{u8e();d8e=kCt});function RCt(n,e=0){let t=(ca[n[e+0]]+ca[n[e+1]]+ca[n[e+2]]+ca[n[e+3]]+"-"+ca[n[e+4]]+ca[n[e+5]]+"-"+ca[n[e+6]]+ca[n[e+7]]+"-"+ca[n[e+8]]+ca[n[e+9]]+"-"+ca[n[e+10]]+ca[n[e+11]]+ca[n[e+12]]+ca[n[e+13]]+ca[n[e+14]]+ca[n[e+15]]).toLowerCase();if(!d8e(t))throw TypeError("Stringified UUID is invalid");return t}var ca,f8e,m8e=N(()=>{p8e();ca=[];for(let n=0;n<256;++n)ca.push((n+256).toString(16).substr(1));f8e=RCt});function PCt(n,e,t){n=n||{};let r=n.random||(n.rng||Fle)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){t=t||0;for(let o=0;o<16;++o)e[t+o]=r[o];return e}return f8e(r)}var Ule,h8e=N(()=>{c8e();m8e();Ule=PCt});var g8e=N(()=>{h8e()});function v8e(){return Ule()}var y8e=N(()=>{g8e()});function b8e(n){return new Ble(n)}var Ble,_8e=N(()=>{RV();y8e();Ble=class{constructor(e){var t,r,o,s,a,c,l;this.url=e.url,this.body=e.body,this.headers=(t=e.headers)!==null&&t!==void 0?t:vP(),this.method=(r=e.method)!==null&&r!==void 0?r:"GET",this.timeout=(o=e.timeout)!==null&&o!==void 0?o:0,this.formData=e.formData,this.disableKeepAlive=(s=e.disableKeepAlive)!==null&&s!==void 0?s:!1,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=(a=e.withCredentials)!==null&&a!==void 0?a:!1,this.abortSignal=e.abortSignal,this.tracingOptions=e.tracingOptions,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||v8e(),this.allowInsecureConnection=(c=e.allowInsecureConnection)!==null&&c!==void 0?c:!1,this.enableBrowserStreams=(l=e.enableBrowserStreams)!==null&&l!==void 0?l:!1}}});function S8e(n={}){var e;return cm([fP(Object.assign(Object.assign({},n),{ignoreSystemErrors:!0}))],{maxRetries:(e=n.maxRetries)!==null&&e!==void 0?e:3})}var x8e,I8e=N(()=>{hV();mP();x8e="exponentialRetryPolicy"});function T8e(n={}){var e;return{name:qle,sendRequest:cm([fP(Object.assign(Object.assign({},n),{ignoreHttpStatusCodes:!0}))],{maxRetries:(e=n.maxRetries)!==null&&e!==void 0?e:3}).sendRequest}}var qle,C8e=N(()=>{hV();mP();qle="systemErrorRetryPolicy"});function E8e(n={}){var e;return{name:jle,sendRequest:cm([fV()],{maxRetries:(e=n.maxRetries)!==null&&e!==void 0?e:3}).sendRequest}}var jle,w8e=N(()=>{mV();mP();jle="throttlingRetryPolicy"});async function DCt(n,e,t){async function r(){if(Date.now()<t)try{return await n()}catch{return null}else{let s=await n();if(s===null)throw new Error("Failed to refresh access token.");return s}}let o=await r();for(;o===null;)await dV(e),o=await r();return o}function k8e(n,e){let t=null,r=null,o,s=Object.assign(Object.assign({},ACt),e),a={get isRefreshing(){return t!==null},get shouldRefresh(){var l;return!a.isRefreshing&&((l=r?.expiresOnTimestamp)!==null&&l!==void 0?l:0)-s.refreshWindowInMs<Date.now()},get mustRefresh(){return r===null||r.expiresOnTimestamp-s.forcedRefreshWindowInMs<Date.now()}};function c(l,u){var d;return a.isRefreshing||(t=DCt(()=>n.getToken(l,u),s.retryIntervalInMs,(d=r?.expiresOnTimestamp)!==null&&d!==void 0?d:Date.now()).then(f=>(t=null,r=f,o=u.tenantId,r)).catch(f=>{throw t=null,r=null,o=void 0,f})),t}return async(l,u)=>o!==u.tenantId||!!u.claims||a.mustRefresh?c(l,u):(a.shouldRefresh&&c(l,u),r)}var ACt,R8e=N(()=>{pV();ACt={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:1e3*60*2}});async function NCt(n){let{scopes:e,getAccessToken:t,request:r}=n,o={abortSignal:r.abortSignal,tracingOptions:r.tracingOptions},s=await t(e,o);s&&n.request.headers.set("Authorization",`Bearer ${s.token}`)}function LCt(n){let e=n.headers.get("WWW-Authenticate");if(n.status===401&&e)return e}function P8e(n){var e;let{credential:t,scopes:r,challengeCallbacks:o}=n,s=n.logger||aa,a=Object.assign({authorizeRequest:(e=o?.authorizeRequest)!==null&&e!==void 0?e:NCt,authorizeRequestOnChallenge:o?.authorizeRequestOnChallenge},o),c=t?k8e(t):()=>Promise.resolve(null);return{name:Hle,async sendRequest(l,u){if(!l.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");await a.authorizeRequest({scopes:Array.isArray(r)?r:[r],request:l,getAccessToken:c,logger:s});let d,p;try{d=await u(l)}catch(f){p=f,d=f.response}if(a.authorizeRequestOnChallenge&&d?.status===401&&LCt(d)&&await a.authorizeRequestOnChallenge({scopes:Array.isArray(r)?r:[r],request:l,response:d,getAccessToken:c,logger:s}))return u(l);if(p)throw p;return d}}}var Hle,A8e=N(()=>{R8e();sP();Hle="bearerTokenAuthenticationPolicy"});function D8e(){return{name:Vle,async sendRequest(n,e){if(typeof n.body=="string"&&n.body.startsWith("[")){let t=JSON.parse(n.body);Array.isArray(t)&&(n.body=t.map(r=>JSON.stringify(r)+`
`).join(""))}return e(n)}}}var Vle,N8e=N(()=>{Vle="ndJsonPolicy"});var L8e={};Dr(L8e,{RestError:()=>Fl,bearerTokenAuthenticationPolicy:()=>P8e,bearerTokenAuthenticationPolicyName:()=>Hle,createDefaultHttpClient:()=>o8e,createEmptyPipeline:()=>XH,createHttpHeaders:()=>vP,createPipelineFromOptions:()=>J6e,createPipelineRequest:()=>b8e,decompressResponsePolicy:()=>uV,decompressResponsePolicyName:()=>$ce,defaultRetryPolicy:()=>gV,exponentialRetryPolicy:()=>S8e,exponentialRetryPolicyName:()=>x8e,formDataPolicy:()=>bV,formDataPolicyName:()=>sle,getDefaultProxySettings:()=>Ile,isRestError:()=>CV,logPolicy:()=>oV,logPolicyName:()=>Uce,ndJsonPolicy:()=>D8e,ndJsonPolicyName:()=>Vle,proxyPolicy:()=>SV,proxyPolicyName:()=>Sle,redirectPolicy:()=>sV,redirectPolicyName:()=>qce,retryPolicy:()=>cm,setClientRequestIdPolicy:()=>IV,setClientRequestIdPolicyName:()=>Cle,systemErrorRetryPolicy:()=>T8e,systemErrorRetryPolicyName:()=>qle,throttlingRetryPolicy:()=>E8e,throttlingRetryPolicyName:()=>jle,tlsPolicy:()=>TV,tlsPolicyName:()=>wle,tracingPolicy:()=>wV,tracingPolicyName:()=>Nle,userAgentPolicy:()=>lV,userAgentPolicyName:()=>Gce});var O8e=N(()=>{Ice();Z6e();s8e();RV();_8e();EV();Wce();I8e();Ele();Bce();Tle();jce();C8e();w8e();mP();Lle();Yce();zce();kle();ale();A8e();N8e()});var U8e=P((uM,F8e)=>{"use strict";var OCt=uM&&uM.__awaiter||function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function c(d){try{u(r.next(d))}catch(p){a(p)}}function l(d){try{u(r.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((r=r.apply(n,e||[])).next())})},MCt=uM&&uM.__generator||function(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,o=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(d){u=[6,d],o=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},M8e=(O8e(),Eo(L8e)),FCt="https://monitor.azure.com//.default";function UCt(n){return null}var BCt=function(){function n(e,t){var r=t?[t]:[FCt];this._azureTokenPolicy=M8e.bearerTokenAuthenticationPolicy({credential:e,scopes:r})}return n.prototype.addAuthorizationHeader=function(e){return OCt(this,void 0,void 0,function(){var t,r;return MCt(this,function(o){switch(o.label){case 0:return t="authorization",r=M8e.createPipelineRequest({url:"https://"}),[4,this._azureTokenPolicy.sendRequest(r,UCt)];case 1:return o.sent(),e.headers[t]=r.headers.get(t),[2]}})})},n}();F8e.exports=BCt});var q8e=P((gcr,B8e)=>{"use strict";var qCt=li(),jCt=ra(),HCt=function(){function n(e,t,r,o){this._buffer=[],this._lastSend=0,this._isDisabled=e,this._getBatchSize=t,this._getBatchIntervalMs=r,this._sender=o}return n.prototype.setUseDiskRetryCaching=function(e,t,r){this._sender.setDiskRetryMode(e,t,r)},n.prototype.send=function(e){var t=this;if(!this._isDisabled()){if(!e){qCt.warn("Cannot send null/undefined telemetry");return}if(this._buffer.push(e),this._buffer.length>=this._getBatchSize()){this.triggerSend(!1);return}!this._timeoutHandle&&this._buffer.length>0&&(this._timeoutHandle=setTimeout(function(){t._timeoutHandle=null,t.triggerSend(!1)},this._getBatchIntervalMs()))}},n.prototype.triggerSend=function(e,t){var r=this._buffer.length<1;r||(e||jCt.isNodeExit?(this._sender.saveOnCrash(this._buffer),typeof t=="function"&&t("data saved on crash")):this._sender.send(this._buffer,t)),this._lastSend=+new Date,this._buffer=[],clearTimeout(this._timeoutHandle),this._timeoutHandle=null,r&&typeof t=="function"&&t("no data to send")},n}();B8e.exports=HCt});var j8e=P(LV=>{"use strict";Object.defineProperty(LV,"__esModule",{value:!0});LV.azureRoleEnvironmentTelemetryProcessor=void 0;function VCt(n,e){}LV.azureRoleEnvironmentTelemetryProcessor=VCt});var G8e=P(_P=>{"use strict";Object.defineProperty(_P,"__esModule",{value:!0});_P.getSamplingHashCode=_P.samplingTelemetryProcessor=void 0;var H8e=Ea();function GCt(n,e){var t=n.sampleRate,r=!1;return t==null||t>=100||n.data&&H8e.TelemetryType.Metric===H8e.baseTypeToTelemetryType(n.data.baseType)?!0:(e.correlationContext&&e.correlationContext.operation?r=V8e(e.correlationContext.operation.id)<t:r=Math.random()*100<t,r)}_P.samplingTelemetryProcessor=GCt;function V8e(n){var e=-2147483648,t=2147483647,r=5381;if(!n)return 0;for(;n.length<8;)n=n+n;for(var o=0;o<n.length;o++)r=((r<<5)+r|0)+n.charCodeAt(o)|0;return r=r<=e?t:Math.abs(r),r/t*100}_P.getSamplingHashCode=V8e});var z8e=P(OV=>{"use strict";Object.defineProperty(OV,"__esModule",{value:!0});OV.performanceMetricsTelemetryProcessor=void 0;var Gle=FH(),zle=Ea();function zCt(n,e){switch(e&&e.addDocument(n),n.data.baseType){case zle.TelemetryTypeString.Exception:Gle.countException();break;case zle.TelemetryTypeString.Request:var t=n.data.baseData;Gle.countRequest(t.duration,t.success);break;case zle.TelemetryTypeString.Dependency:var r=n.data.baseData;Gle.countDependency(r.duration,r.success);break}return!0}OV.performanceMetricsTelemetryProcessor=zCt});var $8e=P(xP=>{"use strict";var lm=xP&&xP.__assign||function(){return lm=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o])}return n},lm.apply(this,arguments)};Object.defineProperty(xP,"__esModule",{value:!0});xP.preAggregatedMetricsTelemetryProcessor=void 0;var $Ct=Ea(),dM=ece(),MV=Ea();function WCt(n,e){if(dM.isEnabled())switch(n.data.baseType){case MV.TelemetryTypeString.Exception:var t=n.data.baseData;t.properties=lm(lm({},t.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Exceptions', Ver:'1.1')"});var r={cloudRoleInstance:n.tags[e.keys.cloudRoleInstance],cloudRoleName:n.tags[e.keys.cloudRole]};dM.countException(r);break;case MV.TelemetryTypeString.Trace:var o=n.data.baseData;o.properties=lm(lm({},o.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Traces', Ver:'1.1')"});var s={cloudRoleInstance:n.tags[e.keys.cloudRoleInstance],cloudRoleName:n.tags[e.keys.cloudRole],traceSeverityLevel:$Ct.SeverityLevel[o.severity]};dM.countTrace(s);break;case MV.TelemetryTypeString.Request:var a=n.data.baseData;a.properties=lm(lm({},a.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Requests', Ver:'1.1')"});var c={cloudRoleInstance:n.tags[e.keys.cloudRoleInstance],cloudRoleName:n.tags[e.keys.cloudRole],operationSynthetic:n.tags[e.keys.operationSyntheticSource],requestSuccess:a.success,requestResultCode:a.responseCode};dM.countRequest(a.duration,c);break;case MV.TelemetryTypeString.Dependency:var l=n.data.baseData;l.properties=lm(lm({},l.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Dependencies', Ver:'1.1')"});var u={cloudRoleInstance:n.tags[e.keys.cloudRoleInstance],cloudRoleName:n.tags[e.keys.cloudRole],operationSynthetic:n.tags[e.keys.operationSyntheticSource],dependencySuccess:l.success,dependencyType:l.type,dependencyTarget:l.target,dependencyResultCode:l.resultCode};dM.countDependency(l.duration,u);break}return!0}xP.preAggregatedMetricsTelemetryProcessor=WCt});var W8e=P(um=>{"use strict";var KCt=um&&um.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),FV=um&&um.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&KCt(e,n,t)};Object.defineProperty(um,"__esModule",{value:!0});FV(j8e(),um);FV(G8e(),um);FV(z8e(),um);FV($8e(),um)});var $le=P((Scr,Q8e)=>{"use strict";var Qt=Ea(),Wc=ra(),K8e=ob(),YCt=li(),QCt=function(){function n(){}return n.createEnvelope=function(e,t,r,o,s){var a=null;switch(t){case Qt.TelemetryType.Trace:a=n.createTraceData(e);break;case Qt.TelemetryType.Dependency:a=n.createDependencyData(e);break;case Qt.TelemetryType.Event:a=n.createEventData(e);break;case Qt.TelemetryType.Exception:a=n.createExceptionData(e);break;case Qt.TelemetryType.Request:a=n.createRequestData(e);break;case Qt.TelemetryType.Metric:a=n.createMetricData(e);break;case Qt.TelemetryType.Availability:a=n.createAvailabilityData(e);break;case Qt.TelemetryType.PageView:a=n.createPageViewData(e);break}if(a&&a.baseData&&Qt.domainSupportsProperties(a.baseData)){if(r)if(!a.baseData.properties)a.baseData.properties=r;else for(var c in r)a.baseData.properties[c]||(a.baseData.properties[c]=r[c]);n.addAzureFunctionsCorrelationProperties(a.baseData.properties),a.baseData.properties&&(a.baseData.properties=Wc.validateStringMap(a.baseData.properties))}var l=s&&s.instrumentationKey||"",u=new Qt.Envelope;return u.data=a,u.iKey=l,u.name="Microsoft.ApplicationInsights."+l.replace(/-/g,"")+"."+a.baseType.substr(0,a.baseType.length-4),u.tags=this.getTags(o,e.tagOverrides),u.time=new Date().toISOString(),u.ver=1,u.sampleRate=s?s.samplingPercentage:100,t===Qt.TelemetryType.Metric&&(u.sampleRate=100),u},n.addAzureFunctionsCorrelationProperties=function(e){var t=K8e.CorrelationContextManager.getCurrentContext();if(t&&t.customProperties&&t.customProperties.getProperty instanceof Function){e=e||{};var r=t.customProperties.getProperty("InvocationId");r&&(e.InvocationId=r),r=t.customProperties.getProperty("ProcessId"),r&&(e.ProcessId=r),r=t.customProperties.getProperty("LogLevel"),r&&(e.LogLevel=r),r=t.customProperties.getProperty("Category"),r&&(e.Category=r),r=t.customProperties.getProperty("HostInstanceId"),r&&(e.HostInstanceId=r),r=t.customProperties.getProperty("AzFuncLiveLogsSessionId"),r&&(e.AzFuncLiveLogsSessionId=r)}},n.truncateProperties=function(e){if(e.properties)try{for(var t={},r=Object.keys(e.properties),o=Object.values(e.properties),s=0;s<r.length;s++)r[s].length<=150&&(Wc.isDate(o[s])||(o[s]==null&&(o[s]=""),typeof o[s]=="object"&&(o[s]=Wc.stringify(o[s])),t[r[s]]=String(o[s]).substring(0,8192)),t[r[s]]=o[s]);return t}catch(a){YCt.warn("Failed to properly truncate telemetry properties: ",a)}},n.createTraceData=function(e){var t,r=new Qt.MessageData;r.message=(t=e.message)===null||t===void 0?void 0:t.substring(0,32768),r.properties=this.truncateProperties(e),isNaN(e.severity)?r.severityLevel=Qt.SeverityLevel.Information:r.severityLevel=e.severity;var o=new Qt.Data;return o.baseType=Qt.telemetryTypeToBaseType(Qt.TelemetryType.Trace),o.baseData=r,o},n.createDependencyData=function(e){var t,r,o,s=new Qt.RemoteDependencyData;s.name=(t=e.name)===null||t===void 0?void 0:t.substring(0,1024),s.data=(r=e.data)===null||r===void 0?void 0:r.substring(0,8192),s.target=(o=e.target)===null||o===void 0?void 0:o.substring(0,1024),s.duration=Wc.msToTimeSpan(e.duration),s.success=e.success,s.type=e.dependencyTypeName,s.properties=this.truncateProperties(e),s.resultCode=e.resultCode?e.resultCode.toString():"0",e.id?s.id=e.id:s.id=Wc.w3cTraceId();var a=new Qt.Data;return a.baseType=Qt.telemetryTypeToBaseType(Qt.TelemetryType.Dependency),a.baseData=s,a},n.createEventData=function(e){var t,r=new Qt.EventData;r.name=(t=e.name)===null||t===void 0?void 0:t.substring(0,512),r.properties=this.truncateProperties(e),r.measurements=e.measurements;var o=new Qt.Data;return o.baseType=Qt.telemetryTypeToBaseType(Qt.TelemetryType.Event),o.baseData=r,o},n.createExceptionData=function(e){var t,r,o=new Qt.ExceptionData;o.properties=this.truncateProperties(e),isNaN(e.severity)?o.severityLevel=Qt.SeverityLevel.Error:o.severityLevel=e.severity,o.measurements=e.measurements,o.exceptions=[];var s=e.exception.stack,a=new Qt.ExceptionDetails;a.message=(t=e.exception.message)===null||t===void 0?void 0:t.substring(0,32768),a.typeName=(r=e.exception.name)===null||r===void 0?void 0:r.substring(0,1024),a.parsedStack=this.parseStack(s),a.hasFullStack=Wc.isArray(a.parsedStack)&&a.parsedStack.length>0,o.exceptions.push(a);var c=new Qt.Data;return c.baseType=Qt.telemetryTypeToBaseType(Qt.TelemetryType.Exception),c.baseData=o,c},n.createRequestData=function(e){var t,r,o,s,a=new Qt.RequestData;e.id?a.id=e.id:a.id=Wc.w3cTraceId(),a.name=(t=e.name)===null||t===void 0?void 0:t.substring(0,1024),a.url=(r=e.url)===null||r===void 0?void 0:r.substring(0,2048),a.source=(o=e.source)===null||o===void 0?void 0:o.substring(0,1024),a.duration=Wc.msToTimeSpan(e.duration),a.responseCode=(s=e.resultCode?e.resultCode.toString():"0")===null||s===void 0?void 0:s.substring(0,1024),a.success=e.success,a.properties=this.truncateProperties(e),a.measurements=e.measurements;var c=new Qt.Data;return c.baseType=Qt.telemetryTypeToBaseType(Qt.TelemetryType.Request),c.baseData=a,c},n.createMetricData=function(e){var t,r=new Qt.MetricData;r.metrics=[];var o=new Qt.DataPoint;o.count=isNaN(e.count)?1:e.count,o.kind=Qt.DataPointType.Aggregation,o.max=isNaN(e.max)?e.value:e.max,o.min=isNaN(e.min)?e.value:e.min,o.name=(t=e.name)===null||t===void 0?void 0:t.substring(0,1024),o.stdDev=isNaN(e.stdDev)?0:e.stdDev,o.value=e.value,o.ns=e.namespace,r.metrics.push(o),r.properties=this.truncateProperties(e);var s=new Qt.Data;return s.baseType=Qt.telemetryTypeToBaseType(Qt.TelemetryType.Metric),s.baseData=r,s},n.createAvailabilityData=function(e){var t,r,o=new Qt.AvailabilityData;e.id?o.id=e.id:o.id=Wc.w3cTraceId(),o.name=(t=e.name)===null||t===void 0?void 0:t.substring(0,1024),o.duration=Wc.msToTimeSpan(e.duration),o.success=e.success,o.runLocation=e.runLocation,o.message=(r=e.message)===null||r===void 0?void 0:r.substring(0,8192),o.measurements=e.measurements,o.properties=this.truncateProperties(e);var s=new Qt.Data;return s.baseType=Qt.telemetryTypeToBaseType(Qt.TelemetryType.Availability),s.baseData=o,s},n.createPageViewData=function(e){var t,r,o=new Qt.PageViewData;o.name=(t=e.name)===null||t===void 0?void 0:t.substring(0,1024),o.duration=Wc.msToTimeSpan(e.duration),o.url=(r=e.url)===null||r===void 0?void 0:r.substring(0,2048),o.measurements=e.measurements,o.properties=this.truncateProperties(e);var s=new Qt.Data;return s.baseType=Qt.telemetryTypeToBaseType(Qt.TelemetryType.PageView),s.baseData=o,s},n.getTags=function(e,t){var r=K8e.CorrelationContextManager.getCurrentContext(),o={};if(e&&e.tags)for(var s in e.tags)o[s]=e.tags[s];if(t)for(var s in t)o[s]=t[s];return r&&(o[e.keys.operationId]=o[e.keys.operationId]||r.operation.id,o[e.keys.operationName]=o[e.keys.operationName]||r.operation.name,o[e.keys.operationParentId]=o[e.keys.operationParentId]||r.operation.parentId),o},n.parseStack=function(e){var t=void 0;if(typeof e=="string"){var r=e.split(`
`);t=[];for(var o=0,s=0,a=0;a<=r.length;a++){var c=r[a];if(Y8e.regex.test(c)){var l=new Y8e(r[a],o++);s+=l.sizeInBytes,t.push(l)}}var u=32*1024;if(s>u)for(var d=0,p=t.length-1,f=0,m=d,h=p;d<p;){var g=t[d].sizeInBytes,y=t[p].sizeInBytes;if(f+=g+y,f>u){var b=h-m+1;t.splice(m,b);break}m=d,h=p,d++,p--}}return t},n}(),Y8e=function(){function n(e,t){this.sizeInBytes=0,this.level=t,this.method="<no_method>",this.assembly=Wc.trim(e);var r=e.match(n.regex);r&&r.length>=5&&(this.method=Wc.trim(r[2])||this.method,this.fileName=Wc.trim(r[4])||"<no_filename>",this.line=parseInt(r[5])||0),this.sizeInBytes+=this.method.length,this.sizeInBytes+=this.fileName.length,this.sizeInBytes+=this.assembly.length,this.sizeInBytes+=n.baseSize,this.sizeInBytes+=this.level.toString().length,this.sizeInBytes+=this.line.toString().length}return n.regex=/^(\s+at)?(.*?)(\@|\s\(|\s)([^\(\n]+):(\d+):(\d+)(\)?)$/,n.baseSize=58,n}();Q8e.exports=QCt});var X8e=P(bb=>{"use strict";var XCt=bb&&bb.__awaiter||function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function c(d){try{u(r.next(d))}catch(p){a(p)}}function l(d){try{u(r.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((r=r.apply(n,e||[])).next())})},JCt=bb&&bb.__generator||function(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,o=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(d){u=[6,d],o=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(bb,"__esModule",{value:!0});bb.FileAccessControl=void 0;var ZCt=require("fs"),eEt=require("os"),SP=require("child_process"),tEt=li(),nEt=function(){function n(){}return n.checkFileProtection=function(){if(!n.OS_PROVIDES_FILE_PROTECTION&&!n.OS_FILE_PROTECTION_CHECKED)if(n.OS_FILE_PROTECTION_CHECKED=!0,n.USE_ICACLS){try{n.OS_PROVIDES_FILE_PROTECTION=ZCt.existsSync(n.ICACLS_PATH)}catch{}n.OS_PROVIDES_FILE_PROTECTION||tEt.warn(n.TAG,"Could not find ICACLS in expected location! This is necessary to use disk retry mode on Windows.")}else n.OS_PROVIDES_FILE_PROTECTION=!0},n.applyACLRules=function(e){return XCt(this,void 0,void 0,function(){var t,r;return JCt(this,function(o){switch(o.label){case 0:if(!n.USE_ICACLS)return[3,7];if(n.ACLED_DIRECTORIES[e]!==void 0)return[3,6];n.ACLED_DIRECTORIES[e]=!1,o.label=1;case 1:return o.trys.push([1,4,,5]),[4,this._getACLIdentity()];case 2:return t=o.sent(),[4,this._runICACLS(this._getACLArguments(e,t))];case 3:return o.sent(),n.ACLED_DIRECTORIES[e]=!0,[3,5];case 4:throw r=o.sent(),n.ACLED_DIRECTORIES[e]=!1,r;case 5:return[3,7];case 6:if(!n.ACLED_DIRECTORIES[e])throw new Error("Setting ACL restrictions did not succeed (cached result)");o.label=7;case 7:return[2]}})})},n.applyACLRulesSync=function(e){if(n.USE_ICACLS){if(n.ACLED_DIRECTORIES[e]===void 0){this._runICACLSSync(this._getACLArguments(e,this._getACLIdentitySync())),n.ACLED_DIRECTORIES[e]=!0;return}else if(!n.ACLED_DIRECTORIES[e])throw new Error("Setting ACL restrictions did not succeed (cached result)")}},n._runICACLS=function(e){return new Promise(function(t,r){var o=SP.spawn(n.ICACLS_PATH,e,{windowsHide:!0});o.on("error",function(s){return r(s)}),o.on("close",function(s,a){s===0?t():r(new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+s+")"))})})},n._runICACLSSync=function(e){if(SP.spawnSync){var t=SP.spawnSync(n.ICACLS_PATH,e,{windowsHide:!0});if(t.error)throw t.error;if(t.status!==0)throw new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+t.status+")")}else throw new Error("Could not synchronously call ICACLS under current version of Node.js")},n._getACLIdentity=function(){return new Promise(function(e,t){n.ACL_IDENTITY&&e(n.ACL_IDENTITY);var r=SP.spawn(n.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]}),o="";r.stdout.on("data",function(s){return o+=s}),r.on("error",function(s){return t(s)}),r.on("close",function(s,a){n.ACL_IDENTITY=o&&o.trim(),s===0?e(n.ACL_IDENTITY):t(new Error("Getting ACL identity did not succeed (PS returned code "+s+")"))})})},n._getACLIdentitySync=function(){if(n.ACL_IDENTITY)return n.ACL_IDENTITY;if(SP.spawnSync){var e=SP.spawnSync(n.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]});if(e.error)throw e.error;if(e.status!==0)throw new Error("Getting ACL identity did not succeed (PS returned code "+e.status+")");return n.ACL_IDENTITY=e.stdout&&e.stdout.toString().trim(),n.ACL_IDENTITY}else throw new Error("Could not synchronously get ACL identity under current version of Node.js")},n._getACLArguments=function(e,t){return[e,"/grant","*S-1-5-32-544:(OI)(CI)F","/grant",t+":(OI)(CI)F","/inheritance:r"]},n.TAG="FileAccessControl",n.ICACLS_PATH=process.env.systemdrive+"/windows/system32/icacls.exe",n.POWERSHELL_PATH=process.env.systemdrive+"/windows/system32/windowspowershell/v1.0/powershell.exe",n.ACLED_DIRECTORIES={},n.ACL_IDENTITY=null,n.OS_FILE_PROTECTION_CHECKED=!1,n.OS_PROVIDES_FILE_PROTECTION=!1,n.USE_ICACLS=eEt.type()==="Windows_NT",n}();bb.FileAccessControl=nEt});var Kle=P((fM,Z8e)=>{"use strict";var UV=fM&&fM.__awaiter||function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function c(d){try{u(r.next(d))}catch(p){a(p)}}function l(d){try{u(r.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((r=r.apply(n,e||[])).next())})},BV=fM&&fM.__generator||function(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,o=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(d){u=[6,d],o=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},Wle=require("fs"),rEt=require("os"),uI=require("path"),iEt=require("zlib"),_b=Oi(),oEt=rP(),yg=hie(),Kc=ra(),sEt=require("url"),J8e=li(),pM=X8e(),aEt=439,cEt=402,lEt=[200,206,402,408,429,439,500],uEt=function(){function n(e,t,r,o,s,a,c){this._redirectedHost=null,this._config=e,this._onSuccess=r,this._onError=o,this._statsbeat=s,this._enableDiskRetryMode=!1,this._resendInterval=n.WAIT_BETWEEN_RESEND,this._maxBytesOnDisk=n.MAX_BYTES_ON_DISK,this._numConsecutiveFailures=0,this._numConsecutiveRedirects=0,this._resendTimer=null,this._getAuthorizationHandler=t,this._fileCleanupTimer=null,this._tempDir=uI.join(rEt.tmpdir(),n.TEMPDIR_PREFIX+this._config.instrumentationKey),this._isStatsbeatSender=a||!1,this._shutdownStatsbeat=c,this._failedToIngestCounter=0,this._statsbeatHasReachedIngestionAtLeastOnce=!1}return n.prototype.setDiskRetryMode=function(e,t,r){var o=this;e&&pM.FileAccessControl.checkFileProtection(),this._enableDiskRetryMode=pM.FileAccessControl.OS_PROVIDES_FILE_PROTECTION&&e,typeof t=="number"&&t>=0&&(this._resendInterval=Math.floor(t)),typeof r=="number"&&r>=0&&(this._maxBytesOnDisk=Math.floor(r)),e&&!pM.FileAccessControl.OS_PROVIDES_FILE_PROTECTION&&(this._enableDiskRetryMode=!1,this._logWarn("Ignoring request to enable disk retry mode. Sufficient file protection capabilities were not detected.")),this._enableDiskRetryMode?(this._statsbeat&&this._statsbeat.addFeature(_b.StatsbeatFeature.DISK_RETRY),this._fileCleanupTimer||(this._fileCleanupTimer=setTimeout(function(){o._fileCleanupTask()},n.CLEANUP_TIMEOUT),this._fileCleanupTimer.unref())):(this._statsbeat&&this._statsbeat.removeFeature(_b.StatsbeatFeature.DISK_RETRY),this._fileCleanupTimer&&clearTimeout(this._fileCleanupTimer))},n.prototype.send=function(e,t){return UV(this,void 0,void 0,function(){var r,o,s,a,c,l,u,d,p=this;return BV(this,function(f){switch(f.label){case 0:if(!e)return[3,5];if(r=this._redirectedHost||this._config.endpointUrl,o=new sEt.URL(r).hostname,s={method:"POST",withCredentials:!1,headers:{"Content-Type":"application/x-json-stream"}},a=this._getAuthorizationHandler?this._getAuthorizationHandler(this._config):null,!a)return[3,4];this._statsbeat&&this._statsbeat.addFeature(_b.StatsbeatFeature.AAD_HANDLING),f.label=1;case 1:return f.trys.push([1,3,,4]),[4,a.addAuthorizationHeader(s)];case 2:return f.sent(),[3,4];case 3:return c=f.sent(),l="Failed to get AAD bearer token for the Application.",this._enableDiskRetryMode&&(l+="This batch of telemetry items will be retried. ",this._storeToDisk(e)),l+="Error:"+c.toString(),this._logWarn(l),typeof t=="function"&&t(l),[2];case 4:u="",e.forEach(function(m){var h=Kc.stringify(m);typeof h=="string"&&(u+=h+`
`)}),u.length>0&&(u=u.substring(0,u.length-1)),d=Buffer.from?Buffer.from(u):new Buffer(u),iEt.gzip(d,function(m,h){var g=h;m?(p._logWarn(Kc.dumpObj(m)),g=d,s.headers["Content-Length"]=d.length.toString()):(s.headers["Content-Encoding"]="gzip",s.headers["Content-Length"]=h.length.toString()),p._logInfo(Kc.dumpObj(s)),s[oEt.disableCollectionRequestOption]=!0;var y=+new Date,b=function(x){x.setEncoding("utf-8");var I="";x.on("data",function(S){I+=S}),x.on("end",function(){var S=+new Date,w=S-y;if(p._numConsecutiveFailures=0,p._isStatsbeatSender&&!p._statsbeatHasReachedIngestionAtLeastOnce&&(lEt.includes(x.statusCode)?p._statsbeatHasReachedIngestionAtLeastOnce=!0:p._statsbeatFailedToIngest()),p._statsbeat&&(x.statusCode==cEt||x.statusCode==aEt?p._statsbeat.countThrottle(_b.StatsbeatNetworkCategory.Breeze,o,x.statusCode):p._statsbeat.countRequest(_b.StatsbeatNetworkCategory.Breeze,o,w,x.statusCode===200,x.statusCode)),p._enableDiskRetryMode){if(x.statusCode===200)p._resendTimer||(p._resendTimer=setTimeout(function(){p._resendTimer=null,p._sendFirstFileOnDisk()},p._resendInterval),p._resendTimer.unref());else if(p._isRetriable(x.statusCode))try{p._statsbeat&&p._statsbeat.countRetry(_b.StatsbeatNetworkCategory.Breeze,o,x.statusCode);var R=JSON.parse(I),k=[];R.errors&&(R.errors.forEach(function(K){(K.statusCode==429||K.statusCode==500||K.statusCode==503)&&k.push(e[K.index])}),k.length>0&&p._storeToDisk(k))}catch{p._storeToDisk(e)}}if(x.statusCode===307||x.statusCode===308)if(p._numConsecutiveRedirects++,p._numConsecutiveRedirects<10){var V=x.headers.location?x.headers.location.toString():null;V&&(p._redirectedHost=V,p.send(e,t))}else{var F={name:"Circular Redirect",message:"Error sending telemetry because of circular redirects."};p._statsbeat&&p._statsbeat.countException(_b.StatsbeatNetworkCategory.Breeze,o,F),typeof t=="function"&&t("Error sending telemetry because of circular redirects.")}else p._numConsecutiveRedirects=0,typeof t=="function"&&t(I),p._logInfo(I),typeof p._onSuccess=="function"&&p._onSuccess(I)})},_=Kc.makeRequest(p._config,r,s,b);_.setTimeout(n.HTTP_TIMEOUT,function(){p._requestTimedOut=!0,_.abort()}),_.on("error",function(x){if(p._isStatsbeatSender&&!p._statsbeatHasReachedIngestionAtLeastOnce&&p._statsbeatFailedToIngest(),p._numConsecutiveFailures++,p._statsbeat&&p._statsbeat.countException(_b.StatsbeatNetworkCategory.Breeze,o,x),!p._enableDiskRetryMode||p._numConsecutiveFailures>0&&p._numConsecutiveFailures%n.MAX_CONNECTION_FAILURES_BEFORE_WARN===0){var I="Ingestion endpoint could not be reached. This batch of telemetry items has been lost. Use Disk Retry Caching to enable resending of failed telemetry. Error:";p._enableDiskRetryMode&&(I="Ingestion endpoint could not be reached "+p._numConsecutiveFailures+" consecutive times. There may be resulting telemetry loss. Most recent error:"),p._logWarn(I,Kc.dumpObj(x))}else{var I="Transient failure to reach ingestion endpoint. This batch of telemetry items will be retried. Error:";p._logInfo(I,Kc.dumpObj(x))}p._onErrorHelper(x),typeof t=="function"&&(x?(p._requestTimedOut&&(x.name="telemetry timeout",x.message="telemetry request timed out"),t(Kc.dumpObj(x))):t("Error sending telemetry")),p._enableDiskRetryMode&&p._storeToDisk(e)}),_.write(g),_.end()}),f.label=5;case 5:return[2]}})})},n.prototype.saveOnCrash=function(e){this._enableDiskRetryMode&&this._storeToDiskSync(Kc.stringify(e))},n.prototype._isRetriable=function(e){return e===206||e===401||e===403||e===408||e===429||e===500||e===502||e===503||e===504},n.prototype._logInfo=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._isStatsbeatSender||J8e.info(n.TAG,e,t)},n.prototype._logWarn=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._isStatsbeatSender||J8e.warn(n.TAG,e,t)},n.prototype._statsbeatFailedToIngest=function(){this._shutdownStatsbeat&&(this._failedToIngestCounter++,this._failedToIngestCounter>=3&&this._shutdownStatsbeat())},n.prototype._storeToDisk=function(e){return UV(this,void 0,void 0,function(){var t,r,o,s,a,c,l;return BV(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),this._logInfo("Checking existence of data storage directory: "+this._tempDir),[4,yg.confirmDirExists(this._tempDir)];case 1:return u.sent(),[3,3];case 2:return t=u.sent(),this._logWarn("Failed to create folder to put telemetry: "+Kc.dumpObj(t)),this._onErrorHelper(t),[2];case 3:return u.trys.push([3,5,,6]),[4,pM.FileAccessControl.applyACLRules(this._tempDir)];case 4:return u.sent(),[3,6];case 5:return r=u.sent(),this._logWarn("Failed to apply file access control to folder: "+Kc.dumpObj(r)),this._onErrorHelper(r),[2];case 6:return u.trys.push([6,8,,9]),[4,yg.getShallowDirectorySize(this._tempDir)];case 7:return o=u.sent(),o>this._maxBytesOnDisk?(this._logWarn("Not saving data due to max size limit being met. Directory size in bytes is: "+o),[2]):[3,9];case 8:return s=u.sent(),this._logWarn("Failed to read directory for retriable telemetry: "+Kc.dumpObj(s)),this._onErrorHelper(s),[2];case 9:return u.trys.push([9,11,,12]),a=new Date().getTime()+".ai.json",c=uI.join(this._tempDir,a),this._logInfo("saving data to disk at: "+c),[4,yg.writeFileAsync(c,Kc.stringify(e),{mode:384})];case 10:return u.sent(),[3,12];case 11:return l=u.sent(),this._logWarn("Failed to persist telemetry to disk: "+Kc.dumpObj(l)),this._onErrorHelper(l),[2];case 12:return[2]}})})},n.prototype._storeToDiskSync=function(e){try{this._logInfo("Checking existence of data storage directory: "+this._tempDir),Wle.existsSync(this._tempDir)||Wle.mkdirSync(this._tempDir),pM.FileAccessControl.applyACLRulesSync(this._tempDir);var t=yg.getShallowDirectorySizeSync(this._tempDir);if(t>this._maxBytesOnDisk){this._logInfo("Not saving data due to max size limit being met. Directory size in bytes is: "+t);return}var r=new Date().getTime()+".ai.json",o=uI.join(this._tempDir,r);this._logInfo("saving data before crash to disk at: "+o),Wle.writeFileSync(o,e,{mode:384})}catch(s){this._logWarn("Error while saving data to disk: "+Kc.dumpObj(s)),this._onErrorHelper(s)}},n.prototype._sendFirstFileOnDisk=function(){return UV(this,void 0,void 0,function(){var e,t,r,o,s,a;return BV(this,function(c){switch(c.label){case 0:return c.trys.push([0,6,,7]),[4,yg.readdirAsync(this._tempDir)];case 1:return e=c.sent(),e=e.filter(function(l){return uI.basename(l).indexOf(".ai.json")>-1}),e.length>0?(t=e[0],r=uI.join(this._tempDir,t),[4,yg.readFileAsync(r)]):[3,5];case 2:return o=c.sent(),[4,yg.unlinkAsync(r)];case 3:return c.sent(),s=JSON.parse(o.toString()),[4,this.send(s)];case 4:c.sent(),c.label=5;case 5:return[3,7];case 6:return a=c.sent(),this._onErrorHelper(a),[3,7];case 7:return[2]}})})},n.prototype._onErrorHelper=function(e){typeof this._onError=="function"&&this._onError(e)},n.prototype._fileCleanupTask=function(){return UV(this,void 0,void 0,function(){var e,t,r,o,s,a,c=this;return BV(this,function(l){switch(l.label){case 0:return l.trys.push([0,6,,7]),[4,yg.readdirAsync(this._tempDir)];case 1:if(e=l.sent(),e=e.filter(function(u){return uI.basename(u).indexOf(".ai.json")>-1}),!(e.length>0))return[3,5];t=0,l.label=2;case 2:return t<e.length?(r=new Date(parseInt(e[t].split(".ai.json")[0])),o=new Date(+new Date-n.FILE_RETEMPTION_PERIOD)>r,o?(s=uI.join(this._tempDir,e[t]),[4,yg.unlinkAsync(s).catch(function(u){c._onErrorHelper(u)})]):[3,4]):[3,5];case 3:l.sent(),l.label=4;case 4:return t++,[3,2];case 5:return[3,7];case 6:return a=l.sent(),a.code!="ENOENT"&&this._onErrorHelper(a),[3,7];case 7:return[2]}})})},n.TAG="Sender",n.WAIT_BETWEEN_RESEND=60*1e3,n.MAX_BYTES_ON_DISK=50*1024*1024,n.MAX_CONNECTION_FAILURES_BEFORE_WARN=5,n.CLEANUP_TIMEOUT=60*60*1e3,n.FILE_RETEMPTION_PERIOD=7*24*60*60*1e3,n.TEMPDIR_PREFIX="appInsights-node",n.HTTP_TIMEOUT=2e4,n}();Z8e.exports=uEt});var t9e=P(qV=>{"use strict";Object.defineProperty(qV,"__esModule",{value:!0});qV.AzureVirtualMachine=void 0;var e9e=li(),dEt=ra(),pEt=rP(),fEt="http://169.254.169.254/metadata/instance/compute",mEt="api-version=2017-12-01",hEt="format=json",gEt="UNREACH",vEt=function(){function n(){}return n.getAzureComputeMetadata=function(e,t){var r,o=this,s={},a=fEt+"?"+mEt+"&"+hEt,c=(r={method:"GET"},r[pEt.disableCollectionRequestOption]=!0,r.headers={Metadata:"True"},r),l=dEt.makeRequest(e,a,c,function(u){if(u.statusCode===200){s.isVM=!0;var d="";u.on("data",function(p){d+=p}),u.on("end",function(){try{var p=JSON.parse(d);s.id=p.vmId||"",s.subscriptionId=p.subscriptionId||"",s.osType=p.osType||""}catch(f){e9e.info(n.TAG,f)}t(s)})}else t(s)},!1,!1);l&&(setTimeout(function(){o._requestTimedOut=!0,l.abort()},n.HTTP_TIMEOUT),l.on("error",function(u){o._requestTimedOut&&u&&(u.name="telemetry timeout",u.message="telemetry request timed out"),u&&u.message&&u.message.indexOf(gEt)>-1?s.isVM=!1:e9e.info(n.TAG,u),t(s)}),l.end())},n.HTTP_TIMEOUT=2500,n.TAG="AzureVirtualMachine",n}();qV.AzureVirtualMachine=vEt});var n9e=P(jV=>{"use strict";Object.defineProperty(jV,"__esModule",{value:!0});jV.NetworkStatsbeat=void 0;var yEt=function(){function n(e,t){this.endpoint=e,this.host=t,this.totalRequestCount=0,this.totalSuccesfulRequestCount=0,this.totalFailedRequestCount=[],this.retryCount=[],this.exceptionCount=[],this.throttleCount=[],this.intervalRequestExecutionTime=0,this.lastIntervalRequestExecutionTime=0,this.lastTime=+new Date,this.lastRequestCount=0}return n}();jV.NetworkStatsbeat=yEt});var a9e=P((dI,s9e)=>{"use strict";var dm=dI&&dI.__assign||function(){return dm=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o])}return n},dm.apply(this,arguments)},Yle=dI&&dI.__awaiter||function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function c(d){try{u(r.next(d))}catch(p){a(p)}}function l(d){try{u(r.throw(d))}catch(p){a(p)}}function u(d){d.done?s(d.value):o(d.value).then(c,l)}u((r=r.apply(n,e||[])).next())})},Qle=dI&&dI.__generator||function(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(d){return l([u,d])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,o=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(d){u=[6,d],o=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},bEt=require("os"),_Et=$le(),r9e=li(),xEt=Kle(),pi=Oi(),SEt=Ea(),IEt=t9e(),TEt=xce(),i9e=QR(),CEt=n9e(),o9e=ra(),EEt="node",wEt=function(){function n(e,t){this._attach=pi.StatsbeatAttach.sdk,this._feature=pi.StatsbeatFeature.NONE,this._instrumentation=pi.StatsbeatInstrumentation.NONE,this._isInitialized=!1,this._statbeatMetrics=[],this._networkStatsbeatCollection=[],this._config=e,this._context=t||new i9e;var r=this._getConnectionString(e);this._statsbeatConfig=new TEt(r),this._statsbeatConfig.samplingPercentage=100,this._sender=new xEt(this._statsbeatConfig,null,null,null,null,!0,this._shutdownStatsbeat.bind(this))}return n.prototype.enable=function(e){var t=this;this._isEnabled=e,this._isEnabled&&!this._isInitialized&&(this._getCustomProperties(),this._isInitialized=!0),e?(this._handle||(this._handle=setInterval(function(){t.trackShortIntervalStatsbeats()},n.STATS_COLLECTION_SHORT_INTERVAL),this._handle.unref()),this._longHandle||(this.trackLongIntervalStatsbeats(),this._longHandle=setInterval(function(){t.trackLongIntervalStatsbeats()},n.STATS_COLLECTION_LONG_INTERVAL),this._longHandle.unref())):(this._handle&&(clearInterval(this._handle),this._handle=null),this._longHandle&&(clearInterval(this._longHandle),this._longHandle=null))},n.prototype.isInitialized=function(){return this._isInitialized},n.prototype.isEnabled=function(){return this._isEnabled},n.prototype.setCodelessAttach=function(){this._attach=pi.StatsbeatAttach.codeless},n.prototype.addFeature=function(e){this._feature|=e},n.prototype.removeFeature=function(e){this._feature&=~e},n.prototype.addInstrumentation=function(e){this._instrumentation|=e},n.prototype.removeInstrumentation=function(e){this._instrumentation&=~e},n.prototype.countRequest=function(e,t,r,o,s){if(this.isEnabled()){var a=this._getNetworkStatsbeatCounter(e,t);if(a.totalRequestCount++,a.intervalRequestExecutionTime+=r,o===!1){if(!s)return;var c=a.totalFailedRequestCount.find(function(l){return s===l.statusCode});c?c.count++:a.totalFailedRequestCount.push({statusCode:s,count:1})}else a.totalSuccesfulRequestCount++}},n.prototype.countException=function(e,t,r){if(this.isEnabled()){var o=this._getNetworkStatsbeatCounter(e,t),s=o.exceptionCount.find(function(a){return r.name===a.exceptionType});s?s.count++:o.exceptionCount.push({exceptionType:r.name,count:1})}},n.prototype.countThrottle=function(e,t,r){if(this.isEnabled()){var o=this._getNetworkStatsbeatCounter(e,t),s=o.throttleCount.find(function(a){return r===a.statusCode});s?s.count++:o.throttleCount.push({statusCode:r,count:1})}},n.prototype.countRetry=function(e,t,r){if(this.isEnabled()){var o=this._getNetworkStatsbeatCounter(e,t),s=o.retryCount.find(function(a){return r===a.statusCode});s?s.count++:o.retryCount.push({statusCode:r,count:1})}},n.prototype.trackShortIntervalStatsbeats=function(){return Yle(this,void 0,void 0,function(){var e,t;return Qle(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,this._getResourceProvider()];case 1:return r.sent(),e={os:this._os,rp:this._resourceProvider,cikey:this._cikey,runtimeVersion:this._runtimeVersion,language:this._language,version:this._sdkVersion,attach:this._attach},this._trackRequestDuration(e),this._trackRequestsCount(e),[4,this._sendStatsbeats()];case 2:return r.sent(),[3,4];case 3:return t=r.sent(),r9e.info(n.TAG,"Failed to send Statsbeat metrics: "+o9e.dumpObj(t)),[3,4];case 4:return[2]}})})},n.prototype.trackLongIntervalStatsbeats=function(){return Yle(this,void 0,void 0,function(){var e,t,r,o,s;return Qle(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),[4,this._getResourceProvider()];case 1:return a.sent(),e={os:this._os,rp:this._resourceProvider,cikey:this._cikey,runtimeVersion:this._runtimeVersion,language:this._language,version:this._sdkVersion,attach:this._attach},t=Object.assign({rpId:this._resourceIdentifier},e),this._statbeatMetrics.push({name:pi.StatsbeatCounter.ATTACH,value:1,properties:t}),this._instrumentation!=pi.StatsbeatInstrumentation.NONE&&(r=Object.assign({feature:this._instrumentation,type:pi.StatsbeatFeatureType.Instrumentation},e),this._statbeatMetrics.push({name:pi.StatsbeatCounter.FEATURE,value:1,properties:r})),this._feature!=pi.StatsbeatFeature.NONE&&(o=Object.assign({feature:this._feature,type:pi.StatsbeatFeatureType.Feature},e),this._statbeatMetrics.push({name:pi.StatsbeatCounter.FEATURE,value:1,properties:o})),[4,this._sendStatsbeats()];case 2:return a.sent(),[3,4];case 3:return s=a.sent(),r9e.info(n.TAG,"Failed to send Statsbeat metrics: "+o9e.dumpObj(s)),[3,4];case 4:return[2]}})})},n.prototype._getNetworkStatsbeatCounter=function(e,t){for(var r=this._getShortHost(t),o=0;o<this._networkStatsbeatCollection.length;o++)if(e===this._networkStatsbeatCollection[o].endpoint&&r===this._networkStatsbeatCollection[o].host)return this._networkStatsbeatCollection[o];var s=new CEt.NetworkStatsbeat(e,r);return this._networkStatsbeatCollection.push(s),s},n.prototype._trackRequestDuration=function(e){for(var t=0;t<this._networkStatsbeatCollection.length;t++){var r=this._networkStatsbeatCollection[t];r.time=+new Date;var o=r.totalRequestCount-r.lastRequestCount||0,s=r.intervalRequestExecutionTime-r.lastIntervalRequestExecutionTime,a=s>0&&s/o||0;if(r.lastIntervalRequestExecutionTime=r.intervalRequestExecutionTime,o>0){var c=Object.assign({endpoint:this._networkStatsbeatCollection[t].endpoint,host:this._networkStatsbeatCollection[t].host},e);this._statbeatMetrics.push({name:pi.StatsbeatCounter.REQUEST_DURATION,value:a,properties:c})}r.lastRequestCount=r.totalRequestCount,r.lastTime=r.time}},n.prototype._getShortHost=function(e){var t=e;try{var r=new RegExp(/^https?:\/\/(?:www\.)?([^\/.-]+)/),o=r.exec(e);o!=null&&o.length>1&&(t=o[1]),t=t.replace(".in.applicationinsights.azure.com","")}catch{}return t},n.prototype._trackRequestsCount=function(e){for(var t=this,r=function(c){s=o._networkStatsbeatCollection[c];var l=Object.assign({endpoint:s.endpoint,host:s.host},e);s.totalSuccesfulRequestCount>0&&(o._statbeatMetrics.push({name:pi.StatsbeatCounter.REQUEST_SUCCESS,value:s.totalSuccesfulRequestCount,properties:l}),s.totalSuccesfulRequestCount=0),s.totalFailedRequestCount.length>0&&(s.totalFailedRequestCount.forEach(function(u){l=Object.assign(dm(dm({},l),{statusCode:u.statusCode})),t._statbeatMetrics.push({name:pi.StatsbeatCounter.REQUEST_FAILURE,value:u.count,properties:l})}),s.totalFailedRequestCount=[]),s.retryCount.length>0&&(s.retryCount.forEach(function(u){l=Object.assign(dm(dm({},l),{statusCode:u.statusCode})),t._statbeatMetrics.push({name:pi.StatsbeatCounter.RETRY_COUNT,value:u.count,properties:l})}),s.retryCount=[]),s.throttleCount.length>0&&(s.throttleCount.forEach(function(u){l=Object.assign(dm(dm({},l),{statusCode:u.statusCode})),t._statbeatMetrics.push({name:pi.StatsbeatCounter.THROTTLE_COUNT,value:u.count,properties:l})}),s.throttleCount=[]),s.exceptionCount.length>0&&(s.exceptionCount.forEach(function(u){l=Object.assign(dm(dm({},l),{exceptionType:u.exceptionType})),t._statbeatMetrics.push({name:pi.StatsbeatCounter.EXCEPTION_COUNT,value:u.count,properties:l})}),s.exceptionCount=[])},o=this,s,a=0;a<this._networkStatsbeatCollection.length;a++)r(a)},n.prototype._sendStatsbeats=function(){return Yle(this,void 0,void 0,function(){var e,t,r,o;return Qle(this,function(s){switch(s.label){case 0:for(e=[],t=0;t<this._statbeatMetrics.length;t++)r={name:this._statbeatMetrics[t].name,value:this._statbeatMetrics[t].value,properties:this._statbeatMetrics[t].properties},o=_Et.createEnvelope(r,SEt.TelemetryType.Metric,null,this._context,this._statsbeatConfig),o.name=pi.StatsbeatTelemetryName,e.push(o);return this._statbeatMetrics=[],[4,this._sender.send(e)];case 1:return s.sent(),[2]}})})},n.prototype._getCustomProperties=function(){this._language=EEt,this._cikey=this._config.instrumentationKey,this._sdkVersion=i9e.sdkVersion,this._os=bEt.type(),this._runtimeVersion=process.version},n.prototype._getResourceProvider=function(){var e=this;return new Promise(function(t,r){var o=!1;e._resourceProvider=pi.StatsbeatResourceProvider.unknown,e._resourceIdentifier=pi.StatsbeatResourceProvider.unknown,process.env.AKS_ARM_NAMESPACE_ID?(e._resourceProvider=pi.StatsbeatResourceProvider.aks,e._resourceIdentifier=process.env.AKS_ARM_NAMESPACE_ID):process.env.WEBSITE_SITE_NAME?(e._resourceProvider=pi.StatsbeatResourceProvider.appsvc,e._resourceIdentifier=process.env.WEBSITE_SITE_NAME,process.env.WEBSITE_HOME_STAMPNAME&&(e._resourceIdentifier+="/"+process.env.WEBSITE_HOME_STAMPNAME)):process.env.FUNCTIONS_WORKER_RUNTIME?(e._resourceProvider=pi.StatsbeatResourceProvider.functions,process.env.WEBSITE_HOSTNAME&&(e._resourceIdentifier=process.env.WEBSITE_HOSTNAME)):e._config&&(e._isVM===void 0||e._isVM==!0?(o=!0,IEt.AzureVirtualMachine.getAzureComputeMetadata(e._config,function(s){e._isVM=s.isVM,e._isVM&&(e._resourceProvider=pi.StatsbeatResourceProvider.vm,e._resourceIdentifier=s.id+"/"+s.subscriptionId,s.osType&&(e._os=s.osType)),t()})):e._resourceProvider=pi.StatsbeatResourceProvider.unknown),o||t()})},n.prototype._shutdownStatsbeat=function(){this.enable(!1)},n.prototype._getConnectionString=function(e){for(var t=e.endpointUrl,r=["westeurope","northeurope","francecentral","francesouth","germanywestcentral","norwayeast","norwaywest","swedencentral","switzerlandnorth","switzerlandwest","uksouth","ukwest"],o=0;o<r.length;o++)if(t.indexOf(r[o])>-1)return n.EU_CONNECTION_STRING;return n.NON_EU_CONNECTION_STRING},n.NON_EU_CONNECTION_STRING="InstrumentationKey=c4a29126-a7cb-47e5-b348-11414998b11e;IngestionEndpoint=https://westus-0.in.applicationinsights.azure.com",n.EU_CONNECTION_STRING="InstrumentationKey=7dc56bab-3c0c-4e9f-9ebb-d1acadee8d0f;IngestionEndpoint=https://westeurope-5.in.applicationinsights.azure.com",n.STATS_COLLECTION_SHORT_INTERVAL=9e5,n.STATS_COLLECTION_LONG_INTERVAL=864e5,n.TAG="Statsbeat",n}();s9e.exports=wEt});var u9e=P((Ecr,l9e)=>{"use strict";var kEt=require("url"),REt=xce(),PEt=U8e(),AEt=QR(),bg=Ea(),DEt=q8e(),Xle=W8e(),c9e=ob(),NEt=a9e(),LEt=Kle(),Jle=ra(),HV=li(),OEt=$le(),MEt=function(){function n(e){this._telemetryProcessors=[];var t=new REt(e);if(this.config=t,!this.config.instrumentationKey||this.config.instrumentationKey=="")throw new Error("Instrumentation key not found, please provide a connection string before starting Application Insights SDK.");this.context=new AEt,this.commonProperties={},this.authorizationHandler=null,this.config.disableStatsbeat||(this._statsbeat=new NEt(this.config,this.context),this._statsbeat.enable(!0));var r=new LEt(this.config,this.getAuthorizationHandler,null,null,this._statsbeat);this.channel=new DEt(function(){return t.disableAppInsights},function(){return t.maxBatchSize},function(){return t.maxBatchIntervalMs},r)}return n.prototype.trackAvailability=function(e){this.track(e,bg.TelemetryType.Availability)},n.prototype.trackPageView=function(e){this.track(e,bg.TelemetryType.PageView)},n.prototype.trackTrace=function(e){this.track(e,bg.TelemetryType.Trace)},n.prototype.trackMetric=function(e){this.track(e,bg.TelemetryType.Metric)},n.prototype.trackException=function(e){e&&e.exception&&!Jle.isError(e.exception)&&(e.exception=new Error(e.exception.toString())),this.track(e,bg.TelemetryType.Exception)},n.prototype.trackEvent=function(e){this.track(e,bg.TelemetryType.Event)},n.prototype.trackRequest=function(e){this.track(e,bg.TelemetryType.Request)},n.prototype.trackDependency=function(e){if(e&&!e.target&&e.data)try{e.target=new kEt.URL(e.data).host}catch(t){e.target=null,HV.warn(n.TAG,"The URL object is failed to create.",t)}this.track(e,bg.TelemetryType.Dependency)},n.prototype.flush=function(e){this.channel.triggerSend(e?!!e.isAppCrashing:!1,e?e.callback:void 0)},n.prototype.track=function(e,t){if(e&&bg.telemetryTypeToBaseType(t)){var r=OEt.createEnvelope(e,t,this.commonProperties,this.context,this.config);e.time&&(r.time=e.time.toISOString());var o=this.runTelemetryProcessors(r,e.contextObjects);o=o&&Xle.samplingTelemetryProcessor(r,{correlationContext:c9e.CorrelationContextManager.getCurrentContext()}),Xle.preAggregatedMetricsTelemetryProcessor(r,this.context),o&&(Xle.performanceMetricsTelemetryProcessor(r,this.quickPulseClient),this.channel.send(r))}else HV.warn(n.TAG,"track() requires telemetry object and telemetryType to be specified.")},n.prototype.setAutoPopulateAzureProperties=function(e){},n.prototype.getAuthorizationHandler=function(e){return e&&e.aadTokenCredential?(this.authorizationHandler||(HV.info(n.TAG,"Adding authorization handler"),this.authorizationHandler=new PEt(e.aadTokenCredential,e.aadAudience)),this.authorizationHandler):null},n.prototype.addTelemetryProcessor=function(e){this._telemetryProcessors.push(e)},n.prototype.clearTelemetryProcessors=function(){this._telemetryProcessors=[]},n.prototype.runTelemetryProcessors=function(e,t){var r=!0,o=this._telemetryProcessors.length;if(o===0)return r;t=t||{},t.correlationContext=c9e.CorrelationContextManager.getCurrentContext();for(var s=0;s<o;++s)try{var a=this._telemetryProcessors[s];if(a&&a.apply(null,[e,t])===!1){r=!1;break}}catch(c){r=!0,HV.warn(n.TAG,"One of telemetry processors failed, telemetry item will be sent.",c,e)}return r&&(e&&e.tags&&(e.tags=Jle.validateStringMap(e.tags)),e&&e.data&&e.data.baseData&&e.data.baseData.properties&&(e.data.baseData.properties=Jle.validateStringMap(e.data.baseData.properties))),r},n.prototype.getStatsbeat=function(){return this._statsbeat},n.TAG="TelemetryClient",n}();l9e.exports=MEt});var f9e=P((Zle,p9e)=>{"use strict";var FEt=Zle&&Zle.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),UEt=u9e(),d9e=mce(),BEt=rP(),VV=li(),qEt=function(n){FEt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.trackNodeHttpRequestSync=function(t){t&&t.request&&t.response&&t.duration?d9e.trackRequestSync(this,t):VV.warn("trackNodeHttpRequestSync requires NodeHttpRequestTelemetry object with request, response and duration specified.")},e.prototype.trackNodeHttpRequest=function(t){(t.duration||t.error)&&VV.warn("trackNodeHttpRequest will ignore supplied duration and error parameters. These values are collected from the request and response objects."),t&&t.request&&t.response?d9e.trackRequest(this,t):VV.warn("trackNodeHttpRequest requires NodeHttpRequestTelemetry object with request and response specified.")},e.prototype.trackNodeHttpDependency=function(t){t&&t.request?BEt.trackRequest(this,t):VV.warn("trackNodeHttpDependency requires NodeHttpDependencyTelemetry object with request specified.")},e}(UEt);p9e.exports=qEt});var h9e=P(m9e=>{"use strict";Object.defineProperty(m9e,"__esModule",{value:!0})});var _9e=P(ce=>{"use strict";Object.defineProperty(ce,"__esModule",{value:!0});ce.dispose=ce.Configuration=ce.wrapWithCorrelationContext=ce.startOperation=ce.getCorrelationContext=ce.start=ce.setup=ce.liveMetricsClient=ce.defaultClient=ce.DistributedTracingModes=void 0;var eue=ob(),jEt=oFe(),HEt=aFe(),tue=FH(),VEt=ece(),GEt=hFe(),zEt=wFe(),$Et=rP(),WEt=mce(),g9e=zS(),mM=li(),v9e=s5e(),nue=a5e(),KEt=u5e();ce.TelemetryClient=f9e();ce.Contracts=Ea();ce.azureFunctionsTypes=h9e();var y9e;(function(n){n[n.AI=0]="AI",n[n.AI_AND_W3C=1]="AI_AND_W3C"})(y9e=ce.DistributedTracingModes||(ce.DistributedTracingModes={}));var hM,gM,vM,yM,bM,IP,TP,pI,_M,xM,Ul=!1,GV;function YEt(n){return ce.defaultClient?mM.info("The default client is already setup"):(ce.defaultClient=new ce.TelemetryClient(n),hM=new jEt(ce.defaultClient),gM=new HEt(ce.defaultClient),vM=new tue(ce.defaultClient),yM=new VEt(ce.defaultClient),bM=new GEt(ce.defaultClient),IP=new zEt(ce.defaultClient),pI=new WEt(ce.defaultClient),_M=new $Et(ce.defaultClient),TP||(TP=new nue.AutoCollectNativePerformance(ce.defaultClient)),xM=new KEt.AzureFunctionsHook(ce.defaultClient)),rue}ce.setup=YEt;function QEt(){ce.defaultClient&&(ce.defaultClient.config.enableAutoCollectExternalLoggers==null&&(ce.defaultClient.config.enableAutoCollectExternalLoggers=!0),ce.defaultClient.config.enableAutoCollectConsole==null&&(ce.defaultClient.config.enableAutoCollectConsole=!1),ce.defaultClient.config.enableAutoCollectExceptions==null&&(ce.defaultClient.config.enableAutoCollectExceptions=!0),ce.defaultClient.config.enableAutoCollectPerformance==null&&(ce.defaultClient.config.enableAutoCollectPerformance=!0),ce.defaultClient.config.enableAutoCollectPreAggregatedMetrics==null&&(ce.defaultClient.config.enableAutoCollectPreAggregatedMetrics=!0),ce.defaultClient.config.enableAutoCollectHeartbeat==null&&(ce.defaultClient.config.enableAutoCollectHeartbeat=!0),ce.defaultClient.config.enableAutoCollectRequests==null&&(ce.defaultClient.config.enableAutoCollectRequests=!0),ce.defaultClient.config.enableAutoCollectDependencies==null&&(ce.defaultClient.config.enableAutoCollectDependencies=!0),ce.defaultClient.config.enableUseDiskRetryCaching==null&&(ce.defaultClient.config.enableUseDiskRetryCaching=!0),ce.defaultClient.config.enableAutoDependencyCorrelation==null&&(ce.defaultClient.config.enableAutoDependencyCorrelation=!0),ce.defaultClient.config.enableSendLiveMetrics==null&&(ce.defaultClient.config.enableSendLiveMetrics=!1),ce.defaultClient.config.enableAutoCollectExtendedMetrics==null&&(ce.defaultClient.config.enableAutoCollectExtendedMetrics=!0),ce.defaultClient.config.enableWebInstrumentation==null&&(ce.defaultClient.config.enableWebInstrumentation=!1),ce.defaultClient.config.enableAutoCollectIncomingRequestAzureFunctions==null&&(ce.defaultClient.config.enableAutoCollectIncomingRequestAzureFunctions=!1))}function b9e(){if(ce.defaultClient){Ul=!0,QEt(),hM.enable(ce.defaultClient.config.enableAutoCollectExternalLoggers,ce.defaultClient.config.enableAutoCollectConsole),gM.enable(ce.defaultClient.config.enableAutoCollectExceptions),vM.enable(ce.defaultClient.config.enableAutoCollectPerformance),yM.enable(ce.defaultClient.config.enableAutoCollectPreAggregatedMetrics),bM.enable(ce.defaultClient.config.enableAutoCollectHeartbeat),pI.useAutoCorrelation(ce.defaultClient.config.enableAutoDependencyCorrelation,ce.defaultClient.config.enableUseAsyncHooks),pI.enable(ce.defaultClient.config.enableAutoCollectRequests),_M.enable(ce.defaultClient.config.enableAutoCollectDependencies),IP.enable(ce.defaultClient.config.enableWebInstrumentation,ce.defaultClient.config.webInstrumentationConnectionString),ce.defaultClient.config.enableSendLiveMetrics&&(ce.liveMetricsClient||(ce.liveMetricsClient=new v9e(ce.defaultClient.config,ce.defaultClient.context,ce.defaultClient.getAuthorizationHandler),GV=new tue(ce.liveMetricsClient,1e3,!0),ce.liveMetricsClient.addCollector(GV),ce.defaultClient.quickPulseClient=ce.liveMetricsClient),ce.liveMetricsClient.enable(ce.defaultClient.config.enableSendLiveMetrics)),xM.enable(ce.defaultClient.config.enableAutoCollectIncomingRequestAzureFunctions);var n=nue.AutoCollectNativePerformance.parseEnabled(ce.defaultClient.config.enableAutoCollectExtendedMetrics,ce.defaultClient.config);TP.enable(ce.defaultClient.config.enableAutoCollectExtendedMetrics,n.disabledMetrics),ce.defaultClient&&ce.defaultClient.channel&&ce.defaultClient.channel.setUseDiskRetryCaching(ce.defaultClient.config.enableUseDiskRetryCaching,ce.defaultClient.config.enableResendInterval,ce.defaultClient.config.enableMaxBytesOnDisk)}else mM.warn("Start cannot be called before setup");return rue}ce.start=b9e;function XEt(){return eue.CorrelationContextManager.getCurrentContext()}ce.getCorrelationContext=XEt;function JEt(n,e){return eue.CorrelationContextManager.startOperation(n,e)}ce.startOperation=JEt;function ZEt(n,e){return eue.CorrelationContextManager.wrapCallback(n,e)}ce.wrapWithCorrelationContext=ZEt;var rue=function(){function n(){}return n.setDistributedTracingMode=function(e){return g9e.w3cEnabled=e===y9e.AI_AND_W3C,n},n.setAutoCollectConsole=function(e,t){return t===void 0&&(t=!1),ce.defaultClient&&(ce.defaultClient.config.enableAutoCollectExternalLoggers=e,ce.defaultClient.config.enableAutoCollectConsole=t,Ul&&hM.enable(e,t)),n},n.setAutoCollectExceptions=function(e){return ce.defaultClient&&(ce.defaultClient.config.enableAutoCollectExceptions=e,Ul&&gM.enable(e)),n},n.setAutoCollectPerformance=function(e,t){if(t===void 0&&(t=!0),ce.defaultClient){ce.defaultClient.config.enableAutoCollectPerformance=e;var r=nue.AutoCollectNativePerformance.parseEnabled(t,ce.defaultClient.config);ce.defaultClient.config.enableAutoCollectExtendedMetrics=r.isEnabled,Ul&&(vM.enable(e),TP.enable(ce.defaultClient.config.enableAutoCollectExtendedMetrics,r.disabledMetrics))}return n},n.setAutoCollectPreAggregatedMetrics=function(e){return ce.defaultClient&&(ce.defaultClient.config.enableAutoCollectPreAggregatedMetrics=e,Ul&&yM.enable(e)),n},n.setAutoCollectHeartbeat=function(e){return ce.defaultClient&&(ce.defaultClient.config.enableAutoCollectHeartbeat=e,Ul&&bM.enable(e)),n},n.enableAutoWebSnippetInjection=function(e,t){return ce.defaultClient&&(ce.defaultClient.config.enableWebInstrumentation=e,ce.defaultClient.config.webInstrumentationConnectionString=t,Ul&&IP.enable(ce.defaultClient.config.enableAutoWebSnippetInjection,ce.defaultClient.config.webSnippetConnectionString)),n},n.enableWebInstrumentation=function(e,t){return ce.defaultClient&&(ce.defaultClient.config.enableWebInstrumentation=e,ce.defaultClient.config.webInstrumentationConnectionString=t,Ul&&IP.enable(ce.defaultClient.config.enableWebInstrumentation,ce.defaultClient.config.webInstrumentationConnectionString)),n},n.setAutoCollectRequests=function(e){return ce.defaultClient&&(ce.defaultClient.config.enableAutoCollectRequests=e,Ul&&pI.enable(e)),n},n.setAutoCollectDependencies=function(e){return ce.defaultClient&&(ce.defaultClient.config.enableAutoCollectDependencies=e,Ul&&_M.enable(e)),n},n.setAutoDependencyCorrelation=function(e,t){return ce.defaultClient&&(ce.defaultClient.config.enableAutoDependencyCorrelation=e,ce.defaultClient.config.enableUseAsyncHooks=t,Ul&&pI.useAutoCorrelation(e,t)),n},n.setUseDiskRetryCaching=function(e,t,r){return ce.defaultClient&&(ce.defaultClient.config.enableUseDiskRetryCaching=e,ce.defaultClient.config.enableResendInterval=t,ce.defaultClient.config.enableMaxBytesOnDisk=r,ce.defaultClient.channel&&ce.defaultClient.channel.setUseDiskRetryCaching(ce.defaultClient.config.enableUseDiskRetryCaching,ce.defaultClient.config.enableResendInterval,ce.defaultClient.config.enableMaxBytesOnDisk)),n},n.setInternalLogging=function(e,t){return e===void 0&&(e=!1),t===void 0&&(t=!0),mM.enableDebug=e,mM.disableWarnings=!t,n},n.setAutoCollectIncomingRequestAzureFunctions=function(e){return ce.defaultClient&&(ce.defaultClient.config.enableAutoCollectIncomingRequestAzureFunctions=e,Ul&&xM.enable(e)),n},n.setSendLiveMetrics=function(e){return e===void 0&&(e=!1),ce.defaultClient?(!ce.liveMetricsClient&&e?(ce.liveMetricsClient=new v9e(ce.defaultClient.config,ce.defaultClient.context,ce.defaultClient.getAuthorizationHandler),GV=new tue(ce.liveMetricsClient,1e3,!0),ce.liveMetricsClient.addCollector(GV),ce.defaultClient.quickPulseClient=ce.liveMetricsClient):ce.liveMetricsClient&&ce.liveMetricsClient.enable(e),ce.defaultClient.config.enableSendLiveMetrics=e,n):(mM.warn("Live metrics client cannot be setup without the default client"),n)},n.start=b9e,n}();ce.Configuration=rue;function ewt(){g9e.w3cEnabled=!0,ce.defaultClient=null,Ul=!1,hM&&hM.dispose(),gM&&gM.dispose(),vM&&vM.dispose(),yM&&yM.dispose(),bM&&bM.dispose(),IP&&IP.dispose(),TP&&TP.dispose(),pI&&pI.dispose(),_M&&_M.dispose(),ce.liveMetricsClient&&(ce.liveMetricsClient.enable(!1),ce.liveMetricsClient=void 0),xM&&xM.dispose()}ce.dispose=ewt});var oue=P(xb=>{"use strict";Object.defineProperty(xb,"__esModule",{value:!0});xb.TargetPopulation=xb.Filters=xb.VSCodeFilterProvider=void 0;var $V=require("vscode"),iue=class n{constructor(e,t,r){this.extensionName=e,this.extensionVersion=t,this.targetPopulation=r}static trimVersionSuffix(e){let t=/\-[a-zA-Z0-9]+$/;return e.split(t)[0]}getFilterValue(e){switch(e){case pm.ApplicationVersion:return n.trimVersionSuffix($V.version);case pm.Build:return $V.env.appName;case pm.ClientId:return $V.env.machineId;case pm.ExtensionName:return this.extensionName;case pm.ExtensionVersion:return n.trimVersionSuffix(this.extensionVersion);case pm.Language:return $V.env.language;case pm.TargetPopulation:return this.targetPopulation;default:return""}}getFilters(){let e=new Map,t=Object.values(pm);for(let r of t)e.set(r,this.getFilterValue(r));return e}};xb.VSCodeFilterProvider=iue;var pm;(function(n){n.Market="X-MSEdge-Market",n.CorpNet="X-FD-Corpnet",n.ApplicationVersion="X-VSCode-AppVersion",n.Build="X-VSCode-Build",n.ClientId="X-MSEdge-ClientId",n.ExtensionName="X-VSCode-ExtensionName",n.ExtensionVersion="X-VSCode-ExtensionVersion",n.Language="X-VSCode-Language",n.TargetPopulation="X-VSCode-TargetPopulation"})(pm||(xb.Filters=pm={}));var C9e;(function(n){n.Team="team",n.Internal="internal",n.Insiders="insider",n.Public="public"})(C9e||(xb.TargetPopulation=C9e={}))});var E9e=P(WV=>{"use strict";Object.defineProperty(WV,"__esModule",{value:!0});WV.BaseFeatureProvider=void 0;var sue=class{constructor(e){this.telemetry=e,this.isFetching=!1}async getFeatures(){if(this.isFetching&&this.fetchPromise)return this.fetchPromise;this.fetchPromise=this.fetch();let e=await this.fetchPromise;return this.isFetching=!1,this.fetchPromise=void 0,e}};WV.BaseFeatureProvider=sue});var w9e=P(KV=>{"use strict";Object.defineProperty(KV,"__esModule",{value:!0});KV.FilteredFeatureProvider=void 0;var rwt=E9e(),aue=class extends rwt.BaseFeatureProvider{constructor(e,t){super(e),this.telemetry=e,this.filterProviders=t,this.cachedTelemetryEvents=[]}getFilters(){let e=new Map;for(let t of this.filterProviders){let r=t.getFilters();for(let o of r.keys()){let s=r.get(o);e.set(o,s)}}return e}PostEventToTelemetry(e){if(this.cachedTelemetryEvents.includes(e))return;let t=JSON.stringify(e);this.telemetry.postEvent("report-headers",new Map([["ABExp.headers",t]])),this.cachedTelemetryEvents.push(e)}};KV.FilteredFeatureProvider=aue});var k9e=P(Sb=>{"use strict";Object.defineProperty(Sb,"__esModule",{value:!0});Sb.TasApiFeatureProvider=Sb.TASAPI_FETCHERROR_EVENTNAME=void 0;var iwt=w9e();Sb.TASAPI_FETCHERROR_EVENTNAME="call-tas-error";var cue="ErrorType",lue=class extends iwt.FilteredFeatureProvider{constructor(e,t,r){super(t,r),this.httpClient=e,this.telemetry=t,this.filterProviders=r}async fetch(){let e=this.getFilters(),t={};for(let c of e.keys()){let l=e.get(c);t[c]=l}let r;try{r=await this.httpClient.get({headers:t})}catch(c){let l=c,u=new Map;l.responseReceived&&!l.responseOk?u.set(cue,"ServerError"):l.responseReceived===!1?u.set(cue,"NoResponse"):u.set(cue,"GenericError"),this.telemetry.postEvent(Sb.TASAPI_FETCHERROR_EVENTNAME,u)}if(!r)throw Error(Sb.TASAPI_FETCHERROR_EVENTNAME);e.keys.length>0&&this.PostEventToTelemetry(t);let o=r.data,s=o.Configs,a=[];for(let c of s)if(c.Parameters)for(let l of Object.keys(c.Parameters)){let u=l+(c.Parameters[l]?"":"cf");a.includes(u)||a.push(u)}return{features:a,assignmentContext:o.AssignmentContext,configs:s}}};Sb.TasApiFeatureProvider=lue});var R9e=P(wP=>{"use strict";Object.defineProperty(wP,"__esModule",{value:!0});wP.HttpClient=wP.FetchError=void 0;var EP=class extends Error{constructor(e,t,r){super(e),this.responseReceived=t,this.responseOk=r}};wP.FetchError=EP;var uue=class{constructor(e){this.endpoint=e}async get(e){let t=await fetch(this.endpoint,{method:"GET",headers:e?.headers});if(!t)throw new EP("No response received",!1);if(!t.ok)throw new EP("Response not ok",!0,!1);let r=await t.json();if(!r)throw new EP("No data received",!1);return{data:r}}};wP.HttpClient=uue});var P9e=P(YV=>{"use strict";Object.defineProperty(YV,"__esModule",{value:!0});YV.MemoryKeyValueStorage=void 0;var due=class{constructor(){this.storage=new Map}async getValue(e,t){return this.storage.has(e)?await Promise.resolve(this.storage.get(e)):await Promise.resolve(t||void 0)}setValue(e,t){this.storage.set(e,t)}};YV.MemoryKeyValueStorage=due});var A9e=P(QV=>{"use strict";Object.defineProperty(QV,"__esModule",{value:!0});QV.ExperimentationServiceBase=void 0;var owt=P9e(),pue=class{get features(){return this._features}set features(e){this._features=e,this.telemetry&&this.telemetry.setSharedProperty(this.assignmentContextTelemetryPropertyName,this.features.assignmentContext)}constructor(e,t,r,o,s){this.telemetry=e,this.assignmentContextTelemetryPropertyName=t,this.telemetryEventName=r,this.storageKey=o,this.storage=s,this.featuresConsumed=!1,this.cachedTelemetryEvents=[],this._features={features:[],assignmentContext:"",configs:[]},this.storageKey||(this.storageKey="ABExp.Features"),this.storage||(s=new owt.MemoryKeyValueStorage),this.loadCachePromise=this.loadCachedFeatureData(),this.initializePromise=this.loadCachePromise,this.initialFetch=new Promise((a,c)=>{this.resolveInitialFetchPromise=a})}async getFeaturesAsync(e=!1){if(this.fetchPromise!=null){try{await this.fetchPromise}catch{}return this.features}if(!this.featureProviders||this.featureProviders.length===0)return Promise.resolve({features:[],assignmentContext:"",configs:[]});try{this.fetchPromise=Promise.all(this.featureProviders.map(async r=>await r.getFeatures()));let t=await this.fetchPromise;this.updateFeatures(t,e)}catch{}return this.fetchPromise=void 0,this.resolveInitialFetchPromise&&(this.resolveInitialFetchPromise(),this.resolveInitialFetchPromise=void 0),this.features}updateFeatures(e,t=!1){let r={features:[],assignmentContext:"",configs:[]};for(let o of e){for(let s of o.features)r.features.includes(s)||r.features.push(s);for(let s of o.configs){let a=r.configs.find(c=>c.Id===s.Id);a?a.Parameters=Object.assign(Object.assign({},a.Parameters),s.Parameters):r.configs.push(s)}r.assignmentContext+=o.assignmentContext}(t||!this.featuresConsumed)&&(this.features=r),this.storage&&this.storage.setValue(this.storageKey,r)}async loadCachedFeatureData(){let e;this.storage&&(e=await this.storage.getValue(this.storageKey),e!==void 0&&e.configs===void 0&&(e.configs=[])),this.features.features.length===0&&(this.features=e||{features:[],assignmentContext:"",configs:[]})}isFlightEnabled(e){return this.featuresConsumed=!0,this.PostEventToTelemetry(e),this.features.features.includes(e)}async isCachedFlightEnabled(e){return await this.loadCachePromise,this.featuresConsumed=!0,this.PostEventToTelemetry(e),this.features.features.includes(e)}async isFlightEnabledAsync(e){let t=await this.getFeaturesAsync(!0);return this.featuresConsumed=!0,this.PostEventToTelemetry(e),t.features.includes(e)}getTreatmentVariable(e,t){this.featuresConsumed=!0,this.PostEventToTelemetry(`${e}.${t}`);let r=this.features.configs.find(o=>o.Id===e);return r?.Parameters[t]}async getTreatmentVariableAsync(e,t,r){if(r){let o=this.featuresConsumed,s=this.getTreatmentVariable(e,t);if(s===void 0)this.featuresConsumed=o;else return s}return await this.getFeaturesAsync(!0),this.getTreatmentVariable(e,t)}PostEventToTelemetry(e){this.cachedTelemetryEvents.includes(e)||(this.telemetry.postEvent(this.telemetryEventName,new Map([["ABExp.queriedFeature",e]])),this.cachedTelemetryEvents.push(e))}invokeInit(){this.init()}addFeatureProvider(...e){if(!(e==null||this.featureProviders==null))for(let t of e)this.featureProviders.push(t)}};QV.ExperimentationServiceBase=pue});var D9e=P(XV=>{"use strict";Object.defineProperty(XV,"__esModule",{value:!0});XV.PollingService=void 0;var fue=class{constructor(e){this.fetchInterval=e}StopPolling(){clearInterval(this.intervalHandle),this.intervalHandle=void 0}OnPollTick(e){this.onTick=e}StartPolling(e=!1){this.intervalHandle&&this.StopPolling(),this.onTick!=null&&(e&&this.onTick().then(()=>{}).catch(()=>{}),this.intervalHandle=setInterval(async()=>{await this.onTick()},this.fetchInterval),this.intervalHandle.unref&&this.intervalHandle.unref())}};XV.PollingService=fue});var N9e=P(JV=>{"use strict";Object.defineProperty(JV,"__esModule",{value:!0});JV.ExperimentationServiceAutoPolling=void 0;var swt=A9e(),awt=D9e(),mue=class extends swt.ExperimentationServiceBase{constructor(e,t,r,o,s,a,c){if(super(e,o,s,a,c),this.telemetry=e,this.filterProviders=t,this.refreshRateMs=r,this.assignmentContextTelemetryPropertyName=o,this.telemetryEventName=s,this.storageKey=a,this.storage=c,r<1e3&&r!==0)throw new Error("The minimum refresh rate for polling is 1000 ms (1 second). If you wish to deactivate this auto-polling use value of 0.");r>0&&(this.pollingService=new awt.PollingService(r),this.pollingService.OnPollTick(async()=>{await super.getFeaturesAsync()}))}init(){this.pollingService?this.pollingService.StartPolling(!0):super.getFeaturesAsync()}async getFeaturesAsync(e=!1){if(this.pollingService){this.pollingService.StopPolling();let t=await super.getFeaturesAsync(e);return this.pollingService.StartPolling(),t}else return await super.getFeaturesAsync(e)}};JV.ExperimentationServiceAutoPolling=mue});var L9e=P(eG=>{"use strict";Object.defineProperty(eG,"__esModule",{value:!0});eG.ExperimentationService=void 0;var cwt=k9e(),lwt=R9e(),uwt=N9e(),ZV=class extends uwt.ExperimentationServiceAutoPolling{constructor(e){super(e.telemetry,e.filterProviders||[],e.refetchInterval!=null?e.refetchInterval:0,e.assignmentContextTelemetryPropertyName,e.telemetryEventName,e.storageKey,e.keyValueStorage),this.options=e,this.invokeInit()}init(){this.featureProviders=[],this.addFeatureProvider(new cwt.TasApiFeatureProvider(new lwt.HttpClient(this.options.endpoint),this.telemetry,this.filterProviders)),super.init()}};eG.ExperimentationService=ZV;ZV.REFRESH_RATE_IN_MINUTES=30});var O9e=P(tG=>{"use strict";Object.defineProperty(tG,"__esModule",{value:!0});tG.ExperimentationService=void 0;var dwt=L9e();Object.defineProperty(tG,"ExperimentationService",{enumerable:!0,get:function(){return dwt.ExperimentationService}})});var M9e=P(nG=>{"use strict";Object.defineProperty(nG,"__esModule",{value:!0});nG.MementoKeyValueStorage=void 0;var hue=class{constructor(e){this.mementoGlobalStorage=e}async getValue(e,t){return await this.mementoGlobalStorage.get(e)||t}setValue(e,t){this.mementoGlobalStorage.update(e,t)}};nG.MementoKeyValueStorage=hue});var F9e=P(vue=>{"use strict";Object.defineProperty(vue,"__esModule",{value:!0});var gue=class{constructor(){this.initializePromise=Promise.resolve(),this.initialFetch=Promise.resolve()}isFlightEnabled(e){return!1}isCachedFlightEnabled(e){return Promise.resolve(!1)}isFlightEnabledAsync(e){return Promise.resolve(!1)}getTreatmentVariable(e,t){}getTreatmentVariableAsync(e,t){return Promise.resolve(void 0)}};vue.default=gue});var B9e=P(kP=>{"use strict";Object.defineProperty(kP,"__esModule",{value:!0});kP.getExperimentationServiceAsync=kP.getExperimentationService=void 0;var pwt=oue(),fwt=O9e(),yue=require("vscode"),mwt=M9e(),hwt=F9e(),gwt="https://default.exp-tas.com/vscode/ab",vwt="query-expfeature",ywt="abexp.assignmentcontext",bwt="VSCode.ABExp.FeatureData",_wt=1e3*60*30;function U9e(n,e,t,r,o,...s){if(!o)throw new Error("Memento storage was not provided.");let a=yue.workspace.getConfiguration("telemetry");if(!(yue.env.isTelemetryEnabled===void 0?a.get("enableTelemetry",!0):yue.env.isTelemetryEnabled))return new hwt.default;let u=[new pwt.VSCodeFilterProvider(n,e,t),...s],d=new mwt.MementoKeyValueStorage(o);return new fwt.ExperimentationService({filterProviders:u,telemetry:r,storageKey:bwt,keyValueStorage:d,featuresTelemetryPropertyName:"",assignmentContextTelemetryPropertyName:ywt,telemetryEventName:vwt,endpoint:gwt,refetchInterval:_wt})}kP.getExperimentationService=U9e;async function xwt(n,e,t,r,o,...s){let a=U9e(n,e,t,r,o,...s);return await a.initializePromise,a}kP.getExperimentationServiceAsync=xwt});var j9e=P(Ib=>{"use strict";Object.defineProperty(Ib,"__esModule",{value:!0});Ib.TargetPopulation=Ib.getExperimentationServiceAsync=Ib.getExperimentationService=void 0;var q9e=B9e();Object.defineProperty(Ib,"getExperimentationService",{enumerable:!0,get:function(){return q9e.getExperimentationService}});Object.defineProperty(Ib,"getExperimentationServiceAsync",{enumerable:!0,get:function(){return q9e.getExperimentationServiceAsync}});var Swt=oue();Object.defineProperty(Ib,"TargetPopulation",{enumerable:!0,get:function(){return Swt.TargetPopulation}})});var V9e=P(sG=>{"use strict";Object.defineProperty(sG,"__esModule",{value:!0});sG.BaseTelemetryReporter=void 0;var _ue=class{constructor(e,t,r){this.telemetrySender=e,this.vscodeAPI=t,this.userOptIn=!1,this.errorOptIn=!1,this.disposables=[],this._onDidChangeTelemetryLevel=new this.vscodeAPI.EventEmitter,this.onDidChangeTelemetryLevel=this._onDidChangeTelemetryLevel.event,this.telemetryLogger=this.vscodeAPI.env.createTelemetryLogger(this.telemetrySender,r),this.updateUserOptIn(),this.telemetryLogger.onDidChangeEnableStates(()=>{this.updateUserOptIn()})}updateUserOptIn(){this.errorOptIn=this.telemetryLogger.isErrorsEnabled,this.userOptIn=this.telemetryLogger.isUsageEnabled,(this.telemetryLogger.isErrorsEnabled||this.telemetryLogger.isUsageEnabled)&&this.telemetrySender.instantiateSender(),this._onDidChangeTelemetryLevel.fire(this.telemetryLevel)}get telemetryLevel(){return this.errorOptIn&&this.userOptIn?"all":this.errorOptIn?"error":"off"}internalSendTelemetryEvent(e,t,r,o){o?this.telemetrySender.sendEventData(e,{properties:t,measurements:r}):this.telemetryLogger.logUsage(e,{properties:t,measurements:r})}sendTelemetryEvent(e,t,r){this.internalSendTelemetryEvent(e,t,r,!1)}sendRawTelemetryEvent(e,t,r){let o={...t};for(let s of Object.keys(o??{})){let a=o[s];typeof s=="string"&&a!==void 0&&(o[s]=new this.vscodeAPI.TelemetryTrustedValue(typeof a=="string"?a:a.value))}this.sendTelemetryEvent(e,o,r)}sendDangerousTelemetryEvent(e,t,r){this.telemetrySender.instantiateSender(),this.internalSendTelemetryEvent(e,t,r,!0)}internalSendTelemetryErrorEvent(e,t,r,o){o?this.telemetrySender.sendEventData(e,{properties:t,measurements:r}):this.telemetryLogger.logError(e,{properties:t,measurements:r})}sendTelemetryErrorEvent(e,t,r){this.internalSendTelemetryErrorEvent(e,t,r,!1)}sendDangerousTelemetryErrorEvent(e,t,r){this.telemetrySender.instantiateSender(),this.internalSendTelemetryErrorEvent(e,t,r,!0)}async dispose(){return await this.telemetrySender.dispose(),this.telemetryLogger.dispose(),Promise.all(this.disposables.map(e=>e.dispose()))}};sG.BaseTelemetryReporter=_ue});var G9e=P(aG=>{"use strict";Object.defineProperty(aG,"__esModule",{value:!0});aG.BaseTelemetrySender=void 0;var _g;(function(n){n[n.NOT_INSTANTIATED=0]="NOT_INSTANTIATED",n[n.INSTANTIATING=1]="INSTANTIATING",n[n.INSTANTIATED=2]="INSTANTIATED"})(_g||(_g={}));var xue=class{constructor(e,t){this._instantiationStatus=_g.NOT_INSTANTIATED,this._eventQueue=[],this._exceptionQueue=[],this._clientFactory=t,this._key=e}sendEventData(e,t){if(!this._telemetryClient){this._instantiationStatus!==_g.INSTANTIATED&&this._eventQueue.push({eventName:e,data:t});return}this._telemetryClient.logEvent(e,t)}sendErrorData(e,t){if(!this._telemetryClient){this._instantiationStatus!==_g.INSTANTIATED&&this._exceptionQueue.push({exception:e,data:t});return}let r={stack:e.stack,message:e.message,name:e.name};if(t){let o=t.properties||t;t.properties={...o,...r}}else t={properties:r};this._telemetryClient.logEvent("unhandlederror",t)}async flush(){return this._telemetryClient?.flush()}async dispose(){this._telemetryClient&&(await this._telemetryClient.dispose(),this._telemetryClient=void 0)}_flushQueues(){this._eventQueue.forEach(({eventName:e,data:t})=>this.sendEventData(e,t)),this._eventQueue=[],this._exceptionQueue.forEach(({exception:e,data:t})=>this.sendErrorData(e,t)),this._exceptionQueue=[]}instantiateSender(){this._instantiationStatus===_g.NOT_INSTANTIATED&&(this._instantiationStatus=_g.INSTANTIATING,this._clientFactory(this._key).then(e=>{this._telemetryClient=e,this._instantiationStatus=_g.INSTANTIATED,this._flushQueues()}).catch(e=>{console.error(e),this._instantiationStatus=_g.INSTANTIATED}))}};aG.BaseTelemetrySender=xue});var Iue=P(cG=>{"use strict";Object.defineProperty(cG,"__esModule",{value:!0});cG.TelemetryUtil=void 0;var Sue=class n{static applyReplacements(e,t){for(let r of Object.keys(e))for(let o of t)o.lookup.test(r)&&(o.replacementString!==void 0?e[r]=o.replacementString:delete e[r])}static shouldUseOneDataSystemSDK(e){return e.length===74&&e[32]==="-"&&e[41]==="-"&&e[46]==="-"&&e[51]==="-"&&e[56]==="-"&&e[69]==="-"}static getAdditionalCommonProperties(e){return{"common.os":e.platform,"common.nodeArch":e.architecture,"common.platformversion":(e.release||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),"common.telemetryclientversion":"0.9.4"}}static getInstance(){return n._instance||(n._instance=new n),n._instance}};cG.TelemetryUtil=Sue});var PP,xg,fm,cp,AP,IM,Tue=N(()=>{PP="function",xg="object",fm="undefined",cp="prototype",AP=Object,IM=AP[cp]});var _o,oo,DP,Tb,Sg,Xu,TM,Ig,CM,EM,z9e,Ju,wM,Er,NP,so,LP,Cue,Bl,Eue,wue,Tg,Yc,En=N(()=>{_o=void 0,oo=null,DP="",Tb="function",Sg="object",Xu="prototype",TM="__proto__",Ig="undefined",CM="constructor",EM="Symbol",z9e="_polyfill",Ju="length",wM="name",Er="call",NP="toString",so=Object,LP=so[Xu],Cue=String,Bl=Cue[Xu],Eue=Math,wue=Array,Tg=wue[Xu],Yc=Tg.slice});function Ra(n,e){try{return{v:n.apply(this,e)}}catch(t){return{e:t}}}var OP=N(()=>{});function $9e(n,e){var t=Ra(n);return t.e?e:t.v}var W9e=N(()=>{OP()});function lG(n){return function(e){return typeof e===n}}function K9e(n){var e="[object "+n+"]";return function(t){return!!(t&&kM(t)===e)}}function kM(n){return LP.toString.call(n)}function uG(n,e){return typeof n===e}function Wt(n){return typeof n===Ig||n===Ig}function Pe(n){return n===oo||Wt(n)}function Rue(n){return n===oo||!dG(n)}function dG(n){return!!n||n!==_o}function Pue(n){return!kue&&(kue=["string","number","boolean",Ig,"symbol","bigint"]),n!==Sg&&kue.indexOf(n)!==-1}function Zr(n){return!n&&Pe(n)?!1:!!n&&typeof n===Sg}function Eb(n){return!!(n&&n.then&&At(n.then))}function pG(n){return!n||!Zu(n)}function Zu(n){return!(!n||$9e(function(){return!(n&&0+n)},!n))}var kue,Jt,At,bt,MP,Pa,lp,Cb,ql=N(()=>{En();W9e();Jt=lG("string"),At=lG(Tb);bt=wue.isArray,MP=K9e("Date"),Pa=lG("number"),lp=lG("boolean"),Cb=K9e("Error")});var fI,fG=N(()=>{En();fI=so.getOwnPropertyDescriptor});function xo(n,e){return!!n&&LP.hasOwnProperty[Er](n,e)}var mG=N(()=>{En()});function Y9e(n,e){return xo(n,e)||!!fI(n,e)}var Qc,hG=N(()=>{En();fG();mG();Qc=so.hasOwn||Y9e});function at(n,e,t){if(n&&Zr(n)){for(var r in n)if(Qc(n,r)&&e[Er](t||n,r,n[r])===-1)break}}var wb=N(()=>{ql();En();hG()});function Aue(n,e,t,r){var o={};return at(n,function(s,a){o[s]=e?a:s,o[a]=t?a:s}),r(o)}var Q9e=N(()=>{wb()});function qi(n){throw new Error(n)}function xi(n){throw new TypeError(n)}var kb=N(()=>{});function X9e(n){var e=[];return at(n,function(t,r){e.push([t,r])}),e}function J9e(n){var e=[];return at(n,function(t,r){e.push(r)}),e}var Z9e=N(()=>{wb()});function eUe(n){return n}function Twt(n){return n[TM]||oo}function oc(n){return Due&&at(n,function(e,t){(bt(t)||Zr(t))&&Due(t)}),mm(n)}var Due,mI,ls,mm,gG,FP,Cwt,zlr,UP=N(()=>{En();ql();wb();Z9e();Due=so.freeze;mI=so.assign,ls=so.keys;mm=Due||eUe,gG=so.seal||eUe,FP=so.getPrototypeOf||Twt,Cwt=so.entries||X9e,zlr=so.values||J9e});function Nue(n){return Aue(n,1,0,oc)}function Lue(n){return Aue(n,0,0,oc)}function tUe(n){var e={};return at(n,function(t,r){e[t]=r[1],e[r[0]]=r[1]}),oc(e)}function Oue(n){return tUe(n)}var Mue=N(()=>{Q9e();wb();UP()});var vG,Fue=N(()=>{Mue();vG=Lue({asyncIterator:0,hasInstance:1,isConcatSpreadable:2,iterator:3,match:4,matchAll:5,replace:6,search:7,species:8,split:9,toPrimitive:10,toStringTag:11,unscopables:12})});var fi,hI=N(()=>{En();fi=Cue});function Bue(){var n;return typeof globalThis!==Ig&&(n=globalThis),!n&&typeof self!==Ig&&(n=self),!n&&typeof window!==Ig&&(n=window),!n&&typeof global!==Ig&&(n=global),n}function yG(){if(!Uue){var n=Ra(Bue).v||{};Uue=n[nUe]=n[nUe]||{}}return Uue}var nUe,Uue,bG=N(()=>{OP();En();nUe="__tsUtils$gblCfg"});function rt(n,e){var t=DP,r=LP[NP][Er](n);r===Ewt&&(n={stack:fi(n.stack),message:fi(n.message),name:fi(n.name)});try{t=JSON.stringify(n,oo,e?typeof e=="number"?e:4:_o),t=t&&t.replace(/"(\w+)"\s*:\s{0,1}/g,"$1: ")||fi(n)}catch(o){t=" - "+rt(o,e)}return r+": "+t}var Ewt,Rb=N(()=>{En();hI();Ewt="[object Error]"});function up(n,e,t){var r=e&&e[n];return function(o){var s=o&&o[n]||r;if(s||t){var a=arguments;return(s||t).apply(o,s?Yc[Er](a,1):a)}xi('"'+fi(n)+'" not defined for '+rt(o))}}function rUe(n){return function(e){return e[n]}}var ed,td=N(()=>{Rb();kb();hI();En();ed=up});var fur,iUe,oUe=N(()=>{En();fur=Eue.min,iUe=Eue.max});var que,sUe=N(()=>{En();td();que=ed("slice",Bl)});function aUe(n,e,t){return Pe(n)&&xi("'polyStrSubstr called with invalid "+rt(n)),t<0?DP:(e=e||0,e<0&&(e=iUe(e+n[Ju],0)),Wt(t)?que(n,e):que(n,e,e+t))}function Pb(n,e){return ao(n,0,e)}var ao,dp,_G=N(()=>{ql();Rb();kb();En();td();oUe();sUe();ao=ed("substring",Bl),dp=up("substr",Bl,aUe)});function wwt(){if(!jue){var n=yG();jue=n.gblSym=n.gblSym||{k:{},s:{}}}return jue}function SG(n){var e={description:fi(n),toString:function(){return EM+"("+n+")"}};return e[z9e]=!0,e}function lUe(n){var e=wwt();if(!Qc(e.k,n)){var t=SG(n),r=ls(e.s).length;t[cUe]=function(){return r+"_"+t[NP]()},e.k[n]=t,e.s[t[cUe]()]=fi(n)}return e.k[n]}function uUe(n){!xG&&(xG={});var e,t=vG[n];return t&&(e=xG[t]=xG[t]||SG(EM+"."+t)),e}var cUe,jue,xG,dUe=N(()=>{Fue();En();hG();hI();bG();UP();cUe="_urid"});function pUe(n){var e={};if(e[IG.c]=!0,e[IG.e]=!0,n.l){e.get=function(){return n.l.v};var t=fI(n.l,"v");t&&t.set&&(e.set=function(r){n.l.v=r})}return at(n,function(r,o){e[IG[r]]=Wt(o)?e[IG[r]]:o}),e}function TG(n,e,t,r,o,s){var a={e:s,c:o};return t&&(a.g=t),r&&(a.s=r),co(n,e,pUe(a))}function lr(n,e,t){return co(n,e,pUe(t))}var IG,co,kwt,gI=N(()=>{En();ql();wb();fG();IG={e:"enumerable",c:"configurable",v:"value",w:"writable",g:"get",s:"set"};co=so.defineProperty,kwt=so.defineProperties});function pp(){lo=yG()}function fp(n){var e={};return!lo&&pp(),e.b=lo.lzy,co(e,"v",{configurable:!0,get:function(){var t=n();return lo.lzy||co(e,"v",{value:t}),e.b=lo.lzy,t}}),e}var lo,vI=N(()=>{bG();gI()});function BP(n,e){return fp(function(){var t=Ra(n);return t.e?e:t.v})}var Hue=N(()=>{vI();OP()});function RM(n){return co({toJSON:function(){return n}},"v",{value:n})}var Vue=N(()=>{gI()});function AM(n,e){var t;return function(){return!lo&&pp(),(!t||lo.lzy)&&(t=RM(Ra(n,e).v)),t.v}}function Cg(n){return fp(function(){return Ra(Sr,[n]).v||_o})}function Aa(n){return!lo&&pp(),(!PM||n===!1||lo.lzy)&&(PM=RM(Ra(Bue).v||oo)),PM.v}function Sr(n,e){var t=!PM||e===!1?Aa(e):PM.v;return t&&t[n]?t[n]:n===fUe?Hi():oo}function Ab(){return!!ji()}function Db(){return!!Hi()}function qP(){return!!Ho()}function CG(){return!!DM()}var fUe,PM,ji,Hi,Ho,DM,Gue,NM=N(()=>{En();bG();vI();Vue();OP();fUe="window";ji=AM(Sr,["document"]);Hi=AM(Sr,[fUe]);Ho=AM(Sr,["navigator"]);DM=AM(Sr,["history"]),Gue=AM(function(){return!!Ra(function(){return process&&(process.versions||{}).node}).v})});function EG(){(!Da||!Da.b)&&(Da=Cg(EM),zue=BP(function(){return Da.v?Da.v.for:_o},_o),Rwt=BP(function(){return Da.v?Da.v.keyFor:_o},_o))}function $ue(){return!!mUe()}function mUe(){return!lo&&pp(),(!Da||lo.lzy)&&EG(),Da.v}function yI(n,e){var t=vG[n];return!lo&&pp(),(!Da||lo.lzy)&&EG(),Da.v?Da.v[t||n]:e?_o:uUe(n)}function bI(n,e){return!lo&&pp(),(!Da||lo.lzy)&&EG(),Da.v?Da.v(n):e?oo:SG(n)}function LM(n){return!lo&&pp(),(!zue||!Da||lo.lzy)&&EG(),(zue.v||lUe)(n)}var Da,zue,Rwt,wG=N(()=>{En();dUe();Fue();vI();Hue();NM()});function OM(n){return!!n&&At(n.next)}function hUe(n){return!Rue(n)&&At(n[yI(3)])}var Wue=N(()=>{wG();ql()});function gUe(n,e,t){if(n&&(OM(n)||(!kG&&(kG=RM(yI(3))),n=n[kG.v]?n[kG.v]():null),OM(n))){var r=void 0,o=void 0;try{for(var s=0;!(o=n.next()).done&&e[Er](t||n,o.value,s,n)!==-1;)s++}catch(a){r={e:a},n.throw&&(o=null,n.throw(r))}finally{try{o&&!o.done&&n.return&&n.return(o)}finally{if(r)throw r.e}}}}var kG,vUe=N(()=>{Vue();En();wG();Wue()});function Eg(n,e,t){return n.apply(e,t)}var RG=N(()=>{});function nd(n,e){return!Wt(e)&&n&&(bt(e)?Eg(n.push,n,e):OM(e)||hUe(e)?gUe(e,function(t){n.push(t)}):n.push(e)),n}var yUe=N(()=>{ql();Wue();vUe();RG()});function Ce(n,e,t){if(n)for(var r=n[Ju]>>>0,o=0;o<r&&!(o in n&&e[Er](t||n,n[o],o,n)===-1);o++);}var PG=N(()=>{En()});var er,Kue=N(()=>{En();td();er=ed("indexOf",Tg)});var hm,bUe=N(()=>{En();td();hm=ed("map",Tg)});function Nb(n,e,t){return(n&&n.slice||Yc).apply(n,Yc[Er](arguments,1))}var _Ue=N(()=>{En()});function xUe(n,e,t){return er(n,e,t)!==-1}var SUe=N(()=>{Kue()});var AG,IUe=N(()=>{En();td();SUe();AG=up("includes",Tg,xUe)});var jP,TUe=N(()=>{En();td();jP=ed("reduce",Tg)});function Pwt(n){if(!n)return{};var e=typeof n;e!==Sg&&e!==Tb&&xi("Prototype must be an Object or function: "+rt(n));function t(){}return t[Xu]=n,new t}var rd,Yue=N(()=>{En();Rb();kb();rd=so.create||Pwt});function Xue(n,e){var t=so.setPrototypeOf||function(r,o){!Que&&(Que=fp(function(){var s;return s={},s[TM]=[],s instanceof Array})),Que.v?r[TM]=o:at(o,function(s,a){return r[s]=a})};return t(n,e)}var Que,CUe=N(()=>{vI();En();wb()});function Awt(n,e,t){Ra(lr,[e,wM,{v:n,c:!0,e:!1}]),e=Xue(e,t);function r(){this.constructor=e,Ra(lr,[this,wM,{v:n,c:!0,e:!1}])}return e[Xu]=t===oo?rd(t):(r[Xu]=t[Xu],new r),e}function EUe(n,e){e&&(n[wM]=e)}function Jue(n,e,t){var r=t||Error,o=r[Xu][wM],s=Error.captureStackTrace;return Awt(n,function(){var a=this,c=arguments;try{Ra(EUe,[r,n]);var l=Eg(r,a,Yc[Er](c))||a;if(l!==a){var u=FP(a);u!==FP(l)&&Xue(l,u)}return s&&s(l,a[CM]),e&&e(l,c),l}finally{Ra(EUe,[r,o])}},r)}var wUe=N(()=>{RG();En();Yue();gI();UP();CUe();OP()});function Vi(){return(Date.now||kUe)()}function kUe(){return new Date().getTime()}var Zue=N(()=>{});function Dwt(n){return function(t){return Pe(t)&&xi("strTrim called ["+rt(t)+"]"),t&&t.replace&&(t=t.replace(n,DP)),t}}var RUe,PUe=N(()=>{ql();Rb();kb();En();RUe=Dwt(/^\s+|(?=\s)\s+$/g)});var sr,AUe=N(()=>{En();td();PUe();sr=up("trim",Bl,RUe)});function us(n){if(!n||typeof n!==Sg)return!1;nde||(nde=Db()?Hi():!0);var e=!1;if(n!==nde){tde||(ede=Function[Xu][NP],tde=ede[Er](so));try{var t=FP(n);e=!t,e||(xo(t,CM)&&(t=t[CM]),e=t&&typeof t===Tb&&ede[Er](t)===tde)}catch{}}return e}var ede,tde,nde,rde=N(()=>{NM();En();mG();UP()});function Nwt(n){return n.value&&MUe(n),!0}function Lwt(n,e,t,r){var o;return Ce(n,function(s){if(s.k===e)return o=s,-1}),o||(o={k:e,v:e},n.push(o),r(o)),o.v}function ide(n,e,t,r){var o=t.handler,s=t.path?r?t.path.concat(r):t.path:[],a={handler:t.handler,src:t.src,path:s},c=typeof e,l=!1,u=!1;e&&c===Sg?l=us(e):u=e===oo||Pue(c);var d={type:c,isPrim:u,isPlain:l,value:e,result:e,path:s,origin:t.src,copy:function(p,f){return ide(n,p,f?a:t,f)},copyTo:function(p,f){return NUe(n,p,f,a)}};return d.isPrim?o&&o[Er](t,d)?d.result:e:Lwt(n,e,s,function(p){lr(d,"result",{g:function(){return p.v},s:function(h){p.v=h}});for(var f=0,m=o;!(m||(f<DUe.length?DUe[f++]:Nwt))[Er](t,d);)m=oo})}function NUe(n,e,t,r){if(!Pe(t))for(var o in t)e[o]=ide(n,t[o],r,o);return e}function LUe(n,e,t){var r={handler:t,src:e,path:[]};return NUe([],n,e,r)}function OUe(n,e){var t={handler:e,src:n};return ide([],n,t)}function Owt(n){var e=n.value;if(bt(e)){var t=n.result=[];return t.length=e.length,n.copyTo(t,e),!0}return!1}function Mwt(n){var e=n.value;return MP(e)?(n.result=new Date(e.getTime()),!0):!1}function Fwt(n){return n.type===Tb}function MUe(n){var e=n.value;if(e&&n.isPlain){var t=n.result={};return n.copyTo(t,e),!0}return!1}var DUe,FUe=N(()=>{PG();ql();En();gI();rde();DUe=[Owt,MUe,Fwt,Mwt]});function Uwt(n,e){return Ce(e,function(t){LUe(n,t)}),n}function DG(n,e,t,r,o,s,a){return Uwt(OUe(n)||{},Yc[Er](arguments))}var UUe=N(()=>{PG();En();FUe()});var HP,BUe=N(()=>{En();td();HP=rUe(Ju)});function wg(){return!lo&&pp(),(!NG||!NG.b&&lo.lzy)&&(NG=Cg("performance")),NG.v}function VP(){var n=wg();return n&&n.now?n.now():Vi()}var NG,qUe=N(()=>{Zue();NM();vI()});function Bwt(n,e,t){Jt(n)||xi("'"+rt(n)+"' is not a string");var r=Jt(e)?e:fi(e),o=!Wt(t)&&t<n[Ju]?t:n[Ju];return ao(n,o-r[Ju],o)===r}var Lb,jUe=N(()=>{ql();Rb();kb();En();td();hI();_G();Lb=up("endsWith",Bl,Bwt)});var sc,HUe=N(()=>{En();td();sc=ed("indexOf",Bl)});function qwt(n,e,t){Jt(n)||xi("'"+rt(n)+"' is not a string");var r=Jt(e)?e:fi(e),o=t>0?t:0;return ao(n,o,o+r[Ju])===r}var _I,VUe=N(()=>{ql();Rb();kb();En();td();hI();_G();_I=up("startsWith",Bl,qwt)});function GUe(n,e,t){var r=!0,o=n?e(oo):oo,s;function a(){return r=!1,o&&o[sde]&&o[sde](),s}function c(){o&&t(o),o=oo}function l(){return o=e(o),r||a(),s}function u(d){!d&&o&&c(),d&&!o&&l()}return s={cancel:c,refresh:l},s[ade]=function(){return o&&o[ade]?o[ade]():r},s[ode]=function(){return r=!0,o&&o[ode]&&o[ode](),s},s[sde]=a,s=co(s,jwt,{get:function(){return!!o},set:u}),{h:s,dn:function(){o=oo}}}var ode,sde,ade,jwt,zUe=N(()=>{En();gI();ode="ref",sde="unref",ade="hasRef",jwt="enabled"});function cde(n,e,t){var r=bt(e),o=r?e.length:0,s=(o>0?e[0]:r?_o:e)||setTimeout,a=(o>1?e[1]:_o)||clearTimeout,c=t[0];t[0]=function(){l.dn(),Eg(c,_o,Yc[Er](arguments))};var l=GUe(n,function(u){if(u){if(u.refresh)return u.refresh(),u;Eg(a,_o,[u])}return Eg(s,_o,t)},function(u){Eg(a,_o,[u])});return l.h}function Xc(n,e){return cde(!0,_o,Yc[Er](arguments))}function lde(n,e,t){return cde(!0,n,Yc[Er](arguments,1))}function ude(n,e){return cde(!1,_o,Yc[Er](arguments))}var $Ue=N(()=>{RG();ql();En();zUe()});var Mt=N(()=>{yUe();PG();IUe();Kue();bUe();TUe();_Ue();ql();wUe();Zue();Rb();Mue();NM();UUe();vI();BUe();qUe();Hue();kb();Yue();gI();wb();fG();hG();mG();rde();UP();jUe();HUe();VUe();_G();hI();AUe();wG();$Ue()});function Jc(n,e){typeof e!==PP&&e!==null&&xi("Class extends value "+String(e)+" is not a constructor or null"),dde(n,e);function t(){this.constructor=n}n[cp]=e===null?rd(e):(t[cp]=e[cp],new t)}function LG(n,e){for(var t=0,r=e.length,o=n.length;t<r;t++,o++)n[o]=e[t];return n}var xmr,Smr,WUe,Gwt,id,dde,KUe=N(()=>{Mt();Tue();xmr=(Aa()||{}).Symbol,Smr=(Aa()||{}).Reflect,WUe="hasOwnProperty",Gwt=function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var o in e)IM[WUe].call(e,o)&&(n[o]=e[o])}return n},id=mI||Gwt,dde=function(n,e){return dde=AP.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)r[WUe](o)&&(t[o]=r[o])},dde(n,e)}});var YUe=N(()=>{});var Zc=N(()=>{Tue();KUe();YUe();Mt()});function UG(n){return n&&(n===bde[kg]||n===Array[kg])}function _de(n){return UG(n)||n===Function[kg]}function xI(n){var e;if(n){if(FM)return FM(n);var t=n[yde]||n[kg]||(n[BG]?n[BG][kg]:null);e=n[MG]||t,xo(n,MG)||(delete n[pde],e=n[MG]=n[pde]||n[MG],n[pde]=t)}return e}function HG(n,e){var t=[];if(JUe)t=JUe(n);else for(var r in n)typeof r=="string"&&xo(n,r)&&t.push(r);if(t&&t.length>0)for(var o=0;o<t.length;o++)e(t[o])}function xde(n,e,t){return e!==BG&&typeof n[e]===qG&&(t||xo(n,e))&&e!==yde&&e!==kg}function VG(n){xi("DynamicProto: "+n)}function $wt(n){var e=rd(null);return HG(n,function(t){!e[t]&&xde(n,t,!1)&&(e[t]=n[t])}),e}function Sde(n,e){for(var t=n.length-1;t>=0;t--)if(n[t]===e)return!0;return!1}function Wwt(n,e,t,r){function o(l,u,d){var p=u[d];if(p[mde]&&r){var f=l[jG]||{};f[MM]!==!1&&(p=(f[u[GP]]||{})[d]||p)}return function(){return p.apply(l,arguments)}}var s=rd(null);HG(t,function(l){s[l]=o(e,t,l)});for(var a=xI(n),c=[];a&&!_de(a)&&!Sde(c,a);)HG(a,function(l){!s[l]&&xde(a,l,!FM)&&(s[l]=o(e,a,l))}),c.push(a),a=xI(a);return s}function Kwt(n,e,t,r){var o=null;if(n&&xo(t,GP)){var s=n[jG]||rd(null);if(o=(s[t[GP]]||rd(null))[e],o||VG("Missing ["+e+"] "+qG),!o[hde]&&s[MM]!==!1){for(var a=!xo(n,e),c=xI(n),l=[];a&&c&&!_de(c)&&!Sde(l,c);){var u=c[e];if(u){a=u===r;break}l.push(c),c=xI(c)}try{a&&(n[e]=o),o[hde]=1}catch{s[MM]=!1}}}return o}function Ywt(n,e,t){var r=e[n];return r===t&&(r=xI(e)[n]),typeof r!==qG&&VG("["+n+"] is not a "+qG),r}function Qwt(n,e,t,r,o){function s(l,u){var d=function(){var p=Kwt(this,u,l,d)||Ywt(u,l,d);return p.apply(this,arguments)};return d[mde]=1,d}if(!UG(n)){var a=t[jG]=t[jG]||rd(null);if(!UG(a)){var c=a[e]=a[e]||rd(null);a[MM]!==!1&&(a[MM]=!!o),UG(c)||HG(t,function(l){xde(t,l,!1)&&t[l]!==r[l]&&(c[l]=t[l],delete t[l],(!xo(n,l)||n[l]&&!n[l][mde])&&(n[l]=s(n,l)))})}}}function Xwt(n,e){if(FM){for(var t=[],r=xI(e);r&&!_de(r)&&!Sde(t,r);){if(r===n)return!0;t.push(r),r=xI(r)}return!1}return!0}function fde(n,e){return xo(n,kg)?n.name||e||QUe:((n||{})[BG]||{}).name||e||QUe}function wn(n,e,t,r){xo(n,kg)||VG("theClass is an invalid class definition.");var o=n[kg];Xwt(o,e)||VG("["+fde(n)+"] not in hierarchy of ["+fde(e)+"]");var s=null;xo(o,GP)?s=o[GP]:(s=zwt+fde(n,"_")+"$"+vde.n,vde.n++,o[GP]=s);var a=wn[e7e],c=!!a[FG];c&&r&&r[FG]!==void 0&&(c=!!r[FG]);var l=$wt(e),u=Wwt(o,e,l,c);t(e,u);var d=!!FM&&!!a[gde];d&&r&&(d=!!r[gde]),Qwt(o,s,e,l,d!==!1)}var OG,BG,kg,qG,jG,mde,GP,zwt,hde,MM,e7e,QUe,yde,MG,XUe,pde,FG,gde,bde,FM,JUe,ZUe,vde,Fs=N(()=>{Mt();BG="constructor",kg="prototype",qG="function",jG="_dynInstFuncs",mde="_isDynProxy",GP="_dynClass",zwt="_dynCls$",hde="_dynInstChk",MM=hde,e7e="_dfOpts",QUe="_unknown_",yde="__proto__",MG="_dyn"+yde,XUe="__dynProto$Gbl",pde="_dynInstProto",FG="useBaseInst",gde="setInstFuncs",bde=Object,FM=bde.getPrototypeOf,JUe=bde.getOwnPropertyNames,ZUe=Aa(),vde=ZUe[XUe]||(ZUe[XUe]={o:(OG={},OG[gde]=!0,OG[FG]=!0,OG),n:1e3});wn[e7e]=vde.o});var Ide,t7e=N(()=>{"use strict";Ide=100});var Vo,Tde,GG=N(()=>{Mt();Vo=Nue,Tde=Oue});var mp,Jwt,n7e=N(()=>{GG();mp=Vo({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5}),Jwt=Vo({Unknown:0,NonRetryableStatus:1,CleanStorage:2,MaxInStorageTimeExceeded:3})});var el,Ob,It,SI,II,zP,Rg,hp,od,Ar,Mb,Dn,gm,zG,TI,Pg,vm,tl,Fb,Cde,Na,Ub,ds,$G,$P,WP,KP,Bb,Ede,nl,UM,CI,WG,ym,jl,YP,bm,gp,rl,qb,EI,Hl,jb,KG,BM,sd,YG,vp,wde,il,qM,wI,kde,Rde,Pde,jM,Hb,kI,yp,QG,QP,Ade,XG,RI,Dde,XP,JP,Vb,Vr=N(()=>{el="toLowerCase",Ob="blkVal",It="length",SI="rdOnly",II="notify",zP="warnToConsole",Rg="throwInternal",hp="setDf",od="watch",Ar="logger",Mb="apply",Dn="push",gm="splice",zG="hdlr",TI="cancel",Pg="initialize",vm="identifier",tl="isInitialized",Fb="getPlugin",Cde="pollInternalLogs",Na="name",Ub="time",ds="processNext",$G="getProcessTelContext",$P="getNotifyMgr",WP="addNotificationListener",KP="removeNotificationListener",Bb="enabled",Ede="stopPollingInternalLogs",nl="unload",UM="onComplete",CI="version",WG="loggingLevelConsole",ym="createNew",jl="teardown",YP="messageId",bm="message",gp="isAsync",rl="diagLog",qb="_doTeardown",EI="update",Hl="getNext",jb="setNextPlugin",KG="protocol",BM="userAgent",sd="split",YG="nodeType",vp="replace",wde="logInternalMessage",il="type",qM="handler",wI="status",kde="itemsReceived",Rde="getResponseHeader",Pde="getAllResponseHeaders",jM="isChildEvt",Hb="data",kI="getCtx",yp="setCtx",QG="complete",QP="urlString",Ade="sendPOST",XG="headers",RI="timeout",Dde="setRequestHeader",XP="traceId",JP="spanId",Vb="traceFlags"});function r7e(n,e){Nde||(Nde=Jue("AggregationError",function(r,o){o[It]>1&&(r.errors=o[1])}));var t=n||"One or more errors occurred.";throw Ce(e,function(r,o){t+=`
`.concat(o," > ").concat(rt(r))}),new Nde(t,e||[])}var Nde,i7e=N(()=>{Mt();Vr()});function Gb(n,e){return JG(n,function(t){return e?e({value:t,rejected:!1}):t},function(t){return e?e({rejected:!0,reason:t}):t})}function JG(n,e,t,r){var o=n;return Eb(n)?(e||t)&&(o=n.then(e,t)):e&&(o=e(n)),r&&o7e(o,r),o}function o7e(n,e){var t=n;return e&&(Eb(n)?n.finally?t=n.finally(e):t=n.then(function(r){return e(),r},function(r){throw e(),r}):e()),t}var Lde=N(()=>{Mt()});function s7e(n,e,t,r){Ode=Ode||{toString:function(){return"[[PromiseState]]"}},Mde=Mde||{toString:function(){return"[[PromiseResult]]"}},Fde=Fde||{toString:function(){return"[[PromiseIsHandled]]"}},co(n,Ode,{get:e}),co(n,Mde,{get:t}),co(n,Fde,{get:r})}var Ode,Mde,Fde,Ude,a7e=N(()=>{Mt();Ude=!1});var ZG,Bde=N(()=>{ZG=["pending","resolving","resolved","rejected"]});function l7e(n,e,t,r){var o=ji();!ez&&(ez=BP(function(){var l;return o&&o.createEvent&&(l=o.createEvent("Event")),!!l&&l.initEvent},null));var s=ez.v?o.createEvent("Event"):r?new Event(e):{};if(t&&t(s),ez.v&&s.initEvent(e,!1,!0),s&&n[c7e])n[c7e](s);else{var a=n["on"+e];if(a)a(s);else{var c=Sr("console");c&&(c.error||c.log)(e,rt(s))}}}var c7e,ez,u7e=N(()=>{Mt();c7e="dispatchEvent"});var ZP,qde=N(()=>{ZP="Promise"});function d7e(n){return At(n)?n.toString():rt(n)}function f7e(n,e,t){var r=Nb(arguments,3),o=0,s=!1,a,c=[],l=ekt++,u=HM.length>0?HM[HM.length-1]:void 0,d=!1,p=null,f;!jde&&(jde=Cg(ZP+"RejectionEvent"));var m=function(S,w){try{HM.push(l),d=!0,p&&p.cancel(),p=null;var R=n(function(k,V){c.push(function(){try{var F=o===2?S:w,K=Wt(F)?a:At(F)?F(a):F;Eb(K)?K.then(k,V):F?k(K):o===3?V(K):k(K)}catch($){V($)}}),s&&b()},r);return R}finally{HM.pop()}},h=function(S){return m(void 0,S)},g=function(S){var w=S,R=S;return At(S)&&(w=function(k){return S&&S(),k},R=function(k){throw S&&S(),k}),m(w,R)},y=function(){return ZG[o]},b=function(){if(c.length>0){var S=c.slice();c=[],d=!0,e(S),p&&p.cancel(),p=null}},_=function(S,w){return function(R){if(o===w){if(S===2&&Eb(R)){o=1,R.then(_(2,1),_(3,1));return}o=S,s=!0,a=R,b(),!d&&S===3&&!p&&(p=Xc(x,tkt))}}},x=function(){if(!d)if(Gue())process.emit(p7e,a,f);else{var S=Hi()||Aa();l7e(S,Zwt,function(w){return lr(w,"promise",{g:function(){return f}}),w.reason=a,w},!!jde.v)}};f={then:m,catch:h,finally:g},co(f,"state",{get:y}),Ude&&s7e(f,y,function(){return kM(a)},function(){return d}),$ue()&&(f[yI(11)]="IPromise");var I=function(){return"IPromise"+(Ude?"["+l+(Wt(u)?"":":"+u)+"]":"")+" "+y()+(s?" - "+d7e(a):"")};return f.toString=I,function(){At(t)||xi(ZP+": executor is not a function - "+d7e(t));var w=_(3,0);try{t.call(f,_(2,0),w)}catch(R){w(R)}}(),f}function eA(n){return function(e){var t=Nb(arguments,1);return n(function(r,o){try{var s=[],a=1;Ce(e,function(c,l){c&&(a++,JG(c,function(u){s[l]=u,--a===0&&r(s)},o))}),a--,a===0&&r(s)}catch(c){o(c)}},t)}}function tA(n){return function(e){var t=Nb(arguments,1);return Eb(e)?e:n(function(r){r(e)},t)}}function nA(n){return function(e){var t=Nb(arguments,1);return n(function(r,o){o(e)},t)}}var p7e,Zwt,HM,ekt,tkt,jde,tz=N(()=>{Mt();Lde();a7e();Bde();u7e();qde();p7e="unhandledRejection",Zwt=p7e.toLowerCase(),HM=[],ekt=0,tkt=10});function m7e(n){var e=Pa(n)?n:0;return function(t){Xc(function(){nkt(t)},e)}}var nkt,h7e=N(()=>{Mt();nkt=function(n){Ce(n,function(e){try{e()}catch{}})}});function rA(n,e){return f7e(rA,m7e(e),n,e)}var _hr,xhr,Shr,g7e=N(()=>{tz();h7e();_hr=eA(rA),xhr=tA(rA),Shr=nA(rA)});function VM(n,e){!Hde&&(Hde=Cg(ZP));var t=Hde.v;if(!t)return rA(n);At(n)||xi(ZP+": executor is not a function - "+rt(n));var r=0;function o(){return ZG[r]}var s=new t(function(a,c){function l(d){r=2,a(d)}function u(d){r=3,c(d)}n(l,u)});return co(s,"state",{get:o}),s}var Hde,Rhr,Phr,Ahr,v7e=N(()=>{g7e();tz();Bde();Mt();qde();Rhr=eA(VM),Phr=tA(VM),Ahr=nA(VM)});function ac(n,e){return!Vde&&(Vde=fp(function(){return VM})),Vde.v.call(this,n,e)}var Vde,Gde,rkt,ikt,y7e=N(()=>{Mt();tz();v7e();Gde=eA(ac),rkt=tA(ac),ikt=nA(ac)});var iA=N(()=>{Lde();y7e()});var Vl,Kt,zb,Gi,nz,GM,Ag,PI,ol,AI,oA,$b,sA,_m,rz,iz,oz,aA,sz,az,b7e,Go=N(()=>{Vl=void 0,Kt="",zb="channels",Gi="core",nz="createPerfMgr",GM="disabled",Ag="extensionConfig",PI="extensions",ol="processTelemetry",AI="priority",oA="eventsSent",$b="eventsDiscarded",sA="eventsSendRequest",_m="perfEvent",rz="offlineEventsStored",iz="offlineBatchSent",oz="offlineBatchDrop",aA="getPerfMgr",sz="domain",az="path",b7e="Not dynamic - "});function okt(n,e){return function(){var t=arguments,r=$de(e);if(r){var o=r.listener;o&&o[n]&&o[n][Mb](o,t)}}}function skt(){var n=Sr("Microsoft");return n&&(lz=n.ApplicationInsights),lz}function $de(n){var e=lz;return!e&&n.disableDbgExt!==!0&&(e=lz||skt()),e?e.ChromeDbgExt:null}function _7e(n){if(!cz){cz={};for(var e=0;e<zde[It];e++)cz[zde[e]]=okt(zde[e],n)}return cz}var zde,lz,cz,Wde=N(()=>{Mt();Vr();Go();zde=[oA,$b,sA,_m],lz=null});function T7e(n,e){var t=!1;if(n){try{if(t=e in n,!t){var r=n[cp];r&&(t=e in r)}}catch{}if(!t)try{var o=new n;t=!Wt(o[e])}catch{}}return t}function Zde(n){I7e=n}function DI(n){if(n&&I7e){var e=Sr("__mockLocation");if(e)return e}return typeof location===xg&&location?location:Sr(ckt)}function zM(){return typeof console!==fm?console:Sr(lkt)}function xm(){return!!(typeof JSON===xg&&JSON||Sr(x7e)!==null)}function la(){return xm()?JSON||Sr(x7e):null}function $M(){return Sr(ukt)}function WM(){return Sr(dkt)}function Wb(){var n=Ho();return n&&n.product?n.product===pkt:!1}function Kb(){var n=Ho();if(n&&(n[BM]!==Yde||Kde===null)){Yde=n[BM];var e=(Yde||Kt)[el]();Kde=So(e,Xde)||So(e,Jde)}return Kde}function KM(n){if(n===void 0&&(n=null),!n){var e=Ho()||{};n=e?(e.userAgent||Kt)[el]():Kt}var t=(n||Kt)[el]();if(So(t,Xde)){var r=ji()||{};return Math.max(parseInt(t[sd](Xde)[1]),r[akt]||0)}else if(So(t,Jde)){var o=parseInt(t[sd](Jde)[1]);if(o)return o+4}return null}function sl(n){return(Qde===null||n===!1)&&(Qde=qP()&&!!Ho().sendBeacon),Qde}function Dg(n){var e=!1;try{e=!!Sr("fetch");var t=Sr("Request");e&&n&&t&&(e=T7e(t,"keepalive"))}catch{}return e}function YM(){return cA===null&&(cA=typeof XDomainRequest!==fm,cA&&lA()&&(cA=cA&&!T7e(Sr(S7e),"withCredentials"))),cA}function lA(){var n=!1;try{var e=Sr(S7e);n=!!e}catch{}return n}function C7e(n,e){if(n)for(var t=0;t<n[It];t++){var r=n[t];if(r[Na]&&r[Na]===e)return r}return{}}function epe(n){var e=ji();return e&&n?C7e(e.querySelectorAll("meta"),n).content:null}function tpe(n){var e,t=wg();if(t){var r=t.getEntriesByType("navigation")||[];e=C7e((r[It]>0?r[0]:{}).serverTiming,n).description}return e}var akt,ckt,lkt,x7e,ukt,dkt,pkt,Xde,Jde,S7e,Kde,Yde,I7e,cA,Qde,Yb=N(()=>{"use strict";Zc();Mt();Vr();Sm();Go();akt="documentMode",ckt="location",lkt="console",x7e="JSON",ukt="crypto",dkt="msCrypto",pkt="ReactNative",Xde="msie",Jde="trident/",S7e="XMLHttpRequest",Kde=null,Yde=null,I7e=!1,cA=null,Qde=null});function E7e(n){return n?'"'+n[vp](/\"/g,Kt)+'"':Kt}function npe(n,e){var t=zM();if(t){var r="log";t[n]&&(r=n),At(t[r])&&t[r](e)}}function bp(n,e){return(n||{})[Ar]||new Qb(e)}function rpe(n){return n||new Qb}function ze(n,e,t,r,o,s){s===void 0&&(s=!1),rpe(n)[Rg](e,t,r,o,s)}function cc(n,e){rpe(n)[zP](e)}function ipe(n,e,t){rpe(n)[wde](e,t)}var uA,w7e,fkt,mkt,hkt,gkt,vkt,NI,Qb,_p=N(()=>{"use strict";Fs();Mt();Xb();Vr();Wde();Yb();Go();w7e="warnToConsole",fkt="AI (Internal): ",mkt="AI: ",hkt="AITR_",gkt={loggingLevelConsole:0,loggingLevelTelemetry:1,maxMessageLimit:25,enableDebug:!1},vkt=(uA={},uA[0]=null,uA[1]="errorToConsole",uA[2]=w7e,uA[3]="debugToConsole",uA);NI=function(){function n(e,t,r,o){r===void 0&&(r=!1);var s=this;s[YP]=e,s[bm]=(r?mkt:fkt)+e;var a=Kt;xm()&&(a=la().stringify(o));var c=(t?" message:"+E7e(t):Kt)+(o?" props:"+E7e(a):Kt);s[bm]+=c}return n.dataType="MessageData",n}();Qb=function(){function n(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,r={},o,s,a,c,l;wn(n,this,function(u){l=p(e||{}),u.consoleLoggingLevel=function(){return o},u[Rg]=function(h,g,y,b,_){_===void 0&&(_=!1);var x=new NI(g,y,_,b);if(c)throw rt(x);var I=vkt[h]||w7e;if(Wt(x[bm]))m("throw"+(h===1?"Critical":"Warning"),x);else{if(_){var S=+x[YP];!r[S]&&o>=h&&(u[I](x[bm]),r[S]=!0)}else o>=h&&u[I](x[bm]);d(h,x)}},u.debugToConsole=function(h){npe("debug",h),m("warning",h)},u[zP]=function(h){npe("warn",h),m("warning",h)},u.errorToConsole=function(h){npe("error",h),m("error",h)},u.resetInternalMessageCount=function(){t=0,r={}},u[wde]=d,u[nl]=function(h){l&&l.rm(),l=null};function d(h,g){if(!f()){var y=!0,b=hkt+g[YP];if(r[b]?y=!1:r[b]=!0,y&&(h<=s&&(u.queue[Dn](g),t++,m(h===1?"error":"warn",g)),t===a)){var _="Internal events throttle limit per PageView reached for this app.",x=new NI(23,_,!1);u.queue[Dn](x),h===1?u.errorToConsole(_):u[zP](_)}}}function p(h){return zo(Si(h,gkt,u).cfg,function(g){var y=g.cfg;o=y[WG],s=y.loggingLevelTelemetry,a=y.maxMessageLimit,c=y.enableDebug})}function f(){return t>=a}function m(h,g){var y=$de(e||{});y&&y[rl]&&y[rl](h,g)}})}return n.__ieDyn=1,n}()});function Im(n){return!Pe(n)}function LI(n){var e=n;return e&&Jt(e)&&(e=e[vp](bkt,function(t,r){return r.toUpperCase()}),e=e[vp](_kt,"_"),e=e[vp](xkt,function(t,r){return"_"+r})),e}function So(n,e){return n&&e?sc(n,e)!==-1:!1}function Gl(n){return n&&n.toISOString()||""}function ei(n){return Cb(n)?n[Na]:Kt}function ad(n,e,t,r,o){var s=t;return n&&(s=n[e],s!==t&&(!o||o(s))&&(!r||r(t))&&(s=t,n[e]=s)),s}function QM(n,e,t){var r;return n?(r=n[e],!r&&Pe(r)&&(r=Wt(t)?{}:t,n[e]=r)):r=Wt(t)?{}:t,r}function R7e(n,e){var t=null,r=null;return At(n)?t=n:r=n,function(){var o=arguments;if(t&&(r=t()),r)return r[e][Mb](r,o)}}function ope(n,e,t){if(n&&e&&Zr(n)&&Zr(e)){var r=function(s){if(Jt(s)){var a=e[s];At(a)?(!t||t(s,!0,e,n))&&(n[s]=R7e(e,s)):(!t||t(s,!1,e,n))&&(Qc(n,s)&&delete n[s],lr(n,s,{g:function(){return e[s]},s:function(c){e[s]=c}}))}};for(var o in e)r(o)}return n}function Ng(n,e,t,r,o){n&&e&&t&&(o!==!1||Wt(n[e]))&&(n[e]=R7e(t,r))}function zl(n,e,t,r){return n&&e&&Zr(n)&&bt(t)&&Ce(t,function(o){Jt(o)&&Ng(n,o,e,o,r)}),n}function spe(n){return function(){function e(){var t=this;n&&at(n,function(r,o){t[r]=o})}return e}()}function cd(n){return n&&mI&&(n=AP(mI({},n))),n}function uz(n,e,t,r,o,s){var a=arguments,c=a[0]||{},l=a[It],u=!1,d=1;for(l>0&&lp(c)&&(u=c,c=a[d]||{},d++),Zr(c)||(c={});d<l;d++){var p=a[d],f=bt(p),m=Zr(p);for(var h in p){var g=f&&h in p||m&&Qc(p,h);if(g){var y=p[h],b=void 0;if(u&&y&&((b=bt(y))||us(y))){var _=c[h];b?bt(_)||(_=[]):us(_)||(_={}),y=uz(u,_,y)}y!==void 0&&(c[h]=y)}}}return c}function xp(n){try{return n.responseText}catch{}return null}function OI(n,e){return n?"XDomainRequest,Response:"+xp(n)||"":e}function Lg(n,e){return n?"XMLHttpRequest,Status:"+n[wI]+",Response:"+xp(n)||n.response||"":e}function Og(n,e){return e&&(Pa(e)?n=[e].concat(n):bt(e)&&(n=e.concat(n))),n}function MI(n,e){try{if(n&&n!==""){var t=la().parse(n);if(t&&t[kde]&&t[kde]>=t.itemsAccepted&&t.itemsReceived-t.itemsAccepted===t.errors[It])return t}}catch(r){ze(e,1,43,"Cannot parse the response. "+ei(r),{response:n})}return null}function ape(n,e,t,r,o,s){r===void 0&&(r=!1),o===void 0&&(o=!1);function a(l,u,d){try{l[u]=d}catch{}}var c=new XMLHttpRequest;return r&&a(c,Skt,r),t&&a(c,k7e,t),c.open(n,e,!o),t&&a(c,k7e,t),!o&&s&&a(c,Ikt,s),c}function dz(n){var e={};if(Jt(n)){var t=sr(n)[sd](/[\r\n]+/);Ce(t,function(r){if(r){var o=r.indexOf(": ");if(o!==-1){var s=sr(r.substring(0,o))[el](),a=sr(r.substring(o+1));e[s]=a}else e[sr(r)]=1}})}return e}function dA(n,e,t){if(!n[t]&&e&&e[Rde]){var r=e[Rde](t);r&&(n[t]=sr(r))}return n}function Mg(n,e){var t={};return n[Pde]?t=dz(n[Pde]()):e&&(t=dA(t,n,Ekt),t=dA(t,n,Tkt),t=dA(t,n,Ckt)),t}var ykt,bkt,_kt,xkt,pgr,Skt,k7e,Ikt,Tkt,Ckt,Ekt,Sm=N(()=>{Zc();Mt();Vr();_p();Yb();Go();ykt="getPrototypeOf",bkt=/-([a-z])/g,_kt=/([^\w\d_$])/g,xkt=/^(\d+[\w\d_$])/,pgr=Object[ykt];Skt="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",k7e="withCredentials",Ikt="timeout";Tkt="kill-duration",Ckt="kill-duration-seconds",Ekt="time-delta-millis"});function wkt(n){n<0&&(n>>>=0),XM=A7e+n&Jb,JM=D7e-n&Jb,N7e=!0}function kkt(){try{var n=Vi()&2147483647;wkt((Math.random()*P7e^n)+n)}catch{}}function ZM(n){return n>0?Math.floor(Fg()/Jb*(n+1))>>>0:0}function Fg(n){var e=0,t=$M()||WM();return t&&t.getRandomValues&&(e=t.getRandomValues(new Uint32Array(1))[0]&Jb),e===0&&Kb()&&(N7e||kkt(),e=L7e()&Jb),e===0&&(e=Math.floor(P7e*Math.random()|0)),n||(e>>>=0),e}function L7e(n){JM=36969*(JM&65535)+(JM>>16)&Jb,XM=18e3*(XM&65535)+(XM>>16)&Jb;var e=(JM<<16)+(XM&65535)>>>0&Jb|0;return n||(e>>>=0),e}function e3(n){n===void 0&&(n=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=Fg()>>>0,r=0,o=Kt;o[It]<n;)r++,o+=e.charAt(t&63),t>>>=6,r===5&&(t=(Fg()<<2&4294967295|t&3)>>>0,r=0);return o}var P7e,Jb,A7e,D7e,N7e,XM,JM,pz=N(()=>{Mt();Vr();Yb();Go();P7e=4294967296,Jb=4294967295,A7e=123456789,D7e=987654321,N7e=!1,XM=A7e,JM=D7e});function M7e(n){return n[YG]===1||n[YG]===9||!+n[YG]}function Akt(n,e){var t=e[n.id];if(!t){t={};try{M7e(e)&&lr(e,n.id,{e:!1,v:t})}catch{}}return t}function ua(n,e){return e===void 0&&(e=!1),LI(n+Pkt+++(e?"."+O7e:Kt)+Rkt)}function fz(n){var e={id:ua("_aiData-"+(n||Kt)+"."+O7e),accept:function(t){return M7e(t)},get:function(t,r,o,s){var a=t[e.id];return a?a[LI(r)]:(s&&(a=Akt(e,t),a[LI(r)]=o),o)},kill:function(t,r){if(t&&t[r])try{delete t[r]}catch{}}};return e}var O7e,Rkt,Pkt,pA=N(()=>{Mt();Vr();Sm();Go();pz();O7e="3.0.5",Rkt="."+e3(6),Pkt=0});function mz(n){return n&&Zr(n)&&(n.isVal||n.fb||Qc(n,"v")||Qc(n,"mrg")||Qc(n,"ref")||n.set)}function F7e(n,e,t){var r,o=t.dfVal||dG;if(e&&t.fb){var s=t.fb;bt(s)||(s=[s]);for(var a=0;a<s[It];a++){var c=s[a],l=e[c];if(o(l)?r=l:n&&(l=n.cfg[c],o(l)&&(r=l),n.set(n.cfg,fi(c),l)),o(r))break}}return!o(r)&&o(t.v)&&(r=t.v),r}function cpe(n,e,t){var r=t;if(t&&mz(t)&&(r=F7e(n,e,t)),r){mz(r)&&(r=cpe(n,e,r));var o;bt(r)?(o=[],o[It]=r[It]):us(r)&&(o={}),o&&(at(r,function(s,a){a&&mz(a)&&(a=cpe(n,e,a)),o[s]=a}),r=o)}return r}function t3(n,e,t,r){var o,s,a,c=r,l,u,d,p;mz(c)?(o=c.isVal,s=c.set,d=c[SI],p=c[Ob],l=c.mrg,u=c.ref,!u&&Wt(u)&&(u=!!l),a=F7e(n,e,c)):a=r,p&&n[Ob](e,t);var f,m=!0,h=e[t];(h||!Pe(h))&&(f=h,m=!1,o&&f!==a&&!o(f)&&(f=a,m=!0),s&&(f=s(f,a,e),m=f===a)),m?a?f=cpe(n,e,a):f=a:(us(f)||bt(a))&&l&&a&&(us(a)||bt(a))&&at(a,function(g,y){t3(n,f,g,y)}),n.set(e,t,f),u&&n.ref(e,t),d&&n[SI](e,t)}var lpe=N(()=>{Mt();Vr()});function upe(n){if(n){var e;if(bt(n)?(e=[],e[It]=n[It]):us(n)&&(e={}),e)return at(n,function(t,r){e[t]=upe(r)}),e}return n}function n3(n){if(n){var e=n[Tm]||n;if(e.cfg&&(e.cfg===n||e.cfg[Tm]===e))return e}return null}function r3(n){if(n&&(us(n)||bt(n)))try{n[U7e]=!0}catch{}return n}function dpe(n){if(n)try{n[B7e]=!0}catch{}return n}function hz(n,e,t){var r=!1;return t&&!n[e.blkVal]&&(r=t[B7e],!r&&!t[U7e]&&(r=us(t)||bt(t))),r}function gz(n){xi("InvalidAccess:"+n)}var Tm,U7e,B7e,vz=N(()=>{Mt();Vr();Tm=LM("[[ai_dynCfg_1]]"),U7e=LM("[[ai_blkDynCfg_1]]"),B7e=LM("[[ai_frcDynCfg_1]]")});function Nkt(n,e,t){bt(e)&&Ce(Dkt,function(r){var o=e[r];e[r]=function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];var c=o[Mb](this,s);return i3(n,e,t,"Patching"),c}})}function yz(n,e){var t=fI(n,e);return t&&t.get}function Lkt(n,e,t,r){var o={n:t,h:[],trk:function(u){u&&u.fn&&(er(o.h,u)===-1&&o.h[Dn](u),n.trk(u,o))},clr:function(u){var d=er(o.h,u);d!==-1&&o.h[gm](d,1)}},s=!0,a=!1;function c(){s&&(a=a||hz(c,n,r),r&&!r[Tm]&&a&&(r=i3(n,r,t,"Converting")),s=!1);var u=n.act;return u&&o.trk(u),r}c[n.prop]={chng:function(){n.add(o)}};function l(u){if(r!==u){c[n.ro]&&!n.upd&&gz("["+t+"] is read-only:"+rt(e)),s&&(a=a||hz(c,n,r),s=!1);var d=a&&c[n.rf];if(a)if(d){at(r,function(f){r[f]=u?u[f]:Vl});try{at(u,function(f,m){o3(n,r,f,m)}),u=r}catch(f){fA((n.hdlr||{})[Ar],t,"Assigning",f),a=!1}}else r&&r[Tm]&&at(r,function(f){var m=yz(r,f);if(m){var h=m[n.prop];h&&h.chng()}});if(u!==r){var p=u&&hz(c,n,u);!d&&p&&(u=i3(n,u,t,"Converting")),r=u,a=p}n.add(o)}}lr(e,o.n,{g:c,s:l})}function o3(n,e,t,r){if(e){var o=yz(e,t),s=o&&!!o[n.prop];s?e[t]=r:Lkt(n,e,t,r)}return e}function bz(n,e,t,r){if(e){var o=yz(e,t),s=o&&!!o[n.prop],a=r&&r[0],c=r&&r[1],l=r&&r[2];if(!s){if(l)try{r3(e)}catch(u){fA((n.hdlr||{})[Ar],t,"Blocking",u)}try{o3(n,e,t,e[t]),o=yz(e,t)}catch(u){fA((n.hdlr||{})[Ar],t,"State",u)}}a&&(o[n.rf]=a),c&&(o[n.ro]=c),l&&(o[n.blkVal]=!0)}return e}function i3(n,e,t,r){try{at(e,function(o,s){o3(n,e,o,s)}),e[Tm]||(co(e,Tm,{get:function(){return n[zG]}}),Nkt(n,e,t))}catch(o){fA((n.hdlr||{})[Ar],t,r,o)}return e}var Dkt,fA,q7e=N(()=>{Mt();Go();Vr();vz();Dkt=["push","pop","shift","unshift","splice"],fA=function(n,e,t,r){n&&n[Rg](3,108,"".concat(t," [").concat(e,"] failed - ")+rt(r))}});function j7e(n){var e,t=bI(s3+"get"+n.uid+a3),r=bI(s3+"ro"+n.uid+a3),o=bI(s3+"rf"+n.uid+a3),s=bI(s3+"blkVal"+n.uid+a3),a=bI(s3+"dtl"+n.uid+a3),c=null,l=null,u;function d(h,g){var y=u.act;try{u.act=h,h&&h[a]&&(Ce(h[a],function(_){_.clr(h)}),h[a]=[]),g({cfg:n.cfg,set:n.set.bind(n),setDf:n[hp].bind(n),ref:n.ref.bind(n),rdOnly:n[SI].bind(n)})}catch(_){var b=n[Ar];throw b&&b[Rg](1,107,rt(_)),_}finally{u.act=y||null}}function p(){if(c){var h=c;c=null,l&&l[TI](),l=null;var g=[];if(Ce(h,function(y){if(y&&(y[a]&&(Ce(y[a],function(b){b.clr(y)}),y[a]=null),y.fn))try{d(y,y.fn)}catch(b){g[Dn](b)}}),c)try{p()}catch(y){g[Dn](y)}g[It]>0&&r7e("Watcher error(s): ",g)}}function f(h){if(h&&h.h[It]>0){c||(c=[]),l||(l=Xc(function(){l=null,p()},0));for(var g=0;g<h.h[It];g++){var y=h.h[g];y&&er(c,y)===-1&&c[Dn](y)}}}function m(h,g){if(h){var y=h[a]=h[a]||[];er(y,g)===-1&&y[Dn](g)}}return u=(e={prop:t,ro:r,rf:o},e[Ob]=s,e[zG]=n,e.add=f,e[II]=p,e.use=d,e.trk=m,e),u}var s3,a3,H7e=N(()=>{Mt();i7e();Vr();s3="[[ai_",a3="]]"});function Okt(n,e){var t={fn:e,rm:function(){t.fn=null,n=null,e=null}};return n.use(t,e),t}function Mkt(n,e,t){var r,o=n3(e);if(o)return o;var s=ua("dyncfg",!0),a=e&&t!==!1?e:upe(e),c;function l(){c[II]()}function u(b,_,x){try{b=o3(c,b,_,x)}catch(I){fA(n,_,"Setting value",I)}return b[_]}function d(b){return Okt(c,b)}function p(b,_){c.use(null,function(x){var I=c.upd;try{Wt(_)||(c.upd=_),b(x)}finally{c.upd=I}})}function f(b,_){var x;return bz(c,b,_,(x={},x[0]=!0,x))[_]}function m(b,_){var x;return bz(c,b,_,(x={},x[1]=!0,x))[_]}function h(b,_){var x;return bz(c,b,_,(x={},x[2]=!0,x))[_]}function g(b,_){return _&&at(_,function(x,I){t3(y,b,x,I)}),b}var y=(r={uid:null,cfg:a},r[Ar]=n,r[II]=l,r.set=u,r[hp]=g,r[od]=d,r.ref=f,r[SI]=m,r[Ob]=h,r._block=p,r);return lr(y,"uid",{c:!1,e:!1,w:!1,v:s}),c=j7e(y),i3(c,a,"config","Creating"),y}function Fkt(n,e){n?(n[zP](e),n[Rg](2,108,e)):gz(e)}function Si(n,e,t,r){var o=Mkt(t,n||{},r);return e&&o[hp](o.cfg,e),o}function zo(n,e,t){var r=n[Tm]||n;return r.cfg&&(r.cfg===n||r.cfg[Tm]===r)?r[od](e):(Fkt(t,b7e+rt(n)),Si(n,null,t)[od](e))}var Xb=N(()=>{Mt();pA();Go();Vr();lpe();q7e();H7e();vz()});function Ug(n,e){if(n&&n[nl])return n[nl](e)}function _z(n,e,t){var r;return t||(r=ac(function(o){t=o})),n&&HP(n)>0?Gb(Ug(n[0],e),function(){_z(Nb(n,1),e,t)}):t(),r}var ppe=N(()=>{iA();Mt();Vr()});var V7e,fpe,mpe=N(()=>{V7e=500,fpe="Microsoft_ApplicationInsights_BypassAjaxInstrumentation"});function Ukt(n,e,t){return!n&&Pe(n)?e:lp(n)?n:fi(n)[el]()==="true"}function hpe(n){return{mrg:!0,v:n}}function mA(n,e,t){return{fb:t,isVal:n,v:e}}function ld(n,e){return{fb:e,set:Ukt,v:!!n}}var gpe=N(()=>{Mt();Vr()});function Spe(){!Cm&&(Cm=fp(function(){return ji()}))}function qkt(n,e){var t=Bg[Zb]||Iz[Zb];return t||(t=Bg[Zb]=Bg(n,e),Iz[Zb]=t),t}function Sz(n){return n?n.isEnabled():!0}function Z7e(n,e){return e&&n&&bt(n.ignoreCookies)?er(n.ignoreCookies,e)!==-1:!1}function jkt(n,e){return e&&n&&bt(n.blockedCookies)&&er(n.blockedCookies,e)!==-1?!0:Z7e(n,e)}function Y7e(n,e){var t=e[Bb];if(Pe(t)){var r=void 0;Wt(n[$7e])||(r=!n[$7e]),Wt(n[_pe])||(r=!n[_pe]),t=r}return t}function Ipe(n,e){var t;if(n)t=n.getCookieMgr();else if(e){var r=e.cookieCfg;r&&r[Zb]?t=r[Zb]:t=Bg(e)}return t||(t=qkt(e,(n||{})[Ar])),t}function Bg(n,e){var t,r,o,s,a,c,l,u,d;n=Si(n||Iz,null,e).cfg,a=zo(n,function(f){f[hp](f.cfg,Bkt),r=f.ref(f.cfg,"cookieCfg"),o=r[az]||"/",s=r[sz],c=Y7e(n,r)!==!1,l=r.getCookie||Hkt,u=r.setCookie||J7e,d=r.delCookie||J7e},e);var p=(t={isEnabled:function(){var f=Y7e(n,r)!==!1&&c&&hA(e),m=Iz[Zb];return f&&m&&p!==m&&(f=Sz(m)),f},setEnabled:function(f){c=f!==!1,r[Bb]=f},set:function(f,m,h,g,y){var b=!1;if(Sz(p)&&!jkt(r,f)){var _={},x=sr(m||Kt),I=sc(x,";");if(I!==-1&&(x=sr(Pb(m,I)),_=eBe(ao(m,I+1))),ad(_,sz,g||s,Zu,Wt),!Pe(h)){var S=Kb();if(Wt(_[ype])){var w=Vi(),R=w+h*1e3;if(R>0){var k=new Date;k.setTime(R),ad(_,ype,Q7e(k,S?G7e:z7e)||Q7e(k,S?G7e:z7e)||Kt,Zu)}}S||ad(_,"max-age",Kt+h,null,Wt)}var V=DI();V&&V[KG]==="https:"&&(ad(_,"secure",null,null,Wt),bpe===null&&(bpe=!Tz((Ho()||{})[BM])),bpe&&ad(_,"SameSite","None",null,Wt)),ad(_,az,y||o,null,Wt),u(f,X7e(x,_)),b=!0}return b},get:function(f){var m=Kt;return Sz(p)&&!Z7e(r,f)&&(m=l(f)),m},del:function(f,m){var h=!1;return Sz(p)&&(h=p.purge(f,m)),h},purge:function(f,m){var h,g=!1;if(hA(e)){var y=(h={},h[az]=m||"/",h[ype]="Thu, 01 Jan 1970 00:00:01 GMT",h);Kb()||(y["max-age"]="0"),d(f,X7e(Kt,y)),g=!0}return g}},t[nl]=function(f){a&&a.rm(),a=null},t);return p[Zb]=p,p}function hA(n){if(xz===null){xz=!1,!Cm&&Spe();try{var e=Cm.v||{};xz=e[xpe]!==void 0}catch(t){ze(n,2,68,"Cannot access document.cookie - "+ei(t),{exception:rt(t)})}}return xz}function eBe(n){var e={};if(n&&n[It]){var t=sr(n)[sd](";");Ce(t,function(r){if(r=sr(r||Kt),r){var o=sc(r,"=");o===-1?e[r]=null:e[sr(Pb(r,o))]=sr(ao(r,o+1))}})}return e}function Q7e(n,e){return At(n[e])?n[e]():null}function X7e(n,e){var t=n||Kt;return at(e,function(r,o){t+="; "+r+(Pe(o)?Kt:"="+o)}),t}function Hkt(n){var e=Kt;if(!Cm&&Spe(),Cm.v){var t=Cm.v[xpe]||Kt;W7e!==t&&(K7e=eBe(t),W7e=t),e=sr(K7e[n]||Kt)}return e}function J7e(n,e){!Cm&&Spe(),Cm.v&&(Cm.v[xpe]=n+"="+e)}function Tz(n){return Jt(n)?!!(So(n,"CPU iPhone OS 12")||So(n,"iPad; CPU OS 12")||So(n,"Macintosh; Intel Mac OS X 10_14")&&So(n,"Version/")&&So(n,"Safari")||So(n,"Macintosh; Intel Mac OS X 10_14")&&Lb(n,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||So(n,"Chrome/5")||So(n,"Chrome/6")||So(n,"UnrealEngine")&&!So(n,"Chrome")||So(n,"UCBrowser/12")||So(n,"UCBrowser/11")):!1}var vpe,FI,G7e,z7e,xpe,ype,$7e,_pe,Zb,xz,bpe,W7e,Cm,K7e,Iz,Bkt,Tpe=N(()=>{Mt();gpe();Xb();Vr();_p();Yb();Sm();Go();G7e="toGMTString",z7e="toUTCString",xpe="cookie",ype="expires",$7e="isCookieUseDisabled",_pe="disableCookiesUsage",Zb="_ckMgr",xz=null,bpe=null,W7e=null,K7e={},Iz={},Bkt=(vpe={cookieCfg:hpe((FI={},FI[sz]={fb:"cookieDomain",dfVal:Im},FI.path={fb:"cookiePath",dfVal:Im},FI.enabled=Vl,FI.ignoreCookies=Vl,FI.blockedCookies=Vl,FI)),cookieDomain:Vl,cookiePath:Vl},vpe[_pe]=Vl,vpe)});function e_(n,e,t,r){Ce(n,function(o){if(o&&o[e])if(t)Xc(function(){return r(o)},0);else try{r(o)}catch{}})}var Vkt,c3,Cpe=N(()=>{Fs();iA();Mt();Xb();Vr();Go();Vkt={perfEvtsSendAll:!1};c3=function(){function n(e){this.listeners=[];var t,r,o=[],s=Si(e,Vkt);r=s[od](function(a){t=!!a.cfg.perfEvtsSendAll}),wn(n,this,function(a){lr(a,"listeners",{g:function(){return o}}),a[WP]=function(c){o[Dn](c)},a[KP]=function(c){for(var l=er(o,c);l>-1;)o[gm](l,1),l=er(o,c)},a[oA]=function(c){e_(o,oA,!0,function(l){l[oA](c)})},a[$b]=function(c,l){e_(o,$b,!0,function(u){u[$b](c,l)})},a[sA]=function(c,l){e_(o,sA,l,function(u){u[sA](c,l)})},a[_m]=function(c){c&&(t||!c[jM]())&&e_(o,_m,!1,function(l){c[gp]?Xc(function(){return l[_m](c)},0):l[_m](c)})},a[rz]=function(c){c&&c[It]&&e_(o,rz,!0,function(l){l[rz](c)})},a[iz]=function(c){c&&c[Hb]&&e_(o,iz,!0,function(l){l[iz](c)})},a[oz]=function(c,l){if(c>0){var u=l||0;e_(o,oz,!0,function(d){d[oz](c,u)})}},a[nl]=function(c){var l=function(){r&&r.rm(),r=null,o=[]},u;if(e_(o,"unload",!1,function(d){var p=d[nl](c);p&&(u||(u=[]),u[Dn](p))}),u)return ac(function(d){return Gb(Gde(u),function(){l(),d()})});l()}})}return n.__ieDyn=1,n}()});function uo(n,e,t,r,o){if(n){var s=n;if(s[aA]&&(s=s[aA]()),s){var a=void 0,c=s[kI](Epe);try{if(a=s.create(e(),r,o),a){if(c&&a[yp]&&(a[yp](UI[wpe],c),c[kI]&&c[yp])){var l=c[kI](UI[l3]);l||(l=[],c[yp](UI[l3],l)),l[Dn](a)}return s[yp](Epe,a),t(a)}}catch(u){a&&a[yp]&&a[yp]("exception",u)}finally{a&&s.fire(a),s[yp](Epe,c)}}}return t()}function kpe(){return Gkt}var gA,wpe,l3,Gkt,UI,u3,Epe,Cz=N(()=>{Fs();Mt();Vr();Go();gA="ctx",wpe="ParentContextKey",l3="ChildrenContextKey",Gkt=null,UI=function(){function n(e,t,r){var o=this;if(o.start=Vi(),o[Na]=e,o[gp]=r,o[jM]=function(){return!1},At(t)){var s;lr(o,"payload",{g:function(){return!s&&At(t)&&(s=t(),t=null),s}})}o[kI]=function(a){return a?a===n[wpe]||a===n[l3]?o[a]:(o[gA]||{})[a]:null},o[yp]=function(a,c){if(a)if(a===n[wpe])o[a]||(o[jM]=function(){return!0}),o[a]=c;else if(a===n[l3])o[a]=c;else{var l=o[gA]=o[gA]||{};l[a]=c}},o[QG]=function(){var a=0,c=o[kI](n[l3]);if(bt(c))for(var l=0;l<c[It];l++){var u=c[l];u&&(a+=u[Ub])}o[Ub]=Vi()-o.start,o.exTime=o[Ub]-a,o[QG]=function(){}}}return n.ParentContextKey="parent",n.ChildrenContextKey="childEvts",n}(),u3=function(){function n(e){this.ctx={},wn(n,this,function(t){t.create=function(r,o,s){return new UI(r,o,s)},t.fire=function(r){r&&(r[QG](),e&&At(e[_m])&&e[_m](r))},t[yp]=function(r,o){if(r){var s=t[gA]=t[gA]||{};s[r]=o}},t[kI]=function(r){return(t[gA]||{})[r]}})}return n.__ieDyn=1,n}(),Epe="CoreUtils.doPerf"});function d3(){var n=BI();return ao(n,0,8)+"-"+ao(n,8,12)+"-"+ao(n,12,16)+"-"+ao(n,16,20)+"-"+ao(n,20)}function BI(){for(var n=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e=Kt,t,r=0;r<4;r++)t=Fg(),e+=n[t&15]+n[t>>4&15]+n[t>>8&15]+n[t>>12&15]+n[t>>16&15]+n[t>>20&15]+n[t>>24&15]+n[t>>28&15];var o=n[8+(Fg()&3)|0];return dp(e,0,8)+dp(e,9,4)+"4"+dp(e,13,3)+o+dp(e,16,3)+dp(e,19,12)}var Rpe=N(()=>{"use strict";Mt();Go();pz()});function qg(n,e,t){return n&&n[It]===e&&n!==t?!!n.match(/^[\da-f]*$/i):!1}function nBe(n,e,t){return qg(n,e)?n:t}function rBe(n){(isNaN(n)||n<0||n>255)&&(n=1);for(var e=n.toString(16);e[It]<2;)e="0"+e;return e}function p3(n,e,t,r){var o;return o={},o[CI]=qg(r,2,Ape)?r:Ppe,o[XP]=Em(n)?n:BI(),o[JP]=wm(e)?e:Pb(BI(),16),o.traceFlags=t>=0&&t<=255?t:1,o}function qI(n,e){var t;if(!n||(bt(n)&&(n=n[0]||""),!n||!Jt(n)||n[It]>8192))return null;if(n.indexOf(",")!==-1){var r=n[sd](",");n=r[e>0&&r[It]>e?e:0]}var o=zkt.exec(sr(n));return!o||o[1]===Ape||o[2]===Ez||o[3]===wz?null:(t={version:(o[1]||Kt)[el](),traceId:(o[2]||Kt)[el](),spanId:(o[3]||Kt)[el]()},t[Vb]=parseInt(o[4],16),t)}function Em(n){return qg(n,32,Ez)}function wm(n){return qg(n,16,wz)}function vA(n){return!(!n||!qg(n[CI],2,Ape)||!qg(n[XP],32,Ez)||!qg(n[JP],16,wz)||!qg(rBe(n[Vb]),2))}function f3(n){return vA(n)?(n[Vb]&tBe)===tBe:!1}function m3(n){if(n){var e=rBe(n[Vb]);qg(e,2)||(e="01");var t=n[CI]||Ppe;return t!=="00"&&t!=="ff"&&(t=Ppe),"".concat(t.toLowerCase(),"-").concat(nBe(n.traceId,32,Ez).toLowerCase(),"-").concat(nBe(n.spanId,16,wz).toLowerCase(),"-").concat(e.toLowerCase())}return""}function h3(n){var e="traceparent",t=qI(epe(e),n);return t||(t=qI(tpe(e),n)),t}var zkt,Ppe,Ape,Ez,wz,tBe,Dpe=N(()=>{Mt();Vr();Rpe();Yb();Go();zkt=/^([\da-f]{2})-([\da-f]{32})-([\da-f]{16})-([\da-f]{2})(-[^\s]{1,64})?$/i,Ppe="00",Ape="ff",Ez="00000000000000000000000000000000",wz="0000000000000000",tBe=1});function jg(n){return $kt.get(n,"state",{},!0)}function Npe(n,e){for(var t=[],r=null,o=n[Hl](),s;o;){var a=o[Fb]();if(a){r&&r[jb]&&a[ol]&&r[jb](a),s=jg(a);var c=!!s[tl];a[tl]&&(c=a[tl]()),c||t[Dn](a),r=a,o=o[Hl]()}}Ce(t,function(l){var u=n[Gi]();l[Pg](n.getCfg(),u,e,n[Hl]()),s=jg(l),!l[Gi]&&!s[Gi]&&(s[Gi]=u),s[tl]=!0,delete s[jl]})}function kz(n){return n.sort(function(e,t){var r=0;if(t){var o=t[ol];e[ol]?r=o?e[AI]-t[AI]:1:o&&(r=-1)}else r=e?1:-1;return r})}function iBe(n){var e={};return{getName:function(){return e[Na]},setName:function(t){n&&n.setName(t),e[Na]=t},getTraceId:function(){return e[XP]},setTraceId:function(t){n&&n.setTraceId(t),Em(t)&&(e[XP]=t)},getSpanId:function(){return e[JP]},setSpanId:function(t){n&&n.setSpanId(t),wm(t)&&(e[JP]=t)},getTraceFlags:function(){return e[Vb]},setTraceFlags:function(t){n&&n.setTraceFlags(t),e[Vb]=t}}}var $kt,Lpe=N(()=>{"use strict";Mt();Vr();pA();Go();Dpe();$kt=fz("plugin")});function Kkt(n,e,t){for(;n;){if(n[Fb]()===t)return n;n=n[Hl]()}return t_([t],e.config||{},e)}function Ope(n,e,t,r){var o=null,s=[];e||(e=Si({},null,t[Ar])),r!==null&&(o=r?Kkt(n,t,r):n);var a={_next:l,ctx:{core:function(){return t},diagLog:function(){return bp(t,e.cfg)},getCfg:function(){return e.cfg},getExtCfg:d,getConfig:p,hasNext:function(){return!!o},getNext:function(){return o},setNext:function(m){o=m},iterate:f,onComplete:c}};function c(m,h){for(var g=[],y=2;y<arguments.length;y++)g[y-2]=arguments[y];m&&s[Dn]({func:m,self:Wt(h)?a.ctx:h,args:g})}function l(){var m=o;if(o=m?m[Hl]():null,!m){var h=s;h&&h[It]>0&&(Ce(h,function(g){try{g.func.call(g.self,g.args)}catch(y){ze(t[Ar],2,73,"Unexpected Exception during onComplete - "+rt(y))}}),s=[])}return m}function u(m,h){var g=null,y=e.cfg;if(y&&m){var b=y[Ag];!b&&h&&(b={}),y[Ag]=b,b=e.ref(y,Ag),b&&(g=b[m],!g&&h&&(g={}),b[m]=g,g=e.ref(b,m))}return g}function d(m,h){var g=u(m,!0);return h&&at(h,function(y,b){if(Pe(g[y])){var _=e.cfg[y];(_||!Pe(_))&&(g[y]=_)}t3(e,g,y,b)}),e[hp](g,h)}function p(m,h,g){g===void 0&&(g=!1);var y,b=u(m,!1),_=e.cfg;return b&&(b[h]||!Pe(b[h]))?y=b[h]:(_[h]||!Pe(_[h]))&&(y=_[h]),y||!Pe(y)?y:g}function f(m){for(var h;h=a._next();){var g=h[Fb]();g&&m(g)}}return a}function lc(n,e,t,r){var o=Si(e),s=Ope(n,o,t,r),a=s.ctx;function c(u){var d=s._next();return d&&d[ol](u,a),!d}function l(u,d){return u===void 0&&(u=null),bt(u)&&(u=t_(u,o.cfg,t,d)),lc(u||a[Hl](),o.cfg,t,d)}return a[ds]=c,a[ym]=l,a}function yA(n,e,t){var r=Si(e.config),o=Ope(n,r,e,t),s=o.ctx;function a(l){var u=o._next();return u&&u[nl](s,l),!u}function c(l,u){return l===void 0&&(l=null),bt(l)&&(l=t_(l,r.cfg,e,u)),yA(l||s[Hl](),e,u)}return s[ds]=a,s[ym]=c,s}function g3(n,e,t){var r=Si(e.config),o=Ope(n,r,e,t),s=o.ctx;function a(l){return s.iterate(function(u){At(u[EI])&&u[EI](s,l)})}function c(l,u){return l===void 0&&(l=null),bt(l)&&(l=t_(l,r.cfg,e,u)),g3(l||s[Hl](),e,u)}return s[ds]=a,s[ym]=c,s}function t_(n,e,t,r){var o=null,s=!r;if(bt(n)&&n[It]>0){var a=null;Ce(n,function(c){if(!s&&r===c&&(s=!0),s&&c&&At(c[ol])){var l=Ykt(c,e,t);o||(o=l),a&&a._setNext(l),a=l}})}return r&&!o?t_([r],e,t):o}function Ykt(n,e,t){var r=null,o=At(n[ol]),s=At(n[jb]),a;n?a=n[vm]+"-"+n[AI]+"-"+aBe++:a="Unknown-0-"+aBe++;var c={getPlugin:function(){return n},getNext:function(){return r},processTelemetry:d,unload:p,update:f,_id:a,_setNext:function(m){r=m}};function l(){var m;return n&&At(n[sBe])&&(m=n[sBe]()),m||(m=lc(c,e,t)),m}function u(m,h,g,y,b){var _=!1,x=n?n[vm]:Wkt,I=m[oBe];return I||(I=m[oBe]={}),m.setNext(r),n&&uo(m[Gi](),function(){return x+":"+g},function(){I[a]=!0;try{var S=r?r._id:Kt;S&&(I[S]=!1),_=h(m)}catch(R){var w=r?I[r._id]:!0;w&&(_=!0),(!r||!w)&&ze(m[rl](),1,73,"Plugin ["+x+"] failed during "+g+" - "+rt(R)+", run flags: "+rt(I))}},y,b),_}function d(m,h){h=h||l();function g(y){if(!n||!o)return!1;var b=jg(n);return b[jl]||b[GM]?!1:(s&&n[jb](r),n[ol](m,y),!0)}u(h,g,"processTelemetry",function(){return{item:m}},!m.sync)||h[ds](m)}function p(m,h){function g(){var y=!1;if(n){var b=jg(n),_=n[Gi]||b[Gi];n&&(!_||_===m.core())&&!b[jl]&&(b[Gi]=null,b[jl]=!0,b[tl]=!1,n[jl]&&n[jl](m,h)===!0&&(y=!0))}return y}u(m,g,"unload",function(){},h[gp])||m[ds](h)}function f(m,h){function g(){var y=!1;if(n){var b=jg(n),_=n[Gi]||b[Gi];n&&(!_||_===m.core())&&!b[jl]&&n[EI]&&n[EI](m,h)===!0&&(y=!0)}return y}u(m,g,"update",function(){},!1)||m[ds](h)}return mm(c)}var Wkt,oBe,sBe,aBe,Mpe,Rz=N(()=>{"use strict";Mt();lpe();Xb();Vr();_p();Sm();Go();Cz();Lpe();Wkt="TelemetryPluginChain",oBe="_hasRun",sBe="_getTelCtx",aBe=0;Mpe=function(){function n(e,t,r,o){var s=this,a=lc(e,t,r,o);zl(s,a,ls(a))}return n}()});function jI(){var n=[];function e(r){r&&n[Dn](r)}function t(r,o){Ce(n,function(s){try{s(r,o)}catch(a){ze(r[rl](),2,73,"Unexpected error calling unload handler - "+rt(a))}}),n=[]}return{add:e,run:t}}var Pz=N(()=>{Mt();Vr();_p()});function Az(){var n=[];function e(r){var o=n;n=[],Ce(o,function(s){try{(s.rm||s.remove).call(s)}catch(a){ze(r,2,73,"Unloading:"+rt(a))}})}function t(r){r&&nd(n,r)}return{run:e,add:t}}var Fpe=N(()=>{Mt();_p()});var Upe,n_,Qkt,Hg,Bpe=N(()=>{"use strict";Fs();Mt();Xb();Vr();_p();Sm();Go();Rz();Pz();Fpe();n_="getPlugin",Qkt=(Upe={},Upe[Ag]={isVal:Im,v:{}},Upe),Hg=function(){function n(){var e=this,t,r,o,s,a;u(),wn(n,e,function(d){d[Pg]=function(p,f,m,h){l(p,f,h),t=!0},d[jl]=function(p,f){var m,h=d[Gi];if(!h||p&&h!==p[Gi]())return;var g,y=!1,b=p||yA(null,h,o&&o[n_]?o[n_]():o),_=f||(m={reason:0},m[gp]=!1,m);function x(){y||(y=!0,s.run(b,f),a.run(b[rl]()),g===!0&&b[ds](_),u())}return!d[qb]||d[qb](b,_,x)!==!0?x():g=!0,g},d[EI]=function(p,f){var m=d[Gi];if(!m||p&&m!==p[Gi]())return;var h,g=!1,y=p||g3(null,m,o&&o[n_]?o[n_]():o),b=f||{reason:0};function _(){g||(g=!0,l(y.getCfg(),y.core(),y[Hl]()))}return!d._doUpdate||d._doUpdate(y,b,_)!==!0?_():h=!0,h},Ng(d,"_addUnloadCb",function(){return s},"add"),Ng(d,"_addHook",function(){return a},"add"),lr(d,"_unloadHooks",{g:function(){return a}})}),e[rl]=function(d){return c(d)[rl]()},e[tl]=function(){return t},e.setInitialized=function(d){t=d},e[jb]=function(d){o=d},e[ds]=function(d,p){p?p[ds](d):o&&At(o[ol])&&o[ol](d,null)},e._getTelCtx=c;function c(d){d===void 0&&(d=null);var p=d;if(!p){var f=r||lc(null,{},e[Gi]);o&&o[n_]?p=f[ym](null,o[n_]):p=f[ym](null,o)}return p}function l(d,p,f){Si(d,Qkt,bp(p)),!f&&p&&(f=p[$G]()[Hl]());var m=o;o&&o[n_]&&(m=o[n_]()),e[Gi]=p,r=lc(f,d,p,m)}function u(){t=!1,e[Gi]=null,r=null,o=null,a=Az(),s=jI()}}return n.__ieDyn=1,n}()});function Xkt(n,e,t){var r={id:e,fn:t};nd(n,r);var o={remove:function(){Ce(n,function(s,a){if(s.id===r.id)return n[gm](a,1),-1})}};return o}function Jkt(n,e,t){for(var r=!1,o=n[It],s=0;s<o;++s){var a=n[s];if(a)try{if(a.fn[Mb](null,[e])===!1){r=!0;break}}catch(c){ze(t,2,64,"Telemetry initializer failed: "+ei(c),{exception:rt(c)},!0)}}return!r}var cBe,lBe=N(()=>{Zc();Fs();Mt();Vr();Bpe();_p();Sm();Go();cBe=function(n){Jc(e,n);function e(){var t=n.call(this)||this;t.identifier="TelemetryInitializerPlugin",t.priority=199;var r,o;s(),wn(e,t,function(a,c){a.addTelemetryInitializer=function(l){return Xkt(o,r++,l)},a[ol]=function(l,u){Jkt(o,l,u?u[rl]():a[rl]())&&a[ds](l,u)},a[qb]=function(){s()}});function s(){r=0,o=[]}return t}return e.__ieDyn=1,e}(Hg)});function tRt(n,e){return new u3(e)}function nRt(n,e,t){var r,o=[],s=[],a={};return Ce(t,function(c){(Pe(c)||Pe(c[Pg]))&&qi(fBe);var l=c[AI],u=c[vm];c&&l&&(Pe(a[l])?a[l]=u:cc(n,"Two extensions have same priority #"+l+" - "+a[l]+", "+u)),!l||l<e?o[Dn](c):s[Dn](c)}),r={},r[Gi]=o,r[zb]=s,r}function dBe(n,e){var t=!1;return Ce(e,function(r){if(r===n)return t=!0,-1}),t}function jpe(n,e,t,r){t&&at(t,function(o,s){r&&us(s)&&us(e[o])&&jpe(n,e[o],s,r),r&&us(s)&&us(e[o])?jpe(n,e[o],s,r):n.set(e,o,s)})}function pBe(n,e){var t=null,r=-1;return Ce(n,function(o,s){if(o.w===e)return t=o,r=s,-1}),{i:r,l:t}}function rRt(n,e){var t=pBe(n,e).l;return t||(t={w:e,rm:function(){var r=pBe(n,e);r.i!==-1&&n[gm](r.i,1)}},n[Dn](t)),t}function iRt(n,e,t){Ce(e,function(r){var o=zo(n,r.w,t);delete r.w,r.rm=function(){o.rm()}})}var r_,fBe,Zkt,uBe,eRt,qpe,Vg,mBe=N(()=>{"use strict";Zc();Fs();iA();Mt();Xb();Vr();ppe();mpe();Tpe();pA();Wde();_p();Sm();Go();Cpe();Cz();Rz();Lpe();lBe();Pz();Fpe();fBe="Plugins must provide initialize method",Zkt="_notificationManager",uBe="SDK is still unloading...",eRt="SDK is not initialized",qpe=oc((r_={cookieCfg:{}},r_[PI]={rdOnly:!0,ref:!0,v:[]},r_[zb]={rdOnly:!0,ref:!0,v:[]},r_[Ag]={ref:!0,v:{}},r_[nz]=Vl,r_.loggingLevelConsole=0,r_.diagnosticLogInterval=Vl,r_));Vg=function(){function n(){var e,t,r,o,s,a,c,l,u,d,p,f,m,h,g,y,b,_,x,I,S,w,R,k,V,F,K,$;wn(n,this,function(j){B(),j._getDbgPlgTargets=function(){return[R]},j[tl]=function(){return t},j[Pg]=function(G,de,me,Ne){m&&qi(uBe),j[tl]()&&qi("Core cannot be initialized more than once"),e=Si(G,qpe,me||j[Ar],!1),G=e.cfg,mt(e[od](function(Ft){S=Ft.cfg.instrumentationKey;var vr=Ft.ref(Ft.cfg,Ag);at(vr,function(Gr){Ft.ref(vr,Gr)}),Pe(S)&&qi("Please provide instrumentation key")})),s=Ne,Ie(),Xe(),j[Ar]=me;var Ee=G[PI];if(d=[],d[Dn].apply(d,LG(LG([],de,!1),Ee,!1)),p=G[zb],W(null),(!f||f[It]===0)&&qi("No "+zb+" available"),p&&p[It]>1){var St=j[Fb]("TeeChannelController");(!St||!St.plugin)&&ze(r,1,28,"TeeChannel required")}iRt(G,w,r),w=null,t=!0,j.releaseQueue(),j[Cde]()},j.getChannels=function(){var G=[];return f&&Ce(f,function(de){G[Dn](de)}),mm(G)},j.track=function(G){uo(j[aA](),function(){return"AppInsightsCore:track"},function(){G===null&&(xe(G),qi("Invalid telemetry item")),!G[Na]&&Pe(G[Na])&&(xe(G),qi("telemetry name required")),G.iKey=G.iKey||S,G[Ub]=G[Ub]||Gl(new Date),G.ver=G.ver||"4.0",!m&&j[tl]()?U()[ds](G):o[Dn](G)},function(){return{item:G}},!G.sync)},j[$G]=U,j[$P]=function(){return s||(s=new c3(e.cfg),j[Zkt]=s),s},j[WP]=function(G){j[$P]()[WP](G)},j[KP]=function(G){s&&s[KP](G)},j.getCookieMgr=function(){return l||(l=Bg(e.cfg,j[Ar])),l},j.setCookieMgr=function(G){l!==G&&(Ug(l,!1),l=G)},j[aA]=function(){return!a&&!c&&mt(e[od](function(G){if(G.cfg.enablePerfMgr){var de=G.cfg[nz];At(de)&&(c=de(j,j[$P]()))}})),a||c||kpe()},j.setPerfMgr=function(G){a=G},j.eventCnt=function(){return o[It]},j.releaseQueue=function(){if(t&&o[It]>0){var G=o;o=[],Ce(G,function(de){U()[ds](de)})}},j[Cde]=function(G){return g=G||null,$=!1,F&&F[TI](),D(!0)};function D(G){if((!F||!F[Bb])&&!$){var de=G||r&&r.queue[It]>0;de&&(K||(K=!0,mt(e[od](function(me){var Ne=me.cfg.diagnosticLogInterval;(!Ne||!(Ne>0))&&(Ne=1e4);var Ee=!1;F&&(Ee=F[Bb],F[TI]()),F=ude(Se,Ne),F.unref(),F[Bb]=Ee}))),F[Bb]=!0)}return F}j[Ede]=function(){$=!0,F&&F[TI](),Se()},zl(j,function(){return h},["addTelemetryInitializer"]),j[nl]=function(G,de,me){var Ne;G===void 0&&(G=!0),t||qi(eRt),m&&qi(uBe);var Ee=(Ne={reason:50},Ne[gp]=G,Ne.flushComplete=!1,Ne),St;G&&!de&&(St=ac(function(Gr){de=Gr}));var Ft=yA(Y(),j);Ft[UM](function(){_.run(j[Ar]),_z([l,s,r],G,function(){B(),de&&de(Ee)})},j);function vr(Gr){Ee.flushComplete=Gr,m=!0,b.run(Ft,Ee),j[Ede](),Ft[ds](Ee)}return Se(),te(G,vr,6,me)||vr(!1),St},j[Fb]=ae,j.addPlugin=function(G,de,me,Ne){if(!G){Ne&&Ne(!1),Nn(fBe);return}var Ee=ae(G[vm]);if(Ee&&!de){Ne&&Ne(!1),Nn("Plugin ["+G[vm]+"] is already loaded!");return}var St={reason:16};function Ft(wi){d[Dn](G),St.added=[G],W(St),Ne&&Ne(!0)}if(Ee){var vr=[Ee.plugin],Gr={reason:2,isAsync:!!me};X(vr,Gr,function(wi){wi?(St.removed=vr,St.reason|=32,Ft(!0)):Ne&&Ne(!1)})}else Ft(!1)},j.updateCfg=function(G,de){de===void 0&&(de=!0);var me;if(j[tl]()){me={reason:1,cfg:e.cfg,oldCfg:DG({},e.cfg),newConfig:DG({},G),merge:de},G=me.newConfig;var Ne=e.cfg;G[PI]=Ne[PI],G[zb]=Ne[zb]}e._block(function(Ee){var St=Ee.cfg;jpe(Ee,St,G,de),de||at(St,function(Ft){Qc(G,Ft)||Ee.set(St,Ft,Vl)}),Ee[hp](St,qpe)},!0),e[II](),me&&Ut(me)},j.evtNamespace=function(){return y},j.flush=te,j.getTraceCtx=function(G){return I||(I=iBe()),I},j.setTraceCtx=function(G){I=G||null},j.addUnloadHook=mt,Ng(j,"addUnloadCb",function(){return b},"add"),j.onCfgChange=function(G){var de;return t?de=zo(e.cfg,G,j[Ar]):de=rRt(w,G),{rm:function(){de.rm()}}},j.getWParam=function(){return Ab()||e.cfg.enableWParam?0:-1};function A(){var G={};k=[];var de=function(me){me&&Ce(me,function(Ne){if(Ne[vm]&&Ne[CI]&&!G[Ne.identifier]){var Ee=Ne[vm]+"="+Ne[CI];k[Dn](Ee),G[Ne.identifier]=Ne}})};de(f),p&&Ce(p,function(me){de(me)}),de(d)}function B(){t=!1,e=Si({},qpe,j[Ar]),e.cfg[WG]=1,lr(j,"config",{g:function(){return e.cfg},s:function(de){j.updateCfg(de,!1)}}),lr(j,"pluginVersionStringArr",{g:function(){return k||A(),k}}),lr(j,"pluginVersionString",{g:function(){return V||(k||A(),V=k.join(";")),V||Kt}}),lr(j,"logger",{g:function(){return r||(r=new Qb(e.cfg),e[Ar]=r),r},s:function(de){e[Ar]=de,r!==de&&(Ug(r,!1),r=de)}}),j[Ar]=new Qb(e.cfg),R=[];var G=j.config[PI]||[];G.splice(0,G[It]),nd(G,R),h=new cBe,o=[],Ug(s,!1),s=null,a=null,c=null,Ug(l,!1),l=null,u=null,d=[],p=null,f=null,m=!1,g=null,y=ua("AIBaseCore",!0),b=jI(),I=null,S=null,_=Az(),w=[],V=null,k=null,$=!1}function U(){var G=lc(Y(),e.cfg,j);return G[UM](D),G}function W(G){var de=nRt(j[Ar],V7e,d);u=null,V=null,k=null,f=(p||[])[0]||[],f=kz(nd(f,de[zb]));var me=nd(kz(de[Gi]),f);R=mm(me);var Ne=j.config[PI]||[];Ne.splice(0,Ne[It]),nd(Ne,R);var Ee=U();f&&f[It]>0&&Npe(Ee[ym](f),me),Npe(Ee,me),G&&Ut(G)}function ae(G){var de=null,me=null,Ne=[];return Ce(R,function(Ee){if(Ee[vm]===G&&Ee!==h)return me=Ee,-1;Ee.getChannel&&Ne[Dn](Ee)}),!me&&Ne[It]>0&&Ce(Ne,function(Ee){if(me=Ee.getChannel(G),!me)return-1}),me&&(de={plugin:me,setEnabled:function(Ee){jg(me)[GM]=!Ee},isEnabled:function(){var Ee=jg(me);return!Ee[jl]&&!Ee[GM]},remove:function(Ee,St){var Ft;Ee===void 0&&(Ee=!0);var vr=[me],Gr=(Ft={reason:1},Ft[gp]=Ee,Ft);X(vr,Gr,function(wi){wi&&W({reason:32,removed:vr}),St&&St(wi)})}}),de}function Y(){if(!u){var G=(R||[]).slice();er(G,h)===-1&&G[Dn](h),u=t_(kz(G),e.cfg,j)}return u}function X(G,de,me){if(G&&G[It]>0){var Ne=t_(G,e.cfg,j),Ee=yA(Ne,j);Ee[UM](function(){var St=!1,Ft=[];Ce(d,function(Gr,wi){dBe(Gr,G)?St=!0:Ft[Dn](Gr)}),d=Ft,V=null,k=null;var vr=[];p&&(Ce(p,function(Gr,wi){var ma=[];Ce(Gr,function(Cp){dBe(Cp,G)?St=!0:ma[Dn](Cp)}),vr[Dn](ma)}),p=vr),me&&me(St),D()}),Ee[ds](de)}else me(!1)}function Se(){if(r&&r.queue){var G=r.queue.slice(0);r.queue[It]=0,Ce(G,function(de){var me,Ne=(me={},me[Na]=g||"InternalMessageId: "+de[YP],me.iKey=S,me[Ub]=Gl(new Date),me.baseType=NI.dataType,me.baseData={message:de[bm]},me);j.track(Ne)})}}function te(G,de,me,Ne){var Ee=1,St=!1,Ft=null;Ne=Ne||5e3;function vr(){Ee--,St&&Ee===0&&(Ft&&Ft[TI](),Ft=null,de&&de(St),de=null)}if(f&&f[It]>0){var Gr=U()[ym](f);Gr.iterate(function(wi){if(wi.flush){Ee++;var ma=!1;wi.flush(G,function(){ma=!0,vr()},me)||ma||(G&&Ft==null?Ft=Xc(function(){Ft=null,vr()},Ne):vr())}})}return St=!0,vr(),!0}function Ie(){!s&&j[$P](),mt(e[od](function(G){var de=G.cfg.disableDbgExt;de===!0&&x&&(s[KP](x),x=null),s&&!x&&de!==!0&&(x=_7e(G.cfg),s[WP](x))}))}function Xe(){mt(e[od](function(G){var de=G.cfg.enablePerfMgr;!de&&c&&(c=null),de&&QM(G.cfg,nz,tRt)}))}function Ut(G){var de=g3(Y(),j);de[UM](D),(!j._updateHook||j._updateHook(de,G)!==!0)&&de[ds](G)}function Nn(G){var de=j[Ar];de?(ze(de,2,73,G),D()):qi(G)}function xe(G){var de=j[$P]();de&&de[$b]([G],2)}function mt(G){_.add(G)}})}return n.__ieDyn=1,n}()});var km,oRt,hBe,Hpe,HI,gBe=N(()=>{Fs();iA();Mt();Vr();mpe();_p();Yb();Sm();km="",oRt="NoResponseBody",hBe="&"+oRt+"=true",Hpe="POST",HI=function(){function n(){var e=0,t,r,o,s,a,c,l,u,d,p,f,m,h;wn(n,this,function(g,y){var b=!0;$(),g[Pg]=function(j,D){o=D,r&&ze(o,1,28,"Sender is already initialized"),g.SetConfig(j),r=!0},g._getDbgPlgTargets=function(){return[r,s,c,t]},g.SetConfig=function(j){try{if(a=j.senderOnCompleteCallBack||{},c=!!j.disableCredentials,s=!!j.isOneDs,t=!!j.enableSendPromise,u=!!j.disableXhr,d=!!j.disableBeacon,p=!!j.disableBeaconSync,h=j.timeWrapper,m=!!j.addNoResponse,f=!!j.disableFetchKeepAlive,l={sendPOST:V},s||(b=!1),c){var D=DI();D&&D.protocol&&D.protocol[el]()==="file:"&&(b=!1)}return!0}catch{}return!1},g.getSyncFetchPayload=function(){return e},g.getSenderInst=function(j,D){return j&&j[It]?S(j,D):null},g.getFallbackInst=function(){return l},g[qb]=function(j,D){$()};function _(j,D){w(D,200,{},j)}function x(j,D){ze(o,2,26,"Failed to send telemetry.",{message:j}),w(D,400,{})}function I(j){x("No endpoint url is provided for the batch",j)}function S(j,D){for(var A,B=0,U=null,W=0;U==null&&W<j[It];)B=j[W],!u&&B===1?YM()?U=K:lA()&&(U=V):B===2&&Dg(D)&&(!D||!f)?U=F:B===3&&sl()&&(D?!p:!d)&&(U=k),W++;return U?(A={_transport:B,_isSync:D},A[Ade]=U,A):null}function w(j,D,A,B){try{j&&j(D,A,B)}catch{}}function R(j,D){var A=Ho(),B=j[QP];if(!B)return I(D),!0;B=j[QP]+(m?hBe:km);var U=j[Hb],W=s?U:new Blob([U],{type:"text/plain;charset=UTF-8"}),ae=A.sendBeacon(B,W);return ae}function k(j,D,A){var B=j[Hb];try{if(B)if(R(j,D))_(km,D);else{var U=a&&a.beaconOnRetry;U&&At(U)?U(j,D,R):(l&&l[Ade](j,D,!0),ze(o,2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}catch(W){s&&cc(o,"Failed to send telemetry using sendBeacon API. Ex:"+rt(W)),w(D,s?0:400,{},km)}}function V(j,D,A){var B,U,W,ae=j[XG]||{};!A&&t&&(B=ac(function(te,Ie){U=te,W=Ie})),s&&A&&j.disableXhrSync&&(A=!1);var Y=j[QP];if(!Y){I(D),U&&U(!1);return}var X=ape(Hpe,Y,b,!0,A,j[RI]);X[Dde]("Content-type","application/json"),Ce(ls(ae),function(te){X[Dde](te,ae[te])}),X.onreadystatechange=function(){s||(Se(X),X.readyState===4&&U&&U(!0))},X.onload=function(){s&&Se(X)};function Se(te){var Ie=a&&a.xhrOnComplete,Xe=Ie&&At(Ie);if(Xe)Ie(te,D,j);else{var Ut=xp(te);w(D,te[wI],Mg(te,s),Ut)}}return X.onerror=function(te){w(D,s?X[wI]:400,Mg(X,s),s?km:Lg(X)),W&&W(te)},X.ontimeout=function(){w(D,s?X[wI]:500,Mg(X,s),s?km:Lg(X)),U&&U(!1)},X.send(j[Hb]),B}function F(j,D,A){var B,U=j[QP],W=j[Hb],ae=s?W:new Blob([W],{type:"application/json"}),Y,X,Se,te=new Headers,Ie=W[It],Xe=!1,Ut=!1,Nn=j[XG]||{},xe=(B={method:Hpe,body:ae},B[fpe]=!0,B);j.headers&&ls(j.headers)[It]>0&&(Ce(ls(Nn),function(me){te.append(me,Nn[me])}),xe[XG]=te),b&&s&&(xe.credentials="include"),A&&(xe.keepalive=!0,e+=Ie,s?j._sendReason===2&&(Xe=!0,m&&(U+=hBe)):Xe=!0);var mt=new Request(U,xe);try{mt[fpe]=!0}catch{}if(!A&&t&&(Y=ac(function(me,Ne){X=me,Se=Ne})),!U){I(D),X&&X(!1);return}function G(me){w(D,s?0:400,{},s?km:me)}function de(me,Ne,Ee){var St=me[wI],Ft=a.fetchOnComplete;Ft&&At(Ft)?Ft(me,D,Ee||km,Ne):w(D,St,{},Ee||km)}try{Gb(fetch(s?U:mt,s?xe:null),function(me){if(A&&(e-=Ie,Ie=0),!Ut)if(Ut=!0,me.rejected)G(me.reason&&me.reason[bm]),Se&&Se(me.reason);else{var Ne=me.value;try{!s&&!Ne.ok?(G(Ne.statusText),X&&X(!1)):s&&!Ne.body?(de(Ne,null,km),X&&X(!0)):Gb(Ne.text(),function(Ee){de(Ne,j,Ee.value),X&&X(!0)})}catch(Ee){G(rt(Ee)),Se&&Se(Ee)}}})}catch(me){Ut||(G(rt(me)),Se&&Se(me))}return Xe&&!Ut&&(Ut=!0,w(D,200,{}),X&&X(!0)),s&&!Ut&&j[RI]>0&&h&&h.set(function(){Ut||(Ut=!0,w(D,500,{}),X&&X(!0))},j[RI]),Y}function K(j,D,A){var B=Hi(),U=new XDomainRequest,W=j[Hb];U.onload=function(){var te=xp(U),Ie=a&&a.xdrOnComplete;Ie&&At(Ie)?Ie(U,D,j):w(D,200,{},te)},U.onerror=function(){w(D,400,{},s?km:OI(U))},U.ontimeout=function(){w(D,500,{})},U.onprogress=function(){};var ae=B&&B.location&&B.location[KG]||"",Y=j[QP];if(!Y){I(D);return}if(!s&&Y.lastIndexOf(ae,0)!==0){var X="Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol.";ze(o,2,40,". "+X),x(X,D);return}var Se=s?Y:Y[vp](/^(https?:)/,"");U.open(Hpe,Se),j[RI]&&(U[RI]=j[RI]),U.send(W),s&&A?h&&h.set(function(){U.send(W)},0):U.send(W)}function $(){e=0,r=!1,t=!1,o=null,s=null,a=null,c=null,l=null,u=!1,d=!1,p=!1,f=!1,m=!1,h=null}})}return n.__ieDyn=1,n}()});function xBe(n){return n&&n[vp]?n[vp](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,Kt):n}function Lz(n,e){var t;if(e){var r=Kt;bt(e)?(r=Kt,Ce(e,function(s){s=xBe(s),s&&(s[0]!=="."&&(s="."+s),r+=s)})):r=xBe(e),r&&(r[0]!=="."&&(r="."+r),n=(n||Kt)+r)}var o=lRt.exec(n||Kt)||[];return t={},t[il]=o[1],t.ns=(o[2]||Kt).replace(sRt,".").replace(aRt,Kt)[sd](".").sort().join("."),t}function Vpe(n,e,t){var r=[],o=y3.get(n,Dz,{},!1),s=Lz(e,t);return at(o,function(a,c){Ce(c,function(l){var u;(!s[il]||s[il]===l.evtName[il])&&(!s.ns||s.ns===s.ns)&&r[Dn]((u={},u[Na]=l.evtName[il]+(l.evtName.ns?"."+l.evtName.ns:Kt),u.handler=l[qM],u))})}),r}function RBe(n,e,t){t===void 0&&(t=!0);var r=y3.get(n,Dz,{},t),o=r[e];return o||(o=r[e]=[]),o}function PBe(n,e,t,r){n&&e&&e[il]&&(n[_Be]?n[_Be](e[il],t,r):n[bBe]&&n[bBe](IBe+e[il],t))}function uRt(n,e,t,r){var o=!1;return n&&e&&e[il]&&t&&(n[yBe]?(n[yBe](e[il],t,r),o=!0):n[vBe]&&(n[vBe](IBe+e[il],t),o=!0)),o}function SBe(n,e,t,r){for(var o=e[It];o--;){var s=e[o];s&&(!t.ns||t.ns===s.evtName.ns)&&(!r||r(s))&&(PBe(n,s.evtName,s[qM],s.capture),e[gm](o,1))}}function dRt(n,e,t){if(e[il])SBe(n,RBe(n,e[il]),e,t);else{var r=y3.get(n,Dz,{});at(r,function(o,s){SBe(n,s,e,t)}),ls(r)[It]===0&&y3.kill(n,Dz)}}function $l(n,e){var t;return e?(bt(e)?t=[n].concat(e):t=[n,e],t=Lz("xx",t).ns[sd](".")):t=n,t}function Rm(n,e,t,r,o){var s;o===void 0&&(o=!1);var a=!1;if(n)try{var c=Lz(e,r);if(a=uRt(n,c,t,o),a&&y3.accept(n)){var l=(s={guid:cRt++,evtName:c},s[qM]=t,s.capture=o,s);RBe(n,c.type)[Dn](l)}}catch{}return a}function Gg(n,e,t,r,o){if(o===void 0&&(o=!1),n)try{var s=Lz(e,r),a=!1;dRt(n,s,function(c){return s.ns&&!t||c[qM]===t?(a=!0,!0):!1}),a||PBe(n,s,t,o)}catch{}}function Gpe(n,e,t,r){return r===void 0&&(r=!1),Rm(n,e,t,null,r)}function zpe(n,e,t,r){r===void 0&&(r=!1),Gg(n,e,t,null,r)}function Oz(n,e,t){var r=!1,o=Hi();o&&(r=Rm(o,n,e,t),r=Rm(o.body,n,e,t)||r);var s=ji();return s&&(r=Rm(s,n,e,t)||r),r}function Mz(n,e,t){var r=Hi();r&&(Gg(r,n,e,t),Gg(r.body,n,e,t));var o=ji();o&&Gg(o,n,e,t)}function bA(n,e,t,r){var o=!1;return e&&n&&n[It]>0&&Ce(n,function(s){s&&(!t||er(t,s)===-1)&&(o=Oz(s,e,r)||o)}),o}function Fz(n,e,t,r){var o=!1;return e&&n&&bt(n)&&(o=bA(n,e,t,r),!o&&t&&t[It]>0&&(o=bA(n,e,null,r))),o}function i_(n,e,t){n&&bt(n)&&Ce(n,function(r){r&&Mz(r,e,t)})}function b3(n,e,t){return Fz([EBe,CBe,Nz],n,e,t)}function _3(n,e){i_([EBe,CBe,Nz],n,e)}function _A(n,e,t){function r(a){var c=ji();n&&c&&c.visibilityState==="hidden"&&n(a)}var o=$l(wBe,t),s=bA([Nz],n,e,o);return(!e||er(e,v3)===-1)&&(s=bA([v3],r,e,o)||s),!s&&e&&(s=_A(n,null,t)),s}function x3(n,e){var t=$l(wBe,e);i_([Nz],n,t),i_([v3],null,t)}function xA(n,e,t){function r(a){var c=ji();n&&c&&c.visibilityState==="visible"&&n(a)}var o=$l(kBe,t),s=bA([TBe],n,e,o);return s=bA([v3],r,e,o)||s,!s&&e&&(s=xA(n,null,t)),s}function S3(n,e){var t=$l(kBe,e);i_([TBe],n,t),i_([v3],null,t)}var IBe,vBe,yBe,bBe,_Be,Dz,v3,Nz,TBe,CBe,EBe,wBe,kBe,sRt,aRt,cRt,y3,lRt,ABe=N(()=>{Mt();Vr();pA();Go();IBe="on",vBe="attachEvent",yBe="addEventListener",bBe="detachEvent",_Be="removeEventListener",Dz="events",v3="visibilitychange",Nz="pagehide",TBe="pageshow",CBe="unload",EBe="beforeunload",wBe=ua("aiEvtPageHide"),kBe=ua("aiEvtPageShow"),sRt=/\.[\.]+/g,aRt=/[\.]+$/,cRt=1,y3=fz("events"),lRt=/^([^.]*)(?:\.(.+)|)/});var $pe,DBe=N(()=>{GG();$pe=Vo({DISABLED:0,CRITICAL:1,WARNING:2,DEBUG:3})});var gr=N(()=>{t7e();n7e();mBe();Bpe();pz();Rpe();ppe();Sm();gBe();Mt();GG();ABe();Yb();Zc();Cpe();Cz();_p();Rz();DBe();Tpe();pA();Pz();Dpe();Xb();vz();gpe()});var Pm,NBe,Wpe,Uz,Bz=N(()=>{Pm="",NBe="https://browser.events.data.microsoft.com/OneCollector/1.0/",Wpe="version",Uz="properties"});var Kpe,Ype,SA,Am,Qpe,Ii,VI,zg,qz,jz,Hz,Vz,I3,Gz=N(()=>{Kpe="initialize",Ype="logger",SA="indexOf",Am="timings",Qpe="pollInternalLogs",Ii="value",VI="kind",zg="length",qz="processTelemetryStart",jz="handleField",Hz="rmSanitizer",Vz="rmFieldSanitizer",I3="canHandle"});function Us(n){return!(n===Pm||Pe(n))}function zz(n){if(n){var e=sc(n,"-");if(e>-1)return Pb(n,e)}return Pm}function UBe(){return Xpe===null&&(Xpe=!Wt(Uint8Array)&&!gRt()&&!Wb()),Xpe}function $z(n){return!!(n&&Pa(n)&&n>=1&&n<=4)}function Wz(n,e,t){if(!e&&!Us(e)||typeof n!="string")return null;var r=typeof e;if(r==="string"||r==="number"||r==="boolean"||bt(e))e={value:e};else if(r==="object"&&!OBe.call(e,"value"))e={value:t?JSON.stringify(e):e};else if(Pe(e[Ii])||e[Ii]===Pm||!Jt(e[Ii])&&!Pa(e[Ii])&&!lp(e[Ii])&&!bt(e[Ii]))return null;if(bt(e[Ii])&&!Zpe(e[Ii]))return null;if(!Pe(e[VI])){if(bt(e[Ii])||!T3(e[VI]))return null;e[Ii]=e[Ii].toString()}return e}function TA(n,e,t){var r=-1;if(!Wt(n))if(e>0&&(e===32?r=8192:e<=13&&(r=e<<5)),hRt(t))r===-1&&(r=0),r|=t;else{var o=mRt[Dm(n)]||-1;r!==-1&&o!==-1?r|=o:o===6&&(r=o)}return r}function BBe(n,e,t){t===void 0&&(t=!0);var r;return n&&(r=n.get(e),t&&r&&decodeURIComponent&&(r=decodeURIComponent(r))),r||Pm}function qBe(n){n===void 0&&(n="D");var e=d3();return n==="B"?e="{"+e+"}":n==="P"?e="("+e+")":n==="N"&&(e=e.replace(/-/g,Pm)),e}function GI(n,e,t,r,o){var s={},a=!1,c=0,l=arguments[zg],u=arguments;for(lp(u[0])&&(a=u[0],c++);c<l;c++){var n=u[c];at(n,function(p,f){a&&f&&Zr(f)?bt(f)?(s[p]=s[p]||[],Ce(f,function(m,h){m&&Zr(m)?s[p][h]=GI(!0,s[p][h],m):s[p][h]=m})):s[p]=GI(!0,s[p],f):s[p]=f})}return s}function T3(n){return n===0||n>0&&n<=13||n===32}function hRt(n){return n>=0&&n<=9}function gRt(){var n=Ho();if(!Wt(n)&&n.userAgent){var e=n.userAgent.toLowerCase();if((e[SA]("safari")>=0||e[SA]("firefox")>=0)&&e[SA]("chrome")<0)return!0}return!1}function Zpe(n){return n[zg]>0}function C3(n,e){var t=n;t[Am]=t[Am]||{},t[Am][qz]=t[Am][qz]||{},t[Am][qz][e]=al()}function Dm(n){var e=0;if(n!=null){var t=typeof n;t==="string"?e=1:t==="number"?e=2:t==="boolean"?e=3:t===xg&&(e=4,bt(n)?(e=4096,n[zg]>0&&(e|=Dm(n[0]))):OBe.call(n,"value")&&(e=8192|Dm(n[Ii])))}return e}function Kz(){return!!Sr("chrome")}function jBe(n,e,t,r,o,s){r===void 0&&(r=!1),o===void 0&&(o=!1);function a(l,u,d){try{l[u]=d}catch{}}var c=new XMLHttpRequest;return r&&a(c,pRt,r),t&&a(c,LBe,t),c.open(n,e,!o),t&&a(c,LBe,t),!o&&s&&a(c,fRt,s),c}function o_(n){return n>0}var $g,Jpe,IA,OBe,pRt,LBe,fRt,mRt,Xpe,MBe,FBe,al,Yz=N(()=>{gr();Zc();Mt();Bz();Gz();Jpe="4.1.1",IA="1DS-Web-JS-"+Jpe,OBe=IM.hasOwnProperty,pRt="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",LBe="withCredentials",fRt="timeout",mRt=($g={},$g[0]=0,$g[2]=6,$g[1]=1,$g[3]=7,$g[4098]=6,$g[4097]=1,$g[4099]=7,$g),Xpe=null,MBe=Ab(),FBe=Db();al=VP});function yRt(n){return n&&(!n.getProperty||!n.setProperty)&&qi("Invalid property storage override passed."),!0}var vRt,HBe,VBe=N(()=>{Zc();Fs();gr();Mt();Bz();Yz();Gz();vRt=oc({endpointUrl:NBe,propertyStorageOverride:{isVal:yRt}});HBe=function(n){Jc(e,n);function e(){var t=n.call(this)||this;return wn(e,t,function(r,o){r[Kpe]=function(s,a,c,l){uo(r,function(){return"AppInsightsCore.initialize"},function(){try{o[Kpe](Si(s,vRt,c||r[Ype],!1).cfg,a,c,l)}catch(p){var u=r[Ype],d=rt(p);d[SA]("channels")!==-1&&(d+=`
 - Channels must be provided through config.channels only!`),ze(u,1,514,"SDK Initialization Failed - no telemetry will be sent: "+d)}},function(){return{config:s,extensions:a,logger:c,notificationManager:l}})},r.track=function(s){uo(r,function(){return"AppInsightsCore.track"},function(){var a=s;if(a){a[Am]=a[Am]||{},a[Am].trackStart=al(),$z(a.latency)||(a.latency=1);var c=a.ext=a.ext||{};c.sdk=c.sdk||{},c.sdk.ver=IA;var l=a.baseData=a.baseData||{};l[Uz]=l[Uz]||{};var u=l[Uz];u[Wpe]=u[Wpe]||r.pluginVersionString||Pm}o.track(a)},function(){return{item:s}},!s.sync)},r[Qpe]=function(s){return o[Qpe](s||"InternalLog")}}),t}return e.__ieDyn=1,e}(Vg)});var GBe,zBe,$Be,WBe,KBe,YBe=N(()=>{gr();GBe=Vo({NotSet:0,Pii_DistinguishedName:1,Pii_GenericData:2,Pii_IPV4Address:3,Pii_IPv6Address:4,Pii_MailSubject:5,Pii_PhoneNumber:6,Pii_QueryString:7,Pii_SipAddress:8,Pii_SmtpAddress:9,Pii_Identity:10,Pii_Uri:11,Pii_Fqdn:12,Pii_IPV4AddressLegacy:13,Pii_IPv6ScrubLastHextets:14,Pii_DropValue:15,CustomerContent_GenericContent:32}),zBe=Vo({Normal:1,CostDeferred:2,RealTime:3,Immediate:4}),$Be=Vo({Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9}),WBe=Vo({Normal:1,Critical:2}),KBe=Vo({NONE:0,ERROR:1,WARNING:2,INFORMATION:3})});var QBe,XBe=N(()=>{gr();Mt();Bz();Yz();Gz();QBe=function(){function n(e){var t=this,r={},o=[],s=[];e&&s.push(e);function a(d,p){var f,m=r[d];if(m&&(f=m[p]),!f&&f!==null){if(Jt(d)&&Jt(p))if(s[zg]>0){for(var h=0;h<s[zg];h++)if(s[h][jz](d,p)){f={canHandle:!0,fieldHandler:s[h]};break}}else o[zg]===0&&(f={canHandle:!0});if(!f&&f!==null){f=null;for(var h=0;h<o[zg];h++)if(o[h][jz](d,p)){f={canHandle:!0,handler:o[h],fieldHandler:null};break}}m||(m=r[d]={}),m[p]=f}return f}t.clearCache=function(){r={}},t.addSanitizer=function(d){d&&(AG(o,d)||o.push(d),r={})},t.addFieldSanitizer=function(d){d&&(AG(s,d)||s.push(d),r={})},t[Hz]=function(d){if(d){var p=er(o,d);p!==-1&&(o.splice(p,1),r={}),Ce(o,function(f){f&&f[Hz]&&f[Hz](d)})}},t[Vz]=function(d){if(d){var p=er(s,d);p!==-1&&(s.splice(p,1),r={}),Ce(o,function(f){f&&f[Vz]&&f[Vz](d)})}},t.isEmpty=function(){return HP(o)+HP(s)===0},t[jz]=function(d,p){var f=a(d,p);return f?f[I3]:!1},t[Ii]=function(d,p,f,m){var h=a(d,p);if(h&&h[I3]){if(!h||!h[I3])return null;if(h.handler)return h.handler[Ii](d,p,f,m);if(!Jt(p)||Pe(f)||f===Pm)return null;var g=null,y=Dm(f);if((y&8192)===8192){var b=y&-8193;if(g=f,!Us(g[Ii])||b!==1&&b!==2&&b!==3&&(b&4096)!==4096)return null}else y===1||y===2||y===3||(y&4096)===4096?g=l(d,p,f):y===4&&(g=l(d,p,m?JSON.stringify(f):f));if(g)return c(h,d,p,y,g,m)}return null},t.property=function(d,p,f,m){var h=a(d,p);if(!h||!h[I3]||!Jt(p)||Pe(f)||!Us(f[Ii]))return null;var g=Dm(f[Ii]);return g===0?null:c(h,d,p,g,f,m)};function c(d,p,f,m,h,g){if(d.handler)return d.handler.property(p,f,h,g);if(!Pe(h[VI])){if((m&4096)===4096||!T3(h[VI]))return null;h[Ii]=h[Ii].toString()}return u(d.fieldHandler,p,f,m,h)}function l(d,p,f){return Us(f)?{value:f}:null}function u(d,p,f,m,h){if(h&&d){var g=d.getSanitizer(p,f,m,h[VI],h.propertyType);if(g)if(m===4){var y={},b=h[Ii];at(b,function(x,I){var S=p+"."+f;if(Us(I)){var w=l(S,x,I);w=u(d,S,x,Dm(I),w),w&&(y[x]=w[Ii])}}),h[Ii]=y}else{var _={path:p,name:f,type:m,prop:h,sanitizer:t};h=g.call(t,_)}}return h}}return n.getFieldType=Dm,n}()});var JBe={};Dr(JBe,{AppInsightsCore:()=>HBe,BaseTelemetryPlugin:()=>Hg,DiagnosticLogger:()=>Qb,EventLatency:()=>zBe,EventPersistence:()=>WBe,EventPropertyType:()=>$Be,EventsDiscardedReason:()=>mp,FullVersionString:()=>IA,InternalAppInsightsCore:()=>Vg,LoggingSeverity:()=>$pe,MinChannelPriorty:()=>Ide,NotificationManager:()=>c3,PerfEvent:()=>UI,PerfManager:()=>u3,ProcessTelemetryContext:()=>Mpe,SenderPostManager:()=>HI,TraceLevel:()=>KBe,Undefined:()=>fm,ValueKind:()=>GBe,ValueSanitizer:()=>QBe,Version:()=>Jpe,_InternalLogMessage:()=>NI,__getRegisteredEvents:()=>Vpe,_appendHeader:()=>dA,_getAllResponseHeaders:()=>Mg,_logInternalMessage:()=>ipe,_throwInternal:()=>ze,_warnToConsole:()=>cc,addEventHandler:()=>Oz,addEventListeners:()=>Fz,addPageHideEventListener:()=>_A,addPageShowEventListener:()=>xA,addPageUnloadEventListener:()=>b3,areCookiesSupported:()=>hA,arrForEach:()=>Ce,arrIndexOf:()=>er,arrMap:()=>hm,arrReduce:()=>jP,attachEvent:()=>Gpe,blockDynamicConversion:()=>r3,convertAllHeadersToMap:()=>dz,cookieAvailable:()=>hA,createCookieMgr:()=>Bg,createDynamicConfig:()=>Si,createEnumStyle:()=>Vo,createGuid:()=>qBe,createProcessTelemetryContext:()=>lc,createTraceParent:()=>p3,createUniqueNamespace:()=>ua,createUnloadHandlerContainer:()=>jI,dateNow:()=>Vi,detachEvent:()=>zpe,disallowsSameSiteNone:()=>Tz,doPerf:()=>uo,dumpObj:()=>rt,eventOff:()=>Gg,eventOn:()=>Rm,extend:()=>GI,findW3cTraceParent:()=>h3,forceDynamicConversion:()=>dpe,formatErrorMessageXdr:()=>OI,formatErrorMessageXhr:()=>Lg,formatTraceParent:()=>m3,generateW3CId:()=>BI,getCommonSchemaMetaData:()=>TA,getConsole:()=>zM,getCookieValue:()=>BBe,getCrypto:()=>$M,getDocument:()=>ji,getDynamicConfigHandler:()=>n3,getExceptionName:()=>ei,getFieldValueType:()=>Dm,getGlobal:()=>Aa,getGlobalInst:()=>Sr,getHistory:()=>DM,getIEVersion:()=>KM,getISOString:()=>Gl,getJSON:()=>la,getLocation:()=>DI,getMsCrypto:()=>WM,getNavigator:()=>Ho,getPerformance:()=>wg,getResponseText:()=>xp,getSetValue:()=>QM,getTenantId:()=>zz,getTime:()=>al,getWindow:()=>Hi,hasDocument:()=>Ab,hasHistory:()=>CG,hasJSON:()=>xm,hasNavigator:()=>qP,hasOwnProperty:()=>xo,hasWindow:()=>Db,isArray:()=>bt,isArrayValid:()=>Zpe,isBeaconsSupported:()=>sl,isBoolean:()=>lp,isChromium:()=>Kz,isDate:()=>MP,isDocumentObjectAvailable:()=>MBe,isError:()=>Cb,isFetchSupported:()=>Dg,isFunction:()=>At,isGreaterThanZero:()=>o_,isIE:()=>Kb,isLatency:()=>$z,isNotTruthy:()=>pG,isNullOrUndefined:()=>Pe,isNumber:()=>Pa,isObject:()=>Zr,isReactNative:()=>Wb,isSampledFlag:()=>f3,isString:()=>Jt,isTruthy:()=>Zu,isTypeof:()=>uG,isUint8ArrayAvailable:()=>UBe,isUndefined:()=>Wt,isValidSpanId:()=>wm,isValidTraceId:()=>Em,isValidTraceParent:()=>vA,isValueAssigned:()=>Us,isValueKind:()=>T3,isWindowObjectAvailable:()=>FBe,isXhrSupported:()=>lA,mergeEvtNamespace:()=>$l,newGuid:()=>d3,newId:()=>e3,normalizeJsName:()=>LI,objDefineAccessors:()=>TG,objForEachKey:()=>at,objFreeze:()=>mm,objKeys:()=>ls,objSeal:()=>gG,onConfigChange:()=>zo,openXhr:()=>jBe,optimizeObject:()=>cd,parseResponse:()=>MI,parseTraceParent:()=>qI,perfNow:()=>VP,prependTransports:()=>Og,proxyAssign:()=>ope,proxyFunctionAs:()=>Ng,proxyFunctions:()=>zl,random32:()=>Fg,randomValue:()=>ZM,removeEventHandler:()=>Mz,removeEventListeners:()=>i_,removePageHideEventListener:()=>x3,removePageShowEventListener:()=>S3,removePageUnloadEventListener:()=>_3,safeGetCookieMgr:()=>Ipe,safeGetLogger:()=>bp,sanitizeProperty:()=>Wz,setEnableEnvMocks:()=>Zde,setProcessTelemetryTimings:()=>C3,setValue:()=>ad,strContains:()=>So,strEndsWith:()=>Lb,strFunction:()=>PP,strObject:()=>xg,strPrototype:()=>cp,strStartsWith:()=>_I,strTrim:()=>sr,strUndefined:()=>fm,throwError:()=>qi,toISOString:()=>Gl,useXDomainRequest:()=>YM});var zI=N(()=>{VBe();YBe();XBe();gr();Yz()});var $I,Qz,Xz,efe=N(()=>{$I="REAL_TIME",Qz="NEAR_REAL_TIME",Xz="BEST_EFFORT"});var Sp,Jz,ZBe,tfe,eqe,tqe,nqe,nfe,rfe,Zz,rqe,iqe,oqe,e$,ife,t$,n$,r$,E3,ofe,sfe,sqe,CA,afe,i$,w3=N(()=>{Sp="",Jz="drop",ZBe="send",tfe="requeue",eqe="rspFail",tqe="oth",nqe="no-cache, no-store",nfe="application/x-json-stream",rfe="cache-control",Zz="content-type",rqe="kill-tokens",iqe="kill-duration",oqe="time-delta-millis",e$="client-version",ife="client-id",t$="time-delta-to-apply-millis",n$="upload-time",r$="apikey",E3="AuthMsaDeviceTicket",ofe="WebAuthToken",sfe="AuthXToken",sqe="NoResponseBody",CA="msfpc",afe="trace",i$="user"});var k3,o$,s$,a$,R3,_n,Nm,ud,Io,Lm,Bs,Om,WI,c$,s_,l$,KI,u$,d$,aqe,cfe,lfe,cqe,lqe,p$,ufe,dfe,uqe,dqe,pfe,ffe,pqe,f$,m$,mfe,YI,EA,hfe,La,cl,P3,A3,wA,h$,D3,fqe,g$,v$,kA,gfe,N3,y$,b$,RA,_$,x$,S$,L3,mqe,hqe,vfe,yfe,gqe,vqe,yqe,I$,O3,a_,QI,PA=N(()=>{k3="allowRequestSending",o$="firstRequestSent",s$="shouldAddClockSkewHeaders",a$="getClockSkewHeaderValue",R3="setClockSkew",_n="length",Nm="concat",ud="iKey",Io="count",Lm="events",Bs="push",Om="split",WI="splice",c$="toLowerCase",s_="hdrs",l$="useHdrs",KI="initialize",u$="setTimeoutOverride",d$="clearTimeoutOverride",aqe="payloadPreprocessor",cfe="overrideEndpointUrl",lfe="avoidOptions",cqe="disableEventTimings",lqe="stringifyObjects",p$="enableCompoundKey",ufe="disableXhrSync",dfe="disableFetchKeepAlive",uqe="addNoResponse",dqe="excludeCsMetaData",pfe="useSendBeacon",ffe="alwaysUseXhrOverride",pqe="unloadTransports",f$="serializeOfflineEvt",m$="getOfflineRequestDetails",mfe="createPayload",YI="headers",EA="_thePayload",hfe="urlString",La="batches",cl="sendType",P3="addHeader",A3="canSendRequest",wA="sendQueuedRequests",h$="isCompletelyIdle",D3="setUnloading",fqe="isTenantKilled",g$="sendSynchronousBatch",v$="_transport",kA="getWParam",gfe="isBeacon",N3="timings",y$="isTeardown",b$="isSync",RA="data",_$="_sendReason",x$="setKillSwitchTenants",S$="_backOffTransmission",L3="identifier",mqe="disableOptimizeObj",hqe="ignoreMc1Ms0CookieProcessing",vfe="eventsLimitInMem",yfe="autoFlushEventsLimit",gqe="disableAutoBatchFlushLimit",vqe="overrideInstrumentationKey",yqe="disableTelemetry",I$="baseData",O3="sendAttempt",a_="latency",QI="sync"});function _qe(n){var e=(n.ext||{}).intweb;return e&&Us(e[CA])?e[CA]:null}function bqe(n){for(var e=null,t=0;e===null&&t<n[_n];t++)e=_qe(n[t]);return e}var AA,bfe=N(()=>{zI();w3();PA();AA=function(){function n(e,t){var r=t?[][Nm](t):[],o=this,s=bqe(r);o[ud]=function(){return e},o.Msfpc=function(){return s||Sp},o[Io]=function(){return r[_n]},o[Lm]=function(){return r},o.addEvent=function(a){return a?(r[Bs](a),s||(s=_qe(a)),!0):!1},o[Om]=function(a,c){var l;if(a<r[_n]){var u=r[_n]-a;Pe(c)||(u=c<u?c:u),l=r[WI](a,u),s=bqe(r)}return new n(e,l)}}return n.create=function(e,t){return new n(e,t)},n}()});var xqe,Sqe=N(()=>{Fs();PA();xqe=function(){function n(){var e=!0,t=!0,r=!0,o="use-collector-delta",s=!1;wn(n,this,function(a){a[k3]=function(){return e},a[o$]=function(){r&&(r=!1,s||(e=!1))},a[s$]=function(){return t},a[a$]=function(){return o},a[R3]=function(c){s||(c?(o=c,t=!0,s=!0):t=!1,e=!0)}})}return n.__ieDyn=1,n}()});var bRt,Iqe,Tqe=N(()=>{Fs();zI();PA();bRt=1e3,Iqe=function(){function n(){var e={};function t(r){var o=[];return r&&Ce(r,function(s){o[Bs](sr(s))}),o}wn(n,this,function(r){r[x$]=function(o,s){if(o&&s)try{var a=t(o[Om](","));if(s==="this-request-only")return a;for(var c=parseInt(s,10)*bRt,l=0;l<a[_n];++l)e[a[l]]=Vi()+c}catch{return[]}return[]},r[fqe]=function(o){var s=e,a=sr(o);return s[a]!==void 0&&s[a]>Vi()?!0:(delete s[a],!1)}})}return n.__ieDyn=1,n}()});function Eqe(n){return!(n>=300&&n<500&&n!=429||n==501||n==505)}function T$(n){var e=0,t=Cqe*_Rt,r=Cqe*xRt,o=Math.floor(Math.random()*(r-t))+t;return e=Math.pow(2,n)*o,Math.min(e,SRt)}var _Rt,xRt,Cqe,SRt,_fe=N(()=>{_Rt=.8,xRt=1.2,Cqe=3e3,SRt=6e5});function wRt(n,e,t,r,o){if(o&&e){var s=n(o.value,o.kind,o.propertyType);if(s>-1){var a=e[wqe];a||(a=e[wqe]={f:{}});var c=a[C$];if(c||(c=a[C$]={}),t)for(var l=0;l<t.length;l++){var u=t[l];c[u]||(c[u]={f:{}});var d=c[u][C$];d||(d=c[u][C$]={}),c=d}c=c[r]={},bt(o.value)?c.a={t:s}:c.t=s}}}var IRt,TRt,kqe,Rqe,CRt,wqe,C$,ERt,Pqe,Aqe=N(()=>{Fs();zI();bfe();w3();Mt();IRt=20,TRt=3984588,kqe=65e3,Rqe=2e6,CRt=Math.min(Rqe,kqe),wqe="metadata",C$="f",ERt=/\./,Pqe=function(){function n(e,t,r,o,s,a){var c="data",l="baseData",u="ext",d=!!o,p=!0,f=t,m={},h=!!a,g=s||TA;wn(n,this,function(y){y.createPayload=function(x,I,S,w,R,k){return{apiKeys:[],payloadBlob:Sp,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:x,isTeardown:I,isSync:S,isBeacon:w,sendType:k,sendReason:R}},y.appendPayload=function(x,I,S){var w=x&&I&&!x.overflow;return w&&uo(e,function(){return"Serializer:appendPayload"},function(){for(var R=I.events(),k=x.payloadBlob,V=x.numEvents,F=!1,K=[],$=[],j=x.isBeacon,D=j?kqe:TRt,A=j?CRt:Rqe,B=0,U=0;B<R.length;){var W=R[B];if(W){if(V>=S){x.overflow=I.split(B);break}var ae=y.getEventBlob(W);if(ae&&ae.length<=A){var Y=ae.length,X=k.length;if(X+Y>D){x.overflow=I.split(B);break}k&&(k+=`
`),k+=ae,U++,U>IRt&&(dp(k,0,1),U=0),F=!0,V++}else ae?K.push(W):$.push(W),R.splice(B,1),B--}B++}if(K.length>0&&x.sizeExceed.push(AA.create(I.iKey(),K)),$.length>0&&x.failedEvts.push(AA.create(I.iKey(),$)),F){x.batches.push(I),x.payloadBlob=k,x.numEvents=V;var Se=I.iKey();er(x.apiKeys,Se)===-1&&x.apiKeys.push(Se)}},function(){return{payload:x,theBatch:{iKey:I.iKey(),evts:I.events()},max:S}}),w},y.getEventBlob=function(x){try{return uo(e,function(){return"Serializer.getEventBlob"},function(){var I={};I.name=x.name,I.time=x.time,I.ver=x.ver,I.iKey="o:"+zz(x.iKey);var S={},w;h||(w=function(F,K,$){wRt(g,S,F,K,$)});var R=x[u];R&&(I[u]=S,at(R,function(F,K){var $=S[F]={};_(K,$,"ext."+F,!0,null,null,!0)}));var k=I[c]={};k.baseType=x.baseType;var V=k[l]={};return _(x.baseData,V,l,!1,[l],w,p),_(x.data,k,c,!1,[],w,p),JSON.stringify(I)},function(){return{item:x}})}catch{return null}};function b(x,I){var S=m[x];return S===void 0&&(x.length>=7&&(S=_I(x,"ext.metadata")||_I(x,"ext.web")),m[x]=S),S}function _(x,I,S,w,R,k,V){at(x,function(F,K){var $=null;if(K||Us(K)){var j=S,D=F,A=R,B=I;if(d&&!w&&ERt.test(F)){var U=F.split("."),W=U.length;if(W>1){A&&(A=A.slice());for(var ae=0;ae<W-1;ae++){var Y=U[ae];B=B[Y]=B[Y]||{},j+="."+Y,A&&A.push(Y)}D=U[W-1]}}var X=w&&b(j,D);if(!X&&f&&f.handleField(j,D)?$=f.value(j,D,K,r):$=Wz(D,K,r),$){var Se=$.value;if(B[D]=Se,k&&k(A,D,$),V&&typeof Se=="object"&&!bt(Se)){var te=A;te&&(te=te.slice(),te.push(D)),_(K,Se,j+"."+D,w,te,k,V)}}}})}})}return n.__ieDyn=1,n}()});function DA(n,e){return{set:function(t,r){for(var o=[],s=2;s<arguments.length;s++)o[s-2]=arguments[s];return lde([n,e],t,r,o)}}}var xfe=N(()=>{Mt()});function JI(n,e,t){Ife[n]=e,t!==!1&&(Tfe[e]=n)}function Dqe(n,e){var t=!1;if(n&&e){var r=ls(n);if(r&&r[_n]>0)for(var o=e[c$](),s=0;s<r[_n];s++){var a=r[s];if(a&&xo(e,a)&&a[c$]()===o){t=!0;break}}}return t}function NA(n,e,t,r){e&&t&&t[_n]>0&&(r&&Ife[e]?(n[s_][Ife[e]]=t,n[l$]=!0):n.url+="&"+e+"="+t)}function ARt(n,e,t){for(var r=0;r<n[_n];r++)if(n[r].name===e){n[r].value=t;return}n[Bs]({name:e,value:t})}function DRt(n,e){for(var t=0;t<n[_n];t++)if(n[t].name===e){n[WI](t,1);return}}var XI,Sfe,kRt,RRt,PRt,Ife,Tfe,Nqe,Lqe=N(()=>{Fs();zI();Mt();Sqe();w3();Tqe();_fe();Aqe();xfe();PA();Sfe="sendAttempt",kRt="&"+sqe+"=true",RRt="?cors=true&"+Zz[c$]()+"="+nfe,PRt=(XI={},XI[1]=tfe,XI[100]=tfe,XI[200]="sent",XI[8004]=Jz,XI[8003]=Jz,XI),Ife={},Tfe={};JI(E3,E3,!1);JI(e$,e$);JI(ife,"Client-Id");JI(r$,r$);JI(t$,t$);JI(n$,n$);JI(sfe,sfe);Nqe=function(){function n(e,t,r,o){var s,a,c,l,u=!1,d,p,f,m,h,g,y,b,_,x,I,S,w,R,k,V,F,K,$,j,D,A,B,U,W,ae,Y;wn(n,this,function(X){Ut();var Se=!0;X[KI]=function(ne,Ue,Ye){U||(h=Ue,S=Ue.getCookieMgr(),p=Ye,f=p.diagLog(),nd(j,zo(ne,function(wt){var J,ue=wt.cfg,ve=wt.cfg.extensionConfig[Ye.identifier];W=DA(ve[u$],ve[d$]),Us(ue.anonCookieName)?ARt(y,"anoncknm",ue.anonCookieName):DRt(y,"anoncknm"),D=ve[aqe],A=ve.payloadListener;var Re=ve.httpXHROverride,Q=ve[cfe]?ve[cfe]:ue.endpointUrl;s=Q+RRt,R=Wt(ve[lfe])?!0:!ve[lfe],I=!ve[cqe];var ie=ve.valueSanitizer,pe=ve[lqe],Ae=!!ue[p$];Wt(ve[p$])||(Ae=!!ve[p$]),k=ve.xhrTimeout,V=!!ve[ufe],F=!!ve[dfe],$=ve[uqe]!==!1,ae=!!ve[dqe],Ue.getPlugin("LocalStorage")&&(F=!0),u=!Wb(),x=new Pqe(h,ie,pe,Ae,TA,ae),Pe(ve[pfe])||(u=!!ve[pfe]);var ut=Ie();Y?Y.SetConfig(ut):(Y=new HI,Y[KI](ut,f));var je=Re,Bn=ve[ffe]?Re:null,Yn=ve[ffe]?Re:null,Co=[3,2];if(!Re){g=!1;var ul=[];Wb()?(ul=[2,1],Co=[2,1,3]):ul=[1,2,3],ul=Og(ul,ve.transports),Re=te(ul,!1),Re||cc(f,"No available transport to send events"),je=te(ul,!0)}Bn||(Co=Og(Co,ve[pqe]),Bn=te(Co,!0)),K=!g&&(u&&sl()||!F&&Dg(!0)),m=(J={},J[0]=Re,J[1]=je||te([1,2,3],!0),J[2]=Bn||je||te([1],!0),J[3]=Yn||te([2,3],!0)||je||te([1],!0),J)})),U=!0)},X.addResponseHandler=function(ne){return B[Bs](ne),{rm:function(){var Ue=B.indexOf(ne);Ue>=0&&B[WI](Ue,1)}}},X[f$]=function(ne){try{if(x)return x.getEventBlob(ne)}catch{}return Sp},X[m$]=function(){try{var ne=x&&x[mfe](0,!1,!1,!1,1,0);return Gr(ne,R)}catch{}return null};function te(ne,Ue){try{return Y&&Y.getSenderInst(ne,Ue)}catch{}return null}X._getDbgPlgTargets=function(){return[m[0],a,x,m]};function Ie(){try{var ne={xdrOnComplete:Xe,fetchOnComplete:Nn,xhrOnComplete:xe,beaconOnRetry:G},Ue={enableSendPromise:!1,isOneDs:!0,disableCredentials:!Se,disableXhr:!1,disableBeacon:!u,disableBeaconSync:!u,disableFetchKeepAlive:F,timeWrapper:W,addNoResponse:$,senderOnCompleteCallBack:ne};return Ue}catch{}return null}function Xe(ne,Ue,Ye){var wt=xp(ne);mt(Ue,200,{},wt),hd(wt)}function Ut(){var ne;s=null,a=new Iqe,c=!1,l=new xqe,u=!1,d=0,p=null,f=null,m=null,h=null,g=!0,y=[],b={},_=[],x=null,I=!1,S=null,w=!1,R=!1,k=ne,V=ne,F=ne,K=ne,$=ne,j=[],D=ne,A=ne,B=[],U=!1,W=DA(),ae=!1,Y=null}function Nn(ne,Ue,Ye,wt){var J=function(Re,Q,ie){mt(Ue,Re,Q,ie),hd(ie)},ue={},ve=ne[YI];ve&&ve.forEach(function(Re,Q){ue[Q]=Re}),J(ne.status,ue,Ye||Sp)}function xe(ne,Ue,Ye){var wt=xp(ne);mt(Ue,ne.status,Mg(ne,!0),wt),hd(wt)}function mt(ne,Ue,Ye,wt){try{ne(Ue,Ye,wt)}catch(J){ze(f,2,518,rt(J))}}function G(ne,Ue,Ye){var wt=ne,J=200,ue=wt[EA],ve=ne[hfe]+($?kRt:Sp);try{var Re=Ho();if(ue){var Q=!!h.getPlugin("LocalStorage"),ie=[],pe=[];Ce(ue[La],function(Ae){if(ie&&Ae&&Ae[Io]()>0)for(var ut=Ae[Lm](),je=0;je<ut[_n];je++)if(Re.sendBeacon(ve,x.getEventBlob(ut[je])))pe[Bs](Ae[je]);else{ie[Bs](Ae[Om](je));break}else ie[Bs](Ae[Om](0))}),pe[_n]>0&&(ue.sentEvts=pe),Q||Je(ie,8003,ue[cl],!0)}else J=0}catch(Ae){cc(f,"Failed to send telemetry using sendBeacon API. Ex:"+rt(Ae)),J=0}finally{mt(Ue,J,{},Sp)}}function de(ne){return ne===2||ne===3}function me(ne){return w&&de(ne)&&(ne=2),ne}X[P3]=function(ne,Ue){b[ne]=Ue},X.removeHeader=function(ne){delete b[ne]},X[A3]=function(){return Ne()&&l[k3]()},X[wA]=function(ne,Ue){Wt(ne)&&(ne=0),w&&(ne=me(ne),Ue=2),St(_,ne,0)&&vr(Ee(),0,!1,ne,Ue||0)},X[h$]=function(){return!c&&d===0&&_[_n]===0},X[D3]=function(ne){w=ne},X.addBatch=function(ne){if(ne&&ne[Io]()>0){if(a.isTenantKilled(ne[ud]()))return!1;_[Bs](ne)}return!0},X.teardown=function(){_[_n]>0&&vr(Ee(),0,!0,2,2),Ce(j,function(ne){ne&&ne.rm&&ne.rm()}),j=[]},X.pause=function(){c=!0},X.resume=function(){c=!1,X[wA](0,4)},X[g$]=function(ne,Ue,Ye){ne&&ne[Io]()>0&&(Pe(Ue)&&(Ue=1),w&&(Ue=me(Ue),Ye=2),vr([ne],0,!1,Ue,Ye||0))};function Ne(){return!c&&d<t}function Ee(){var ne=_;return _=[],ne}function St(ne,Ue,Ye){var wt=!1;return ne&&ne[_n]>0&&!c&&m[Ue]&&x&&(wt=Ue!==0||Ne()&&(Ye>0||l[k3]())),wt}function Ft(ne){var Ue={};return ne&&Ce(ne,function(Ye,wt){Ue[wt]={iKey:Ye[ud](),evts:Ye[Lm]()}}),Ue}function vr(ne,Ue,Ye,wt,J){if(!(!ne||ne[_n]===0)){if(c){Je(ne,1,wt);return}wt=me(wt);try{var ue=ne,ve=wt!==0;uo(h,function(){return"HttpManager:_sendBatches"},function(Re){Re&&(ne=ne.slice(0));for(var Q=[],ie=null,pe=al(),Ae=m[wt]||(ve?m[1]:m[0]),ut=Ae&&Ae[v$],je=K&&(w||de(wt)||ut===3||Ae._isSync&&ut===2);St(ne,wt,Ue);){var Bn=ne.shift();Bn&&Bn[Io]()>0&&(a.isTenantKilled(Bn[ud]())?Q[Bs](Bn):(ie=ie||x[mfe](Ue,Ye,ve,je,J,wt),x.appendPayload(ie,Bn,e)?ie.overflow!==null&&(ne=[ie.overflow][Nm](ne),ie.overflow=null,ma(ie,pe,al(),J),pe=al(),ie=null):(ma(ie,pe,al(),J),pe=al(),ne=[Bn][Nm](ne),ie=null)))}ie&&ma(ie,pe,al(),J),ne[_n]>0&&(_=ne[Nm](_)),Je(Q,8004,wt)},function(){return{batches:Ft(ue),retryCount:Ue,isTeardown:Ye,isSynchronous:ve,sendReason:J,useSendBeacon:de(wt),sendType:wt}},!ve)}catch(Re){ze(f,2,48,"Unexpected Exception sending batch: "+rt(Re))}}}function Gr(ne,Ue){var Ye={url:s,hdrs:{},useHdrs:!1};Ue?(Ye[s_]=GI(Ye[s_],b),Ye.useHdrs=ls(Ye.hdrs)[_n]>0):at(b,function(Re,Q){Tfe[Re]?NA(Ye,Tfe[Re],Q,!1):(Ye[s_][Re]=Q,Ye[l$]=!0)}),NA(Ye,ife,"NO_AUTH",Ue),NA(Ye,e$,IA,Ue);var wt=Sp;Ce(ne.apiKeys,function(Re){wt[_n]>0&&(wt+=","),wt+=Re}),NA(Ye,r$,wt,Ue),NA(Ye,n$,Vi().toString(),Ue);var J=v1(ne);if(Us(J)&&(Ye.url+="&ext.intweb.msfpc="+J),l[s$]()&&NA(Ye,t$,l[a$](),Ue),h[kA]){var ue=h[kA]();ue>=0&&(Ye.url+="&w="+ue)}for(var ve=0;ve<y[_n];ve++)Ye.url+="&"+y[ve].name+"="+y[ve].value;return Ye}function wi(ne,Ue,Ye){ne[Ue]=ne[Ue]||{},ne[Ue][p.identifier]=Ye}function ma(ne,Ue,Ye,wt){if(ne&&ne.payloadBlob&&ne.payloadBlob[_n]>0){var J=!!D,ue=m[ne.sendType];!de(ne[cl])&&ne[gfe]&&ne.sendReason===2&&(ue=m[2]||m[3]||ue);var ve=R;(ne.isBeacon||ue[v$]===3)&&(ve=!1);var Re=Gr(ne,ve);ve=ve||Re[l$];var Q=al();uo(h,function(){return"HttpManager:_doPayloadSend"},function(){for(var ie=0;ie<ne.batches[_n];ie++)for(var pe=ne[La][ie],Ae=pe[Lm](),ut=0;ut<Ae[_n];ut++){var je=Ae[ut];if(I){var Bn=je[N3]=je[N3]||{};wi(Bn,"sendEventStart",Q),wi(Bn,"serializationStart",Ue),wi(Bn,"serializationCompleted",Ye)}je[Sfe]>0?je[Sfe]++:je[Sfe]=1}Je(ne[La],1e3+(wt||0),ne[cl],!0);var Yn={data:ne.payloadBlob,urlString:Re.url,headers:Re[s_],_thePayload:ne,_sendReason:wt,timeout:k,disableXhrSync:V,disableFetchKeepAlive:F};ve&&(Dqe(Yn[YI],rfe)||(Yn[YI][rfe]=nqe),Dqe(Yn[YI],Zz)||(Yn[YI][Zz]=nfe));var Co=null;ue&&(Co=function(ul){l[o$]();var av=function(cv,L_){D_(cv,L_,ne,wt)},Ua=ne[y$]||ne[b$];try{ue.sendPOST(ul,av,Ua),A&&A(Yn,ul,Ua,ne[gfe])}catch(cv){cc(f,"Unexpected exception sending payload. Ex:"+rt(cv)),mt(av,0,{})}}),uo(h,function(){return"HttpManager:_doPayloadSend.sender"},function(){if(Co)if(ne[cl]===0&&d++,J&&!ne.isBeacon&&ue[v$]!==3){var ul={data:Yn[RA],urlString:Yn[hfe],headers:GI({},Yn[YI]),timeout:Yn.timeout,disableXhrSync:Yn[ufe],disableFetchKeepAlive:Yn[dfe]},av=!1;uo(h,function(){return"HttpManager:_doPayloadSend.sendHook"},function(){try{D(ul,function(Ua){av=!0,!g&&!Ua[EA]&&(Ua[EA]=Ua[EA]||Yn[EA],Ua[_$]=Ua[_$]||Yn[_$]),Co(Ua)},ne.isSync||ne[y$])}catch{av||Co(Yn)}})}else Co(Yn)})},function(){return{thePayload:ne,serializationStart:Ue,serializationCompleted:Ye,sendReason:wt}},ne[b$])}ne.sizeExceed&&ne.sizeExceed[_n]>0&&Je(ne.sizeExceed,8003,ne[cl]),ne.failedEvts&&ne.failedEvts[_n]>0&&Je(ne.failedEvts,8002,ne[cl])}function Cp(ne,Ue){I&&Ce(ne,function(Ye){var wt=Ye[N3]=Ye[N3]||{};wi(wt,"sendEventCompleted",Ue)})}function D_(ne,Ue,Ye,wt){var J=9e3,ue=null,ve=!1,Re=!1;try{var Q=!0;if(typeof ne!==fm){if(Ue){l[R3](Ue[oqe]);var ie=Ue[iqe]||Ue["kill-duration-seconds"];Ce(a[x$](Ue[rqe],ie),function(Ae){Ce(Ye[La],function(ut){if(ut[ud]()===Ae){ue=ue||[];var je=ut[Om](0);Ye.numEvents-=je[Io](),ue[Bs](je)}})})}if(ne==200||ne==204){J=200;return}(!Eqe(ne)||Ye.numEvents<=0)&&(Q=!1),J=9e3+ne%1e3}if(Q){J=100;var pe=Ye.retryCnt;Ye[cl]===0&&(pe<r?(ve=!0,Ep(function(){Ye[cl]===0&&d--,vr(Ye[La],pe+1,Ye[y$],w?2:Ye[cl],5)},w,T$(pe))):(Re=!0,w&&(J=8001)))}}finally{ve||(l[R3](),ov(Ye,J,wt,Re)),Je(ue,8004,Ye[cl])}}function ov(ne,Ue,Ye,wt){try{wt&&p[S$]();var J=ne[La];Ue===200&&(J=ne.sentEvts||ne[La],!wt&&!ne[b$]&&p._clearBackOff(),N_(J)),Je(J,Ue,ne[cl],!0)}finally{ne[cl]===0&&(d--,Ye!==5&&X.sendQueuedRequests(ne[cl],Ye))}}function N_(ne){if(I){var Ue=al();Ce(ne,function(Ye){Ye&&Ye[Io]()>0&&Cp(Ye[Lm](),Ue)})}}function Ep(ne,Ue,Ye){Ue?ne():W.set(ne,Ye)}function v1(ne){for(var Ue=0;Ue<ne.batches[_n];Ue++){var Ye=ne[La][Ue].Msfpc();if(Ye)return encodeURIComponent(Ye)}return Sp}function hd(ne){var Ue=B;try{for(var Ye=0;Ye<Ue[_n];Ye++)try{Ue[Ye](ne)}catch(J){ze(f,1,519,"Response handler failed: "+J)}if(ne){var wt=JSON.parse(ne);Us(wt.webResult)&&Us(wt.webResult[CA])&&S.set("MSFPC",wt.webResult[CA],365*86400)}}catch{}}function Je(ne,Ue,Ye,wt){if(ne&&ne[_n]>0&&o){var J=o[sv(Ue)];if(J){var ue=Ye!==0;uo(h,function(){return"HttpManager:_sendBatchesNotification"},function(){Ep(function(){try{J.call(o,ne,Ue,ue,Ye)}catch(ve){ze(f,1,74,"send request notification failed: "+ve)}},wt||ue,0)},function(){return{batches:Ft(ne),reason:Ue,isSync:ue,sendSync:wt,sendType:Ye}},!ue)}}}function sv(ne){var Ue=PRt[ne];return Us(Ue)||(Ue=tqe,ne>=9e3&&ne<=9999?Ue=eqe:ne>=8e3&&ne<=8999?Ue=Jz:ne>=1e3&&ne<=1999&&(Ue=ZBe)),Ue}})}return n.__ieDyn=1,n}()});function URt(n){return n&&n.sendPOST}var NRt,Oqe,LRt,Uqe,Bqe,ORt,Mqe,MRt,Cfe,ZI,Fqe,ps,FRt,qqe,jqe=N(()=>{Zc();Fs();zI();iA();Mt();efe();bfe();Lqe();w3();_fe();xfe();PA();NRt=.25,Oqe=500,LRt=20,Uqe=6,Bqe=2,ORt=4,Mqe=2,MRt=1,Cfe=1e4,ZI="eventsDiscarded",Fqe="",ps=void 0,FRt=oc({eventsLimitInMem:{isVal:o_,v:Cfe},immediateEventLimit:{isVal:o_,v:500},autoFlushEventsLimit:{isVal:o_,v:0},disableAutoBatchFlushLimit:!1,httpXHROverride:{isVal:URt,v:ps},overrideInstrumentationKey:ps,overrideEndpointUrl:ps,disableTelemetry:!1,ignoreMc1Ms0CookieProcessing:!1,setTimeoutOverride:ps,clearTimeoutOverride:ps,payloadPreprocessor:ps,payloadListener:ps,disableEventTimings:ps,valueSanitizer:ps,stringifyObjects:ps,enableCompoundKey:ps,disableOptimizeObj:!1,transports:ps,unloadTransports:ps,useSendBeacon:ps,disableFetchKeepAlive:ps,avoidOptions:!1,xhrTimeout:ps,disableXhrSync:ps,alwaysUseXhrOverride:!1,maxEventRetryAttempts:{isVal:Pa,v:Uqe},maxUnloadEventRetryAttempts:{isVal:Pa,v:Bqe},addNoResponse:ps,excludeCsMetaData:ps});qqe=function(n){Jc(e,n);function e(){var t=n.call(this)||this;t.identifier="PostChannel",t.priority=1011,t.version="4.1.1";var r,o=!1,s=[],a,c=!1,l=0,u,d=0,p,f={},m=$I,h,g,y,b,_,x,I,S,w,R,k,V,F,K,$,j,D,A,B,U,W,ae;return wn(e,t,function(Y,X){Ne(),Y._getDbgPlgTargets=function(){return[_,r]},Y[KI]=function(Q,ie,pe){uo(ie,function(){return"PostChannel:initialize"},function(){X[KI](Q,ie,pe),B=ie.getNotifyMgr();try{$=$l(ua(Y[L3]),ie.evtNamespace&&ie.evtNamespace()),Y._addHook(zo(Q,function(Ae){var ut=Ae.cfg,je=lc(null,ut,ie);r=je.getExtCfg(Y[L3],FRt),j=DA(r[u$],r[d$]),k=!r[mqe]&&Kz(),D=r[hqe],te(ie),p=r[vfe],u=r.immediateEventLimit,I=r[yfe],F=r.maxEventRetryAttempts,K=r.maxUnloadEventRetryAttempts,A=r[gqe],Re(),W=r[vqe],ae=!!r[yqe],U&&Se();var Bn=ut.disablePageUnloadEvents||[];U=b3(Ut,Bn,$),U=_A(Ut,Bn,$)||U,U=xA(Nn,ut.disablePageShowEvents,$)||U})),_[KI](Q,Y.core,Y)}catch(Ae){throw Y.setInitialized(!1),Ae}},function(){return{theConfig:Q,core:ie,extensions:pe}})},Y.processTelemetry=function(Q,ie){C3(Q,Y[L3]),ie=ie||Y._getTelCtx(ie);var pe=Q;!ae&&!o&&(W&&(pe[ud]=W),mt(pe,!0),V?Ft(2,2):me()),Y.processNext(pe,ie)},Y.getOfflineSupport=function(){try{var Q=_&&_[m$]();if(Q)return{getUrl:function(){return Q.url},serialize:Xe,batch:Ie,shouldProcess:function(ie){return!ae},createPayload:function(ie){return{urlString:Q.url,headers:Q[s_],data:ie}}}}catch{}return null},Y._doTeardown=function(Q,ie){Ft(2,2),o=!0,_.teardown(),Se(),Ne()};function Se(){_3(null,$),x3(null,$),S3(null,$)}function te(Q){var ie=Q[kA];Q[kA]=function(){var pe=0;return D&&(pe=pe|2),pe|ie.call(Q)}}function Ie(Q){var ie=Fqe;return Q&&Q[_n]&&Ce(Q,function(pe){ie&&(ie+=`
`),ie+=pe}),ie}function Xe(Q){var ie=Fqe;try{xe(Q),ie=_[f$](Q)}catch{}return ie}function Ut(Q){var ie=Q||Hi().event;ie.type!=="beforeunload"&&(V=!0,_[D3](V)),Ft(2,2)}function Nn(Q){V=!1,_[D3](V)}function xe(Q){Q.ext&&Q.ext[afe]&&delete Q.ext[afe],Q.ext&&Q.ext[i$]&&Q.ext[i$].id&&delete Q.ext[i$].id,k&&(Q.ext=cd(Q.ext),Q[I$]&&(Q[I$]=cd(Q[I$])),Q[RA]&&(Q[RA]=cd(Q[RA])))}function mt(Q,ie){if(Q[O3]||(Q[O3]=0),Q[a_]||(Q[a_]=1),xe(Q),Q[QI]){if(y||c)Q[a_]=3,Q[QI]=!1;else if(_){k&&(Q=cd(Q)),_[g$](AA.create(Q[ud],[Q]),Q[QI]===!0?1:Q[QI],3);return}}var pe=Q[a_],Ae=d,ut=p;pe===4&&(Ae=l,ut=u);var je=!1;if(Ae<ut)je=!ma(Q,ie);else{var Bn=1,Yn=LRt;pe===4&&(Bn=4,Yn=1),je=!0,Cp(Q[ud],Q[a_],Bn,Yn)&&(je=!ma(Q,ie))}je&&ne(ZI,[Q],mp.QueueFull)}Y.setEventQueueLimits=function(Q,ie){r[vfe]=p=o_(Q)?Q:Cfe,r[yfe]=I=o_(ie)?ie:0,Re();var pe=d>Q;if(!pe&&S>0)for(var Ae=1;!pe&&Ae<=3;Ae++){var ut=x[Ae];ut&&ut[La]&&Ce(ut[La],function(je){je&&je[Io]()>=S&&(pe=!0)})}wi(!0,pe)},Y.pause=function(){St(),c=!0,_.pause()},Y.resume=function(){c=!1,_.resume(),me()},Y._loadTransmitProfiles=function(Q){v1(),at(Q,function(ie,pe){var Ae=pe[_n];if(Ae>=2){var ut=Ae>2?pe[2]:0;if(pe[WI](0,Ae-2),pe[1]<0&&(pe[0]=-1),pe[1]>0&&pe[0]>0){var je=pe[0]/pe[1];pe[0]=Math.ceil(je)*pe[1]}ut>=0&&pe[1]>=0&&ut>pe[1]&&(ut=pe[1]),pe[Bs](ut),f[ie]=pe}})},Y.flush=function(Q,ie,pe){Q===void 0&&(Q=!0);var Ae;if(!c)if(pe=pe||1,Q)ie||(Ae=ac(function(je){ie=je})),a==null?(St(),ov(1,0,pe),a=Ee(function(){a=null,N_(ie,pe)},0)):s[Bs](ie);else{var ut=St();G(1,1,pe),ie&&ie(),ut&&me()}return Ae},Y.setMsaAuthTicket=function(Q){_[P3](E3,Q)},Y.setAuthPluginHeader=function(Q){_[P3](ofe,Q)},Y.removeAuthPluginHeader=function(){_.removeHeader(ofe)},Y.hasEvents=de,Y._setTransmitProfile=function(Q){m!==Q&&f[Q]!==void 0&&(St(),m=Q,me())},zl(Y,function(){return _},["addResponseHandler"]);function G(Q,ie,pe){var Ae=ov(Q,ie,pe);return _[wA](ie,pe),Ae}function de(){return d>0}function me(){if(w>=0&&ov(w,0,R)&&_[wA](0,R),l>0&&!g&&!c){var Q=f[m][2];Q>=0&&(g=Ee(function(){g=null,G(4,0,1),me()},Q))}var ie=f[m][1];!h&&!a&&ie>=0&&!c&&(de()?h=Ee(function(){h=null,G(b===0?3:1,0,1),b++,b%=2,me()},ie):b=0)}Y[S$]=function(){y<ORt&&(y++,St(),me())},Y._clearBackOff=function(){y&&(y=0,St(),me())};function Ne(){r=null,o=!1,s=[],a=null,c=!1,l=0,u=500,d=0,p=Cfe,f={},m=$I,h=null,g=null,y=0,b=0,x={},I=0,U=!1,S=0,w=-1,R=null,k=!0,V=!1,F=Uqe,K=Bqe,$=null,W=null,ae=!1,j=DA(),_=new Nqe(Oqe,Mqe,MRt,{requeue:Je,send:Ye,sent:wt,drop:J,rspFail:ue,oth:ve}),hd(),vr(),Re()}function Ee(Q,ie){ie===0&&y&&(ie=1);var pe=1e3;return y&&(pe=T$(y-1)),j.set(Q,ie*pe)}function St(){return h!==null?(h.cancel(),h=null,b=0,!0):!1}function Ft(Q,ie){St(),a&&(a.cancel(),a=null),c||G(1,Q,ie)}function vr(){x[4]={batches:[],iKeyMap:{}},x[3]={batches:[],iKeyMap:{}},x[2]={batches:[],iKeyMap:{}},x[1]={batches:[],iKeyMap:{}}}function Gr(Q,ie,pe){var Ae=x[ie];Ae||(ie=1,Ae=x[ie]);var ut=Ae.iKeyMap[Q];return!ut&&pe&&(ut=AA.create(Q),Ae.batches[Bs](ut),Ae.iKeyMap[Q]=ut),ut}function wi(Q,ie){_[A3]()&&!y&&(I>0&&d>I&&(ie=!0),ie&&a==null&&Y.flush(Q,function(){},20))}function ma(Q,ie){k&&(Q=cd(Q));var pe=Q[a_],Ae=Gr(Q[ud],pe,!0);return Ae.addEvent(Q)?(pe!==4?(d++,ie&&Q[O3]===0&&wi(!Q.sync,S>0&&Ae[Io]()>=S)):l++,!0):!1}function Cp(Q,ie,pe,Ae){for(;pe<=ie;){var ut=Gr(Q,ie,!0);if(ut&&ut[Io]()>0){var je=ut[Om](0,Ae),Bn=je[Io]();if(Bn>0)return pe===4?l-=Bn:d-=Bn,Ue(ZI,[je],mp.QueueFull),!0}pe++}return D_(),!1}function D_(){for(var Q=0,ie=0,pe=function(ut){var je=x[ut];je&&je[La]&&Ce(je[La],function(Bn){ut===4?Q+=Bn[Io]():ie+=Bn[Io]()})},Ae=1;Ae<=4;Ae++)pe(Ae);d=ie,l=Q}function ov(Q,ie,pe){var Ae=!1,ut=ie===0;return!ut||_[A3]()?uo(Y.core,function(){return"PostChannel._queueBatches"},function(){for(var je=[],Bn=4;Bn>=Q;){var Yn=x[Bn];Yn&&Yn.batches&&Yn.batches[_n]>0&&(Ce(Yn[La],function(Co){_.addBatch(Co)?Ae=Ae||Co&&Co[Io]()>0:je=je[Nm](Co[Lm]()),Bn===4?l-=Co[Io]():d-=Co[Io]()}),Yn[La]=[],Yn.iKeyMap={}),Bn--}je[_n]>0&&ne(ZI,je,mp.KillSwitch),Ae&&w>=Q&&(w=-1,R=0)},function(){return{latency:Q,sendType:ie,sendReason:pe}},!ut):(w=w>=0?Math.min(w,Q):Q,R=Math.max(R,pe)),Ae}function N_(Q,ie){G(1,0,ie),D_(),Ep(function(){Q&&Q(),s[_n]>0?a=Ee(function(){a=null,N_(s.shift(),ie)},0):(a=null,me())})}function Ep(Q){_[h$]()?Q():a=Ee(function(){a=null,Ep(Q)},NRt)}function v1(){St(),hd(),m=$I,me()}function hd(){f={},f[$I]=[2,1,0],f[Qz]=[6,3,0],f[Xz]=[18,9,0]}function Je(Q,ie){var pe=[],Ae=F;V&&(Ae=K),Ce(Q,function(ut){ut&&ut[Io]()>0&&Ce(ut[Lm](),function(je){je&&(je[QI]&&(je[a_]=4,je[QI]=!1),je[O3]<Ae?(C3(je,Y[L3]),mt(je,!1)):pe[Bs](je))})}),pe[_n]>0&&ne(ZI,pe,mp.NonRetryableStatus),V&&Ft(2,2)}function sv(Q,ie){var pe=B||{},Ae=pe[Q];if(Ae)try{Ae.apply(pe,ie)}catch(ut){ze(Y.diagLog(),1,74,Q+" notification failed: "+ut)}}function ne(Q,ie){for(var pe=[],Ae=2;Ae<arguments.length;Ae++)pe[Ae-2]=arguments[Ae];ie&&ie[_n]>0&&sv(Q,[ie][Nm](pe))}function Ue(Q,ie){for(var pe=[],Ae=2;Ae<arguments.length;Ae++)pe[Ae-2]=arguments[Ae];ie&&ie[_n]>0&&Ce(ie,function(ut){ut&&ut[Io]()>0&&sv(Q,[ut.events()][Nm](pe))})}function Ye(Q,ie,pe){Q&&Q[_n]>0&&sv("eventsSendRequest",[ie>=1e3&&ie<=1999?ie-1e3:0,pe!==!0])}function wt(Q,ie){Ue("eventsSent",Q,ie),me()}function J(Q,ie){Ue(ZI,Q,ie>=8e3&&ie<=8999?ie-8e3:mp.Unknown)}function ue(Q){Ue(ZI,Q,mp.NonRetryableStatus),me()}function ve(Q,ie){Ue(ZI,Q,mp.Unknown),me()}function Re(){A?S=0:S=Math.max(Oqe*(Mqe+1),p/6)}}),t}return e.__ieDyn=1,e}(Hg)});var Hqe={};Dr(Hqe,{BE_PROFILE:()=>Xz,NRT_PROFILE:()=>Qz,PostChannel:()=>qqe,RT_PROFILE:()=>$I});var Vqe=N(()=>{efe();jqe()});var zqe=P(Mm=>{"use strict";var BRt=Mm&&Mm.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,o)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),qRt=Mm&&Mm.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),Gqe=Mm&&Mm.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&BRt(e,n,t);return qRt(e,n),e};Object.defineProperty(Mm,"__esModule",{value:!0});Mm.oneDataSystemClientFactory=void 0;var jRt=async(n,e,t)=>{let r=await Promise.resolve().then(()=>Gqe((zI(),Eo(JBe)))),o=await Promise.resolve().then(()=>Gqe((Vqe(),Eo(Hqe)))),s=new r.AppInsightsCore,a=new o.PostChannel,c={instrumentationKey:n,endpointUrl:"https://mobile.events.data.microsoft.com/OneCollector/1.0",loggingLevelTelemetry:0,loggingLevelConsole:0,disableCookiesUsage:!0,disableDbgExt:!0,disableInstrumentationKeyValidation:!0,channels:[[a]]};if(t){c.extensionConfig={};let d={alwaysUseXhrOverride:!0,httpXHROverride:t};c.extensionConfig[a.identifier]=d}let u=e.workspace.getConfiguration("telemetry").get("internalTesting");return s.initialize(c,[]),s.addTelemetryInitializer(d=>{d.ext=d.ext??{},d.ext.web=d.ext.web??{},d.ext.web.consentDetails='{"GPC_DataSharingOptIn":false}',u&&(d.ext.utc=d.ext.utc??{},d.ext.utc.flags=8462029)}),s},HRt=async(n,e,t)=>{let r=await jRt(n,e,t);return{logEvent:(a,c)=>{try{r?.track({name:a,baseData:{name:a,properties:c?.properties,measurements:c?.measurements}})}catch(l){throw new Error(`Failed to log event to app insights!
`+l.message)}},flush:async()=>{try{return new Promise((c,l)=>{if(!r){c();return}r.flush(!0,u=>{if(!u){l("Failed to flush app 1DS!");return}})})}catch(a){throw new Error(`Failed to flush 1DS!
`+a.message)}},dispose:async()=>new Promise(c=>{if(!r){c();return}r.unload(!1,()=>{c(),r=void 0},1e3)})}};Mm.oneDataSystemClientFactory=HRt});var $qe,LA,OA,M3,c_,Fm,ms,E$,dd=N(()=>{$qe="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",LA="sampleRate",OA="ProcessLegacy",M3="http.method",c_="https://dc.services.visualstudio.com",Fm="/v2/track",ms="not_specified",E$="iKey"});var e1,Efe=N(()=>{gr();e1=Tde({requestContextHeader:[0,"Request-Context"],requestContextTargetKey:[1,"appId"],requestContextAppIdFormat:[2,"appId=cid-v1:"],requestIdHeader:[3,"Request-Id"],traceParentHeader:[4,"traceparent"],traceStateHeader:[5,"tracestate"],sdkContextHeader:[6,"Sdk-Context"],sdkContextHeaderAppIdRequest:[7,"appId"],requestContextHeaderLowerCase:[8,"request-context"]})});var Wg,Yt,Um,l_,Kg,Yg,w$,$o,Ip,u_,k$,R$,P$,wfe,A$,D$,t1,MA,kfe,F3,n1,pd,da,Oa,r1,Bm,i1,N$,L$,Rfe,o1,d_,U3,B3,s1,FA,a1,Pfe,hs=N(()=>{Wg="split",Yt="length",Um="toLowerCase",l_="ingestionendpoint",Kg="toString",Yg="push",w$="removeItem",$o="name",Ip="message",u_="count",k$="preTriggerDate",R$="disabled",P$="interval",wfe="daysOfMonth",A$="date",D$="getUTCDate",t1="stringify",MA="pathname",kfe="correlationHeaderExcludePatterns",F3="extensionConfig",n1="exceptions",pd="parsedStack",da="properties",Oa="measurements",r1="sizeInBytes",Bm="typeName",i1="severityLevel",N$="problemGroup",L$="isManual",Rfe="CreateFromInterface",o1="assembly",d_="fileName",U3="hasFullStack",B3="level",s1="method",FA="line",a1="duration",Pfe="receivedResponse"});function O$(n,e,t){var r=e[Yt],o=Afe(n,e);if(o[Yt]!==r){for(var s=0,a=o;t[a]!==void 0;)s++,a=ao(o,0,147)+Dfe(s);o=a}return o}function Afe(n,e){var t;return e&&(e=sr(fi(e)),e[Yt]>150&&(t=ao(e,0,150),ze(n,2,57,"name is too long.  It has been truncated to 150 characters.",{name:e},!0))),t||e}function wr(n,e,t){t===void 0&&(t=1024);var r;return e&&(t=t||1024,e=sr(fi(e)),e[Yt]>t&&(r=ao(e,0,t),ze(n,2,61,"string value is too long. It has been truncated to "+t+" characters.",{value:e},!0))),r||e}function p_(n,e){return U$(n,e,2048,66)}function UA(n,e){var t;return e&&e[Yt]>32768&&(t=ao(e,0,32768),ze(n,2,56,"message is too long, it has been truncated to 32768 characters.",{message:e},!0)),t||e}function M$(n,e){var t;if(e){var r=""+e;r[Yt]>32768&&(t=ao(r,0,32768),ze(n,2,52,"exception is too long, it has been truncated to 32768 characters.",{exception:e},!0))}return t||e}function Ma(n,e){if(e){var t={};at(e,function(r,o){if(Zr(o)&&xm())try{o=la()[t1](o)}catch(s){ze(n,2,49,"custom property is not valid",{exception:s},!0)}o=wr(n,o,8192),r=O$(n,r,t),t[r]=o}),e=t}return e}function Fa(n,e){if(e){var t={};at(e,function(r,o){r=O$(n,r,t),t[r]=o}),e=t}return e}function F$(n,e){return e&&U$(n,e,128,69)[Kg]()}function U$(n,e,t,r){var o;return e&&(e=sr(fi(e)),e[Yt]>t&&(o=ao(e,0,t),ze(n,2,r,"input is too long, it has been truncated to "+t+" characters.",{data:e},!0))),o||e}function Dfe(n){var e="00"+n;return dp(e,e[Yt]-3)}var fd=N(()=>{gr();Mt();hs()});function c1(n){var e=Kqe,t=VRt,r=t[e];return Wqe.createElement?t[e]||(r=t[e]=Wqe.createElement("a")):r={host:Nfe(n,!0)},r.href=n,e++,e>=t[Yt]&&(e=0),Kqe=e,r}function Yqe(n){var e,t=c1(n);return t&&(e=t.href),e}function Qqe(n){var e,t=c1(n);return t&&(e=t[MA]),e}function Xqe(n,e){return n?n.toUpperCase()+" "+e:e}function Nfe(n,e){var t=q3(n,e)||"";if(t){var r=t.match(/(www\d{0,5}\.)?([^\/:]{1,256})(:\d{1,20})?/i);if(r!=null&&r[Yt]>3&&Jt(r[2])&&r[2][Yt]>0)return r[2]+(r[3]||"")}return t}function q3(n,e){var t=null;if(n){var r=n.match(/(\w{1,150}):\/\/([^\/:]{1,256})(:\d{1,20})?/i);if(r!=null&&r[Yt]>2&&Jt(r[2])&&r[2][Yt]>0&&(t=r[2]||"",e&&r[Yt]>2)){var o=(r[1]||"")[Um](),s=r[3]||"";(o==="http"&&s===":80"||o==="https"&&s===":443")&&(s=""),t+=s}}return t}var Wqe,Kqe,VRt,Lfe=N(()=>{gr();hs();Wqe=ji()||{},Kqe=0,VRt=[null,null,null,null,null]});function j3(n){return er(GRt,n[Um]())!==-1}function Jqe(n){Ofe=n}function Zqe(){return Ofe}function eje(n,e,t){if(!e||n&&n.disableCorrelationHeaders)return!1;if(n&&n[kfe]){for(var r=0;r<n.correlationHeaderExcludePatterns[Yt];r++)if(n[kfe][r].test(e))return!1}var o=c1(e).host[Um]();if(o&&(sc(o,":443")!==-1||sc(o,":80")!==-1)&&(o=(q3(e,!0)||"")[Um]()),(!n||!n.enableCorsCorrelation)&&o&&o!==t)return!1;var s=n&&n.correlationHeaderDomains;if(s){var a;if(Ce(s,function(u){var d=new RegExp(u.toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));a=a||d.test(o)}),!a)return!1}var c=n&&n.correlationHeaderExcludedDomains;if(!c||c[Yt]===0)return!0;for(var r=0;r<c[Yt];r++){var l=new RegExp(c[r].toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));if(l.test(o))return!1}return o&&o[Yt]>0}function tje(n){if(n){var e=Mfe(n,e1[1]);if(e&&e!==Ofe)return e}}function Mfe(n,e){if(n)for(var t=n[Wg](","),r=0;r<t[Yt];++r){var o=t[r][Wg]("=");if(o[Yt]===2&&o[0]===e)return o[1]}}function nje(n,e,t,r){var o,s=r,a=r;if(e&&e[Yt]>0){var c=c1(e);if(o=c.host,!s)if(c[MA]!=null){var l=c.pathname[Yt]===0?"/":c[MA];l.charAt(0)!=="/"&&(l="/"+l),a=c[MA],s=wr(n,t?t+" "+l:l)}else s=wr(n,e)}else o=r,s=r;return{target:o,name:s,data:a}}function rje(){var n=wg();if(n&&n.now&&n.timing){var e=n.now()+n.timing.navigationStart;if(e>0)return e}return Vi()}function ije(n,e){var t=null;return n!==0&&e!==0&&!Pe(n)&&!Pe(e)&&(t=e-n),t}function oje(n,e){var t=n||{};return{getName:function(){return t[$o]},setName:function(r){e&&e.setName(r),t[$o]=r},getTraceId:function(){return t.traceID},setTraceId:function(r){e&&e.setTraceId(r),Em(r)&&(t.traceID=r)},getSpanId:function(){return t.parentID},setSpanId:function(r){e&&e.setSpanId(r),wm(r)&&(t.parentID=r)},getTraceFlags:function(){return t.traceFlags},setTraceFlags:function(r){e&&e.setTraceFlags(r),t.traceFlags=r}}}var GRt,Ofe,Ffe=N(()=>{gr();Mt();dd();Efe();fd();Lfe();hs();GRt=[c_+Fm,"https://breeze.aimon.applicationinsights.io"+Fm,"https://dc-int.services.visualstudio.com"+Fm],Ofe="cid-v1:"});var BA,sje,aje,Ufe=N(()=>{gr();BA=Vo({LocalStorage:0,SessionStorage:1}),sje=Vo({AI:0,AI_AND_W3C:1,W3C:2}),aje=Vo({Normal:1,Critical:2})});function Bfe(){return qA()?B$(BA.LocalStorage):null}function B$(n){try{if(Pe(Aa()))return null;var e=new Date()[Kg](),t=Sr(n===BA.LocalStorage?"localStorage":"sessionStorage"),r=cje+e;t.setItem(r,e);var o=t.getItem(r)!==e;if(t[w$](r),!o)return t}catch{}return null}function qfe(){return l1()?B$(BA.SessionStorage):null}function lje(){f_=!1,m_=!1}function q$(n){cje=n||""}function uje(){f_=qA(!0),m_=l1(!0)}function qA(n){return(n||f_===void 0)&&(f_=!!B$(BA.LocalStorage)),f_}function j$(n,e){var t=Bfe();if(t!==null)try{return t.getItem(e)}catch(r){f_=!1,ze(n,2,1,"Browser failed read of local storage. "+ei(r),{exception:rt(r)})}return null}function H$(n,e,t){var r=Bfe();if(r!==null)try{return r.setItem(e,t),!0}catch(o){f_=!1,ze(n,2,3,"Browser failed write to local storage. "+ei(o),{exception:rt(o)})}return!1}function dje(n,e){var t=Bfe();if(t!==null)try{return t[w$](e),!0}catch(r){f_=!1,ze(n,2,5,"Browser failed removal of local storage item. "+ei(r),{exception:rt(r)})}return!1}function l1(n){return(n||m_===void 0)&&(m_=!!B$(BA.SessionStorage)),m_}function pje(){var n=[];return l1()&&at(Sr("sessionStorage"),function(e){n[Yg](e)}),n}function V$(n,e){var t=qfe();if(t!==null)try{return t.getItem(e)}catch(r){m_=!1,ze(n,2,2,"Browser failed read of session storage. "+ei(r),{exception:rt(r)})}return null}function G$(n,e,t){var r=qfe();if(r!==null)try{return r.setItem(e,t),!0}catch(o){m_=!1,ze(n,2,4,"Browser failed write to session storage. "+ei(o),{exception:rt(o)})}return!1}function fje(n,e){var t=qfe();if(t!==null)try{return t[w$](e),!0}catch(r){m_=!1,ze(n,2,6,"Browser failed removal of session storage item. "+ei(r),{exception:rt(r)})}return!1}var f_,m_,cje,jfe=N(()=>{gr();Ufe();hs();f_=void 0,m_=void 0,cje=""});var zRt,mje,hje=N(()=>{gr();Mt();jfe();hs();zRt="appInsightsThrottle",mje=function(){function n(e,t){var r=this,o,s,a,c,l,u,d,p=!1,f=!1;h(),r._getDbgPlgTargets=function(){return[d]},r.getConfig=function(){return a},r.canThrottle=function(D){var A=K(D),B=g(D);return _(B,o,A)},r.isTriggered=function(D){return $(D)},r.isReady=function(){return p},r.flush=function(D){try{var A=j(D);if(A&&A[Yt]>0){var B=A.slice(0);return d[D]=[],Ce(B,function(U){m(U.msgID,U[Ip],U.severity,!1)}),!0}}catch{}return!1},r.flushAll=function(){try{if(d){var D=!0;return at(d,function(A){var B=r.flush(parseInt(A));D=D&&B}),D}}catch{}return!1},r.onReadyState=function(D,A){return A===void 0&&(A=!0),p=Pe(D)?!0:D,p&&A?r.flushAll():null},r.sendMessage=function(D,A,B){return m(D,A,B,!0)};function m(D,A,B,U){if(p){var W=F(D);if(!W)return;var ae=g(D),Y=K(D),X=_(ae,o,Y),Se=!1,te=0,Ie=$(D);try{X&&!Ie?(te=Math.min(ae.limit.maxSendNumber,Y[u_]+1),Y[u_]=0,Se=!0,l[D]=!0,Y[k$]=new Date):(l[D]=X,Y[u_]+=1);var Xe=x(D);R(s,Xe,Y);for(var Ut=0;Ut<te;Ut++)V(D,s,A,B)}catch{}return{isThrottled:Se,throttleNum:te}}else if(U){var Nn=j(D);Nn[Yg]({msgID:D,message:A,severity:B})}return null}function h(){s=bp(e),l={},c={},d={},a={},y(109),u=Im(t)?t:"",e.addUnloadHook(zo(e.config,function(D){var A=D.cfg;o=qA();var B=A.throttleMgrCfg||{};at(B,function(U,W){y(parseInt(U),W)})}))}function g(D){return a[D]||a[109]}function y(D,A){var B,U;try{var W=A||{},ae={};ae[R$]=!!W[R$];var Y=W[P$]||{};f=Y?.daysOfMonth&&Y?.daysOfMonth[Yt]>0,ae[P$]=b(Y);var X={samplingRate:((B=W.limit)===null||B===void 0?void 0:B.samplingRate)||100,maxSendNumber:((U=W.limit)===null||U===void 0?void 0:U.maxSendNumber)||1};ae.limit=X,a[D]=ae}catch{}}function b(D){D=D||{};var A=D?.monthInterval,B=D?.dayInterval;return Pe(A)&&Pe(B)&&(D.monthInterval=3,f||(D[wfe]=[28],f=!0)),D={monthInterval:D?.monthInterval,dayInterval:D?.dayInterval,daysOfMonth:D?.daysOfMonth},D}function _(D,A,B){if(D&&!D[R$]&&A&&Im(B)){var U=w(),W=B[A$],ae=D[P$],Y=1;if(ae?.monthInterval){var X=(U.getUTCFullYear()-W.getUTCFullYear())*12+U.getUTCMonth()-W.getUTCMonth();Y=k(ae.monthInterval,0,X)}var Se=1;if(f)Se=er(ae[wfe],U[D$]());else if(ae?.dayInterval){var te=Math.floor((U.getTime()-W.getTime())/864e5);Se=k(ae.dayInterval,0,te)}return Y>=0&&Se>=0}return!1}function x(D,A){var B=Im(A)?A:"";return D?zRt+B+"-"+D:null}function I(D){try{if(D){var A=new Date;return D.getUTCFullYear()===A.getUTCFullYear()&&D.getUTCMonth()===A.getUTCMonth()&&D[D$]()===A[D$]()}}catch{}return!1}function S(D,A,B){try{var U={date:w(),count:0};if(D){var W=JSON.parse(D),ae={date:w(W[A$])||U[A$],count:W[u_]||U[u_],preTriggerDate:W.preTriggerDate?w(W[k$]):void 0};return ae}else return R(A,B,U),U}catch{}return null}function w(D){try{if(D){var A=new Date(D);if(!isNaN(A.getDate()))return A}else return new Date}catch{}return null}function R(D,A,B){try{return H$(D,A,sr(JSON[t1](B)))}catch{}return!1}function k(D,A,B){return D<=0?1:B>=A&&(B-A)%D==0?Math.floor((B-A)/D)+1:-1}function V(D,A,B,U){ze(A,U||1,D,B)}function F(D){try{var A=g(D);return ZM(1e6)<=A.limit.samplingRate}catch{}return!1}function K(D){try{var A=c[D];if(!A){var B=x(D,u);A=S(j$(s,B),s,B),c[D]=A}return c[D]}catch{}return null}function $(D){var A=l[D];if(Pe(A)){A=!1;var B=K(D);B&&(A=I(B[k$])),l[D]=A}return l[D]}function j(D){return d=d||{},Pe(d[D])&&(d[D]=[]),d[D]}}return n}()});function H3(n){if(!n)return{};var e=n[Wg]($Rt),t=jP(e,function(o,s){var a=s[Wg](WRt);if(a[Yt]===2){var c=a[0][Um](),l=a[1];o[c]=l}return o},{});if(ls(t)[Yt]>0){if(t.endpointsuffix){var r=t.location?t.location+".":"";t[l_]=t[l_]||"https://"+r+"dc."+t.endpointsuffix}t[l_]=t[l_]||c_,Lb(t[l_],"/")&&(t[l_]=t[l_].slice(0,-1))}return t}var $Rt,WRt,gje,vje=N(()=>{gr();dd();hs();$Rt=";",WRt="=";gje={parse:H3}});var z$,yje=N(()=>{gr();dd();hs();fd();z$=function(){function n(e,t,r){var o=this,s=this;s.ver=1,s.sampleRate=100,s.tags={},s[$o]=wr(e,r)||ms,s.data=t,s.time=Gl(new Date),s.aiDataContract={time:1,iKey:1,name:1,sampleRate:function(){return o.sampleRate===100?4:1},tags:1,data:1}}return n}()});var qm,bje=N(()=>{dd();hs();fd();qm=function(){function n(e,t,r,o){this.aiDataContract={ver:1,name:1,properties:0,measurements:0};var s=this;s.ver=2,s[$o]=wr(e,t)||ms,s[da]=Ma(e,r),s[Oa]=Fa(e,o)}return n.envelopeType="Microsoft.ApplicationInsights.{0}.Event",n.dataType="EventData",n}()});function zfe(n,e){var t=n;return t&&!Jt(t)&&(JSON&&JSON[t1]?(t=JSON[t1](n),e&&(!t||t==="{}")&&(At(n[Kg])?t=n[Kg]():t=""+n)):t=""+n+" - (Missing JSON.stringify)"),t||""}function Tje(n,e){var t=n;return n&&(t&&!Jt(t)&&(t=n[Gfe]||n[Ije]||t),t&&!Jt(t)&&(t=zfe(t,!0)),n.filename&&(t=t+" @"+(n.filename||"")+":"+(n.lineno||"?")+":"+(n.colno||"?"))),e&&e!=="String"&&e!=="Object"&&e!=="Error"&&sc(t||"",e)===-1&&(t=e+": "+t),t||""}function YRt(n){try{if(Zr(n))return"hasFullStack"in n&&"typeName"in n}catch{}return!1}function QRt(n){try{if(Zr(n))return"ver"in n&&"exceptions"in n&&"properties"in n}catch{}return!1}function xje(n){return n&&n.src&&Jt(n.src)&&n.obj&&bt(n.obj)}function u1(n){var e=n||"";Jt(e)||(Jt(e[ll])?e=e[ll]:e=""+e);var t=e[Wg](`
`);return{src:e,obj:t}}function XRt(n){for(var e=[],t=n[Wg](`
`),r=0;r<t[Yt];r++){var o=t[r];t[r+1]&&(o+="@"+t[r+1],r++),e[Yg](o)}return{src:n,obj:e}}function Cje(n){var e=null;if(n)try{if(n[ll])e=u1(n[ll]);else if(n[jA]&&n[jA][ll])e=u1(n[jA][ll]);else if(n.exception&&n.exception[ll])e=u1(n.exception[ll]);else if(xje(n))e=n;else if(xje(n[Vfe]))e=n[Vfe];else if(Hi()&&Hi().opera&&n[Gfe])e=XRt(n[Ip]);else if(n.reason&&n.reason[ll])e=u1(n.reason[ll]);else if(Jt(n))e=u1(n);else{var t=n[Gfe]||n[Ije]||"";Jt(n[_je])&&(t&&(t+=`
`),t+=" from "+n[_je]),t&&(e=u1(t))}}catch(r){e=u1(r)}return e||{src:"",obj:null}}function JRt(n){var e="";return n&&(n.obj?Ce(n.obj,function(t){e+=t+`
`}):e=n.src||""),e}function ZRt(n){var e,t=n.obj;if(t&&t[Yt]>0){e=[];var r=0,o=0;Ce(t,function(h){var g=h[Kg]();if($fe.regex.test(g)){var y=new $fe(g,r++);o+=y[r1],e[Yg](y)}});var s=32*1024;if(o>s)for(var a=0,c=e[Yt]-1,l=0,u=a,d=c;a<c;){var p=e[a][r1],f=e[c][r1];if(l+=p+f,l>s){var m=d-u+1;e.splice(u,m);break}u=a,d=c,a++,c--}}return e}function $$(n){var e="";if(n&&(e=n.typeName||n[$o]||"",!e))try{var t=/function (.{1,200})\(/,r=t.exec(n.constructor[Kg]());e=r&&r[Yt]>1?r[1]:""}catch{}return e}function Hfe(n){if(n)try{if(!Jt(n)){var e=$$(n),t=zfe(n,!1);return(!t||t==="{}")&&(n[jA]&&(n=n[jA],e=$$(n)),t=zfe(n,!0)),sc(t,e)!==0&&e!=="String"?e+":"+t:t}}catch{}return""+(n||"")}var KRt,jA,ll,Vfe,_je,Gfe,Ije,h_,Sje,$fe,Eje=N(()=>{Zc();gr();Mt();dd();hs();fd();KRt="<no_method>",jA="error",ll="stack",Vfe="stackDetails",_je="errorSrc",Gfe="message",Ije="description";h_=function(){function n(e,t,r,o,s,a){this.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0};var c=this;c.ver=2,QRt(t)?(c[n1]=t[n1]||[],c[da]=t[da],c[Oa]=t[Oa],t[i1]&&(c[i1]=t[i1]),t.id&&(c.id=t.id,t[da].id=t.id),t[N$]&&(c[N$]=t[N$]),Pe(t[L$])||(c[L$]=t[L$])):(r||(r={}),a&&(r.id=a),c[n1]=[new Sje(e,t,r)],c[da]=Ma(e,r),c[Oa]=Fa(e,o),s&&(c[i1]=s),a&&(c.id=a))}return n.CreateAutoException=function(e,t,r,o,s,a,c,l){var u,d=$$(s||a||e);return u={},u[Ip]=Tje(e,d),u.url=t,u.lineNumber=r,u.columnNumber=o,u.error=Hfe(s||a||e),u.evt=Hfe(a||e),u[Bm]=d,u.stackDetails=Cje(c||s||a),u.errorSrc=l,u},n.CreateFromInterface=function(e,t,r,o){var s=t[n1]&&hm(t[n1],function(c){return Sje[Rfe](e,c)}),a=new n(e,id(id({},t),{exceptions:s}),r,o);return a},n.prototype.toInterface=function(){var e,t=this,r=t.exceptions,o=t.properties,s=t.measurements,a=t.severityLevel,c=t.problemGroup,l=t.id,u=t.isManual,d=r instanceof Array&&hm(r,function(p){return p.toInterface()})||void 0;return e={ver:"4.0"},e[n1]=d,e.severityLevel=a,e.properties=o,e.measurements=s,e.problemGroup=c,e.id=l,e.isManual=u,e},n.CreateSimpleException=function(e,t,r,o,s,a){var c;return{exceptions:[(c={},c[U3]=!0,c.message=e,c.stack=s,c.typeName=t,c)]}},n.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",n.dataType="ExceptionData",n.formatError=Hfe,n}(),Sje=function(){function n(e,t,r){this.aiDataContract={id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2};var o=this;if(YRt(t))o[Bm]=t[Bm],o[Ip]=t[Ip],o[ll]=t[ll],o[pd]=t[pd]||[],o[U3]=t[U3];else{var s=t,a=s&&s.evt;Cb(s)||(s=s[jA]||a||s),o[Bm]=wr(e,$$(s))||ms,o[Ip]=UA(e,Tje(t||s,o[Bm]))||ms;var c=t[Vfe]||Cje(t);o[pd]=ZRt(c),bt(o[pd])&&hm(o[pd],function(l){l[o1]=wr(e,l[o1]),l[d_]=wr(e,l[d_])}),o[ll]=M$(e,JRt(c)),o.hasFullStack=bt(o.parsedStack)&&o.parsedStack[Yt]>0,r&&(r[Bm]=r[Bm]||o[Bm])}}return n.prototype.toInterface=function(){var e,t=this,r=t[pd]instanceof Array&&hm(t[pd],function(s){return s.toInterface()}),o=(e={id:t.id,outerId:t.outerId,typeName:t[Bm],message:t[Ip],hasFullStack:t[U3],stack:t[ll]},e[pd]=r||void 0,e);return o},n.CreateFromInterface=function(e,t){var r=t[pd]instanceof Array&&hm(t[pd],function(s){return $fe[Rfe](s)})||t[pd],o=new n(e,id(id({},t),{parsedStack:r}));return o},n}(),$fe=function(){function n(e,t){this.aiDataContract={level:1,method:1,assembly:0,fileName:0,line:0};var r=this;if(r[r1]=0,typeof e=="string"){var o=e;r[B3]=t,r[s1]=KRt,r[o1]=sr(o),r[d_]="",r[FA]=0;var s=o.match(n.regex);s&&s[Yt]>=5&&(r[s1]=sr(s[2])||r[s1],r[d_]=sr(s[4]),r[FA]=parseInt(s[5])||0)}else r[B3]=e[B3],r[s1]=e[s1],r[o1]=e[o1],r[d_]=e[d_],r[FA]=e[FA],r[r1]=0;r.sizeInBytes+=r.method[Yt],r.sizeInBytes+=r.fileName[Yt],r.sizeInBytes+=r.assembly[Yt],r[r1]+=n.baseSize,r.sizeInBytes+=r.level.toString()[Yt],r.sizeInBytes+=r.line.toString()[Yt]}return n.CreateFromInterface=function(e){return new n(e,null)},n.prototype.toInterface=function(){var e=this;return{level:e[B3],method:e[s1],assembly:e[o1],fileName:e[d_],line:e[FA]}},n.regex=/^([\s]+at)?[\s]{0,50}([^\@\()]+?)[\s]{0,50}(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/,n.baseSize=58,n}()});var wje,kje=N(()=>{wje=function(){function n(){this.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},this.kind=0}return n}()});var jm,Rje=N(()=>{dd();hs();kje();fd();jm=function(){function n(e,t,r,o,s,a,c,l,u){this.aiDataContract={ver:1,metrics:1,properties:0};var d=this;d.ver=2;var p=new wje;p[u_]=o>0?o:void 0,p.max=isNaN(a)||a===null?void 0:a,p.min=isNaN(s)||s===null?void 0:s,p[$o]=wr(e,t)||ms,p.value=r,p.stdDev=isNaN(c)||c===null?void 0:c,d.metrics=[p],d[da]=Ma(e,l),d[Oa]=Fa(e,u)}return n.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",n.dataType="MetricData",n}()});function Pje(n,e){return e===void 0&&(e=!1),n==null?e:n.toString()[Um]()==="true"}function HA(n){(isNaN(n)||n<0)&&(n=0),n=Math.round(n);var e=V3+n%1e3,t=V3+Math.floor(n/1e3)%60,r=V3+Math.floor(n/(1e3*60))%60,o=V3+Math.floor(n/(1e3*60*60))%24,s=Math.floor(n/(1e3*60*60*24));return e=e[Yt]===1?"00"+e:e[Yt]===2?"0"+e:e,t=t[Yt]<2?"0"+t:t,r=r[Yt]<2?"0"+r:r,o=o[Yt]<2?"0"+o:o,(s>0?s+".":V3)+o+":"+r+":"+t+"."+e}function Aje(n,e){var t=null;return Ce(n,function(r){if(r.identifier===e)return t=r,-1}),t}function Dje(n,e,t,r,o){return!o&&Jt(n)&&(n==="Script error."||n==="Script error")}var V3,W$=N(()=>{gr();hs();V3=""});var g_,Nje=N(()=>{dd();W$();hs();fd();g_=function(){function n(e,t,r,o,s,a,c){this.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0};var l=this;l.ver=2,l.id=F$(e,c),l.url=p_(e,r),l[$o]=wr(e,t)||ms,isNaN(o)||(l[a1]=HA(o)),l[da]=Ma(e,s),l[Oa]=Fa(e,a)}return n.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",n.dataType="PageviewData",n}()});var v_,Lje=N(()=>{W$();Ffe();hs();fd();v_=function(){function n(e,t,r,o,s,a,c,l,u,d,p,f){u===void 0&&(u="Ajax"),this.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0};var m=this;m.ver=2,m.id=t,m[a1]=HA(s),m.success=a,m.resultCode=c+"",m.type=wr(e,u);var h=nje(e,r,l,o);m.data=p_(e,o)||h.data,m.target=wr(e,h.target),d&&(m.target="".concat(m.target," | ").concat(d)),m[$o]=wr(e,h[$o]),m[da]=Ma(e,p),m[Oa]=Fa(e,f)}return n.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",n.dataType="RemoteDependencyData",n}()});var y_,Oje=N(()=>{dd();hs();fd();y_=function(){function n(e,t,r,o,s){this.aiDataContract={ver:1,message:1,severityLevel:0,properties:0};var a=this;a.ver=2,t=t||ms,a[Ip]=UA(e,t),a[da]=Ma(e,o),a[Oa]=Fa(e,s),r&&(a[i1]=r)}return n.envelopeType="Microsoft.ApplicationInsights.{0}.Message",n.dataType="MessageData",n}()});var b_,Mje=N(()=>{dd();hs();fd();b_=function(){function n(e,t,r,o,s,a,c){this.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0};var l=this;l.ver=2,l.url=p_(e,r),l[$o]=wr(e,t)||ms,l[da]=Ma(e,s),l[Oa]=Fa(e,a),c&&(l.domProcessing=c.domProcessing,l[a1]=c[a1],l.networkConnect=c.networkConnect,l.perfTotal=c.perfTotal,l[Pfe]=c[Pfe],l.sentRequest=c.sentRequest)}return n.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",n.dataType="PageviewPerformanceData",n}()});var Hm,Fje=N(()=>{Hm=function(){function n(e,t){this.aiDataContract={baseType:1,baseData:1},this.baseType=e,this.baseData=t}return n}()});var K$,Uje=N(()=>{gr();K$=Vo({Verbose:0,Information:1,Warning:2,Error:3,Critical:4})});var Bje,qje=N(()=>{gr();hs();Bje=function(){function n(){}return n.getConfig=function(e,t,r,o){o===void 0&&(o=!1);var s;return r&&e[F3]&&e[F3][r]&&!Pe(e[F3][r][t])?s=e[F3][r][t]:s=e[t],Pe(s)?o:s},n}()});function x_(n){var e="ai."+n+".";return function(t){return e+t}}var G3,gs,Y$,VA,Wfe,__,d1,z3,GA,Kfe=N(()=>{Zc();gr();G3=x_("application"),gs=x_("device"),Y$=x_("location"),VA=x_("operation"),Wfe=x_("session"),__=x_("user"),d1=x_("cloud"),z3=x_("internal"),GA=function(n){Jc(e,n);function e(){return n.call(this)||this}return e}(spe({applicationVersion:G3("ver"),applicationBuild:G3("build"),applicationTypeId:G3("typeId"),applicationId:G3("applicationId"),applicationLayer:G3("layer"),deviceId:gs("id"),deviceIp:gs("ip"),deviceLanguage:gs("language"),deviceLocale:gs("locale"),deviceModel:gs("model"),deviceFriendlyName:gs("friendlyName"),deviceNetwork:gs("network"),deviceNetworkName:gs("networkName"),deviceOEMName:gs("oemName"),deviceOS:gs("os"),deviceOSVersion:gs("osVersion"),deviceRoleInstance:gs("roleInstance"),deviceRoleName:gs("roleName"),deviceScreenResolution:gs("screenResolution"),deviceType:gs("type"),deviceMachineName:gs("machineName"),deviceVMName:gs("vmName"),deviceBrowser:gs("browser"),deviceBrowserVersion:gs("browserVersion"),locationIp:Y$("ip"),locationCountry:Y$("country"),locationProvince:Y$("province"),locationCity:Y$("city"),operationId:VA("id"),operationName:VA("name"),operationParentId:VA("parentId"),operationRootId:VA("rootId"),operationSyntheticSource:VA("syntheticSource"),operationCorrelationVector:VA("correlationVector"),sessionId:Wfe("id"),sessionIsFirst:Wfe("isFirst"),sessionIsNew:Wfe("isNew"),userAccountAcquisitionDate:__("accountAcquisitionDate"),userAccountId:__("accountId"),userAgent:__("userAgent"),userId:__("id"),userStoreRegion:__("storeRegion"),userAuthUserId:__("authUserId"),userAnonymousUserAcquisitionDate:__("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:__("authUserAcquisitionDate"),cloudName:d1("name"),cloudRole:d1("role"),cloudRoleVer:d1("roleVer"),cloudRoleInstance:d1("roleInstance"),cloudEnvironment:d1("environment"),cloudLocation:d1("location"),cloudDeploymentUnit:d1("deploymentUnit"),internalNodeName:z3("nodeName"),internalSdkVersion:z3("sdkVersion"),internalAgentVersion:z3("agentVersion"),internalSnippet:z3("snippet"),internalSdkSrc:z3("sdkSrc")}))});function Yfe(n,e,t,r,o,s){var a;t=wr(r,t)||ms,(Pe(n)||Pe(e)||Pe(t))&&qi("Input doesn't contain all required fields");var c="";n[E$]&&(c=n[E$],delete n[E$]);var l=(a={},a[$o]=t,a.time=Gl(new Date),a.iKey=c,a.ext=s||{},a.tags=[],a.data={},a.baseType=e,a.baseData=n,a);return Pe(o)||at(o,function(u,d){l.data[u]=d}),l}var jje,Hje=N(()=>{gr();dd();fd();hs();jje=function(){function n(){}return n.create=Yfe,n}()});var Vje,Wo,Gje=N(()=>{Kfe();Vje={UserExt:"user",DeviceExt:"device",TraceExt:"trace",WebExt:"web",AppExt:"app",OSExt:"os",SessionExt:"ses",SDKExt:"sdk"},Wo=new GA});function zje(n){var e=null;if(At(Event))e=new Event(n);else{var t=ji();t&&t.createEvent&&(e=t.createEvent("Event"),e.initEvent(n,!0,!0))}return e}var $je=N(()=>{gr()});function Wje(n,e){Gg(n,null,null,e)}function Q$(n){var e=ji(),t=Ho(),r=!1,o=[],s=1;t&&!Pe(t.onLine)&&!t.onLine&&(s=2);var a=0,c=f(),l=$l(ua("OfflineListener"),n);try{if(d(Hi())&&(r=!0),e){var u=e.body||e;u.ononline&&d(u)&&(r=!0)}}catch{r=!1}function d(x){var I=!1;return x&&(I=Rm(x,"online",g,l),I&&Rm(x,"offline",y,l)),I}function p(){return c}function f(){return!(a===2||s===2)}function m(){var x=f();c!==x&&(c=x,Ce(o,function(I){var S={isOnline:c,rState:s,uState:a};try{I(S)}catch{}}))}function h(x){a=x,m()}function g(){s=1,m()}function y(){s=2,m()}function b(){var x=Hi();if(x&&r){if(Wje(x,l),e){var I=e.body||e;Wt(I.ononline)||Wje(I,l)}r=!1}}function _(x){return o[Yg](x),{rm:function(){var I=o.indexOf(x);if(I>-1)return o.splice(I,1)}}}return{isOnline:p,isListening:function(){return r},unload:b,addListener:_,setOnlineState:h}}var Kje=N(()=>{gr();hs()});var Yje={};Dr(Yje,{AnalyticsPluginIdentifier:()=>tPt,BreezeChannelIdentifier:()=>Qfe,ConfigurationManager:()=>Bje,ConnectionStringParser:()=>gje,ContextTagKeys:()=>GA,CtxTagKeys:()=>Wo,DEFAULT_BREEZE_ENDPOINT:()=>c_,DEFAULT_BREEZE_PATH:()=>Fm,Data:()=>Hm,DisabledPropertyName:()=>$qe,DistributedTracingModes:()=>sje,Envelope:()=>z$,Event:()=>qm,EventPersistence:()=>aje,Exception:()=>h_,Extensions:()=>Vje,HttpMethod:()=>M3,Metric:()=>jm,PageView:()=>g_,PageViewPerformance:()=>b_,ProcessLegacy:()=>OA,PropertiesPluginIdentifier:()=>ePt,RemoteDependencyData:()=>v_,RequestHeaders:()=>e1,SampleRate:()=>LA,SeverityLevel:()=>K$,TelemetryItemCreator:()=>jje,ThrottleMgr:()=>mje,Trace:()=>y_,correlationIdCanIncludeCorrelationHeader:()=>eje,correlationIdGetCorrelationContext:()=>tje,correlationIdGetCorrelationContextValue:()=>Mfe,correlationIdGetPrefix:()=>Zqe,correlationIdSetPrefix:()=>Jqe,createDistributedTraceContextFromTrace:()=>oje,createDomEvent:()=>zje,createOfflineListener:()=>Q$,createTelemetryItem:()=>Yfe,createTraceParent:()=>p3,dataSanitizeException:()=>M$,dataSanitizeId:()=>F$,dataSanitizeInput:()=>U$,dataSanitizeKey:()=>Afe,dataSanitizeKeyAndAddUniqueness:()=>O$,dataSanitizeMeasurements:()=>Fa,dataSanitizeMessage:()=>UA,dataSanitizeProperties:()=>Ma,dataSanitizeString:()=>wr,dataSanitizeUrl:()=>p_,dateTimeUtilsDuration:()=>ije,dateTimeUtilsNow:()=>rje,dsPadNumber:()=>Dfe,findW3cTraceParent:()=>h3,formatTraceParent:()=>m3,getExtensionByName:()=>Aje,isBeaconApiSupported:()=>sl,isCrossOriginError:()=>Dje,isInternalApplicationInsightsEndpoint:()=>j3,isSampledFlag:()=>f3,isValidSpanId:()=>wm,isValidTraceId:()=>Em,isValidTraceParent:()=>vA,msToTimeSpan:()=>HA,parseConnectionString:()=>H3,parseTraceParent:()=>qI,strNotSpecified:()=>ms,stringToBoolOrDefault:()=>Pje,urlGetAbsoluteUrl:()=>Yqe,urlGetCompleteUrl:()=>Xqe,urlGetPathName:()=>Qqe,urlParseFullHost:()=>q3,urlParseHost:()=>Nfe,urlParseUrl:()=>c1,utlCanUseLocalStorage:()=>qA,utlCanUseSessionStorage:()=>l1,utlDisableStorage:()=>lje,utlEnableStorage:()=>uje,utlGetLocalStorage:()=>j$,utlGetSessionStorage:()=>V$,utlGetSessionStorageKeys:()=>pje,utlRemoveSessionStorage:()=>fje,utlRemoveStorage:()=>dje,utlSetLocalStorage:()=>H$,utlSetSessionStorage:()=>G$,utlSetStoragePrefix:()=>q$});var ePt,Qfe,tPt,Qg=N(()=>{Ffe();hje();vje();Efe();dd();yje();bje();Eje();Rje();Nje();Lje();Oje();Mje();Fje();Uje();qje();Kfe();fd();Hje();Gje();Ufe();W$();gr();$je();jfe();Lfe();Kje();ePt="AppInsightsPropertiesPlugin",Qfe="AppInsightsChannelPlugin",tPt="ApplicationInsightsAnalytics"});var S_,Qje=N(()=>{S_="duration"});var Ko,X$,pa,Vm,p1,dn,I_,T_,md,C_,Xg,zA,Jg,Zg,J$,ev,$3,E_,W3,$A,f1,K3,Z$,tv,WA,KA,fa,eW,YA,tW,Xfe,nW,rW,Jfe,iW,Zfe,nv,eme,tme,nme,rme,Y3,ime,ome,sme,QA,w_,oW,Q3,sW,Xje,aW,cW,XA,ame,lW,Jje,k_=N(()=>{Ko="tags",X$="deviceType",pa="data",Vm="name",p1="traceID",dn="length",I_="stringify",T_="measurements",md="dataType",C_="envelopeType",Xg="toString",zA="_get",Jg="enqueue",Zg="count",J$="eventsLimitInMem",ev="push",$3="emitLineDelimitedJson",E_="clear",W3="createNew",$A="markAsSent",f1="clearSent",K3="bufferOverride",Z$="BUFFER_KEY",tv="SENT_BUFFER_KEY",WA="MAX_BUFFER_SIZE",KA="triggerSend",fa="diagLog",eW="initialize",YA="_sender",tW="customHeaders",Xfe="maxBatchSizeInBytes",nW="onunloadDisableBeacon",rW="isBeaconApiDisabled",Jfe="alwaysUseXhrOverride",iW="disableXhr",Zfe="enableSessionStorageBuffer",nv="_buffer",eme="onunloadDisableFetch",tme="disableSendBeaconSplit",nme="instrumentationKey",rme="enableSendPromise",Y3="getSenderInst",ime="unloadTransports",ome="convertUndefined",sme="maxBatchInterval",QA="serialize",w_="_onError",oW="_onPartialSuccess",Q3="_onSuccess",sW="itemsAccepted",Xje="itemsReceived",aW="oriPayload",cW="baseType",XA="sampleRate",ame="eventsSendRequest",lW="getSamplingScore",Jje="getHashCodeScore"});function Yo(n,e,t){return ad(n,e,t,Zu)}function nPt(n,e,t){var r=t[Ko]=t[Ko]||{},o=e.ext=e.ext||{},s=e[Ko]=e[Ko]||[],a=o.user;a&&(Yo(r,Wo.userAuthUserId,a.authId),Yo(r,Wo.userId,a.id||a.localId));var c=o.app;c&&Yo(r,Wo.sessionId,c.sesId);var l=o.device;l&&(Yo(r,Wo.deviceId,l.id||l.localId),Yo(r,Wo[X$],l.deviceClass),Yo(r,Wo.deviceIp,l.ip),Yo(r,Wo.deviceModel,l.model),Yo(r,Wo[X$],l[X$]));var u=e.ext.web;if(u){Yo(r,Wo.deviceLanguage,u.browserLang),Yo(r,Wo.deviceBrowserVersion,u.browserVer),Yo(r,Wo.deviceBrowser,u.browser);var d=t[pa]=t[pa]||{},p=d[Ti]=d[Ti]||{},f=p[qs]=p[qs]||{};Yo(f,"domain",u.domain),Yo(f,"isManual",u.isManual?Zje:null),Yo(f,"screenRes",u.screenRes),Yo(f,"userConsent",u.userConsent?Zje:null)}var m=o.os;m&&Yo(r,Wo.deviceOS,m[Vm]);var h=o.trace;h&&(Yo(r,Wo.operationParentId,h.parentID),Yo(r,Wo.operationName,wr(n,h[Vm])),Yo(r,Wo.operationId,h[p1]));for(var g={},y=s[dn]-1;y>=0;y--){var b=s[y];at(b,function(x,I){g[x]=I}),s.splice(y,1)}at(s,function(x,I){g[x]=I});var _=id(id({},r),g);_[Wo.internalSdkVersion]||(_[Wo.internalSdkVersion]=wr(n,"javascript:".concat(rPt.Version),64)),t[Ko]=cd(_)}function R_(n,e,t){Pe(n)||at(n,function(r,o){Pa(o)?t[r]=o:Jt(o)?e[r]=o:xm()&&(e[r]=la()[I_](o))})}function m1(n,e){Pe(n)||at(n,function(t,r){n[t]=r||e})}function h1(n,e,t,r){var o=new z$(n,r,e);Yo(o,"sampleRate",t[LA]),(t[Ti]||{}).startTime&&(o.time=Gl(t[Ti].startTime)),o.iKey=t.iKey;var s=t.iKey.replace(/-/g,"");return o[Vm]=o[Vm].replace("{0}",s),nPt(n,t,o),t[Ko]=t[Ko]||[],cd(o)}function g1(n,e){Pe(e[Ti])&&ze(n,1,46,"telemetryItem.baseData cannot be null.")}function eHe(n,e,t){g1(n,e);var r=e[Ti][T_]||{},o=e[Ti][qs]||{};R_(e[pa],o,r),Pe(t)||m1(o,t);var s=e[Ti];if(Pe(s))return cc(n,"Invalid input for dependency data"),null;var a=s[qs]&&s[qs][M3]?s[qs][M3]:"GET",c=new v_(n,s.id,s.target,s[Vm],s[S_],s.success,s.responseCode,a,s.type,s.correlationContext,o,r),l=new Hm(v_[md],c);return h1(n,v_[C_],e,l)}function lme(n,e,t){g1(n,e);var r={},o={};e[cme]!==qm[md]&&(r.baseTypeSource=e[cme]),e[cme]===qm[md]?(r=e[Ti][qs]||{},o=e[Ti][T_]||{}):e[Ti]&&R_(e[Ti],r,o),R_(e[pa],r,o),Pe(t)||m1(r,t);var s=e[Ti][Vm],a=new qm(n,s,r,o),c=new Hm(qm[md],a);return h1(n,qm[C_],e,c)}function tHe(n,e,t){g1(n,e);var r=e[Ti][T_]||{},o=e[Ti][qs]||{};R_(e[pa],o,r),Pe(t)||m1(o,t);var s=e[Ti],a=h_.CreateFromInterface(n,s,o,r),c=new Hm(h_[md],a);return h1(n,h_[C_],e,c)}function nHe(n,e,t){g1(n,e);var r=e[Ti],o=r[qs]||{},s=r[T_]||{};R_(e[pa],o,s),Pe(t)||m1(o,t);var a=new jm(n,r[Vm],r.average,r.sampleCount,r.min,r.max,r.stdDev,o,s),c=new Hm(jm[md],a);return h1(n,jm[C_],e,c)}function rHe(n,e,t){g1(n,e);var r,o=e[Ti];!Pe(o)&&!Pe(o[qs])&&!Pe(o[qs][S_])?(r=o[qs][S_],delete o[qs][S_]):!Pe(e[pa])&&!Pe(e[pa][S_])&&(r=e[pa][S_],delete e[pa][S_]);var s=e[Ti],a;((e.ext||{}).trace||{})[p1]&&(a=e.ext.trace[p1]);var c=s.id||a,l=s[Vm],u=s.uri,d=s[qs]||{},p=s[T_]||{};if(Pe(s.refUri)||(d.refUri=s.refUri),Pe(s.pageType)||(d.pageType=s.pageType),Pe(s.isLoggedIn)||(d.isLoggedIn=s.isLoggedIn[Xg]()),!Pe(s[qs])){var f=s[qs];at(f,function(g,y){d[g]=y})}R_(e[pa],d,p),Pe(t)||m1(d,t);var m=new g_(n,l,u,r,d,p,c),h=new Hm(g_[md],m);return h1(n,g_[C_],e,h)}function iHe(n,e,t){g1(n,e);var r=e[Ti],o=r[Vm],s=r.uri||r.url,a=r[qs]||{},c=r[T_]||{};R_(e[pa],a,c),Pe(t)||m1(a,t);var l=new b_(n,o,s,void 0,a,c,r),u=new Hm(b_[md],l);return h1(n,b_[C_],e,u)}function oHe(n,e,t){g1(n,e);var r=e[Ti].message,o=e[Ti].severityLevel,s=e[Ti][qs]||{},a=e[Ti][T_]||{};R_(e[pa],s,a),Pe(t)||m1(s,t);var c=new y_(n,r,o,s,a),l=new Hm(y_[md],c);return h1(n,y_[C_],e,l)}var cme,Ti,qs,Zje,rPt,sHe=N(()=>{Zc();Qg();gr();Qje();k_();cme="baseType",Ti="baseData",qs="properties",Zje="true";rPt={Version:"3.1.1"}});var aHe,uW,ume,cHe=N(()=>{Zc();Fs();Qg();gr();k_();aHe=function(){function n(e,t){var r=[],o=!1;this[zA]=function(){return r},this._set=function(s){return r=s,r},wn(n,this,function(s){s[Jg]=function(a){if(s[Zg]()>=t[J$]){o||(ze(e,2,105,"Maximum in-memory buffer size reached: "+s[Zg](),!0),o=!0);return}r[ev](a)},s[Zg]=function(){return r[dn]},s.size=function(){for(var a=r[dn],c=0;c<r[dn];c++)a+=r[c][dn];return t[$3]||(a+=2),a},s[E_]=function(){r=[],o=!1},s.getItems=function(){return r.slice(0)},s.batchPayloads=function(a){if(a&&a[dn]>0){var c=t[$3]?a.join(`
`):"["+a.join(",")+"]";return c}return null},s[W3]=function(a,c,l){var u=r.slice(0);a=a||e,c=c||{};var d=l?new ume(a,c):new uW(a,c);return Ce(u,function(p){d[Jg](p)}),d}})}return n.__ieDyn=1,n}(),uW=function(n){Jc(e,n);function e(t,r){var o=n.call(this,t,r)||this;return wn(e,o,function(s,a){s[$A]=function(c){a[E_]()},s[f1]=function(c){}}),o}return e.__ieDyn=1,e}(aHe),ume=function(n){Jc(e,n);function e(t,r){var o=n.call(this,t,r)||this,s=!1,a=r?.namePrefix,c=r[K3]||{getItem:V$,setItem:G$},l=c.getItem,u=c.setItem;return wn(e,o,function(d,p){var f=y(e[Z$]),m=y(e[tv]),h=d._set(f.concat(m));h[dn]>e[WA]&&(h[dn]=e[WA]),b(e[tv],[]),b(e[Z$],h),d[Jg]=function(_){if(d[Zg]()>=e[WA]){s||(ze(t,2,67,"Maximum buffer size reached: "+d[Zg](),!0),s=!0);return}p[Jg](_),b(e.BUFFER_KEY,d[zA]())},d[E_]=function(){p[E_](),b(e.BUFFER_KEY,d[zA]()),b(e[tv],[]),s=!1},d[$A]=function(_){b(e[Z$],d._set(g(_,d[zA]())));var x=y(e[tv]);x instanceof Array&&_ instanceof Array&&(x=x.concat(_),x[dn]>e[WA]&&(ze(t,1,67,"Sent buffer reached its maximum size: "+x[dn],!0),x[dn]=e[WA]),b(e[tv],x))},d[f1]=function(_){var x=y(e[tv]);x=g(_,x),b(e[tv],x)},d[W3]=function(_,x,I){I=!!I;var S=d[zA]().slice(0),w=y(e[tv]).slice(0);_=_||t,x=x||{},d[E_]();var R=I?new e(_,x):new uW(_,x);return Ce(S,function(k){R[Jg](k)}),I&&R[$A](w),R};function g(_,x){var I=[];return Ce(x,function(S){!At(S)&&er(_,S)===-1&&I[ev](S)}),I}function y(_){var x=_;try{x=a?a+"_"+x:x;var I=l(t,x);if(I){var S=la().parse(I);if(Jt(S)&&(S=la().parse(S)),S&&bt(S))return S}}catch(w){ze(t,1,42," storage key: "+x+", "+ei(w),{exception:rt(w)})}return[]}function b(_,x){var I=_;try{I=a?a+"_"+I:I;var S=JSON[I_](x);u(t,I,S)}catch(w){u(t,I,JSON[I_]([])),ze(t,2,41," storage key: "+I+", "+ei(w)+". Buffer cleared",{exception:rt(w)})}}}),o}return e.BUFFER_KEY="AI_buffer",e.SENT_BUFFER_KEY="AI_sentBuffer",e.MAX_BUFFER_SIZE=2e3,e}(aHe)});var lHe,uHe=N(()=>{Fs();gr();k_();lHe=function(){function n(e){wn(n,this,function(t){t[QA]=function(a){var c=r(a,"root");try{return la()[I_](c)}catch(l){ze(e,1,48,l&&At(l[Xg])?l[Xg]():"Error serializing object",null,!0)}};function r(a,c){var l="__aiCircularRefCheck",u={};if(!a)return ze(e,1,48,"cannot serialize object because it is null or undefined",{name:c},!0),u;if(a[l])return ze(e,2,50,"Circular reference detected while serializing object",{name:c},!0),u;if(!a.aiDataContract){if(c==="measurements")u=s(a,"number",c);else if(c==="properties")u=s(a,"string",c);else if(c==="tags")u=s(a,"string",c);else if(bt(a))u=o(a,c);else{ze(e,2,49,"Attempting to serialize an object which does not implement ISerializable",{name:c},!0);try{la()[I_](a),u=a}catch(d){ze(e,1,48,d&&At(d[Xg])?d[Xg]():"Error serializing object",null,!0)}}return u}return a[l]=!0,at(a.aiDataContract,function(d,p){var f=At(p)?p()&1:p&1,m=At(p)?p()&4:p&4,h=p&2,g=a[d]!==void 0,y=Zr(a[d])&&a[d]!==null;if(f&&!g&&!h)ze(e,1,24,"Missing required field specification. The field is required but not present on source",{field:d,name:c});else if(!m){var b=void 0;y?h?b=o(a[d],d):b=r(a[d],d):b=a[d],b!==void 0&&(u[d]=b)}}),delete a[l],u}function o(a,c){var l;if(a)if(!bt(a))ze(e,1,54,`This field was specified as an array in the contract but the item is not an array.\r
`,{name:c},!0);else{l=[];for(var u=0;u<a[dn];u++){var d=a[u],p=r(d,c+"["+u+"]");l[ev](p)}}return l}function s(a,c,l){var u;return a&&(u={},at(a,function(d,p){if(c==="string")p===void 0?u[d]="undefined":p===null?u[d]="null":p[Xg]?u[d]=p[Xg]():u[d]="invalid field: toString() is not defined.";else if(c==="number")if(p===void 0)u[d]="undefined";else if(p===null)u[d]="null";else{var f=parseFloat(p);u[d]=f}else u[d]="invalid field: "+l+" is of unknown type.",ze(e,1,u[d],null,!0)})),u}})}return n.__ieDyn=1,n}()});var iPt,dHe,pHe=N(()=>{k_();iPt=8,dHe=function(){function n(){}return n.prototype.getHashCodeScore=function(e){var t=this.getHashCode(e)/n.INT_MAX_VALUE;return t*100},n.prototype.getHashCode=function(e){if(e==="")return 0;for(;e[dn]<iPt;)e=e.concat(e);for(var t=5381,r=0;r<e[dn];++r)t=(t<<5)+t+e.charCodeAt(r),t=t&t;return Math.abs(t)},n.INT_MAX_VALUE=2147483647,n}()});var fHe,mHe=N(()=>{Qg();k_();pHe();fHe=function(){function n(){var e=this,t=new dHe,r=new GA;e[lW]=function(o){var s=0;return o[Ko]&&o[Ko][r.userId]?s=t.getHashCodeScore(o[Ko][r.userId]):o.ext&&o.ext.user&&o.ext.user.id?s=t[Jje](o.ext.user.id):o[Ko]&&o[Ko][r.operationId]?s=t.getHashCodeScore(o[Ko][r.operationId]):o.ext&&o.ext.telemetryTrace&&o.ext.telemetryTrace[p1]?s=t.getHashCodeScore(o.ext.telemetryTrace[p1]):s=Math.random()*100,s}}return n}()});var hHe,gHe=N(()=>{Qg();gr();k_();mHe();hHe=function(){function n(e,t){this.INT_MAX_VALUE=2147483647;var r=t||bp(null);(e>100||e<0)&&(r.throwInternal(2,58,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),e=100),this[XA]=e,this.samplingScoreGenerator=new fHe}return n.prototype.isSampledIn=function(e){var t=this[XA],r=!1;return t==null||t>=100||e.baseType===jm[md]?!0:(r=this.samplingScoreGenerator[lW](e)<t,r)},n}()});function yHe(n){try{return n.responseText}catch{}return null}function sPt(n){return n&&n.sendPOST}function aPt(n){return!isNaN(n)&&n>0&&n<=100}var Ci,rv,Gm,vHe,oPt,bHe,cPt,X3,_He=N(()=>{Zc();Fs();Qg();gr();Mt();sHe();cHe();uHe();gHe();k_();Gm=void 0,vHe="",oPt=65e3;bHe=oc((Ci={endpointUrl:mA(Zu,c_+Fm)},Ci[$3]=ld(),Ci[sme]=15e3,Ci[Xfe]=102400,Ci.disableTelemetry=ld(),Ci[Zfe]=ld(!0),Ci.isRetryDisabled=ld(),Ci[rW]=ld(!0),Ci[tme]=ld(!0),Ci[iW]=ld(),Ci[eme]=ld(),Ci[nW]=ld(),Ci[nme]=Gm,Ci.namePrefix=Gm,Ci.samplingPercentage=mA(aPt,100),Ci[tW]=Gm,Ci[ome]=Gm,Ci[J$]=1e4,Ci[K3]=!1,Ci.httpXHROverride={isVal:sPt,v:Gm},Ci[Jfe]=ld(),Ci.transports=Gm,Ci.retryCodes=Gm,Ci));cPt=(rv={},rv[qm.dataType]=lme,rv[y_.dataType]=oHe,rv[g_.dataType]=rHe,rv[b_.dataType]=iHe,rv[h_.dataType]=tHe,rv[jm.dataType]=nHe,rv[v_.dataType]=eHe,rv),X3=function(n){Jc(e,n);function e(){var t=n.call(this)||this;t.priority=1001,t.identifier=Qfe;var r,o,s,a,c,l,u,d,p=0,f,m,h,g,y,b,_,x,I,S,w,R,k,V,F,K,$,j,D,A,B,U,W,ae,Y,X,Se;return wn(e,t,function(te,Ie){wt(),te.pause=function(){Je(),a=!0},te.resume=function(){a&&(a=!1,o=null,wi(),hd())},te.flush=function(J,ue,ve){if(J===void 0&&(J=!0),!a){Je();try{return te[KA](J,null,ve||1)}catch(Re){ze(te[fa](),1,22,"flush failed, telemetry will not be collected: "+ei(Re),{exception:rt(Re)})}}},te.onunloadFlush=function(){if(!a)if(_||A)try{return te[KA](!0,D_,2)}catch(J){ze(te[fa](),1,20,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+ei(J),{exception:rt(J)})}else te.flush(!1)},te.addHeader=function(J,ue){d[J]=ue},te[eW]=function(J,ue,ve,Re){te.isInitialized()&&ze(te[fa](),1,28,"Sender is already initialized"),Ie[eW](J,ue,ve,Re);var Q=te.identifier;l=new lHe(ue.logger),r=0,o=null,s=0,te[YA]=null,u=0;var ie=te[fa]();h=$l(ua("Sender"),ue.evtNamespace&&ue.evtNamespace()),m=Q$(h),te._addHook(zo(J,function(pe){var Ae=pe.cfg;Ae.storagePrefix&&q$(Ae.storagePrefix);var ut=lc(null,Ae,ue),je=ut.getExtCfg(Q,bHe);lr(te,"_senderConfig",{g:function(){return je}}),y!==je.endpointUrl&&(g=y=je.endpointUrl),S&&S!==je[tW]&&Ce(S,function(Hs){delete d[Hs.header]}),b=je[Xfe],_=(je[nW]===!1||je[rW]===!1)&&sl(),x=je[nW]===!1&&sl(),I=je[rW]===!1&&sl(),A=je[Jfe],B=!!je[iW],Se=je.retryCodes;var Bn=je[K3],Yn=!!je[Zfe]&&(!!Bn||l1()),Co=je.namePrefix,ul=Yn!==K||Yn&&j!==Co||Yn&&$!==Bn;if(te[nv]){if(ul)try{te._buffer=te._buffer[W3](ie,je,Yn)}catch(Hs){ze(te[fa](),1,12,"failed to transfer telemetry to different buffer storage, telemetry will be lost: "+ei(Hs),{exception:rt(Hs)})}wi()}else te[nv]=Yn?new ume(ie,je):new uW(ie,je);j=Co,K=Yn,$=Bn,U=!je[eme]&&Dg(!0),Y=!!je[tme],te._sample=new hHe(je.samplingPercentage,ie),R=je[nme],Ye(R,Ae)||ze(ie,1,100,"Invalid Instrumentation key "+R),S=je[tW],!j3(g)&&S&&S[dn]>0?Ce(S,function(Hs){t.addHeader(Hs.header,Hs.value)}):S=null,D=je[rme];var av=Ut();X?X.SetConfig(av):(X=new HI,X[eW](av,ie));var Ua=je.httpXHROverride,cv=null,L_=null,XHe=Og([3,1,2],je.transports);cv=X&&X[Y3](XHe,!1);var wW=X&&X.getFallbackInst();W=function(Hs,O_){return Ft(wW,Hs,O_)},ae=function(Hs,O_){return Ft(wW,Hs,O_,!1)},cv=A?Ua:cv||Ua||wW,te[YA]=function(Hs,O_){return Ft(cv,Hs,O_)},U&&(f=N_);var kW=Og([3,1],je[ime]);U||(kW=kW.filter(function(Hs){return Hs!==2})),L_=X&&X[Y3](kW,!0),L_=A?Ua:L_||Ua,(A||je[ime]||!f)&&L_&&(f=function(Hs,O_){return Ft(L_,Hs,O_)}),f||(f=W),w=je.disableTelemetry,k=je[ome]||Gm,V=je.isRetryDisabled,F=je[sme]}))},te.processTelemetry=function(J,ue){ue=te._getTelCtx(ue);var ve=ue[fa]();try{var Re=mt(J,ve);if(!Re)return;var Q=G(J,ve);if(!Q)return;var ie=l[QA](Q),pe=te[nv];wi(ie),pe[Jg](ie),hd()}catch(Ae){ze(ve,2,12,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+ei(Ae),{exception:rt(Ae)})}te.processNext(J,ue)},te.isCompletelyIdle=function(){return!a&&p===0&&te._buffer[Zg]()===0},te._xhrReadyStateChange=function(J,ue,ve){return Nn(J,ue,ve)},te[KA]=function(J,ue,ve){J===void 0&&(J=!0);var Re;if(!a)try{var Q=te[nv];if(w)Q[E_]();else{if(Q[Zg]()>0){var ie=Q.getItems();Ue(ve||0,J),ue?Re=ue.call(te,ie,J):Re=te[YA](ie,J)}s=+new Date}Je()}catch(Ae){var pe=KM();(!pe||pe>9)&&ze(te[fa](),1,40,"Telemetry transmission failed, some telemetry will be lost: "+ei(Ae),{exception:rt(Ae)})}return Re},te.getOfflineSupport=function(){var J;return J={getUrl:function(){return g},createPayload:Ne},J[QA]=de,J.batch=me,J.shouldProcess=function(ue){return!!mt(ue)},J},te._doTeardown=function(J,ue){te.onunloadFlush(),Ug(m,!1),wt()},te[w_]=function(J,ue,ve){ze(te[fa](),2,26,"Failed to send telemetry.",{message:ue}),te._buffer&&te._buffer[f1](J)},te[oW]=function(J,ue){for(var ve=[],Re=[],Q=ue.errors.reverse(),ie=0,pe=Q;ie<pe.length;ie++){var Ae=pe[ie],ut=J.splice(Ae.index,1)[0];sv(Ae.statusCode)?Re[ev](ut):ve[ev](ut)}J[dn]>0&&te[Q3](J,ue[sW]),ve[dn]>0&&te[w_](ve,Lg(null,["partial success",ue[sW],"of",ue.itemsReceived].join(" "))),Re[dn]>0&&(Ep(Re),ze(te[fa](),2,40,"Partial success. Delivered: "+J[dn]+", Failed: "+ve[dn]+". Will retry to send "+Re[dn]+" our of "+ue[Xje]+" items"))},te[Q3]=function(J,ue){te._buffer&&te._buffer[f1](J)},te._xdrOnLoad=function(J,ue){return Xe(J,ue)};function Xe(J,ue){var ve=yHe(J);if(J&&(ve+""=="200"||ve===""))r=0,te[Q3](ue,0);else{var Re=MI(ve);Re&&Re.itemsReceived&&Re.itemsReceived>Re[sW]&&!V?te[oW](ue,Re):te[w_](ue,OI(J))}}function Ut(){var J;try{var ue={xdrOnComplete:function(Re,Q,ie){var pe=xe(ie);if(pe)return Xe(Re,pe)},fetchOnComplete:function(Re,Q,ie,pe){var Ae=xe(pe);if(Ae)return ma(Re.status,Ae,Re.url,Ae[dn],Re.statusText,ie||"")},xhrOnComplete:function(Re,Q,ie){var pe=xe(ie);if(pe)return Nn(Re,pe,pe[dn])},beaconOnRetry:function(Re,Q,ie){return ov(Re,Q,ie)}},ve=(J={},J[rme]=D,J.isOneDs=!1,J.disableCredentials=!1,J[iW]=B,J.disableBeacon=!I,J.disableBeaconSync=!x,J.senderOnCompleteCallBack=ue,J);return ve}catch{}return null}function Nn(J,ue,ve){J.readyState===4&&ma(J.status,ue,J.responseURL,ve,Lg(J),yHe(J)||J.response)}function xe(J){try{if(J){var ue=J,ve=ue[aW];return ve&&ve[dn]?ve:null}}catch{}return null}function mt(J,ue){if(w)return!1;if(!J)return ue&&ze(ue,1,7,"Cannot send empty telemetry"),!1;if(J.baseData&&!J[cW])return ue&&ze(ue,1,70,"Cannot send telemetry without baseData and baseType"),!1;if(J[cW]||(J[cW]="EventData"),!te[YA])return ue&&ze(ue,1,28,"Sender was not initialized"),!1;if(Ee(J))J[LA]=te._sample[XA];else return ue&&ze(ue,2,33,"Telemetry item was sampled out and not sent",{SampleRate:te._sample[XA]}),!1;return!0}function G(J,ue){var ve=J.iKey||R,Re=e.constructEnvelope(J,ve,ue,k);if(!Re){ze(ue,1,47,"Unable to create an AppInsights envelope");return}var Q=!1;if(J[Ko]&&J[Ko][OA]&&(Ce(J[Ko][OA],function(ie){try{ie&&ie(Re)===!1&&(Q=!0,cc(ue,"Telemetry processor check returns false"))}catch(pe){ze(ue,1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+ei(pe),{exception:rt(pe)},!0)}}),delete J[Ko][OA]),!Q)return Re}function de(J){var ue=vHe,ve=te[fa]();try{var Re=mt(J,ve),Q=null;Re&&(Q=G(J,ve)),Q&&(ue=l[QA](Q))}catch{}return ue}function me(J){var ue=vHe;return J&&J[dn]&&(ue="["+J.join(",")+"]"),ue}function Ne(J){var ue,ve=Gr();return ue={urlString:g},ue[pa]=J,ue.headers=ve,ue}function Ee(J){return te._sample.isSampledIn(J)}function St(J,ue,ve,Re){ue===200&&J?te._onSuccess(J,J[dn]):Re&&te[w_](J,Re)}function Ft(J,ue,ve,Re){Re===void 0&&(Re=!0);var Q=function(Ae,ut,je){return St(ue,Ae,ut,je)},ie=vr(ue),pe=J&&J.sendPOST;return pe&&ie?(Re&&te._buffer[$A](ue),pe(ie,Q,!ve)):null}function vr(J){var ue;if(bt(J)&&J[dn]>0){var ve=te[nv].batchPayloads(J),Re=Gr(),Q=(ue={},ue[pa]=ve,ue.urlString=g,ue.headers=Re,ue.disableXhrSync=B,ue.disableFetchKeepAlive=!U,ue[aW]=J,ue);return Q}return null}function Gr(){try{var J=d||{};return j3(g)&&(J[e1[6]]=e1[7]),J}catch{}return null}function wi(J){var ue=J?J[dn]:0;return te[nv].size()+ue>b?((!m||m.isOnline())&&te[KA](!0,null,10),!0):!1}function ma(J,ue,ve,Re,Q,ie){var pe=null;if(te._appId||(pe=MI(ie),pe&&pe.appId&&(te._appId=pe.appId)),(J<200||J>=300)&&J!==0){if((J===301||J===307||J===308)&&!Cp(ve)){te[w_](ue,Q);return}!V&&sv(J)?(Ep(ue),ze(te[fa](),2,40,". Response code "+J+". Will retry to send "+ue[dn]+" items.")):te[w_](ue,Q)}else if(m&&!m.isOnline()){if(!V){var Ae=10;Ep(ue,Ae),ze(te[fa](),2,40,". Offline - Response Code: ".concat(J,". Offline status: ").concat(!m.isOnline(),". Will retry to send ").concat(ue.length," items."))}}else Cp(ve),J===206?(pe||(pe=MI(ie)),pe&&!V?te[oW](ue,pe):te[w_](ue,Q)):(r=0,te[Q3](ue,Re))}function Cp(J){return u>=10?!1:!Pe(J)&&J!==""&&J!==g?(g=J,++u,!0):!1}function D_(J,ue){if(f)f(J,!1);else{var ve=X&&X[Y3]([3],!0);return Ft(ve,J,ue)}}function ov(J,ue,ve){var Re=J,Q=Re&&Re[aW];if(Y)ae&&ae(Q,!0),ze(te[fa](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender.");else{for(var ie=[],pe=0;pe<Q[dn];pe++){var Ae=Q[pe],ut=[Ae],je=vr(ut);ve(je,ue)?te._onSuccess(ut,ut[dn]):ie[ev](Ae)}ie[dn]>0&&(ae&&ae(ie,!0),ze(te[fa](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}function N_(J,ue){var ve=null;if(bt(J)){for(var Re=J[dn],Q=0;Q<J[dn];Q++)Re+=J[Q][dn];var ie=X.getSyncFetchPayload();ie+Re<=oPt?ve=2:sl()?ve=3:(ve=1,ze(te[fa](),2,40,". Failed to send telemetry with Beacon API, retried with xhrSender."));var pe=X&&X[Y3]([ve],!0);return Ft(pe,J,ue)}return null}function Ep(J,ue){if(ue===void 0&&(ue=1),!(!J||J[dn]===0)){var ve=te[nv];ve[f1](J),r++;for(var Re=0,Q=J;Re<Q.length;Re++){var ie=Q[Re];ve[Jg](ie)}v1(ue),hd()}}function v1(J){var ue=10,ve;if(r<=1)ve=ue;else{var Re=(Math.pow(2,r)-1)/2,Q=Math.floor(Math.random()*Re*ue)+1;Q=J*Q,ve=Math.max(Math.min(Q,3600),ue)}var ie=Vi()+ve*1e3;o=ie}function hd(){if(!c&&!a){var J=o?Math.max(0,o-Vi()):0,ue=Math.max(F,J);c=Xc(function(){c=null,te[KA](!0,null,1)},ue)}}function Je(){c&&c.cancel(),c=null,o=null}function sv(J){return Pe(Se)?J===401||J===408||J===429||J===500||J===502||J===503||J===504:Se[dn]&&Se.indexOf(J)>-1}function ne(){var J="getNotifyMgr";return te.core[J]?te.core[J]():te.core._notificationManager}function Ue(J,ue){var ve=ne();if(ve&&ve[ame])try{ve[ame](J,ue)}catch(Re){ze(te[fa](),1,74,"send request notification failed: "+ei(Re),{exception:rt(Re)})}}function Ye(J,ue){var ve=ue.disableInstrumentationKeyValidation,Re=Pe(ve)?!1:ve;if(Re)return!0;var Q="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",ie=new RegExp(Q);return ie.test(J)}function wt(){te[YA]=null,te[nv]=null,te._appId=null,te._sample=null,d={},m=null,r=0,o=null,s=null,a=!1,c=null,l=null,u=0,p=0,f=null,h=null,g=null,y=null,b=0,_=!1,S=null,w=!1,R=null,k=Gm,V=!1,K=null,j=Gm,B=!1,U=!1,Y=!1,W=null,ae=null,X=null,lr(te,"_senderConfig",{g:function(){return uz({},bHe)}})}}),t}return e.constructEnvelope=function(t,r,o,s){var a;r!==t.iKey&&!Pe(r)?a=id(id({},t),{iKey:r}):a=t;var c=cPt[a.baseType]||lme;return c(o,a,s)},e}(Hg)});var dme=N(()=>{_He()});var dW,pW,fW,J3,xHe=N(()=>{dW="instrumentationKey",pW="connectionString",fW="endpointUrl",J3="userOverrideEndpointUrl"});var SHe={};Dr(SHe,{AppInsightsCore:()=>Vg,ApplicationInsights:()=>dPt,Sender:()=>X3,SeverityLevel:()=>K$,arrForEach:()=>Ce,isNullOrUndefined:()=>Pe,proxyFunctions:()=>zl,throwError:()=>qi});function uPt(n){return n&&n>0}var lPt,dPt,IHe=N(()=>{Fs();dme();Qg();gr();Mt();xHe();gr();Qg();dme();lPt={diagnosticLogInterval:mA(uPt,1e4)};dPt=function(){function n(e){var t=new Vg,r;(Pe(e)||Pe(e[dW])&&Pe(e[pW]))&&qi("Invalid input configuration"),wn(n,this,function(s){lr(s,"config",{g:function(){return r}}),a(),s.initialize=a,s.track=o,zl(s,t,["flush","pollInternalLogs","stopPollingInternalLogs","unload","getPlugin","addPlugin","evtNamespace","addUnloadCb","onCfgChange"]);function a(){var c=Si(e||{},lPt);r=c.cfg,t.addUnloadHook(zo(c,function(){if(r[pW]){var l=H3(r[pW]),u=l.ingestionendpoint;r[fW]=r[J3]?r[J3]:u+Fm,r[dW]=l.instrumentationkey||r[dW]}r[fW]=r[J3]?r[J3]:r[fW]})),t.initialize(r,[new X3])}});function o(s){s&&(s.baseData=s.baseData||{},s.baseType=s.baseType||"EventData"),t.track(s)}}return n.__ieDyn=1,n}()});var THe=P(zm=>{"use strict";var pPt=zm&&zm.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,o)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),fPt=zm&&zm.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),mPt=zm&&zm.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&pPt(e,n,t);return fPt(e,n),e};Object.defineProperty(zm,"__esModule",{value:!0});zm.appInsightsClientFactory=void 0;var hPt=(Qg(),Eo(Yje)),gPt=Iue(),vPt=async(n,e,t)=>{let r;try{let s=await Promise.resolve().then(()=>mPt((IHe(),Eo(SHe)))),a={};if(e){let c={alwaysUseXhrOverride:!0,httpXHROverride:e};a[hPt.BreezeChannelIdentifier]=c}r=new s.ApplicationInsights({instrumentationKey:n,disableAjaxTracking:!0,disableExceptionTracking:!0,disableFetchTracking:!0,disableCorrelationHeaders:!0,disableCookiesUsage:!0,autoTrackPageVisitTime:!1,emitLineDelimitedJson:!1,disableInstrumentationKeyValidation:!0,extensionConfig:a})}catch(s){return Promise.reject(s)}return{logEvent:(s,a)=>{let c={...a?.properties,...a?.measurements};t?.length&&gPt.TelemetryUtil.applyReplacements(c,t),r?.track({name:s,data:c,baseType:"EventData",baseData:{name:s,properties:a?.properties,measurements:a?.measurements}})},flush:async()=>{r?.flush(!1)},dispose:async()=>new Promise(a=>{r?.unload(!0,()=>{a(),r=void 0},1e3)})}};zm.appInsightsClientFactory=vPt});var kHe=P(iv=>{"use strict";var yPt=iv&&iv.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,o)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),bPt=iv&&iv.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),mme=iv&&iv.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&yPt(e,n,t);return bPt(e,n),e};Object.defineProperty(iv,"__esModule",{value:!0});var pme=mme(require("os")),CHe=mme(require("vscode")),_Pt=mme(require("https")),xPt=V9e(),SPt=G9e(),EHe=Iue(),IPt=zqe(),TPt=THe();function wHe(){return{sendPOST:(e,t)=>{let r={method:"POST",headers:{...e.headers,"Content-Type":"application/json","Content-Length":Buffer.byteLength(e.data)}};try{let o=_Pt.request(e.urlString,r,s=>{s.on("data",function(a){t(s.statusCode??200,s.headers,a.toString())}),s.on("error",function(){t(0,{})})});o.write(e.data,s=>{s&&t(0,{})}),o.end()}catch{t(0,{})}}}}var fme=class extends xPt.BaseTelemetryReporter{constructor(e,t){let r=a=>(0,TPt.appInsightsClientFactory)(a,wHe(),t);EHe.TelemetryUtil.shouldUseOneDataSystemSDK(e)&&(r=a=>(0,IPt.oneDataSystemClientFactory)(a,CHe,wHe()));let o={release:pme.release(),platform:pme.platform(),architecture:pme.arch()},s=new SPt.BaseTelemetrySender(e,r);if(e&&e.indexOf("AIF-")===0)throw new Error("AIF keys are no longer supported. Please switch to 1DS keys for 1st party extensions");super(s,CHe,{additionalCommonProperties:EHe.TelemetryUtil.getAdditionalCommonProperties(o)})}};iv.default=fme});var HPt={};Dr(HPt,{activate:()=>qPt,createExtensionContext:()=>QHe});module.exports=Eo(HPt);var KHe=q(ht()),YHe=q(require("path")),b2=require("vscode");var gd;(o=>{o.serviceIds=new Map,o.DI_TARGET="$di$target",o.DI_DEPENDENCIES="$di$dependencies";function r(s){return s[o.DI_DEPENDENCIES]||[]}o.getServiceDependencies=r})(gd||={});var H=re("instantiationService");function mVe(n,e,t){e[gd.DI_TARGET]===e?e[gd.DI_DEPENDENCIES].push({id:n,index:t}):(e[gd.DI_DEPENDENCIES]=[{id:n,index:t}],e[gd.DI_TARGET]=e)}function re(n){if(gd.serviceIds.has(n))return gd.serviceIds.get(n);let e=function(t,r,o){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");mVe(e,t,o)};return e.toString=()=>n,gd.serviceIds.set(n,e),e}var PW=class{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?oF.isErrorNoTelemetry(e)?new oF(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(t=>{t(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}},hVe=new PW;function lv(n){wo(n)||hVe.onUnexpectedError(n)}var AW="Canceled";function wo(n){return n instanceof dt?!0:n instanceof Error&&n.name===AW&&n.message===AW}var dt=class extends Error{constructor(){super(AW),this.name=this.message}};function ur(n){return n?new Error(`Illegal argument: ${n}`):new Error("Illegal argument")}function Ame(n){return n?new Error(`Illegal state: ${n}`):new Error("Illegal state")}function sF(n){return n?n.message?n.message:n.stack?n.stack.split(`
`)[0]:String(n):"Error"}var oF=class n extends Error{constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof n)return e;let t=new n;return t.message=e.message,t.stack=e.stack,t}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}},Xt=class n extends Error{constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,n.prototype)}};function DW(n,e){let t=this,r=!1,o;return function(){if(r)return o;if(r=!0,e)try{o=n.apply(t,arguments)}finally{e()}else o=n.apply(t,arguments);return o}}function aF(n,e){let t=NW(n,e);if(t!==-1)return n[t]}function NW(n,e,t=n.length-1){for(let r=t;r>=0;r--){let o=n[r];if(e(o))return r}return-1}function LW(n,e){let t=vd(n,e);return t===-1?void 0:n[t]}function vd(n,e,t=0,r=n.length){let o=t,s=r;for(;o<s;){let a=Math.floor((o+s)/2);e(n[a])?o=a+1:s=a}return o-1}function cF(n,e){let t=uv(n,e);return t===n.length?void 0:n[t]}function uv(n,e,t=0,r=n.length){let o=t,s=r;for(;o<s;){let a=Math.floor((o+s)/2);e(n[a])?s=a:o=a+1}return o}function OW(n,e,t=0,r=n.length){let o=uv(n,e,t,r);return o===n.length?-1:o}var Dme=class n{constructor(e){this._array=e;this._findLastMonotonousLastIdx=0}static{this.assertInvariants=!1}findLastMonotonous(e){if(n.assertInvariants){if(this._prevFindLastPredicate){for(let r of this._array)if(this._prevFindLastPredicate(r)&&!e(r))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this._prevFindLastPredicate=e}let t=vd(this._array,e,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=t+1,t===-1?void 0:this._array[t]}};function Nme(n,e){if(n.length===0)return-1;let t=0;for(let r=1;r<n.length;r++){let o=n[r];e(o,n[t])>0&&(t=r)}return t}function wp(n,e){for(let t of n){let r=e(t);if(r!==void 0)return r}}function Qm(n,e,t=(r,o)=>r===o){if(n===e)return!0;if(!n||!e||n.length!==e.length)return!1;for(let r=0,o=n.length;r<o;r++)if(!t(n[r],e[r]))return!1;return!0}function Ome(n,e){let t=0,r=n-1;for(;t<=r;){let o=(t+r)/2|0,s=e(o);if(s<0)t=o+1;else if(s>0)r=o-1;else return o}return-(t+1)}function*Mme(n,e){let t,r;for(let o of n)r!==void 0&&e(r,o)?t.push(o):(t&&(yield t),t=[o]),r=o;t&&(yield t)}function zn(n){return n.filter(e=>!!e)}function Fme(n,e=t=>t){let t=new Set;return n.filter(r=>{let o=e(r);return t.has(o)?!1:(t.add(o),!0)})}function Ume(n){let e=new Set;return t=>{let r=n(t);return e.has(r)?!1:(e.add(r),!0)}}function S2(n,e){let t=typeof e=="number"?n:0;typeof e=="number"?t=n:(t=0,e=n);let r=[];if(t<=e)for(let o=t;o<e;o++)r.push(o);else for(let o=t;o>e;o--)r.push(o);return r}function Bme(n){return Array.isArray(n)?n:[n]}var qme;(c=>{function n(l){return l<0}c.isLessThan=n;function e(l){return l<=0}c.isLessThanOrEqual=e;function t(l){return l>0}c.isGreaterThan=t;function r(l){return l===0}c.isNeitherLessOrGreaterThan=r,c.greaterThan=1,c.lessThan=-1,c.neitherLessOrGreaterThan=0})(qme||={});function y1(n,e){return(t,r)=>e(n(t),n(r))}var b1=(n,e)=>n-e;var lF=class{constructor(e){this.items=e;this.firstIdx=0;this.lastIdx=this.items.length-1}get length(){return this.lastIdx-this.firstIdx+1}takeWhile(e){let t=this.firstIdx;for(;t<this.items.length&&e(this.items[t]);)t++;let r=t===this.firstIdx?null:this.items.slice(this.firstIdx,t);return this.firstIdx=t,r}takeFromEndWhile(e){let t=this.lastIdx;for(;t>=0&&e(this.items[t]);)t--;let r=t===this.lastIdx?null:this.items.slice(t+1,this.lastIdx+1);return this.lastIdx=t,r}peek(){if(this.length!==0)return this.items[this.firstIdx]}peekLast(){if(this.length!==0)return this.items[this.lastIdx]}dequeue(){let e=this.items[this.firstIdx];return this.firstIdx++,e}removeLast(){let e=this.items[this.lastIdx];return this.lastIdx--,e}takeCount(e){let t=this.items.slice(this.firstIdx,this.firstIdx+e);return this.firstIdx+=e,t}},Lme=class n{constructor(e){this.iterate=e}static{this.empty=new n(e=>{})}forEach(e){this.iterate(t=>(e(t),!0))}toArray(){let e=[];return this.iterate(t=>(e.push(t),!0)),e}filter(e){return new n(t=>this.iterate(r=>e(r)?t(r):!0))}map(e){return new n(t=>this.iterate(r=>t(e(r))))}some(e){let t=!1;return this.iterate(r=>(t=e(r),!t)),t}findFirst(e){let t;return this.iterate(r=>e(r)?(t=r,!1):!0),t}findLast(e){let t;return this.iterate(r=>(e(r)&&(t=r),!0)),t}findLastMaxBy(e){let t,r=!0;return this.iterate(o=>((r||qme.isGreaterThan(e(o,t)))&&(r=!1,t=o),!0)),t}};function Hme(n,e){let t=Object.create(null);for(let r of n){let o=e(r),s=t[o];s||(s=t[o]=[]),s.push(r)}return t}var vVe,jme=class{constructor(e,t){this.toKey=t;this._map=new Map;this[vVe]="SetWithKey";for(let r of e)this.add(r)}static{vVe=Symbol.toStringTag}get size(){return this._map.size}add(e){let t=this.toKey(e);return this._map.set(t,e),this}delete(e){return this._map.delete(this.toKey(e))}has(e){return this._map.has(this.toKey(e))}*entries(){for(let e of this._map.values())yield[e,e]}keys(){return this.values()}*values(){for(let e of this._map.values())yield e}clear(){this._map.clear()}forEach(e,t){this._map.forEach(r=>e.call(t,r,r,this))}[Symbol.iterator](){return this.values()}};var FW=class{constructor(e,t){this.uri=e;this.value=t}};function yVe(n){return Array.isArray(n)}var bVe,kn=class n{constructor(e,t){this[bVe]="ResourceMap";if(e instanceof n)this.map=new Map(e.map),this.toKey=t??n.defaultToKey;else if(yVe(e)){this.map=new Map,this.toKey=t??n.defaultToKey;for(let[r,o]of e)this.set(r,o)}else this.map=new Map,this.toKey=e??n.defaultToKey}static{this.defaultToKey=e=>e.toString()}set(e,t){return this.map.set(this.toKey(e),new FW(e,t)),this}get(e){return this.map.get(this.toKey(e))?.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t<"u"&&(e=e.bind(t));for(let[r,o]of this.map)e(o.value,o.uri,this)}*values(){for(let e of this.map.values())yield e.value}*keys(){for(let e of this.map.values())yield e.uri}*entries(){for(let e of this.map.values())yield[e.uri,e.value]}*[(bVe=Symbol.toStringTag,Symbol.iterator)](){for(let[,e]of this.map)yield[e.uri,e.value]}},_Ve,_1=class{constructor(e,t){this[_Ve]="ResourceSet";!e||typeof e=="function"?this._map=new kn(e):(this._map=new kn(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((r,o)=>e.call(t,o,o,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(_Ve=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}};var xVe,UW=class{constructor(){this[xVe]="LinkedMap";this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=0){let r=this._map.get(e);if(r)return t!==0&&this.touch(r,t),r.value}set(e,t,r=0){let o=this._map.get(e);if(o)o.value=t,r!==0&&this.touch(o,r);else{switch(o={key:e,value:t,next:void 0,previous:void 0},r){case 0:this.addItemLast(o);break;case 1:this.addItemFirst(o);break;case 2:this.addItemLast(o);break;default:this.addItemLast(o);break}this._map.set(e,o),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let r=this._state,o=this._head;for(;o;){if(t?e.bind(t)(o.value,o.key,this):e(o.value,o.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");o=o.next}}keys(){let e=this,t=this._state,r=this._head,o={[Symbol.iterator](){return o},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(r){let s={value:r.key,done:!1};return r=r.next,s}else return{value:void 0,done:!0}}};return o}values(){let e=this,t=this._state,r=this._head,o={[Symbol.iterator](){return o},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(r){let s={value:r.value,done:!1};return r=r.next,s}else return{value:void 0,done:!0}}};return o}entries(){let e=this,t=this._state,r=this._head,o={[Symbol.iterator](){return o},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(r){let s={value:[r.key,r.value],done:!1};return r=r.next,s}else return{value:void 0,done:!0}}};return o}[(xVe=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,r=this.size;for(;t&&r>e;)this._map.delete(t.key),t=t.next,r--;this._head=t,this._size=r,t&&(t.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._tail,r=this.size;for(;t&&r>e;)this._map.delete(t.key),t=t.previous,r--;this._tail=t,this._size=r,t&&(t.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,r=e.previous;if(!t||!r)throw new Error("Invalid list");t.previous=r,r.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;let r=e.next,o=e.previous;e===this._tail?(o.next=void 0,this._tail=o):(r.previous=o,o.next=r),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;let r=e.next,o=e.previous;e===this._head?(r.previous=void 0,this._head=r):(r.previous=o,o.next=r),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,r)=>{e.push([r,t])}),e}fromJSON(e){this.clear();for(let[t,r]of e)this.set(t,r)}},BW=class extends UW{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}},kp=class extends BW{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){return super.set(e,t),this.checkTrim(),this}};var uF=class{constructor(){this.map=new Map}add(e,t){let r=this.map.get(e);r||(r=new Set,this.map.set(e,r)),r.add(t)}delete(e,t){let r=this.map.get(e);r&&(r.delete(t),r.size===0&&this.map.delete(e))}forEach(e,t){let r=this.map.get(e);r&&r.forEach(t)}get(e){let t=this.map.get(e);return t||new Set}};var ti;(x=>{function n(I){return I&&typeof I=="object"&&typeof I[Symbol.iterator]=="function"}x.is=n;let e=Object.freeze([]);function t(){return e}x.empty=t;function*r(I){yield I}x.single=r;function o(I){return n(I)?I:r(I)}x.wrap=o;function s(I){return I||e}x.from=s;function*a(I){for(let S=I.length-1;S>=0;S--)yield I[S]}x.reverse=a;function c(I){return!I||I[Symbol.iterator]().next().done===!0}x.isEmpty=c;function l(I){return I[Symbol.iterator]().next().value}x.first=l;function u(I,S){let w=0;for(let R of I)if(S(R,w++))return!0;return!1}x.some=u;function d(I,S){for(let w of I)if(S(w))return w}x.find=d;function*p(I,S){for(let w of I)S(w)&&(yield w)}x.filter=p;function*f(I,S){let w=0;for(let R of I)yield S(R,w++)}x.map=f;function*m(I,S){let w=0;for(let R of I)yield*S(R,w++)}x.flatMap=m;function*h(...I){for(let S of I)yield*S}x.concat=h;function g(I,S,w){let R=w;for(let k of I)R=S(R,k);return R}x.reduce=g;function*y(I,S,w=I.length){for(S<0&&(S+=I.length),w<0?w+=I.length:w>I.length&&(w=I.length);S<w;S++)yield I[S]}x.slice=y;function b(I,S=Number.POSITIVE_INFINITY){let w=[];if(S===0)return[w,I];let R=I[Symbol.iterator]();for(let k=0;k<S;k++){let V=R.next();if(V.done)return[w,x.empty()];w.push(V.value)}return[w,{[Symbol.iterator](){return R}}]}x.consume=b;async function _(I){let S=[];for await(let w of I)S.push(w);return Promise.resolve(S)}x.asyncToArray=_})(ti||={});var SVe=!1,x1=null,Vme=class n{constructor(){this.livingDisposables=new Map}static{this.idx=0}getDisposableData(e){let t=this.livingDisposables.get(e);return t||(t={parent:null,source:null,isSingleton:!1,value:e,idx:n.idx++},this.livingDisposables.set(e,t)),t}trackDisposable(e){let t=this.getDisposableData(e);t.source||(t.source=new Error().stack)}setParent(e,t){let r=this.getDisposableData(e);r.parent=t}markAsDisposed(e){this.livingDisposables.delete(e)}markAsSingleton(e){this.getDisposableData(e).isSingleton=!0}getRootParent(e,t){let r=t.get(e);if(r)return r;let o=e.parent?this.getRootParent(this.getDisposableData(e.parent),t):e;return t.set(e,o),o}getTrackedDisposables(){let e=new Map;return[...this.livingDisposables.entries()].filter(([,r])=>r.source!==null&&!this.getRootParent(r,e).isSingleton).flatMap(([r])=>r)}computeLeakingDisposables(e=10,t){let r;if(t)r=t;else{let l=new Map,u=[...this.livingDisposables.values()].filter(p=>p.source!==null&&!this.getRootParent(p,l).isSingleton);if(u.length===0)return;let d=new Set(u.map(p=>p.value));if(r=u.filter(p=>!(p.parent&&d.has(p.parent))),r.length===0)throw new Error("There are cyclic diposable chains!")}if(!r)return;function o(l){function u(p,f){for(;p.length>0&&f.some(m=>typeof m=="string"?m===p[0]:p[0].match(m));)p.shift()}let d=l.source.split(`
`).map(p=>p.trim().replace("at ","")).filter(p=>p!=="");return u(d,["Error",/^trackDisposable \(.*\)$/,/^DisposableTracker.trackDisposable \(.*\)$/]),d.reverse()}let s=new uF;for(let l of r){let u=o(l);for(let d=0;d<=u.length;d++)s.add(u.slice(0,d).join(`
`),l)}r.sort(y1(l=>l.idx,b1));let a="",c=0;for(let l of r.slice(0,e)){c++;let u=o(l),d=[];for(let p=0;p<u.length;p++){let f=u[p];f=`(shared with ${s.get(u.slice(0,p+1).join(`
`)).size}/${r.length} leaks) at ${f}`;let h=s.get(u.slice(0,p).join(`
`)),g=Hme([...h].map(y=>o(y)[p]),y=>y);delete g[u[p]];for(let[y,b]of Object.entries(g))d.unshift(`    - stacktraces of ${b.length} other leaks continue with ${y}`);d.unshift(f)}a+=`


==================== Leaking disposable ${c}/${r.length}: ${l.value.constructor.name} ====================
${d.join(`
`)}
============================================================

`}return r.length>e&&(a+=`


... and ${r.length-e} more leaking disposables

`),{leaks:r,details:a}}};function IVe(n){x1=n}if(SVe){let n="__is_disposable_tracked__";IVe(new class{trackDisposable(e){let t=new Error("Potentially leaked disposable").stack;setTimeout(()=>{e[n]||console.log(t)},3e3)}setParent(e,t){if(e&&e!==ye.None)try{e[n]=!0}catch{}}markAsDisposed(e){if(e&&e!==ye.None)try{e[n]=!0}catch{}}markAsSingleton(e){}})}function M_(n){return x1?.trackDisposable(n),n}function F_(n){x1?.markAsDisposed(n)}function I2(n,e){x1?.setParent(n,e)}function TVe(n,e){if(x1)for(let t of n)x1.setParent(t,e)}function I1(n){return typeof n=="object"&&n!==null&&typeof n.dispose=="function"&&n.dispose.length===0}function pv(n){if(ti.is(n)){let e=[];for(let t of n)if(t)try{t.dispose()}catch(r){e.push(r)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(n)?[]:n}else if(n)return n.dispose(),n}function T1(...n){let e=zi(()=>pv(n));return TVe(n,e),e}function zi(n){let e=M_({dispose:DW(()=>{F_(e),n()})});return e}var _t=class n{constructor(){this._toDispose=new Set;this._isDisposed=!1;M_(this)}static{this.DISABLE_DISPOSED_WARNING=!1}dispose(){this._isDisposed||(F_(this),this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{pv(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return I2(e,this),this._isDisposed?n.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}delete(e){if(e){if(e===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}deleteAndLeak(e){e&&this._toDispose.has(e)&&(this._toDispose.delete(e),I2(e,null))}},ye=class{constructor(){this._store=new _t;M_(this),I2(this._store,this)}static{this.None=Object.freeze({dispose(){}})}dispose(){F_(this),this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}},dv=class{constructor(){this._isDisposed=!1;M_(this)}get value(){return this._isDisposed?void 0:this._value}set value(e){this._isDisposed||e===this._value||(this._value?.dispose(),e&&I2(e,this),this._value=e)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,F_(this),this._value?.dispose(),this._value=void 0}clearAndLeak(){let e=this._value;return this._value=void 0,e&&I2(e,null),e}};var S1=class{constructor(){this._store=new Map;this._isDisposed=!1;M_(this)}dispose(){F_(this),this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{pv(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get size(){return this._store.size}get(e){return this._store.get(e)}set(e,t,r=!1){this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),r||this._store.get(e)?.dispose(),this._store.set(e,t)}deleteAndDispose(e){this._store.get(e)?.dispose(),this._store.delete(e)}deleteAndLeak(e){let t=this._store.get(e);return this._store.delete(e),t}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}};var ni=class n{static{this.Undefined=new n(void 0)}constructor(e){this.element=e,this.next=n.Undefined,this.prev=n.Undefined}},U_=class{constructor(){this._first=ni.Undefined;this._last=ni.Undefined;this._size=0}get size(){return this._size}isEmpty(){return this._first===ni.Undefined}clear(){let e=this._first;for(;e!==ni.Undefined;){let t=e.next;e.prev=ni.Undefined,e.next=ni.Undefined,e=t}this._first=ni.Undefined,this._last=ni.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){let r=new ni(e);if(this._first===ni.Undefined)this._first=r,this._last=r;else if(t){let s=this._last;this._last=r,r.prev=s,s.next=r}else{let s=this._first;this._first=r,r.next=s,s.prev=r}this._size+=1;let o=!1;return()=>{o||(o=!0,this._remove(r))}}shift(){if(this._first!==ni.Undefined){let e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==ni.Undefined){let e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==ni.Undefined&&e.next!==ni.Undefined){let t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===ni.Undefined&&e.next===ni.Undefined?(this._first=ni.Undefined,this._last=ni.Undefined):e.next===ni.Undefined?(this._last=this._last.prev,this._last.next=ni.Undefined):e.prev===ni.Undefined&&(this._first=this._first.next,this._first.prev=ni.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==ni.Undefined;)yield e.element,e=e.next}};var CVe=globalThis.performance&&typeof globalThis.performance.now=="function",Qo=class n{static create(e){return new n(e)}constructor(e){this._now=CVe&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}};var EVe=!1,Gme=!1,wVe=!1,Kl;(D=>{D.None=()=>ye.None;function e(A){if(wVe){let{onDidAddListener:B}=A,U=T2.create(),W=0;A.onDidAddListener=()=>{++W===2&&(console.warn("snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here"),U.print()),B?.()}}}function t(A,B){return m(A,()=>{},0,void 0,!0,void 0,B)}D.defer=t;function r(A){return(B,U=null,W)=>{let ae=!1,Y;return Y=A(X=>{if(!ae)return Y?Y.dispose():ae=!0,B.call(U,X)},null,W),ae&&Y.dispose(),Y}}D.once=r;function o(A,B){return D.once(D.filter(A,B))}D.onceIf=o;function s(A,B,U){return p((W,ae=null,Y)=>A(X=>W.call(ae,B(X)),null,Y),U)}D.map=s;function a(A,B,U){return p((W,ae=null,Y)=>A(X=>{B(X),W.call(ae,X)},null,Y),U)}D.forEach=a;function c(A,B,U){return p((W,ae=null,Y)=>A(X=>B(X)&&W.call(ae,X),null,Y),U)}D.filter=c;function l(A){return A}D.signal=l;function u(...A){return(B,U=null,W)=>{let ae=T1(...A.map(Y=>Y(X=>B.call(U,X))));return f(ae,W)}}D.any=u;function d(A,B,U,W){let ae=U;return s(A,Y=>(ae=B(ae,Y),ae),W)}D.reduce=d;function p(A,B){let U,W={onWillAddFirstListener(){U=A(ae.fire,ae)},onDidRemoveLastListener(){U?.dispose()}};B||e(W);let ae=new jt(W);return B?.add(ae),ae.event}function f(A,B){return B instanceof Array?B.push(A):B&&B.add(A),A}function m(A,B,U=100,W=!1,ae=!1,Y,X){let Se,te,Ie,Xe=0,Ut,Nn={leakWarningThreshold:Y,onWillAddFirstListener(){Se=A(mt=>{Xe++,te=B(te,mt),W&&!Ie&&(xe.fire(te),te=void 0),Ut=()=>{let G=te;te=void 0,Ie=void 0,(!W||Xe>1)&&xe.fire(G),Xe=0},typeof U=="number"?(clearTimeout(Ie),Ie=setTimeout(Ut,U)):Ie===void 0&&(Ie=0,queueMicrotask(Ut))})},onWillRemoveListener(){ae&&Xe>0&&Ut?.()},onDidRemoveLastListener(){Ut=void 0,Se.dispose()}};X||e(Nn);let xe=new jt(Nn);return X?.add(xe),xe.event}D.debounce=m;function h(A,B=0,U){return D.debounce(A,(W,ae)=>W?(W.push(ae),W):[ae],B,void 0,!0,void 0,U)}D.accumulate=h;function g(A,B=(W,ae)=>W===ae,U){let W=!0,ae;return c(A,Y=>{let X=W||!B(Y,ae);return W=!1,ae=Y,X},U)}D.latch=g;function y(A,B,U){return[D.filter(A,B,U),D.filter(A,W=>!B(W),U)]}D.split=y;function b(A,B=!1,U=[],W){let ae=U.slice(),Y=A(te=>{ae?ae.push(te):Se.fire(te)});W&&W.add(Y);let X=()=>{ae?.forEach(te=>Se.fire(te)),ae=null},Se=new jt({onWillAddFirstListener(){Y||(Y=A(te=>Se.fire(te)),W&&W.add(Y))},onDidAddFirstListener(){ae&&(B?setTimeout(X):X())},onDidRemoveLastListener(){Y&&Y.dispose(),Y=null}});return W&&W.add(Se),Se.event}D.buffer=b;function _(A,B){return(W,ae,Y)=>{let X=B(new I);return A(function(Se){let te=X.evaluate(Se);te!==x&&W.call(ae,te)},void 0,Y)}}D.chain=_;let x=Symbol("HaltChainable");class I{constructor(){this.steps=[]}map(B){return this.steps.push(B),this}forEach(B){return this.steps.push(U=>(B(U),U)),this}filter(B){return this.steps.push(U=>B(U)?U:x),this}reduce(B,U){let W=U;return this.steps.push(ae=>(W=B(W,ae),W)),this}latch(B=(U,W)=>U===W){let U=!0,W;return this.steps.push(ae=>{let Y=U||!B(ae,W);return U=!1,W=ae,Y?ae:x}),this}evaluate(B){for(let U of this.steps)if(B=U(B),B===x)break;return B}}function S(A,B,U=W=>W){let W=(...Se)=>X.fire(U(...Se)),ae=()=>A.on(B,W),Y=()=>A.removeListener(B,W),X=new jt({onWillAddFirstListener:ae,onDidRemoveLastListener:Y});return X.event}D.fromNodeEventEmitter=S;function w(A,B,U=W=>W){let W=(...Se)=>X.fire(U(...Se)),ae=()=>A.addEventListener(B,W),Y=()=>A.removeEventListener(B,W),X=new jt({onWillAddFirstListener:ae,onDidRemoveLastListener:Y});return X.event}D.fromDOMEventEmitter=w;function R(A){return new Promise(B=>r(A)(B))}D.toPromise=R;function k(A){let B=new jt;return A.then(U=>{B.fire(U)},()=>{B.fire(void 0)}).finally(()=>{B.dispose()}),B.event}D.fromPromise=k;function V(A,B){return A(U=>B.fire(U))}D.forward=V;function F(A,B,U){return B(U),A(W=>B(W))}D.runAndSubscribe=F;class K{constructor(B,U){this._observable=B;this._counter=0;this._hasChanged=!1;let W={onWillAddFirstListener:()=>{B.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{B.removeObserver(this)}};U||e(W),this.emitter=new jt(W),U&&U.add(this.emitter)}beginUpdate(B){this._counter++}handlePossibleChange(B){}handleChange(B,U){this._hasChanged=!0}endUpdate(B){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function $(A,B){return new K(A,B).emitter.event}D.fromObservable=$;function j(A){return(B,U,W)=>{let ae=0,Y=!1,X={beginUpdate(){ae++},endUpdate(){ae--,ae===0&&(A.reportChanges(),Y&&(Y=!1,B.call(U)))},handlePossibleChange(){},handleChange(){Y=!0}};A.addObserver(X),A.reportChanges();let Se={dispose(){A.removeObserver(X)}};return W instanceof _t?W.add(Se):Array.isArray(W)&&W.push(Se),Se}}D.fromObservableLight=j})(Kl||={});var qW=class n{constructor(e){this.listenerCount=0;this.invocationCount=0;this.elapsedOverall=0;this.durations=[];this.name=`${e}_${n._idPool++}`,n.all.add(this)}static{this.all=new Set}static{this._idPool=0}start(e){this._stopWatch=new Qo,this.listenerCount=e}stop(){if(this._stopWatch){let e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}},zme=-1;var jW=class n{constructor(e,t,r=(n._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e;this.threshold=t;this.name=r;this._warnCountdown=0}static{this._idPool=1}dispose(){this._stacks?.clear()}check(e,t){let r=this.threshold;if(r<=0||t<r)return;this._stacks||(this._stacks=new Map);let o=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,o+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=r*.5;let[s,a]=this.getMostFrequentStack(),c=`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${a}):`;console.warn(c),console.warn(s);let l=new HW(c,s);this._errorHandler(l)}return()=>{let s=this._stacks.get(e.value)||0;this._stacks.set(e.value,s-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,t=0;for(let[r,o]of this._stacks)(!e||t<o)&&(e=[r,o],t=o);return e}},T2=class n{constructor(e){this.value=e}static create(){let e=new Error;return new n(e.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},HW=class extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}},VW=class extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}},kVe=0,C1=class{constructor(e){this.value=e;this.id=kVe++}},RVe=2,PVe=(n,e)=>{if(n instanceof C1)e(n);else for(let t=0;t<n.length;t++){let r=n[t];r&&e(r)}},dF;if(EVe){let n=[];setInterval(()=>{n.length!==0&&(console.warn("[LEAKING LISTENERS] GC'ed these listeners that were NOT yet disposed:"),console.warn(n.join(`
`)),n.length=0)},3e3),dF=new FinalizationRegistry(e=>{typeof e=="string"&&n.push(e)})}var jt=class{constructor(e){this._size=0;this._options=e,this._leakageMon=zme>0||this._options?.leakWarningThreshold?new jW(e?.onListenerError??lv,this._options?.leakWarningThreshold??zme):void 0,this._perfMon=this._options?._profName?new qW(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){if(!this._disposed){if(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners){if(Gme){let e=this._listeners;queueMicrotask(()=>{PVe(e,t=>t.stack?.print())})}this._listeners=void 0,this._size=0}this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose()}}get event(){return this._event??=(e,t,r)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let l=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(l);let u=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],d=new VW(`${l}. HINT: Stack shows most frequent listener (${u[1]}-times)`,u[0]);return(this._options?.onListenerError||lv)(d),ye.None}if(this._disposed)return ye.None;t&&(e=e.bind(t));let o=new C1(e),s,a;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(o.stack=T2.create(),s=this._leakageMon.check(o.stack,this._size+1)),Gme&&(o.stack=a??T2.create()),this._listeners?this._listeners instanceof C1?(this._deliveryQueue??=new GW,this._listeners=[this._listeners,o]):this._listeners.push(o):(this._options?.onWillAddFirstListener?.(this),this._listeners=o,this._options?.onDidAddFirstListener?.(this)),this._size++;let c=zi(()=>{dF?.unregister(c),s?.(),this._removeListener(o)});if(r instanceof _t?r.add(c):Array.isArray(r)&&r.push(c),dF){let l=new Error().stack.split(`
`).slice(2,3).join(`
`).trim(),u=/(file:|vscode-file:\/\/vscode-app)?(\/[^:]*:\d+:\d+)/.exec(l);dF.register(c,u?.[2]??l,c)}return c},this._event}_removeListener(e){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let t=this._listeners,r=t.indexOf(e);if(r===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,t[r]=void 0;let o=this._deliveryQueue.current===this;if(this._size*RVe<=t.length){let s=0;for(let a=0;a<t.length;a++)t[a]?t[s++]=t[a]:o&&(this._deliveryQueue.end--,s<this._deliveryQueue.i&&this._deliveryQueue.i--);t.length=s}}_deliver(e,t){if(!e)return;let r=this._options?.onListenerError||lv;if(!r){e.value(t);return}try{e.value(t)}catch(o){r(o)}}_deliverQueue(e){let t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof C1)this._deliver(this._listeners,e);else{let t=this._deliveryQueue;t.enqueue(this,e,this._listeners.length),this._deliverQueue(t)}this._perfMon?.stop()}hasListeners(){return this._size>0}};var GW=class{constructor(){this.i=-1;this.end=0}enqueue(e,t,r){this.i=0,this.end=r,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}};var $me=Object.freeze(function(n,e){let t=setTimeout(n.bind(e),0);return{dispose(){clearTimeout(t)}}}),Zt;(r=>{function n(o){return o===r.None||o===r.Cancelled||o instanceof E1?!0:!o||typeof o!="object"?!1:typeof o.isCancellationRequested=="boolean"&&typeof o.onCancellationRequested=="function"}r.isCancellationToken=n,r.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Kl.None}),r.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:$me})})(Zt||={});var E1=class{constructor(){this._isCancelled=!1;this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?$me:(this._emitter||(this._emitter=new jt),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}},ko=class{constructor(e){this._token=void 0;this._parentListener=void 0;this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new E1),this._token}cancel(){this._token?this._token instanceof E1&&this._token.cancel():this._token=Zt.Cancelled}dispose(e=!1){e&&this.cancel(),this._parentListener?.dispose(),this._token?this._token instanceof E1&&this._token.dispose():this._token=Zt.None}};function Wme(n){let e=new ko;return n.add({dispose(){e.cancel()}}),e.token}function zW(){return globalThis._VSCODE_NLS_MESSAGES}function C2(){return globalThis._VSCODE_NLS_LANGUAGE}var AVe=C2()==="pseudo"||typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function Kme(n,e){let t;return e.length===0?t=n:t=n.replace(/\{(\d+)\}/g,(r,o)=>{let s=o[0],a=e[s],c=r;return typeof a=="string"?c=a:(typeof a=="number"||typeof a=="boolean"||a===void 0||a===null)&&(c=String(a)),c}),AVe&&(t="\uFF3B"+t.replace(/[aouei]/g,"$&$&")+"\uFF3D"),t}function Yme(n,e,...t){return Kme(typeof n=="number"?DVe(n,e):e,t)}function DVe(n,e){let t=zW()?.[n];if(typeof t!="string"){if(typeof e=="string")return e;throw new Error(`!!! NLS MISSING: ${n} !!!`)}return t}var w1="en",hF=!1,gF=!1,E2=!1,LVe=!1,Xme=!1,$W=!1,OVe=!1,MVe=!1,FVe=!1,UVe=!1,pF,fF=w1,Qme=w1,BVe,Xm,Jm=globalThis,dl;typeof Jm.vscode<"u"&&typeof Jm.vscode.process<"u"?dl=Jm.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(dl=process);var Jme=typeof dl?.versions?.electron=="string",qVe=Jme&&dl?.type==="renderer";if(typeof dl=="object"){hF=dl.platform==="win32",gF=dl.platform==="darwin",E2=dl.platform==="linux",LVe=E2&&!!dl.env.SNAP&&!!dl.env.SNAP_REVISION,OVe=Jme,FVe=!!dl.env.CI||!!dl.env.BUILD_ARTIFACTSTAGINGDIRECTORY,pF=w1,fF=w1;let n=dl.env.VSCODE_NLS_CONFIG;if(n)try{let e=JSON.parse(n);pF=e.userLocale,Qme=e.osLocale,fF=e.resolvedLanguage||w1,BVe=e.languagePack?.translationsConfigFile}catch{}Xme=!0}else typeof navigator=="object"&&!qVe?(Xm=navigator.userAgent,hF=Xm.indexOf("Windows")>=0,gF=Xm.indexOf("Macintosh")>=0,MVe=(Xm.indexOf("Macintosh")>=0||Xm.indexOf("iPad")>=0||Xm.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,E2=Xm.indexOf("Linux")>=0,UVe=Xm?.indexOf("Mobi")>=0,$W=!0,fF=C2()||w1,pF=navigator.language.toLowerCase(),Qme=pF):console.error("Unable to resolve platform.");var mF=0;gF?mF=1:hF?mF=3:E2&&(mF=2);var Pp=hF,Zme=gF,ehe=E2;var the=Xme;var nhe=$W,jVe=$W&&typeof Jm.importScripts=="function",rhe=jVe?Jm.origin:void 0;var ihe=mF,Rp=Xm,fv=fF,HVe;(r=>{function n(){return fv}r.value=n;function e(){return fv.length===2?fv==="en":fv.length>=3?fv[0]==="e"&&fv[1]==="n"&&fv[2]==="-":!1}r.isDefaultVariant=e;function t(){return fv==="en"}r.isDefault=t})(HVe||={});var VVe=typeof Jm.postMessage=="function"&&!Jm.importScripts,ohe=(()=>{if(VVe){let n=[];Jm.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let r=0,o=n.length;r<o;r++){let s=n[r];if(s.id===t.data.vscodeScheduleAsyncWork){n.splice(r,1),s.callback();return}}});let e=0;return t=>{let r=++e;n.push({id:r,callback:t}),Jm.postMessage({vscodeScheduleAsyncWork:r},"*")}}return n=>setTimeout(n)})();var GVe=!!(Rp&&Rp.indexOf("Chrome")>=0),xAt=!!(Rp&&Rp.indexOf("Firefox")>=0),SAt=!!(!GVe&&Rp&&Rp.indexOf("Safari")>=0),IAt=!!(Rp&&Rp.indexOf("Edg/")>=0),TAt=!!(Rp&&Rp.indexOf("Android")>=0);var B_,WW=globalThis.vscode;if(typeof WW<"u"&&typeof WW.process<"u"){let n=WW.process;B_={get platform(){return n.platform},get arch(){return n.arch},get env(){return n.env},cwd(){return n.cwd()}}}else typeof process<"u"&&typeof process?.versions?.node=="string"?B_={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:B_={get platform(){return Pp?"win32":Zme?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var w2=B_.cwd,she=B_.env,ahe=B_.platform,wAt=B_.arch;var WVe=65,KVe=97,YVe=90,QVe=122,gv=46,vs=47,dc=92,mv=58,XVe=63,vF=class extends Error{constructor(e,t,r){let o;typeof t=="string"&&t.indexOf("not ")===0?(o="must not be",t=t.replace(/^not /,"")):o="must be";let s=e.indexOf(".")!==-1?"property":"argument",a=`The "${e}" ${s} ${o} of type ${t}`;a+=`. Received type ${typeof r}`,super(a),this.code="ERR_INVALID_ARG_TYPE"}};function JVe(n,e){if(n===null||typeof n!="object")throw new vF(e,"Object",n)}function $i(n,e){if(typeof n!="string")throw new vF(e,"string",n)}var pc=ahe==="win32";function pn(n){return n===vs||n===dc}function KW(n){return n===vs}function hv(n){return n>=WVe&&n<=YVe||n>=KVe&&n<=QVe}function yF(n,e,t,r){let o="",s=0,a=-1,c=0,l=0;for(let u=0;u<=n.length;++u){if(u<n.length)l=n.charCodeAt(u);else{if(r(l))break;l=vs}if(r(l)){if(!(a===u-1||c===1))if(c===2){if(o.length<2||s!==2||o.charCodeAt(o.length-1)!==gv||o.charCodeAt(o.length-2)!==gv){if(o.length>2){let d=o.lastIndexOf(t);d===-1?(o="",s=0):(o=o.slice(0,d),s=o.length-1-o.lastIndexOf(t)),a=u,c=0;continue}else if(o.length!==0){o="",s=0,a=u,c=0;continue}}e&&(o+=o.length>0?`${t}..`:"..",s=2)}else o.length>0?o+=`${t}${n.slice(a+1,u)}`:o=n.slice(a+1,u),s=u-a-1;a=u,c=0}else l===gv&&c!==-1?++c:c=-1}return o}function ZVe(n){return n?`${n[0]==="."?"":"."}${n}`:""}function che(n,e){JVe(e,"pathObject");let t=e.dir||e.root,r=e.base||`${e.name||""}${ZVe(e.ext)}`;return t?t===e.root?`${t}${r}`:`${t}${n}${r}`:r}var Wi={resolve(...n){let e="",t="",r=!1;for(let o=n.length-1;o>=-1;o--){let s;if(o>=0){if(s=n[o],$i(s,`paths[${o}]`),s.length===0)continue}else e.length===0?s=w2():(s=she[`=${e}`]||w2(),(s===void 0||s.slice(0,2).toLowerCase()!==e.toLowerCase()&&s.charCodeAt(2)===dc)&&(s=`${e}\\`));let a=s.length,c=0,l="",u=!1,d=s.charCodeAt(0);if(a===1)pn(d)&&(c=1,u=!0);else if(pn(d))if(u=!0,pn(s.charCodeAt(1))){let p=2,f=p;for(;p<a&&!pn(s.charCodeAt(p));)p++;if(p<a&&p!==f){let m=s.slice(f,p);for(f=p;p<a&&pn(s.charCodeAt(p));)p++;if(p<a&&p!==f){for(f=p;p<a&&!pn(s.charCodeAt(p));)p++;(p===a||p!==f)&&(l=`\\\\${m}\\${s.slice(f,p)}`,c=p)}}}else c=1;else hv(d)&&s.charCodeAt(1)===mv&&(l=s.slice(0,2),c=2,a>2&&pn(s.charCodeAt(2))&&(u=!0,c=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(r){if(e.length>0)break}else if(t=`${s.slice(c)}\\${t}`,r=u,u&&e.length>0)break}return t=yF(t,!r,"\\",pn),r?`${e}\\${t}`:`${e}${t}`||"."},normalize(n){$i(n,"path");let e=n.length;if(e===0)return".";let t=0,r,o=!1,s=n.charCodeAt(0);if(e===1)return KW(s)?"\\":n;if(pn(s))if(o=!0,pn(n.charCodeAt(1))){let c=2,l=c;for(;c<e&&!pn(n.charCodeAt(c));)c++;if(c<e&&c!==l){let u=n.slice(l,c);for(l=c;c<e&&pn(n.charCodeAt(c));)c++;if(c<e&&c!==l){for(l=c;c<e&&!pn(n.charCodeAt(c));)c++;if(c===e)return`\\\\${u}\\${n.slice(l)}\\`;c!==l&&(r=`\\\\${u}\\${n.slice(l,c)}`,t=c)}}}else t=1;else hv(s)&&n.charCodeAt(1)===mv&&(r=n.slice(0,2),t=2,e>2&&pn(n.charCodeAt(2))&&(o=!0,t=3));let a=t<e?yF(n.slice(t),!o,"\\",pn):"";return a.length===0&&!o&&(a="."),a.length>0&&pn(n.charCodeAt(e-1))&&(a+="\\"),r===void 0?o?`\\${a}`:a:o?`${r}\\${a}`:`${r}${a}`},isAbsolute(n){$i(n,"path");let e=n.length;if(e===0)return!1;let t=n.charCodeAt(0);return pn(t)||e>2&&hv(t)&&n.charCodeAt(1)===mv&&pn(n.charCodeAt(2))},join(...n){if(n.length===0)return".";let e,t;for(let s=0;s<n.length;++s){let a=n[s];$i(a,"path"),a.length>0&&(e===void 0?e=t=a:e+=`\\${a}`)}if(e===void 0)return".";let r=!0,o=0;if(typeof t=="string"&&pn(t.charCodeAt(0))){++o;let s=t.length;s>1&&pn(t.charCodeAt(1))&&(++o,s>2&&(pn(t.charCodeAt(2))?++o:r=!1))}if(r){for(;o<e.length&&pn(e.charCodeAt(o));)o++;o>=2&&(e=`\\${e.slice(o)}`)}return Wi.normalize(e)},relative(n,e){if($i(n,"from"),$i(e,"to"),n===e)return"";let t=Wi.resolve(n),r=Wi.resolve(e);if(t===r||(n=t.toLowerCase(),e=r.toLowerCase(),n===e))return"";let o=0;for(;o<n.length&&n.charCodeAt(o)===dc;)o++;let s=n.length;for(;s-1>o&&n.charCodeAt(s-1)===dc;)s--;let a=s-o,c=0;for(;c<e.length&&e.charCodeAt(c)===dc;)c++;let l=e.length;for(;l-1>c&&e.charCodeAt(l-1)===dc;)l--;let u=l-c,d=a<u?a:u,p=-1,f=0;for(;f<d;f++){let h=n.charCodeAt(o+f);if(h!==e.charCodeAt(c+f))break;h===dc&&(p=f)}if(f!==d){if(p===-1)return r}else{if(u>d){if(e.charCodeAt(c+f)===dc)return r.slice(c+f+1);if(f===2)return r.slice(c+f)}a>d&&(n.charCodeAt(o+f)===dc?p=f:f===2&&(p=3)),p===-1&&(p=0)}let m="";for(f=o+p+1;f<=s;++f)(f===s||n.charCodeAt(f)===dc)&&(m+=m.length===0?"..":"\\..");return c+=p,m.length>0?`${m}${r.slice(c,l)}`:(r.charCodeAt(c)===dc&&++c,r.slice(c,l))},toNamespacedPath(n){if(typeof n!="string"||n.length===0)return n;let e=Wi.resolve(n);if(e.length<=2)return n;if(e.charCodeAt(0)===dc){if(e.charCodeAt(1)===dc){let t=e.charCodeAt(2);if(t!==XVe&&t!==gv)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(hv(e.charCodeAt(0))&&e.charCodeAt(1)===mv&&e.charCodeAt(2)===dc)return`\\\\?\\${e}`;return n},dirname(n){$i(n,"path");let e=n.length;if(e===0)return".";let t=-1,r=0,o=n.charCodeAt(0);if(e===1)return pn(o)?n:".";if(pn(o)){if(t=r=1,pn(n.charCodeAt(1))){let c=2,l=c;for(;c<e&&!pn(n.charCodeAt(c));)c++;if(c<e&&c!==l){for(l=c;c<e&&pn(n.charCodeAt(c));)c++;if(c<e&&c!==l){for(l=c;c<e&&!pn(n.charCodeAt(c));)c++;if(c===e)return n;c!==l&&(t=r=c+1)}}}}else hv(o)&&n.charCodeAt(1)===mv&&(t=e>2&&pn(n.charCodeAt(2))?3:2,r=t);let s=-1,a=!0;for(let c=e-1;c>=r;--c)if(pn(n.charCodeAt(c))){if(!a){s=c;break}}else a=!1;if(s===-1){if(t===-1)return".";s=t}return n.slice(0,s)},basename(n,e){e!==void 0&&$i(e,"suffix"),$i(n,"path");let t=0,r=-1,o=!0,s;if(n.length>=2&&hv(n.charCodeAt(0))&&n.charCodeAt(1)===mv&&(t=2),e!==void 0&&e.length>0&&e.length<=n.length){if(e===n)return"";let a=e.length-1,c=-1;for(s=n.length-1;s>=t;--s){let l=n.charCodeAt(s);if(pn(l)){if(!o){t=s+1;break}}else c===-1&&(o=!1,c=s+1),a>=0&&(l===e.charCodeAt(a)?--a===-1&&(r=s):(a=-1,r=c))}return t===r?r=c:r===-1&&(r=n.length),n.slice(t,r)}for(s=n.length-1;s>=t;--s)if(pn(n.charCodeAt(s))){if(!o){t=s+1;break}}else r===-1&&(o=!1,r=s+1);return r===-1?"":n.slice(t,r)},extname(n){$i(n,"path");let e=0,t=-1,r=0,o=-1,s=!0,a=0;n.length>=2&&n.charCodeAt(1)===mv&&hv(n.charCodeAt(0))&&(e=r=2);for(let c=n.length-1;c>=e;--c){let l=n.charCodeAt(c);if(pn(l)){if(!s){r=c+1;break}continue}o===-1&&(s=!1,o=c+1),l===gv?t===-1?t=c:a!==1&&(a=1):t!==-1&&(a=-1)}return t===-1||o===-1||a===0||a===1&&t===o-1&&t===r+1?"":n.slice(t,o)},format:che.bind(null,"\\"),parse(n){$i(n,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return e;let t=n.length,r=0,o=n.charCodeAt(0);if(t===1)return pn(o)?(e.root=e.dir=n,e):(e.base=e.name=n,e);if(pn(o)){if(r=1,pn(n.charCodeAt(1))){let p=2,f=p;for(;p<t&&!pn(n.charCodeAt(p));)p++;if(p<t&&p!==f){for(f=p;p<t&&pn(n.charCodeAt(p));)p++;if(p<t&&p!==f){for(f=p;p<t&&!pn(n.charCodeAt(p));)p++;p===t?r=p:p!==f&&(r=p+1)}}}}else if(hv(o)&&n.charCodeAt(1)===mv){if(t<=2)return e.root=e.dir=n,e;if(r=2,pn(n.charCodeAt(2))){if(t===3)return e.root=e.dir=n,e;r=3}}r>0&&(e.root=n.slice(0,r));let s=-1,a=r,c=-1,l=!0,u=n.length-1,d=0;for(;u>=r;--u){if(o=n.charCodeAt(u),pn(o)){if(!l){a=u+1;break}continue}c===-1&&(l=!1,c=u+1),o===gv?s===-1?s=u:d!==1&&(d=1):s!==-1&&(d=-1)}return c!==-1&&(s===-1||d===0||d===1&&s===c-1&&s===a+1?e.base=e.name=n.slice(a,c):(e.name=n.slice(a,s),e.base=n.slice(a,c),e.ext=n.slice(s,c))),a>0&&a!==r?e.dir=n.slice(0,a-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},eGe=(()=>{if(pc){let n=/\\/g;return()=>{let e=w2().replace(n,"/");return e.slice(e.indexOf("/"))}}return()=>w2()})(),qn={resolve(...n){let e="",t=!1;for(let r=n.length-1;r>=-1&&!t;r--){let o=r>=0?n[r]:eGe();$i(o,`paths[${r}]`),o.length!==0&&(e=`${o}/${e}`,t=o.charCodeAt(0)===vs)}return e=yF(e,!t,"/",KW),t?`/${e}`:e.length>0?e:"."},normalize(n){if($i(n,"path"),n.length===0)return".";let e=n.charCodeAt(0)===vs,t=n.charCodeAt(n.length-1)===vs;return n=yF(n,!e,"/",KW),n.length===0?e?"/":t?"./":".":(t&&(n+="/"),e?`/${n}`:n)},isAbsolute(n){return $i(n,"path"),n.length>0&&n.charCodeAt(0)===vs},join(...n){if(n.length===0)return".";let e;for(let t=0;t<n.length;++t){let r=n[t];$i(r,"path"),r.length>0&&(e===void 0?e=r:e+=`/${r}`)}return e===void 0?".":qn.normalize(e)},relative(n,e){if($i(n,"from"),$i(e,"to"),n===e||(n=qn.resolve(n),e=qn.resolve(e),n===e))return"";let t=1,r=n.length,o=r-t,s=1,a=e.length-s,c=o<a?o:a,l=-1,u=0;for(;u<c;u++){let p=n.charCodeAt(t+u);if(p!==e.charCodeAt(s+u))break;p===vs&&(l=u)}if(u===c)if(a>c){if(e.charCodeAt(s+u)===vs)return e.slice(s+u+1);if(u===0)return e.slice(s+u)}else o>c&&(n.charCodeAt(t+u)===vs?l=u:u===0&&(l=0));let d="";for(u=t+l+1;u<=r;++u)(u===r||n.charCodeAt(u)===vs)&&(d+=d.length===0?"..":"/..");return`${d}${e.slice(s+l)}`},toNamespacedPath(n){return n},dirname(n){if($i(n,"path"),n.length===0)return".";let e=n.charCodeAt(0)===vs,t=-1,r=!0;for(let o=n.length-1;o>=1;--o)if(n.charCodeAt(o)===vs){if(!r){t=o;break}}else r=!1;return t===-1?e?"/":".":e&&t===1?"//":n.slice(0,t)},basename(n,e){e!==void 0&&$i(e,"ext"),$i(n,"path");let t=0,r=-1,o=!0,s;if(e!==void 0&&e.length>0&&e.length<=n.length){if(e===n)return"";let a=e.length-1,c=-1;for(s=n.length-1;s>=0;--s){let l=n.charCodeAt(s);if(l===vs){if(!o){t=s+1;break}}else c===-1&&(o=!1,c=s+1),a>=0&&(l===e.charCodeAt(a)?--a===-1&&(r=s):(a=-1,r=c))}return t===r?r=c:r===-1&&(r=n.length),n.slice(t,r)}for(s=n.length-1;s>=0;--s)if(n.charCodeAt(s)===vs){if(!o){t=s+1;break}}else r===-1&&(o=!1,r=s+1);return r===-1?"":n.slice(t,r)},extname(n){$i(n,"path");let e=-1,t=0,r=-1,o=!0,s=0;for(let a=n.length-1;a>=0;--a){let c=n.charCodeAt(a);if(c===vs){if(!o){t=a+1;break}continue}r===-1&&(o=!1,r=a+1),c===gv?e===-1?e=a:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||r===-1||s===0||s===1&&e===r-1&&e===t+1?"":n.slice(e,r)},format:che.bind(null,"/"),parse(n){$i(n,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return e;let t=n.charCodeAt(0)===vs,r;t?(e.root="/",r=1):r=0;let o=-1,s=0,a=-1,c=!0,l=n.length-1,u=0;for(;l>=r;--l){let d=n.charCodeAt(l);if(d===vs){if(!c){s=l+1;break}continue}a===-1&&(c=!1,a=l+1),d===gv?o===-1?o=l:u!==1&&(u=1):o!==-1&&(u=-1)}if(a!==-1){let d=s===0&&t?1:s;o===-1||u===0||u===1&&o===a-1&&o===s+1?e.base=e.name=n.slice(d,a):(e.name=n.slice(d,o),e.base=n.slice(d,a),e.ext=n.slice(o,a))}return s>0?e.dir=n.slice(0,s-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};qn.win32=Wi.win32=Wi;qn.posix=Wi.posix=qn;var YW=pc?Wi.normalize:qn.normalize,tGe=pc?Wi.isAbsolute:qn.isAbsolute,k2=pc?Wi.join:qn.join,lhe=pc?Wi.resolve:qn.resolve,uhe=pc?Wi.relative:qn.relative,bF=pc?Wi.dirname:qn.dirname,k1=pc?Wi.basename:qn.basename,kAt=pc?Wi.extname:qn.extname,RAt=pc?Wi.format:qn.format,PAt=pc?Wi.parse:qn.parse,AAt=pc?Wi.toNamespacedPath:qn.toNamespacedPath,R1=pc?Wi.sep:qn.sep,DAt=pc?Wi.delimiter:qn.delimiter;function dhe(n){return n}var xF=class{constructor(e,t){this.lastCache=void 0;this.lastArgKey=void 0;typeof e=="function"?(this._fn=e,this._computeKey=dhe):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){let t=this._computeKey(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this._fn(e)),this.lastCache}},Zm=class{constructor(e,t){this._map=new Map;this._map2=new Map;typeof e=="function"?(this._fn=e,this._computeKey=dhe):(this._fn=t,this._computeKey=e.getCacheKey)}get cachedValues(){return this._map}get(e){let t=this._computeKey(e);if(this._map2.has(t))return this._map2.get(t);let r=this._fn(e);return this._map.set(e,r),this._map2.set(t,r),r}};var kr=class{constructor(e){this.executor=e;this._didRun=!1}get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}};function q_(n){return n<0?0:n>4294967295?4294967295:n|0}function P1(n){return!n||typeof n!="string"?!0:n.trim().length===0}function j_(n){return n.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function A1(n,e){let t=0,r=n.indexOf(e);for(;r!==-1;)t++,r=n.indexOf(e,r+e.length);return t}function pl(n){return n.split(/\r\n|\r|\n/)}function vhe(n){for(let e=0,t=n.length;e<t;e++){let r=n.charCodeAt(e);if(r!==32&&r!==9)return e}return-1}function yhe(n,e){return n<e?-1:n>e?1:0}function nGe(n,e,t=0,r=n.length,o=0,s=e.length){for(;t<r&&o<s;t++,o++){let l=n.charCodeAt(t),u=e.charCodeAt(o);if(l<u)return-1;if(l>u)return 1}let a=r-t,c=s-o;return a<c?-1:a>c?1:0}function bhe(n,e,t=0,r=n.length,o=0,s=e.length){for(;t<r&&o<s;t++,o++){let l=n.charCodeAt(t),u=e.charCodeAt(o);if(l===u)continue;if(l>=128||u>=128)return nGe(n.toLowerCase(),e.toLowerCase(),t,r,o,s);phe(l)&&(l-=32),phe(u)&&(u-=32);let d=l-u;if(d!==0)return d}let a=r-t,c=s-o;return a<c?-1:a>c?1:0}function phe(n){return n>=97&&n<=122}function SF(n,e){return n.length===e.length&&bhe(n,e)===0}function QW(n,e){let t=e.length;return e.length>n.length?!1:bhe(n,e,0,t)===0}function IF(n,e){let t=Math.min(n.length,e.length),r;for(r=0;r<t;r++)if(n.charCodeAt(r)!==e.charCodeAt(r))return r;return t}function _he(n,e){let t=Math.min(n.length,e.length),r,o=n.length-1,s=e.length-1;for(r=0;r<t;r++)if(n.charCodeAt(o-r)!==e.charCodeAt(s-r))return r;return t}var rGe=/^[\t\n\r\x20-\x7E]*$/;function XW(n){return rGe.test(n)}var HAt=String.fromCharCode(65279);var fhe=class n{static{this._INSTANCE=null}static getInstance(){return n._INSTANCE||(n._INSTANCE=new n),n._INSTANCE}constructor(){this._data=iGe()}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;let t=this._data,r=t.length/3,o=1;for(;o<=r;)if(e<t[3*o])o=2*o;else if(e>t[3*o+1])o=2*o+1;else return t[3*o+2];return 0}};function iGe(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}var mhe=class n{constructor(e){this.confusableDictionary=e}static{this.ambiguousCharacterData=new kr(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'))}static{this.cache=new xF({getCacheKey:JSON.stringify},e=>{function t(d){let p=new Map;for(let f=0;f<d.length;f+=2)p.set(d[f],d[f+1]);return p}function r(d,p){let f=new Map(d);for(let[m,h]of p)f.set(m,h);return f}function o(d,p){if(!d)return p;let f=new Map;for(let[m,h]of d)p.has(m)&&f.set(m,h);return f}let s=this.ambiguousCharacterData.value,a=e.filter(d=>!d.startsWith("_")&&d in s);a.length===0&&(a=["_default"]);let c;for(let d of a){let p=t(s[d]);c=o(c,p)}let l=t(s._common),u=r(l,c);return new n(u)})}static getInstance(e){return n.cache.get(Array.from(e))}static{this._locales=new kr(()=>Object.keys(n.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")))}static getLocales(){return n._locales.value}isAmbiguous(e){return this.confusableDictionary.has(e)}containsAmbiguousCharacter(e){for(let t=0;t<e.length;t++){let r=e.codePointAt(t);if(typeof r=="number"&&this.isAmbiguous(r))return!0}return!1}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}},hhe=class n{static getRawData(){return JSON.parse("[9,10,11,12,13,32,127,160,173,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12288,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999]")}static{this._data=void 0}static getData(){return this._data||(this._data=new Set(n.getRawData())),this._data}static isInvisibleCharacter(e){return n.getData().has(e)}static containsInvisibleCharacter(e){for(let t=0;t<e.length;t++){let r=e.codePointAt(t);if(typeof r=="number"&&n.isInvisibleCharacter(r))return!0}return!1}static get codePoints(){return n.getData()}};function R2(n){return typeof n=="string"}function TF(n){return Array.isArray(n)&&n.every(e=>R2(e))}function P2(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)&&!(n instanceof RegExp)&&!(n instanceof Date)}function D1(n){return typeof n=="number"&&!isNaN(n)}function sGe(n){return typeof n>"u"}function N1(n){return!JW(n)}function JW(n){return sGe(n)||n===null}function Vs(n,e){if(!n)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}function yv(n){return n===47||n===92}function L1(n){return n.replace(/[\\/]/g,qn.sep)}function xhe(n){return n.indexOf("/")===-1&&(n=L1(n)),/^[a-zA-Z]:(\/|$)/.test(n)&&(n="/"+n),n}function ZW(n,e=qn.sep){if(!n)return"";let t=n.length,r=n.charCodeAt(0);if(yv(r)){if(yv(n.charCodeAt(1))&&!yv(n.charCodeAt(2))){let s=3,a=s;for(;s<t&&!yv(n.charCodeAt(s));s++);if(a!==s&&!yv(n.charCodeAt(s+1))){for(s+=1;s<t;s++)if(yv(n.charCodeAt(s)))return n.slice(0,s+1).replace(/[\\/]/g,e)}}return e}else if(cGe(r)&&n.charCodeAt(1)===58)return yv(n.charCodeAt(2))?n.slice(0,2)+e:n.slice(0,2);let o=n.indexOf("://");if(o!==-1){for(o+=3;o<t;o++)if(yv(n.charCodeAt(o)))return n.slice(0,o+1)}return""}function eK(n,e,t,r=R1){if(n===e)return!0;if(!n||!e||e.length>n.length)return!1;if(t){if(!QW(n,e))return!1;if(e.length===n.length)return!0;let s=e.length;return e.charAt(e.length-1)===r&&s--,n.charAt(s)===r}return e.charAt(e.length-1)!==r&&(e+=r),n.indexOf(e)===0}function cGe(n){return n>=65&&n<=90||n>=97&&n<=122}var uGe=/^\w[\w\d+.-]*$/,dGe=/^\//,pGe=/^\/\//;function fGe(n,e){if(!n.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${n.authority}", path: "${n.path}", query: "${n.query}", fragment: "${n.fragment}"}`);if(n.scheme&&!uGe.test(n.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(n.path){if(n.authority){if(!dGe.test(n.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(pGe.test(n.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function mGe(n,e){return!n&&!e?"file":n}function hGe(n,e){switch(n){case"https":case"http":case"file":e?e[0]!==yd&&(e=yd+e):e=yd;break}return e}var Nr="",yd="/",gGe=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,$e=class n{static isUri(e){return e instanceof n?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}constructor(e,t,r,o,s,a=!1){typeof e=="object"?(this.scheme=e.scheme||Nr,this.authority=e.authority||Nr,this.path=e.path||Nr,this.query=e.query||Nr,this.fragment=e.fragment||Nr):(this.scheme=mGe(e,a),this.authority=t||Nr,this.path=hGe(this.scheme,r||Nr),this.query=o||Nr,this.fragment=s||Nr,fGe(this,a))}get fsPath(){return A2(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:r,path:o,query:s,fragment:a}=e;return t===void 0?t=this.scheme:t===null&&(t=Nr),r===void 0?r=this.authority:r===null&&(r=Nr),o===void 0?o=this.path:o===null&&(o=Nr),s===void 0?s=this.query:s===null&&(s=Nr),a===void 0?a=this.fragment:a===null&&(a=Nr),t===this.scheme&&r===this.authority&&o===this.path&&s===this.query&&a===this.fragment?this:new bv(t,r,o,s,a)}static parse(e,t=!1){let r=gGe.exec(e);return r?new bv(r[2]||Nr,CF(r[4]||Nr),CF(r[5]||Nr),CF(r[7]||Nr),CF(r[9]||Nr),t):new bv(Nr,Nr,Nr,Nr,Nr)}static file(e){let t=Nr;if(Pp&&(e=e.replace(/\\/g,yd)),e[0]===yd&&e[1]===yd){let r=e.indexOf(yd,2);r===-1?(t=e.substring(2),e=yd):(t=e.substring(2,r),e=e.substring(r)||yd)}return new bv("file",t,e,Nr,Nr)}static from(e,t){return new bv(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let r;return Pp&&e.scheme==="file"?r=n.file(Wi.join(A2(e,!0),...t)).path:r=qn.join(e.path,...t),e.with({path:r})}toString(e=!1){return tK(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof n)return e;{let t=new bv(e);return t._formatted=e.external??null,t._fsPath=e._sep===The?e.fsPath??null:null,t}}else return e}[Symbol.for("debug.description")](){return`URI(${this.toString()})`}};function D2(n){return!n||typeof n!="object"?!1:typeof n.scheme=="string"&&(typeof n.authority=="string"||typeof n.authority>"u")&&(typeof n.path=="string"||typeof n.path>"u")&&(typeof n.query=="string"||typeof n.query>"u")&&(typeof n.fragment=="string"||typeof n.fragment>"u")}var The=Pp?1:void 0,bv=class extends $e{constructor(){super(...arguments);this._formatted=null;this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=A2(this,!1)),this._fsPath}toString(t=!1){return t?tK(this,!0):(this._formatted||(this._formatted=tK(this,!1)),this._formatted)}toJSON(){let t={$mid:1};return this._fsPath&&(t.fsPath=this._fsPath,t._sep=The),this._formatted&&(t.external=this._formatted),this.path&&(t.path=this.path),this.scheme&&(t.scheme=this.scheme),this.authority&&(t.authority=this.authority),this.query&&(t.query=this.query),this.fragment&&(t.fragment=this.fragment),t}},Che={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function She(n,e,t){let r,o=-1;for(let s=0;s<n.length;s++){let a=n.charCodeAt(s);if(a>=97&&a<=122||a>=65&&a<=90||a>=48&&a<=57||a===45||a===46||a===95||a===126||e&&a===47||t&&a===91||t&&a===93||t&&a===58)o!==-1&&(r+=encodeURIComponent(n.substring(o,s)),o=-1),r!==void 0&&(r+=n.charAt(s));else{r===void 0&&(r=n.substr(0,s));let c=Che[a];c!==void 0?(o!==-1&&(r+=encodeURIComponent(n.substring(o,s)),o=-1),r+=c):o===-1&&(o=s)}}return o!==-1&&(r+=encodeURIComponent(n.substring(o))),r!==void 0?r:n}function vGe(n){let e;for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r===35||r===63?(e===void 0&&(e=n.substr(0,t)),e+=Che[r]):e!==void 0&&(e+=n[t])}return e!==void 0?e:n}function A2(n,e){let t;return n.authority&&n.path.length>1&&n.scheme==="file"?t=`//${n.authority}${n.path}`:n.path.charCodeAt(0)===47&&(n.path.charCodeAt(1)>=65&&n.path.charCodeAt(1)<=90||n.path.charCodeAt(1)>=97&&n.path.charCodeAt(1)<=122)&&n.path.charCodeAt(2)===58?e?t=n.path.substr(1):t=n.path[1].toLowerCase()+n.path.substr(2):t=n.path,Pp&&(t=t.replace(/\//g,"\\")),t}function tK(n,e){let t=e?vGe:She,r="",{scheme:o,authority:s,path:a,query:c,fragment:l}=n;if(o&&(r+=o,r+=":"),(s||o==="file")&&(r+=yd,r+=yd),s){let u=s.indexOf("@");if(u!==-1){let d=s.substr(0,u);s=s.substr(u+1),u=d.lastIndexOf(":"),u===-1?r+=t(d,!1,!1):(r+=t(d.substr(0,u),!1,!1),r+=":",r+=t(d.substr(u+1),!1,!0)),r+="@"}s=s.toLowerCase(),u=s.lastIndexOf(":"),u===-1?r+=t(s,!1,!0):(r+=t(s.substr(0,u),!1,!0),r+=s.substr(u))}if(a){if(a.length>=3&&a.charCodeAt(0)===47&&a.charCodeAt(2)===58){let u=a.charCodeAt(1);u>=65&&u<=90&&(a=`/${String.fromCharCode(u+32)}:${a.substr(3)}`)}else if(a.length>=2&&a.charCodeAt(1)===58){let u=a.charCodeAt(0);u>=65&&u<=90&&(a=`${String.fromCharCode(u+32)}:${a.substr(2)}`)}r+=t(a,!0,!1)}return c&&(r+="?",r+=t(c,!1,!1)),l&&(r+="#",r+=e?l:She(l,!1,!1)),r}function Ehe(n){try{return decodeURIComponent(n)}catch{return n.length>3?n.substr(0,3)+Ehe(n.substr(3)):n}}var Ihe=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function CF(n){return n.match(Ihe)?n.replace(Ihe,e=>Ehe(e)):n}var yr;(Ie=>(Ie.inMemory="inmemory",Ie.vscode="vscode",Ie.internal="private",Ie.walkThrough="walkThrough",Ie.walkThroughSnippet="walkThroughSnippet",Ie.http="http",Ie.https="https",Ie.file="file",Ie.mailto="mailto",Ie.untitled="untitled",Ie.data="data",Ie.command="command",Ie.vscodeRemote="vscode-remote",Ie.vscodeRemoteResource="vscode-remote-resource",Ie.vscodeManagedRemoteResource="vscode-managed-remote-resource",Ie.vscodeUserData="vscode-userdata",Ie.vscodeCustomEditor="vscode-custom-editor",Ie.vscodeNotebookCell="vscode-notebook-cell",Ie.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",Ie.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",Ie.vscodeNotebookCellOutput="vscode-notebook-cell-output",Ie.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",Ie.vscodeNotebookMetadata="vscode-notebook-metadata",Ie.vscodeInteractiveInput="vscode-interactive-input",Ie.vscodeSettings="vscode-settings",Ie.vscodeWorkspaceTrust="vscode-workspace-trust",Ie.vscodeTerminal="vscode-terminal",Ie.vscodeChatCodeBlock="vscode-chat-code-block",Ie.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",Ie.vscodeChatSesssion="vscode-chat-editor",Ie.webviewPanel="webview-panel",Ie.vscodeWebview="vscode-webview",Ie.extension="extension",Ie.vscodeFileResource="vscode-file",Ie.tmp="tmp",Ie.vsls="vsls",Ie.vscodeSourceControl="vscode-scm",Ie.commentsInput="comment",Ie.codeSetting="code-setting",Ie.outputChannel="output"))(yr||={});var yGe="tkn",nK=class{constructor(){this._hosts=Object.create(null);this._ports=Object.create(null);this._connectionTokens=Object.create(null);this._preferredWebSchema="http";this._delegate=null;this._serverRootPath="/"}setPreferredWebSchema(e){this._preferredWebSchema=e}setDelegate(e){this._delegate=e}setServerRootPath(e,t){this._serverRootPath=_Ge(e,t)}getServerRootPath(){return this._serverRootPath}get _remoteResourcesPath(){return qn.join(this._serverRootPath,yr.vscodeRemoteResource)}set(e,t,r){this._hosts[e]=t,this._ports[e]=r}setConnectionToken(e,t){this._connectionTokens[e]=t}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(c){return lv(c),e}let t=e.authority,r=this._hosts[t];r&&r.indexOf(":")!==-1&&r.indexOf("[")===-1&&(r=`[${r}]`);let o=this._ports[t],s=this._connectionTokens[t],a=`path=${encodeURIComponent(e.path)}`;return typeof s=="string"&&(a+=`&${yGe}=${encodeURIComponent(s)}`),$e.from({scheme:nhe?this._preferredWebSchema:yr.vscodeRemoteResource,authority:`${r}:${o}`,path:this._remoteResourcesPath,query:a})}},bGe=new nK;function _Ge(n,e){return qn.join(e??"/",`${n.quality??"oss"}-${n.commit??"dev"}`)}var xGe="vscode-app",rK=class n{static{this.FALLBACK_AUTHORITY=xGe}asBrowserUri(e){let t=this.toUri(e);return this.uriToBrowserUri(t)}uriToBrowserUri(e){return e.scheme===yr.vscodeRemote?bGe.rewrite(e):e.scheme===yr.file&&(the||rhe===`${yr.vscodeFileResource}://${n.FALLBACK_AUTHORITY}`)?e.with({scheme:yr.vscodeFileResource,authority:e.authority||n.FALLBACK_AUTHORITY,query:null,fragment:null}):e}asFileUri(e){let t=this.toUri(e);return this.uriToFileUri(t)}uriToFileUri(e){return e.scheme===yr.vscodeFileResource?e.with({scheme:yr.file,authority:e.authority!==n.FALLBACK_AUTHORITY?e.authority:null,query:null,fragment:null}):e}toUri(e,t){if($e.isUri(e))return e;if(globalThis._VSCODE_FILE_ROOT){let r=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(r))return $e.joinPath($e.parse(r,!0),e);let o=k2(r,e);return $e.file(o)}return $e.parse(t.toUrl(e))}},r2t=new rK,SGe;(s=>{let n=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);s.CoopAndCoep=Object.freeze(n.get("3"));let t="vscode-coi";function r(a){let c;typeof a=="string"?c=new URL(a).searchParams:a instanceof URL?c=a.searchParams:$e.isUri(a)&&(c=new URL(a.toString(!0)).searchParams);let l=c?.get(t);if(l)return n.get(l)}s.getHeadersFromQuery=r;function o(a,c,l){if(!globalThis.crossOriginIsolated)return;let u=c&&l?"3":l?"2":"1";a instanceof URLSearchParams?a.set(t,u):a[t]=u}s.addSearchParam=o})(SGe||={});function eh(n){return A2(n,!0)}var N2=class{constructor(e){this._ignorePathCasing=e}compare(e,t,r=!1){return e===t?0:yhe(this.getComparisonKey(e,r),this.getComparisonKey(t,r))}isEqual(e,t,r=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,r)===this.getComparisonKey(t,r)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,t,r=!1){if(e.scheme===t.scheme){if(e.scheme===yr.file)return eK(eh(e),eh(t),this._ignorePathCasing(e))&&e.query===t.query&&(r||e.fragment===t.fragment);if(whe(e.authority,t.authority))return eK(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(r||e.fragment===t.fragment)}return!1}joinPath(e,...t){return $e.joinPath(e,...t)}basenameOrAuthority(e){return fc(e)||e.authority}basename(e){return qn.basename(e.path)}extname(e){return qn.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===yr.file?t=$e.file(bF(eh(e))).path:(t=qn.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===yr.file?t=$e.file(YW(eh(e))).path:t=qn.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!whe(e.authority,t.authority))return;if(e.scheme===yr.file){let s=uhe(eh(e),eh(t));return Pp?L1(s):s}let r=e.path||"/",o=t.path||"/";if(this._ignorePathCasing(e)){let s=0;for(let a=Math.min(r.length,o.length);s<a&&!(r.charCodeAt(s)!==o.charCodeAt(s)&&r.charAt(s).toLowerCase()!==o.charAt(s).toLowerCase());s++);r=o.substr(0,s)+r.substr(s)}return qn.relative(r,o)}resolvePath(e,t){if(e.scheme===yr.file){let r=$e.file(lhe(eh(e),t));return e.with({authority:r.authority,path:r.path})}return t=xhe(t),e.with({path:qn.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&SF(e,t)}hasTrailingPathSeparator(e,t=R1){if(e.scheme===yr.file){let r=eh(e);return r.length>ZW(r).length&&r[r.length-1]===t}else{let r=e.path;return r.length>1&&r.charCodeAt(r.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=R1){return khe(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=R1){let r=!1;if(e.scheme===yr.file){let o=eh(e);r=o!==void 0&&o.length===ZW(o).length&&o[o.length-1]===t}else{t="/";let o=e.path;r=o.length===1&&o.charCodeAt(o.length-1)===47}return!r&&!khe(e,t)?e.with({path:e.path+"/"}):e}},tr=new N2(()=>!1),u2t=new N2(n=>n.scheme===yr.file?!ehe:!0),d2t=new N2(n=>!0),th=tr.isEqual.bind(tr),p2t=tr.isEqualOrParent.bind(tr),f2t=tr.getComparisonKey.bind(tr),m2t=tr.basenameOrAuthority.bind(tr),fc=tr.basename.bind(tr),fl=tr.extname.bind(tr),h2t=tr.dirname.bind(tr),Rhe=tr.joinPath.bind(tr),g2t=tr.normalizePath.bind(tr),v2t=tr.relativePath.bind(tr),y2t=tr.resolvePath.bind(tr),b2t=tr.isAbsolutePath.bind(tr),whe=tr.isEqualAuthority.bind(tr),khe=tr.hasTrailingPathSeparator.bind(tr),_2t=tr.removeTrailingPathSeparator.bind(tr),x2t=tr.addTrailingPathSeparator.bind(tr);var IGe;(s=>{s.META_DATA_LABEL="label",s.META_DATA_DESCRIPTION="description",s.META_DATA_SIZE="size",s.META_DATA_MIME="mime";function o(a){let c=new Map;a.path.substring(a.path.indexOf(";")+1,a.path.lastIndexOf(";")).split(";").forEach(d=>{let[p,f]=d.split(":");p&&f&&c.set(p,f)});let u=a.path.substring(0,a.path.indexOf(";"));return u&&c.set(s.META_DATA_MIME,u),c}s.parseMetaData=o})(IGe||={});var Ahe=Symbol("MicrotaskDelay");function TGe(n){return!!n&&typeof n.then=="function"}function O1(n){let e=new ko,t=n(e.token),r=new Promise((o,s)=>{let a=e.token.onCancellationRequested(()=>{a.dispose(),s(new dt)});Promise.resolve(t).then(c=>{a.dispose(),e.dispose(),o(c)},c=>{a.dispose(),e.dispose(),s(c)})});return new class{cancel(){e.cancel(),e.dispose()}then(o,s){return r.then(o,s)}catch(o){return this.then(void 0,o)}finally(o){return r.finally(o)}}}function po(n,e,t){return new Promise((r,o)=>{let s=e.onCancellationRequested(()=>{s.dispose(),r(t)});n.then(r,o).finally(()=>s.dispose())})}function Dhe(n,e){return new Promise((t,r)=>{let o=e.onCancellationRequested(()=>{o.dispose(),r(new dt)});n.then(t,r).finally(()=>o.dispose())})}function Dp(n,e,t){let r,o=setTimeout(()=>{r?.(void 0),t?.()},e);return Promise.race([n.finally(()=>clearTimeout(o)),new Promise(s=>r=s)])}function Nhe(n){return new Promise((e,t)=>{let r=n();TGe(r)?r.then(e,t):e(r)})}var iK=class{constructor(){this.isDisposed=!1;this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){let t=()=>{if(this.queuedPromise=null,this.isDisposed)return;let r=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,r};this.queuedPromise=new Promise(r=>{this.activePromise.then(t,t).then(r)})}return new Promise((t,r)=>{this.queuedPromise.then(t,r)})}return this.activePromise=e(),new Promise((t,r)=>{this.activePromise.then(o=>{this.activePromise=null,t(o)},o=>{this.activePromise=null,r(o)})})}dispose(){this.isDisposed=!0}};var CGe=(n,e)=>{let t=!0,r=setTimeout(()=>{t=!1,e()},n);return{isTriggered:()=>t,dispose:()=>{clearTimeout(r),t=!1}}},EGe=n=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,n())}),{isTriggered:()=>e,dispose:()=>{e=!1}}},oK=class{constructor(e){this.defaultDelay=e;this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((o,s)=>{this.doResolve=o,this.doReject=s}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){let o=this.task;return this.task=null,o()}}));let r=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=t===Ahe?EGe(r):CGe(t,r),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject?.(new dt),this.completionPromise=null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}},_v=class{constructor(e){this.delayer=new oK(e),this.throttler=new iK}trigger(e,t){return this.delayer.trigger(()=>this.throttler.queue(e),t)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}};function mc(n,e){return e?new Promise((t,r)=>{let o=setTimeout(()=>{s.dispose(),t()},n),s=e.onCancellationRequested(()=>{clearTimeout(o),s.dispose(),r(new dt)})}):O1(t=>mc(n,t))}var Ap=class{constructor(e){this._size=0;this._isDisposed=!1;this.maxDegreeOfParalellism=e,this.outstandingPromises=[],this.runningPromises=0,this._onDrained=new jt}whenIdle(){return this.size>0?Kl.toPromise(this.onDrained):Promise.resolve()}get onDrained(){return this._onDrained.event}get size(){return this._size}queue(e){if(this._isDisposed)throw new Error("Object has been disposed");return this._size++,new Promise((t,r)=>{this.outstandingPromises.push({factory:e,c:t,e:r}),this.consume()})}consume(){for(;this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism;){let e=this.outstandingPromises.shift();this.runningPromises++;let t=e.factory();t.then(e.c,e.e),t.then(()=>this.consumed(),()=>this.consumed())}}consumed(){this._isDisposed||(this.runningPromises--,--this._size===0&&this._onDrained.fire(),this.outstandingPromises.length>0&&this.consume())}clear(){if(this._isDisposed)throw new Error("Object has been disposed");this.outstandingPromises.length=0,this._size=this.runningPromises}dispose(){this._isDisposed=!0,this.outstandingPromises.length=0,this._size=0,this._onDrained.dispose()}};var wF=class{constructor(e,t){this._isDisposed=!1;this._token=-1,typeof e=="function"&&typeof t=="number"&&this.setIfNotSet(e,t)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(e,t){if(this._isDisposed)throw new Xt("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,e()},t)}setIfNotSet(e,t){if(this._isDisposed)throw new Xt("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,e()},t))}};var wGe,EF;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?EF=(n,e)=>{ohe(()=>{if(t)return;let r=Date.now()+15;e(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,r-Date.now())}}))});let t=!1;return{dispose(){t||(t=!0)}}}:EF=(n,e,t)=>{let r=n.requestIdleCallback(e,typeof t=="number"?{timeout:t}:void 0),o=!1;return{dispose(){o||(o=!0,n.cancelIdleCallback(r))}}},wGe=n=>EF(globalThis,n)})();var sK=class{constructor(e,t){this._didRun=!1;this._executor=()=>{try{this._value=t()}catch(r){this._error=r}finally{this._didRun=!0}},this._handle=EF(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}},kF=class extends sK{constructor(e){super(globalThis,e)}};var ys=class{get isRejected(){return this.outcome?.outcome===1}get isResolved(){return this.outcome?.outcome===0}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===0?this.outcome?.value:void 0}constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return new Promise(t=>{this.completeCallback(e),this.outcome={outcome:0,value:e},t()})}error(e){return new Promise(t=>{this.errorCallback(e),this.outcome={outcome:1,value:e},t()})}cancel(){return this.error(new dt)}},kGe;(t=>{async function n(r){let o,s=await Promise.all(r.map(a=>a.then(c=>c,c=>{o||(o=c)})));if(typeof o<"u")throw o;return s}t.settled=n;function e(r){return new Promise(async(o,s)=>{try{await r(o,s)}catch(a){s(a)}})}t.withAsyncBody=e})(kGe||={});var nr=class n{static fromArray(e){return new n(t=>{t.emitMany(e)})}static fromPromise(e){return new n(async t=>{t.emitMany(await e)})}static fromPromises(e){return new n(async t=>{await Promise.all(e.map(async r=>t.emitOne(await r)))})}static merge(e){return new n(async t=>{await Promise.all(e.map(async r=>{for await(let o of r)t.emitOne(o)}))})}static{this.EMPTY=n.fromArray([])}constructor(e,t){this._state=0,this._results=[],this._error=null,this._onReturn=t,this._onStateChanged=new jt,queueMicrotask(async()=>{let r={emitOne:o=>this.emitOne(o),emitMany:o=>this.emitMany(o),reject:o=>this.reject(o)};try{await Promise.resolve(e(r)),this.resolve()}catch(o){this.reject(o)}finally{r.emitOne=void 0,r.emitMany=void 0,r.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===1)return{done:!0,value:void 0};await Kl.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(e,t){return new n(async r=>{for await(let o of e)r.emitOne(t(o))})}map(e){return n.map(this,e)}static filter(e,t){return new n(async r=>{for await(let o of e)t(o)&&r.emitOne(o)})}filter(e){return n.filter(this,e)}static coalesce(e){return n.filter(e,t=>!!t)}coalesce(){return n.coalesce(this)}static async toPromise(e){let t=[];for await(let r of e)t.push(r);return t}toPromise(){return n.toPromise(this)}emitOne(e){this._state===0&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===0&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(e){this._state===0&&(this._state=2,this._error=e,this._onStateChanged.fire())}};var xv=class{constructor(e){this._deferred=new ys;this._asyncIterable=new nr(o=>{if(t){o.reject(t);return}return r&&o.emitMany(r),this._errorFn=s=>o.reject(s),this._emitFn=s=>o.emitOne(s),this._deferred.p},e);let t,r;this._emitFn=o=>{r||(r=[]),r.push(o)},this._errorFn=o=>{t||(t=o)}}get asyncIterable(){return this._asyncIterable}resolve(){this._deferred.complete()}reject(e){this._errorFn(e),this._deferred.complete()}emitOne(e){this._emitFn(e)}};var fe=class{constructor(e,t=[],r=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=r}};var aK=class{constructor(e,t){this.key=e;this.data=t;this.incoming=new Map;this.outgoing=new Map}},L2=class{constructor(e){this._hashFn=e;this._nodes=new Map}roots(){let e=[];for(let t of this._nodes.values())t.outgoing.size===0&&e.push(t);return e}insertEdge(e,t){let r=this.lookupOrInsertNode(e),o=this.lookupOrInsertNode(t);r.outgoing.set(o.key,o),o.incoming.set(r.key,r)}removeNode(e){let t=this._hashFn(e);this._nodes.delete(t);for(let r of this._nodes.values())r.outgoing.delete(t),r.incoming.delete(t)}lookupOrInsertNode(e){let t=this._hashFn(e),r=this._nodes.get(t);return r||(r=new aK(t,e),this._nodes.set(t,r)),r}lookup(e){return this._nodes.get(this._hashFn(e))}isEmpty(){return this._nodes.size===0}toString(){let e=[];for(let[t,r]of this._nodes)e.push(`${t}
	(-> incoming)[${[...r.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...r.outgoing.keys()].join(",")}]
`);return e.join(`
`)}findCycleSlow(){for(let[e,t]of this._nodes){let r=new Set([e]),o=this._findCycle(t,r);if(o)return o}}_findCycle(e,t){for(let[r,o]of e.outgoing){if(t.has(r))return[...t,r].join(" -> ");t.add(r);let s=this._findCycle(o,t);if(s)return s;t.delete(r)}}};var H_=class{constructor(...e){this._entries=new Map;for(let[t,r]of e)this.set(t,r)}set(e,t){let r=this._entries.get(e);return this._entries.set(e,t),r}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}};var RGe=!1,RF=class extends Error{constructor(e){super("cyclic dependency between services"),this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}},PF=class n{constructor(e=new H_,t=!1,r,o=RGe){this._services=e;this._strict=t;this._parent=r;this._enableTracing=o;this._isDisposed=!1;this._servicesToMaybeDispose=new Set;this._children=new Set;this._activeInstantiations=new Set;this._services.set(H,this),this._globalGraph=o?r?._globalGraph??new L2(s=>s):void 0}dispose(){if(!this._isDisposed){this._isDisposed=!0,pv(this._children),this._children.clear();for(let e of this._servicesToMaybeDispose)I1(e)&&e.dispose();this._servicesToMaybeDispose.clear()}}_throwIfDisposed(){if(this._isDisposed)throw new Error("InstantiationService has been disposed")}createChild(e,t){this._throwIfDisposed();let r=this,o=new class extends n{dispose(){r._children.delete(o),super.dispose()}}(e,this._strict,this,this._enableTracing);return this._children.add(o),t?.add(o),o}invokeFunction(e,...t){this._throwIfDisposed();let r=O2.traceInvocation(this._enableTracing,e),o=!1;try{return e({get:a=>{if(o)throw Ame("service accessor is only valid during the invocation of its target method");let c=this._getOrCreateServiceInstance(a,r);if(!c)throw new Error(`[invokeFunction] unknown service '${a}'`);return c}},...t)}finally{o=!0,r.stop()}}createInstance(e,...t){this._throwIfDisposed();let r,o;return e instanceof fe?(r=O2.traceCreation(this._enableTracing,e.ctor),o=this._createInstance(e.ctor,e.staticArguments.concat(t),r)):(r=O2.traceCreation(this._enableTracing,e),o=this._createInstance(e,t,r)),r.stop(),o}_createInstance(e,t=[],r){let o=gd.getServiceDependencies(e).sort((c,l)=>c.index-l.index),s=[];for(let c of o){let l=this._getOrCreateServiceInstance(c.id,r);l||this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${c.id}.`,!1),s.push(l)}let a=o.length>0?o[0].index:t.length;if(t.length!==a){console.trace(`[createInstance] First service dependency of ${e.name} at position ${a+1} conflicts with ${t.length} static arguments`);let c=a-t.length;c>0?t=t.concat(new Array(c)):t=t.slice(0,a)}return Reflect.construct(e,t.concat(s))}_setCreatedServiceInstance(e,t){if(this._services.get(e)instanceof fe)this._services.set(e,t);else if(this._parent)this._parent._setCreatedServiceInstance(e,t);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(e){let t=this._services.get(e);return!t&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):t}_getOrCreateServiceInstance(e,t){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(e));let r=this._getServiceInstanceOrDescriptor(e);return r instanceof fe?this._safeCreateAndCacheServiceInstance(e,r,t.branch(e,!0)):(t.branch(e,!1),r)}_safeCreateAndCacheServiceInstance(e,t,r){if(this._activeInstantiations.has(e))throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,t,r)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,t,r){let o=new L2(l=>l.id.toString()),s=0,a=[{id:e,desc:t,_trace:r}],c=new Set;for(;a.length;){let l=a.pop();if(!c.has(String(l.id))){if(c.add(String(l.id)),o.lookupOrInsertNode(l),s++>1e3)throw new RF(o);for(let u of gd.getServiceDependencies(l.desc.ctor)){let d=this._getServiceInstanceOrDescriptor(u.id);if(d||this._throwIfStrict(`[createInstance] ${e} depends on ${u.id} which is NOT registered.`,!0),this._globalGraph?.insertEdge(String(l.id),String(u.id)),d instanceof fe){let p={id:u.id,desc:d,_trace:l._trace.branch(u.id,!0)};o.insertEdge(l,p),a.push(p)}}}}for(;;){let l=o.roots();if(l.length===0){if(!o.isEmpty())throw new RF(o);break}for(let{data:u}of l){if(this._getServiceInstanceOrDescriptor(u.id)instanceof fe){let p=this._createServiceInstanceWithOwner(u.id,u.desc.ctor,u.desc.staticArguments,u.desc.supportsDelayedInstantiation,u._trace);this._setCreatedServiceInstance(u.id,p)}o.removeNode(u)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,t,r=[],o,s){if(this._services.get(e)instanceof fe)return this._createServiceInstance(e,t,r,o,s,this._servicesToMaybeDispose);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,t,r,o,s);throw new Error(`illegalState - creating UNKNOWN service instance ${t.name}`)}_createServiceInstance(e,t,r=[],o,s,a){if(o){let c=new n(void 0,this._strict,this,this._enableTracing);c._globalGraphImplicitDependency=String(e);let l=new Map,u=new kF(()=>{let d=c._createInstance(t,r,s);for(let[p,f]of l){let m=d[p];if(typeof m=="function")for(let h of f)h.disposable=m.apply(d,h.listener)}return l.clear(),a.add(d),d});return new Proxy(Object.create(null),{get(d,p){if(!u.isInitialized&&typeof p=="string"&&(p.startsWith("onDid")||p.startsWith("onWill"))){let h=l.get(p);return h||(h=new U_,l.set(p,h)),(y,b,_)=>{if(u.isInitialized)return u.value[p](y,b,_);{let x={listener:[y,b,_],disposable:void 0},I=h.push(x);return zi(()=>{I(),x.disposable?.dispose()})}}}if(p in d)return d[p];let f=u.value,m=f[p];return typeof m!="function"||(m=m.bind(f),d[p]=m),m},set(d,p,f){return u.value[p]=f,!0},getPrototypeOf(d){return t.prototype}})}else{let c=this._createInstance(t,r,s);return a.add(c),c}}_throwIfStrict(e,t){if(t&&console.warn(e),this._strict)throw new Error(e)}};var O2=class n{constructor(e,t){this.type=e;this.name=t;this._start=Date.now();this._dep=[]}static{this.all=new Set}static{this._None=new class extends n{constructor(){super(0,null)}stop(){}branch(){return this}}}static traceInvocation(e,t){return e?new n(2,t.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):n._None}static traceCreation(e,t){return e?new n(1,t.name):n._None}static{this._totals=0}branch(e,t){let r=new n(3,e.toString());return this._dep.push([e,t,r]),r}stop(){let e=Date.now()-this._start;n._totals+=e;let t=!1;function r(s,a){let c=[],l=new Array(s+1).join("	");for(let[u,d,p]of a._dep)if(d&&p){t=!0,c.push(`${l}CREATES -> ${u}`);let f=r(s+1,p);f&&c.push(f)}else c.push(`${l}uses -> ${u}`);return c.join(`
`)}let o=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${r(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${n._totals.toFixed(2)}ms)`];(e>2||t)&&n.all.add(o.join(`
`))}};var AF=class{constructor(e){this._isSealed=!1;this._collection=Array.isArray(e)?new H_(...e):e??new H_}define(e,t){if(this._isSealed)throw new Error("This accessor is sealed and cannot be modified anymore.");this._collection.set(e,t)}seal(){if(this._isSealed)throw new Error("This accessor is sealed and cannot be seal again anymore.");return this._isSealed=!0,new PF(this._collection,!0)}};var hc=require("../package.json"),DF=hc.buildType!=="dev",ml=hc.isPreRelease||!DF,cDt=hc.engines.vscode;var M2=class{constructor(e,t){this.name=e;this.version=t}format(){return`${this.name}/${this.version}`}},it=re("IEnvService");var F2=class n{constructor(e,t){this.offset=e;this.timestamp=t}adjust(e){return new n(this.offset+e,this.timestamp)}},M1=re("heatmapService");var NF=`

**Note:** Some files were excluded from the context due to content exclusion rules. Click [here](https://docs.github.com/en/copilot/managing-github-copilot-in-your-organization/configuring-content-exclusions-for-github-copilot) to learn more.`,Te=re("IIgnoreService"),Lhe=class n{static{this.Instance=new n}dispose(){}get isEnabled(){return!1}get isRegexExclusionsEnabled(){return!1}async init(){}async isCopilotIgnored(e){return!1}async asMinimatchPattern(){}};async function cK(n,e){let t=[];for(let r of e)await n.isCopilotIgnored(r)||t.push(r);return t}var fn=re("IExperimentationService"),LF=class{constructor(){this.initializePromise=Promise.resolve();this.initialFetch=Promise.resolve()}isFlightEnabled(e){return!1}isCachedFlightEnabled(e){return Promise.resolve(!1)}isFlightEnabledAsync(e){return Promise.resolve(!1)}getTreatmentVariable(e,t){}getTreatmentVariableAsync(e,t){return Promise.resolve(void 0)}};var Ohe=require("vscode");var bd=re("IScopeSelector");var V_=class{constructor(e){this._scopeSelector=e}static{this.version=1}async selectScope(e,t){if(e??=Ohe.window.activeTextEditor,!!e)return this._scopeSelector.selectEnclosingScope(e,t)}};V_=E([v(0,bd)],V_);var gc=re("ICopilotTokenStore"),OF=class extends ye{constructor(){super(...arguments);this._onDidStoreUpdate=this._register(new jt);this.onDidStoreUpdate=this._onDidStoreUpdate.event}get copilotToken(){return this._copilotToken}set copilotToken(t){let r=this._copilotToken?.token;this._copilotToken=t,r!==t?.token&&this._onDidStoreUpdate.fire()}};var PGe=Object.prototype.hasOwnProperty;function Mhe(n,e){return lK(n,e,new Set)}function lK(n,e,t){if(JW(n))return n;let r=e(n);if(typeof r<"u")return r;if(Array.isArray(n)){let o=[];for(let s of n)o.push(lK(s,e,t));return o}if(P2(n)){if(t.has(n))throw new Error("Cannot clone recursive data-structure");t.add(n);let o={};for(let s in n)PGe.call(n,s)&&(o[s]=lK(n[s],e,t));return t.delete(n),o}return n}function U2(n,e){if(n===e)return!0;if(n==null||e===null||e===void 0||typeof n!=typeof e||typeof n!="object"||Array.isArray(n)!==Array.isArray(e))return!1;let t,r;if(Array.isArray(n)){if(n.length!==e.length)return!1;for(t=0;t<n.length;t++)if(!U2(n[t],e[t]))return!1}else{let o=[];for(r in n)o.push(r);o.sort();let s=[];for(r in e)s.push(r);if(s.sort(),!U2(o,s))return!1;for(t=0;t<o.length;t++)if(!U2(n[o[t]],e[o[t]]))return!1}return!0}function MF(n,e="Unreachable"){throw new Error(e)}function Sv(n,e="unexpected state"){if(!n)throw new Xt(`Assertion Failed: ${e}`)}function Iv(n){if(!n()){debugger;n(),lv(new Xt("Assertion Failed"))}}function uK(n,e){let t=0;for(;t<n.length-1;){let r=n[t],o=n[t+1];if(!e(r,o))return!1;t++}return!0}var ha=class{constructor(e,t,r){this.owner=e;this.debugNameSource=t;this.referenceFn=r}getDebugName(e){return qhe(e,this)}},Fhe=new Map,dK=new WeakMap;function qhe(n,e){let t=dK.get(n);if(t)return t;let r=DGe(n,e);if(r){let o=Fhe.get(r)??0;o++,Fhe.set(r,o);let s=o===1?r:`${r}#${o}`;return dK.set(n,s),s}}function DGe(n,e){let t=dK.get(n);if(t)return t;let r=e.owner?LGe(e.owner)+".":"",o,s=e.debugNameSource;if(s!==void 0)if(typeof s=="function"){if(o=s(),o!==void 0)return r+o}else return r+s;let a=e.referenceFn;if(a!==void 0&&(o=FF(a),o!==void 0))return r+o;if(e.owner!==void 0){let c=NGe(e.owner,n);if(c!==void 0)return r+c}}function NGe(n,e){for(let t in n)if(n[t]===e)return t}var Uhe=new Map,Bhe=new WeakMap;function LGe(n){let e=Bhe.get(n);if(e)return e;let t=OGe(n),r=Uhe.get(t)??0;r++,Uhe.set(t,r);let o=r===1?t:`${t}#${r}`;return Bhe.set(n,o),o}function OGe(n){let e=n.constructor;return e?e.name:"Object"}function FF(n){let e=n.toString(),r=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e);return(r?r[1]:void 0)?.trim()}var jhe;function Hhe(n){jhe=n}function hl(){return jhe}var UF=class{constructor(){this.indentation=0;this.changedObservablesSets=new WeakMap}textToConsoleArgs(e){return MGe([F1(BGe("|  ",this.indentation)),e])}formatInfo(e){return e.hadValue?e.didChange?[F1(" "),_d(q2(e.oldValue,70),{color:"red",strikeThrough:!0}),F1(" "),_d(q2(e.newValue,60),{color:"green"})]:[F1(" (unchanged)")]:[F1(" "),_d(q2(e.newValue,60),{color:"green"}),F1(" (initial)")]}handleObservableChanged(e,t){console.log(...this.textToConsoleArgs([B2("observable value changed"),_d(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t)]))}formatChanges(e){if(e.size!==0)return _d(" (changed deps: "+[...e].map(t=>t.debugName).join(", ")+")",{color:"gray"})}handleDerivedCreated(e){let t=e.handleChange;this.changedObservablesSets.set(e,new Set),e.handleChange=(r,o)=>(this.changedObservablesSets.get(e).add(r),t.apply(e,[r,o]))}handleDerivedRecomputed(e,t){let r=this.changedObservablesSets.get(e);console.log(...this.textToConsoleArgs([B2("derived recomputed"),_d(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t),this.formatChanges(r),{data:[{fn:e._debugNameData.referenceFn??e._computeFn}]}])),r.clear()}handleFromEventObservableTriggered(e,t){console.log(...this.textToConsoleArgs([B2("observable from event triggered"),_d(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t),{data:[{fn:e._getValue}]}]))}handleAutorunCreated(e){let t=e.handleChange;this.changedObservablesSets.set(e,new Set),e.handleChange=(r,o)=>(this.changedObservablesSets.get(e).add(r),t.apply(e,[r,o]))}handleAutorunTriggered(e){let t=this.changedObservablesSets.get(e);console.log(...this.textToConsoleArgs([B2("autorun"),_d(e.debugName,{color:"BlueViolet"}),this.formatChanges(t),{data:[{fn:e._debugNameData.referenceFn??e._runFn}]}])),t.clear(),this.indentation++}handleAutorunFinished(e){this.indentation--}handleBeginTransaction(e){let t=e.getDebugName();t===void 0&&(t=""),console.log(...this.textToConsoleArgs([B2("transaction"),_d(t,{color:"BlueViolet"}),{data:[{fn:e._fn}]}])),this.indentation++}handleEndTransaction(){this.indentation--}};function MGe(n){let e=new Array,t=[],r="";function o(a){if("length"in a)for(let c of a)c&&o(c);else"text"in a?(r+=`%c${a.text}`,e.push(a.style),a.data&&t.push(...a.data)):"data"in a&&t.push(...a.data)}o(n);let s=[r,...e];return s.push(...t),s}function F1(n){return _d(n,{color:"black"})}function B2(n){return _d(qGe(`${n}: `,10),{color:"black",bold:!0})}function _d(n,e={color:"black"}){function t(o){return Object.entries(o).reduce((s,[a,c])=>`${s}${a}:${c};`,"")}let r={color:e.color};return e.strikeThrough&&(r["text-decoration"]="line-through"),e.bold&&(r["font-weight"]="bold"),{text:n,style:t(r)}}function q2(n,e){switch(typeof n){case"number":return""+n;case"string":return n.length+2<=e?`"${n}"`:`"${n.substr(0,e-7)}"+...`;case"boolean":return n?"true":"false";case"undefined":return"undefined";case"object":return n===null?"null":Array.isArray(n)?FGe(n,e):UGe(n,e);case"symbol":return n.toString();case"function":return`[[Function${n.name?" "+n.name:""}]]`;default:return""+n}}function FGe(n,e){let t="[ ",r=!0;for(let o of n){if(r||(t+=", "),t.length-5>e){t+="...";break}r=!1,t+=`${q2(o,e-t.length)}`}return t+=" ]",t}function UGe(n,e){let t="{ ",r=!0;for(let[o,s]of Object.entries(n)){if(r||(t+=", "),t.length-5>e){t+="...";break}r=!1,t+=`${o}: ${q2(s,e-t.length)}`}return t+=" }",t}function BGe(n,e){let t="";for(let r=1;r<=e;r++)t+=n;return t}function qGe(n,e){for(;n.length<e;)n+=" ";return n}function Yl(n){return new j2(new ha(void 0,void 0,n),n,void 0,void 0)}function pK(n,e){return new j2(new ha(n.owner,n.debugName,n.debugReferenceFn??e),e,void 0,void 0)}function G_(n){let e=new _t,t=pK({owner:void 0,debugName:void 0,debugReferenceFn:n},r=>{e.clear(),n(r,e)});return zi(()=>{t.dispose(),e.dispose()})}var j2=class{constructor(e,t,r,o){this._debugNameData=e;this._runFn=t;this.createChangeSummary=r;this._handleChange=o;this.state=2;this.updateCount=0;this.disposed=!1;this.dependencies=new Set;this.dependenciesToBeRemoved=new Set;this.changeSummary=this.createChangeSummary?.(),hl()?.handleAutorunCreated(this),this._runIfNeeded(),M_(this)}get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}dispose(){this.disposed=!0;for(let e of this.dependencies)e.removeObserver(this);this.dependencies.clear(),F_(this)}_runIfNeeded(){if(this.state===3)return;let e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e,this.state=3;let t=this.disposed;try{if(!t){hl()?.handleAutorunTriggered(this);let r=this.changeSummary;this.changeSummary=this.createChangeSummary?.(),this._runFn(this,r)}}finally{t||hl()?.handleAutorunFinished(this);for(let r of this.dependenciesToBeRemoved)r.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===3&&(this.state=1),this.updateCount++}endUpdate(){if(this.updateCount===1)do{if(this.state===1){this.state=3;for(let e of this.dependencies)if(e.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3);this.updateCount--,Iv(()=>this.updateCount>=0)}handlePossibleChange(e){this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(this.state=1)}handleChange(e,t){this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(!this._handleChange||this._handleChange({changedObservable:e,change:t,didChange:o=>o===e},this.changeSummary))&&(this.state=2)}readObservable(e){if(this.disposed)return e.get();e.addObserver(this);let t=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),t}};(e=>e.Observer=j2)(Yl||={});var Np=(n,e)=>n===e;var Vhe;function Ghe(n){Vhe=n}var zhe;function $he(n){zhe=n}var fK;function Whe(n){fK=n}var BF=class{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t){let r=t===void 0?void 0:e,o=t===void 0?e:t;return fK({owner:r,debugName:()=>{let s=FF(o);if(s!==void 0)return s;let c=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(o.toString());if(c)return`${this.debugName}.${c[2]}`;if(!r)return`${this.debugName} (mapped)`},debugReferenceFn:o},s=>o(this.read(s),s))}flatten(){return fK({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,t){return e.add(Vhe(this,t)),this}keepObserved(e){return e.add(zhe(this)),this}get debugValue(){return this.get()}},Tv=class extends BF{constructor(){super(...arguments);this.observers=new Set}addObserver(t){let r=this.observers.size;this.observers.add(t),r===0&&this.onFirstObserverAdded()}removeObserver(t){this.observers.delete(t)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}};function H2(n,e){let t=new qF(n,e);try{n(t)}finally{t.finish()}}function mK(n,e,t){n?e(n):H2(e,t)}var qF=class{constructor(e,t){this._fn=e;this._getDebugName=t;this.updatingObservers=[];hl()?.handleBeginTransaction(this)}getDebugName(){return this._getDebugName?this._getDebugName():FF(this._fn)}updateObserver(e,t){this.updatingObservers.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){let e=this.updatingObservers;for(let t=0;t<e.length;t++){let{observer:r,observable:o}=e[t];r.endUpdate(o)}this.updatingObservers=null,hl()?.handleEndTransaction()}};function Ql(n,e){return e!==void 0?new U1(new ha(n,void 0,e),e,void 0,void 0,void 0,Np):new U1(new ha(void 0,void 0,n),n,void 0,void 0,void 0,Np)}function V2(n,e){return new U1(new ha(n.owner,n.debugName,n.debugReferenceFn),e,void 0,void 0,n.onLastObserverRemoved,n.equalsFn??Np)}Whe(V2);var U1=class extends Tv{constructor(t,r,o,s,a=void 0,c){super();this._debugNameData=t;this._computeFn=r;this.createChangeSummary=o;this._handleChange=s;this._handleLastObserverRemoved=a;this._equalityComparator=c;this.state=0;this.value=void 0;this.updateCount=0;this.dependencies=new Set;this.dependenciesToBeRemoved=new Set;this.changeSummary=void 0;this.changeSummary=this.createChangeSummary?.(),hl()?.handleDerivedCreated(this)}get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}onLastObserverRemoved(){this.state=0,this.value=void 0;for(let t of this.dependencies)t.removeObserver(this);this.dependencies.clear(),this._handleLastObserverRemoved?.()}get(){if(this.observers.size===0){let t=this._computeFn(this,this.createChangeSummary?.());return this.onLastObserverRemoved(),t}else{do{if(this.state===1){for(let t of this.dependencies)if(t.reportChanges(),this.state===2)break}this.state===1&&(this.state=3),this._recomputeIfNeeded()}while(this.state!==3);return this.value}}_recomputeIfNeeded(){if(this.state===3)return;let t=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=t;let r=this.state!==0,o=this.value;this.state=3;let s=this.changeSummary;this.changeSummary=this.createChangeSummary?.();try{this.value=this._computeFn(this,s)}finally{for(let c of this.dependenciesToBeRemoved)c.removeObserver(this);this.dependenciesToBeRemoved.clear()}let a=r&&!this._equalityComparator(o,this.value);if(hl()?.handleDerivedRecomputed(this,{oldValue:o,newValue:this.value,change:void 0,didChange:a,hadValue:r}),a)for(let c of this.observers)c.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(t){this.updateCount++;let r=this.updateCount===1;if(this.state===3&&(this.state=1,!r))for(let o of this.observers)o.handlePossibleChange(this);if(r)for(let o of this.observers)o.beginUpdate(this)}endUpdate(t){if(this.updateCount--,this.updateCount===0){let r=[...this.observers];for(let o of r)o.endUpdate(this)}Iv(()=>this.updateCount>=0)}handlePossibleChange(t){if(this.state===3&&this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)){this.state=1;for(let r of this.observers)r.handlePossibleChange(this)}}handleChange(t,r){if(this.dependencies.has(t)&&!this.dependenciesToBeRemoved.has(t)){let o=this._handleChange?this._handleChange({changedObservable:t,change:r,didChange:a=>a===t},this.changeSummary):!0,s=this.state===3;if(o&&(this.state===1||s)&&(this.state=2,s))for(let a of this.observers)a.handlePossibleChange(this)}}readObservable(t){t.addObserver(this);let r=t.get();return this.dependencies.add(t),this.dependenciesToBeRemoved.delete(t),r}addObserver(t){let r=!this.observers.has(t)&&this.updateCount>0;super.addObserver(t),r&&t.beginUpdate(this)}removeObserver(t){let r=this.observers.has(t)&&this.updateCount>0;super.removeObserver(t),r&&t.endUpdate(this)}};function Ki(...n){let e,t,r;return n.length===3?[e,t,r]=n:[t,r]=n,new Lp(new ha(e,void 0,r),t,r,()=>Lp.globalTransaction,Np)}function Yhe(n,e,t){return new Lp(new ha(n.owner,n.debugName,n.debugReferenceFn??t),e,t,()=>Lp.globalTransaction,n.equalsFn??Np)}var Lp=class extends Tv{constructor(t,r,o,s,a){super();this._debugNameData=t;this.event=r;this._getValue=o;this._getTransaction=s;this._equalityComparator=a;this.hasValue=!1;this.handleEvent=t=>{let r=this._getValue(t),o=this.value,s=!this.hasValue||!this._equalityComparator(o,r),a=!1;s&&(this.value=r,this.hasValue&&(a=!0,mK(this._getTransaction(),c=>{hl()?.handleFromEventObservableTriggered(this,{oldValue:o,newValue:r,change:void 0,didChange:s,hadValue:this.hasValue});for(let l of this.observers)c.updateObserver(l,this),l.handleChange(this,void 0)},()=>{let c=this.getDebugName();return"Event fired"+(c?`: ${c}`:"")})),this.hasValue=!0),a||hl()?.handleFromEventObservableTriggered(this,{oldValue:o,newValue:r,change:void 0,didChange:s,hadValue:this.hasValue})}}getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){let t=this.getDebugName();return"From Event"+(t?`: ${t}`:"")}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0,this.hasValue=!1,this.value=void 0}get(){return this.subscription?(this.hasValue||this.handleEvent(void 0),this.value):this._getValue(void 0)}};(t=>{t.Observer=Lp;function e(r,o){let s=!1;Lp.globalTransaction===void 0&&(Lp.globalTransaction=r,s=!0);try{o()}finally{s&&(Lp.globalTransaction=void 0)}}t.batchEventsGlobally=e})(Ki||={});function hK(n){return typeof n=="string"?new jF(n):new jF(void 0,n)}var jF=class extends Tv{constructor(t,r){super();this._debugName=t;this._owner=r}get debugName(){return new ha(this._owner,this._debugName,void 0).getDebugName(this)??"Observable Signal"}toString(){return this.debugName}trigger(t,r){if(!t){H2(o=>{this.trigger(o,r)},()=>`Trigger signal ${this.debugName}`);return}for(let o of this.observers)t.updateObserver(o,this),o.handleChange(this,r)}get(){}};function Qhe(n){let e=new HF(!1,void 0);return n.addObserver(e),zi(()=>{n.removeObserver(e)})}$he(Qhe);function Xhe(n,e){let t=new HF(!0,e);return n.addObserver(t),e?e(n.get()):n.reportChanges(),zi(()=>{n.removeObserver(t)})}Ghe(Xhe);var HF=class{constructor(e,t){this._forceRecompute=e;this._handleValue=t;this._counter=0}beginUpdate(e){this._counter++}endUpdate(e){this._counter--,this._counter===0&&this._forceRecompute&&(this._handleValue?this._handleValue(e.get()):e.reportChanges())}handlePossibleChange(e){}handleChange(e,t){}};function Jhe(n,e){let t;return V2({owner:n,debugReferenceFn:e},o=>(t=e(o,t),t))}function Zhe(n,e,t,r){let o=new VF(t,r);return V2({debugReferenceFn:t,owner:n,onLastObserverRemoved:()=>{o.dispose(),o=new VF(t)}},a=>(o.setItems(e.read(a)),o.getItems()))}var VF=class{constructor(e,t){this._map=e;this._keySelector=t;this._cache=new Map;this._items=[]}dispose(){this._cache.forEach(e=>e.store.dispose()),this._cache.clear()}setItems(e){let t=[],r=new Set(this._cache.keys());for(let o of e){let s=this._keySelector?this._keySelector(o):o,a=this._cache.get(s);if(a)r.delete(s);else{let c=new _t;a={out:this._map(o,c),store:c},this._cache.set(s,a)}t.push(a.out)}for(let o of r)this._cache.get(o).store.dispose(),this._cache.delete(o);this._items=t}getItems(){return this._items}};function ege(n,e){return Jhe(n,(t,r)=>r??e(t))}var Cv="github.copilot",be=re("IConfigurationService"),tge=(n,e)=>Yhe({debugName:()=>`Configuration Key "${e.id}"`},t=>n.onDidChangeConfiguration(r=>{r.affectsConfiguration(e.fullyQualifiedId)&&t(r)}),()=>n.getConfig(e)),zF=class{getConfigMixedWithDefaults(e){let t=this.getConfig(e);return t===void 0?e.defaultValue:P2(t)&&P2(e.defaultValue)?{...e.defaultValue,...t}:t}};var GF;function HGe(){if(!GF){GF=new Map;let e=hc.contributes.configuration.map(r=>r.properties),t=Object.assign({},...e);for(let r in t)typeof t[r].default<"u"&&GF.set(r,t[r].default)}return GF}function nge(n,e){let t=`${Cv}.${n}`,r=HGe().get(t);if(typeof r<"u"&&!U2(e,r))throw new Error(`The default value for setting ${n} is different in package.json and in code`);let o=n.indexOf("."),s=n.substring(0,o);if(s!=="editor"&&s!=="chat"&&s!=="advanced"&&s!=="notebook"&&s!=="renameSuggestions")throw new Error(`Unexpected setting section ${s} in setting ${n}`);let a=n.substring(o+1);return{id:n,fullyQualifiedId:t,firstPart:s,secondPart:a,defaultValue:e}}function Ht(n,e){return{...nge(n,e),configType:0}}function vc(n,e){return{...nge(n,e),configType:1}}var gK="7/600",le;(Je=>(Je.DebugOverrideCAPIUrl=Ht("advanced.debug.overrideCAPIUrl","https://api.githubcopilot.com"),Je.DebugOverrideFastRewriteUrl=Ht("advanced.debug.overrideFastRewriteUrl",void 0),Je.DebugOverrideFastRewriteEngine=Ht("advanced.debug.overrideFastRewriteEngine",void 0),Je.DebugOverrideChatEngine=Ht("advanced.debug.overrideChatEngine",void 0),Je.DebugOverrideEmbeddingsModel=Ht("advanced.debug.overrideEmbeddingsModel",void 0),Je.DebugOverrideChatMaxTokenNum=Ht("advanced.debug.overrideChatMaxTokenNum",0),Je.DebugReportFeedback=Ht("advanced.debug.reportFeedback",!1),Je.DebugUseNodeFetcher=Ht("advanced.debug.useNodeFetcher",!1),Je.DebugUseElectronFetcher=Ht("advanced.debug.useElectronFetcher",!0),Je.DebugOverrideModelNames=Ht("advanced.debug.overrideModelNames",{}),Je.ConversationVariablesEnablements=Ht("advanced.variables",{"*":ml}),Je.InternalLoggingEnabled=Ht("advanced.internalLogging",void 0),Je.KerberosServicePrincipal=Ht("advanced.kerberosServicePrincipal",void 0),Je.ProjectLabelsExpanded=vc("advanced.projectLabels.expanded",!1),Je.ProjectLabelsChat=vc("advanced.projectLabels.chat",!1),Je.ProjectLabelsInline=vc("advanced.projectLabels.inline",!1),Je.WorkspaceUseChunksEndpoint=vc("advanced.workspace.useChunksEndpoint",!1),Je.WorkspacePreInitEmbeddings=vc("advanced.workspace.preInitEmbeddings",!1),Je.FeedbackOnChange=Ht("advanced.feedback.onChange",!1),Je.ReviewIntent=Ht("advanced.review.intent",!1),Je.EditIntentFastRewrite=vc("advanced.edit.useFastRewrite",!0),Je.EditIntentRateLimit=vc("advanced.edit.rateLimit",gK),Je.EditUseOldPrompt=vc("advanced.edit.useOldPrompt",!1),Je.EditRemindNoCodeDuplication=vc("chat.advanced.edit.remindNoCodeDuplication",!0),Je.NotebookSummaryExperimentEnabled=Ht("advanced.notebook.summaryExperimentEnabled",!1),Je.NotebookVariableFilteringEnabled=Ht("advanced.notebook.variableFilteringEnabled",!1),Je.TerminalToDebuggerEnabled=Ht("advanced.debugTerminalCommands",!1),Je.TerminalToDebuggerPatterns=Ht("advanced.debugTerminalCommandPatterns",[]),Je.AuthProvider=Ht("advanced.authProvider","github"),Je.InlineEditsEnabled=Ht("advanced.inlineEdits.enabled",!1),Je.InlineEditFirstEditStrategy=Ht("advanced.inlineEdits.firstEditPickStrategy","closestToEdit"),Je.InlineEditsTriggerOnSelection=Ht("advanced.inlineEdits.triggerOnSelection",!1),Je.InlineEditsTriggerOnDiagnostics=Ht("advanced.inlineEdits.triggerOnDiagnostics",!1),Je.InlineEditsProviderId=Ht("advanced.inlineEdits.providerId",void 0),Je.InlineEditsFineTunedModelEndpointOverride=Ht("advanced.inlineEdits.fineTunedModel.endpointOverride",void 0),Je.InlineEditsFineTunedModelLogProbThreshold=Ht("advanced.inlineEdits.fineTunedModel.logProbThreshold",void 0),Je.WorkspaceRecordingEnabled=Ht("advanced.localWorkspaceRecording.enabled",!1),Je.InternalWelcomeHintEnabled=Ht("advanced.welcomePageHint.enabled",!0),Je.ChatPromptRewrite=vc("advanced.panel.promptRewrite",!1),Je.TemporalContextMaxAge=vc("advanced.temporalContext.maxAge",300),Je.TemporalContextPreferSameLang=vc("advanced.temporalContext.preferSameLang",!1),Je.TemporalContextEnabled=vc("chat.temporalContext.enabled",!1),Je.CodeGenerationInstructions=Ht("chat.codeGeneration.instructions",[]),Je.TestGenerationInstructions=Ht("chat.testGeneration.instructions",[]),Je.GenerateTestsCodeLens=Ht("chat.generateTests.codeLens",!1),Je.SetupTests=Ht("chat.setupTests.enabled",!0),Je.InlineChatCompletionsTrigger=Ht("chat.inlineChatCompletionTrigger.enabled",!1),Je.InlineChatHint=Ht("chat.inlineChatHint.enabled",!1),Je.SemanticSearchEnabled=Ht("chat.search.semanticTextResults",!1),Je.PanelEditingEnabled=vc("chat.edits.enabled",!0),Je.StartDebuggingIntent=Ht("chat.startDebugging.enabled",!0),Je.UseInstructionFiles=Ht("chat.codeGeneration.useInstructionFiles",!0),Je.CodeFeedback=Ht("chat.reviewSelection.enabled",!0),Je.CodeFeedbackInstructions=Ht("chat.reviewSelection.instructions",[]),Je.FixTestFailure=Ht("chat.fixTestFailure.enabled",!0),Je.RunCommandEnabled=Ht("chat.runCommand.enabled",!0),Je.UseProjectTemplates=Ht("chat.useProjectTemplates",!0),Je.ExplainScopeSelection=Ht("chat.scopeSelection",!1),Je.EnableCodeActions=Ht("editor.enableCodeActions",!0),Je.LocaleOverride=Ht("chat.localeOverride","auto"),Je.TerminalChatLocation=Ht("chat.terminalChatLocation","chatView"),Je.NotebookIterativeImproving=Ht("notebook.iterativeImproving",!1),Je.AutomaticRenameSuggestions=Ht("renameSuggestions.triggerAutomatically",!0),Je.FollowUpsEnabled=Ht("chat.followUps","firstOnly")))(le||={});var oe=re("ILogService"),WF=(a=>(a[a.Off=0]="Off",a[a.Trace=1]="Trace",a[a.Debug=2]="Debug",a[a.Info=3]="Info",a[a.Warning=4]="Warning",a[a.Error=5]="Error",a))(WF||{});var B1=class{constructor(e,t,r){this.public=new $F(t,r,e,!1),this.internal=new $F(t,r,e,!0)}};B1=E([v(1,gc),v(2,be)],B1);var $F=class{constructor(e,t,r,o){this._tokenStore=e;this._configService=t;this._logTargets=r;this._isInternalOnlyLogger=o}get shouldLog(){return this._isInternalOnlyLogger?vK(this._configService,this._tokenStore.copilotToken):!0}_logIt(e,t){this.shouldLog&&(this._isInternalOnlyLogger&&(t=`[\u{1F92B}] ${t}`),this._logTargets.map(r=>r.logIt(e,t)))}trace(e){this._logIt(1,e)}debug(e){this._logIt(2,e)}info(e){this._logIt(3,e)}warn(e){this._logIt(4,e)}error(e,t){let r=e instanceof Error?e.stack??"Empty error":e;this._logIt(5,r+(t?`: ${t}`:""))}};function vK(n,e){let t=n.getConfig(le.InternalLoggingEnabled),r=!!e?.isVscodeTeamMember;return t===void 0?r:t===!1?!1:!!e?.isInternal}var KF=re("ITelemetryUserConfig"),q1=class{constructor(e,t,r){this._tokenStore=r;this.trackingId=e,this.optedIn=t??!1,this.setupUpdateOnToken()}setupUpdateOnToken(){this._tokenStore.onDidStoreUpdate(()=>{let e=this._tokenStore.copilotToken;if(!e)return;let t=e.getTokenValue("rt")==="1",r=e.getTokenValue("tid");r!==void 0&&(this.trackingId=r,this.organizationsList=e.organizationList.toString(),this.optedIn=t)})}};q1=E([v(2,gc)],q1);var ge=re("ITelemetryService"),j1=class{constructor(e){this.value=e;this.isTrustedTelemetryValue=!0}};var H1=class{constructor(e){this.telemetryService=e;e.sendGHTelemetryEvent("extension.activate")}dispose(){this.telemetryService.sendGHTelemetryEvent("extension.deactivate")}};H1=E([v(0,ge)],H1);var VGe=[Lr(H1)];function Lr(n){return{create(e){return e.get(H).createInstance(n)}}}var Ev=class extends ye{constructor(t,r,o){super();this.allActivationBlockers=[];for(let s of t){let a;try{if(a=o.invokeFunction(s.create),I1(a)&&this._register(a),a?.activationBlocker){let c=Qo.create(),l=a.id||"UNKNOWN";this.allActivationBlockers.push(a.activationBlocker.finally(()=>{r.public.info(`activationBlocker from '${l}' took for ${Math.round(c.elapsed())}ms`)}))}}catch(c){r.public.error(c,`Error while loading contribution: ${c}`)}}}async waitForActivationBlockers(){await Promise.allSettled(this.allActivationBlockers)}};Ev=E([v(1,oe),v(2,H)],Ev);var rge=VGe;var yK=class extends ye{constructor(){super(...arguments);this._contextDescriptors=[]}getContextResolverDescriptors(){return this._contextDescriptors}register(t){this._contextDescriptors.push(t)}},zr=new yK;var Bve=q(ht()),uD=q(Ve());var ove="https://aka.ms/microsoft/vscode-copilot-release",xn=re("IDomainService");var Id=re("IGithubRepositoryService"),g5=re("IOctoKitService"),sve=1682102,Lv=class{constructor(e,t){this._domainService=e;this._fetcherService=t}async getCurrentAuthedUserWithToken(e){return this._makeGHAPIRequest("user","GET",e)}async getTeamMembershipWithToken(e,t,r){return this._makeGHAPIRequest(`teams/${e}/memberships/${r}`,"GET",t)}async _makeGHAPIRequest(e,t,r,o){let s=await this._fetcherService.fetch(`${this._domainService.dotComAPIURL}/${e}`,{method:t,headers:{Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28",Authorization:`Bearer ${r}`},body:o?JSON.stringify(o):void 0});if(s.ok)try{return await s.json()}catch{return}}};var tD=class extends Lv{async getCurrentAuthedUserWithToken(e){return{avatar_url:"",login:"NullUser",name:"Null User"}}async getTeamMembershipWithToken(e,t,r){}async _makeGHAPIRequest(e,t,r,o){}};var hn=re("IFetcherService"),Ov=class{constructor(e,t,r,o,s,a){this.status=e;this.statusText=t;this.headers=r;this.getText=o;this.getJson=s;this.getBody=a;this.ok=this.status>=200&&this.status<300}async text(){return this.getText()}async json(){return this.getJson()}async body(){return this.getBody()}};var Gt=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let n;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?n=crypto.getRandomValues.bind(crypto):n=function(r){for(let o=0;o<r.length;o++)r[o]=Math.floor(Math.random()*256);return r};let e=new Uint8Array(16),t=[];for(let r=0;r<256;r++)t.push(r.toString(16).padStart(2,"0"));return function(){n(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let o=0,s="";return s+=t[e[o++]],s+=t[e[o++]],s+=t[e[o++]],s+=t[e[o++]],s+="-",s+=t[e[o++]],s+=t[e[o++]],s+="-",s+=t[e[o++]],s+=t[e[o++]],s+="-",s+=t[e[o++]],s+=t[e[o++]],s+="-",s+=t[e[o++]],s+=t[e[o++]],s+=t[e[o++]],s+=t[e[o++]],s+=t[e[o++]],s+=t[e[o++]],s}}();var mi=class n{static{this.keysExemptedFromSanitization=["VSCode.ABExp.Features","abexp.assignmentcontext"]}constructor(e,t,r){this.properties=e,this.measurements=t,this.issuedTime=r}static createAndMarkAsIssued(e,t){return new n(e||{},t||{},Date.now())}extendedBy(e,t){let r={...this.properties,...e},o={...this.measurements,...t},s=new n(r,o,this.issuedTime);return s.displayedTime=this.displayedTime,s}markAsDisplayed(){this.displayedTime===void 0&&(this.displayedTime=Date.now())}extendWithEditorAgnosticFields(e){this.properties.editor_version=e.getEditorInfo().format(),this.properties.editor_plugin_version=e.getEditorPluginInfo().format(),this.properties.client_machineid=e.machineId,this.properties.client_sessionid=e.sessionId,this.properties.copilot_version=`copilot/${e.getVersion()}`,this.properties.common_extname=e.getEditorPluginInfo().name,this.properties.common_extversion=e.getEditorPluginInfo().version,this.properties.common_vscodeversion=e.getEditorInfo().format()}extendWithConfigProperties(e,t,r){let o=e.dumpConfig();o["copilot.build"]=t.getBuild(),o["copilot.buildType"]=t.getBuildType(),r.trackingId&&(o["copilot.trackingId"]=r.trackingId),r.organizationsList&&(o.organizations_list=r.organizationsList),this.properties={...this.properties,...o}}extendWithRequestId(e){let t={completionId:e.completionId,created:e.created.toString(),headerRequestId:e.headerRequestId,serverExperiments:e.serverExperiments,deploymentId:e.deploymentId};this.properties={...this.properties,...t}}static{this.keysToRemoveFromStandardTelemetryHack=["gitRepoHost","gitRepoName","gitRepoOwner","gitRepoUrl","gitRepoPath","repo","request_option_nwo","userKind"]}static maybeRemoveRepoInfoFromPropertiesHack(e,t){if(e)return t;let r={};for(let o in t)n.keysToRemoveFromStandardTelemetryHack.includes(o)||(r[o]=t[o]);return r}sanitizeKeys(){this.properties=n.sanitizeKeys(this.properties),this.measurements=n.sanitizeKeys(this.measurements)}static sanitizeKeys(e){e=e||{};let t={};for(let r in e){let o=n.keysExemptedFromSanitization.includes(r)?r:r.replace(/\./g,"_");t[o]=e[r]}return t}updateTimeSinceIssuedAndDisplayed(){let e=Date.now()-this.issuedTime;if(this.measurements.timeSinceIssuedMs=e,this.displayedTime!==void 0){let t=Date.now()-this.displayedTime;this.measurements.timeSinceDisplayedMs=t}}makeReadyForSending(e,t,r){this.extendWithConfigProperties(e,t,r),this.extendWithEditorAgnosticFields(t),this.sanitizeKeys(),this.updateTimeSinceIssuedAndDisplayed();for(let o in this.properties)this.properties[o]===void 0&&delete this.properties[o];Rze(t,this.properties)}};function ave(n){if(!n)return;let e={};for(let t in n){let r=n[t];r&&(r.value?e[t]=r.value:e[t]=r)}return e}function Rze(n,e){e.unique_id=Gt(),e.common_extname=n.getEditorPluginInfo().name,e.common_extversion=n.getEditorPluginInfo().version,e.common_vscodeversion=n.getEditorInfo().format()}var Q_=class{constructor(e){this._info=e;this.tokenMap=this.parseToken(e.token)}parseToken(e){let t=new Map,o=e?.split(":")[0]?.split(";");for(let s of o){let[a,c]=s.split("=");t.set(a,c)}return t}get token(){return this._info.token}get sku(){return this._info.sku}get organizationList(){return this._info.organization_list||[]}get enterpriseList(){return this._info.enterprise_list||[]}get endpoints(){return this._info.endpoints||{api:"https://api.githubcopilot.com",telemetry:"https://copilot-telemetry.githubusercontent.com",proxy:"https://copilot-proxy.githubusercontent.com"}}get isInternal(){let e=["4535c7beffc844b46bb1ed4aa04d759a","a5db0bcaae94032fe715fb34a5e4bce2","7184f66dfcee98cb5f08a1cb936d5225","1cb18ac6eedd49b43d74a1c5beb0b955"];for(let t of this.organizationList)if(e.includes(t))return!0;return!1}get isVscodeTeamMember(){return this._info.isVscodeTeamMember}get username(){return this._info.username}isTelemetryEnabled(){return this._isTelemetryEnabled===void 0&&(this._isTelemetryEnabled=this._info.telemetry==="enabled"),this._isTelemetryEnabled}isPublicSuggestionsEnabled(){return this._isPublicSuggestionsEnabled===void 0&&(this._isPublicSuggestionsEnabled=this._info.public_suggestions==="enabled"),this._isPublicSuggestionsEnabled}isChatEnabled(){return this._info.chat_enabled??!1}isCopilotIgnoreEnabled(){return this._info.copilotignore_enabled??!1}get isCopilotCodeReviewEnabled(){return this.getTokenValue("ccr")==="1"}getTokenValue(e){return this.tokenMap.get(e)}};var J_=re("ICopilotTokenManager");function Mv(){return Math.floor(Date.now()/1e3)}var Q1=class extends ye{constructor(t,r,o,s,a,c){super();this._baseOctokitservice=t;this._logService=r;this._telemetryService=o;this._domainService=s;this._fetcherService=a;this._envService=c;this._refreshDelayer=this._register(new _v(1e3));this._isDisposed=!1;this._copilotTokenRefreshEmitter=this._register(new jt);this.onDidCopilotTokenRefresh=this._copilotTokenRefreshEmitter.event;this._register(zi(()=>this._isDisposed=!0))}get copilotToken(){return this._copilotToken}set copilotToken(t){t!==this._copilotToken&&(this._copilotToken=t,this._copilotTokenRefreshEmitter.fire(),t&&this._refreshToken(t.refresh_in))}resetCopilotToken(t){t!==void 0&&this._telemetryService.sendGHTelemetryEvent("auth.reset_token_"+t),this._logService.public.debug(`Resetting copilot token on HTTP error ${t||"unknown"}`),this.copilotToken=void 0}async authFromGitHubToken(t){this._telemetryService.sendGHTelemetryEvent("auth.new_login");let r=await this.fetchCopilotToken(t);if(!r)return this._logService.public.warn("Failed to get copilot token"),this._telemetryService.sendGHTelemetryErrorEvent("auth.request_failed"),{kind:"failure",reason:"FailedToGetToken"};let o=await r.json();if(!o)return this._logService.public.warn("Failed to get copilot token"),this._telemetryService.sendGHTelemetryErrorEvent("auth.request_read_failed"),{kind:"failure",reason:"FailedToGetToken"};if(r.status===401)return this._logService.public.warn("Failed to get copilot token due to 401 status"),this._telemetryService.sendGHTelemetryErrorEvent("auth.unknown_401"),{kind:"failure",reason:"HTTP401"};if(r.status===403&&o.message?.startsWith("API rate limit exceeded"))return this._logService.public.warn("Failed to get copilot token due to exceeding API rate limit"),this._telemetryService.sendGHTelemetryErrorEvent("auth.rate_limited"),{kind:"failure",reason:"RateLimited"};if(!r.ok||!o.token){this._logService.public.warn(`Invalid copilot token: missing token: ${r.status} ${r.statusText}`);let p=mi.createAndMarkAsIssued({status:r.status.toString(),status_text:r.statusText});return this._telemetryService.sendGHTelemetryErrorEvent("auth.invalid_token",p.properties,p.measurements),{kind:"failure",reason:"NotAuthorized",...o.error_details}}let s=o.expires_at;o.expires_at=Mv()+o.refresh_in+60;let c=(await this._baseOctokitservice.getCurrentAuthedUserWithToken(t))?.login??"unknown",l=await this._baseOctokitservice.getTeamMembershipWithToken(sve,t,c),u={...o,username:c,isVscodeTeamMember:!!l},d=mi.createAndMarkAsIssued({},{adjusted_expires_at:o.expires_at,expires_at:s,current_time:Mv()});return this._telemetryService.sendGHTelemetryEvent("auth.new_token",d.properties,d.measurements),{kind:"success",...u}}async _refreshToken(t){if(this._isDisposed)return;let r=Mv();try{await this._refreshDelayer.trigger(async()=>{if(this._isDisposed)return;let o,s="";try{await this.getCopilotToken(!0),o="success"}catch(c){o="failure",s=c.toString()}let a=mi.createAndMarkAsIssued({result:o},{time_taken:Mv()-r});s&&(a.properties.reason=s),this._telemetryService.sendGHTelemetryEvent("auth.token_refresh",a.properties,a.measurements)},t*1e3)}catch(o){if(o instanceof dt)return;throw o}}async fetchCopilotToken(t){let r=this._domainService.tokenURL;return await this._fetcherService.fetch(r,{headers:{Authorization:`token ${t}`,...this._envService.getEditorVersionHeaders()}})}},Y1=class extends Q1{constructor(t,r,o,s,a,c){super(new tD(s,a),r,o,s,a,c);this._completionsToken=t;this.copilotToken={token:t,expires_at:0,refresh_in:0,username:"fixedTokenManager",isVscodeTeamMember:!1}}set completionsToken(t){this._completionsToken=t,this.copilotToken={token:t,expires_at:0,refresh_in:0,username:"fixedTokenManager",isVscodeTeamMember:!1}}get completionsToken(){return this._completionsToken}async getCopilotToken(){return new Q_(this.copilotToken)}async checkCopilotToken(){return{status:"OK"}}};Y1=E([v(1,oe),v(2,ge),v(3,xn),v(4,hn),v(5,it)],Y1);var X_=class extends Q1{constructor(t,r,o,s,a,c,l){super(new tD(s,a),r,o,s,a,c);this.githubToken=t;this.configurationService=l}async getCopilotToken(t){if(!this.copilotToken||this.copilotToken.expires_at<Mv()||t){let r=await this.authFromGitHubToken(this.githubToken);if(r.kind==="failure")throw Error(`Failed to get copilot token: ${r.reason.toString()} ${r.message??""}`);this.copilotToken={...r}}return new Q_(this.copilotToken)}async checkCopilotToken(){if(!this.copilotToken||this.copilotToken.expires_at<Mv()){let r=await this.authFromGitHubToken(this.githubToken);if(r.kind==="failure")return r;this.copilotToken={...r}}return{status:"OK"}}};X_=E([v(1,oe),v(2,ge),v(3,xn),v(4,hn),v(5,it),v(6,be)],X_);var tY=["user:email"],cve=["read:user"],v5=["read:user","user:email","repo","workflow"],xt=re("IAuthenticationService"),X1=class extends ye{constructor(t,r,o){super();this._logService=t;this._tokenStore=r;this._tokenManager=o;this._onDidAuthenticationChange=this._register(new jt);this.onDidAuthenticationChange=this._onDidAuthenticationChange.event;this._onDidAccessTokenChange=this._register(new jt);this.onDidAccessTokenChange=this._onDidAccessTokenChange.event;this._register(o.onDidCopilotTokenRefresh(()=>{this._logService.internal.debug("Handling CopilotToken refresh."),this._handleAuthChangeEvent()}))}get anyGitHubSession(){return this._anyGitHubSession}get permissiveGitHubSession(){return this._permissiveGitHubSession}get copilotToken(){return this._tokenStore.copilotToken}async getCopilotToken(t){try{await this.getAnyGitHubSession({silent:!0});let r=await this._tokenManager.getCopilotToken(t);return this._tokenStore.copilotToken=r,this._copilotTokenError=void 0,r}catch(r){this._tokenStore.copilotToken=void 0;let o=this._copilotTokenError;throw this._copilotTokenError=r,o&&r&&o.message!==r.message&&this._onDidAuthenticationChange.fire(),r}}resetCopilotToken(t){this._tokenStore.copilotToken=void 0,this._tokenManager.resetCopilotToken(t)}async _handleAuthChangeEvent(){let t=this._anyGitHubSession,r=this._permissiveGitHubSession,o=this._tokenStore.copilotToken,s=this._copilotTokenError,a=await Promise.allSettled([this.getAnyGitHubSession({silent:!0}),this.getPermissiveGitHubSession({silent:!0})]);for(let c of a)c.status==="rejected"&&this._logService.public.error(`Error getting a session: ${c.reason}`);if(t?.accessToken!==this._anyGitHubSession?.accessToken||r?.accessToken!==this._permissiveGitHubSession?.accessToken){this._onDidAccessTokenChange.fire(),this._logService.internal.debug("Auth state changed, minting a new CopilotToken...");try{await this.getCopilotToken(!0)}catch{}this._logService.internal.debug("Minted a new CopilotToken.");return}try{await this.getCopilotToken()}catch{}(o?.token!==this._tokenStore.copilotToken?.token||s?.message!==this._copilotTokenError?.message)&&(this._logService.internal.debug("CopilotToken state changed, firing event."),this._onDidAuthenticationChange.fire()),this._logService.internal.debug("Finished handling auth change event.")}};X1=E([v(0,oe),v(1,gc),v(2,J_)],X1);var J1=q(Sve()),iD=require("path");var rD=class{constructor(e,t){this.prev=null;this.next=null;this.key=e,this.value=t}},Xl=class{constructor(e=10){if(e<1)throw new Error("Cache size must be at least 1");this._capacity=e,this._cache=new Map,this._head=new rD("",null),this._tail=new rD("",null),this._head.next=this._tail,this._tail.prev=this._head}_addNode(e){e.prev=this._head,e.next=this._head.next,this._head.next.prev=e,this._head.next=e}_removeNode(e){let t=e.prev,r=e.next;t.next=r,r.prev=t}_moveToHead(e){this._removeNode(e),this._addNode(e)}_popTail(){let e=this._tail.prev;return this._removeNode(e),e}clear(){this._cache.clear(),this._head.next=this._tail,this._tail.prev=this._head}deleteKey(e){let t=this._cache.get(e);if(t)return this._removeNode(t),this._cache.delete(e),t.value}get(e){let t=this._cache.get(e);if(t)return this._moveToHead(t),t.value}keys(){let e=[],t=this._head.next;for(;t!==this._tail;)e.push(t.key),t=t.next;return e}getValues(){let e=[],t=this._head.next;for(;t!==this._tail;)e.push(t.value),t=t.next;return e}put(e,t){let r=this._cache.get(e);if(r)r.value=t,this._moveToHead(r);else if(r=new rD(e,t),this._cache.set(e,r),this._addNode(r),this._cache.size>this._capacity){let o=this._popTail();return this._cache.delete(o.key),[o.key,o.value]}}},T5=class{constructor(e){this.actual=new Xl(e)}dispose(){this.clear()}clear(){let e=this.actual.getValues();for(let t of e)t.dispose();this.actual.clear()}deleteKey(e){let t=this.actual.deleteKey(e);t&&t.dispose()}get(e){return this.actual.get(e)}keys(){return this.actual.keys()}getValues(){return this.actual.getValues()}put(e,t){let r=this.actual.put(e,t);r&&r[1].dispose()}};var Tve=require("fs");function Ive(n,e){let t=0,r=0,o;do o=n.readUInt8(e+r),t|=(o&127)<<r*7,r++;while(o&128);return{value:t,consumed:r}}var Cve=n=>{let e=(0,Tve.readFileSync)(n),t=new Map;for(let r=0;r<e.length;){let o=Ive(e,r);r+=o.consumed,t.set(e.subarray(r,r+o.value),t.size),r+=o.value}return t};var Qn=re("ITokenizerProvider"),Eve=3,Wze=3,Kze=1,C5=class{constructor(){let e=(0,iD.basename)(__dirname)==="dist"?Cve:t=>t;this._cl100kTokenizer=new E5((0,iD.join)(__dirname,"./cl100k_base.tiktoken"),"cl100k_base",e),this._o200kTokenizer=new E5((0,iD.join)(__dirname,"./o200k_base.tiktoken"),"o200k_base",e)}get cl100kTokenizer(){return this._cl100kTokenizer}acquireTokenizer(e){switch(e.tokenizer){case"cl100k_base":return this._cl100kTokenizer;case"o200k_base":return this._o200kTokenizer;default:throw new Error(`Unknown tokenizer: ${e.tokenizer}`)}}},E5=class{constructor(e,t,r){this._tokenFilePath=e;this._encoderName=t;this._parser=r;this._cache=new Xl(5e3);this.baseTokensPerMessage=Wze;this.baseTokensPerName=Kze}tokenize(e){return this._tokenizer||(this._tokenizer=this.initTokenizer()),this._tokenizer.encode(e)}tokenLength(e){if(!e)return 0;let t=this._cache.get(e);return t||(t=this.tokenize(e).length,this._cache.put(e,t)),t}countMessageTokens(e){return this.baseTokensPerMessage+this.countMessageObjectTokens(e)}countToolTokens(e){let r=0;e.length&&(r+=16);let o=8;for(let s of e)r+=o,r+=this.countObjectTokens({name:s.name,description:s.description,parameters:s.parametersSchema});return r*1.1}countMessageObjectTokens(e){let t=0;for(let[r,o]of Object.entries(e))o&&(typeof o=="string"?t+=this.tokenLength(o):o&&(t+=this.countMessageObjectTokens(o)),r==="name"&&o!==void 0&&(t+=this.baseTokensPerName));return t}countObjectTokens(e){let t=0;for(let[r,o]of Object.entries(e))o&&(t+=this.tokenLength(r),typeof o=="string"?t+=this.tokenLength(o):o&&(t+=this.countMessageObjectTokens(o)));return t}initTokenizer(){return(0,J1.createTokenizer)(this._parser(this._tokenFilePath),(0,J1.getSpecialTokensByEncoder)(this._encoderName),(0,J1.getRegexByEncoder)(this._encoderName),64e3)}};var w5=class n{static getIfVisualizationTestIsRunning(){if(oh.instance)return new n}decorateAndRegister(e,t){let r=!1;return e.render=async function(...o){let s=await Object.getPrototypeOf(e).render.apply(this,...o);return r||(r=!0,new pY(e,t),oh.instance?.reload()),s},e}},pY=class{constructor(e,t){this._renderer=e;oh.instance?.addData(`Prompt ${t}`,()=>this.getData())}getData(){class e{constructor(l,u,d){this.label=l;this.children=u;this.range=d;if(!d){let p=u.map(f=>f.range).filter(f=>!!f);if(p.length>0){d=[Number.MAX_SAFE_INTEGER,0];for(let f of p)d[0]=Math.min(d[0],f[0]),d[1]=Math.max(d[1],f[1]);this.range=d}}}toObj(){return{label:this.label,codicon:this.label==="Text"||this.label==="LineBreak"?"text-size":"symbol-class",range:this.range,children:this.children.map(l=>l.toObj())}}}let t=this._renderer,r="";function o(c){if(c.kind===0){let l=["SystemMessage","UserMessage","AssistantMessage"],u=c._obj.constructor.name;l.some(p=>u.indexOf(p)!==-1)&&(r+=`
======== ${u} ========
`);let d=c._children.map(p=>o(p)).filter(p=>p.label!=="LineBreak");return new e(u,d,void 0)}else if(c.kind===1){let l=r.length;return r=r+c.text,new e("Text",[],[l,r.length])}else if(c.kind===2){let l=r.length;return r=r+`
`,new e("LineBreak",[],[l,r.length])}throw new Error}return{root:o(t._root).toObj(),source:r,$fileExtension:"ast.w"}}},oh=class n{constructor(){this.g=globalThis;this._data=[];this._knownLabels=new Set;this.g.$$debugValueEditor_properties=[]}static{this._instance=void 0}static get instance(){return this._instance}static startRun(){this._instance=new n}addData(e,t,r){let o="debugValueProperty###"+e;if(globalThis[o]=()=>{let s=t();return r?{[r]:s}:s},this._knownLabels.has(o))this.g.$$debugValueEditor_refresh?.("{}");else{this._knownLabels.add(o);let s=r?`.${r}`:"";this._data=[...this._data,{label:e,expression:`globalThis[${JSON.stringify(o)}]()${s}`}],this.g.$$debugValueEditor_properties=this._data}}reload(){this.g.$$debugValueEditor_refresh?.("{}")}};var hY=q(Ve());function sh(n){return $e.isUri(n)}function jp(n){return n&&typeof n=="object"&&"uri"in n&&"range"in n}function wve(n){return n&&typeof n=="object"&&"name"in n&&"containerName"in n}var He=q(require("vscode")),Sn=He.Position,Me=He.Range,Hp=He.Selection;var kve=He.CancellationTokenSource;var $r=He.TextEdit,Z_=He.WorkspaceEdit,zt=He.Uri,Ao=He.MarkdownString;var oD=He.DiagnosticSeverity,vl=He.ExtensionMode,ar=He.Location;var ki=He.ChatResponseMarkdownPart,Td=He.ChatResponseFileTreePart,Z1=He.ChatResponseAnchorPart,Ri=He.ChatResponseProgressPart,Rve=He.ChatResponseProgressPart2,k5=He.ChatResponseReferencePart,R5=He.ChatResponseReferencePart2,Pve=He.ChatResponseCodeCitationPart,ex=He.ChatResponseCommandButtonPart,P5=He.ChatResponseWarningPart,A5=He.ChatResponseMovePart,Ave=He.ChatResponseMarkdownWithVulnerabilitiesPart,Dve=He.ChatResponseCodeblockUriPart,_c=He.ChatResponseTextEditPart,tx=He.ChatResponseConfirmationPart,Nve=He.ChatResponseDetectedParticipantPart;var Lve=He.ChatRequestTurn,Ove=He.ChatResponseTurn,Mve=He.NewSymbolName,Fve=He.NewSymbolNameTag,sD=He.NewSymbolNameTriggerKind,aD=He.ChatLocation,fY=He.ChatRequestEditorData,mY=He.ChatRequestNotebookData;var D5=He.LanguageModelToolResult;var N5=He.LanguageModelPromptTsxPart,cD=He.LanguageModelTextPart,Uve=He.ChatReferenceBinaryData,VOt={t:He.l10n.t};var Xo=q(Ve());var Jl=class{toString(){return Object.getPrototypeOf(this).constructor.name}},nx=class{constructor(e,t){this.request=e;this.sessionId=t;this.status="in-progress";this.contextParts=[];this.references=[];this.startTime=Date.now()}addReferences(e){this.references=L5([...this.references,...e])}},Vp=class{constructor(e=[]){this.turns=e}getLatestTurn(){return this.turns[this.turns.length-1]}addTurn(e){this.turns.forEach(t=>t.chatMessages=[]),this.turns.push(e)}};function L5(n){let e=new kn,t=[],r=(s,a)=>{if(s.contains(a))return s;if(a.contains(s))return a;let[c,l]=s.start.line<a.start.line?[s,a]:[a,s];if(c.end.line>=l.start.line-1)return new Me(c.start,l.end)};return n.forEach(s=>{let a=s.anchor;if("variableName"in a)t.push(s);else if(!jp(a))e.set(a,s);else{let c=e.get(a.uri);if(!c)e.set(a.uri,[s]);else if(!(c instanceof hY.PromptReference)){let l=[],u=a.range;c.forEach(p=>{if("variableName"in p.anchor||!jp(p.anchor))return;let f=r(u,p.anchor.range);f?u=f:l.push(p.anchor)});let d={uri:a.uri,range:u};e.set(a.uri,[...l,d].sort((p,f)=>p.range.start.line-f.range.start.line||p.range.end.line-f.range.end.line).map(p=>new hY.PromptReference(p)))}}}),[...Array.from(e.keys()).sort((s,a)=>s.fsPath.localeCompare(a.fsPath)).map(s=>{let a=e.get(s);return a||[]}).flat(),...t]}var Zl=q(ht());function O5(n){if(n<90)return`${n} seconds`;let e=Math.floor(n/60);if(n<=5400)return`${e} minutes`;let t=Math.floor(e/60),r=e%60,o=`${t} hours`;return r>0&&(o+=` ${r} minutes`),o}var lt=(s=>(s[s.InlineChat=1]="InlineChat",s[s.PanelChat=2]="PanelChat",s[s.EditingSession=3]="EditingSession",s[s.Terminal=4]="Terminal",s[s.Other=5]="Other",s))(lt||{});(t=>{function n(r){switch(r){case 1:return"conversationInline";case 2:return"conversationPanel";case 3:return"editingSession";default:return"none"}}t.toString=n;function e(r){switch(r){case 1:return"inline";case 2:return"panel";case 3:return"editingSession";default:return"none"}}t.toStringShorter=e})(lt||={});function Cd(n){switch(n.type){case"offTopic":return{message:Zl.t("Sorry, but I can only assist with programming related questions.")};case"canceled":return{message:"Cancelled"};case"rateLimited":return{message:Zl.t("Sorry, your request was rate-limited. Please wait {0} before trying again.",n.retryAfter?O5(n.retryAfter):"a moment"),responseIsFiltered:!0};case"badRequest":case"failed":return{message:Zl.t("Sorry, your request failed. Please try again. Request id: {0}",n.requestId)};case"filtered":return{message:vY(n.category),responseIsFiltered:!0};case"agent_unauthorized":return{message:Zl.t("Sorry, something went wrong.")};case"agent_failed_dependency":return{message:n.reason};case"length":return{message:Zl.t("Sorry, the response hit the length limit. Please rephrase your prompt.")};case"unknown":return{message:Zl.t("Sorry, no response was returned.")};case"extensionBlocked":return{message:Zl.t("Sorry, something went wrong.")}}}function vY(n,e=!0){switch(n){case"snippy":return e?Zl.t({message:"Sorry, the response matched public code so it was blocked. Please rephrase your prompt. [Learn more](https://aka.ms/copilot-chat-filtered-docs).",comment:["{Locked='](https://aka.ms/copilot-chat-filtered-docs)'}"]}):Zl.t("Sorry, the response matched public code so it was blocked. Please rephrase your prompt.");default:return e?Zl.t({message:"Sorry, the response was filtered by the Responsible AI Service. Please rephrase your prompt and try again. [Learn more](https://aka.ms/copilot-chat-filtered-docs).",comment:["{Locked='](https://aka.ms/copilot-chat-filtered-docs)'}"]}):Zl.t("Sorry, the response was filtered by the Responsible AI Service. Please rephrase your prompt and try again.")}}var gt=class n{constructor(e,t){this.start=e;this.endExclusive=t;if(!Number.isInteger(e)||!Number.isInteger(t))throw new Xt("NaN");if(e>t)throw new Xt(`Invalid range: ${this.toString()}`)}static addRange(e,t){let r=0;for(;r<t.length&&t[r].endExclusive<e.start;)r++;let o=r;for(;o<t.length&&t[o].start<=e.endExclusive;)o++;if(r===o)t.splice(r,0,e);else{let s=Math.min(e.start,t[r].start),a=Math.max(e.endExclusive,t[o-1].endExclusive);t.splice(r,o-r,new n(s,a))}}static tryCreate(e,t){if(!(e>t))return new n(e,t)}static ofLength(e){return new n(0,e)}static ofStartAndLength(e,t){return new n(e,e+t)}get isEmpty(){return this.start===this.endExclusive}delta(e){return new n(this.start+e,this.endExclusive+e)}deltaStart(e){return new n(this.start+e,this.endExclusive)}deltaEnd(e){return new n(this.start,this.endExclusive+e)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(e){return this.start===e.start&&this.endExclusive===e.endExclusive}containsRange(e){return this.start<=e.start&&e.endExclusive<=this.endExclusive}contains(e){return this.start<=e&&e<this.endExclusive}join(e){return new n(Math.min(this.start,e.start),Math.max(this.endExclusive,e.endExclusive))}intersect(e){let t=Math.max(this.start,e.start),r=Math.min(this.endExclusive,e.endExclusive);if(t<=r)return new n(t,r)}intersects(e){let t=Math.max(this.start,e.start),r=Math.min(this.endExclusive,e.endExclusive);return t<r}intersectsOrTouches(e){let t=Math.max(this.start,e.start),r=Math.min(this.endExclusive,e.endExclusive);return t<=r}isBefore(e){return this.endExclusive<=e.start}isAfter(e){return this.start>=e.endExclusive}slice(e){return e.slice(this.start,this.endExclusive)}substring(e){return e.substring(this.start,this.endExclusive)}clip(e){if(this.isEmpty)throw new Xt(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,e))}clipCyclic(e){if(this.isEmpty)throw new Xt(`Invalid clipping range: ${this.toString()}`);return e<this.start?this.endExclusive-(this.start-e)%this.length:e>=this.endExclusive?this.start+(e-this.start)%this.length:e}map(e){let t=[];for(let r=this.start;r<this.endExclusive;r++)t.push(e(r));return t}forEach(e){for(let t=this.start;t<this.endExclusive;t++)e(t)}};var Ed=class n{static{this.chatRequestScheme="ccreq"}static buildUri(e){return e.kind==="latest"?`${n.chatRequestScheme}:latestrequest.copilotmd`:`${n.chatRequestScheme}:${e.id}.copilotmd`}static parseUri(e){if(e===n.buildUri({kind:"latest"}))return{kind:"latest"};{let t=e.match(/ccreq:([^\s]+)\.copilotmd/);if(t)return{kind:"request",id:t[1]}}}static findAllUris(e){let t=/(ccreq:[^\s]+\.copilotmd)/g;return[...e.matchAll(t)].map(r=>{let o=r[1];return{uri:o,range:new gt(r.index,r.index+o.length)}})}};var eu=re("IRequestLogger");var M5=class extends ye{get promptRendererTracing(){return!1}logChatRequest(e,t,r){return new yY(this,e,t,r)}},yY=class{constructor(e,t,r,o){this._logbook=e;this._debugName=t;this._chatEndpoint=r;this._chatParams=o;this._timeToFirstToken=void 0;this._time=new Date}markTimeToFirstToken(e){this._timeToFirstToken=e}resolve(e,t){e.type==="success"?this._logbook.addEntry({type:"ChatMLSuccess",debugName:this._debugName,chatEndpoint:this._chatEndpoint,chatParams:this._chatParams,startTime:this._time,endTime:new Date,timeToFirstToken:this._timeToFirstToken,result:e,deltas:t}):this._logbook.addEntry({type:"ChatMLFailure",debugName:this._debugName,chatEndpoint:this._chatEndpoint,chatParams:this._chatParams,startTime:this._time,endTime:new Date,timeToFirstToken:this._timeToFirstToken,result:e})}resolveWithCancelation(){this._logbook.addEntry({type:"ChatMLCancelation",debugName:this._debugName,chatEndpoint:this._chatEndpoint,chatParams:this._chatParams,startTime:this._time,endTime:new Date})}};var ga=class{constructor(e,t,r){this.intent=e;this.location=t;this.endpoint=r}async buildPrompt(e,t,r){return await(await this.createRenderer(e,this.endpoint,t,r)).render(t,r)}},Fe=class extends uD.PromptRenderer{constructor(t,r,o,s={validate:!0},a,c,l,u){let d=a.acquireTokenizer(t);super(t,r,o,d);this.endpoint=t;this.options=s;this._instantiationService=c;this._requestLogger=l;let p=u.copilotToken;!!(p?.isInternal&&p.isVscodeTeamMember)&&(this.ctorName=r.name||"<anonymous>",this.tracer=new uD.HTMLTracer)}static create(t,r,o,s,a={validate:!0}){return t.invokeFunction(c=>{let l=c.get(Qn),u=new Fe(r,o,s,a,l,t,c.get(eu),c.get(xt)),d=w5.getIfVisualizationTestIsRunning();return d&&(u=d.decorateAndRegister(u,o.name)),u})}createElement(t,...r){return this._instantiationService.createInstance(t.ctor,t.props,...r)}async render(t,r){let o=await super.render(t,r);this.tracer&&this._requestLogger.addPromptTrace(this.ctorName,this.endpoint,o,this.tracer);for(let a=1;a<o.messages.length;a++){let c=o.messages[a],l=o.messages[a-1];c.role==="system"&&l.role==="system"&&(l.content+=`
`+c.content,o.messages.splice(a,1),a--)}let s=o.messages[o.messages.length-1];if(this.options.validate&&s&&s.role!=="user"&&s.role!=="function")throw new Error(Bve.t("Sorry, this message is too long. Please try a shorter question."));return{...o,references:L5(o.references)}}async countTokens(t){return(await super.render(void 0,t)).tokenCount}};Fe=E([v(4,Qn),v(5,H),v(6,eu),v(7,xt)],Fe);async function Qi(n,e,t,r,o,s,a){let c=Fe.create(n,e,t,r,a),{messages:l,tokenCount:u,references:d,metadata:p}=await c.render(o,s);return{messages:l,tokenCount:u,metadatas:p,references:L5(d)}}var lD=class extends uD.PromptRenderer{constructor(t,r,o,s){let a={countMessageTokens(l){throw new Error("Tools may only return text, not messages.")},tokenLength(l,u){return Promise.resolve(o?.countTokens(l,u)??Promise.resolve(1))}},c={modelMaxPromptTokens:o?.tokenBudget??Number.MAX_SAFE_INTEGER,family:"gpt-4",tokenizer:"o200k_base"};super(c,t,r,a);this.instantiationService=s}createElement(t,...r){return this.instantiationService.createInstance(t.ctor,t.props,...r)}};lD=E([v(3,H)],lD);async function qve(n,e,t,r,o){return await n.createInstance(lD,e,t,r).renderElementJSON(o)}var q5=q(Ve());var Gve=require("util");var gn=re("IFileSystemService");async function jve(n,e,t){let r=e.textDocuments.find(s=>s.uri.toString()===t.toString());if(r)return r.getText();let o=await n.readFile(t);return new TextDecoder().decode(o)}var Hve=new class{constructor(){this._cache=null}enable(){this._cache=new Xl(10)}async readJSON(n,e){if(!this._cache)return this._readJSON(n,e);let t=this._cache.get(e.toString());if(t!==void 0)return t;let r=await this._readJSON(n,e);return this._cache.put(e.toString(),r),r}async _readJSON(n,e){let t=await n.readFile(e);return JSON.parse(t.toString())}};var Qze="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function Xze(n=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(let t of Qze)n.indexOf(t)>=0||(e+="\\"+t);return e+="\\s]+)",new RegExp(e,"g")}var bY=Xze();function Jze(n){let e=bY;if(n&&n instanceof RegExp)if(n.global)e=n;else{let t="g";n.ignoreCase&&(t+="i"),n.multiline&&(t+="m"),n.unicode&&(t+="u"),e=new RegExp(n.source,t)}return e.lastIndex=0,e}var Vve=new U_;Vve.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function _Y(n,e,t,r,o){if(e=Jze(e),o||(o=ti.first(Vve)),t.length>o.maxLen){let u=n-o.maxLen/2;return u<0?u=0:r+=u,t=t.substring(u,n+o.maxLen/2),_Y(n,e,t,r,o)}let s=Date.now(),a=n-1-r,c=-1,l=null;for(let u=1;!(Date.now()-s>=o.timeBudget);u++){let d=a-o.windowSize*u;e.lastIndex=Math.max(0,d);let p=Zze(e,t,a,c);if(!p&&l||(l=p,d<=0))break;c=d}if(l){let u={word:l[0],startColumn:r+1+l.index,endColumn:r+1+l.index+l[0].length};return e.lastIndex=0,u}return null}function Zze(n,e,t,r){let o;for(;o=n.exec(e);){let s=o.index||0;if(s<=t&&n.lastIndex>=t)return o;if(r>0&&s>r)return null}return null}var F5=class{constructor(e){this.values=e,this.prefixSum=new Uint32Array(e.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}getCount(){return this.values.length}insertValues(e,t){e=q_(e);let r=this.values,o=this.prefixSum,s=t.length;return s===0?!1:(this.values=new Uint32Array(r.length+s),this.values.set(r.subarray(0,e),0),this.values.set(r.subarray(e),e+s),this.values.set(t,e),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(o.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}setValue(e,t){return e=q_(e),t=q_(t),this.values[e]===t?!1:(this.values[e]=t,e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),!0)}removeValues(e,t){e=q_(e),t=q_(t);let r=this.values,o=this.prefixSum;if(e>=r.length)return!1;let s=r.length-e;return t>=s&&(t=s),t===0?!1:(this.values=new Uint32Array(r.length-t),this.values.set(r.subarray(0,e),0),this.values.set(r.subarray(e+t),e),this.prefixSum=new Uint32Array(this.values.length),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(o.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return this.values.length===0?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(e){return e<0?0:(e=q_(e),this._getPrefixSum(e))}_getPrefixSum(e){if(e<=this.prefixSumValidIndex[0])return this.prefixSum[e];let t=this.prefixSumValidIndex[0]+1;t===0&&(this.prefixSum[0]=this.values[0],t++),e>=this.values.length&&(e=this.values.length-1);for(let r=t;r<=e;r++)this.prefixSum[r]=this.prefixSum[r-1]+this.values[r];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e),this.prefixSum[e]}getIndexOf(e){e=Math.floor(e),this.getTotalSum();let t=0,r=this.values.length-1,o=0,s=0,a=0;for(;t<=r;)if(o=t+(r-t)/2|0,s=this.prefixSum[o],a=s-this.values[o],e<a)r=o-1;else if(e>=s)t=o+1;else break;return new xY(o,e-a)}};var xY=class{constructor(e,t){this.index=e;this.remainder=t;this._prefixSumIndexOfResultBrand=void 0;this.index=e,this.remainder=t}};var Dt=class n{constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new n(e,t)}delta(e=0,t=0){return this.with(this.lineNumber+e,this.column+t)}equals(e){return n.equals(this,e)}static equals(e,t){return!e&&!t?!0:!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return n.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<t.column}isBeforeOrEqual(e){return n.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<=t.column}static compare(e,t){let r=e.lineNumber|0,o=t.lineNumber|0;if(r===o){let s=e.column|0,a=t.column|0;return s-a}return r-o}clone(){return new n(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new n(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}};var xc=class{get lines(){return this._lineStartOffsets.length}constructor(e){this._lineStartOffsets=[0];let t=0;for(;;){let r=e.indexOf(`
`,t);if(r===-1)break;this._lineStartOffsets.push(r+1),t=r+1}}lineLength(e){return this._lineStartOffsets[e]-this._lineStartOffsets[e-1]-1}offsetToPosition(e){let t=1;for(;t<this._lineStartOffsets.length&&!(this._lineStartOffsets[t]>e);t++);let r=e-this._lineStartOffsets[t-1];return new Dt(t,r+1)}startOffsetOfLineContaining(e){let t=1;for(;t<this._lineStartOffsets.length&&!(this._lineStartOffsets[t]>e);t++);return this._lineStartOffsets[t-1]}positionToOffset(e){return e.lineNumber>=this._lineStartOffsets.length?this._lineStartOffsets[this._lineStartOffsets.length-1]+e.column-1:this._lineStartOffsets[e.lineNumber-1]+e.column-1}};var Rn=class n{constructor(e){this.edits=e;let t=-1;for(let r of e){if(!(r.replaceRange.start>=t))throw new Error(`Edits must be disjoint and sorted. Found ${r} after ${t}`);t=r.replaceRange.endExclusive}}static{this.empty=new n([])}static fromJson(e){return new n(e.map(Pi.fromJson))}static from(e){let t=e.map(o=>new Pi(gt.ofStartAndLength(o.rangeOffset,o.rangeLength),o.text));return t.reverse(),new n(t)}static single(e,t){return new n([new Pi(e,t)])}static async fromDiff(e,t,r){let o=await r.computeDiff(e,t,{maxComputationTimeMs:5e3,computeMoves:!1,ignoreTrimWhitespace:!1}),s=new xc(e),a=new xc(t),c=[];for(let l of o.changes)for(let u of l.innerChanges??[]){let d=a.positionToOffset(u.modifiedRange.getStartPosition()),p=a.positionToOffset(u.modifiedRange.getEndPosition()),f=t.substring(d,p),m=s.positionToOffset(u.originalRange.getStartPosition()),h=s.positionToOffset(u.originalRange.getEndPosition()),g=new gt(m,h);c.push(new Pi(g,f))}return new n(c)}normalize(){let e=[],t;for(let r of this.edits)r.newText.length===0&&r.replaceRange.length===0||(t&&t.replaceRange.endExclusive===r.replaceRange.start?t=new Pi(t.replaceRange.join(r.replaceRange),t.newText+r.newText):(t&&e.push(t),t=r));return t&&e.push(t),new n(e)}normalizeEOL(e){return new n(this.edits.map(t=>t.normalizeEOL(e)))}isNoop(e){return this.edits.every(t=>t.isNoop(e))}toString(){return`[${this.edits.map(t=>t.toString()).join(", ")}]`}apply(e){let t=[],r=0;for(let o of this.edits)t.push(e.substring(r,o.replaceRange.start)),t.push(o.newText),r=o.replaceRange.endExclusive;return t.push(e.substring(r)),t.join("")}compose(e){return e$e(this,e)}inverse(e){let t=[],r=0;for(let o of this.edits)t.push(new Pi(gt.ofStartAndLength(o.replaceRange.start+r,o.newText.length),e.substring(o.replaceRange.start,o.replaceRange.endExclusive))),r+=o.newText.length-o.replaceRange.length;return new n(t)}getNewTextRanges(){let e=[],t=0;for(let r of this.edits)e.push(gt.ofStartAndLength(r.replaceRange.start+t,r.newText.length)),t+=r.newText.length-r.replaceRange.length;return e}get isEmpty(){return this.edits.length===0}tryRebase(e){let t=[],r=0,o=0,s=0;for(;o<this.edits.length||r<e.edits.length;){let a=e.edits[r],c=this.edits[o];if(c)a?c.replaceRange.intersects(a.replaceRange)?o++:c.replaceRange.start<a.replaceRange.start?(t.push(new Pi(c.replaceRange.delta(s),c.newText)),o++):(r++,s+=a.newText.length-a.replaceRange.length):(t.push(new Pi(c.replaceRange.delta(s),c.newText)),o++);else break}return new n(t)}removeCommonSuffixPrefix(e){let t=[];for(let r of this.edits){let o=r.removeCommonSuffixPrefix(e);o.isEmpty||t.push(o)}return new n(t)}applyToOffset(e){let t=0;for(let r of this.edits)if(r.replaceRange.start<=e){if(e<r.replaceRange.endExclusive)return r.replaceRange.start+t;t+=r.newText.length-r.replaceRange.length}else break;return e+t}applyToOffsetRange(e){return new gt(this.applyToOffset(e.start),this.applyToOffset(e.endExclusive))}applyToOffsetOrUndefined(e){let t=0;for(let r of this.edits)if(r.replaceRange.start<=e){if(e<r.replaceRange.endExclusive)return;t+=r.newText.length-r.replaceRange.length}else break;return e+t}applyToOffsetRangeOrUndefined(e){let t=this.applyToOffsetOrUndefined(e.start);if(t===void 0)return;let r=this.applyToOffsetOrUndefined(e.endExclusive);if(r!==void 0)return new gt(t,r)}applyInverseToOffset(e){let t=0;for(let r of this.edits){let o=r.newText.length;if(r.replaceRange.start<=e-t){if(e-t<r.replaceRange.start+o)return r.replaceRange.start;t+=o-r.replaceRange.length}else break}return e-t}},Pi=class n{constructor(e,t){this.replaceRange=e;this.newText=t}static delete(e){return new n(e,"")}static fromJson(e){return new n(gt.ofStartAndLength(e.pos,e.len),e.txt)}toString(){return`${this.replaceRange} -> "${this.newText}"`}removeCommonSuffixPrefix(e){let t=e.substring(this.replaceRange.start,this.replaceRange.endExclusive),r=IF(t,this.newText),o=Math.min(t.length-r,this.newText.length-r,_he(t,this.newText)),s=new gt(this.replaceRange.start+r,this.replaceRange.endExclusive-o),a=this.newText.substring(r,this.newText.length-o);return new n(s,a)}normalizeEOL(e){let t=this.newText.replace(/\r\n|\n/g,e);return new n(this.replaceRange,t)}isNoop(e){return this.newText===e.substring(this.replaceRange.start,this.replaceRange.endExclusive)}get isEmpty(){return this.newText.length===0&&this.replaceRange.length===0}};function e$e(n,e){if(n=n.normalize(),e=e.normalize(),n.isEmpty)return e;if(e.isEmpty)return n;let t=[...n.edits],r=[],o=0;for(let s of e.edits){for(;;){let u=t[0];if(!u||u.replaceRange.start+o+u.newText.length>=s.replaceRange.start)break;t.shift(),r.push(u),o+=u.newText.length-u.replaceRange.length}let a=o,c,l;for(;;){let u=t[0];if(!u||u.replaceRange.start+o>s.replaceRange.endExclusive)break;c||(c=u),l=u,t.shift(),o+=u.newText.length-u.replaceRange.length}if(!c)r.push(new Pi(s.replaceRange.delta(-o),s.newText));else{let u="",d=s.replaceRange.start-(c.replaceRange.start+a);d>0&&(u=c.newText.slice(0,d));let p=l.replaceRange.endExclusive+o-s.replaceRange.endExclusive;if(p>0){let h=new Pi(gt.ofStartAndLength(l.replaceRange.endExclusive,0),l.newText.slice(-p));t.unshift(h),o-=h.newText.length-h.replaceRange.length}let f=u+s.newText,m=new gt(Math.min(c.replaceRange.start,s.replaceRange.start-a),s.replaceRange.endExclusive-o);r.push(new Pi(m,f))}}for(;;){let s=t.shift();if(!s)break;r.push(s)}return new Rn(r).normalize()}var Sc=class{constructor(e){this._lines=pl(e),this._eol=e.charAt(this._lines[0].length)==="\r"?`\r
`:`
`;let t=new Uint32Array(this._lines.length);for(let r=0;r<this._lines.length;r++)t[r]=this._lines[r].length+this._eol.length;this._lineStarts=new F5(t)}_getText(){return this._lines.join(this._eol)}applyOffsetEdits(e){let{edits:t}=e;for(let r=t.length-1;r>=0;r--){let o=t[r],s=this.toRange(o.replaceRange);this._acceptDeleteRange(s),this._acceptInsertText(s.start,o.newText)}}_acceptDeleteRange(e){if(e.start.line===e.end.line){if(e.start.character===e.end.character)return;this._setLineText(e.start.line,this._lines[e.start.line].substring(0,e.start.character)+this._lines[e.start.line].substring(e.end.character));return}this._setLineText(e.start.line,this._lines[e.start.line].substring(0,e.start.character)+this._lines[e.end.line].substring(e.end.character)),this._lines.splice(e.start.line+1,e.end.line-e.start.line),this._lineStarts.removeValues(e.start.line+1,e.end.line-e.start.line)}_acceptInsertText(e,t){if(t.length===0)return;let r=pl(t);if(r.length===1){this._setLineText(e.line,this._lines[e.line].substring(0,e.character)+r[0]+this._lines[e.line].substring(e.character));return}r[r.length-1]+=this._lines[e.line].substring(e.character),this._setLineText(e.line,this._lines[e.line].substring(0,e.character)+r[0]);let o=new Uint32Array(r.length-1);for(let s=1;s<r.length;s++)this._lines.splice(e.line+1+s-1,0,r[s]),o[s-1]=r[s].length+this._eol.length;this._lineStarts.insertValues(e.line+1,o)}_setLineText(e,t){this._lines[e]=t,this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}getLineCount(){return this._lines.length}getOffset(e){return e=this.validatePosition(e),this._lineStarts.getPrefixSum(e.line-1)+e.character}getPosition(e){e=Math.floor(e),e=Math.max(0,e);let t=this._lineStarts.getIndexOf(e),r=this._lines[t.index].length;return new Sn(t.index,Math.min(t.remainder,r))}toRange(e){return new Me(this.getPosition(e.start),this.getPosition(e.endExclusive))}toOffsetRange(e){return new gt(this.getOffset(e.start),this.getOffset(e.end))}toOffsetEdit(e){let t=e.map(r=>new $r(this.validateRange(r.range),r.newText));return new Rn(t.map(r=>new Pi(this.toOffsetRange(r.range),r.newText)))}toTextEdits(e){return e.edits.map(t=>new $r(this.toRange(t.replaceRange),t.newText))}validatePosition(e){if(!(e instanceof Sn))throw new Error("Invalid argument");if(this._lines.length===0)return e.with(0,0);let{line:t,character:r}=e,o=!1;if(t<0)t=0,r=0,o=!0;else if(t>=this._lines.length)t=this._lines.length-1,r=this._lines[t].length,o=!0;else{let s=this._lines[t].length;r<0?(r=0,o=!0):r>s&&(r=s,o=!0)}return o?new Sn(t,r):e}validateRange(e){return new Me(this.validatePosition(e.start),this.validatePosition(e.end))}};var Bt=class n{constructor(e,t,r,o,s,a){this._transformer=null;this._lines=null;this.document=e,this.uri=t,this._text=r,this.languageId=o,this.eol=s,this.version=a}static create(e){return new n(e,e.uri,e.getText(),e.languageId,e.eol,e.version)}get transformer(){return this._transformer||(this._transformer=new Sc(this._text)),this._transformer}get fileName(){return this.uri.fsPath}get isUntitled(){return this.uri.scheme==="untitled"}get lineCount(){return this.lines.length}get lines(){return this._lines||(this._lines=this._text.split(/\r\n|\r|\n/g)),this._lines}lineAt(e){let t;if(e instanceof Sn)t=e.line;else if(typeof e=="number")t=e;else throw new Error("Invalid argument");return new SY(t,this.lines[t],t===this.lines.length-1)}offsetAt(e){return e=this.validatePosition(e),this.transformer.getOffset(e)}positionAt(e){return e=Math.floor(e),e=Math.max(0,e),this.transformer.getPosition(e)}getText(e){return e?this._getTextInRange(e):this._text}_getTextInRange(e){let t=this.validateRange(e);if(t.isEmpty)return"";let r=this.transformer.toOffsetRange(t);return this._text.substring(r.start,r.endExclusive)}getWordRangeAtPosition(e){let t=this.validatePosition(e),r=_Y(t.character+1,bY,this.lines[t.line],0);if(r)return new Me(t.line,r.startColumn-1,t.line,r.endColumn-1)}validateRange(e){let t=this.validatePosition(e.start),r=this.validatePosition(e.end);return t===e.start&&r===e.end?e:new Me(t.line,t.character,r.line,r.character)}validatePosition(e){if(this._text.length===0)return e.with(0,0);let{line:t,character:r}=e,o=!1;if(t<0)t=0,r=0,o=!0;else if(t>=this.lines.length)t=this.lines.length-1,r=this.lines[t].length,o=!0;else{let s=this.lines[t].length;r<0?(r=0,o=!0):r>s&&(r=s,o=!0)}return o?new Sn(t,r):e}},SY=class{constructor(e,t,r){this._line=e,this._text=t,this._isLastLine=r}get lineNumber(){return this._line}get text(){return this._text}get range(){return new Me(this._line,0,this._line,this._text.length)}get rangeIncludingLineBreak(){return this._isLastLine?this.range:new Me(this._line,0,this._line+1,0)}get firstNonWhitespaceCharacterIndex(){return/^(\s*)/.exec(this._text)[1].length}get isEmptyOrWhitespace(){return this.firstNonWhitespaceCharacterIndex===this._text.length}};var Be=re("IWorkspaceService"),U5=class{async openTextDocumentAndSnapshot(e){let t=await this.openTextDocument(e);return Bt.create(t)}getWorkspaceFolder(e){return this.getWorkspaceFolders().find(t=>t.scheme===e.scheme&&t.authority===e.authority&&e.fsPath.startsWith(t.fsPath))}};function wd(n,e){let t=n.getWorkspaceFolder(e);return t?qn.relative(t.path,e.path):e.path}var B5=re("IPromptWorkspaceLabels");var eT=class{constructor(e,t,r,o){this._experimentationService=e;this._configurationService=t;this._telemetryService=r;this._instantiationService=o;this.strategy=0;this.basicWorkspaceLabels=this._instantiationService.createInstance(tT),this.expandedWorkspaceLabels=this._instantiationService.createInstance(dD)}get workspaceLabels(){return this.strategy===0?this.basicWorkspaceLabels:this.expandedWorkspaceLabels}get labels(){return[...new Set(this.workspaceLabels.labels)].sort()}async collectContext(){let e=this._configurationService.getExperimentBasedConfig(le.ProjectLabelsExpanded,this._experimentationService);this.strategy=e?1:0,await this.workspaceLabels.collectContext();let t=[...new Set(this.labels)].sort();this._telemetryService.sendMSFTTelemetryEvent("projectLabels",{labels:t.join(",").replaceAll("@"," ")},{count:t.length})}};eT=E([v(0,fn),v(1,be),v(2,ge),v(3,H)],eT);var tT=class{constructor(e,t,r){this._workspaceService=e;this._fileSystemService=t;this._ignoreService=r;this.indicators=new Map;this.contentIndicators=new Map;this._labels=[];this.initIndicators()}get labels(){if(this._labels.includes("javascript")&&this._labels.includes("typescript")){let e=this._labels.indexOf("javascript");this._labels.splice(e,1)}return this._labels}async collectContext(){let e=this._workspaceService.getWorkspaceFolders();if(e)for(let t=0;t<e.length;t++)await this.addContextForFolders(e[t])}async addContextForFolders(e){for(let[t,r]of this.indicators.entries())await this.addLabelIfApplicable(e,t,r)}async addLabelIfApplicable(e,t,r){let o=zt.joinPath(e,t);if(!await this._ignoreService.isCopilotIgnored(o))try{await this._fileSystemService.stat(o),r.forEach(a=>this._labels.push(a));let s=this.contentIndicators.get(t);if(s){let a=await this._fileSystemService.readFile(o);try{s(new Gve.TextDecoder().decode(a)).forEach(l=>this._labels.push(l))}catch{}}}catch{}}initIndicators(){this.addIndicator("package.json","javascript","npm"),this.addIndicator("tsconfig.json","typescript"),this.addIndicator("pom.xml","java","maven"),this.addIndicator("build.gradle","java","gradle"),this.addIndicator("requirements.txt","python","pip"),this.addIndicator("Pipfile","python","pip"),this.addIndicator("Cargo.toml","rust","cargo"),this.addIndicator("go.mod","go","go.mod"),this.addIndicator("pubspec.yaml","dart","pub"),this.addIndicator("build.sbt","scala","sbt"),this.addIndicator("build.boot","clojure","boot"),this.addIndicator("project.clj","clojure","lein"),this.addIndicator("mix.exs","elixir","mix"),this.addIndicator("composer.json","php","composer"),this.addIndicator("Gemfile","ruby","bundler"),this.addIndicator("build.xml","java","ant"),this.addIndicator("build.gradle.kts","java","gradle"),this.addIndicator("yarn.lock","yarn"),this.addIndicator("CMakeLists.txt","c++","cmake"),this.addIndicator("vcpkg.json","c++"),this.addIndicator("Makefile","c++","makefile"),this.addContentIndicator("CMakeLists.txt",this.collectCMakeListsTxtIndicators),this.addContentIndicator("package.json",this.collectPackageJsonIndicators)}addIndicator(e,...t){this.indicators.set(e,t)}addContentIndicator(e,t){this.contentIndicators.set(e,t)}collectCMakeListsTxtIndicators(e){function t(a,c,l){try{let u=Array.from(a.matchAll(c));if(u&&u[0]&&u[0][1]){let d=parseInt(u[0][1]);if(l.includes(d))return d}}catch{}}let r=[],o=t(e,/set\s*\(\s*CMAKE_CXX_STANDARD\s*(\d+)/gmi,[98,11,14,17,20,23,26]);o&&r.push(`C++${o}`);let s=t(e,/set\s*\(\s*CMAKE_C_STANDARD\s*(\d+)/gmi,[90,99,11,17,23]);return s&&r.push(`C${s}`),r}collectPackageJsonIndicators(e){let t=[],r=JSON.parse(e),o=r.dependencies,s=r.devDependencies;o&&(o["@angular/core"]&&t.push("angular"),o.react&&t.push("react"),o.vue&&t.push("vue")),s&&s.typescript&&t.push("typescript");let a=r.engines;return a&&(a.node&&t.push("node"),a.vscode&&t.push("vscode extension")),t}};tT=E([v(0,Be),v(1,gn),v(2,Te)],tT);var dD=class extends tT{constructor(t,r,o){super(t,r,o);this.popularPackages=["numpy","pandas","scipy","scikit-learn","matplotlib","tensorflow","keras","torch","seaborn","plotly","dash","jupyter","notebook","ipython","openai","pyspark","airflow","nltk","sympy","spacy","langchain","Flask","Django","fastapi","pydantic","requests","beautifulsoup4","gunicorn","uvicorn","httpx","Jinja2","aiohttp","pytest","tox","nox","selenium","playwright","coverage","hypothesis","Sphinx","celery","asyncio","boto3","google-cloud-storage","azure-storage-blob","docker","kubernetes","azure","google","ansible","cryptography","paramiko","PyJWT","xlrd","xlrd-2024","openpyxl","pywin32","pywin","psycopg2","mysqlclient","SQLite4","Werkzeug","pymongo","redis","PyMySQL","Pillow","SQLAlchemy","lxml","html5lib","Markdown","pytz","Click","attrs","PyYAML","configparser","loguru","structlog","pygame","discord"];this.addContentIndicator("package.json",this.collectPackageJsonIndicatorsExpanded),this.addContentIndicator("requirements.txt",this.collectPythonRequirementsIndicators),this.addContentIndicator("pyproject.toml",this.collectPythonTomlIndicators)}collectPackageJsonIndicatorsExpanded(t){let r=[],o=d=>{let[p,f]=d.split(".");return`${p.replace(/[^0-9]/g,"")}.${f.replace(/[^0-9]/g,"")}`},s=(d,p)=>{d&&p.forEach(({dependency:f,prefix:m})=>{if(d[f]){let h=o(d[f]);r.push(`${m||f}@${h}`)}})},a;try{a=JSON.parse(t)}catch{return r}let c=[a.dependencies,a.devDependencies,a.peerDependencies,a.optionalDependencies],l=[{dependency:"react"},{dependency:"vue"},{dependency:"@angular/core"},{dependency:"svelte"},{dependency:"solid-js"},{dependency:"alpinejs"},{dependency:"redux"},{dependency:"mobx"},{dependency:"vuex"},{dependency:"ngrx"},{dependency:"antd"},{dependency:"bootstrap"},{dependency:"bulma"},{dependency:"@mui/material"},{dependency:"semantic-ui-react"},{dependency:"next"},{dependency:"gatsby"},{dependency:"remix"},{dependency:"astro"},{dependency:"sveltekit"},{dependency:"nuxt"},{dependency:"jest"},{dependency:"mocha"},{dependency:"cypress"},{dependency:"@testing-library/react"},{dependency:"@playwright/test"},{dependency:"vitest"},{dependency:"@storybook/react"},{dependency:"tailwindcss"},{dependency:"sass"},{dependency:"styled-components"},{dependency:"css-modules"},{dependency:"postcss"},{dependency:"@emotion/react"},{dependency:"vite"},{dependency:"webpack"},{dependency:"parcel"},{dependency:"rollup"},{dependency:"snowpack"},{dependency:"esbuild"},{dependency:"@swc/core"},{dependency:"socket.io"},{dependency:"d3"},{dependency:"graphql"},{dependency:"lodash"},{dependency:"moment"},{dependency:"rxjs"},{dependency:"underscore"},{dependency:"gulp"},{dependency:"backbone"},{dependency:"ember-source"},{dependency:"handlebars"},{dependency:"jquery"},{dependency:"knockout"},{dependency:"aws-sdk"},{dependency:"cloudinary"},{dependency:"firebase"},{dependency:"@azure/storage-blob"},{dependency:"@google-cloud/storage"},{dependency:"@aws-lambda"},{dependency:"@azure/functions"},{dependency:"@google-cloud/functions"},{dependency:"firebase-functions"},{dependency:"@azure/cosmos"},{dependency:"@google-cloud/firestore"},{dependency:"mongoose"},{dependency:"dockerode"},{dependency:"kubernetes-client"},{dependency:"@elastic/elasticsearch"},{dependency:"@sentry/node"},{dependency:"log4js"},{dependency:"winston"},{dependency:"bcrypt"},{dependency:"helmet"},{dependency:"jsonwebtoken"},{dependency:"passport"},{dependency:"@azure/identity"},{dependency:"@azure/keyvault-certificates"},{dependency:"@azure/keyvault-keys"},{dependency:"@azure/keyvault-secrets"},{dependency:"@azure/service-bus"},{dependency:"@azure/event-hubs"},{dependency:"@azure/data-tables"},{dependency:"@azure/monitor-query"},{dependency:"@azure/app-configuration"},{dependency:"babel"},{dependency:"eslint"},{dependency:"parcel"},{dependency:"prettier"},{dependency:"rollup"},{dependency:"typescript"},{dependency:"webpack"},{dependency:"vite"}],u=[{dependency:"node"},{dependency:"vscode",prefix:"vscode extension"}];return c.forEach(d=>s(d,l)),s(a.engines,u),r}collectPythonRequirementsIndicators(t){let r=[];return t.split(`
`).forEach(s=>{let[a,c]=s.split("==");this.popularPackages.includes(a)&&r.push(`${a}-${c||"latest"}`)}),r}collectPythonTomlIndicators(t){let r=[],o=t.split(`
`),s=!1;return o.forEach(a=>{if(a=a.trim(),a==="[tool.poetry.dependencies]")s=!0;else if(a.startsWith("[")&&a.endsWith("]"))s=!1;else if(s&&a){let[c,l]=a.split("=").map(u=>u.trim().replace(/"|'/g,""));this.popularPackages.includes(c)&&r.push(`${c}-${l||"latest"}`)}}),r}};dD=E([v(0,Be),v(1,gn),v(2,Te)],dD);var zve=q(Ve()),Do=class extends zve.PromptElement{render(){return vscpp(vscppf,null,this.props.children)}};var Xi=class extends q5.PromptElement{constructor(t,r){super(t);this.workspaceLabels=r}async render(t,r){await this.workspaceLabels.collectContext();let o=this.workspaceLabels.labels;if(o.length!==0)return this.props.embeddedInsideUserMessage?vscpp(Do,{priority:this.props.priority},"<projectLabels>",this._render(o),"</projectLabels>"):vscpp(q5.UserMessage,{priority:this.props.priority},this._render(o))}_render(t){return vscpp(vscppf,null,"I am working on a project of the following nature:",vscpp("br",null),t.reduce((r,o)=>`${r}
- ${o}`,"").trim())}};Xi=E([v(1,B5)],Xi);var pD=class{constructor(e){this._instantiationService=e;this.kind="project-labels"}async resolveContext(e){let{messages:t}=await Qi(this._instantiationService,e.endpoint,Xi,{});if(t.length>0)return{kind:this.kind,userMessages:t.map(r=>r.content)}}};pD=E([v(0,H)],pD);zr.register(new fe(pD));var ln=q(require("vscode"));var j5=re("IChatAgentService"),$ve="default",fD="editor",Wve="workspace",Kve="vscode",nT="terminal",Yve="editingSession",IY="github.copilot.";function Bv(n){return`${IY}${n}`}function Qve(n){return n.replace(/^github\.copilot\./,"")}var va=re("ConversationOptions");var H5=re("IDevContainerConfigurationService");function mD(n){return n.capabilities.type==="chat"}function Xve(n){return n.capabilities.type==="embeddings"}var _e=re("IEndpointProvider");var ah=re("IWorkbenchService");var _s=re("IEmbeddingsComputer");function TY(n,e,t,r,o=0){return t.map(([s,a])=>{let c=0;for(let l=0;l<a.length;l++)c+=a[l]*e[l];return{score:c,item:s}}).filter(s=>s.score>o).sort((s,a)=>a.score-s.score).slice(0,r).map(s=>s.item)}function qv(n,e){let t=n.reduce((s,a,c)=>s+a*e[c],0),r=Math.sqrt(n.reduce((s,a)=>s+a*a,0)),o=Math.sqrt(e.reduce((s,a)=>s+a*a,0));return t/(r*o)}var qt=re("IVSCodeExtensionContext");function t$e(n){switch(n.model){case"text-embedding-3-small":return"text-3-small";default:return"text-ada-002"}}var rT=class{constructor(e,t,r,o,s){this.cacheType=e;this.cacheKey=t;this.cacheVersion=r;this.fileSystemService=o;this.extensionContext=s;this.cacheVersionKey=`${t}-version`}get cacheStorageUri(){return this.cacheType===2?this.extensionContext.storageUri:this.extensionContext.globalStorageUri}get cacheVersionMementoStorage(){return this.cacheType===2?this.extensionContext.workspaceState:this.extensionContext.globalState}async updateCache(e){if(!this.cacheStorageUri||e===void 0||!this.fileSystemService.isWritableFileSystem(this.cacheStorageUri.scheme))return;try{await this.fileSystemService.stat(this.cacheStorageUri)}catch(r){r.code==="ENOENT"&&await this.fileSystemService.createDirectory(this.cacheStorageUri)}await this.cacheVersionMementoStorage.update(this.cacheVersionKey,this.cacheVersion);let t=$e.joinPath(this.cacheStorageUri,`${this.cacheKey}.json`);try{await this.fileSystemService.writeFile(t,Buffer.from(JSON.stringify(e)))}catch{e!==void 0&&console.error(`Failed to write embeddings cache to ${t}`)}}async getCache(){if(!(!this.cacheStorageUri||this.cacheVersionMementoStorage.get(this.cacheVersionKey)!==this.cacheVersion))try{let t=await Hve.readJSON(this.fileSystemService,$e.joinPath(this.cacheStorageUri,`${this.cacheKey}.json`));return this.isEmbeddingCacheEntriesType(t)?this.constructExposedCache(t):t}catch{return}}async clearCache(){if(!this.cacheStorageUri)return;this.cacheVersionMementoStorage.get(this.cacheKey)&&await this.cacheVersionMementoStorage.update(this.cacheKey,void 0);let t=$e.joinPath(this.cacheStorageUri,`${this.cacheKey}.json`);try{await this.fileSystemService.stat(this.cacheStorageUri),await this.fileSystemService.delete(t,{useTrash:!1})}catch(r){if(r.code==="ENOENT")throw new Error(`Cache file ${t} does not exist`)}}isEmbeddingCacheEntriesType(e){return e.core!==void 0&&e.extensions!==void 0}constructExposedCache(e){let t={...e.core};for(let r in e.extensions){let o=e.extensions[r];for(let s in o)t[s]=o[s]}return t}};rT=E([v(3,gn),v(4,qt)],rT);var kd=class{constructor(e,t,r,o){this.cacheKey=t;this.cacheVersion=r;this._embeddingsCache=o.createInstance(rT,e,t,r)}async getCache(){let e=await this._embeddingsCache.getCache();if(e===void 0)throw new Error(`Failed to get cache for ${this.cacheKey}, version ${this.cacheVersion}`);return e}clearCache(){return this._embeddingsCache.clearCache()}};kd=E([v(3,H)],kd);var nu=class{constructor(e,t,r,o,s,a,c){this.cacheVersion=r;this.remoteCacheType=o;this.endpointProvider=s;this.fetcherService=a;this.embeddingsCache=c.createInstance(rT,e,t,r),this.remoteCacheVersionKey=`${t}-version-remote`}async clearCache(){await this.embeddingsCache.clearCache()}async getRemoteContainer(){let e=await this.endpointProvider.getEmbeddingsEndpoint("text3small");return t$e(e)}async getRemoteCacheURL(){if(!this._remoteCacheURL){let e=await this.getRemoteContainer();this._remoteCacheURL=nu.calculateRemoteCDNURL(e,this.remoteCacheType,this.cacheVersion)}return this._remoteCacheURL}async getRemoteCacheLatestUpdateURL(){if(!this._remoteCacheLatestUpdateURL){let e=await this.getRemoteContainer();this._remoteCacheLatestUpdateURL=nu.calculateRemoteCDNLatestURL(e,this.remoteCacheType,this.cacheVersion)}return this._remoteCacheLatestUpdateURL}async fetchRemoteCache(){if(this._remoteCacheEntries)return this._remoteCacheEntries;let e=await this.getRemoteCacheURL();try{let t=await this.getRemoteCacheURL(),r=await this.fetcherService.fetch(t,{method:"GET"});if(r.ok)return this._remoteCacheEntries=await r.json(),this._remoteCacheEntries;console.error(`Failed to fetch remote embeddings cache from ${t}`),console.error(`Response status: ${r.status}, status text: ${r.statusText}`);return}catch(t){console.error(`Failed to fetch remote embeddings cache from ${e}`),console.error(t);return}}async fetchRemoteCacheLatest(){let e=await this.getRemoteCacheLatestUpdateURL();try{let t=await this.fetcherService.fetch(e,{method:"GET"});if(t.ok)return t.text();console.error(`Failed to fetch remote embeddings cache from ${e}`),console.error(`Response status: ${t.status}, status text: ${t.statusText}`);return}catch(t){console.error(`Failed to fetch remote embeddings cache from ${e}`),console.error(t);return}}async getCache(){let e=await this.fetchRemoteCacheLatest(),t=await this.embeddingsCache.getCache();if(t&&e===this.embeddingsCache.cacheVersionMementoStorage.get(this.remoteCacheVersionKey))return t;let r=await this.fetchRemoteCache();return r===void 0?t:(await this.embeddingsCache.clearCache(),await this.embeddingsCache.cacheVersionMementoStorage.update(this.remoteCacheVersionKey,e),await this.embeddingsCache.updateCache(r),r)}static calculateRemoteCDNURL(e,t,r){return`https://embeddings.vscode-cdn.net/${e}/v${r}/${t}/core.json`}static calculateRemoteCDNLatestURL(e,t,r){return`https://embeddings.vscode-cdn.net/${e}/v${r}/${t}/latest.txt`}};nu=E([v(4,_e),v(5,hn),v(6,H)],nu);var Rd=class extends nu{constructor(t,r,o,s,a,c,l,u){super(t,r,o,s,a,c,u);this.workbenchService=l}async getBaseExtensionCDNURL(){if(!this._baseExtensionCDNURL){let t=await this.getRemoteContainer();this._baseExtensionCDNURL=Rd.calculateBaseRemoteExtensionCDNURL(t,this.remoteCacheType,this.cacheVersion)}return this._baseExtensionCDNURL}constructExposedCache(){if(!this._remoteExtensionCache)return;let t={...this._remoteExtensionCache.core};for(let r in this._remoteExtensionCache.extensions){let o=this._remoteExtensionCache.extensions[r];for(let s in o)t[s]=o[s]}return t}async fetchRemoteExtensionCache(t){let o=`${await this.getBaseExtensionCDNURL()}/${t}.json`;try{let s=await this.fetcherService.fetch(o,{method:"GET"});if(s.ok)return await s.json();if(s.status===404)return{};console.error(`Failed to fetch remote embeddings cache from ${o}`),console.error(`Response status: ${s.status}, status text: ${s.statusText}`);return}catch(s){console.error(`Failed to fetch remote embeddings cache from ${o}`),console.error(s);return}}async getCache(){let t=await super.getCache();if(t===void 0)return;let r={core:{},extensions:{}};t&&Rd.isEmbeddingsCacheEntriesWithExtensions(t)?r=t:r={core:t,extensions:{}};let o=Rd.getInstalledExtensionIds(this.workbenchService),s=!1;for(let c in r.extensions)o.includes(c)||(delete r.extensions[c],s=!0);let a=o.filter(c=>!(c in r.extensions)||r.extensions[c]===void 0);for(let c of a){let l=await this.fetchRemoteExtensionCache(c);l&&(r.extensions[c]=l)}return this._remoteExtensionCache=r,(a.length>0||s)&&(await this.embeddingsCache.clearCache(),await this.embeddingsCache.updateCache(r)),this.constructExposedCache()}static isEmbeddingsCacheEntriesWithExtensions(t){return"core"in t&&"extensions"in t}static getInstalledExtensionIds(t){return t.getAllExtensions().filter(r=>!r.id.startsWith("vscode")).map(r=>r.id)}static calculateBaseRemoteExtensionCDNURL(t,r,o){return`https://embeddings.vscode-cdn.net/${t}/v${o}/${r}`}};Rd=E([v(4,_e),v(5,hn),v(6,ah),v(7,H)],Rd);var V5=class{constructor(e,t,r,o,s){this.cacheKey=t;this._embeddingsCache=r;this.embeddingsComputer=o;this.logService=s;this._isIndexLoaded=!1;this._items=new Map}get isIndexLoaded(){return this._isIndexLoaded}set isIndexLoaded(e){this._isIndexLoaded=e}async rebuildCache(){return await this._embeddingsCache.clearCache(),this._items.clear(),this.calculateEmbeddings()}nClosestValues(e,t){let r=Array.from(this._items.values()).map(o=>{if(!o.embedding)return{item:o,similarity:0};let s=qv(e,o.embedding);return{item:o,similarity:s}});return r=r.filter(o=>o.similarity>0),r.sort((o,s)=>s.similarity-o.similarity),r.slice(0,t).map(o=>o.item)}hasItem(e){return this._items.has(e)}getItem(e){return this._items.get(e)}async calculateEmbeddings(){return this._calculationPromise?this._calculationPromise:(this._calculationPromise=this._calculateEmbeddings(),this._calculationPromise.then(()=>this._calculationPromise=void 0))}async _calculateEmbeddings(){let e=Date.now(),t=await this.getLatestItems(),r=await this._embeddingsCache.getCache(),o=new Map;for(let s of t){let a=s,c=this._items.get(s.key),l=s.key;c?.embedding?a=c:r&&r[l]&&(a={...s,...r[l]}),o.set(l,a)}this._items=o,this.logService.internal.debug(`Embeddings for ${this.cacheKey} calculated in ${Date.now()-e}ms`),this.isIndexLoaded=!0}};function ch(n){let e=n.split(".");return`${e[0]}.${e[1]}`}function CY(n){let e=`Setting Id: ${n.key}
`;if(e+=`Type: ${n.type}
`,e+=`Description: ${n.description??n.markdownDescription??""}
`,n.enum){e+=`Possible values:
`;for(let t=0;t<n.enum.length;t++)e+=` - ${n.enum[t]} - ${n.enumDescriptions?.[t]??""}
`}return e+=`
`,e}var G5=class extends V5{constructor(t,r,o,s,a,c,l,u){super(t,r,s,o,l);this._endpointProvider=a;this.relatedInformationConfig=c;this._logService=l;this.telemetryService=u;this.isIndexLoaded=!1}async provideRelatedInformation(t,r){let o=Date.now();if(!this.isIndexLoaded)return this.calculateEmbeddings(),this._logService.internal.debug(`Related Information: Index not loaded yet triggering background calculation, returning ${Date.now()-o}ms`),[];if(r.isCancellationRequested)return this._logService.internal.debug(`Related Information: Request cancelled, returning ${Date.now()-o}ms`),[];let s=Date.now(),a=await this._endpointProvider.getEmbeddingsEndpoint("text3small"),c=await this.embeddingsComputer.computeEmbeddings(a,[t],{dimensions:512},r);if(this._logService.internal.debug(`Related Information: Remote similarly request took ${Date.now()-s}ms`),r.isCancellationRequested||!c||!c.embeddings[0])return this._logService.internal.debug(`Related Information: Request cancelled or no embeddings computed, returning ${Date.now()-o}ms`),[];let l=[];for(let d of this._items.values()){if(r.isCancellationRequested){this._logService.internal.debug(`Related Information: Request cancelled, returning ${Date.now()-o}ms`);break}if(d.embedding){let p=qv(c.embeddings[0],d.embedding);p>this.relatedInformationConfig.threshold&&l.push(this.toRelatedInformation(d,p))}}return this.logService.internal.debug(`Related Information: Successfully Calculated, returning ${Date.now()-o}ms`),this.relatedInformationConfig.type===4&&this.telemetryService.sendInternalMSFTTelemetryEvent("relatedInformationSettings",{query:t}),l.sort((d,p)=>p.weight-d.weight).slice(0,this.relatedInformationConfig.maxResults)}},hD=class extends G5{constructor(t,r,o,s,a,c){super("CommandIdIndex","commandEmbeddings",r,t,o,{type:2,threshold:0,maxResults:100},s,a);this.workbenchService=c}async getLatestItems(){let t=await this.workbenchService.getAllCommands();return t.push({label:"Extensions: Search the marketplace for extensions",command:"workbench.extensions.search",keybinding:"Not set"}),t.push({label:"Extensions: Install extension from marketplace",command:"workbench.extensions.installExtension",keybinding:"Not set"}),t.map(r=>({key:r.command,label:r.label.replace("View: Toggle","View: Toggle or Show or Hide"),originalLabel:r.label,keybinding:r.keybinding??"Not set"}))}getEmbeddingQueryString(t){return`${t.label} - ${t.key}`}toRelatedInformation(t,r){return{type:2,weight:r,command:t.key}}};hD=E([v(1,_s),v(2,_e),v(3,oe),v(4,ge),v(5,ah)],hD);var gD=class extends G5{constructor(t,r,o,s,a,c){super("SettingsIndex","settingEmbeddings",r,t,o,{type:4,threshold:0,maxResults:100},s,a);this.workbenchService=c}async getLatestItems(){let t=await this.workbenchService.getAllSettings(),r=[];for(let o of Object.keys(t)){let s=t[o];s.deprecationMessage||s.markdownDeprecationMessage||r.push({...s,key:o})}return r}getEmbeddingQueryString(t){return CY(t)}toRelatedInformation(t,r){return{type:4,weight:r,setting:t.key}}};gD=E([v(1,_s),v(2,_e),v(3,oe),v(4,ge),v(5,ah)],gD);var Pd=re("ICombinedEmbeddingIndex"),iT=class{constructor(e=!0,t,r){let o=e?t.createInstance(Rd,1,"settingEmbeddings",ch(r.getEditorInfo().version),"settings"):t.createInstance(kd,1,"settingEmbeddings",ch(r.getEditorInfo().version)),s=e?t.createInstance(Rd,1,"commandEmbeddings",ch(r.getEditorInfo().version),"commands"):t.createInstance(kd,1,"commandEmbeddings",ch(r.getEditorInfo().version));this.settingsIndex=t.createInstance(gD,o),this.commandIdIndex=t.createInstance(hD,s)}async loadIndexes(){await Promise.all([this.commandIdIndex.isIndexLoaded?Promise.resolve():this.commandIdIndex.calculateEmbeddings(),this.settingsIndex.isIndexLoaded?Promise.resolve():this.settingsIndex.calculateEmbeddings()])}async nClosestValues(e,t){return await this.loadIndexes(),{commands:this.commandIdIndex.nClosestValues(e,t),settings:this.settingsIndex.nClosestValues(e,t)}}hasSetting(e){return this.settingsIndex.hasItem(e)}hasCommand(e){return this.commandIdIndex.hasItem(e)}getSetting(e){return this.settingsIndex.getItem(e)}getCommand(e){return this.commandIdIndex.getItem(e)}};iT=E([v(1,H),v(2,it)],iT);var z5=re("IGitCommitMessageService");var x_e=q(require("path")),Ct=q(require("vscode"));var Ji=re("IGitExtensionService");var ft=re("IParserService");function $5(n){return{startPosition:{row:n.start.line,column:n.start.character},endPosition:{row:n.end.line,column:n.end.character}}}function W5(n){return new Me(n.startPosition.row,n.startPosition.column,n.endPosition.row,n.endPosition.column)}function No(n,e){return{startIndex:e.offsetAt(n.start),endIndex:e.offsetAt(n.end)}}function Gs(n,e){return new Me(n.positionAt(e.startIndex),n.positionAt(e.endIndex))}var ya=re("IReviewService");var $t=re("ITabsAndEditorsService");var Ad=class n{constructor(e){this._push=e}static spy(e,t){return new n(r=>{t(r),e.push(r)})}markdown(e){this._push(new ki(e))}anchor(e,t){this._push(new Z1(e,t))}button(e){this._push(new ex(e))}filetree(e,t){this._push(new Td(e,t))}progress(e,t){typeof t>"u"?this._push(new Ri(e)):this._push(new Rve(e,t))}reference(e,t){this._push(new k5(e,t))}reference2(e,t,r){this._push(new R5(e,t,r))}codeCitation(e,t,r){this._push(new Pve(e,t,r))}push(e){this._push(e)}textEdit(e,t){this._push(new _c(e,t))}markdownWithVulnerabilities(e,t){this._push(new Ave(e,t))}codeblockUri(e){try{this._push(new Dve(e))}catch{}}detectedParticipant(e,t){this._push(new Nve(e,t))}confirmation(e,t,r,o){this._push(new tx(e,t,r,o))}warning(e){this._push(new P5(e))}};var EY="github.copilot-dynamic.platform",oT={workspace:{explain:"explain",edit:"edit",review:"review",tests:"tests",fix:"fix",new:"new",newNotebook:"newNotebook",semanticSearch:"semanticSearch",fixTestFailure:"fixTestFailure",setupTests:"setupTests"},vscode:{search:"search",runCommand:"runCommand",startDebugging:"startDebugging"},terminal:{explain:"terminalExplain"},editor:{doc:"doc",fix:"fix",explain:"explain",review:"review",tests:"tests",fixTestFailure:"fixTestFailure"}};function K5(n){if(Object.keys(oT).includes(n))return{agent:n};for(let[e,t]of Object.entries(oT))if(Object.values(t).includes(n))return{agent:e,command:n}}var lh="GitHub.copilot-chat";var uye=q(require("path"));var De=class n{constructor(e,t,r,o){e>r||e===r&&t>o?(this.startLineNumber=r,this.startColumn=o,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=r,this.endColumn=o)}isEmpty(){return n.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return n.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<e.startColumn||t.lineNumber===e.endLineNumber&&t.column>e.endColumn)}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<=e.startColumn||t.lineNumber===e.endLineNumber&&t.column>=e.endColumn)}containsRange(e){return n.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)}strictContainsRange(e){return n.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)}plusRange(e){return n.plusRange(this,e)}static plusRange(e,t){let r,o,s,a;return t.startLineNumber<e.startLineNumber?(r=t.startLineNumber,o=t.startColumn):t.startLineNumber===e.startLineNumber?(r=t.startLineNumber,o=Math.min(t.startColumn,e.startColumn)):(r=e.startLineNumber,o=e.startColumn),t.endLineNumber>e.endLineNumber?(s=t.endLineNumber,a=t.endColumn):t.endLineNumber===e.endLineNumber?(s=t.endLineNumber,a=Math.max(t.endColumn,e.endColumn)):(s=e.endLineNumber,a=e.endColumn),new n(r,o,s,a)}intersectRanges(e){return n.intersectRanges(this,e)}static intersectRanges(e,t){let r=e.startLineNumber,o=e.startColumn,s=e.endLineNumber,a=e.endColumn,c=t.startLineNumber,l=t.startColumn,u=t.endLineNumber,d=t.endColumn;return r<c?(r=c,o=l):r===c&&(o=Math.max(o,l)),s>u?(s=u,a=d):s===u&&(a=Math.min(a,d)),r>s||r===s&&o>a?null:new n(r,o,s,a)}equalsRange(e){return n.equalsRange(this,e)}static equalsRange(e,t){return!e&&!t?!0:!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return n.getEndPosition(this)}static getEndPosition(e){return new Dt(e.endLineNumber,e.endColumn)}getStartPosition(){return n.getStartPosition(this)}static getStartPosition(e){return new Dt(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new n(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new n(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return n.collapseToStart(this)}static collapseToStart(e){return new n(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return n.collapseToEnd(this)}static collapseToEnd(e){return new n(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new n(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}static fromPositions(e,t=e){return new n(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new n(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,t){if(e&&t){let s=e.startLineNumber|0,a=t.startLineNumber|0;if(s===a){let c=e.startColumn|0,l=t.startColumn|0;if(c===l){let u=e.endLineNumber|0,d=t.endLineNumber|0;if(u===d){let p=e.endColumn|0,f=t.endColumn|0;return p-f}return u-d}return c-l}return s-a}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}};function yl(n,e,t){if(n===0)return{text:e,range:t};let r=typeof n=="number"?{0:e.slice(0,n),index:n}:e.match(n);if(!r)return{text:e,range:t};let o=r[0],s=A1(o,`
`);return{text:e.slice(o.length),range:{startLineNumber:t.startLineNumber+s,startColumn:s>0?o.length-(o.lastIndexOf(`
`)+1):t.startColumn+o.length,endColumn:t.endColumn,endLineNumber:t.endLineNumber}}}function ru(n,e,t){if(n===0)return{text:e,range:t};let r=typeof n=="number"?{0:e.slice(-n),index:e.length-n}:e.match(n);if(!r)return{text:e,range:t};let o=r[0],s=A1(o,`
`),a=t.endLineNumber-s;return{text:e.slice(0,r.index),range:{startColumn:t.startColumn,startLineNumber:t.startLineNumber,endLineNumber:a,endColumn:s>0?(a===t.startLineNumber?t.startColumn:0)+r.index-(e.lastIndexOf(`
`,r.index-1)+1):Math.max(0,t.endColumn-o.length)}}}function t0e(n){let e=n.lastIndexOf(`
`);return e===-1?{lineNumber:0,column:n.length}:{lineNumber:A1(n.slice(0,e),`
`)+1,column:n.length-(e+1)}}function n0e(n,e,t,r){let o=t?n$e(t,n,e):{text:n,range:e};return r?r$e(r,o.text,o.range):o}function n$e(n,e,t){let r=De.lift(t),o=Dt.lift(n);if(o.equals(r.getStartPosition()))return{text:e,range:t};if(o.isBefore(r.getStartPosition()))return{text:e,range:t};let s=0;if(o.lineNumber===r.getStartPosition().lineNumber)s=o.column-r.getStartPosition().column;else{let a=e.split(`
`);for(let[c,l]of a.entries())if(r.getStartPosition().lineNumber+c===o.lineNumber){s+=o.column;break}else s+=l.length+1}return{text:e.substring(s),range:{startLineNumber:o.lineNumber,startColumn:o.column,endColumn:t.endColumn,endLineNumber:t.endLineNumber}}}function r$e(n,e,t){let r=De.lift(t),o=Dt.lift(n);if(o.equals(r.getEndPosition()))return{text:e,range:t};if(r.getEndPosition().isBefore(o))return{text:e,range:t};let s="";if(o.lineNumber===r.getStartPosition().lineNumber)s=e.substring(0,o.column-r.getStartPosition().column);else{let a=e.split(`
`),c=[];for(let[l,u]of a.entries())if(r.getStartPosition().lineNumber+l===o.lineNumber){c.push(u.substring(0,o.column));break}else c.push(u+`
`);s=c.join("")}return{text:s,range:{startLineNumber:t.startLineNumber,startColumn:t.startColumn,endColumn:o.column,endLineNumber:o.lineNumber}}}function jv(n,e=0,t=0){let r=n.row+e,o=n.column+t;return{lineNumber:r<0?0:r,column:o<0?0:o}}function Lo(n){return{startLineNumber:n.range.startPosition.row,startColumn:n.range.startPosition.column,endLineNumber:n.range.endPosition.row,endColumn:n.range.endPosition.column}}var rx=/\s+$/;function r0e(n){return n.replace(rx,"")}function iu(n,e){return{startLineNumber:n.lineNumber,startColumn:n.column,endLineNumber:e.lineNumber,endColumn:e.column}}function i0e(n,e,t){if(n===0)return{text:e,sources:t};let r=typeof n=="number"?{0:e.slice(-n),index:e.length-n}:e.match(n);if(!r)return{text:e,sources:t};let o=r.index;return{text:e.slice(0,o),sources:t.filter(s=>s.start<o).map(s=>({start:s.start,end:Math.min(s.end,o),range:ru(Math.max(0,s.end-o),e.slice(0,s.end),s.range).range}))}}var Y5=class{constructor(e,t){this.tokenizer=t.acquireTokenizer(e)}canSpiralChunk(e,t,r,o){let s=Math.max(e.startLineNumber-t,0),a=e.endLineNumber-t;if(r.length<s)return!1;let c=r.slice(s,a);return this.tokenizer.tokenLength(c.map(u=>u.text).join(`
`))<=o}processLinesIntoChunkUsingSprial(e,t,r,o,s,a,c=0,l=!1,u){let d=o-c-(l?0:c),p=0,f=e.split(`
`),m=[];for(let B=0;B<f.length;B++){let U=f[B],W=p;if(p+=U.length+1,a&&U.length===0)continue;let ae=U.slice(0,o*4);m.push({text:ae,lineNumber:B+t,originalStart:W,originalEnd:W+ae.length,tokens:this.tokenizer.tokenLength(ae)})}if(u&&u.endLineNumber<t)return;let h=u?Math.max(u.startLineNumber-t,0):0,g=Math.min(u?u.endLineNumber+1-t:m.length,m.length),y=this.tokenizer.tokenLength(m.map(B=>B.text).slice(h,g).join(`
`)),b=()=>{if(h<=0)return;let B=m[h-1];return{index:h-1,line:B,isBefore:!0}},_=()=>{if(g>=m.length-1)return;let B=m[g+1];return{index:g+1,line:B,isBefore:!1}},x=!0,I=()=>{let B;if(x){if(B=b(),!B)return _()}else if(B=_(),!B)return b();return g===m.length?x=!0:h<=0?x=!1:x=!x,B},S=I();if(S&&S.line.tokens+y<d)for(h=S.isBefore?S.index:h,g=S.isBefore?g:S.index,S=I();S;){let B=S.isBefore?S.index:h,U=S.isBefore?g:S.index,W=m.map(Y=>Y.text).slice(B,U).join(`
`);if(this.tokenizer.tokenLength(W)>d)break;h=B,g=U,S=I()}let w=m.slice(h,g),R=w[w.length-1];if(w.length===0)return;for(;w.length;){let B=w[w.length-1],U=B.text.trimEnd();if(U==="")w.pop();else if(U!==B.text){B.text=U,B.originalEnd=U.length;break}else break}if(w.length===0)return;let k=[];r.sort((B,U)=>B.start-U.start);let V=0,F=0,K=0,$=w[0]?.originalStart||0,j=(B,U)=>{if(F===B){F=U;return}for(;V<r.length&&r[V].start<F;){let W=r[V++];if(W.end<$)continue;let ae=Math.max(0,W.end-F),Y=Math.max(0,$-W.start),X=ru(ae,e.slice(W.start,W.end),W.range),Se=yl(Y,X.text,X.range);k.push({start:W.start+Y-K,end:W.end-ae-K,range:Se.range})}F=U,$=B},D="";for(let B=0;B<w.length;B++){let U=w[B];j(U.originalStart,U.originalEnd),D+=U.text,K=U.originalEnd-D.length,B<w.length-1&&(D+=`
`,e[U.originalEnd]===`
`&&j(U.originalEnd,U.originalEnd+1))}return j(1/0,1/0),{text:D,range:{startLineNumber:w[0].lineNumber,startColumn:0,endLineNumber:R.lineNumber,endColumn:R.text.length},sources:k}}};var i$e=!1,yD=(n,e)=>{let t=Lo(n);return{sources:[{start:0,end:n.text.length,range:t}],text:n.text,range:t}},Gp=class{constructor(e,t){this.tokenizer=t.acquireTokenizer(e),this.spiralChunker=i$e?new Y5(e,t):void 0}genericWholeFileChunking(e,{maxTokenLength:t=sT,removeEmptyLines:r=!0,rangeLimit:o=void 0,rangeLimitStrategy:s=void 0}){e=e.replace(/\r\n/g,`
`);let a=e,c=t0e(e),l={startLineNumber:0,startColumn:0,endLineNumber:c.lineNumber,endColumn:c.column};if(o&&s!==1){let d=_D(De.lift(o),e,De.lift(l));a=d.newTextRange.text,l=d.newTextRange.range}let u=this._processLinesIntoChunks(a,l.startLineNumber,[{start:l.startLineNumber,end:e.length,range:l}],t,!0,r);return o&&s===1&&o0e(u,De.lift(o)),u.filter(d=>!r||d.text.length&&/[\w\d]{2}/.test(d.text))}genericChunking({lineRangeText:e,maxTokenLength:t=sT,removeEmptyLines:r=!0,extraLineRangeSeparator:o="",numTokensInEllipsis:s=0,removeChunksOutsideOfRange:a=void 0}){if(t<0)throw Error("Cannot chunk text, not enough chunk room");if(e.length===0)return[];let c=this.tokenizer.tokenLength(o),l=[],u,d=!1;for(let p=0;p<e.length;p++){let f=e[p];if(u){let h=t-this.tokenizer.tokenLength(u.text)-c;if(h>0&&f.text.length<2e4&&this.tokenizer.tokenLength(f.text)<=h){let g=o||(d?`
`:""),y=u.text.length+g.length,b=u.text+g+f.text,_={startLineNumber:u.range.startLineNumber,startColumn:u.range.startColumn,endColumn:f.range.endColumn,endLineNumber:f.range.endLineNumber},x=f.sources.map(I=>({start:I.start+y,end:I.end+y,range:I.range}));for(let I of u.sources)x.push(I);d=!1,u={sources:x,text:b,range:_};continue}(!a||De.lift(a).intersectRanges(u.range))&&l.push(u),u=void 0}if(a&&a.endLineNumber<f.range.startLineNumber)break;let m=this._processLinesIntoChunks(f.text,f.range.startLineNumber,f.sources,t,!1,r,s,p===0,a?De.areIntersecting(a,f.range):void 0,a);u=m.pop(),d=!0,a&&o0e(m,a),l.push(...m)}return u&&(!a||De.lift(a).intersectRanges(u.range))&&l.push(u),l.filter(p=>!r||p.text.length&&/[^\s]/.test(p.text)).map(p=>{let{text:f,sources:m}=i0e(rx,p.text,p.sources);return{range:p.range,text:f,sources:m}})}_processLinesIntoChunks(e,t,r,o,s,a,c=0,l=!1,u=!1,d){let p=0,f=0,m=e.split(`
`),h=[];for(let y=0;y<m.length;y++){let b=m[y],_=f;if(f+=b.length+1,a&&b.length===0)continue;let x=b.slice(0,o*4);h.push({text:x,lineNumber:y+t,originalStart:_,originalEnd:_+x.length,tokens:this.tokenizer.tokenLength(x)})}let g=[];if(this.spiralChunker&&u&&d&&this.spiralChunker.canSpiralChunk(d,t,h,o)){let y=this.spiralChunker.processLinesIntoChunkUsingSprial(e,t,r,o,s,a,c,l,d);if(y)return g.push(y),g}for(;p<h.length;){let y=o-c-(l?0:c),b=p+1,_="";for(let j=h[p].tokens;b<h.length;b++){let D=j+h[b].tokens;if(D>y){_=h.slice(p,b+1).map(B=>B.text).join(`
`);let A=this.tokenizer.tokenLength(_);for(;A<=y&&b<h.length-1;)b++,_+=`
`+h[b].text,A=this.tokenizer.tokenLength(_);break}j=D}let x=h.slice(p,b),I=b;if(s){let{chunks:j,usedFromRemaining:D}=this._dedentAndAddLinesToChunk(x,h.slice(b),y);x=j,p=I+D}else for(p=I;p<h.length&&h[p].text.length===0;)p++;if(x.length===0)continue;for(;x.length;){let j=x[x.length-1],D=j.text.trimEnd();if(D==="")x.pop();else if(D!==j.text){j.text=D,j.originalEnd=D.length;break}else break}if(x.length===0)continue;let S=[];r.sort((j,D)=>j.start-D.start);let w=0,R=0,k=0,V=x[0]?.originalStart||0,F=(j,D)=>{if(R===j){R=D;return}for(;w<r.length&&r[w].start<R;){let A=r[w++];if(A.end<V)continue;let B=Math.max(0,A.end-R),U=Math.max(0,V-A.start),W=ru(B,e.slice(A.start,A.end),A.range),ae=yl(U,W.text,W.range);S.push({start:A.start+U-k,end:A.end-B-k,range:ae.range})}R=D,V=j},K="";for(let j=0;j<x.length;j++){let D=x[j];F(D.originalStart,D.originalEnd),K+=D.text,k=D.originalEnd-K.length,j<x.length-1&&(K+=`
`,e[D.originalEnd]===`
`&&F(D.originalEnd,D.originalEnd+1))}F(1/0,1/0);let $=x[x.length-1];g.push({text:K,range:{startLineNumber:x[0].lineNumber,startColumn:0,endLineNumber:$.lineNumber,endColumn:$.text.length},sources:S})}return g}_dedentAndAddLinesToChunk(e,t,r){let o=bD(e.map(d=>d.text)),s=o.shortestLeadingCommonWhitespace;if(!s)return{chunks:e,usedFromRemaining:0};let a=e;for(let d=0;d<a.length;d++)a[d].originalStart+=s.length,a[d].text=o.trimmedLines[d]||"";let c=0,l=this.tokenizer.tokenLength(a.map(d=>d.text).join(`
`)),u=t[c];for(l+=u?.tokens||0;u&&l<r&&(u.text.length===0||u.text.startsWith(s));)a.push({...u,text:u.text.slice(s.length),originalStart:u.originalEnd+s.length}),c++,u=t[c],l+=u?.tokens||0;return{chunks:a,usedFromRemaining:c}}};Gp=E([v(1,Qn)],Gp);function bD(n){let e=n.map(s=>{if(!s)return;let a=s.match(/^\s+/),c=a?a[0]:"",l=s.substring(c?.length);return[c,l]}),t=zn(e),r=o$e(t)??"",o=r.length;return{trimmedLines:e.map(s=>s?s[0].substring(o)+s[1]:void 0),shortestLeadingCommonWhitespace:r}}function o$e(n){let e;for(let t of n){if(e===void 0){e=t[0];continue}e=s$e(e,t[0])}return e??""}function s$e(n,e){let t=IF(n,e);return n.substring(0,t)}var sT=250;function _D(n,e,t){let r=t.getStartPosition().isBefore(n.getStartPosition()),o=n.getEndPosition().isBefore(t.getEndPosition());return{newTextRange:n0e(e,t,n.getStartPosition(),n.getEndPosition()),trimmedLeft:r,trimmedRight:o}}function o0e(n,e){if(n.length>0&&e.startLineNumber>n[0].range.startLineNumber)for(;n.length>0&&De.lift(n[0].range).getEndPosition().isBefore(e.getStartPosition());)n.shift();if(n.length>0&&e.endLineNumber<n[n.length-1].range.endLineNumber)for(;n.length>0;){let t=De.lift(n[n.length-1].range).getStartPosition();if(e.getEndPosition().isBefore(t))n.pop();else break}}var OY={};Dr(OY,{arrayReplaceAt:()=>LY,assign:()=>lT,escapeHtml:()=>uh,escapeRE:()=>V$e,fromCodePoint:()=>ID,has:()=>D$e,isMdAsciiPunct:()=>sx,isPunctChar:()=>ox,isSpace:()=>Ln,isString:()=>s6,isValidEntityCode:()=>a6,isWhiteSpace:()=>ix,lib:()=>G$e,normalizeReference:()=>ax,unescapeAll:()=>Gv,unescapeMd:()=>F$e});var e6={};Dr(e6,{decode:()=>xD,encode:()=>J5,format:()=>aT,parse:()=>SD});var s0e={};function a$e(n){let e=s0e[n];if(e)return e;e=s0e[n]=[];for(let t=0;t<128;t++){let r=String.fromCharCode(t);e.push(r)}for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);e[r]="%"+("0"+r.toString(16).toUpperCase()).slice(-2)}return e}function Q5(n,e){typeof e!="string"&&(e=Q5.defaultChars);let t=a$e(e);return n.replace(/(%[a-f0-9]{2})+/gi,function(r){let o="";for(let s=0,a=r.length;s<a;s+=3){let c=parseInt(r.slice(s+1,s+3),16);if(c<128){o+=t[c];continue}if((c&224)===192&&s+3<a){let l=parseInt(r.slice(s+4,s+6),16);if((l&192)===128){let u=c<<6&1984|l&63;u<128?o+="\uFFFD\uFFFD":o+=String.fromCharCode(u),s+=3;continue}}if((c&240)===224&&s+6<a){let l=parseInt(r.slice(s+4,s+6),16),u=parseInt(r.slice(s+7,s+9),16);if((l&192)===128&&(u&192)===128){let d=c<<12&61440|l<<6&4032|u&63;d<2048||d>=55296&&d<=57343?o+="\uFFFD\uFFFD\uFFFD":o+=String.fromCharCode(d),s+=6;continue}}if((c&248)===240&&s+9<a){let l=parseInt(r.slice(s+4,s+6),16),u=parseInt(r.slice(s+7,s+9),16),d=parseInt(r.slice(s+10,s+12),16);if((l&192)===128&&(u&192)===128&&(d&192)===128){let p=c<<18&1835008|l<<12&258048|u<<6&4032|d&63;p<65536||p>1114111?o+="\uFFFD\uFFFD\uFFFD\uFFFD":(p-=65536,o+=String.fromCharCode(55296+(p>>10),56320+(p&1023))),s+=9;continue}}o+="\uFFFD"}return o})}Q5.defaultChars=";/?:@&=+$,#";Q5.componentChars="";var xD=Q5;var a0e={};function c$e(n){let e=a0e[n];if(e)return e;e=a0e[n]=[];for(let t=0;t<128;t++){let r=String.fromCharCode(t);/^[0-9a-z]$/i.test(r)?e.push(r):e.push("%"+("0"+t.toString(16).toUpperCase()).slice(-2))}for(let t=0;t<n.length;t++)e[n.charCodeAt(t)]=n[t];return e}function X5(n,e,t){typeof e!="string"&&(t=e,e=X5.defaultChars),typeof t>"u"&&(t=!0);let r=c$e(e),o="";for(let s=0,a=n.length;s<a;s++){let c=n.charCodeAt(s);if(t&&c===37&&s+2<a&&/^[0-9a-f]{2}$/i.test(n.slice(s+1,s+3))){o+=n.slice(s,s+3),s+=2;continue}if(c<128){o+=r[c];continue}if(c>=55296&&c<=57343){if(c>=55296&&c<=56319&&s+1<a){let l=n.charCodeAt(s+1);if(l>=56320&&l<=57343){o+=encodeURIComponent(n[s]+n[s+1]),s++;continue}}o+="%EF%BF%BD";continue}o+=encodeURIComponent(n[s])}return o}X5.defaultChars=";/?:@&=+$,-_.!~*'()#";X5.componentChars="-_.!~*'()";var J5=X5;function aT(n){let e="";return e+=n.protocol||"",e+=n.slashes?"//":"",e+=n.auth?n.auth+"@":"",n.hostname&&n.hostname.indexOf(":")!==-1?e+="["+n.hostname+"]":e+=n.hostname||"",e+=n.port?":"+n.port:"",e+=n.pathname||"",e+=n.search||"",e+=n.hash||"",e}function Z5(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}var l$e=/^([a-z0-9.+-]+:)/i,u$e=/:[0-9]*$/,d$e=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,p$e=["<",">",'"',"`"," ","\r",`
`,"	"],f$e=["{","}","|","\\","^","`"].concat(p$e),m$e=["'"].concat(f$e),c0e=["%","/","?",";","#"].concat(m$e),l0e=["/","?","#"],h$e=255,u0e=/^[+a-z0-9A-Z_-]{0,63}$/,g$e=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,d0e={javascript:!0,"javascript:":!0},p0e={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function v$e(n,e){if(n&&n instanceof Z5)return n;let t=new Z5;return t.parse(n,e),t}Z5.prototype.parse=function(n,e){let t,r,o,s=n;if(s=s.trim(),!e&&n.split("#").length===1){let u=d$e.exec(s);if(u)return this.pathname=u[1],u[2]&&(this.search=u[2]),this}let a=l$e.exec(s);if(a&&(a=a[0],t=a.toLowerCase(),this.protocol=a,s=s.substr(a.length)),(e||a||s.match(/^\/\/[^@\/]+@[^@\/]+/))&&(o=s.substr(0,2)==="//",o&&!(a&&d0e[a])&&(s=s.substr(2),this.slashes=!0)),!d0e[a]&&(o||a&&!p0e[a])){let u=-1;for(let h=0;h<l0e.length;h++)r=s.indexOf(l0e[h]),r!==-1&&(u===-1||r<u)&&(u=r);let d,p;u===-1?p=s.lastIndexOf("@"):p=s.lastIndexOf("@",u),p!==-1&&(d=s.slice(0,p),s=s.slice(p+1),this.auth=d),u=-1;for(let h=0;h<c0e.length;h++)r=s.indexOf(c0e[h]),r!==-1&&(u===-1||r<u)&&(u=r);u===-1&&(u=s.length),s[u-1]===":"&&u--;let f=s.slice(0,u);s=s.slice(u),this.parseHost(f),this.hostname=this.hostname||"";let m=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!m){let h=this.hostname.split(/\./);for(let g=0,y=h.length;g<y;g++){let b=h[g];if(b&&!b.match(u0e)){let _="";for(let x=0,I=b.length;x<I;x++)b.charCodeAt(x)>127?_+="x":_+=b[x];if(!_.match(u0e)){let x=h.slice(0,g),I=h.slice(g+1),S=b.match(g$e);S&&(x.push(S[1]),I.unshift(S[2])),I.length&&(s=I.join(".")+s),this.hostname=x.join(".");break}}}}this.hostname.length>h$e&&(this.hostname=""),m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}let c=s.indexOf("#");c!==-1&&(this.hash=s.substr(c),s=s.slice(0,c));let l=s.indexOf("?");return l!==-1&&(this.search=s.substr(l),s=s.slice(0,l)),s&&(this.pathname=s),p0e[t]&&this.hostname&&!this.pathname&&(this.pathname=""),this};Z5.prototype.parseHost=function(n){let e=u$e.exec(n);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),n=n.substr(0,n.length-e.length)),n&&(this.hostname=n)};var SD=v$e;var wY={};Dr(wY,{Any:()=>t6,Cc:()=>n6,Cf:()=>f0e,P:()=>cT,Z:()=>r6});var t6=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/;var n6=/[\0-\x1F\x7F-\x9F]/;var f0e=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/;var cT=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/;var r6=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/;var m0e=new Uint16Array('\u1D41<\xD5\u0131\u028A\u049D\u057B\u05D0\u0675\u06DE\u07A2\u07D6\u080F\u0A4A\u0A91\u0DA1\u0E6D\u0F09\u0F26\u10CA\u1228\u12E1\u1415\u149D\u14C3\u14DF\u1525\0\0\0\0\0\0\u156B\u16CD\u198D\u1C12\u1DDD\u1F7E\u2060\u21B0\u228D\u23C0\u23FB\u2442\u2824\u2912\u2D08\u2E48\u2FCE\u3016\u32BA\u3639\u37AC\u38FE\u3A28\u3A71\u3AE0\u3B2E\u0800EMabcfglmnoprstu\\bfms\x7F\x84\x8B\x90\x95\x98\xA6\xB3\xB9\xC8\xCFlig\u803B\xC6\u40C6P\u803B&\u4026cute\u803B\xC1\u40C1reve;\u4102\u0100iyx}rc\u803B\xC2\u40C2;\u4410r;\uC000\u{1D504}rave\u803B\xC0\u40C0pha;\u4391acr;\u4100d;\u6A53\u0100gp\x9D\xA1on;\u4104f;\uC000\u{1D538}plyFunction;\u6061ing\u803B\xC5\u40C5\u0100cs\xBE\xC3r;\uC000\u{1D49C}ign;\u6254ilde\u803B\xC3\u40C3ml\u803B\xC4\u40C4\u0400aceforsu\xE5\xFB\xFE\u0117\u011C\u0122\u0127\u012A\u0100cr\xEA\xF2kslash;\u6216\u0176\xF6\xF8;\u6AE7ed;\u6306y;\u4411\u0180crt\u0105\u010B\u0114ause;\u6235noullis;\u612Ca;\u4392r;\uC000\u{1D505}pf;\uC000\u{1D539}eve;\u42D8c\xF2\u0113mpeq;\u624E\u0700HOacdefhilorsu\u014D\u0151\u0156\u0180\u019E\u01A2\u01B5\u01B7\u01BA\u01DC\u0215\u0273\u0278\u027Ecy;\u4427PY\u803B\xA9\u40A9\u0180cpy\u015D\u0162\u017Aute;\u4106\u0100;i\u0167\u0168\u62D2talDifferentialD;\u6145leys;\u612D\u0200aeio\u0189\u018E\u0194\u0198ron;\u410Cdil\u803B\xC7\u40C7rc;\u4108nint;\u6230ot;\u410A\u0100dn\u01A7\u01ADilla;\u40B8terDot;\u40B7\xF2\u017Fi;\u43A7rcle\u0200DMPT\u01C7\u01CB\u01D1\u01D6ot;\u6299inus;\u6296lus;\u6295imes;\u6297o\u0100cs\u01E2\u01F8kwiseContourIntegral;\u6232eCurly\u0100DQ\u0203\u020FoubleQuote;\u601Duote;\u6019\u0200lnpu\u021E\u0228\u0247\u0255on\u0100;e\u0225\u0226\u6237;\u6A74\u0180git\u022F\u0236\u023Aruent;\u6261nt;\u622FourIntegral;\u622E\u0100fr\u024C\u024E;\u6102oduct;\u6210nterClockwiseContourIntegral;\u6233oss;\u6A2Fcr;\uC000\u{1D49E}p\u0100;C\u0284\u0285\u62D3ap;\u624D\u0580DJSZacefios\u02A0\u02AC\u02B0\u02B4\u02B8\u02CB\u02D7\u02E1\u02E6\u0333\u048D\u0100;o\u0179\u02A5trahd;\u6911cy;\u4402cy;\u4405cy;\u440F\u0180grs\u02BF\u02C4\u02C7ger;\u6021r;\u61A1hv;\u6AE4\u0100ay\u02D0\u02D5ron;\u410E;\u4414l\u0100;t\u02DD\u02DE\u6207a;\u4394r;\uC000\u{1D507}\u0100af\u02EB\u0327\u0100cm\u02F0\u0322ritical\u0200ADGT\u0300\u0306\u0316\u031Ccute;\u40B4o\u0174\u030B\u030D;\u42D9bleAcute;\u42DDrave;\u4060ilde;\u42DCond;\u62C4ferentialD;\u6146\u0470\u033D\0\0\0\u0342\u0354\0\u0405f;\uC000\u{1D53B}\u0180;DE\u0348\u0349\u034D\u40A8ot;\u60DCqual;\u6250ble\u0300CDLRUV\u0363\u0372\u0382\u03CF\u03E2\u03F8ontourIntegra\xEC\u0239o\u0274\u0379\0\0\u037B\xBB\u0349nArrow;\u61D3\u0100eo\u0387\u03A4ft\u0180ART\u0390\u0396\u03A1rrow;\u61D0ightArrow;\u61D4e\xE5\u02CAng\u0100LR\u03AB\u03C4eft\u0100AR\u03B3\u03B9rrow;\u67F8ightArrow;\u67FAightArrow;\u67F9ight\u0100AT\u03D8\u03DErrow;\u61D2ee;\u62A8p\u0241\u03E9\0\0\u03EFrrow;\u61D1ownArrow;\u61D5erticalBar;\u6225n\u0300ABLRTa\u0412\u042A\u0430\u045E\u047F\u037Crrow\u0180;BU\u041D\u041E\u0422\u6193ar;\u6913pArrow;\u61F5reve;\u4311eft\u02D2\u043A\0\u0446\0\u0450ightVector;\u6950eeVector;\u695Eector\u0100;B\u0459\u045A\u61BDar;\u6956ight\u01D4\u0467\0\u0471eeVector;\u695Fector\u0100;B\u047A\u047B\u61C1ar;\u6957ee\u0100;A\u0486\u0487\u62A4rrow;\u61A7\u0100ct\u0492\u0497r;\uC000\u{1D49F}rok;\u4110\u0800NTacdfglmopqstux\u04BD\u04C0\u04C4\u04CB\u04DE\u04E2\u04E7\u04EE\u04F5\u0521\u052F\u0536\u0552\u055D\u0560\u0565G;\u414AH\u803B\xD0\u40D0cute\u803B\xC9\u40C9\u0180aiy\u04D2\u04D7\u04DCron;\u411Arc\u803B\xCA\u40CA;\u442Dot;\u4116r;\uC000\u{1D508}rave\u803B\xC8\u40C8ement;\u6208\u0100ap\u04FA\u04FEcr;\u4112ty\u0253\u0506\0\0\u0512mallSquare;\u65FBerySmallSquare;\u65AB\u0100gp\u0526\u052Aon;\u4118f;\uC000\u{1D53C}silon;\u4395u\u0100ai\u053C\u0549l\u0100;T\u0542\u0543\u6A75ilde;\u6242librium;\u61CC\u0100ci\u0557\u055Ar;\u6130m;\u6A73a;\u4397ml\u803B\xCB\u40CB\u0100ip\u056A\u056Fsts;\u6203onentialE;\u6147\u0280cfios\u0585\u0588\u058D\u05B2\u05CCy;\u4424r;\uC000\u{1D509}lled\u0253\u0597\0\0\u05A3mallSquare;\u65FCerySmallSquare;\u65AA\u0370\u05BA\0\u05BF\0\0\u05C4f;\uC000\u{1D53D}All;\u6200riertrf;\u6131c\xF2\u05CB\u0600JTabcdfgorst\u05E8\u05EC\u05EF\u05FA\u0600\u0612\u0616\u061B\u061D\u0623\u066C\u0672cy;\u4403\u803B>\u403Emma\u0100;d\u05F7\u05F8\u4393;\u43DCreve;\u411E\u0180eiy\u0607\u060C\u0610dil;\u4122rc;\u411C;\u4413ot;\u4120r;\uC000\u{1D50A};\u62D9pf;\uC000\u{1D53E}eater\u0300EFGLST\u0635\u0644\u064E\u0656\u065B\u0666qual\u0100;L\u063E\u063F\u6265ess;\u62DBullEqual;\u6267reater;\u6AA2ess;\u6277lantEqual;\u6A7Eilde;\u6273cr;\uC000\u{1D4A2};\u626B\u0400Aacfiosu\u0685\u068B\u0696\u069B\u069E\u06AA\u06BE\u06CARDcy;\u442A\u0100ct\u0690\u0694ek;\u42C7;\u405Eirc;\u4124r;\u610ClbertSpace;\u610B\u01F0\u06AF\0\u06B2f;\u610DizontalLine;\u6500\u0100ct\u06C3\u06C5\xF2\u06A9rok;\u4126mp\u0144\u06D0\u06D8ownHum\xF0\u012Fqual;\u624F\u0700EJOacdfgmnostu\u06FA\u06FE\u0703\u0707\u070E\u071A\u071E\u0721\u0728\u0744\u0778\u078B\u078F\u0795cy;\u4415lig;\u4132cy;\u4401cute\u803B\xCD\u40CD\u0100iy\u0713\u0718rc\u803B\xCE\u40CE;\u4418ot;\u4130r;\u6111rave\u803B\xCC\u40CC\u0180;ap\u0720\u072F\u073F\u0100cg\u0734\u0737r;\u412AinaryI;\u6148lie\xF3\u03DD\u01F4\u0749\0\u0762\u0100;e\u074D\u074E\u622C\u0100gr\u0753\u0758ral;\u622Bsection;\u62C2isible\u0100CT\u076C\u0772omma;\u6063imes;\u6062\u0180gpt\u077F\u0783\u0788on;\u412Ef;\uC000\u{1D540}a;\u4399cr;\u6110ilde;\u4128\u01EB\u079A\0\u079Ecy;\u4406l\u803B\xCF\u40CF\u0280cfosu\u07AC\u07B7\u07BC\u07C2\u07D0\u0100iy\u07B1\u07B5rc;\u4134;\u4419r;\uC000\u{1D50D}pf;\uC000\u{1D541}\u01E3\u07C7\0\u07CCr;\uC000\u{1D4A5}rcy;\u4408kcy;\u4404\u0380HJacfos\u07E4\u07E8\u07EC\u07F1\u07FD\u0802\u0808cy;\u4425cy;\u440Cppa;\u439A\u0100ey\u07F6\u07FBdil;\u4136;\u441Ar;\uC000\u{1D50E}pf;\uC000\u{1D542}cr;\uC000\u{1D4A6}\u0580JTaceflmost\u0825\u0829\u082C\u0850\u0863\u09B3\u09B8\u09C7\u09CD\u0A37\u0A47cy;\u4409\u803B<\u403C\u0280cmnpr\u0837\u083C\u0841\u0844\u084Dute;\u4139bda;\u439Bg;\u67EAlacetrf;\u6112r;\u619E\u0180aey\u0857\u085C\u0861ron;\u413Ddil;\u413B;\u441B\u0100fs\u0868\u0970t\u0500ACDFRTUVar\u087E\u08A9\u08B1\u08E0\u08E6\u08FC\u092F\u095B\u0390\u096A\u0100nr\u0883\u088FgleBracket;\u67E8row\u0180;BR\u0899\u089A\u089E\u6190ar;\u61E4ightArrow;\u61C6eiling;\u6308o\u01F5\u08B7\0\u08C3bleBracket;\u67E6n\u01D4\u08C8\0\u08D2eeVector;\u6961ector\u0100;B\u08DB\u08DC\u61C3ar;\u6959loor;\u630Aight\u0100AV\u08EF\u08F5rrow;\u6194ector;\u694E\u0100er\u0901\u0917e\u0180;AV\u0909\u090A\u0910\u62A3rrow;\u61A4ector;\u695Aiangle\u0180;BE\u0924\u0925\u0929\u62B2ar;\u69CFqual;\u62B4p\u0180DTV\u0937\u0942\u094CownVector;\u6951eeVector;\u6960ector\u0100;B\u0956\u0957\u61BFar;\u6958ector\u0100;B\u0965\u0966\u61BCar;\u6952ight\xE1\u039Cs\u0300EFGLST\u097E\u098B\u0995\u099D\u09A2\u09ADqualGreater;\u62DAullEqual;\u6266reater;\u6276ess;\u6AA1lantEqual;\u6A7Dilde;\u6272r;\uC000\u{1D50F}\u0100;e\u09BD\u09BE\u62D8ftarrow;\u61DAidot;\u413F\u0180npw\u09D4\u0A16\u0A1Bg\u0200LRlr\u09DE\u09F7\u0A02\u0A10eft\u0100AR\u09E6\u09ECrrow;\u67F5ightArrow;\u67F7ightArrow;\u67F6eft\u0100ar\u03B3\u0A0Aight\xE1\u03BFight\xE1\u03CAf;\uC000\u{1D543}er\u0100LR\u0A22\u0A2CeftArrow;\u6199ightArrow;\u6198\u0180cht\u0A3E\u0A40\u0A42\xF2\u084C;\u61B0rok;\u4141;\u626A\u0400acefiosu\u0A5A\u0A5D\u0A60\u0A77\u0A7C\u0A85\u0A8B\u0A8Ep;\u6905y;\u441C\u0100dl\u0A65\u0A6FiumSpace;\u605Flintrf;\u6133r;\uC000\u{1D510}nusPlus;\u6213pf;\uC000\u{1D544}c\xF2\u0A76;\u439C\u0480Jacefostu\u0AA3\u0AA7\u0AAD\u0AC0\u0B14\u0B19\u0D91\u0D97\u0D9Ecy;\u440Acute;\u4143\u0180aey\u0AB4\u0AB9\u0ABEron;\u4147dil;\u4145;\u441D\u0180gsw\u0AC7\u0AF0\u0B0Eative\u0180MTV\u0AD3\u0ADF\u0AE8ediumSpace;\u600Bhi\u0100cn\u0AE6\u0AD8\xEB\u0AD9eryThi\xEE\u0AD9ted\u0100GL\u0AF8\u0B06reaterGreate\xF2\u0673essLes\xF3\u0A48Line;\u400Ar;\uC000\u{1D511}\u0200Bnpt\u0B22\u0B28\u0B37\u0B3Areak;\u6060BreakingSpace;\u40A0f;\u6115\u0680;CDEGHLNPRSTV\u0B55\u0B56\u0B6A\u0B7C\u0BA1\u0BEB\u0C04\u0C5E\u0C84\u0CA6\u0CD8\u0D61\u0D85\u6AEC\u0100ou\u0B5B\u0B64ngruent;\u6262pCap;\u626DoubleVerticalBar;\u6226\u0180lqx\u0B83\u0B8A\u0B9Bement;\u6209ual\u0100;T\u0B92\u0B93\u6260ilde;\uC000\u2242\u0338ists;\u6204reater\u0380;EFGLST\u0BB6\u0BB7\u0BBD\u0BC9\u0BD3\u0BD8\u0BE5\u626Fqual;\u6271ullEqual;\uC000\u2267\u0338reater;\uC000\u226B\u0338ess;\u6279lantEqual;\uC000\u2A7E\u0338ilde;\u6275ump\u0144\u0BF2\u0BFDownHump;\uC000\u224E\u0338qual;\uC000\u224F\u0338e\u0100fs\u0C0A\u0C27tTriangle\u0180;BE\u0C1A\u0C1B\u0C21\u62EAar;\uC000\u29CF\u0338qual;\u62ECs\u0300;EGLST\u0C35\u0C36\u0C3C\u0C44\u0C4B\u0C58\u626Equal;\u6270reater;\u6278ess;\uC000\u226A\u0338lantEqual;\uC000\u2A7D\u0338ilde;\u6274ested\u0100GL\u0C68\u0C79reaterGreater;\uC000\u2AA2\u0338essLess;\uC000\u2AA1\u0338recedes\u0180;ES\u0C92\u0C93\u0C9B\u6280qual;\uC000\u2AAF\u0338lantEqual;\u62E0\u0100ei\u0CAB\u0CB9verseElement;\u620CghtTriangle\u0180;BE\u0CCB\u0CCC\u0CD2\u62EBar;\uC000\u29D0\u0338qual;\u62ED\u0100qu\u0CDD\u0D0CuareSu\u0100bp\u0CE8\u0CF9set\u0100;E\u0CF0\u0CF3\uC000\u228F\u0338qual;\u62E2erset\u0100;E\u0D03\u0D06\uC000\u2290\u0338qual;\u62E3\u0180bcp\u0D13\u0D24\u0D4Eset\u0100;E\u0D1B\u0D1E\uC000\u2282\u20D2qual;\u6288ceeds\u0200;EST\u0D32\u0D33\u0D3B\u0D46\u6281qual;\uC000\u2AB0\u0338lantEqual;\u62E1ilde;\uC000\u227F\u0338erset\u0100;E\u0D58\u0D5B\uC000\u2283\u20D2qual;\u6289ilde\u0200;EFT\u0D6E\u0D6F\u0D75\u0D7F\u6241qual;\u6244ullEqual;\u6247ilde;\u6249erticalBar;\u6224cr;\uC000\u{1D4A9}ilde\u803B\xD1\u40D1;\u439D\u0700Eacdfgmoprstuv\u0DBD\u0DC2\u0DC9\u0DD5\u0DDB\u0DE0\u0DE7\u0DFC\u0E02\u0E20\u0E22\u0E32\u0E3F\u0E44lig;\u4152cute\u803B\xD3\u40D3\u0100iy\u0DCE\u0DD3rc\u803B\xD4\u40D4;\u441Eblac;\u4150r;\uC000\u{1D512}rave\u803B\xD2\u40D2\u0180aei\u0DEE\u0DF2\u0DF6cr;\u414Cga;\u43A9cron;\u439Fpf;\uC000\u{1D546}enCurly\u0100DQ\u0E0E\u0E1AoubleQuote;\u601Cuote;\u6018;\u6A54\u0100cl\u0E27\u0E2Cr;\uC000\u{1D4AA}ash\u803B\xD8\u40D8i\u016C\u0E37\u0E3Cde\u803B\xD5\u40D5es;\u6A37ml\u803B\xD6\u40D6er\u0100BP\u0E4B\u0E60\u0100ar\u0E50\u0E53r;\u603Eac\u0100ek\u0E5A\u0E5C;\u63DEet;\u63B4arenthesis;\u63DC\u0480acfhilors\u0E7F\u0E87\u0E8A\u0E8F\u0E92\u0E94\u0E9D\u0EB0\u0EFCrtialD;\u6202y;\u441Fr;\uC000\u{1D513}i;\u43A6;\u43A0usMinus;\u40B1\u0100ip\u0EA2\u0EADncareplan\xE5\u069Df;\u6119\u0200;eio\u0EB9\u0EBA\u0EE0\u0EE4\u6ABBcedes\u0200;EST\u0EC8\u0EC9\u0ECF\u0EDA\u627Aqual;\u6AAFlantEqual;\u627Cilde;\u627Eme;\u6033\u0100dp\u0EE9\u0EEEuct;\u620Fortion\u0100;a\u0225\u0EF9l;\u621D\u0100ci\u0F01\u0F06r;\uC000\u{1D4AB};\u43A8\u0200Ufos\u0F11\u0F16\u0F1B\u0F1FOT\u803B"\u4022r;\uC000\u{1D514}pf;\u611Acr;\uC000\u{1D4AC}\u0600BEacefhiorsu\u0F3E\u0F43\u0F47\u0F60\u0F73\u0FA7\u0FAA\u0FAD\u1096\u10A9\u10B4\u10BEarr;\u6910G\u803B\xAE\u40AE\u0180cnr\u0F4E\u0F53\u0F56ute;\u4154g;\u67EBr\u0100;t\u0F5C\u0F5D\u61A0l;\u6916\u0180aey\u0F67\u0F6C\u0F71ron;\u4158dil;\u4156;\u4420\u0100;v\u0F78\u0F79\u611Cerse\u0100EU\u0F82\u0F99\u0100lq\u0F87\u0F8Eement;\u620Builibrium;\u61CBpEquilibrium;\u696Fr\xBB\u0F79o;\u43A1ght\u0400ACDFTUVa\u0FC1\u0FEB\u0FF3\u1022\u1028\u105B\u1087\u03D8\u0100nr\u0FC6\u0FD2gleBracket;\u67E9row\u0180;BL\u0FDC\u0FDD\u0FE1\u6192ar;\u61E5eftArrow;\u61C4eiling;\u6309o\u01F5\u0FF9\0\u1005bleBracket;\u67E7n\u01D4\u100A\0\u1014eeVector;\u695Dector\u0100;B\u101D\u101E\u61C2ar;\u6955loor;\u630B\u0100er\u102D\u1043e\u0180;AV\u1035\u1036\u103C\u62A2rrow;\u61A6ector;\u695Biangle\u0180;BE\u1050\u1051\u1055\u62B3ar;\u69D0qual;\u62B5p\u0180DTV\u1063\u106E\u1078ownVector;\u694FeeVector;\u695Cector\u0100;B\u1082\u1083\u61BEar;\u6954ector\u0100;B\u1091\u1092\u61C0ar;\u6953\u0100pu\u109B\u109Ef;\u611DndImplies;\u6970ightarrow;\u61DB\u0100ch\u10B9\u10BCr;\u611B;\u61B1leDelayed;\u69F4\u0680HOacfhimoqstu\u10E4\u10F1\u10F7\u10FD\u1119\u111E\u1151\u1156\u1161\u1167\u11B5\u11BB\u11BF\u0100Cc\u10E9\u10EEHcy;\u4429y;\u4428FTcy;\u442Ccute;\u415A\u0280;aeiy\u1108\u1109\u110E\u1113\u1117\u6ABCron;\u4160dil;\u415Erc;\u415C;\u4421r;\uC000\u{1D516}ort\u0200DLRU\u112A\u1134\u113E\u1149ownArrow\xBB\u041EeftArrow\xBB\u089AightArrow\xBB\u0FDDpArrow;\u6191gma;\u43A3allCircle;\u6218pf;\uC000\u{1D54A}\u0272\u116D\0\0\u1170t;\u621Aare\u0200;ISU\u117B\u117C\u1189\u11AF\u65A1ntersection;\u6293u\u0100bp\u118F\u119Eset\u0100;E\u1197\u1198\u628Fqual;\u6291erset\u0100;E\u11A8\u11A9\u6290qual;\u6292nion;\u6294cr;\uC000\u{1D4AE}ar;\u62C6\u0200bcmp\u11C8\u11DB\u1209\u120B\u0100;s\u11CD\u11CE\u62D0et\u0100;E\u11CD\u11D5qual;\u6286\u0100ch\u11E0\u1205eeds\u0200;EST\u11ED\u11EE\u11F4\u11FF\u627Bqual;\u6AB0lantEqual;\u627Dilde;\u627FTh\xE1\u0F8C;\u6211\u0180;es\u1212\u1213\u1223\u62D1rset\u0100;E\u121C\u121D\u6283qual;\u6287et\xBB\u1213\u0580HRSacfhiors\u123E\u1244\u1249\u1255\u125E\u1271\u1276\u129F\u12C2\u12C8\u12D1ORN\u803B\xDE\u40DEADE;\u6122\u0100Hc\u124E\u1252cy;\u440By;\u4426\u0100bu\u125A\u125C;\u4009;\u43A4\u0180aey\u1265\u126A\u126Fron;\u4164dil;\u4162;\u4422r;\uC000\u{1D517}\u0100ei\u127B\u1289\u01F2\u1280\0\u1287efore;\u6234a;\u4398\u0100cn\u128E\u1298kSpace;\uC000\u205F\u200ASpace;\u6009lde\u0200;EFT\u12AB\u12AC\u12B2\u12BC\u623Cqual;\u6243ullEqual;\u6245ilde;\u6248pf;\uC000\u{1D54B}ipleDot;\u60DB\u0100ct\u12D6\u12DBr;\uC000\u{1D4AF}rok;\u4166\u0AE1\u12F7\u130E\u131A\u1326\0\u132C\u1331\0\0\0\0\0\u1338\u133D\u1377\u1385\0\u13FF\u1404\u140A\u1410\u0100cr\u12FB\u1301ute\u803B\xDA\u40DAr\u0100;o\u1307\u1308\u619Fcir;\u6949r\u01E3\u1313\0\u1316y;\u440Eve;\u416C\u0100iy\u131E\u1323rc\u803B\xDB\u40DB;\u4423blac;\u4170r;\uC000\u{1D518}rave\u803B\xD9\u40D9acr;\u416A\u0100di\u1341\u1369er\u0100BP\u1348\u135D\u0100ar\u134D\u1350r;\u405Fac\u0100ek\u1357\u1359;\u63DFet;\u63B5arenthesis;\u63DDon\u0100;P\u1370\u1371\u62C3lus;\u628E\u0100gp\u137B\u137Fon;\u4172f;\uC000\u{1D54C}\u0400ADETadps\u1395\u13AE\u13B8\u13C4\u03E8\u13D2\u13D7\u13F3rrow\u0180;BD\u1150\u13A0\u13A4ar;\u6912ownArrow;\u61C5ownArrow;\u6195quilibrium;\u696Eee\u0100;A\u13CB\u13CC\u62A5rrow;\u61A5own\xE1\u03F3er\u0100LR\u13DE\u13E8eftArrow;\u6196ightArrow;\u6197i\u0100;l\u13F9\u13FA\u43D2on;\u43A5ing;\u416Ecr;\uC000\u{1D4B0}ilde;\u4168ml\u803B\xDC\u40DC\u0480Dbcdefosv\u1427\u142C\u1430\u1433\u143E\u1485\u148A\u1490\u1496ash;\u62ABar;\u6AEBy;\u4412ash\u0100;l\u143B\u143C\u62A9;\u6AE6\u0100er\u1443\u1445;\u62C1\u0180bty\u144C\u1450\u147Aar;\u6016\u0100;i\u144F\u1455cal\u0200BLST\u1461\u1465\u146A\u1474ar;\u6223ine;\u407Ceparator;\u6758ilde;\u6240ThinSpace;\u600Ar;\uC000\u{1D519}pf;\uC000\u{1D54D}cr;\uC000\u{1D4B1}dash;\u62AA\u0280cefos\u14A7\u14AC\u14B1\u14B6\u14BCirc;\u4174dge;\u62C0r;\uC000\u{1D51A}pf;\uC000\u{1D54E}cr;\uC000\u{1D4B2}\u0200fios\u14CB\u14D0\u14D2\u14D8r;\uC000\u{1D51B};\u439Epf;\uC000\u{1D54F}cr;\uC000\u{1D4B3}\u0480AIUacfosu\u14F1\u14F5\u14F9\u14FD\u1504\u150F\u1514\u151A\u1520cy;\u442Fcy;\u4407cy;\u442Ecute\u803B\xDD\u40DD\u0100iy\u1509\u150Drc;\u4176;\u442Br;\uC000\u{1D51C}pf;\uC000\u{1D550}cr;\uC000\u{1D4B4}ml;\u4178\u0400Hacdefos\u1535\u1539\u153F\u154B\u154F\u155D\u1560\u1564cy;\u4416cute;\u4179\u0100ay\u1544\u1549ron;\u417D;\u4417ot;\u417B\u01F2\u1554\0\u155BoWidt\xE8\u0AD9a;\u4396r;\u6128pf;\u6124cr;\uC000\u{1D4B5}\u0BE1\u1583\u158A\u1590\0\u15B0\u15B6\u15BF\0\0\0\0\u15C6\u15DB\u15EB\u165F\u166D\0\u1695\u169B\u16B2\u16B9\0\u16BEcute\u803B\xE1\u40E1reve;\u4103\u0300;Ediuy\u159C\u159D\u15A1\u15A3\u15A8\u15AD\u623E;\uC000\u223E\u0333;\u623Frc\u803B\xE2\u40E2te\u80BB\xB4\u0306;\u4430lig\u803B\xE6\u40E6\u0100;r\xB2\u15BA;\uC000\u{1D51E}rave\u803B\xE0\u40E0\u0100ep\u15CA\u15D6\u0100fp\u15CF\u15D4sym;\u6135\xE8\u15D3ha;\u43B1\u0100ap\u15DFc\u0100cl\u15E4\u15E7r;\u4101g;\u6A3F\u0264\u15F0\0\0\u160A\u0280;adsv\u15FA\u15FB\u15FF\u1601\u1607\u6227nd;\u6A55;\u6A5Clope;\u6A58;\u6A5A\u0380;elmrsz\u1618\u1619\u161B\u161E\u163F\u164F\u1659\u6220;\u69A4e\xBB\u1619sd\u0100;a\u1625\u1626\u6221\u0461\u1630\u1632\u1634\u1636\u1638\u163A\u163C\u163E;\u69A8;\u69A9;\u69AA;\u69AB;\u69AC;\u69AD;\u69AE;\u69AFt\u0100;v\u1645\u1646\u621Fb\u0100;d\u164C\u164D\u62BE;\u699D\u0100pt\u1654\u1657h;\u6222\xBB\xB9arr;\u637C\u0100gp\u1663\u1667on;\u4105f;\uC000\u{1D552}\u0380;Eaeiop\u12C1\u167B\u167D\u1682\u1684\u1687\u168A;\u6A70cir;\u6A6F;\u624Ad;\u624Bs;\u4027rox\u0100;e\u12C1\u1692\xF1\u1683ing\u803B\xE5\u40E5\u0180cty\u16A1\u16A6\u16A8r;\uC000\u{1D4B6};\u402Amp\u0100;e\u12C1\u16AF\xF1\u0288ilde\u803B\xE3\u40E3ml\u803B\xE4\u40E4\u0100ci\u16C2\u16C8onin\xF4\u0272nt;\u6A11\u0800Nabcdefiklnoprsu\u16ED\u16F1\u1730\u173C\u1743\u1748\u1778\u177D\u17E0\u17E6\u1839\u1850\u170D\u193D\u1948\u1970ot;\u6AED\u0100cr\u16F6\u171Ek\u0200ceps\u1700\u1705\u170D\u1713ong;\u624Cpsilon;\u43F6rime;\u6035im\u0100;e\u171A\u171B\u623Dq;\u62CD\u0176\u1722\u1726ee;\u62BDed\u0100;g\u172C\u172D\u6305e\xBB\u172Drk\u0100;t\u135C\u1737brk;\u63B6\u0100oy\u1701\u1741;\u4431quo;\u601E\u0280cmprt\u1753\u175B\u1761\u1764\u1768aus\u0100;e\u010A\u0109ptyv;\u69B0s\xE9\u170Cno\xF5\u0113\u0180ahw\u176F\u1771\u1773;\u43B2;\u6136een;\u626Cr;\uC000\u{1D51F}g\u0380costuvw\u178D\u179D\u17B3\u17C1\u17D5\u17DB\u17DE\u0180aiu\u1794\u1796\u179A\xF0\u0760rc;\u65EFp\xBB\u1371\u0180dpt\u17A4\u17A8\u17ADot;\u6A00lus;\u6A01imes;\u6A02\u0271\u17B9\0\0\u17BEcup;\u6A06ar;\u6605riangle\u0100du\u17CD\u17D2own;\u65BDp;\u65B3plus;\u6A04e\xE5\u1444\xE5\u14ADarow;\u690D\u0180ako\u17ED\u1826\u1835\u0100cn\u17F2\u1823k\u0180lst\u17FA\u05AB\u1802ozenge;\u69EBriangle\u0200;dlr\u1812\u1813\u1818\u181D\u65B4own;\u65BEeft;\u65C2ight;\u65B8k;\u6423\u01B1\u182B\0\u1833\u01B2\u182F\0\u1831;\u6592;\u65914;\u6593ck;\u6588\u0100eo\u183E\u184D\u0100;q\u1843\u1846\uC000=\u20E5uiv;\uC000\u2261\u20E5t;\u6310\u0200ptwx\u1859\u185E\u1867\u186Cf;\uC000\u{1D553}\u0100;t\u13CB\u1863om\xBB\u13CCtie;\u62C8\u0600DHUVbdhmptuv\u1885\u1896\u18AA\u18BB\u18D7\u18DB\u18EC\u18FF\u1905\u190A\u1910\u1921\u0200LRlr\u188E\u1890\u1892\u1894;\u6557;\u6554;\u6556;\u6553\u0280;DUdu\u18A1\u18A2\u18A4\u18A6\u18A8\u6550;\u6566;\u6569;\u6564;\u6567\u0200LRlr\u18B3\u18B5\u18B7\u18B9;\u655D;\u655A;\u655C;\u6559\u0380;HLRhlr\u18CA\u18CB\u18CD\u18CF\u18D1\u18D3\u18D5\u6551;\u656C;\u6563;\u6560;\u656B;\u6562;\u655Fox;\u69C9\u0200LRlr\u18E4\u18E6\u18E8\u18EA;\u6555;\u6552;\u6510;\u650C\u0280;DUdu\u06BD\u18F7\u18F9\u18FB\u18FD;\u6565;\u6568;\u652C;\u6534inus;\u629Flus;\u629Eimes;\u62A0\u0200LRlr\u1919\u191B\u191D\u191F;\u655B;\u6558;\u6518;\u6514\u0380;HLRhlr\u1930\u1931\u1933\u1935\u1937\u1939\u193B\u6502;\u656A;\u6561;\u655E;\u653C;\u6524;\u651C\u0100ev\u0123\u1942bar\u803B\xA6\u40A6\u0200ceio\u1951\u1956\u195A\u1960r;\uC000\u{1D4B7}mi;\u604Fm\u0100;e\u171A\u171Cl\u0180;bh\u1968\u1969\u196B\u405C;\u69C5sub;\u67C8\u016C\u1974\u197El\u0100;e\u1979\u197A\u6022t\xBB\u197Ap\u0180;Ee\u012F\u1985\u1987;\u6AAE\u0100;q\u06DC\u06DB\u0CE1\u19A7\0\u19E8\u1A11\u1A15\u1A32\0\u1A37\u1A50\0\0\u1AB4\0\0\u1AC1\0\0\u1B21\u1B2E\u1B4D\u1B52\0\u1BFD\0\u1C0C\u0180cpr\u19AD\u19B2\u19DDute;\u4107\u0300;abcds\u19BF\u19C0\u19C4\u19CA\u19D5\u19D9\u6229nd;\u6A44rcup;\u6A49\u0100au\u19CF\u19D2p;\u6A4Bp;\u6A47ot;\u6A40;\uC000\u2229\uFE00\u0100eo\u19E2\u19E5t;\u6041\xEE\u0693\u0200aeiu\u19F0\u19FB\u1A01\u1A05\u01F0\u19F5\0\u19F8s;\u6A4Don;\u410Ddil\u803B\xE7\u40E7rc;\u4109ps\u0100;s\u1A0C\u1A0D\u6A4Cm;\u6A50ot;\u410B\u0180dmn\u1A1B\u1A20\u1A26il\u80BB\xB8\u01ADptyv;\u69B2t\u8100\xA2;e\u1A2D\u1A2E\u40A2r\xE4\u01B2r;\uC000\u{1D520}\u0180cei\u1A3D\u1A40\u1A4Dy;\u4447ck\u0100;m\u1A47\u1A48\u6713ark\xBB\u1A48;\u43C7r\u0380;Ecefms\u1A5F\u1A60\u1A62\u1A6B\u1AA4\u1AAA\u1AAE\u65CB;\u69C3\u0180;el\u1A69\u1A6A\u1A6D\u42C6q;\u6257e\u0261\u1A74\0\0\u1A88rrow\u0100lr\u1A7C\u1A81eft;\u61BAight;\u61BB\u0280RSacd\u1A92\u1A94\u1A96\u1A9A\u1A9F\xBB\u0F47;\u64C8st;\u629Birc;\u629Aash;\u629Dnint;\u6A10id;\u6AEFcir;\u69C2ubs\u0100;u\u1ABB\u1ABC\u6663it\xBB\u1ABC\u02EC\u1AC7\u1AD4\u1AFA\0\u1B0Aon\u0100;e\u1ACD\u1ACE\u403A\u0100;q\xC7\xC6\u026D\u1AD9\0\0\u1AE2a\u0100;t\u1ADE\u1ADF\u402C;\u4040\u0180;fl\u1AE8\u1AE9\u1AEB\u6201\xEE\u1160e\u0100mx\u1AF1\u1AF6ent\xBB\u1AE9e\xF3\u024D\u01E7\u1AFE\0\u1B07\u0100;d\u12BB\u1B02ot;\u6A6Dn\xF4\u0246\u0180fry\u1B10\u1B14\u1B17;\uC000\u{1D554}o\xE4\u0254\u8100\xA9;s\u0155\u1B1Dr;\u6117\u0100ao\u1B25\u1B29rr;\u61B5ss;\u6717\u0100cu\u1B32\u1B37r;\uC000\u{1D4B8}\u0100bp\u1B3C\u1B44\u0100;e\u1B41\u1B42\u6ACF;\u6AD1\u0100;e\u1B49\u1B4A\u6AD0;\u6AD2dot;\u62EF\u0380delprvw\u1B60\u1B6C\u1B77\u1B82\u1BAC\u1BD4\u1BF9arr\u0100lr\u1B68\u1B6A;\u6938;\u6935\u0270\u1B72\0\0\u1B75r;\u62DEc;\u62DFarr\u0100;p\u1B7F\u1B80\u61B6;\u693D\u0300;bcdos\u1B8F\u1B90\u1B96\u1BA1\u1BA5\u1BA8\u622Arcap;\u6A48\u0100au\u1B9B\u1B9Ep;\u6A46p;\u6A4Aot;\u628Dr;\u6A45;\uC000\u222A\uFE00\u0200alrv\u1BB5\u1BBF\u1BDE\u1BE3rr\u0100;m\u1BBC\u1BBD\u61B7;\u693Cy\u0180evw\u1BC7\u1BD4\u1BD8q\u0270\u1BCE\0\0\u1BD2re\xE3\u1B73u\xE3\u1B75ee;\u62CEedge;\u62CFen\u803B\xA4\u40A4earrow\u0100lr\u1BEE\u1BF3eft\xBB\u1B80ight\xBB\u1BBDe\xE4\u1BDD\u0100ci\u1C01\u1C07onin\xF4\u01F7nt;\u6231lcty;\u632D\u0980AHabcdefhijlorstuwz\u1C38\u1C3B\u1C3F\u1C5D\u1C69\u1C75\u1C8A\u1C9E\u1CAC\u1CB7\u1CFB\u1CFF\u1D0D\u1D7B\u1D91\u1DAB\u1DBB\u1DC6\u1DCDr\xF2\u0381ar;\u6965\u0200glrs\u1C48\u1C4D\u1C52\u1C54ger;\u6020eth;\u6138\xF2\u1133h\u0100;v\u1C5A\u1C5B\u6010\xBB\u090A\u016B\u1C61\u1C67arow;\u690Fa\xE3\u0315\u0100ay\u1C6E\u1C73ron;\u410F;\u4434\u0180;ao\u0332\u1C7C\u1C84\u0100gr\u02BF\u1C81r;\u61CAtseq;\u6A77\u0180glm\u1C91\u1C94\u1C98\u803B\xB0\u40B0ta;\u43B4ptyv;\u69B1\u0100ir\u1CA3\u1CA8sht;\u697F;\uC000\u{1D521}ar\u0100lr\u1CB3\u1CB5\xBB\u08DC\xBB\u101E\u0280aegsv\u1CC2\u0378\u1CD6\u1CDC\u1CE0m\u0180;os\u0326\u1CCA\u1CD4nd\u0100;s\u0326\u1CD1uit;\u6666amma;\u43DDin;\u62F2\u0180;io\u1CE7\u1CE8\u1CF8\u40F7de\u8100\xF7;o\u1CE7\u1CF0ntimes;\u62C7n\xF8\u1CF7cy;\u4452c\u026F\u1D06\0\0\u1D0Arn;\u631Eop;\u630D\u0280lptuw\u1D18\u1D1D\u1D22\u1D49\u1D55lar;\u4024f;\uC000\u{1D555}\u0280;emps\u030B\u1D2D\u1D37\u1D3D\u1D42q\u0100;d\u0352\u1D33ot;\u6251inus;\u6238lus;\u6214quare;\u62A1blebarwedg\xE5\xFAn\u0180adh\u112E\u1D5D\u1D67ownarrow\xF3\u1C83arpoon\u0100lr\u1D72\u1D76ef\xF4\u1CB4igh\xF4\u1CB6\u0162\u1D7F\u1D85karo\xF7\u0F42\u026F\u1D8A\0\0\u1D8Ern;\u631Fop;\u630C\u0180cot\u1D98\u1DA3\u1DA6\u0100ry\u1D9D\u1DA1;\uC000\u{1D4B9};\u4455l;\u69F6rok;\u4111\u0100dr\u1DB0\u1DB4ot;\u62F1i\u0100;f\u1DBA\u1816\u65BF\u0100ah\u1DC0\u1DC3r\xF2\u0429a\xF2\u0FA6angle;\u69A6\u0100ci\u1DD2\u1DD5y;\u445Fgrarr;\u67FF\u0900Dacdefglmnopqrstux\u1E01\u1E09\u1E19\u1E38\u0578\u1E3C\u1E49\u1E61\u1E7E\u1EA5\u1EAF\u1EBD\u1EE1\u1F2A\u1F37\u1F44\u1F4E\u1F5A\u0100Do\u1E06\u1D34o\xF4\u1C89\u0100cs\u1E0E\u1E14ute\u803B\xE9\u40E9ter;\u6A6E\u0200aioy\u1E22\u1E27\u1E31\u1E36ron;\u411Br\u0100;c\u1E2D\u1E2E\u6256\u803B\xEA\u40EAlon;\u6255;\u444Dot;\u4117\u0100Dr\u1E41\u1E45ot;\u6252;\uC000\u{1D522}\u0180;rs\u1E50\u1E51\u1E57\u6A9Aave\u803B\xE8\u40E8\u0100;d\u1E5C\u1E5D\u6A96ot;\u6A98\u0200;ils\u1E6A\u1E6B\u1E72\u1E74\u6A99nters;\u63E7;\u6113\u0100;d\u1E79\u1E7A\u6A95ot;\u6A97\u0180aps\u1E85\u1E89\u1E97cr;\u4113ty\u0180;sv\u1E92\u1E93\u1E95\u6205et\xBB\u1E93p\u01001;\u1E9D\u1EA4\u0133\u1EA1\u1EA3;\u6004;\u6005\u6003\u0100gs\u1EAA\u1EAC;\u414Bp;\u6002\u0100gp\u1EB4\u1EB8on;\u4119f;\uC000\u{1D556}\u0180als\u1EC4\u1ECE\u1ED2r\u0100;s\u1ECA\u1ECB\u62D5l;\u69E3us;\u6A71i\u0180;lv\u1EDA\u1EDB\u1EDF\u43B5on\xBB\u1EDB;\u43F5\u0200csuv\u1EEA\u1EF3\u1F0B\u1F23\u0100io\u1EEF\u1E31rc\xBB\u1E2E\u0269\u1EF9\0\0\u1EFB\xED\u0548ant\u0100gl\u1F02\u1F06tr\xBB\u1E5Dess\xBB\u1E7A\u0180aei\u1F12\u1F16\u1F1Als;\u403Dst;\u625Fv\u0100;D\u0235\u1F20D;\u6A78parsl;\u69E5\u0100Da\u1F2F\u1F33ot;\u6253rr;\u6971\u0180cdi\u1F3E\u1F41\u1EF8r;\u612Fo\xF4\u0352\u0100ah\u1F49\u1F4B;\u43B7\u803B\xF0\u40F0\u0100mr\u1F53\u1F57l\u803B\xEB\u40EBo;\u60AC\u0180cip\u1F61\u1F64\u1F67l;\u4021s\xF4\u056E\u0100eo\u1F6C\u1F74ctatio\xEE\u0559nential\xE5\u0579\u09E1\u1F92\0\u1F9E\0\u1FA1\u1FA7\0\0\u1FC6\u1FCC\0\u1FD3\0\u1FE6\u1FEA\u2000\0\u2008\u205Allingdotse\xF1\u1E44y;\u4444male;\u6640\u0180ilr\u1FAD\u1FB3\u1FC1lig;\u8000\uFB03\u0269\u1FB9\0\0\u1FBDg;\u8000\uFB00ig;\u8000\uFB04;\uC000\u{1D523}lig;\u8000\uFB01lig;\uC000fj\u0180alt\u1FD9\u1FDC\u1FE1t;\u666Dig;\u8000\uFB02ns;\u65B1of;\u4192\u01F0\u1FEE\0\u1FF3f;\uC000\u{1D557}\u0100ak\u05BF\u1FF7\u0100;v\u1FFC\u1FFD\u62D4;\u6AD9artint;\u6A0D\u0100ao\u200C\u2055\u0100cs\u2011\u2052\u03B1\u201A\u2030\u2038\u2045\u2048\0\u2050\u03B2\u2022\u2025\u2027\u202A\u202C\0\u202E\u803B\xBD\u40BD;\u6153\u803B\xBC\u40BC;\u6155;\u6159;\u615B\u01B3\u2034\0\u2036;\u6154;\u6156\u02B4\u203E\u2041\0\0\u2043\u803B\xBE\u40BE;\u6157;\u615C5;\u6158\u01B6\u204C\0\u204E;\u615A;\u615D8;\u615El;\u6044wn;\u6322cr;\uC000\u{1D4BB}\u0880Eabcdefgijlnorstv\u2082\u2089\u209F\u20A5\u20B0\u20B4\u20F0\u20F5\u20FA\u20FF\u2103\u2112\u2138\u0317\u213E\u2152\u219E\u0100;l\u064D\u2087;\u6A8C\u0180cmp\u2090\u2095\u209Dute;\u41F5ma\u0100;d\u209C\u1CDA\u43B3;\u6A86reve;\u411F\u0100iy\u20AA\u20AErc;\u411D;\u4433ot;\u4121\u0200;lqs\u063E\u0642\u20BD\u20C9\u0180;qs\u063E\u064C\u20C4lan\xF4\u0665\u0200;cdl\u0665\u20D2\u20D5\u20E5c;\u6AA9ot\u0100;o\u20DC\u20DD\u6A80\u0100;l\u20E2\u20E3\u6A82;\u6A84\u0100;e\u20EA\u20ED\uC000\u22DB\uFE00s;\u6A94r;\uC000\u{1D524}\u0100;g\u0673\u061Bmel;\u6137cy;\u4453\u0200;Eaj\u065A\u210C\u210E\u2110;\u6A92;\u6AA5;\u6AA4\u0200Eaes\u211B\u211D\u2129\u2134;\u6269p\u0100;p\u2123\u2124\u6A8Arox\xBB\u2124\u0100;q\u212E\u212F\u6A88\u0100;q\u212E\u211Bim;\u62E7pf;\uC000\u{1D558}\u0100ci\u2143\u2146r;\u610Am\u0180;el\u066B\u214E\u2150;\u6A8E;\u6A90\u8300>;cdlqr\u05EE\u2160\u216A\u216E\u2173\u2179\u0100ci\u2165\u2167;\u6AA7r;\u6A7Aot;\u62D7Par;\u6995uest;\u6A7C\u0280adels\u2184\u216A\u2190\u0656\u219B\u01F0\u2189\0\u218Epro\xF8\u209Er;\u6978q\u0100lq\u063F\u2196les\xF3\u2088i\xED\u066B\u0100en\u21A3\u21ADrtneqq;\uC000\u2269\uFE00\xC5\u21AA\u0500Aabcefkosy\u21C4\u21C7\u21F1\u21F5\u21FA\u2218\u221D\u222F\u2268\u227Dr\xF2\u03A0\u0200ilmr\u21D0\u21D4\u21D7\u21DBrs\xF0\u1484f\xBB\u2024il\xF4\u06A9\u0100dr\u21E0\u21E4cy;\u444A\u0180;cw\u08F4\u21EB\u21EFir;\u6948;\u61ADar;\u610Firc;\u4125\u0180alr\u2201\u220E\u2213rts\u0100;u\u2209\u220A\u6665it\xBB\u220Alip;\u6026con;\u62B9r;\uC000\u{1D525}s\u0100ew\u2223\u2229arow;\u6925arow;\u6926\u0280amopr\u223A\u223E\u2243\u225E\u2263rr;\u61FFtht;\u623Bk\u0100lr\u2249\u2253eftarrow;\u61A9ightarrow;\u61AAf;\uC000\u{1D559}bar;\u6015\u0180clt\u226F\u2274\u2278r;\uC000\u{1D4BD}as\xE8\u21F4rok;\u4127\u0100bp\u2282\u2287ull;\u6043hen\xBB\u1C5B\u0AE1\u22A3\0\u22AA\0\u22B8\u22C5\u22CE\0\u22D5\u22F3\0\0\u22F8\u2322\u2367\u2362\u237F\0\u2386\u23AA\u23B4cute\u803B\xED\u40ED\u0180;iy\u0771\u22B0\u22B5rc\u803B\xEE\u40EE;\u4438\u0100cx\u22BC\u22BFy;\u4435cl\u803B\xA1\u40A1\u0100fr\u039F\u22C9;\uC000\u{1D526}rave\u803B\xEC\u40EC\u0200;ino\u073E\u22DD\u22E9\u22EE\u0100in\u22E2\u22E6nt;\u6A0Ct;\u622Dfin;\u69DCta;\u6129lig;\u4133\u0180aop\u22FE\u231A\u231D\u0180cgt\u2305\u2308\u2317r;\u412B\u0180elp\u071F\u230F\u2313in\xE5\u078Ear\xF4\u0720h;\u4131f;\u62B7ed;\u41B5\u0280;cfot\u04F4\u232C\u2331\u233D\u2341are;\u6105in\u0100;t\u2338\u2339\u621Eie;\u69DDdo\xF4\u2319\u0280;celp\u0757\u234C\u2350\u235B\u2361al;\u62BA\u0100gr\u2355\u2359er\xF3\u1563\xE3\u234Darhk;\u6A17rod;\u6A3C\u0200cgpt\u236F\u2372\u2376\u237By;\u4451on;\u412Ff;\uC000\u{1D55A}a;\u43B9uest\u803B\xBF\u40BF\u0100ci\u238A\u238Fr;\uC000\u{1D4BE}n\u0280;Edsv\u04F4\u239B\u239D\u23A1\u04F3;\u62F9ot;\u62F5\u0100;v\u23A6\u23A7\u62F4;\u62F3\u0100;i\u0777\u23AElde;\u4129\u01EB\u23B8\0\u23BCcy;\u4456l\u803B\xEF\u40EF\u0300cfmosu\u23CC\u23D7\u23DC\u23E1\u23E7\u23F5\u0100iy\u23D1\u23D5rc;\u4135;\u4439r;\uC000\u{1D527}ath;\u4237pf;\uC000\u{1D55B}\u01E3\u23EC\0\u23F1r;\uC000\u{1D4BF}rcy;\u4458kcy;\u4454\u0400acfghjos\u240B\u2416\u2422\u2427\u242D\u2431\u2435\u243Bppa\u0100;v\u2413\u2414\u43BA;\u43F0\u0100ey\u241B\u2420dil;\u4137;\u443Ar;\uC000\u{1D528}reen;\u4138cy;\u4445cy;\u445Cpf;\uC000\u{1D55C}cr;\uC000\u{1D4C0}\u0B80ABEHabcdefghjlmnoprstuv\u2470\u2481\u2486\u248D\u2491\u250E\u253D\u255A\u2580\u264E\u265E\u2665\u2679\u267D\u269A\u26B2\u26D8\u275D\u2768\u278B\u27C0\u2801\u2812\u0180art\u2477\u247A\u247Cr\xF2\u09C6\xF2\u0395ail;\u691Barr;\u690E\u0100;g\u0994\u248B;\u6A8Bar;\u6962\u0963\u24A5\0\u24AA\0\u24B1\0\0\0\0\0\u24B5\u24BA\0\u24C6\u24C8\u24CD\0\u24F9ute;\u413Amptyv;\u69B4ra\xEE\u084Cbda;\u43BBg\u0180;dl\u088E\u24C1\u24C3;\u6991\xE5\u088E;\u6A85uo\u803B\xAB\u40ABr\u0400;bfhlpst\u0899\u24DE\u24E6\u24E9\u24EB\u24EE\u24F1\u24F5\u0100;f\u089D\u24E3s;\u691Fs;\u691D\xEB\u2252p;\u61ABl;\u6939im;\u6973l;\u61A2\u0180;ae\u24FF\u2500\u2504\u6AABil;\u6919\u0100;s\u2509\u250A\u6AAD;\uC000\u2AAD\uFE00\u0180abr\u2515\u2519\u251Drr;\u690Crk;\u6772\u0100ak\u2522\u252Cc\u0100ek\u2528\u252A;\u407B;\u405B\u0100es\u2531\u2533;\u698Bl\u0100du\u2539\u253B;\u698F;\u698D\u0200aeuy\u2546\u254B\u2556\u2558ron;\u413E\u0100di\u2550\u2554il;\u413C\xEC\u08B0\xE2\u2529;\u443B\u0200cqrs\u2563\u2566\u256D\u257Da;\u6936uo\u0100;r\u0E19\u1746\u0100du\u2572\u2577har;\u6967shar;\u694Bh;\u61B2\u0280;fgqs\u258B\u258C\u0989\u25F3\u25FF\u6264t\u0280ahlrt\u2598\u25A4\u25B7\u25C2\u25E8rrow\u0100;t\u0899\u25A1a\xE9\u24F6arpoon\u0100du\u25AF\u25B4own\xBB\u045Ap\xBB\u0966eftarrows;\u61C7ight\u0180ahs\u25CD\u25D6\u25DErrow\u0100;s\u08F4\u08A7arpoon\xF3\u0F98quigarro\xF7\u21F0hreetimes;\u62CB\u0180;qs\u258B\u0993\u25FAlan\xF4\u09AC\u0280;cdgs\u09AC\u260A\u260D\u261D\u2628c;\u6AA8ot\u0100;o\u2614\u2615\u6A7F\u0100;r\u261A\u261B\u6A81;\u6A83\u0100;e\u2622\u2625\uC000\u22DA\uFE00s;\u6A93\u0280adegs\u2633\u2639\u263D\u2649\u264Bppro\xF8\u24C6ot;\u62D6q\u0100gq\u2643\u2645\xF4\u0989gt\xF2\u248C\xF4\u099Bi\xED\u09B2\u0180ilr\u2655\u08E1\u265Asht;\u697C;\uC000\u{1D529}\u0100;E\u099C\u2663;\u6A91\u0161\u2669\u2676r\u0100du\u25B2\u266E\u0100;l\u0965\u2673;\u696Alk;\u6584cy;\u4459\u0280;acht\u0A48\u2688\u268B\u2691\u2696r\xF2\u25C1orne\xF2\u1D08ard;\u696Bri;\u65FA\u0100io\u269F\u26A4dot;\u4140ust\u0100;a\u26AC\u26AD\u63B0che\xBB\u26AD\u0200Eaes\u26BB\u26BD\u26C9\u26D4;\u6268p\u0100;p\u26C3\u26C4\u6A89rox\xBB\u26C4\u0100;q\u26CE\u26CF\u6A87\u0100;q\u26CE\u26BBim;\u62E6\u0400abnoptwz\u26E9\u26F4\u26F7\u271A\u272F\u2741\u2747\u2750\u0100nr\u26EE\u26F1g;\u67ECr;\u61FDr\xEB\u08C1g\u0180lmr\u26FF\u270D\u2714eft\u0100ar\u09E6\u2707ight\xE1\u09F2apsto;\u67FCight\xE1\u09FDparrow\u0100lr\u2725\u2729ef\xF4\u24EDight;\u61AC\u0180afl\u2736\u2739\u273Dr;\u6985;\uC000\u{1D55D}us;\u6A2Dimes;\u6A34\u0161\u274B\u274Fst;\u6217\xE1\u134E\u0180;ef\u2757\u2758\u1800\u65CAnge\xBB\u2758ar\u0100;l\u2764\u2765\u4028t;\u6993\u0280achmt\u2773\u2776\u277C\u2785\u2787r\xF2\u08A8orne\xF2\u1D8Car\u0100;d\u0F98\u2783;\u696D;\u600Eri;\u62BF\u0300achiqt\u2798\u279D\u0A40\u27A2\u27AE\u27BBquo;\u6039r;\uC000\u{1D4C1}m\u0180;eg\u09B2\u27AA\u27AC;\u6A8D;\u6A8F\u0100bu\u252A\u27B3o\u0100;r\u0E1F\u27B9;\u601Arok;\u4142\u8400<;cdhilqr\u082B\u27D2\u2639\u27DC\u27E0\u27E5\u27EA\u27F0\u0100ci\u27D7\u27D9;\u6AA6r;\u6A79re\xE5\u25F2mes;\u62C9arr;\u6976uest;\u6A7B\u0100Pi\u27F5\u27F9ar;\u6996\u0180;ef\u2800\u092D\u181B\u65C3r\u0100du\u2807\u280Dshar;\u694Ahar;\u6966\u0100en\u2817\u2821rtneqq;\uC000\u2268\uFE00\xC5\u281E\u0700Dacdefhilnopsu\u2840\u2845\u2882\u288E\u2893\u28A0\u28A5\u28A8\u28DA\u28E2\u28E4\u0A83\u28F3\u2902Dot;\u623A\u0200clpr\u284E\u2852\u2863\u287Dr\u803B\xAF\u40AF\u0100et\u2857\u2859;\u6642\u0100;e\u285E\u285F\u6720se\xBB\u285F\u0100;s\u103B\u2868to\u0200;dlu\u103B\u2873\u2877\u287Bow\xEE\u048Cef\xF4\u090F\xF0\u13D1ker;\u65AE\u0100oy\u2887\u288Cmma;\u6A29;\u443Cash;\u6014asuredangle\xBB\u1626r;\uC000\u{1D52A}o;\u6127\u0180cdn\u28AF\u28B4\u28C9ro\u803B\xB5\u40B5\u0200;acd\u1464\u28BD\u28C0\u28C4s\xF4\u16A7ir;\u6AF0ot\u80BB\xB7\u01B5us\u0180;bd\u28D2\u1903\u28D3\u6212\u0100;u\u1D3C\u28D8;\u6A2A\u0163\u28DE\u28E1p;\u6ADB\xF2\u2212\xF0\u0A81\u0100dp\u28E9\u28EEels;\u62A7f;\uC000\u{1D55E}\u0100ct\u28F8\u28FDr;\uC000\u{1D4C2}pos\xBB\u159D\u0180;lm\u2909\u290A\u290D\u43BCtimap;\u62B8\u0C00GLRVabcdefghijlmoprstuvw\u2942\u2953\u297E\u2989\u2998\u29DA\u29E9\u2A15\u2A1A\u2A58\u2A5D\u2A83\u2A95\u2AA4\u2AA8\u2B04\u2B07\u2B44\u2B7F\u2BAE\u2C34\u2C67\u2C7C\u2CE9\u0100gt\u2947\u294B;\uC000\u22D9\u0338\u0100;v\u2950\u0BCF\uC000\u226B\u20D2\u0180elt\u295A\u2972\u2976ft\u0100ar\u2961\u2967rrow;\u61CDightarrow;\u61CE;\uC000\u22D8\u0338\u0100;v\u297B\u0C47\uC000\u226A\u20D2ightarrow;\u61CF\u0100Dd\u298E\u2993ash;\u62AFash;\u62AE\u0280bcnpt\u29A3\u29A7\u29AC\u29B1\u29CCla\xBB\u02DEute;\u4144g;\uC000\u2220\u20D2\u0280;Eiop\u0D84\u29BC\u29C0\u29C5\u29C8;\uC000\u2A70\u0338d;\uC000\u224B\u0338s;\u4149ro\xF8\u0D84ur\u0100;a\u29D3\u29D4\u666El\u0100;s\u29D3\u0B38\u01F3\u29DF\0\u29E3p\u80BB\xA0\u0B37mp\u0100;e\u0BF9\u0C00\u0280aeouy\u29F4\u29FE\u2A03\u2A10\u2A13\u01F0\u29F9\0\u29FB;\u6A43on;\u4148dil;\u4146ng\u0100;d\u0D7E\u2A0Aot;\uC000\u2A6D\u0338p;\u6A42;\u443Dash;\u6013\u0380;Aadqsx\u0B92\u2A29\u2A2D\u2A3B\u2A41\u2A45\u2A50rr;\u61D7r\u0100hr\u2A33\u2A36k;\u6924\u0100;o\u13F2\u13F0ot;\uC000\u2250\u0338ui\xF6\u0B63\u0100ei\u2A4A\u2A4Ear;\u6928\xED\u0B98ist\u0100;s\u0BA0\u0B9Fr;\uC000\u{1D52B}\u0200Eest\u0BC5\u2A66\u2A79\u2A7C\u0180;qs\u0BBC\u2A6D\u0BE1\u0180;qs\u0BBC\u0BC5\u2A74lan\xF4\u0BE2i\xED\u0BEA\u0100;r\u0BB6\u2A81\xBB\u0BB7\u0180Aap\u2A8A\u2A8D\u2A91r\xF2\u2971rr;\u61AEar;\u6AF2\u0180;sv\u0F8D\u2A9C\u0F8C\u0100;d\u2AA1\u2AA2\u62FC;\u62FAcy;\u445A\u0380AEadest\u2AB7\u2ABA\u2ABE\u2AC2\u2AC5\u2AF6\u2AF9r\xF2\u2966;\uC000\u2266\u0338rr;\u619Ar;\u6025\u0200;fqs\u0C3B\u2ACE\u2AE3\u2AEFt\u0100ar\u2AD4\u2AD9rro\xF7\u2AC1ightarro\xF7\u2A90\u0180;qs\u0C3B\u2ABA\u2AEAlan\xF4\u0C55\u0100;s\u0C55\u2AF4\xBB\u0C36i\xED\u0C5D\u0100;r\u0C35\u2AFEi\u0100;e\u0C1A\u0C25i\xE4\u0D90\u0100pt\u2B0C\u2B11f;\uC000\u{1D55F}\u8180\xAC;in\u2B19\u2B1A\u2B36\u40ACn\u0200;Edv\u0B89\u2B24\u2B28\u2B2E;\uC000\u22F9\u0338ot;\uC000\u22F5\u0338\u01E1\u0B89\u2B33\u2B35;\u62F7;\u62F6i\u0100;v\u0CB8\u2B3C\u01E1\u0CB8\u2B41\u2B43;\u62FE;\u62FD\u0180aor\u2B4B\u2B63\u2B69r\u0200;ast\u0B7B\u2B55\u2B5A\u2B5Flle\xEC\u0B7Bl;\uC000\u2AFD\u20E5;\uC000\u2202\u0338lint;\u6A14\u0180;ce\u0C92\u2B70\u2B73u\xE5\u0CA5\u0100;c\u0C98\u2B78\u0100;e\u0C92\u2B7D\xF1\u0C98\u0200Aait\u2B88\u2B8B\u2B9D\u2BA7r\xF2\u2988rr\u0180;cw\u2B94\u2B95\u2B99\u619B;\uC000\u2933\u0338;\uC000\u219D\u0338ghtarrow\xBB\u2B95ri\u0100;e\u0CCB\u0CD6\u0380chimpqu\u2BBD\u2BCD\u2BD9\u2B04\u0B78\u2BE4\u2BEF\u0200;cer\u0D32\u2BC6\u0D37\u2BC9u\xE5\u0D45;\uC000\u{1D4C3}ort\u026D\u2B05\0\0\u2BD6ar\xE1\u2B56m\u0100;e\u0D6E\u2BDF\u0100;q\u0D74\u0D73su\u0100bp\u2BEB\u2BED\xE5\u0CF8\xE5\u0D0B\u0180bcp\u2BF6\u2C11\u2C19\u0200;Ees\u2BFF\u2C00\u0D22\u2C04\u6284;\uC000\u2AC5\u0338et\u0100;e\u0D1B\u2C0Bq\u0100;q\u0D23\u2C00c\u0100;e\u0D32\u2C17\xF1\u0D38\u0200;Ees\u2C22\u2C23\u0D5F\u2C27\u6285;\uC000\u2AC6\u0338et\u0100;e\u0D58\u2C2Eq\u0100;q\u0D60\u2C23\u0200gilr\u2C3D\u2C3F\u2C45\u2C47\xEC\u0BD7lde\u803B\xF1\u40F1\xE7\u0C43iangle\u0100lr\u2C52\u2C5Ceft\u0100;e\u0C1A\u2C5A\xF1\u0C26ight\u0100;e\u0CCB\u2C65\xF1\u0CD7\u0100;m\u2C6C\u2C6D\u43BD\u0180;es\u2C74\u2C75\u2C79\u4023ro;\u6116p;\u6007\u0480DHadgilrs\u2C8F\u2C94\u2C99\u2C9E\u2CA3\u2CB0\u2CB6\u2CD3\u2CE3ash;\u62ADarr;\u6904p;\uC000\u224D\u20D2ash;\u62AC\u0100et\u2CA8\u2CAC;\uC000\u2265\u20D2;\uC000>\u20D2nfin;\u69DE\u0180Aet\u2CBD\u2CC1\u2CC5rr;\u6902;\uC000\u2264\u20D2\u0100;r\u2CCA\u2CCD\uC000<\u20D2ie;\uC000\u22B4\u20D2\u0100At\u2CD8\u2CDCrr;\u6903rie;\uC000\u22B5\u20D2im;\uC000\u223C\u20D2\u0180Aan\u2CF0\u2CF4\u2D02rr;\u61D6r\u0100hr\u2CFA\u2CFDk;\u6923\u0100;o\u13E7\u13E5ear;\u6927\u1253\u1A95\0\0\0\0\0\0\0\0\0\0\0\0\0\u2D2D\0\u2D38\u2D48\u2D60\u2D65\u2D72\u2D84\u1B07\0\0\u2D8D\u2DAB\0\u2DC8\u2DCE\0\u2DDC\u2E19\u2E2B\u2E3E\u2E43\u0100cs\u2D31\u1A97ute\u803B\xF3\u40F3\u0100iy\u2D3C\u2D45r\u0100;c\u1A9E\u2D42\u803B\xF4\u40F4;\u443E\u0280abios\u1AA0\u2D52\u2D57\u01C8\u2D5Alac;\u4151v;\u6A38old;\u69BClig;\u4153\u0100cr\u2D69\u2D6Dir;\u69BF;\uC000\u{1D52C}\u036F\u2D79\0\0\u2D7C\0\u2D82n;\u42DBave\u803B\xF2\u40F2;\u69C1\u0100bm\u2D88\u0DF4ar;\u69B5\u0200acit\u2D95\u2D98\u2DA5\u2DA8r\xF2\u1A80\u0100ir\u2D9D\u2DA0r;\u69BEoss;\u69BBn\xE5\u0E52;\u69C0\u0180aei\u2DB1\u2DB5\u2DB9cr;\u414Dga;\u43C9\u0180cdn\u2DC0\u2DC5\u01CDron;\u43BF;\u69B6pf;\uC000\u{1D560}\u0180ael\u2DD4\u2DD7\u01D2r;\u69B7rp;\u69B9\u0380;adiosv\u2DEA\u2DEB\u2DEE\u2E08\u2E0D\u2E10\u2E16\u6228r\xF2\u1A86\u0200;efm\u2DF7\u2DF8\u2E02\u2E05\u6A5Dr\u0100;o\u2DFE\u2DFF\u6134f\xBB\u2DFF\u803B\xAA\u40AA\u803B\xBA\u40BAgof;\u62B6r;\u6A56lope;\u6A57;\u6A5B\u0180clo\u2E1F\u2E21\u2E27\xF2\u2E01ash\u803B\xF8\u40F8l;\u6298i\u016C\u2E2F\u2E34de\u803B\xF5\u40F5es\u0100;a\u01DB\u2E3As;\u6A36ml\u803B\xF6\u40F6bar;\u633D\u0AE1\u2E5E\0\u2E7D\0\u2E80\u2E9D\0\u2EA2\u2EB9\0\0\u2ECB\u0E9C\0\u2F13\0\0\u2F2B\u2FBC\0\u2FC8r\u0200;ast\u0403\u2E67\u2E72\u0E85\u8100\xB6;l\u2E6D\u2E6E\u40B6le\xEC\u0403\u0269\u2E78\0\0\u2E7Bm;\u6AF3;\u6AFDy;\u443Fr\u0280cimpt\u2E8B\u2E8F\u2E93\u1865\u2E97nt;\u4025od;\u402Eil;\u6030enk;\u6031r;\uC000\u{1D52D}\u0180imo\u2EA8\u2EB0\u2EB4\u0100;v\u2EAD\u2EAE\u43C6;\u43D5ma\xF4\u0A76ne;\u660E\u0180;tv\u2EBF\u2EC0\u2EC8\u43C0chfork\xBB\u1FFD;\u43D6\u0100au\u2ECF\u2EDFn\u0100ck\u2ED5\u2EDDk\u0100;h\u21F4\u2EDB;\u610E\xF6\u21F4s\u0480;abcdemst\u2EF3\u2EF4\u1908\u2EF9\u2EFD\u2F04\u2F06\u2F0A\u2F0E\u402Bcir;\u6A23ir;\u6A22\u0100ou\u1D40\u2F02;\u6A25;\u6A72n\u80BB\xB1\u0E9Dim;\u6A26wo;\u6A27\u0180ipu\u2F19\u2F20\u2F25ntint;\u6A15f;\uC000\u{1D561}nd\u803B\xA3\u40A3\u0500;Eaceinosu\u0EC8\u2F3F\u2F41\u2F44\u2F47\u2F81\u2F89\u2F92\u2F7E\u2FB6;\u6AB3p;\u6AB7u\xE5\u0ED9\u0100;c\u0ECE\u2F4C\u0300;acens\u0EC8\u2F59\u2F5F\u2F66\u2F68\u2F7Eppro\xF8\u2F43urlye\xF1\u0ED9\xF1\u0ECE\u0180aes\u2F6F\u2F76\u2F7Approx;\u6AB9qq;\u6AB5im;\u62E8i\xED\u0EDFme\u0100;s\u2F88\u0EAE\u6032\u0180Eas\u2F78\u2F90\u2F7A\xF0\u2F75\u0180dfp\u0EEC\u2F99\u2FAF\u0180als\u2FA0\u2FA5\u2FAAlar;\u632Eine;\u6312urf;\u6313\u0100;t\u0EFB\u2FB4\xEF\u0EFBrel;\u62B0\u0100ci\u2FC0\u2FC5r;\uC000\u{1D4C5};\u43C8ncsp;\u6008\u0300fiopsu\u2FDA\u22E2\u2FDF\u2FE5\u2FEB\u2FF1r;\uC000\u{1D52E}pf;\uC000\u{1D562}rime;\u6057cr;\uC000\u{1D4C6}\u0180aeo\u2FF8\u3009\u3013t\u0100ei\u2FFE\u3005rnion\xF3\u06B0nt;\u6A16st\u0100;e\u3010\u3011\u403F\xF1\u1F19\xF4\u0F14\u0A80ABHabcdefhilmnoprstux\u3040\u3051\u3055\u3059\u30E0\u310E\u312B\u3147\u3162\u3172\u318E\u3206\u3215\u3224\u3229\u3258\u326E\u3272\u3290\u32B0\u32B7\u0180art\u3047\u304A\u304Cr\xF2\u10B3\xF2\u03DDail;\u691Car\xF2\u1C65ar;\u6964\u0380cdenqrt\u3068\u3075\u3078\u307F\u308F\u3094\u30CC\u0100eu\u306D\u3071;\uC000\u223D\u0331te;\u4155i\xE3\u116Emptyv;\u69B3g\u0200;del\u0FD1\u3089\u308B\u308D;\u6992;\u69A5\xE5\u0FD1uo\u803B\xBB\u40BBr\u0580;abcfhlpstw\u0FDC\u30AC\u30AF\u30B7\u30B9\u30BC\u30BE\u30C0\u30C3\u30C7\u30CAp;\u6975\u0100;f\u0FE0\u30B4s;\u6920;\u6933s;\u691E\xEB\u225D\xF0\u272El;\u6945im;\u6974l;\u61A3;\u619D\u0100ai\u30D1\u30D5il;\u691Ao\u0100;n\u30DB\u30DC\u6236al\xF3\u0F1E\u0180abr\u30E7\u30EA\u30EEr\xF2\u17E5rk;\u6773\u0100ak\u30F3\u30FDc\u0100ek\u30F9\u30FB;\u407D;\u405D\u0100es\u3102\u3104;\u698Cl\u0100du\u310A\u310C;\u698E;\u6990\u0200aeuy\u3117\u311C\u3127\u3129ron;\u4159\u0100di\u3121\u3125il;\u4157\xEC\u0FF2\xE2\u30FA;\u4440\u0200clqs\u3134\u3137\u313D\u3144a;\u6937dhar;\u6969uo\u0100;r\u020E\u020Dh;\u61B3\u0180acg\u314E\u315F\u0F44l\u0200;ips\u0F78\u3158\u315B\u109Cn\xE5\u10BBar\xF4\u0FA9t;\u65AD\u0180ilr\u3169\u1023\u316Esht;\u697D;\uC000\u{1D52F}\u0100ao\u3177\u3186r\u0100du\u317D\u317F\xBB\u047B\u0100;l\u1091\u3184;\u696C\u0100;v\u318B\u318C\u43C1;\u43F1\u0180gns\u3195\u31F9\u31FCht\u0300ahlrst\u31A4\u31B0\u31C2\u31D8\u31E4\u31EErrow\u0100;t\u0FDC\u31ADa\xE9\u30C8arpoon\u0100du\u31BB\u31BFow\xEE\u317Ep\xBB\u1092eft\u0100ah\u31CA\u31D0rrow\xF3\u0FEAarpoon\xF3\u0551ightarrows;\u61C9quigarro\xF7\u30CBhreetimes;\u62CCg;\u42DAingdotse\xF1\u1F32\u0180ahm\u320D\u3210\u3213r\xF2\u0FEAa\xF2\u0551;\u600Foust\u0100;a\u321E\u321F\u63B1che\xBB\u321Fmid;\u6AEE\u0200abpt\u3232\u323D\u3240\u3252\u0100nr\u3237\u323Ag;\u67EDr;\u61FEr\xEB\u1003\u0180afl\u3247\u324A\u324Er;\u6986;\uC000\u{1D563}us;\u6A2Eimes;\u6A35\u0100ap\u325D\u3267r\u0100;g\u3263\u3264\u4029t;\u6994olint;\u6A12ar\xF2\u31E3\u0200achq\u327B\u3280\u10BC\u3285quo;\u603Ar;\uC000\u{1D4C7}\u0100bu\u30FB\u328Ao\u0100;r\u0214\u0213\u0180hir\u3297\u329B\u32A0re\xE5\u31F8mes;\u62CAi\u0200;efl\u32AA\u1059\u1821\u32AB\u65B9tri;\u69CEluhar;\u6968;\u611E\u0D61\u32D5\u32DB\u32DF\u332C\u3338\u3371\0\u337A\u33A4\0\0\u33EC\u33F0\0\u3428\u3448\u345A\u34AD\u34B1\u34CA\u34F1\0\u3616\0\0\u3633cute;\u415Bqu\xEF\u27BA\u0500;Eaceinpsy\u11ED\u32F3\u32F5\u32FF\u3302\u330B\u330F\u331F\u3326\u3329;\u6AB4\u01F0\u32FA\0\u32FC;\u6AB8on;\u4161u\xE5\u11FE\u0100;d\u11F3\u3307il;\u415Frc;\u415D\u0180Eas\u3316\u3318\u331B;\u6AB6p;\u6ABAim;\u62E9olint;\u6A13i\xED\u1204;\u4441ot\u0180;be\u3334\u1D47\u3335\u62C5;\u6A66\u0380Aacmstx\u3346\u334A\u3357\u335B\u335E\u3363\u336Drr;\u61D8r\u0100hr\u3350\u3352\xEB\u2228\u0100;o\u0A36\u0A34t\u803B\xA7\u40A7i;\u403Bwar;\u6929m\u0100in\u3369\xF0nu\xF3\xF1t;\u6736r\u0100;o\u3376\u2055\uC000\u{1D530}\u0200acoy\u3382\u3386\u3391\u33A0rp;\u666F\u0100hy\u338B\u338Fcy;\u4449;\u4448rt\u026D\u3399\0\0\u339Ci\xE4\u1464ara\xEC\u2E6F\u803B\xAD\u40AD\u0100gm\u33A8\u33B4ma\u0180;fv\u33B1\u33B2\u33B2\u43C3;\u43C2\u0400;deglnpr\u12AB\u33C5\u33C9\u33CE\u33D6\u33DE\u33E1\u33E6ot;\u6A6A\u0100;q\u12B1\u12B0\u0100;E\u33D3\u33D4\u6A9E;\u6AA0\u0100;E\u33DB\u33DC\u6A9D;\u6A9Fe;\u6246lus;\u6A24arr;\u6972ar\xF2\u113D\u0200aeit\u33F8\u3408\u340F\u3417\u0100ls\u33FD\u3404lsetm\xE9\u336Ahp;\u6A33parsl;\u69E4\u0100dl\u1463\u3414e;\u6323\u0100;e\u341C\u341D\u6AAA\u0100;s\u3422\u3423\u6AAC;\uC000\u2AAC\uFE00\u0180flp\u342E\u3433\u3442tcy;\u444C\u0100;b\u3438\u3439\u402F\u0100;a\u343E\u343F\u69C4r;\u633Ff;\uC000\u{1D564}a\u0100dr\u344D\u0402es\u0100;u\u3454\u3455\u6660it\xBB\u3455\u0180csu\u3460\u3479\u349F\u0100au\u3465\u346Fp\u0100;s\u1188\u346B;\uC000\u2293\uFE00p\u0100;s\u11B4\u3475;\uC000\u2294\uFE00u\u0100bp\u347F\u348F\u0180;es\u1197\u119C\u3486et\u0100;e\u1197\u348D\xF1\u119D\u0180;es\u11A8\u11AD\u3496et\u0100;e\u11A8\u349D\xF1\u11AE\u0180;af\u117B\u34A6\u05B0r\u0165\u34AB\u05B1\xBB\u117Car\xF2\u1148\u0200cemt\u34B9\u34BE\u34C2\u34C5r;\uC000\u{1D4C8}tm\xEE\xF1i\xEC\u3415ar\xE6\u11BE\u0100ar\u34CE\u34D5r\u0100;f\u34D4\u17BF\u6606\u0100an\u34DA\u34EDight\u0100ep\u34E3\u34EApsilo\xEE\u1EE0h\xE9\u2EAFs\xBB\u2852\u0280bcmnp\u34FB\u355E\u1209\u358B\u358E\u0480;Edemnprs\u350E\u350F\u3511\u3515\u351E\u3523\u352C\u3531\u3536\u6282;\u6AC5ot;\u6ABD\u0100;d\u11DA\u351Aot;\u6AC3ult;\u6AC1\u0100Ee\u3528\u352A;\u6ACB;\u628Alus;\u6ABFarr;\u6979\u0180eiu\u353D\u3552\u3555t\u0180;en\u350E\u3545\u354Bq\u0100;q\u11DA\u350Feq\u0100;q\u352B\u3528m;\u6AC7\u0100bp\u355A\u355C;\u6AD5;\u6AD3c\u0300;acens\u11ED\u356C\u3572\u3579\u357B\u3326ppro\xF8\u32FAurlye\xF1\u11FE\xF1\u11F3\u0180aes\u3582\u3588\u331Bppro\xF8\u331Aq\xF1\u3317g;\u666A\u0680123;Edehlmnps\u35A9\u35AC\u35AF\u121C\u35B2\u35B4\u35C0\u35C9\u35D5\u35DA\u35DF\u35E8\u35ED\u803B\xB9\u40B9\u803B\xB2\u40B2\u803B\xB3\u40B3;\u6AC6\u0100os\u35B9\u35BCt;\u6ABEub;\u6AD8\u0100;d\u1222\u35C5ot;\u6AC4s\u0100ou\u35CF\u35D2l;\u67C9b;\u6AD7arr;\u697Bult;\u6AC2\u0100Ee\u35E4\u35E6;\u6ACC;\u628Blus;\u6AC0\u0180eiu\u35F4\u3609\u360Ct\u0180;en\u121C\u35FC\u3602q\u0100;q\u1222\u35B2eq\u0100;q\u35E7\u35E4m;\u6AC8\u0100bp\u3611\u3613;\u6AD4;\u6AD6\u0180Aan\u361C\u3620\u362Drr;\u61D9r\u0100hr\u3626\u3628\xEB\u222E\u0100;o\u0A2B\u0A29war;\u692Alig\u803B\xDF\u40DF\u0BE1\u3651\u365D\u3660\u12CE\u3673\u3679\0\u367E\u36C2\0\0\0\0\0\u36DB\u3703\0\u3709\u376C\0\0\0\u3787\u0272\u3656\0\0\u365Bget;\u6316;\u43C4r\xEB\u0E5F\u0180aey\u3666\u366B\u3670ron;\u4165dil;\u4163;\u4442lrec;\u6315r;\uC000\u{1D531}\u0200eiko\u3686\u369D\u36B5\u36BC\u01F2\u368B\0\u3691e\u01004f\u1284\u1281a\u0180;sv\u3698\u3699\u369B\u43B8ym;\u43D1\u0100cn\u36A2\u36B2k\u0100as\u36A8\u36AEppro\xF8\u12C1im\xBB\u12ACs\xF0\u129E\u0100as\u36BA\u36AE\xF0\u12C1rn\u803B\xFE\u40FE\u01EC\u031F\u36C6\u22E7es\u8180\xD7;bd\u36CF\u36D0\u36D8\u40D7\u0100;a\u190F\u36D5r;\u6A31;\u6A30\u0180eps\u36E1\u36E3\u3700\xE1\u2A4D\u0200;bcf\u0486\u36EC\u36F0\u36F4ot;\u6336ir;\u6AF1\u0100;o\u36F9\u36FC\uC000\u{1D565}rk;\u6ADA\xE1\u3362rime;\u6034\u0180aip\u370F\u3712\u3764d\xE5\u1248\u0380adempst\u3721\u374D\u3740\u3751\u3757\u375C\u375Fngle\u0280;dlqr\u3730\u3731\u3736\u3740\u3742\u65B5own\xBB\u1DBBeft\u0100;e\u2800\u373E\xF1\u092E;\u625Cight\u0100;e\u32AA\u374B\xF1\u105Aot;\u65ECinus;\u6A3Alus;\u6A39b;\u69CDime;\u6A3Bezium;\u63E2\u0180cht\u3772\u377D\u3781\u0100ry\u3777\u377B;\uC000\u{1D4C9};\u4446cy;\u445Brok;\u4167\u0100io\u378B\u378Ex\xF4\u1777head\u0100lr\u3797\u37A0eftarro\xF7\u084Fightarrow\xBB\u0F5D\u0900AHabcdfghlmoprstuw\u37D0\u37D3\u37D7\u37E4\u37F0\u37FC\u380E\u381C\u3823\u3834\u3851\u385D\u386B\u38A9\u38CC\u38D2\u38EA\u38F6r\xF2\u03EDar;\u6963\u0100cr\u37DC\u37E2ute\u803B\xFA\u40FA\xF2\u1150r\u01E3\u37EA\0\u37EDy;\u445Eve;\u416D\u0100iy\u37F5\u37FArc\u803B\xFB\u40FB;\u4443\u0180abh\u3803\u3806\u380Br\xF2\u13ADlac;\u4171a\xF2\u13C3\u0100ir\u3813\u3818sht;\u697E;\uC000\u{1D532}rave\u803B\xF9\u40F9\u0161\u3827\u3831r\u0100lr\u382C\u382E\xBB\u0957\xBB\u1083lk;\u6580\u0100ct\u3839\u384D\u026F\u383F\0\0\u384Arn\u0100;e\u3845\u3846\u631Cr\xBB\u3846op;\u630Fri;\u65F8\u0100al\u3856\u385Acr;\u416B\u80BB\xA8\u0349\u0100gp\u3862\u3866on;\u4173f;\uC000\u{1D566}\u0300adhlsu\u114B\u3878\u387D\u1372\u3891\u38A0own\xE1\u13B3arpoon\u0100lr\u3888\u388Cef\xF4\u382Digh\xF4\u382Fi\u0180;hl\u3899\u389A\u389C\u43C5\xBB\u13FAon\xBB\u389Aparrows;\u61C8\u0180cit\u38B0\u38C4\u38C8\u026F\u38B6\0\0\u38C1rn\u0100;e\u38BC\u38BD\u631Dr\xBB\u38BDop;\u630Eng;\u416Fri;\u65F9cr;\uC000\u{1D4CA}\u0180dir\u38D9\u38DD\u38E2ot;\u62F0lde;\u4169i\u0100;f\u3730\u38E8\xBB\u1813\u0100am\u38EF\u38F2r\xF2\u38A8l\u803B\xFC\u40FCangle;\u69A7\u0780ABDacdeflnoprsz\u391C\u391F\u3929\u392D\u39B5\u39B8\u39BD\u39DF\u39E4\u39E8\u39F3\u39F9\u39FD\u3A01\u3A20r\xF2\u03F7ar\u0100;v\u3926\u3927\u6AE8;\u6AE9as\xE8\u03E1\u0100nr\u3932\u3937grt;\u699C\u0380eknprst\u34E3\u3946\u394B\u3952\u395D\u3964\u3996app\xE1\u2415othin\xE7\u1E96\u0180hir\u34EB\u2EC8\u3959op\xF4\u2FB5\u0100;h\u13B7\u3962\xEF\u318D\u0100iu\u3969\u396Dgm\xE1\u33B3\u0100bp\u3972\u3984setneq\u0100;q\u397D\u3980\uC000\u228A\uFE00;\uC000\u2ACB\uFE00setneq\u0100;q\u398F\u3992\uC000\u228B\uFE00;\uC000\u2ACC\uFE00\u0100hr\u399B\u399Fet\xE1\u369Ciangle\u0100lr\u39AA\u39AFeft\xBB\u0925ight\xBB\u1051y;\u4432ash\xBB\u1036\u0180elr\u39C4\u39D2\u39D7\u0180;be\u2DEA\u39CB\u39CFar;\u62BBq;\u625Alip;\u62EE\u0100bt\u39DC\u1468a\xF2\u1469r;\uC000\u{1D533}tr\xE9\u39AEsu\u0100bp\u39EF\u39F1\xBB\u0D1C\xBB\u0D59pf;\uC000\u{1D567}ro\xF0\u0EFBtr\xE9\u39B4\u0100cu\u3A06\u3A0Br;\uC000\u{1D4CB}\u0100bp\u3A10\u3A18n\u0100Ee\u3980\u3A16\xBB\u397En\u0100Ee\u3992\u3A1E\xBB\u3990igzag;\u699A\u0380cefoprs\u3A36\u3A3B\u3A56\u3A5B\u3A54\u3A61\u3A6Airc;\u4175\u0100di\u3A40\u3A51\u0100bg\u3A45\u3A49ar;\u6A5Fe\u0100;q\u15FA\u3A4F;\u6259erp;\u6118r;\uC000\u{1D534}pf;\uC000\u{1D568}\u0100;e\u1479\u3A66at\xE8\u1479cr;\uC000\u{1D4CC}\u0AE3\u178E\u3A87\0\u3A8B\0\u3A90\u3A9B\0\0\u3A9D\u3AA8\u3AAB\u3AAF\0\0\u3AC3\u3ACE\0\u3AD8\u17DC\u17DFtr\xE9\u17D1r;\uC000\u{1D535}\u0100Aa\u3A94\u3A97r\xF2\u03C3r\xF2\u09F6;\u43BE\u0100Aa\u3AA1\u3AA4r\xF2\u03B8r\xF2\u09EBa\xF0\u2713is;\u62FB\u0180dpt\u17A4\u3AB5\u3ABE\u0100fl\u3ABA\u17A9;\uC000\u{1D569}im\xE5\u17B2\u0100Aa\u3AC7\u3ACAr\xF2\u03CEr\xF2\u0A01\u0100cq\u3AD2\u17B8r;\uC000\u{1D4CD}\u0100pt\u17D6\u3ADCr\xE9\u17D4\u0400acefiosu\u3AF0\u3AFD\u3B08\u3B0C\u3B11\u3B15\u3B1B\u3B21c\u0100uy\u3AF6\u3AFBte\u803B\xFD\u40FD;\u444F\u0100iy\u3B02\u3B06rc;\u4177;\u444Bn\u803B\xA5\u40A5r;\uC000\u{1D536}cy;\u4457pf;\uC000\u{1D56A}cr;\uC000\u{1D4CE}\u0100cm\u3B26\u3B29y;\u444El\u803B\xFF\u40FF\u0500acdefhiosw\u3B42\u3B48\u3B54\u3B58\u3B64\u3B69\u3B6D\u3B74\u3B7A\u3B80cute;\u417A\u0100ay\u3B4D\u3B52ron;\u417E;\u4437ot;\u417C\u0100et\u3B5D\u3B61tr\xE6\u155Fa;\u43B6r;\uC000\u{1D537}cy;\u4436grarr;\u61DDpf;\uC000\u{1D56B}cr;\uC000\u{1D4CF}\u0100jn\u3B85\u3B87;\u600Dj;\u600C'.split("").map(n=>n.charCodeAt(0)));var h0e=new Uint16Array("\u0200aglq	\x1B\u026D\0\0p;\u4026os;\u4027t;\u403Et;\u403Cuot;\u4022".split("").map(n=>n.charCodeAt(0)));var kY,y$e=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),RY=(kY=String.fromCodePoint)!==null&&kY!==void 0?kY:function(n){let e="";return n>65535&&(n-=65536,e+=String.fromCharCode(n>>>10&1023|55296),n=56320|n&1023),e+=String.fromCharCode(n),e};function PY(n){var e;return n>=55296&&n<=57343||n>1114111?65533:(e=y$e.get(n))!==null&&e!==void 0?e:n}var Ss;(function(n){n[n.NUM=35]="NUM",n[n.SEMI=59]="SEMI",n[n.EQUALS=61]="EQUALS",n[n.ZERO=48]="ZERO",n[n.NINE=57]="NINE",n[n.LOWER_A=97]="LOWER_A",n[n.LOWER_F=102]="LOWER_F",n[n.LOWER_X=120]="LOWER_X",n[n.LOWER_Z=122]="LOWER_Z",n[n.UPPER_A=65]="UPPER_A",n[n.UPPER_F=70]="UPPER_F",n[n.UPPER_Z=90]="UPPER_Z"})(Ss||(Ss={}));var b$e=32,Hv;(function(n){n[n.VALUE_LENGTH=49152]="VALUE_LENGTH",n[n.BRANCH_LENGTH=16256]="BRANCH_LENGTH",n[n.JUMP_TABLE=127]="JUMP_TABLE"})(Hv||(Hv={}));function AY(n){return n>=Ss.ZERO&&n<=Ss.NINE}function _$e(n){return n>=Ss.UPPER_A&&n<=Ss.UPPER_F||n>=Ss.LOWER_A&&n<=Ss.LOWER_F}function x$e(n){return n>=Ss.UPPER_A&&n<=Ss.UPPER_Z||n>=Ss.LOWER_A&&n<=Ss.LOWER_Z||AY(n)}function S$e(n){return n===Ss.EQUALS||x$e(n)}var xs;(function(n){n[n.EntityStart=0]="EntityStart",n[n.NumericStart=1]="NumericStart",n[n.NumericDecimal=2]="NumericDecimal",n[n.NumericHex=3]="NumericHex",n[n.NamedEntity=4]="NamedEntity"})(xs||(xs={}));var zp;(function(n){n[n.Legacy=0]="Legacy",n[n.Strict=1]="Strict",n[n.Attribute=2]="Attribute"})(zp||(zp={}));var i6=class{constructor(e,t,r){this.decodeTree=e,this.emitCodePoint=t,this.errors=r,this.state=xs.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=zp.Strict}startEntity(e){this.decodeMode=e,this.state=xs.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,t){switch(this.state){case xs.EntityStart:return e.charCodeAt(t)===Ss.NUM?(this.state=xs.NumericStart,this.consumed+=1,this.stateNumericStart(e,t+1)):(this.state=xs.NamedEntity,this.stateNamedEntity(e,t));case xs.NumericStart:return this.stateNumericStart(e,t);case xs.NumericDecimal:return this.stateNumericDecimal(e,t);case xs.NumericHex:return this.stateNumericHex(e,t);case xs.NamedEntity:return this.stateNamedEntity(e,t)}}stateNumericStart(e,t){return t>=e.length?-1:(e.charCodeAt(t)|b$e)===Ss.LOWER_X?(this.state=xs.NumericHex,this.consumed+=1,this.stateNumericHex(e,t+1)):(this.state=xs.NumericDecimal,this.stateNumericDecimal(e,t))}addToNumericResult(e,t,r,o){if(t!==r){let s=r-t;this.result=this.result*Math.pow(o,s)+parseInt(e.substr(t,s),o),this.consumed+=s}}stateNumericHex(e,t){let r=t;for(;t<e.length;){let o=e.charCodeAt(t);if(AY(o)||_$e(o))t+=1;else return this.addToNumericResult(e,r,t,16),this.emitNumericEntity(o,3)}return this.addToNumericResult(e,r,t,16),-1}stateNumericDecimal(e,t){let r=t;for(;t<e.length;){let o=e.charCodeAt(t);if(AY(o))t+=1;else return this.addToNumericResult(e,r,t,10),this.emitNumericEntity(o,2)}return this.addToNumericResult(e,r,t,10),-1}emitNumericEntity(e,t){var r;if(this.consumed<=t)return(r=this.errors)===null||r===void 0||r.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===Ss.SEMI)this.consumed+=1;else if(this.decodeMode===zp.Strict)return 0;return this.emitCodePoint(PY(this.result),this.consumed),this.errors&&(e!==Ss.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,t){let{decodeTree:r}=this,o=r[this.treeIndex],s=(o&Hv.VALUE_LENGTH)>>14;for(;t<e.length;t++,this.excess++){let a=e.charCodeAt(t);if(this.treeIndex=I$e(r,o,this.treeIndex+Math.max(1,s),a),this.treeIndex<0)return this.result===0||this.decodeMode===zp.Attribute&&(s===0||S$e(a))?0:this.emitNotTerminatedNamedEntity();if(o=r[this.treeIndex],s=(o&Hv.VALUE_LENGTH)>>14,s!==0){if(a===Ss.SEMI)return this.emitNamedEntityData(this.treeIndex,s,this.consumed+this.excess);this.decodeMode!==zp.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;let{result:t,decodeTree:r}=this,o=(r[t]&Hv.VALUE_LENGTH)>>14;return this.emitNamedEntityData(t,o,this.consumed),(e=this.errors)===null||e===void 0||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,t,r){let{decodeTree:o}=this;return this.emitCodePoint(t===1?o[e]&~Hv.VALUE_LENGTH:o[e+1],r),t===3&&this.emitCodePoint(o[e+2],r),r}end(){var e;switch(this.state){case xs.NamedEntity:return this.result!==0&&(this.decodeMode!==zp.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case xs.NumericDecimal:return this.emitNumericEntity(0,2);case xs.NumericHex:return this.emitNumericEntity(0,3);case xs.NumericStart:return(e=this.errors)===null||e===void 0||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case xs.EntityStart:return 0}}};function g0e(n){let e="",t=new i6(n,r=>e+=RY(r));return function(o,s){let a=0,c=0;for(;(c=o.indexOf("&",c))>=0;){e+=o.slice(a,c),t.startEntity(s);let u=t.write(o,c+1);if(u<0){a=c+t.end();break}a=c+u,c=u===0?a+1:a}let l=e+o.slice(a);return e="",l}}function I$e(n,e,t,r){let o=(e&Hv.BRANCH_LENGTH)>>7,s=e&Hv.JUMP_TABLE;if(o===0)return s!==0&&r===s?t:-1;if(s){let l=r-s;return l<0||l>=o?-1:n[t+l]-1}let a=t,c=a+o-1;for(;a<=c;){let l=a+c>>>1,u=n[l];if(u<r)a=l+1;else if(u>r)c=l-1;else return n[l+o]}return-1}var T$e=g0e(m0e),DFt=g0e(h0e);function Vv(n,e=zp.Legacy){return T$e(n,e)}function o6(n){for(let e=1;e<n.length;e++)n[e][0]+=n[e-1][0]+1;return n}var C$e=new Map(o6([[9,"&Tab;"],[0,"&NewLine;"],[22,"&excl;"],[0,"&quot;"],[0,"&num;"],[0,"&dollar;"],[0,"&percnt;"],[0,"&amp;"],[0,"&apos;"],[0,"&lpar;"],[0,"&rpar;"],[0,"&ast;"],[0,"&plus;"],[0,"&comma;"],[1,"&period;"],[0,"&sol;"],[10,"&colon;"],[0,"&semi;"],[0,{v:"&lt;",n:8402,o:"&nvlt;"}],[0,{v:"&equals;",n:8421,o:"&bne;"}],[0,{v:"&gt;",n:8402,o:"&nvgt;"}],[0,"&quest;"],[0,"&commat;"],[26,"&lbrack;"],[0,"&bsol;"],[0,"&rbrack;"],[0,"&Hat;"],[0,"&lowbar;"],[0,"&DiacriticalGrave;"],[5,{n:106,o:"&fjlig;"}],[20,"&lbrace;"],[0,"&verbar;"],[0,"&rbrace;"],[34,"&nbsp;"],[0,"&iexcl;"],[0,"&cent;"],[0,"&pound;"],[0,"&curren;"],[0,"&yen;"],[0,"&brvbar;"],[0,"&sect;"],[0,"&die;"],[0,"&copy;"],[0,"&ordf;"],[0,"&laquo;"],[0,"&not;"],[0,"&shy;"],[0,"&circledR;"],[0,"&macr;"],[0,"&deg;"],[0,"&PlusMinus;"],[0,"&sup2;"],[0,"&sup3;"],[0,"&acute;"],[0,"&micro;"],[0,"&para;"],[0,"&centerdot;"],[0,"&cedil;"],[0,"&sup1;"],[0,"&ordm;"],[0,"&raquo;"],[0,"&frac14;"],[0,"&frac12;"],[0,"&frac34;"],[0,"&iquest;"],[0,"&Agrave;"],[0,"&Aacute;"],[0,"&Acirc;"],[0,"&Atilde;"],[0,"&Auml;"],[0,"&angst;"],[0,"&AElig;"],[0,"&Ccedil;"],[0,"&Egrave;"],[0,"&Eacute;"],[0,"&Ecirc;"],[0,"&Euml;"],[0,"&Igrave;"],[0,"&Iacute;"],[0,"&Icirc;"],[0,"&Iuml;"],[0,"&ETH;"],[0,"&Ntilde;"],[0,"&Ograve;"],[0,"&Oacute;"],[0,"&Ocirc;"],[0,"&Otilde;"],[0,"&Ouml;"],[0,"&times;"],[0,"&Oslash;"],[0,"&Ugrave;"],[0,"&Uacute;"],[0,"&Ucirc;"],[0,"&Uuml;"],[0,"&Yacute;"],[0,"&THORN;"],[0,"&szlig;"],[0,"&agrave;"],[0,"&aacute;"],[0,"&acirc;"],[0,"&atilde;"],[0,"&auml;"],[0,"&aring;"],[0,"&aelig;"],[0,"&ccedil;"],[0,"&egrave;"],[0,"&eacute;"],[0,"&ecirc;"],[0,"&euml;"],[0,"&igrave;"],[0,"&iacute;"],[0,"&icirc;"],[0,"&iuml;"],[0,"&eth;"],[0,"&ntilde;"],[0,"&ograve;"],[0,"&oacute;"],[0,"&ocirc;"],[0,"&otilde;"],[0,"&ouml;"],[0,"&div;"],[0,"&oslash;"],[0,"&ugrave;"],[0,"&uacute;"],[0,"&ucirc;"],[0,"&uuml;"],[0,"&yacute;"],[0,"&thorn;"],[0,"&yuml;"],[0,"&Amacr;"],[0,"&amacr;"],[0,"&Abreve;"],[0,"&abreve;"],[0,"&Aogon;"],[0,"&aogon;"],[0,"&Cacute;"],[0,"&cacute;"],[0,"&Ccirc;"],[0,"&ccirc;"],[0,"&Cdot;"],[0,"&cdot;"],[0,"&Ccaron;"],[0,"&ccaron;"],[0,"&Dcaron;"],[0,"&dcaron;"],[0,"&Dstrok;"],[0,"&dstrok;"],[0,"&Emacr;"],[0,"&emacr;"],[2,"&Edot;"],[0,"&edot;"],[0,"&Eogon;"],[0,"&eogon;"],[0,"&Ecaron;"],[0,"&ecaron;"],[0,"&Gcirc;"],[0,"&gcirc;"],[0,"&Gbreve;"],[0,"&gbreve;"],[0,"&Gdot;"],[0,"&gdot;"],[0,"&Gcedil;"],[1,"&Hcirc;"],[0,"&hcirc;"],[0,"&Hstrok;"],[0,"&hstrok;"],[0,"&Itilde;"],[0,"&itilde;"],[0,"&Imacr;"],[0,"&imacr;"],[2,"&Iogon;"],[0,"&iogon;"],[0,"&Idot;"],[0,"&imath;"],[0,"&IJlig;"],[0,"&ijlig;"],[0,"&Jcirc;"],[0,"&jcirc;"],[0,"&Kcedil;"],[0,"&kcedil;"],[0,"&kgreen;"],[0,"&Lacute;"],[0,"&lacute;"],[0,"&Lcedil;"],[0,"&lcedil;"],[0,"&Lcaron;"],[0,"&lcaron;"],[0,"&Lmidot;"],[0,"&lmidot;"],[0,"&Lstrok;"],[0,"&lstrok;"],[0,"&Nacute;"],[0,"&nacute;"],[0,"&Ncedil;"],[0,"&ncedil;"],[0,"&Ncaron;"],[0,"&ncaron;"],[0,"&napos;"],[0,"&ENG;"],[0,"&eng;"],[0,"&Omacr;"],[0,"&omacr;"],[2,"&Odblac;"],[0,"&odblac;"],[0,"&OElig;"],[0,"&oelig;"],[0,"&Racute;"],[0,"&racute;"],[0,"&Rcedil;"],[0,"&rcedil;"],[0,"&Rcaron;"],[0,"&rcaron;"],[0,"&Sacute;"],[0,"&sacute;"],[0,"&Scirc;"],[0,"&scirc;"],[0,"&Scedil;"],[0,"&scedil;"],[0,"&Scaron;"],[0,"&scaron;"],[0,"&Tcedil;"],[0,"&tcedil;"],[0,"&Tcaron;"],[0,"&tcaron;"],[0,"&Tstrok;"],[0,"&tstrok;"],[0,"&Utilde;"],[0,"&utilde;"],[0,"&Umacr;"],[0,"&umacr;"],[0,"&Ubreve;"],[0,"&ubreve;"],[0,"&Uring;"],[0,"&uring;"],[0,"&Udblac;"],[0,"&udblac;"],[0,"&Uogon;"],[0,"&uogon;"],[0,"&Wcirc;"],[0,"&wcirc;"],[0,"&Ycirc;"],[0,"&ycirc;"],[0,"&Yuml;"],[0,"&Zacute;"],[0,"&zacute;"],[0,"&Zdot;"],[0,"&zdot;"],[0,"&Zcaron;"],[0,"&zcaron;"],[19,"&fnof;"],[34,"&imped;"],[63,"&gacute;"],[65,"&jmath;"],[142,"&circ;"],[0,"&caron;"],[16,"&breve;"],[0,"&DiacriticalDot;"],[0,"&ring;"],[0,"&ogon;"],[0,"&DiacriticalTilde;"],[0,"&dblac;"],[51,"&DownBreve;"],[127,"&Alpha;"],[0,"&Beta;"],[0,"&Gamma;"],[0,"&Delta;"],[0,"&Epsilon;"],[0,"&Zeta;"],[0,"&Eta;"],[0,"&Theta;"],[0,"&Iota;"],[0,"&Kappa;"],[0,"&Lambda;"],[0,"&Mu;"],[0,"&Nu;"],[0,"&Xi;"],[0,"&Omicron;"],[0,"&Pi;"],[0,"&Rho;"],[1,"&Sigma;"],[0,"&Tau;"],[0,"&Upsilon;"],[0,"&Phi;"],[0,"&Chi;"],[0,"&Psi;"],[0,"&ohm;"],[7,"&alpha;"],[0,"&beta;"],[0,"&gamma;"],[0,"&delta;"],[0,"&epsi;"],[0,"&zeta;"],[0,"&eta;"],[0,"&theta;"],[0,"&iota;"],[0,"&kappa;"],[0,"&lambda;"],[0,"&mu;"],[0,"&nu;"],[0,"&xi;"],[0,"&omicron;"],[0,"&pi;"],[0,"&rho;"],[0,"&sigmaf;"],[0,"&sigma;"],[0,"&tau;"],[0,"&upsi;"],[0,"&phi;"],[0,"&chi;"],[0,"&psi;"],[0,"&omega;"],[7,"&thetasym;"],[0,"&Upsi;"],[2,"&phiv;"],[0,"&piv;"],[5,"&Gammad;"],[0,"&digamma;"],[18,"&kappav;"],[0,"&rhov;"],[3,"&epsiv;"],[0,"&backepsilon;"],[10,"&IOcy;"],[0,"&DJcy;"],[0,"&GJcy;"],[0,"&Jukcy;"],[0,"&DScy;"],[0,"&Iukcy;"],[0,"&YIcy;"],[0,"&Jsercy;"],[0,"&LJcy;"],[0,"&NJcy;"],[0,"&TSHcy;"],[0,"&KJcy;"],[1,"&Ubrcy;"],[0,"&DZcy;"],[0,"&Acy;"],[0,"&Bcy;"],[0,"&Vcy;"],[0,"&Gcy;"],[0,"&Dcy;"],[0,"&IEcy;"],[0,"&ZHcy;"],[0,"&Zcy;"],[0,"&Icy;"],[0,"&Jcy;"],[0,"&Kcy;"],[0,"&Lcy;"],[0,"&Mcy;"],[0,"&Ncy;"],[0,"&Ocy;"],[0,"&Pcy;"],[0,"&Rcy;"],[0,"&Scy;"],[0,"&Tcy;"],[0,"&Ucy;"],[0,"&Fcy;"],[0,"&KHcy;"],[0,"&TScy;"],[0,"&CHcy;"],[0,"&SHcy;"],[0,"&SHCHcy;"],[0,"&HARDcy;"],[0,"&Ycy;"],[0,"&SOFTcy;"],[0,"&Ecy;"],[0,"&YUcy;"],[0,"&YAcy;"],[0,"&acy;"],[0,"&bcy;"],[0,"&vcy;"],[0,"&gcy;"],[0,"&dcy;"],[0,"&iecy;"],[0,"&zhcy;"],[0,"&zcy;"],[0,"&icy;"],[0,"&jcy;"],[0,"&kcy;"],[0,"&lcy;"],[0,"&mcy;"],[0,"&ncy;"],[0,"&ocy;"],[0,"&pcy;"],[0,"&rcy;"],[0,"&scy;"],[0,"&tcy;"],[0,"&ucy;"],[0,"&fcy;"],[0,"&khcy;"],[0,"&tscy;"],[0,"&chcy;"],[0,"&shcy;"],[0,"&shchcy;"],[0,"&hardcy;"],[0,"&ycy;"],[0,"&softcy;"],[0,"&ecy;"],[0,"&yucy;"],[0,"&yacy;"],[1,"&iocy;"],[0,"&djcy;"],[0,"&gjcy;"],[0,"&jukcy;"],[0,"&dscy;"],[0,"&iukcy;"],[0,"&yicy;"],[0,"&jsercy;"],[0,"&ljcy;"],[0,"&njcy;"],[0,"&tshcy;"],[0,"&kjcy;"],[1,"&ubrcy;"],[0,"&dzcy;"],[7074,"&ensp;"],[0,"&emsp;"],[0,"&emsp13;"],[0,"&emsp14;"],[1,"&numsp;"],[0,"&puncsp;"],[0,"&ThinSpace;"],[0,"&hairsp;"],[0,"&NegativeMediumSpace;"],[0,"&zwnj;"],[0,"&zwj;"],[0,"&lrm;"],[0,"&rlm;"],[0,"&dash;"],[2,"&ndash;"],[0,"&mdash;"],[0,"&horbar;"],[0,"&Verbar;"],[1,"&lsquo;"],[0,"&CloseCurlyQuote;"],[0,"&lsquor;"],[1,"&ldquo;"],[0,"&CloseCurlyDoubleQuote;"],[0,"&bdquo;"],[1,"&dagger;"],[0,"&Dagger;"],[0,"&bull;"],[2,"&nldr;"],[0,"&hellip;"],[9,"&permil;"],[0,"&pertenk;"],[0,"&prime;"],[0,"&Prime;"],[0,"&tprime;"],[0,"&backprime;"],[3,"&lsaquo;"],[0,"&rsaquo;"],[3,"&oline;"],[2,"&caret;"],[1,"&hybull;"],[0,"&frasl;"],[10,"&bsemi;"],[7,"&qprime;"],[7,{v:"&MediumSpace;",n:8202,o:"&ThickSpace;"}],[0,"&NoBreak;"],[0,"&af;"],[0,"&InvisibleTimes;"],[0,"&ic;"],[72,"&euro;"],[46,"&tdot;"],[0,"&DotDot;"],[37,"&complexes;"],[2,"&incare;"],[4,"&gscr;"],[0,"&hamilt;"],[0,"&Hfr;"],[0,"&Hopf;"],[0,"&planckh;"],[0,"&hbar;"],[0,"&imagline;"],[0,"&Ifr;"],[0,"&lagran;"],[0,"&ell;"],[1,"&naturals;"],[0,"&numero;"],[0,"&copysr;"],[0,"&weierp;"],[0,"&Popf;"],[0,"&Qopf;"],[0,"&realine;"],[0,"&real;"],[0,"&reals;"],[0,"&rx;"],[3,"&trade;"],[1,"&integers;"],[2,"&mho;"],[0,"&zeetrf;"],[0,"&iiota;"],[2,"&bernou;"],[0,"&Cayleys;"],[1,"&escr;"],[0,"&Escr;"],[0,"&Fouriertrf;"],[1,"&Mellintrf;"],[0,"&order;"],[0,"&alefsym;"],[0,"&beth;"],[0,"&gimel;"],[0,"&daleth;"],[12,"&CapitalDifferentialD;"],[0,"&dd;"],[0,"&ee;"],[0,"&ii;"],[10,"&frac13;"],[0,"&frac23;"],[0,"&frac15;"],[0,"&frac25;"],[0,"&frac35;"],[0,"&frac45;"],[0,"&frac16;"],[0,"&frac56;"],[0,"&frac18;"],[0,"&frac38;"],[0,"&frac58;"],[0,"&frac78;"],[49,"&larr;"],[0,"&ShortUpArrow;"],[0,"&rarr;"],[0,"&darr;"],[0,"&harr;"],[0,"&updownarrow;"],[0,"&nwarr;"],[0,"&nearr;"],[0,"&LowerRightArrow;"],[0,"&LowerLeftArrow;"],[0,"&nlarr;"],[0,"&nrarr;"],[1,{v:"&rarrw;",n:824,o:"&nrarrw;"}],[0,"&Larr;"],[0,"&Uarr;"],[0,"&Rarr;"],[0,"&Darr;"],[0,"&larrtl;"],[0,"&rarrtl;"],[0,"&LeftTeeArrow;"],[0,"&mapstoup;"],[0,"&map;"],[0,"&DownTeeArrow;"],[1,"&hookleftarrow;"],[0,"&hookrightarrow;"],[0,"&larrlp;"],[0,"&looparrowright;"],[0,"&harrw;"],[0,"&nharr;"],[1,"&lsh;"],[0,"&rsh;"],[0,"&ldsh;"],[0,"&rdsh;"],[1,"&crarr;"],[0,"&cularr;"],[0,"&curarr;"],[2,"&circlearrowleft;"],[0,"&circlearrowright;"],[0,"&leftharpoonup;"],[0,"&DownLeftVector;"],[0,"&RightUpVector;"],[0,"&LeftUpVector;"],[0,"&rharu;"],[0,"&DownRightVector;"],[0,"&dharr;"],[0,"&dharl;"],[0,"&RightArrowLeftArrow;"],[0,"&udarr;"],[0,"&LeftArrowRightArrow;"],[0,"&leftleftarrows;"],[0,"&upuparrows;"],[0,"&rightrightarrows;"],[0,"&ddarr;"],[0,"&leftrightharpoons;"],[0,"&Equilibrium;"],[0,"&nlArr;"],[0,"&nhArr;"],[0,"&nrArr;"],[0,"&DoubleLeftArrow;"],[0,"&DoubleUpArrow;"],[0,"&DoubleRightArrow;"],[0,"&dArr;"],[0,"&DoubleLeftRightArrow;"],[0,"&DoubleUpDownArrow;"],[0,"&nwArr;"],[0,"&neArr;"],[0,"&seArr;"],[0,"&swArr;"],[0,"&lAarr;"],[0,"&rAarr;"],[1,"&zigrarr;"],[6,"&larrb;"],[0,"&rarrb;"],[15,"&DownArrowUpArrow;"],[7,"&loarr;"],[0,"&roarr;"],[0,"&hoarr;"],[0,"&forall;"],[0,"&comp;"],[0,{v:"&part;",n:824,o:"&npart;"}],[0,"&exist;"],[0,"&nexist;"],[0,"&empty;"],[1,"&Del;"],[0,"&Element;"],[0,"&NotElement;"],[1,"&ni;"],[0,"&notni;"],[2,"&prod;"],[0,"&coprod;"],[0,"&sum;"],[0,"&minus;"],[0,"&MinusPlus;"],[0,"&dotplus;"],[1,"&Backslash;"],[0,"&lowast;"],[0,"&compfn;"],[1,"&radic;"],[2,"&prop;"],[0,"&infin;"],[0,"&angrt;"],[0,{v:"&ang;",n:8402,o:"&nang;"}],[0,"&angmsd;"],[0,"&angsph;"],[0,"&mid;"],[0,"&nmid;"],[0,"&DoubleVerticalBar;"],[0,"&NotDoubleVerticalBar;"],[0,"&and;"],[0,"&or;"],[0,{v:"&cap;",n:65024,o:"&caps;"}],[0,{v:"&cup;",n:65024,o:"&cups;"}],[0,"&int;"],[0,"&Int;"],[0,"&iiint;"],[0,"&conint;"],[0,"&Conint;"],[0,"&Cconint;"],[0,"&cwint;"],[0,"&ClockwiseContourIntegral;"],[0,"&awconint;"],[0,"&there4;"],[0,"&becaus;"],[0,"&ratio;"],[0,"&Colon;"],[0,"&dotminus;"],[1,"&mDDot;"],[0,"&homtht;"],[0,{v:"&sim;",n:8402,o:"&nvsim;"}],[0,{v:"&backsim;",n:817,o:"&race;"}],[0,{v:"&ac;",n:819,o:"&acE;"}],[0,"&acd;"],[0,"&VerticalTilde;"],[0,"&NotTilde;"],[0,{v:"&eqsim;",n:824,o:"&nesim;"}],[0,"&sime;"],[0,"&NotTildeEqual;"],[0,"&cong;"],[0,"&simne;"],[0,"&ncong;"],[0,"&ap;"],[0,"&nap;"],[0,"&ape;"],[0,{v:"&apid;",n:824,o:"&napid;"}],[0,"&backcong;"],[0,{v:"&asympeq;",n:8402,o:"&nvap;"}],[0,{v:"&bump;",n:824,o:"&nbump;"}],[0,{v:"&bumpe;",n:824,o:"&nbumpe;"}],[0,{v:"&doteq;",n:824,o:"&nedot;"}],[0,"&doteqdot;"],[0,"&efDot;"],[0,"&erDot;"],[0,"&Assign;"],[0,"&ecolon;"],[0,"&ecir;"],[0,"&circeq;"],[1,"&wedgeq;"],[0,"&veeeq;"],[1,"&triangleq;"],[2,"&equest;"],[0,"&ne;"],[0,{v:"&Congruent;",n:8421,o:"&bnequiv;"}],[0,"&nequiv;"],[1,{v:"&le;",n:8402,o:"&nvle;"}],[0,{v:"&ge;",n:8402,o:"&nvge;"}],[0,{v:"&lE;",n:824,o:"&nlE;"}],[0,{v:"&gE;",n:824,o:"&ngE;"}],[0,{v:"&lnE;",n:65024,o:"&lvertneqq;"}],[0,{v:"&gnE;",n:65024,o:"&gvertneqq;"}],[0,{v:"&ll;",n:new Map(o6([[824,"&nLtv;"],[7577,"&nLt;"]]))}],[0,{v:"&gg;",n:new Map(o6([[824,"&nGtv;"],[7577,"&nGt;"]]))}],[0,"&between;"],[0,"&NotCupCap;"],[0,"&nless;"],[0,"&ngt;"],[0,"&nle;"],[0,"&nge;"],[0,"&lesssim;"],[0,"&GreaterTilde;"],[0,"&nlsim;"],[0,"&ngsim;"],[0,"&LessGreater;"],[0,"&gl;"],[0,"&NotLessGreater;"],[0,"&NotGreaterLess;"],[0,"&pr;"],[0,"&sc;"],[0,"&prcue;"],[0,"&sccue;"],[0,"&PrecedesTilde;"],[0,{v:"&scsim;",n:824,o:"&NotSucceedsTilde;"}],[0,"&NotPrecedes;"],[0,"&NotSucceeds;"],[0,{v:"&sub;",n:8402,o:"&NotSubset;"}],[0,{v:"&sup;",n:8402,o:"&NotSuperset;"}],[0,"&nsub;"],[0,"&nsup;"],[0,"&sube;"],[0,"&supe;"],[0,"&NotSubsetEqual;"],[0,"&NotSupersetEqual;"],[0,{v:"&subne;",n:65024,o:"&varsubsetneq;"}],[0,{v:"&supne;",n:65024,o:"&varsupsetneq;"}],[1,"&cupdot;"],[0,"&UnionPlus;"],[0,{v:"&sqsub;",n:824,o:"&NotSquareSubset;"}],[0,{v:"&sqsup;",n:824,o:"&NotSquareSuperset;"}],[0,"&sqsube;"],[0,"&sqsupe;"],[0,{v:"&sqcap;",n:65024,o:"&sqcaps;"}],[0,{v:"&sqcup;",n:65024,o:"&sqcups;"}],[0,"&CirclePlus;"],[0,"&CircleMinus;"],[0,"&CircleTimes;"],[0,"&osol;"],[0,"&CircleDot;"],[0,"&circledcirc;"],[0,"&circledast;"],[1,"&circleddash;"],[0,"&boxplus;"],[0,"&boxminus;"],[0,"&boxtimes;"],[0,"&dotsquare;"],[0,"&RightTee;"],[0,"&dashv;"],[0,"&DownTee;"],[0,"&bot;"],[1,"&models;"],[0,"&DoubleRightTee;"],[0,"&Vdash;"],[0,"&Vvdash;"],[0,"&VDash;"],[0,"&nvdash;"],[0,"&nvDash;"],[0,"&nVdash;"],[0,"&nVDash;"],[0,"&prurel;"],[1,"&LeftTriangle;"],[0,"&RightTriangle;"],[0,{v:"&LeftTriangleEqual;",n:8402,o:"&nvltrie;"}],[0,{v:"&RightTriangleEqual;",n:8402,o:"&nvrtrie;"}],[0,"&origof;"],[0,"&imof;"],[0,"&multimap;"],[0,"&hercon;"],[0,"&intcal;"],[0,"&veebar;"],[1,"&barvee;"],[0,"&angrtvb;"],[0,"&lrtri;"],[0,"&bigwedge;"],[0,"&bigvee;"],[0,"&bigcap;"],[0,"&bigcup;"],[0,"&diam;"],[0,"&sdot;"],[0,"&sstarf;"],[0,"&divideontimes;"],[0,"&bowtie;"],[0,"&ltimes;"],[0,"&rtimes;"],[0,"&leftthreetimes;"],[0,"&rightthreetimes;"],[0,"&backsimeq;"],[0,"&curlyvee;"],[0,"&curlywedge;"],[0,"&Sub;"],[0,"&Sup;"],[0,"&Cap;"],[0,"&Cup;"],[0,"&fork;"],[0,"&epar;"],[0,"&lessdot;"],[0,"&gtdot;"],[0,{v:"&Ll;",n:824,o:"&nLl;"}],[0,{v:"&Gg;",n:824,o:"&nGg;"}],[0,{v:"&leg;",n:65024,o:"&lesg;"}],[0,{v:"&gel;",n:65024,o:"&gesl;"}],[2,"&cuepr;"],[0,"&cuesc;"],[0,"&NotPrecedesSlantEqual;"],[0,"&NotSucceedsSlantEqual;"],[0,"&NotSquareSubsetEqual;"],[0,"&NotSquareSupersetEqual;"],[2,"&lnsim;"],[0,"&gnsim;"],[0,"&precnsim;"],[0,"&scnsim;"],[0,"&nltri;"],[0,"&NotRightTriangle;"],[0,"&nltrie;"],[0,"&NotRightTriangleEqual;"],[0,"&vellip;"],[0,"&ctdot;"],[0,"&utdot;"],[0,"&dtdot;"],[0,"&disin;"],[0,"&isinsv;"],[0,"&isins;"],[0,{v:"&isindot;",n:824,o:"&notindot;"}],[0,"&notinvc;"],[0,"&notinvb;"],[1,{v:"&isinE;",n:824,o:"&notinE;"}],[0,"&nisd;"],[0,"&xnis;"],[0,"&nis;"],[0,"&notnivc;"],[0,"&notnivb;"],[6,"&barwed;"],[0,"&Barwed;"],[1,"&lceil;"],[0,"&rceil;"],[0,"&LeftFloor;"],[0,"&rfloor;"],[0,"&drcrop;"],[0,"&dlcrop;"],[0,"&urcrop;"],[0,"&ulcrop;"],[0,"&bnot;"],[1,"&profline;"],[0,"&profsurf;"],[1,"&telrec;"],[0,"&target;"],[5,"&ulcorn;"],[0,"&urcorn;"],[0,"&dlcorn;"],[0,"&drcorn;"],[2,"&frown;"],[0,"&smile;"],[9,"&cylcty;"],[0,"&profalar;"],[7,"&topbot;"],[6,"&ovbar;"],[1,"&solbar;"],[60,"&angzarr;"],[51,"&lmoustache;"],[0,"&rmoustache;"],[2,"&OverBracket;"],[0,"&bbrk;"],[0,"&bbrktbrk;"],[37,"&OverParenthesis;"],[0,"&UnderParenthesis;"],[0,"&OverBrace;"],[0,"&UnderBrace;"],[2,"&trpezium;"],[4,"&elinters;"],[59,"&blank;"],[164,"&circledS;"],[55,"&boxh;"],[1,"&boxv;"],[9,"&boxdr;"],[3,"&boxdl;"],[3,"&boxur;"],[3,"&boxul;"],[3,"&boxvr;"],[7,"&boxvl;"],[7,"&boxhd;"],[7,"&boxhu;"],[7,"&boxvh;"],[19,"&boxH;"],[0,"&boxV;"],[0,"&boxdR;"],[0,"&boxDr;"],[0,"&boxDR;"],[0,"&boxdL;"],[0,"&boxDl;"],[0,"&boxDL;"],[0,"&boxuR;"],[0,"&boxUr;"],[0,"&boxUR;"],[0,"&boxuL;"],[0,"&boxUl;"],[0,"&boxUL;"],[0,"&boxvR;"],[0,"&boxVr;"],[0,"&boxVR;"],[0,"&boxvL;"],[0,"&boxVl;"],[0,"&boxVL;"],[0,"&boxHd;"],[0,"&boxhD;"],[0,"&boxHD;"],[0,"&boxHu;"],[0,"&boxhU;"],[0,"&boxHU;"],[0,"&boxvH;"],[0,"&boxVh;"],[0,"&boxVH;"],[19,"&uhblk;"],[3,"&lhblk;"],[3,"&block;"],[8,"&blk14;"],[0,"&blk12;"],[0,"&blk34;"],[13,"&square;"],[8,"&blacksquare;"],[0,"&EmptyVerySmallSquare;"],[1,"&rect;"],[0,"&marker;"],[2,"&fltns;"],[1,"&bigtriangleup;"],[0,"&blacktriangle;"],[0,"&triangle;"],[2,"&blacktriangleright;"],[0,"&rtri;"],[3,"&bigtriangledown;"],[0,"&blacktriangledown;"],[0,"&dtri;"],[2,"&blacktriangleleft;"],[0,"&ltri;"],[6,"&loz;"],[0,"&cir;"],[32,"&tridot;"],[2,"&bigcirc;"],[8,"&ultri;"],[0,"&urtri;"],[0,"&lltri;"],[0,"&EmptySmallSquare;"],[0,"&FilledSmallSquare;"],[8,"&bigstar;"],[0,"&star;"],[7,"&phone;"],[49,"&female;"],[1,"&male;"],[29,"&spades;"],[2,"&clubs;"],[1,"&hearts;"],[0,"&diamondsuit;"],[3,"&sung;"],[2,"&flat;"],[0,"&natural;"],[0,"&sharp;"],[163,"&check;"],[3,"&cross;"],[8,"&malt;"],[21,"&sext;"],[33,"&VerticalSeparator;"],[25,"&lbbrk;"],[0,"&rbbrk;"],[84,"&bsolhsub;"],[0,"&suphsol;"],[28,"&LeftDoubleBracket;"],[0,"&RightDoubleBracket;"],[0,"&lang;"],[0,"&rang;"],[0,"&Lang;"],[0,"&Rang;"],[0,"&loang;"],[0,"&roang;"],[7,"&longleftarrow;"],[0,"&longrightarrow;"],[0,"&longleftrightarrow;"],[0,"&DoubleLongLeftArrow;"],[0,"&DoubleLongRightArrow;"],[0,"&DoubleLongLeftRightArrow;"],[1,"&longmapsto;"],[2,"&dzigrarr;"],[258,"&nvlArr;"],[0,"&nvrArr;"],[0,"&nvHarr;"],[0,"&Map;"],[6,"&lbarr;"],[0,"&bkarow;"],[0,"&lBarr;"],[0,"&dbkarow;"],[0,"&drbkarow;"],[0,"&DDotrahd;"],[0,"&UpArrowBar;"],[0,"&DownArrowBar;"],[2,"&Rarrtl;"],[2,"&latail;"],[0,"&ratail;"],[0,"&lAtail;"],[0,"&rAtail;"],[0,"&larrfs;"],[0,"&rarrfs;"],[0,"&larrbfs;"],[0,"&rarrbfs;"],[2,"&nwarhk;"],[0,"&nearhk;"],[0,"&hksearow;"],[0,"&hkswarow;"],[0,"&nwnear;"],[0,"&nesear;"],[0,"&seswar;"],[0,"&swnwar;"],[8,{v:"&rarrc;",n:824,o:"&nrarrc;"}],[1,"&cudarrr;"],[0,"&ldca;"],[0,"&rdca;"],[0,"&cudarrl;"],[0,"&larrpl;"],[2,"&curarrm;"],[0,"&cularrp;"],[7,"&rarrpl;"],[2,"&harrcir;"],[0,"&Uarrocir;"],[0,"&lurdshar;"],[0,"&ldrushar;"],[2,"&LeftRightVector;"],[0,"&RightUpDownVector;"],[0,"&DownLeftRightVector;"],[0,"&LeftUpDownVector;"],[0,"&LeftVectorBar;"],[0,"&RightVectorBar;"],[0,"&RightUpVectorBar;"],[0,"&RightDownVectorBar;"],[0,"&DownLeftVectorBar;"],[0,"&DownRightVectorBar;"],[0,"&LeftUpVectorBar;"],[0,"&LeftDownVectorBar;"],[0,"&LeftTeeVector;"],[0,"&RightTeeVector;"],[0,"&RightUpTeeVector;"],[0,"&RightDownTeeVector;"],[0,"&DownLeftTeeVector;"],[0,"&DownRightTeeVector;"],[0,"&LeftUpTeeVector;"],[0,"&LeftDownTeeVector;"],[0,"&lHar;"],[0,"&uHar;"],[0,"&rHar;"],[0,"&dHar;"],[0,"&luruhar;"],[0,"&ldrdhar;"],[0,"&ruluhar;"],[0,"&rdldhar;"],[0,"&lharul;"],[0,"&llhard;"],[0,"&rharul;"],[0,"&lrhard;"],[0,"&udhar;"],[0,"&duhar;"],[0,"&RoundImplies;"],[0,"&erarr;"],[0,"&simrarr;"],[0,"&larrsim;"],[0,"&rarrsim;"],[0,"&rarrap;"],[0,"&ltlarr;"],[1,"&gtrarr;"],[0,"&subrarr;"],[1,"&suplarr;"],[0,"&lfisht;"],[0,"&rfisht;"],[0,"&ufisht;"],[0,"&dfisht;"],[5,"&lopar;"],[0,"&ropar;"],[4,"&lbrke;"],[0,"&rbrke;"],[0,"&lbrkslu;"],[0,"&rbrksld;"],[0,"&lbrksld;"],[0,"&rbrkslu;"],[0,"&langd;"],[0,"&rangd;"],[0,"&lparlt;"],[0,"&rpargt;"],[0,"&gtlPar;"],[0,"&ltrPar;"],[3,"&vzigzag;"],[1,"&vangrt;"],[0,"&angrtvbd;"],[6,"&ange;"],[0,"&range;"],[0,"&dwangle;"],[0,"&uwangle;"],[0,"&angmsdaa;"],[0,"&angmsdab;"],[0,"&angmsdac;"],[0,"&angmsdad;"],[0,"&angmsdae;"],[0,"&angmsdaf;"],[0,"&angmsdag;"],[0,"&angmsdah;"],[0,"&bemptyv;"],[0,"&demptyv;"],[0,"&cemptyv;"],[0,"&raemptyv;"],[0,"&laemptyv;"],[0,"&ohbar;"],[0,"&omid;"],[0,"&opar;"],[1,"&operp;"],[1,"&olcross;"],[0,"&odsold;"],[1,"&olcir;"],[0,"&ofcir;"],[0,"&olt;"],[0,"&ogt;"],[0,"&cirscir;"],[0,"&cirE;"],[0,"&solb;"],[0,"&bsolb;"],[3,"&boxbox;"],[3,"&trisb;"],[0,"&rtriltri;"],[0,{v:"&LeftTriangleBar;",n:824,o:"&NotLeftTriangleBar;"}],[0,{v:"&RightTriangleBar;",n:824,o:"&NotRightTriangleBar;"}],[11,"&iinfin;"],[0,"&infintie;"],[0,"&nvinfin;"],[4,"&eparsl;"],[0,"&smeparsl;"],[0,"&eqvparsl;"],[5,"&blacklozenge;"],[8,"&RuleDelayed;"],[1,"&dsol;"],[9,"&bigodot;"],[0,"&bigoplus;"],[0,"&bigotimes;"],[1,"&biguplus;"],[1,"&bigsqcup;"],[5,"&iiiint;"],[0,"&fpartint;"],[2,"&cirfnint;"],[0,"&awint;"],[0,"&rppolint;"],[0,"&scpolint;"],[0,"&npolint;"],[0,"&pointint;"],[0,"&quatint;"],[0,"&intlarhk;"],[10,"&pluscir;"],[0,"&plusacir;"],[0,"&simplus;"],[0,"&plusdu;"],[0,"&plussim;"],[0,"&plustwo;"],[1,"&mcomma;"],[0,"&minusdu;"],[2,"&loplus;"],[0,"&roplus;"],[0,"&Cross;"],[0,"&timesd;"],[0,"&timesbar;"],[1,"&smashp;"],[0,"&lotimes;"],[0,"&rotimes;"],[0,"&otimesas;"],[0,"&Otimes;"],[0,"&odiv;"],[0,"&triplus;"],[0,"&triminus;"],[0,"&tritime;"],[0,"&intprod;"],[2,"&amalg;"],[0,"&capdot;"],[1,"&ncup;"],[0,"&ncap;"],[0,"&capand;"],[0,"&cupor;"],[0,"&cupcap;"],[0,"&capcup;"],[0,"&cupbrcap;"],[0,"&capbrcup;"],[0,"&cupcup;"],[0,"&capcap;"],[0,"&ccups;"],[0,"&ccaps;"],[2,"&ccupssm;"],[2,"&And;"],[0,"&Or;"],[0,"&andand;"],[0,"&oror;"],[0,"&orslope;"],[0,"&andslope;"],[1,"&andv;"],[0,"&orv;"],[0,"&andd;"],[0,"&ord;"],[1,"&wedbar;"],[6,"&sdote;"],[3,"&simdot;"],[2,{v:"&congdot;",n:824,o:"&ncongdot;"}],[0,"&easter;"],[0,"&apacir;"],[0,{v:"&apE;",n:824,o:"&napE;"}],[0,"&eplus;"],[0,"&pluse;"],[0,"&Esim;"],[0,"&Colone;"],[0,"&Equal;"],[1,"&ddotseq;"],[0,"&equivDD;"],[0,"&ltcir;"],[0,"&gtcir;"],[0,"&ltquest;"],[0,"&gtquest;"],[0,{v:"&leqslant;",n:824,o:"&nleqslant;"}],[0,{v:"&geqslant;",n:824,o:"&ngeqslant;"}],[0,"&lesdot;"],[0,"&gesdot;"],[0,"&lesdoto;"],[0,"&gesdoto;"],[0,"&lesdotor;"],[0,"&gesdotol;"],[0,"&lap;"],[0,"&gap;"],[0,"&lne;"],[0,"&gne;"],[0,"&lnap;"],[0,"&gnap;"],[0,"&lEg;"],[0,"&gEl;"],[0,"&lsime;"],[0,"&gsime;"],[0,"&lsimg;"],[0,"&gsiml;"],[0,"&lgE;"],[0,"&glE;"],[0,"&lesges;"],[0,"&gesles;"],[0,"&els;"],[0,"&egs;"],[0,"&elsdot;"],[0,"&egsdot;"],[0,"&el;"],[0,"&eg;"],[2,"&siml;"],[0,"&simg;"],[0,"&simlE;"],[0,"&simgE;"],[0,{v:"&LessLess;",n:824,o:"&NotNestedLessLess;"}],[0,{v:"&GreaterGreater;",n:824,o:"&NotNestedGreaterGreater;"}],[1,"&glj;"],[0,"&gla;"],[0,"&ltcc;"],[0,"&gtcc;"],[0,"&lescc;"],[0,"&gescc;"],[0,"&smt;"],[0,"&lat;"],[0,{v:"&smte;",n:65024,o:"&smtes;"}],[0,{v:"&late;",n:65024,o:"&lates;"}],[0,"&bumpE;"],[0,{v:"&PrecedesEqual;",n:824,o:"&NotPrecedesEqual;"}],[0,{v:"&sce;",n:824,o:"&NotSucceedsEqual;"}],[2,"&prE;"],[0,"&scE;"],[0,"&precneqq;"],[0,"&scnE;"],[0,"&prap;"],[0,"&scap;"],[0,"&precnapprox;"],[0,"&scnap;"],[0,"&Pr;"],[0,"&Sc;"],[0,"&subdot;"],[0,"&supdot;"],[0,"&subplus;"],[0,"&supplus;"],[0,"&submult;"],[0,"&supmult;"],[0,"&subedot;"],[0,"&supedot;"],[0,{v:"&subE;",n:824,o:"&nsubE;"}],[0,{v:"&supE;",n:824,o:"&nsupE;"}],[0,"&subsim;"],[0,"&supsim;"],[2,{v:"&subnE;",n:65024,o:"&varsubsetneqq;"}],[0,{v:"&supnE;",n:65024,o:"&varsupsetneqq;"}],[2,"&csub;"],[0,"&csup;"],[0,"&csube;"],[0,"&csupe;"],[0,"&subsup;"],[0,"&supsub;"],[0,"&subsub;"],[0,"&supsup;"],[0,"&suphsub;"],[0,"&supdsub;"],[0,"&forkv;"],[0,"&topfork;"],[0,"&mlcp;"],[8,"&Dashv;"],[1,"&Vdashl;"],[0,"&Barv;"],[0,"&vBar;"],[0,"&vBarv;"],[1,"&Vbar;"],[0,"&Not;"],[0,"&bNot;"],[0,"&rnmid;"],[0,"&cirmid;"],[0,"&midcir;"],[0,"&topcir;"],[0,"&nhpar;"],[0,"&parsim;"],[9,{v:"&parsl;",n:8421,o:"&nparsl;"}],[44343,{n:new Map(o6([[56476,"&Ascr;"],[1,"&Cscr;"],[0,"&Dscr;"],[2,"&Gscr;"],[2,"&Jscr;"],[0,"&Kscr;"],[2,"&Nscr;"],[0,"&Oscr;"],[0,"&Pscr;"],[0,"&Qscr;"],[1,"&Sscr;"],[0,"&Tscr;"],[0,"&Uscr;"],[0,"&Vscr;"],[0,"&Wscr;"],[0,"&Xscr;"],[0,"&Yscr;"],[0,"&Zscr;"],[0,"&ascr;"],[0,"&bscr;"],[0,"&cscr;"],[0,"&dscr;"],[1,"&fscr;"],[1,"&hscr;"],[0,"&iscr;"],[0,"&jscr;"],[0,"&kscr;"],[0,"&lscr;"],[0,"&mscr;"],[0,"&nscr;"],[1,"&pscr;"],[0,"&qscr;"],[0,"&rscr;"],[0,"&sscr;"],[0,"&tscr;"],[0,"&uscr;"],[0,"&vscr;"],[0,"&wscr;"],[0,"&xscr;"],[0,"&yscr;"],[0,"&zscr;"],[52,"&Afr;"],[0,"&Bfr;"],[1,"&Dfr;"],[0,"&Efr;"],[0,"&Ffr;"],[0,"&Gfr;"],[2,"&Jfr;"],[0,"&Kfr;"],[0,"&Lfr;"],[0,"&Mfr;"],[0,"&Nfr;"],[0,"&Ofr;"],[0,"&Pfr;"],[0,"&Qfr;"],[1,"&Sfr;"],[0,"&Tfr;"],[0,"&Ufr;"],[0,"&Vfr;"],[0,"&Wfr;"],[0,"&Xfr;"],[0,"&Yfr;"],[1,"&afr;"],[0,"&bfr;"],[0,"&cfr;"],[0,"&dfr;"],[0,"&efr;"],[0,"&ffr;"],[0,"&gfr;"],[0,"&hfr;"],[0,"&ifr;"],[0,"&jfr;"],[0,"&kfr;"],[0,"&lfr;"],[0,"&mfr;"],[0,"&nfr;"],[0,"&ofr;"],[0,"&pfr;"],[0,"&qfr;"],[0,"&rfr;"],[0,"&sfr;"],[0,"&tfr;"],[0,"&ufr;"],[0,"&vfr;"],[0,"&wfr;"],[0,"&xfr;"],[0,"&yfr;"],[0,"&zfr;"],[0,"&Aopf;"],[0,"&Bopf;"],[1,"&Dopf;"],[0,"&Eopf;"],[0,"&Fopf;"],[0,"&Gopf;"],[1,"&Iopf;"],[0,"&Jopf;"],[0,"&Kopf;"],[0,"&Lopf;"],[0,"&Mopf;"],[1,"&Oopf;"],[3,"&Sopf;"],[0,"&Topf;"],[0,"&Uopf;"],[0,"&Vopf;"],[0,"&Wopf;"],[0,"&Xopf;"],[0,"&Yopf;"],[1,"&aopf;"],[0,"&bopf;"],[0,"&copf;"],[0,"&dopf;"],[0,"&eopf;"],[0,"&fopf;"],[0,"&gopf;"],[0,"&hopf;"],[0,"&iopf;"],[0,"&jopf;"],[0,"&kopf;"],[0,"&lopf;"],[0,"&mopf;"],[0,"&nopf;"],[0,"&oopf;"],[0,"&popf;"],[0,"&qopf;"],[0,"&ropf;"],[0,"&sopf;"],[0,"&topf;"],[0,"&uopf;"],[0,"&vopf;"],[0,"&wopf;"],[0,"&xopf;"],[0,"&yopf;"],[0,"&zopf;"]]))}],[8906,"&fflig;"],[0,"&filig;"],[0,"&fllig;"],[0,"&ffilig;"],[0,"&ffllig;"]]));var E$e=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]),w$e=String.prototype.codePointAt!=null?(n,e)=>n.codePointAt(e):(n,e)=>(n.charCodeAt(e)&64512)===55296?(n.charCodeAt(e)-55296)*1024+n.charCodeAt(e+1)-56320+65536:n.charCodeAt(e);function DY(n,e){return function(r){let o,s=0,a="";for(;o=n.exec(r);)s!==o.index&&(a+=r.substring(s,o.index)),a+=e.get(o[0].charCodeAt(0)),s=o.index+1;return a+r.substring(s)}}var v0e=DY(/[&<>'"]/g,E$e),y0e=DY(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),b0e=DY(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]]));var _0e;(function(n){n[n.XML=0]="XML",n[n.HTML=1]="HTML"})(_0e||(_0e={}));var x0e;(function(n){n[n.UTF8=0]="UTF8",n[n.ASCII=1]="ASCII",n[n.Extensive=2]="Extensive",n[n.Attribute=3]="Attribute",n[n.Text=4]="Text"})(x0e||(x0e={}));function P$e(n){return Object.prototype.toString.call(n)}function s6(n){return P$e(n)==="[object String]"}var A$e=Object.prototype.hasOwnProperty;function D$e(n,e){return A$e.call(n,e)}function lT(n){return Array.prototype.slice.call(arguments,1).forEach(function(t){if(t){if(typeof t!="object")throw new TypeError(t+"must be object");Object.keys(t).forEach(function(r){n[r]=t[r]})}}),n}function LY(n,e,t){return[].concat(n.slice(0,e),t,n.slice(e+1))}function a6(n){return!(n>=55296&&n<=57343||n>=64976&&n<=65007||(n&65535)===65535||(n&65535)===65534||n>=0&&n<=8||n===11||n>=14&&n<=31||n>=127&&n<=159||n>1114111)}function ID(n){if(n>65535){n-=65536;let e=55296+(n>>10),t=56320+(n&1023);return String.fromCharCode(e,t)}return String.fromCharCode(n)}var T0e=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,N$e=/&([a-z#][a-z0-9]{1,31});/gi,L$e=new RegExp(T0e.source+"|"+N$e.source,"gi"),O$e=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function M$e(n,e){if(e.charCodeAt(0)===35&&O$e.test(e)){let r=e[1].toLowerCase()==="x"?parseInt(e.slice(2),16):parseInt(e.slice(1),10);return a6(r)?ID(r):n}let t=Vv(n);return t!==n?t:n}function F$e(n){return n.indexOf("\\")<0?n:n.replace(T0e,"$1")}function Gv(n){return n.indexOf("\\")<0&&n.indexOf("&")<0?n:n.replace(L$e,function(e,t,r){return t||M$e(e,r)})}var U$e=/[&<>"]/,B$e=/[&<>"]/g,q$e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function j$e(n){return q$e[n]}function uh(n){return U$e.test(n)?n.replace(B$e,j$e):n}var H$e=/[.?*+^$[\]\\(){}|-]/g;function V$e(n){return n.replace(H$e,"\\$&")}function Ln(n){switch(n){case 9:case 32:return!0}return!1}function ix(n){if(n>=8192&&n<=8202)return!0;switch(n){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function ox(n){return cT.test(n)}function sx(n){switch(n){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function ax(n){return n=n.trim().replace(/\s+/g," "),"\u1E9E".toLowerCase()==="\u1E7E"&&(n=n.replace(//g,"\xDF")),n.toLowerCase().toUpperCase()}var G$e={mdurl:e6,ucmicro:wY};var BY={};Dr(BY,{parseLinkDestination:()=>FY,parseLinkLabel:()=>MY,parseLinkTitle:()=>UY});function MY(n,e,t){let r,o,s,a,c=n.posMax,l=n.pos;for(n.pos=e+1,r=1;n.pos<c;){if(s=n.src.charCodeAt(n.pos),s===93&&(r--,r===0)){o=!0;break}if(a=n.pos,n.md.inline.skipToken(n),s===91){if(a===n.pos-1)r++;else if(t)return n.pos=l,-1}}let u=-1;return o&&(u=n.pos),n.pos=l,u}function FY(n,e,t){let r,o=e,s={ok:!1,pos:0,lines:0,str:""};if(n.charCodeAt(o)===60){for(o++;o<t;){if(r=n.charCodeAt(o),r===10||r===60)return s;if(r===62)return s.pos=o+1,s.str=Gv(n.slice(e+1,o)),s.ok=!0,s;if(r===92&&o+1<t){o+=2;continue}o++}return s}let a=0;for(;o<t&&(r=n.charCodeAt(o),!(r===32||r<32||r===127));){if(r===92&&o+1<t){if(n.charCodeAt(o+1)===32)break;o+=2;continue}if(r===40&&(a++,a>32))return s;if(r===41){if(a===0)break;a--}o++}return e===o||a!==0||(s.str=Gv(n.slice(e,o)),s.pos=o,s.ok=!0),s}function UY(n,e,t){let r,o,s=0,a=e,c={ok:!1,pos:0,lines:0,str:""};if(a>=t||(o=n.charCodeAt(a),o!==34&&o!==39&&o!==40))return c;for(a++,o===40&&(o=41);a<t;){if(r=n.charCodeAt(a),r===o)return c.pos=a+1,c.lines=s,c.str=Gv(n.slice(e+1,a)),c.ok=!0,c;if(r===40&&o===41)return c;r===10?s++:r===92&&a+1<t&&(a++,n.charCodeAt(a)===10&&s++),a++}return c}var $p={};$p.code_inline=function(n,e,t,r,o){let s=n[e];return"<code"+o.renderAttrs(s)+">"+uh(s.content)+"</code>"};$p.code_block=function(n,e,t,r,o){let s=n[e];return"<pre"+o.renderAttrs(s)+"><code>"+uh(n[e].content)+`</code></pre>
`};$p.fence=function(n,e,t,r,o){let s=n[e],a=s.info?Gv(s.info).trim():"",c="",l="";if(a){let d=a.split(/(\s+)/g);c=d[0],l=d.slice(2).join("")}let u;if(t.highlight?u=t.highlight(s.content,c,l)||uh(s.content):u=uh(s.content),u.indexOf("<pre")===0)return u+`
`;if(a){let d=s.attrIndex("class"),p=s.attrs?s.attrs.slice():[];d<0?p.push(["class",t.langPrefix+c]):(p[d]=p[d].slice(),p[d][1]+=" "+t.langPrefix+c);let f={attrs:p};return`<pre><code${o.renderAttrs(f)}>${u}</code></pre>
`}return`<pre><code${o.renderAttrs(s)}>${u}</code></pre>
`};$p.image=function(n,e,t,r,o){let s=n[e];return s.attrs[s.attrIndex("alt")][1]=o.renderInlineAsText(s.children,t,r),o.renderToken(n,e,t)};$p.hardbreak=function(n,e,t){return t.xhtmlOut?`<br />
`:`<br>
`};$p.softbreak=function(n,e,t){return t.breaks?t.xhtmlOut?`<br />
`:`<br>
`:`
`};$p.text=function(n,e){return uh(n[e].content)};$p.html_block=function(n,e){return n[e].content};$p.html_inline=function(n,e){return n[e].content};function uT(){this.rules=lT({},$p)}uT.prototype.renderAttrs=function(e){let t,r,o;if(!e.attrs)return"";for(o="",t=0,r=e.attrs.length;t<r;t++)o+=" "+uh(e.attrs[t][0])+'="'+uh(e.attrs[t][1])+'"';return o};uT.prototype.renderToken=function(e,t,r){let o=e[t],s="";if(o.hidden)return"";o.block&&o.nesting!==-1&&t&&e[t-1].hidden&&(s+=`
`),s+=(o.nesting===-1?"</":"<")+o.tag,s+=this.renderAttrs(o),o.nesting===0&&r.xhtmlOut&&(s+=" /");let a=!1;if(o.block&&(a=!0,o.nesting===1&&t+1<e.length)){let c=e[t+1];(c.type==="inline"||c.hidden||c.nesting===-1&&c.tag===o.tag)&&(a=!1)}return s+=a?`>
`:">",s};uT.prototype.renderInline=function(n,e,t){let r="",o=this.rules;for(let s=0,a=n.length;s<a;s++){let c=n[s].type;typeof o[c]<"u"?r+=o[c](n,s,e,t,this):r+=this.renderToken(n,s,e)}return r};uT.prototype.renderInlineAsText=function(n,e,t){let r="";for(let o=0,s=n.length;o<s;o++)switch(n[o].type){case"text":r+=n[o].content;break;case"image":r+=this.renderInlineAsText(n[o].children,e,t);break;case"html_inline":case"html_block":r+=n[o].content;break;case"softbreak":case"hardbreak":r+=`
`;break;default:}return r};uT.prototype.render=function(n,e,t){let r="",o=this.rules;for(let s=0,a=n.length;s<a;s++){let c=n[s].type;c==="inline"?r+=this.renderInline(n[s].children,e,t):typeof o[c]<"u"?r+=o[c](n,s,e,t,this):r+=this.renderToken(n,s,e,t)}return r};var C0e=uT;function Dd(){this.__rules__=[],this.__cache__=null}Dd.prototype.__find__=function(n){for(let e=0;e<this.__rules__.length;e++)if(this.__rules__[e].name===n)return e;return-1};Dd.prototype.__compile__=function(){let n=this,e=[""];n.__rules__.forEach(function(t){t.enabled&&t.alt.forEach(function(r){e.indexOf(r)<0&&e.push(r)})}),n.__cache__={},e.forEach(function(t){n.__cache__[t]=[],n.__rules__.forEach(function(r){r.enabled&&(t&&r.alt.indexOf(t)<0||n.__cache__[t].push(r.fn))})})};Dd.prototype.at=function(n,e,t){let r=this.__find__(n),o=t||{};if(r===-1)throw new Error("Parser rule not found: "+n);this.__rules__[r].fn=e,this.__rules__[r].alt=o.alt||[],this.__cache__=null};Dd.prototype.before=function(n,e,t,r){let o=this.__find__(n),s=r||{};if(o===-1)throw new Error("Parser rule not found: "+n);this.__rules__.splice(o,0,{name:e,enabled:!0,fn:t,alt:s.alt||[]}),this.__cache__=null};Dd.prototype.after=function(n,e,t,r){let o=this.__find__(n),s=r||{};if(o===-1)throw new Error("Parser rule not found: "+n);this.__rules__.splice(o+1,0,{name:e,enabled:!0,fn:t,alt:s.alt||[]}),this.__cache__=null};Dd.prototype.push=function(n,e,t){let r=t||{};this.__rules__.push({name:n,enabled:!0,fn:e,alt:r.alt||[]}),this.__cache__=null};Dd.prototype.enable=function(n,e){Array.isArray(n)||(n=[n]);let t=[];return n.forEach(function(r){let o=this.__find__(r);if(o<0){if(e)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[o].enabled=!0,t.push(r)},this),this.__cache__=null,t};Dd.prototype.enableOnly=function(n,e){Array.isArray(n)||(n=[n]),this.__rules__.forEach(function(t){t.enabled=!1}),this.enable(n,e)};Dd.prototype.disable=function(n,e){Array.isArray(n)||(n=[n]);let t=[];return n.forEach(function(r){let o=this.__find__(r);if(o<0){if(e)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[o].enabled=!1,t.push(r)},this),this.__cache__=null,t};Dd.prototype.getRules=function(n){return this.__cache__===null&&this.__compile__(),this.__cache__[n]||[]};var cx=Dd;function dT(n,e,t){this.type=n,this.tag=e,this.attrs=null,this.map=null,this.nesting=t,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}dT.prototype.attrIndex=function(e){if(!this.attrs)return-1;let t=this.attrs;for(let r=0,o=t.length;r<o;r++)if(t[r][0]===e)return r;return-1};dT.prototype.attrPush=function(e){this.attrs?this.attrs.push(e):this.attrs=[e]};dT.prototype.attrSet=function(e,t){let r=this.attrIndex(e),o=[e,t];r<0?this.attrPush(o):this.attrs[r]=o};dT.prototype.attrGet=function(e){let t=this.attrIndex(e),r=null;return t>=0&&(r=this.attrs[t][1]),r};dT.prototype.attrJoin=function(e,t){let r=this.attrIndex(e);r<0?this.attrPush([e,t]):this.attrs[r][1]=this.attrs[r][1]+" "+t};var dh=dT;function E0e(n,e,t){this.src=n,this.env=t,this.tokens=[],this.inlineMode=!1,this.md=e}E0e.prototype.Token=dh;var w0e=E0e;var z$e=/\r\n?|\n/g,$$e=/\0/g;function qY(n){let e;e=n.src.replace(z$e,`
`),e=e.replace($$e,"\uFFFD"),n.src=e}function jY(n){let e;n.inlineMode?(e=new n.Token("inline","",0),e.content=n.src,e.map=[0,1],e.children=[],n.tokens.push(e)):n.md.block.parse(n.src,n.md,n.env,n.tokens)}function HY(n){let e=n.tokens;for(let t=0,r=e.length;t<r;t++){let o=e[t];o.type==="inline"&&n.md.inline.parse(o.content,n.md,n.env,o.children)}}function W$e(n){return/^<a[>\s]/i.test(n)}function K$e(n){return/^<\/a\s*>/i.test(n)}function VY(n){let e=n.tokens;if(n.md.options.linkify)for(let t=0,r=e.length;t<r;t++){if(e[t].type!=="inline"||!n.md.linkify.pretest(e[t].content))continue;let o=e[t].children,s=0;for(let a=o.length-1;a>=0;a--){let c=o[a];if(c.type==="link_close"){for(a--;o[a].level!==c.level&&o[a].type!=="link_open";)a--;continue}if(c.type==="html_inline"&&(W$e(c.content)&&s>0&&s--,K$e(c.content)&&s++),!(s>0)&&c.type==="text"&&n.md.linkify.test(c.content)){let l=c.content,u=n.md.linkify.match(l),d=[],p=c.level,f=0;u.length>0&&u[0].index===0&&a>0&&o[a-1].type==="text_special"&&(u=u.slice(1));for(let m=0;m<u.length;m++){let h=u[m].url,g=n.md.normalizeLink(h);if(!n.md.validateLink(g))continue;let y=u[m].text;u[m].schema?u[m].schema==="mailto:"&&!/^mailto:/i.test(y)?y=n.md.normalizeLinkText("mailto:"+y).replace(/^mailto:/,""):y=n.md.normalizeLinkText(y):y=n.md.normalizeLinkText("http://"+y).replace(/^http:\/\//,"");let b=u[m].index;if(b>f){let S=new n.Token("text","",0);S.content=l.slice(f,b),S.level=p,d.push(S)}let _=new n.Token("link_open","a",1);_.attrs=[["href",g]],_.level=p++,_.markup="linkify",_.info="auto",d.push(_);let x=new n.Token("text","",0);x.content=y,x.level=p,d.push(x);let I=new n.Token("link_close","a",-1);I.level=--p,I.markup="linkify",I.info="auto",d.push(I),f=u[m].lastIndex}if(f<l.length){let m=new n.Token("text","",0);m.content=l.slice(f),m.level=p,d.push(m)}e[t].children=o=LY(o,a,d)}}}}var k0e=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,Y$e=/\((c|tm|r)\)/i,Q$e=/\((c|tm|r)\)/ig,X$e={c:"\xA9",r:"\xAE",tm:"\u2122"};function J$e(n,e){return X$e[e.toLowerCase()]}function Z$e(n){let e=0;for(let t=n.length-1;t>=0;t--){let r=n[t];r.type==="text"&&!e&&(r.content=r.content.replace(Q$e,J$e)),r.type==="link_open"&&r.info==="auto"&&e--,r.type==="link_close"&&r.info==="auto"&&e++}}function eWe(n){let e=0;for(let t=n.length-1;t>=0;t--){let r=n[t];r.type==="text"&&!e&&k0e.test(r.content)&&(r.content=r.content.replace(/\+-/g,"\xB1").replace(/\.{2,}/g,"\u2026").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1\u2014").replace(/(^|\s)--(?=\s|$)/mg,"$1\u2013").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1\u2013")),r.type==="link_open"&&r.info==="auto"&&e--,r.type==="link_close"&&r.info==="auto"&&e++}}function GY(n){let e;if(n.md.options.typographer)for(e=n.tokens.length-1;e>=0;e--)n.tokens[e].type==="inline"&&(Y$e.test(n.tokens[e].content)&&Z$e(n.tokens[e].children),k0e.test(n.tokens[e].content)&&eWe(n.tokens[e].children))}var tWe=/['"]/,R0e=/['"]/g,P0e="\u2019";function c6(n,e,t){return n.slice(0,e)+t+n.slice(e+1)}function nWe(n,e){let t,r=[];for(let o=0;o<n.length;o++){let s=n[o],a=n[o].level;for(t=r.length-1;t>=0&&!(r[t].level<=a);t--);if(r.length=t+1,s.type!=="text")continue;let c=s.content,l=0,u=c.length;e:for(;l<u;){R0e.lastIndex=l;let d=R0e.exec(c);if(!d)break;let p=!0,f=!0;l=d.index+1;let m=d[0]==="'",h=32;if(d.index-1>=0)h=c.charCodeAt(d.index-1);else for(t=o-1;t>=0&&!(n[t].type==="softbreak"||n[t].type==="hardbreak");t--)if(n[t].content){h=n[t].content.charCodeAt(n[t].content.length-1);break}let g=32;if(l<u)g=c.charCodeAt(l);else for(t=o+1;t<n.length&&!(n[t].type==="softbreak"||n[t].type==="hardbreak");t++)if(n[t].content){g=n[t].content.charCodeAt(0);break}let y=sx(h)||ox(String.fromCharCode(h)),b=sx(g)||ox(String.fromCharCode(g)),_=ix(h),x=ix(g);if(x?p=!1:b&&(_||y||(p=!1)),_?f=!1:y&&(x||b||(f=!1)),g===34&&d[0]==='"'&&h>=48&&h<=57&&(f=p=!1),p&&f&&(p=y,f=b),!p&&!f){m&&(s.content=c6(s.content,d.index,P0e));continue}if(f)for(t=r.length-1;t>=0;t--){let I=r[t];if(r[t].level<a)break;if(I.single===m&&r[t].level===a){I=r[t];let S,w;m?(S=e.md.options.quotes[2],w=e.md.options.quotes[3]):(S=e.md.options.quotes[0],w=e.md.options.quotes[1]),s.content=c6(s.content,d.index,w),n[I.token].content=c6(n[I.token].content,I.pos,S),l+=w.length-1,I.token===o&&(l+=S.length-1),c=s.content,u=c.length,r.length=t;continue e}}p?r.push({token:o,pos:d.index,single:m,level:a}):f&&m&&(s.content=c6(s.content,d.index,P0e))}}}function zY(n){if(n.md.options.typographer)for(let e=n.tokens.length-1;e>=0;e--)n.tokens[e].type!=="inline"||!tWe.test(n.tokens[e].content)||nWe(n.tokens[e].children,n)}function $Y(n){let e,t,r=n.tokens,o=r.length;for(let s=0;s<o;s++){if(r[s].type!=="inline")continue;let a=r[s].children,c=a.length;for(e=0;e<c;e++)a[e].type==="text_special"&&(a[e].type="text");for(e=t=0;e<c;e++)a[e].type==="text"&&e+1<c&&a[e+1].type==="text"?a[e+1].content=a[e].content+a[e+1].content:(e!==t&&(a[t]=a[e]),t++);e!==t&&(a.length=t)}}var WY=[["normalize",qY],["block",jY],["inline",HY],["linkify",VY],["replacements",GY],["smartquotes",zY],["text_join",$Y]];function KY(){this.ruler=new cx;for(let n=0;n<WY.length;n++)this.ruler.push(WY[n][0],WY[n][1])}KY.prototype.process=function(n){let e=this.ruler.getRules("");for(let t=0,r=e.length;t<r;t++)e[t](n)};KY.prototype.State=w0e;var A0e=KY;function Wp(n,e,t,r){this.src=n,this.md=e,this.env=t,this.tokens=r,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;let o=this.src;for(let s=0,a=0,c=0,l=0,u=o.length,d=!1;a<u;a++){let p=o.charCodeAt(a);if(!d)if(Ln(p)){c++,p===9?l+=4-l%4:l++;continue}else d=!0;(p===10||a===u-1)&&(p!==10&&a++,this.bMarks.push(s),this.eMarks.push(a),this.tShift.push(c),this.sCount.push(l),this.bsCount.push(0),d=!1,c=0,l=0,s=a+1)}this.bMarks.push(o.length),this.eMarks.push(o.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}Wp.prototype.push=function(n,e,t){let r=new dh(n,e,t);return r.block=!0,t<0&&this.level--,r.level=this.level,t>0&&this.level++,this.tokens.push(r),r};Wp.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]};Wp.prototype.skipEmptyLines=function(e){for(let t=this.lineMax;e<t&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e};Wp.prototype.skipSpaces=function(e){for(let t=this.src.length;e<t;e++){let r=this.src.charCodeAt(e);if(!Ln(r))break}return e};Wp.prototype.skipSpacesBack=function(e,t){if(e<=t)return e;for(;e>t;)if(!Ln(this.src.charCodeAt(--e)))return e+1;return e};Wp.prototype.skipChars=function(e,t){for(let r=this.src.length;e<r&&this.src.charCodeAt(e)===t;e++);return e};Wp.prototype.skipCharsBack=function(e,t,r){if(e<=r)return e;for(;e>r;)if(t!==this.src.charCodeAt(--e))return e+1;return e};Wp.prototype.getLines=function(e,t,r,o){if(e>=t)return"";let s=new Array(t-e);for(let a=0,c=e;c<t;c++,a++){let l=0,u=this.bMarks[c],d=u,p;for(c+1<t||o?p=this.eMarks[c]+1:p=this.eMarks[c];d<p&&l<r;){let f=this.src.charCodeAt(d);if(Ln(f))f===9?l+=4-(l+this.bsCount[c])%4:l++;else if(d-u<this.tShift[c])l++;else break;d++}l>r?s[a]=new Array(l-r+1).join(" ")+this.src.slice(d,p):s[a]=this.src.slice(d,p)}return s.join("")};Wp.prototype.Token=dh;var D0e=Wp;function YY(n,e){let t=n.bMarks[e]+n.tShift[e],r=n.eMarks[e];return n.src.slice(t,r)}function N0e(n){let e=[],t=n.length,r=0,o=n.charCodeAt(r),s=!1,a=0,c="";for(;r<t;)o===124&&(s?(c+=n.substring(a,r-1),a=r):(e.push(c+n.substring(a,r)),c="",a=r+1)),s=o===92,r++,o=n.charCodeAt(r);return e.push(c+n.substring(a)),e}function QY(n,e,t,r){if(e+2>t)return!1;let o=e+1;if(n.sCount[o]<n.blkIndent||n.sCount[o]-n.blkIndent>=4)return!1;let s=n.bMarks[o]+n.tShift[o];if(s>=n.eMarks[o])return!1;let a=n.src.charCodeAt(s++);if(a!==124&&a!==45&&a!==58||s>=n.eMarks[o])return!1;let c=n.src.charCodeAt(s++);if(c!==124&&c!==45&&c!==58&&!Ln(c)||a===45&&Ln(c))return!1;for(;s<n.eMarks[o];){let x=n.src.charCodeAt(s);if(x!==124&&x!==45&&x!==58&&!Ln(x))return!1;s++}let l=YY(n,e+1),u=l.split("|"),d=[];for(let x=0;x<u.length;x++){let I=u[x].trim();if(!I){if(x===0||x===u.length-1)continue;return!1}if(!/^:?-+:?$/.test(I))return!1;I.charCodeAt(I.length-1)===58?d.push(I.charCodeAt(0)===58?"center":"right"):I.charCodeAt(0)===58?d.push("left"):d.push("")}if(l=YY(n,e).trim(),l.indexOf("|")===-1||n.sCount[e]-n.blkIndent>=4)return!1;u=N0e(l),u.length&&u[0]===""&&u.shift(),u.length&&u[u.length-1]===""&&u.pop();let p=u.length;if(p===0||p!==d.length)return!1;if(r)return!0;let f=n.parentType;n.parentType="table";let m=n.md.block.ruler.getRules("blockquote"),h=n.push("table_open","table",1),g=[e,0];h.map=g;let y=n.push("thead_open","thead",1);y.map=[e,e+1];let b=n.push("tr_open","tr",1);b.map=[e,e+1];for(let x=0;x<u.length;x++){let I=n.push("th_open","th",1);d[x]&&(I.attrs=[["style","text-align:"+d[x]]]);let S=n.push("inline","",0);S.content=u[x].trim(),S.children=[],n.push("th_close","th",-1)}n.push("tr_close","tr",-1),n.push("thead_close","thead",-1);let _;for(o=e+2;o<t&&!(n.sCount[o]<n.blkIndent);o++){let x=!1;for(let S=0,w=m.length;S<w;S++)if(m[S](n,o,t,!0)){x=!0;break}if(x||(l=YY(n,o).trim(),!l)||n.sCount[o]-n.blkIndent>=4)break;if(u=N0e(l),u.length&&u[0]===""&&u.shift(),u.length&&u[u.length-1]===""&&u.pop(),o===e+2){let S=n.push("tbody_open","tbody",1);S.map=_=[e+2,0]}let I=n.push("tr_open","tr",1);I.map=[o,o+1];for(let S=0;S<p;S++){let w=n.push("td_open","td",1);d[S]&&(w.attrs=[["style","text-align:"+d[S]]]);let R=n.push("inline","",0);R.content=u[S]?u[S].trim():"",R.children=[],n.push("td_close","td",-1)}n.push("tr_close","tr",-1)}return _&&(n.push("tbody_close","tbody",-1),_[1]=o),n.push("table_close","table",-1),g[1]=o,n.parentType=f,n.line=o,!0}function XY(n,e,t){if(n.sCount[e]-n.blkIndent<4)return!1;let r=e+1,o=r;for(;r<t;){if(n.isEmpty(r)){r++;continue}if(n.sCount[r]-n.blkIndent>=4){r++,o=r;continue}break}n.line=o;let s=n.push("code_block","code",0);return s.content=n.getLines(e,o,4+n.blkIndent,!1)+`
`,s.map=[e,n.line],!0}function JY(n,e,t,r){let o=n.bMarks[e]+n.tShift[e],s=n.eMarks[e];if(n.sCount[e]-n.blkIndent>=4||o+3>s)return!1;let a=n.src.charCodeAt(o);if(a!==126&&a!==96)return!1;let c=o;o=n.skipChars(o,a);let l=o-c;if(l<3)return!1;let u=n.src.slice(c,o),d=n.src.slice(o,s);if(a===96&&d.indexOf(String.fromCharCode(a))>=0)return!1;if(r)return!0;let p=e,f=!1;for(;p++,!(p>=t||(o=c=n.bMarks[p]+n.tShift[p],s=n.eMarks[p],o<s&&n.sCount[p]<n.blkIndent));)if(n.src.charCodeAt(o)===a&&!(n.sCount[p]-n.blkIndent>=4)&&(o=n.skipChars(o,a),!(o-c<l)&&(o=n.skipSpaces(o),!(o<s)))){f=!0;break}l=n.sCount[e],n.line=p+(f?1:0);let m=n.push("fence","code",0);return m.info=d,m.content=n.getLines(e+1,p,l,!0),m.markup=u,m.map=[e,n.line],!0}function ZY(n,e,t,r){let o=n.bMarks[e]+n.tShift[e],s=n.eMarks[e],a=n.lineMax;if(n.sCount[e]-n.blkIndent>=4||n.src.charCodeAt(o)!==62)return!1;if(r)return!0;let c=[],l=[],u=[],d=[],p=n.md.block.ruler.getRules("blockquote"),f=n.parentType;n.parentType="blockquote";let m=!1,h;for(h=e;h<t;h++){let x=n.sCount[h]<n.blkIndent;if(o=n.bMarks[h]+n.tShift[h],s=n.eMarks[h],o>=s)break;if(n.src.charCodeAt(o++)===62&&!x){let S=n.sCount[h]+1,w,R;n.src.charCodeAt(o)===32?(o++,S++,R=!1,w=!0):n.src.charCodeAt(o)===9?(w=!0,(n.bsCount[h]+S)%4===3?(o++,S++,R=!1):R=!0):w=!1;let k=S;for(c.push(n.bMarks[h]),n.bMarks[h]=o;o<s;){let V=n.src.charCodeAt(o);if(Ln(V))V===9?k+=4-(k+n.bsCount[h]+(R?1:0))%4:k++;else break;o++}m=o>=s,l.push(n.bsCount[h]),n.bsCount[h]=n.sCount[h]+1+(w?1:0),u.push(n.sCount[h]),n.sCount[h]=k-S,d.push(n.tShift[h]),n.tShift[h]=o-n.bMarks[h];continue}if(m)break;let I=!1;for(let S=0,w=p.length;S<w;S++)if(p[S](n,h,t,!0)){I=!0;break}if(I){n.lineMax=h,n.blkIndent!==0&&(c.push(n.bMarks[h]),l.push(n.bsCount[h]),d.push(n.tShift[h]),u.push(n.sCount[h]),n.sCount[h]-=n.blkIndent);break}c.push(n.bMarks[h]),l.push(n.bsCount[h]),d.push(n.tShift[h]),u.push(n.sCount[h]),n.sCount[h]=-1}let g=n.blkIndent;n.blkIndent=0;let y=n.push("blockquote_open","blockquote",1);y.markup=">";let b=[e,0];y.map=b,n.md.block.tokenize(n,e,h);let _=n.push("blockquote_close","blockquote",-1);_.markup=">",n.lineMax=a,n.parentType=f,b[1]=n.line;for(let x=0;x<d.length;x++)n.bMarks[x+e]=c[x],n.tShift[x+e]=d[x],n.sCount[x+e]=u[x],n.bsCount[x+e]=l[x];return n.blkIndent=g,!0}function eQ(n,e,t,r){let o=n.eMarks[e];if(n.sCount[e]-n.blkIndent>=4)return!1;let s=n.bMarks[e]+n.tShift[e],a=n.src.charCodeAt(s++);if(a!==42&&a!==45&&a!==95)return!1;let c=1;for(;s<o;){let u=n.src.charCodeAt(s++);if(u!==a&&!Ln(u))return!1;u===a&&c++}if(c<3)return!1;if(r)return!0;n.line=e+1;let l=n.push("hr","hr",0);return l.map=[e,n.line],l.markup=Array(c+1).join(String.fromCharCode(a)),!0}function L0e(n,e){let t=n.eMarks[e],r=n.bMarks[e]+n.tShift[e],o=n.src.charCodeAt(r++);if(o!==42&&o!==45&&o!==43)return-1;if(r<t){let s=n.src.charCodeAt(r);if(!Ln(s))return-1}return r}function O0e(n,e){let t=n.bMarks[e]+n.tShift[e],r=n.eMarks[e],o=t;if(o+1>=r)return-1;let s=n.src.charCodeAt(o++);if(s<48||s>57)return-1;for(;;){if(o>=r)return-1;if(s=n.src.charCodeAt(o++),s>=48&&s<=57){if(o-t>=10)return-1;continue}if(s===41||s===46)break;return-1}return o<r&&(s=n.src.charCodeAt(o),!Ln(s))?-1:o}function rWe(n,e){let t=n.level+2;for(let r=e+2,o=n.tokens.length-2;r<o;r++)n.tokens[r].level===t&&n.tokens[r].type==="paragraph_open"&&(n.tokens[r+2].hidden=!0,n.tokens[r].hidden=!0,r+=2)}function tQ(n,e,t,r){let o,s,a,c,l=e,u=!0;if(n.sCount[l]-n.blkIndent>=4||n.listIndent>=0&&n.sCount[l]-n.listIndent>=4&&n.sCount[l]<n.blkIndent)return!1;let d=!1;r&&n.parentType==="paragraph"&&n.sCount[l]>=n.blkIndent&&(d=!0);let p,f,m;if((m=O0e(n,l))>=0){if(p=!0,a=n.bMarks[l]+n.tShift[l],f=Number(n.src.slice(a,m-1)),d&&f!==1)return!1}else if((m=L0e(n,l))>=0)p=!1;else return!1;if(d&&n.skipSpaces(m)>=n.eMarks[l])return!1;if(r)return!0;let h=n.src.charCodeAt(m-1),g=n.tokens.length;p?(c=n.push("ordered_list_open","ol",1),f!==1&&(c.attrs=[["start",f]])):c=n.push("bullet_list_open","ul",1);let y=[l,0];c.map=y,c.markup=String.fromCharCode(h);let b=!1,_=n.md.block.ruler.getRules("list"),x=n.parentType;for(n.parentType="list";l<t;){s=m,o=n.eMarks[l];let I=n.sCount[l]+m-(n.bMarks[l]+n.tShift[l]),S=I;for(;s<o;){let A=n.src.charCodeAt(s);if(A===9)S+=4-(S+n.bsCount[l])%4;else if(A===32)S++;else break;s++}let w=s,R;w>=o?R=1:R=S-I,R>4&&(R=1);let k=I+R;c=n.push("list_item_open","li",1),c.markup=String.fromCharCode(h);let V=[l,0];c.map=V,p&&(c.info=n.src.slice(a,m-1));let F=n.tight,K=n.tShift[l],$=n.sCount[l],j=n.listIndent;if(n.listIndent=n.blkIndent,n.blkIndent=k,n.tight=!0,n.tShift[l]=w-n.bMarks[l],n.sCount[l]=S,w>=o&&n.isEmpty(l+1)?n.line=Math.min(n.line+2,t):n.md.block.tokenize(n,l,t,!0),(!n.tight||b)&&(u=!1),b=n.line-l>1&&n.isEmpty(n.line-1),n.blkIndent=n.listIndent,n.listIndent=j,n.tShift[l]=K,n.sCount[l]=$,n.tight=F,c=n.push("list_item_close","li",-1),c.markup=String.fromCharCode(h),l=n.line,V[1]=l,l>=t||n.sCount[l]<n.blkIndent||n.sCount[l]-n.blkIndent>=4)break;let D=!1;for(let A=0,B=_.length;A<B;A++)if(_[A](n,l,t,!0)){D=!0;break}if(D)break;if(p){if(m=O0e(n,l),m<0)break;a=n.bMarks[l]+n.tShift[l]}else if(m=L0e(n,l),m<0)break;if(h!==n.src.charCodeAt(m-1))break}return p?c=n.push("ordered_list_close","ol",-1):c=n.push("bullet_list_close","ul",-1),c.markup=String.fromCharCode(h),y[1]=l,n.line=l,n.parentType=x,u&&rWe(n,g),!0}function nQ(n,e,t,r){let o=0,s=n.bMarks[e]+n.tShift[e],a=n.eMarks[e],c=e+1;if(n.sCount[e]-n.blkIndent>=4||n.src.charCodeAt(s)!==91)return!1;for(;++s<a;)if(n.src.charCodeAt(s)===93&&n.src.charCodeAt(s-1)!==92){if(s+1===a||n.src.charCodeAt(s+1)!==58)return!1;break}let l=n.lineMax,u=n.md.block.ruler.getRules("reference"),d=n.parentType;for(n.parentType="reference";c<l&&!n.isEmpty(c);c++){if(n.sCount[c]-n.blkIndent>3||n.sCount[c]<0)continue;let S=!1;for(let w=0,R=u.length;w<R;w++)if(u[w](n,c,l,!0)){S=!0;break}if(S)break}let p=n.getLines(e,c,n.blkIndent,!1).trim();a=p.length;let f=-1;for(s=1;s<a;s++){let S=p.charCodeAt(s);if(S===91)return!1;if(S===93){f=s;break}else S===10?o++:S===92&&(s++,s<a&&p.charCodeAt(s)===10&&o++)}if(f<0||p.charCodeAt(f+1)!==58)return!1;for(s=f+2;s<a;s++){let S=p.charCodeAt(s);if(S===10)o++;else if(!Ln(S))break}let m=n.md.helpers.parseLinkDestination(p,s,a);if(!m.ok)return!1;let h=n.md.normalizeLink(m.str);if(!n.md.validateLink(h))return!1;s=m.pos,o+=m.lines;let g=s,y=o,b=s;for(;s<a;s++){let S=p.charCodeAt(s);if(S===10)o++;else if(!Ln(S))break}let _=n.md.helpers.parseLinkTitle(p,s,a),x;for(s<a&&b!==s&&_.ok?(x=_.str,s=_.pos,o+=_.lines):(x="",s=g,o=y);s<a;){let S=p.charCodeAt(s);if(!Ln(S))break;s++}if(s<a&&p.charCodeAt(s)!==10&&x)for(x="",s=g,o=y;s<a;){let S=p.charCodeAt(s);if(!Ln(S))break;s++}if(s<a&&p.charCodeAt(s)!==10)return!1;let I=ax(p.slice(1,f));return I?(r||(typeof n.env.references>"u"&&(n.env.references={}),typeof n.env.references[I]>"u"&&(n.env.references[I]={title:x,href:h}),n.parentType=d,n.line=e+o+1),!0):!1}var M0e=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"];var iWe="[a-zA-Z_:][a-zA-Z0-9:._-]*",oWe="[^\"'=<>`\\x00-\\x20]+",sWe="'[^']*'",aWe='"[^"]*"',cWe="(?:"+oWe+"|"+sWe+"|"+aWe+")",lWe="(?:\\s+"+iWe+"(?:\\s*=\\s*"+cWe+")?)",F0e="<[A-Za-z][A-Za-z0-9\\-]*"+lWe+"*\\s*\\/?>",U0e="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",uWe="<!---->|<!--(?:-?[^>-])(?:-?[^-])*-->",dWe="<[?][\\s\\S]*?[?]>",pWe="<![A-Z]+\\s+[^>]*>",fWe="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",B0e=new RegExp("^(?:"+F0e+"|"+U0e+"|"+uWe+"|"+dWe+"|"+pWe+"|"+fWe+")"),q0e=new RegExp("^(?:"+F0e+"|"+U0e+")");var pT=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+M0e.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(q0e.source+"\\s*$"),/^$/,!1]];function rQ(n,e,t,r){let o=n.bMarks[e]+n.tShift[e],s=n.eMarks[e];if(n.sCount[e]-n.blkIndent>=4||!n.md.options.html||n.src.charCodeAt(o)!==60)return!1;let a=n.src.slice(o,s),c=0;for(;c<pT.length&&!pT[c][0].test(a);c++);if(c===pT.length)return!1;if(r)return pT[c][2];let l=e+1;if(!pT[c][1].test(a)){for(;l<t&&!(n.sCount[l]<n.blkIndent);l++)if(o=n.bMarks[l]+n.tShift[l],s=n.eMarks[l],a=n.src.slice(o,s),pT[c][1].test(a)){a.length!==0&&l++;break}}n.line=l;let u=n.push("html_block","",0);return u.map=[e,l],u.content=n.getLines(e,l,n.blkIndent,!0),!0}function iQ(n,e,t,r){let o=n.bMarks[e]+n.tShift[e],s=n.eMarks[e];if(n.sCount[e]-n.blkIndent>=4)return!1;let a=n.src.charCodeAt(o);if(a!==35||o>=s)return!1;let c=1;for(a=n.src.charCodeAt(++o);a===35&&o<s&&c<=6;)c++,a=n.src.charCodeAt(++o);if(c>6||o<s&&!Ln(a))return!1;if(r)return!0;s=n.skipSpacesBack(s,o);let l=n.skipCharsBack(s,35,o);l>o&&Ln(n.src.charCodeAt(l-1))&&(s=l),n.line=e+1;let u=n.push("heading_open","h"+String(c),1);u.markup="########".slice(0,c),u.map=[e,n.line];let d=n.push("inline","",0);d.content=n.src.slice(o,s).trim(),d.map=[e,n.line],d.children=[];let p=n.push("heading_close","h"+String(c),-1);return p.markup="########".slice(0,c),!0}function oQ(n,e,t){let r=n.md.block.ruler.getRules("paragraph");if(n.sCount[e]-n.blkIndent>=4)return!1;let o=n.parentType;n.parentType="paragraph";let s=0,a,c=e+1;for(;c<t&&!n.isEmpty(c);c++){if(n.sCount[c]-n.blkIndent>3)continue;if(n.sCount[c]>=n.blkIndent){let m=n.bMarks[c]+n.tShift[c],h=n.eMarks[c];if(m<h&&(a=n.src.charCodeAt(m),(a===45||a===61)&&(m=n.skipChars(m,a),m=n.skipSpaces(m),m>=h))){s=a===61?1:2;break}}if(n.sCount[c]<0)continue;let f=!1;for(let m=0,h=r.length;m<h;m++)if(r[m](n,c,t,!0)){f=!0;break}if(f)break}if(!s)return!1;let l=n.getLines(e,c,n.blkIndent,!1).trim();n.line=c+1;let u=n.push("heading_open","h"+String(s),1);u.markup=String.fromCharCode(a),u.map=[e,n.line];let d=n.push("inline","",0);d.content=l,d.map=[e,n.line-1],d.children=[];let p=n.push("heading_close","h"+String(s),-1);return p.markup=String.fromCharCode(a),n.parentType=o,!0}function sQ(n,e,t){let r=n.md.block.ruler.getRules("paragraph"),o=n.parentType,s=e+1;for(n.parentType="paragraph";s<t&&!n.isEmpty(s);s++){if(n.sCount[s]-n.blkIndent>3||n.sCount[s]<0)continue;let u=!1;for(let d=0,p=r.length;d<p;d++)if(r[d](n,s,t,!0)){u=!0;break}if(u)break}let a=n.getLines(e,s,n.blkIndent,!1).trim();n.line=s;let c=n.push("paragraph_open","p",1);c.map=[e,n.line];let l=n.push("inline","",0);return l.content=a,l.map=[e,n.line],l.children=[],n.push("paragraph_close","p",-1),n.parentType=o,!0}var l6=[["table",QY,["paragraph","reference"]],["code",XY],["fence",JY,["paragraph","reference","blockquote","list"]],["blockquote",ZY,["paragraph","reference","blockquote","list"]],["hr",eQ,["paragraph","reference","blockquote","list"]],["list",tQ,["paragraph","reference","blockquote"]],["reference",nQ],["html_block",rQ,["paragraph","reference","blockquote"]],["heading",iQ,["paragraph","reference","blockquote"]],["lheading",oQ],["paragraph",sQ]];function u6(){this.ruler=new cx;for(let n=0;n<l6.length;n++)this.ruler.push(l6[n][0],l6[n][1],{alt:(l6[n][2]||[]).slice()})}u6.prototype.tokenize=function(n,e,t){let r=this.ruler.getRules(""),o=r.length,s=n.md.options.maxNesting,a=e,c=!1;for(;a<t&&(n.line=a=n.skipEmptyLines(a),!(a>=t||n.sCount[a]<n.blkIndent));){if(n.level>=s){n.line=t;break}let l=n.line,u=!1;for(let d=0;d<o;d++)if(u=r[d](n,a,t,!1),u){if(l>=n.line)throw new Error("block rule didn't increment state.line");break}if(!u)throw new Error("none of the block rules matched");n.tight=!c,n.isEmpty(n.line-1)&&(c=!0),a=n.line,a<t&&n.isEmpty(a)&&(c=!0,a++,n.line=a)}};u6.prototype.parse=function(n,e,t,r){if(!n)return;let o=new this.State(n,e,t,r);this.tokenize(o,o.line,o.lineMax)};u6.prototype.State=D0e;var j0e=u6;function TD(n,e,t,r){this.src=n,this.env=t,this.md=e,this.tokens=r,this.tokens_meta=Array(r.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}TD.prototype.pushPending=function(){let n=new dh("text","",0);return n.content=this.pending,n.level=this.pendingLevel,this.tokens.push(n),this.pending="",n};TD.prototype.push=function(n,e,t){this.pending&&this.pushPending();let r=new dh(n,e,t),o=null;return t<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),r.level=this.level,t>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],o={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(r),this.tokens_meta.push(o),r};TD.prototype.scanDelims=function(n,e){let t,r,o=!0,s=!0,a=this.posMax,c=this.src.charCodeAt(n),l=n>0?this.src.charCodeAt(n-1):32,u=n;for(;u<a&&this.src.charCodeAt(u)===c;)u++;let d=u-n,p=u<a?this.src.charCodeAt(u):32,f=sx(l)||ox(String.fromCharCode(l)),m=sx(p)||ox(String.fromCharCode(p)),h=ix(l),g=ix(p);return g?o=!1:m&&(h||f||(o=!1)),h?s=!1:f&&(g||m||(s=!1)),e?(t=o,r=s):(t=o&&(!s||f),r=s&&(!o||m)),{can_open:t,can_close:r,length:d}};TD.prototype.Token=dh;var H0e=TD;function mWe(n){switch(n){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}function aQ(n,e){let t=n.pos;for(;t<n.posMax&&!mWe(n.src.charCodeAt(t));)t++;return t===n.pos?!1:(e||(n.pending+=n.src.slice(n.pos,t)),n.pos=t,!0)}var hWe=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;function cQ(n,e){if(!n.md.options.linkify||n.linkLevel>0)return!1;let t=n.pos,r=n.posMax;if(t+3>r||n.src.charCodeAt(t)!==58||n.src.charCodeAt(t+1)!==47||n.src.charCodeAt(t+2)!==47)return!1;let o=n.pending.match(hWe);if(!o)return!1;let s=o[1],a=n.md.linkify.matchAtStart(n.src.slice(t-s.length));if(!a)return!1;let c=a.url;if(c.length<=s.length)return!1;c=c.replace(/\*+$/,"");let l=n.md.normalizeLink(c);if(!n.md.validateLink(l))return!1;if(!e){n.pending=n.pending.slice(0,-s.length);let u=n.push("link_open","a",1);u.attrs=[["href",l]],u.markup="linkify",u.info="auto";let d=n.push("text","",0);d.content=n.md.normalizeLinkText(c);let p=n.push("link_close","a",-1);p.markup="linkify",p.info="auto"}return n.pos+=c.length-s.length,!0}function lQ(n,e){let t=n.pos;if(n.src.charCodeAt(t)!==10)return!1;let r=n.pending.length-1,o=n.posMax;if(!e)if(r>=0&&n.pending.charCodeAt(r)===32)if(r>=1&&n.pending.charCodeAt(r-1)===32){let s=r-1;for(;s>=1&&n.pending.charCodeAt(s-1)===32;)s--;n.pending=n.pending.slice(0,s),n.push("hardbreak","br",0)}else n.pending=n.pending.slice(0,-1),n.push("softbreak","br",0);else n.push("softbreak","br",0);for(t++;t<o&&Ln(n.src.charCodeAt(t));)t++;return n.pos=t,!0}var uQ=[];for(let n=0;n<256;n++)uQ.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(n){uQ[n.charCodeAt(0)]=1});function dQ(n,e){let t=n.pos,r=n.posMax;if(n.src.charCodeAt(t)!==92||(t++,t>=r))return!1;let o=n.src.charCodeAt(t);if(o===10){for(e||n.push("hardbreak","br",0),t++;t<r&&(o=n.src.charCodeAt(t),!!Ln(o));)t++;return n.pos=t,!0}let s=n.src[t];if(o>=55296&&o<=56319&&t+1<r){let c=n.src.charCodeAt(t+1);c>=56320&&c<=57343&&(s+=n.src[t+1],t++)}let a="\\"+s;if(!e){let c=n.push("text_special","",0);o<256&&uQ[o]!==0?c.content=s:c.content=a,c.markup=a,c.info="escape"}return n.pos=t+1,!0}function pQ(n,e){let t=n.pos;if(n.src.charCodeAt(t)!==96)return!1;let o=t;t++;let s=n.posMax;for(;t<s&&n.src.charCodeAt(t)===96;)t++;let a=n.src.slice(o,t),c=a.length;if(n.backticksScanned&&(n.backticks[c]||0)<=o)return e||(n.pending+=a),n.pos+=c,!0;let l=t,u;for(;(u=n.src.indexOf("`",l))!==-1;){for(l=u+1;l<s&&n.src.charCodeAt(l)===96;)l++;let d=l-u;if(d===c){if(!e){let p=n.push("code_inline","code",0);p.markup=a,p.content=n.src.slice(t,u).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return n.pos=l,!0}n.backticks[d]=u}return n.backticksScanned=!0,e||(n.pending+=a),n.pos+=c,!0}function gWe(n,e){let t=n.pos,r=n.src.charCodeAt(t);if(e||r!==126)return!1;let o=n.scanDelims(n.pos,!0),s=o.length,a=String.fromCharCode(r);if(s<2)return!1;let c;s%2&&(c=n.push("text","",0),c.content=a,s--);for(let l=0;l<s;l+=2)c=n.push("text","",0),c.content=a+a,n.delimiters.push({marker:r,length:0,token:n.tokens.length-1,end:-1,open:o.can_open,close:o.can_close});return n.pos+=o.length,!0}function V0e(n,e){let t,r=[],o=e.length;for(let s=0;s<o;s++){let a=e[s];if(a.marker!==126||a.end===-1)continue;let c=e[a.end];t=n.tokens[a.token],t.type="s_open",t.tag="s",t.nesting=1,t.markup="~~",t.content="",t=n.tokens[c.token],t.type="s_close",t.tag="s",t.nesting=-1,t.markup="~~",t.content="",n.tokens[c.token-1].type==="text"&&n.tokens[c.token-1].content==="~"&&r.push(c.token-1)}for(;r.length;){let s=r.pop(),a=s+1;for(;a<n.tokens.length&&n.tokens[a].type==="s_close";)a++;a--,s!==a&&(t=n.tokens[a],n.tokens[a]=n.tokens[s],n.tokens[s]=t)}}function vWe(n){let e=n.tokens_meta,t=n.tokens_meta.length;V0e(n,n.delimiters);for(let r=0;r<t;r++)e[r]&&e[r].delimiters&&V0e(n,e[r].delimiters)}var fQ={tokenize:gWe,postProcess:vWe};function yWe(n,e){let t=n.pos,r=n.src.charCodeAt(t);if(e||r!==95&&r!==42)return!1;let o=n.scanDelims(n.pos,r===42);for(let s=0;s<o.length;s++){let a=n.push("text","",0);a.content=String.fromCharCode(r),n.delimiters.push({marker:r,length:o.length,token:n.tokens.length-1,end:-1,open:o.can_open,close:o.can_close})}return n.pos+=o.length,!0}function G0e(n,e){let t=e.length;for(let r=t-1;r>=0;r--){let o=e[r];if(o.marker!==95&&o.marker!==42||o.end===-1)continue;let s=e[o.end],a=r>0&&e[r-1].end===o.end+1&&e[r-1].marker===o.marker&&e[r-1].token===o.token-1&&e[o.end+1].token===s.token+1,c=String.fromCharCode(o.marker),l=n.tokens[o.token];l.type=a?"strong_open":"em_open",l.tag=a?"strong":"em",l.nesting=1,l.markup=a?c+c:c,l.content="";let u=n.tokens[s.token];u.type=a?"strong_close":"em_close",u.tag=a?"strong":"em",u.nesting=-1,u.markup=a?c+c:c,u.content="",a&&(n.tokens[e[r-1].token].content="",n.tokens[e[o.end+1].token].content="",r--)}}function bWe(n){let e=n.tokens_meta,t=n.tokens_meta.length;G0e(n,n.delimiters);for(let r=0;r<t;r++)e[r]&&e[r].delimiters&&G0e(n,e[r].delimiters)}var mQ={tokenize:yWe,postProcess:bWe};function hQ(n,e){let t,r,o,s,a="",c="",l=n.pos,u=!0;if(n.src.charCodeAt(n.pos)!==91)return!1;let d=n.pos,p=n.posMax,f=n.pos+1,m=n.md.helpers.parseLinkLabel(n,n.pos,!0);if(m<0)return!1;let h=m+1;if(h<p&&n.src.charCodeAt(h)===40){for(u=!1,h++;h<p&&(t=n.src.charCodeAt(h),!(!Ln(t)&&t!==10));h++);if(h>=p)return!1;if(l=h,o=n.md.helpers.parseLinkDestination(n.src,h,n.posMax),o.ok){for(a=n.md.normalizeLink(o.str),n.md.validateLink(a)?h=o.pos:a="",l=h;h<p&&(t=n.src.charCodeAt(h),!(!Ln(t)&&t!==10));h++);if(o=n.md.helpers.parseLinkTitle(n.src,h,n.posMax),h<p&&l!==h&&o.ok)for(c=o.str,h=o.pos;h<p&&(t=n.src.charCodeAt(h),!(!Ln(t)&&t!==10));h++);}(h>=p||n.src.charCodeAt(h)!==41)&&(u=!0),h++}if(u){if(typeof n.env.references>"u")return!1;if(h<p&&n.src.charCodeAt(h)===91?(l=h+1,h=n.md.helpers.parseLinkLabel(n,h),h>=0?r=n.src.slice(l,h++):h=m+1):h=m+1,r||(r=n.src.slice(f,m)),s=n.env.references[ax(r)],!s)return n.pos=d,!1;a=s.href,c=s.title}if(!e){n.pos=f,n.posMax=m;let g=n.push("link_open","a",1),y=[["href",a]];g.attrs=y,c&&y.push(["title",c]),n.linkLevel++,n.md.inline.tokenize(n),n.linkLevel--,n.push("link_close","a",-1)}return n.pos=h,n.posMax=p,!0}function gQ(n,e){let t,r,o,s,a,c,l,u,d="",p=n.pos,f=n.posMax;if(n.src.charCodeAt(n.pos)!==33||n.src.charCodeAt(n.pos+1)!==91)return!1;let m=n.pos+2,h=n.md.helpers.parseLinkLabel(n,n.pos+1,!1);if(h<0)return!1;if(s=h+1,s<f&&n.src.charCodeAt(s)===40){for(s++;s<f&&(t=n.src.charCodeAt(s),!(!Ln(t)&&t!==10));s++);if(s>=f)return!1;for(u=s,c=n.md.helpers.parseLinkDestination(n.src,s,n.posMax),c.ok&&(d=n.md.normalizeLink(c.str),n.md.validateLink(d)?s=c.pos:d=""),u=s;s<f&&(t=n.src.charCodeAt(s),!(!Ln(t)&&t!==10));s++);if(c=n.md.helpers.parseLinkTitle(n.src,s,n.posMax),s<f&&u!==s&&c.ok)for(l=c.str,s=c.pos;s<f&&(t=n.src.charCodeAt(s),!(!Ln(t)&&t!==10));s++);else l="";if(s>=f||n.src.charCodeAt(s)!==41)return n.pos=p,!1;s++}else{if(typeof n.env.references>"u")return!1;if(s<f&&n.src.charCodeAt(s)===91?(u=s+1,s=n.md.helpers.parseLinkLabel(n,s),s>=0?o=n.src.slice(u,s++):s=h+1):s=h+1,o||(o=n.src.slice(m,h)),a=n.env.references[ax(o)],!a)return n.pos=p,!1;d=a.href,l=a.title}if(!e){r=n.src.slice(m,h);let g=[];n.md.inline.parse(r,n.md,n.env,g);let y=n.push("image","img",0),b=[["src",d],["alt",""]];y.attrs=b,y.children=g,y.content=r,l&&b.push(["title",l])}return n.pos=s,n.posMax=f,!0}var _We=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,xWe=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;function vQ(n,e){let t=n.pos;if(n.src.charCodeAt(t)!==60)return!1;let r=n.pos,o=n.posMax;for(;;){if(++t>=o)return!1;let a=n.src.charCodeAt(t);if(a===60)return!1;if(a===62)break}let s=n.src.slice(r+1,t);if(xWe.test(s)){let a=n.md.normalizeLink(s);if(!n.md.validateLink(a))return!1;if(!e){let c=n.push("link_open","a",1);c.attrs=[["href",a]],c.markup="autolink",c.info="auto";let l=n.push("text","",0);l.content=n.md.normalizeLinkText(s);let u=n.push("link_close","a",-1);u.markup="autolink",u.info="auto"}return n.pos+=s.length+2,!0}if(_We.test(s)){let a=n.md.normalizeLink("mailto:"+s);if(!n.md.validateLink(a))return!1;if(!e){let c=n.push("link_open","a",1);c.attrs=[["href",a]],c.markup="autolink",c.info="auto";let l=n.push("text","",0);l.content=n.md.normalizeLinkText(s);let u=n.push("link_close","a",-1);u.markup="autolink",u.info="auto"}return n.pos+=s.length+2,!0}return!1}function SWe(n){return/^<a[>\s]/i.test(n)}function IWe(n){return/^<\/a\s*>/i.test(n)}function TWe(n){let e=n|32;return e>=97&&e<=122}function yQ(n,e){if(!n.md.options.html)return!1;let t=n.posMax,r=n.pos;if(n.src.charCodeAt(r)!==60||r+2>=t)return!1;let o=n.src.charCodeAt(r+1);if(o!==33&&o!==63&&o!==47&&!TWe(o))return!1;let s=n.src.slice(r).match(B0e);if(!s)return!1;if(!e){let a=n.push("html_inline","",0);a.content=s[0],SWe(a.content)&&n.linkLevel++,IWe(a.content)&&n.linkLevel--}return n.pos+=s[0].length,!0}var CWe=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,EWe=/^&([a-z][a-z0-9]{1,31});/i;function bQ(n,e){let t=n.pos,r=n.posMax;if(n.src.charCodeAt(t)!==38||t+1>=r)return!1;if(n.src.charCodeAt(t+1)===35){let s=n.src.slice(t).match(CWe);if(s){if(!e){let a=s[1][0].toLowerCase()==="x"?parseInt(s[1].slice(1),16):parseInt(s[1],10),c=n.push("text_special","",0);c.content=a6(a)?ID(a):ID(65533),c.markup=s[0],c.info="entity"}return n.pos+=s[0].length,!0}}else{let s=n.src.slice(t).match(EWe);if(s){let a=Vv(s[0]);if(a!==s[0]){if(!e){let c=n.push("text_special","",0);c.content=a,c.markup=s[0],c.info="entity"}return n.pos+=s[0].length,!0}}}return!1}function z0e(n){let e={},t=n.length;if(!t)return;let r=0,o=-2,s=[];for(let a=0;a<t;a++){let c=n[a];if(s.push(0),(n[r].marker!==c.marker||o!==c.token-1)&&(r=a),o=c.token,c.length=c.length||0,!c.close)continue;e.hasOwnProperty(c.marker)||(e[c.marker]=[-1,-1,-1,-1,-1,-1]);let l=e[c.marker][(c.open?3:0)+c.length%3],u=r-s[r]-1,d=u;for(;u>l;u-=s[u]+1){let p=n[u];if(p.marker===c.marker&&p.open&&p.end<0){let f=!1;if((p.close||c.open)&&(p.length+c.length)%3===0&&(p.length%3!==0||c.length%3!==0)&&(f=!0),!f){let m=u>0&&!n[u-1].open?s[u-1]+1:0;s[a]=a-u+m,s[u]=m,c.open=!1,p.end=a,p.close=!1,d=-1,o=-2;break}}}d!==-1&&(e[c.marker][(c.open?3:0)+(c.length||0)%3]=d)}}function _Q(n){let e=n.tokens_meta,t=n.tokens_meta.length;z0e(n.delimiters);for(let r=0;r<t;r++)e[r]&&e[r].delimiters&&z0e(e[r].delimiters)}function xQ(n){let e,t,r=0,o=n.tokens,s=n.tokens.length;for(e=t=0;e<s;e++)o[e].nesting<0&&r--,o[e].level=r,o[e].nesting>0&&r++,o[e].type==="text"&&e+1<s&&o[e+1].type==="text"?o[e+1].content=o[e].content+o[e+1].content:(e!==t&&(o[t]=o[e]),t++);e!==t&&(o.length=t)}var SQ=[["text",aQ],["linkify",cQ],["newline",lQ],["escape",dQ],["backticks",pQ],["strikethrough",fQ.tokenize],["emphasis",mQ.tokenize],["link",hQ],["image",gQ],["autolink",vQ],["html_inline",yQ],["entity",bQ]],IQ=[["balance_pairs",_Q],["strikethrough",fQ.postProcess],["emphasis",mQ.postProcess],["fragments_join",xQ]];function CD(){this.ruler=new cx;for(let n=0;n<SQ.length;n++)this.ruler.push(SQ[n][0],SQ[n][1]);this.ruler2=new cx;for(let n=0;n<IQ.length;n++)this.ruler2.push(IQ[n][0],IQ[n][1])}CD.prototype.skipToken=function(n){let e=n.pos,t=this.ruler.getRules(""),r=t.length,o=n.md.options.maxNesting,s=n.cache;if(typeof s[e]<"u"){n.pos=s[e];return}let a=!1;if(n.level<o){for(let c=0;c<r;c++)if(n.level++,a=t[c](n,!0),n.level--,a){if(e>=n.pos)throw new Error("inline rule didn't increment state.pos");break}}else n.pos=n.posMax;a||n.pos++,s[e]=n.pos};CD.prototype.tokenize=function(n){let e=this.ruler.getRules(""),t=e.length,r=n.posMax,o=n.md.options.maxNesting;for(;n.pos<r;){let s=n.pos,a=!1;if(n.level<o){for(let c=0;c<t;c++)if(a=e[c](n,!1),a){if(s>=n.pos)throw new Error("inline rule didn't increment state.pos");break}}if(a){if(n.pos>=r)break;continue}n.pending+=n.src[n.pos++]}n.pending&&n.pushPending()};CD.prototype.parse=function(n,e,t,r){let o=new this.State(n,e,t,r);this.tokenize(o);let s=this.ruler2.getRules(""),a=s.length;for(let c=0;c<a;c++)s[c](o)};CD.prototype.State=H0e;var $0e=CD;function W0e(n){let e={};n=n||{},e.src_Any=t6.source,e.src_Cc=n6.source,e.src_Z=r6.source,e.src_P=cT.source,e.src_ZPCc=[e.src_Z,e.src_P,e.src_Cc].join("|"),e.src_ZCc=[e.src_Z,e.src_Cc].join("|");let t="[><\uFF5C]";return e.src_pseudo_letter="(?:(?!"+t+"|"+e.src_ZPCc+")"+e.src_Any+")",e.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",e.src_auth="(?:(?:(?!"+e.src_ZCc+"|[@/\\[\\]()]).)+@)?",e.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",e.src_host_terminator="(?=$|"+t+"|"+e.src_ZPCc+")(?!"+(n["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+e.src_ZPCc+"))",e.src_path="(?:[/?#](?:(?!"+e.src_ZCc+"|"+t+`|[()[\\]{}.,"'?!\\-;]).|\\[(?:(?!`+e.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+e.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+e.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+e.src_ZCc+`|["]).)+\\"|\\'(?:(?!`+e.src_ZCc+"|[']).)+\\'|\\'(?="+e.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+e.src_ZCc+"|[.]|$)|"+(n["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+e.src_ZCc+"|$)|;(?!"+e.src_ZCc+"|$)|\\!+(?!"+e.src_ZCc+"|[!]|$)|\\?(?!"+e.src_ZCc+"|[?]|$))+|\\/)?",e.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',e.src_xn="xn--[a-z0-9\\-]{1,59}",e.src_domain_root="(?:"+e.src_xn+"|"+e.src_pseudo_letter+"{1,63})",e.src_domain="(?:"+e.src_xn+"|(?:"+e.src_pseudo_letter+")|(?:"+e.src_pseudo_letter+"(?:-|"+e.src_pseudo_letter+"){0,61}"+e.src_pseudo_letter+"))",e.src_host="(?:(?:(?:(?:"+e.src_domain+")\\.)*"+e.src_domain+"))",e.tpl_host_fuzzy="(?:"+e.src_ip4+"|(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%)))",e.tpl_host_no_ip_fuzzy="(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%))",e.src_host_strict=e.src_host+e.src_host_terminator,e.tpl_host_fuzzy_strict=e.tpl_host_fuzzy+e.src_host_terminator,e.src_host_port_strict=e.src_host+e.src_port+e.src_host_terminator,e.tpl_host_port_fuzzy_strict=e.tpl_host_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_port_no_ip_fuzzy_strict=e.tpl_host_no_ip_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+e.src_ZPCc+"|>|$))",e.tpl_email_fuzzy="(^|"+t+'|"|\\(|'+e.src_ZCc+")("+e.src_email_name+"@"+e.tpl_host_fuzzy_strict+")",e.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|\uFF5C]|"+e.src_ZPCc+"))((?![$+<=>^`|\uFF5C])"+e.tpl_host_port_fuzzy_strict+e.src_path+")",e.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|\uFF5C]|"+e.src_ZPCc+"))((?![$+<=>^`|\uFF5C])"+e.tpl_host_port_no_ip_fuzzy_strict+e.src_path+")",e}function TQ(n){return Array.prototype.slice.call(arguments,1).forEach(function(t){t&&Object.keys(t).forEach(function(r){n[r]=t[r]})}),n}function p6(n){return Object.prototype.toString.call(n)}function wWe(n){return p6(n)==="[object String]"}function kWe(n){return p6(n)==="[object Object]"}function RWe(n){return p6(n)==="[object RegExp]"}function K0e(n){return p6(n)==="[object Function]"}function PWe(n){return n.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}var Q0e={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};function AWe(n){return Object.keys(n||{}).reduce(function(e,t){return e||Q0e.hasOwnProperty(t)},!1)}var DWe={"http:":{validate:function(n,e,t){let r=n.slice(e);return t.re.http||(t.re.http=new RegExp("^\\/\\/"+t.re.src_auth+t.re.src_host_port_strict+t.re.src_path,"i")),t.re.http.test(r)?r.match(t.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(n,e,t){let r=n.slice(e);return t.re.no_http||(t.re.no_http=new RegExp("^"+t.re.src_auth+"(?:localhost|(?:(?:"+t.re.src_domain+")\\.)+"+t.re.src_domain_root+")"+t.re.src_port+t.re.src_host_terminator+t.re.src_path,"i")),t.re.no_http.test(r)?e>=3&&n[e-3]===":"||e>=3&&n[e-3]==="/"?0:r.match(t.re.no_http)[0].length:0}},"mailto:":{validate:function(n,e,t){let r=n.slice(e);return t.re.mailto||(t.re.mailto=new RegExp("^"+t.re.src_email_name+"@"+t.re.src_host_strict,"i")),t.re.mailto.test(r)?r.match(t.re.mailto)[0].length:0}}},NWe="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",LWe="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|\u0440\u0444".split("|");function OWe(n){n.__index__=-1,n.__text_cache__=""}function MWe(n){return function(e,t){let r=e.slice(t);return n.test(r)?r.match(n)[0].length:0}}function Y0e(){return function(n,e){e.normalize(n)}}function d6(n){let e=n.re=W0e(n.__opts__),t=n.__tlds__.slice();n.onCompile(),n.__tlds_replaced__||t.push(NWe),t.push(e.src_xn),e.src_tlds=t.join("|");function r(c){return c.replace("%TLDS%",e.src_tlds)}e.email_fuzzy=RegExp(r(e.tpl_email_fuzzy),"i"),e.link_fuzzy=RegExp(r(e.tpl_link_fuzzy),"i"),e.link_no_ip_fuzzy=RegExp(r(e.tpl_link_no_ip_fuzzy),"i"),e.host_fuzzy_test=RegExp(r(e.tpl_host_fuzzy_test),"i");let o=[];n.__compiled__={};function s(c,l){throw new Error('(LinkifyIt) Invalid schema "'+c+'": '+l)}Object.keys(n.__schemas__).forEach(function(c){let l=n.__schemas__[c];if(l===null)return;let u={validate:null,link:null};if(n.__compiled__[c]=u,kWe(l)){RWe(l.validate)?u.validate=MWe(l.validate):K0e(l.validate)?u.validate=l.validate:s(c,l),K0e(l.normalize)?u.normalize=l.normalize:l.normalize?s(c,l):u.normalize=Y0e();return}if(wWe(l)){o.push(c);return}s(c,l)}),o.forEach(function(c){n.__compiled__[n.__schemas__[c]]&&(n.__compiled__[c].validate=n.__compiled__[n.__schemas__[c]].validate,n.__compiled__[c].normalize=n.__compiled__[n.__schemas__[c]].normalize)}),n.__compiled__[""]={validate:null,normalize:Y0e()};let a=Object.keys(n.__compiled__).filter(function(c){return c.length>0&&n.__compiled__[c]}).map(PWe).join("|");n.re.schema_test=RegExp("(^|(?!_)(?:[><\uFF5C]|"+e.src_ZPCc+"))("+a+")","i"),n.re.schema_search=RegExp("(^|(?!_)(?:[><\uFF5C]|"+e.src_ZPCc+"))("+a+")","ig"),n.re.schema_at_start=RegExp("^"+n.re.schema_search.source,"i"),n.re.pretest=RegExp("("+n.re.schema_test.source+")|("+n.re.host_fuzzy_test.source+")|@","i"),OWe(n)}function FWe(n,e){let t=n.__index__,r=n.__last_index__,o=n.__text_cache__.slice(t,r);this.schema=n.__schema__.toLowerCase(),this.index=t+e,this.lastIndex=r+e,this.raw=o,this.text=o,this.url=o}function CQ(n,e){let t=new FWe(n,e);return n.__compiled__[t.schema].normalize(t,n),t}function bl(n,e){if(!(this instanceof bl))return new bl(n,e);e||AWe(n)&&(e=n,n={}),this.__opts__=TQ({},Q0e,e),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=TQ({},DWe,n),this.__compiled__={},this.__tlds__=LWe,this.__tlds_replaced__=!1,this.re={},d6(this)}bl.prototype.add=function(e,t){return this.__schemas__[e]=t,d6(this),this};bl.prototype.set=function(e){return this.__opts__=TQ(this.__opts__,e),this};bl.prototype.test=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return!1;let t,r,o,s,a,c,l,u,d;if(this.re.schema_test.test(e)){for(l=this.re.schema_search,l.lastIndex=0;(t=l.exec(e))!==null;)if(s=this.testSchemaAt(e,t[2],l.lastIndex),s){this.__schema__=t[2],this.__index__=t.index+t[1].length,this.__last_index__=t.index+t[0].length+s;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(u=e.search(this.re.host_fuzzy_test),u>=0&&(this.__index__<0||u<this.__index__)&&(r=e.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))!==null&&(a=r.index+r[1].length,(this.__index__<0||a<this.__index__)&&(this.__schema__="",this.__index__=a,this.__last_index__=r.index+r[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(d=e.indexOf("@"),d>=0&&(o=e.match(this.re.email_fuzzy))!==null&&(a=o.index+o[1].length,c=o.index+o[0].length,(this.__index__<0||a<this.__index__||a===this.__index__&&c>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=a,this.__last_index__=c))),this.__index__>=0};bl.prototype.pretest=function(e){return this.re.pretest.test(e)};bl.prototype.testSchemaAt=function(e,t,r){return this.__compiled__[t.toLowerCase()]?this.__compiled__[t.toLowerCase()].validate(e,r,this):0};bl.prototype.match=function(e){let t=[],r=0;this.__index__>=0&&this.__text_cache__===e&&(t.push(CQ(this,r)),r=this.__last_index__);let o=r?e.slice(r):e;for(;this.test(o);)t.push(CQ(this,r)),o=o.slice(this.__last_index__),r+=this.__last_index__;return t.length?t:null};bl.prototype.matchAtStart=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return null;let t=this.re.schema_at_start.exec(e);if(!t)return null;let r=this.testSchemaAt(e,t[2],t[0].length);return r?(this.__schema__=t[2],this.__index__=t.index+t[1].length,this.__last_index__=t.index+t[0].length+r,CQ(this,0)):null};bl.prototype.tlds=function(e,t){return e=Array.isArray(e)?e:[e],t?(this.__tlds__=this.__tlds__.concat(e).sort().filter(function(r,o,s){return r!==s[o-1]}).reverse(),d6(this),this):(this.__tlds__=e.slice(),this.__tlds_replaced__=!0,d6(this),this)};bl.prototype.normalize=function(e){e.schema||(e.url="http://"+e.url),e.schema==="mailto:"&&!/^mailto:/i.test(e.url)&&(e.url="mailto:"+e.url)};bl.prototype.onCompile=function(){};var X0e=bl;var Z0e="-",UWe=/^xn--/,BWe=/[^\0-\x7F]/,qWe=/[\x2E\u3002\uFF0E\uFF61]/g,jWe={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},EQ=35,Kp=Math.floor,wQ=String.fromCharCode;function zv(n){throw new RangeError(jWe[n])}function HWe(n,e){let t=[],r=n.length;for(;r--;)t[r]=e(n[r]);return t}function eye(n,e){let t=n.split("@"),r="";t.length>1&&(r=t[0]+"@",n=t[1]),n=n.replace(qWe,".");let o=n.split("."),s=HWe(o,e).join(".");return r+s}function tye(n){let e=[],t=0,r=n.length;for(;t<r;){let o=n.charCodeAt(t++);if(o>=55296&&o<=56319&&t<r){let s=n.charCodeAt(t++);(s&64512)==56320?e.push(((o&1023)<<10)+(s&1023)+65536):(e.push(o),t--)}else e.push(o)}return e}var VWe=n=>String.fromCodePoint(...n),GWe=function(n){return n>=48&&n<58?26+(n-48):n>=65&&n<91?n-65:n>=97&&n<123?n-97:36},J0e=function(n,e){return n+22+75*(n<26)-((e!=0)<<5)},nye=function(n,e,t){let r=0;for(n=t?Kp(n/700):n>>1,n+=Kp(n/e);n>EQ*26>>1;r+=36)n=Kp(n/EQ);return Kp(r+(EQ+1)*n/(n+38))},rye=function(n){let e=[],t=n.length,r=0,o=128,s=72,a=n.lastIndexOf(Z0e);a<0&&(a=0);for(let c=0;c<a;++c)n.charCodeAt(c)>=128&&zv("not-basic"),e.push(n.charCodeAt(c));for(let c=a>0?a+1:0;c<t;){let l=r;for(let d=1,p=36;;p+=36){c>=t&&zv("invalid-input");let f=GWe(n.charCodeAt(c++));f>=36&&zv("invalid-input"),f>Kp((2147483647-r)/d)&&zv("overflow"),r+=f*d;let m=p<=s?1:p>=s+26?26:p-s;if(f<m)break;let h=36-m;d>Kp(2147483647/h)&&zv("overflow"),d*=h}let u=e.length+1;s=nye(r-l,u,l==0),Kp(r/u)>2147483647-o&&zv("overflow"),o+=Kp(r/u),r%=u,e.splice(r++,0,o)}return String.fromCodePoint(...e)},iye=function(n){let e=[];n=tye(n);let t=n.length,r=128,o=0,s=72;for(let l of n)l<128&&e.push(wQ(l));let a=e.length,c=a;for(a&&e.push(Z0e);c<t;){let l=2147483647;for(let d of n)d>=r&&d<l&&(l=d);let u=c+1;l-r>Kp((2147483647-o)/u)&&zv("overflow"),o+=(l-r)*u,r=l;for(let d of n)if(d<r&&++o>2147483647&&zv("overflow"),d===r){let p=o;for(let f=36;;f+=36){let m=f<=s?1:f>=s+26?26:f-s;if(p<m)break;let h=p-m,g=36-m;e.push(wQ(J0e(m+h%g,0))),p=Kp(h/g)}e.push(wQ(J0e(p,0))),s=nye(o,u,c===a),o=0,++c}++o,++r}return e.join("")},zWe=function(n){return eye(n,function(e){return UWe.test(e)?rye(e.slice(4).toLowerCase()):e})},$We=function(n){return eye(n,function(e){return BWe.test(e)?"xn--"+iye(e):e})},WWe={version:"2.3.1",ucs2:{decode:tye,encode:VWe},decode:rye,encode:iye,toASCII:$We,toUnicode:zWe};var kQ=WWe;var oye={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"\u201C\u201D\u2018\u2019",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}};var sye={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"\u201C\u201D\u2018\u2019",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}};var aye={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"\u201C\u201D\u2018\u2019",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}};var KWe={default:oye,zero:sye,commonmark:aye},YWe=/^(vbscript|javascript|file|data):/,QWe=/^data:image\/(gif|png|jpeg|webp);/;function XWe(n){let e=n.trim().toLowerCase();return YWe.test(e)?QWe.test(e):!0}var cye=["http:","https:","mailto:"];function JWe(n){let e=SD(n,!0);if(e.hostname&&(!e.protocol||cye.indexOf(e.protocol)>=0))try{e.hostname=kQ.toASCII(e.hostname)}catch{}return J5(aT(e))}function ZWe(n){let e=SD(n,!0);if(e.hostname&&(!e.protocol||cye.indexOf(e.protocol)>=0))try{e.hostname=kQ.toUnicode(e.hostname)}catch{}return xD(aT(e),xD.defaultChars+"%")}function ou(n,e){if(!(this instanceof ou))return new ou(n,e);e||s6(n)||(e=n||{},n="default"),this.inline=new $0e,this.block=new j0e,this.core=new A0e,this.renderer=new C0e,this.linkify=new X0e,this.validateLink=XWe,this.normalizeLink=JWe,this.normalizeLinkText=ZWe,this.utils=OY,this.helpers=lT({},BY),this.options={},this.configure(n),e&&this.set(e)}ou.prototype.set=function(n){return lT(this.options,n),this};ou.prototype.configure=function(n){let e=this;if(s6(n)){let t=n;if(n=KWe[t],!n)throw new Error('Wrong `markdown-it` preset "'+t+'", check name')}if(!n)throw new Error("Wrong `markdown-it` preset, can't be empty");return n.options&&e.set(n.options),n.components&&Object.keys(n.components).forEach(function(t){n.components[t].rules&&e[t].ruler.enableOnly(n.components[t].rules),n.components[t].rules2&&e[t].ruler2.enableOnly(n.components[t].rules2)}),this};ou.prototype.enable=function(n,e){let t=[];Array.isArray(n)||(n=[n]),["core","block","inline"].forEach(function(o){t=t.concat(this[o].ruler.enable(n,!0))},this),t=t.concat(this.inline.ruler2.enable(n,!0));let r=n.filter(function(o){return t.indexOf(o)<0});if(r.length&&!e)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+r);return this};ou.prototype.disable=function(n,e){let t=[];Array.isArray(n)||(n=[n]),["core","block","inline"].forEach(function(o){t=t.concat(this[o].ruler.disable(n,!0))},this),t=t.concat(this.inline.ruler2.disable(n,!0));let r=n.filter(function(o){return t.indexOf(o)<0});if(r.length&&!e)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+r);return this};ou.prototype.use=function(n){let e=[this].concat(Array.prototype.slice.call(arguments,1));return n.apply(n,e),this};ou.prototype.parse=function(n,e){if(typeof n!="string")throw new Error("Input data should be a String");let t=new this.core.State(n,this,e);return this.core.process(t),t.tokens};ou.prototype.render=function(n,e){return e=e||{},this.renderer.render(this.parse(n,e),this.options,e)};ou.prototype.parseInline=function(n,e){let t=new this.core.State(n,this,e);return t.inlineMode=!0,this.core.process(t),t.tokens};ou.prototype.renderInline=function(n,e){return e=e||{},this.renderer.render(this.parseInline(n,e),this.options,e)};var RQ=ou;var eKe=Object.freeze({abap:{lineComment:{start:"'"}},bat:{lineComment:{start:"REM"},aliases:["Batch","bat"],extensions:[".bat",".cmd"]},bibtex:{lineComment:{start:"%"},aliases:["BibTeX","bibtex"],extensions:[".bib"]},blade:{lineComment:{start:"#"}},c:{lineComment:{start:"//"},aliases:["C","c"],extensions:[".c",".i"]},clojure:{lineComment:{start:";"},aliases:["Clojure","clojure"],extensions:[".clj",".cljs",".cljc",".cljx",".clojure",".edn"]},coffeescript:{lineComment:{start:"//"},aliases:["CoffeeScript","coffeescript","coffee"],extensions:[".coffee",".cson",".iced"]},cpp:{lineComment:{start:"//"},aliases:["C++","Cpp","cpp"],extensions:[".cpp",".cc",".cxx",".c++",".hpp",".hh",".hxx",".h++",".h",".ii",".ino",".inl",".ipp",".ixx",".tpp",".txx",".hpp.in",".h.in"]},csharp:{lineComment:{start:"//"},aliases:["C#","csharp"],extensions:[".cs",".csx",".cake"]},css:{lineComment:{start:"/*",end:"*/"},aliases:["CSS","css"],extensions:[".css"]},dart:{lineComment:{start:"//"},aliases:["Dart"],extensions:[".dart"]},dockerfile:{lineComment:{start:"#"},aliases:["Docker","Dockerfile","Containerfile"],extensions:[".dockerfile",".containerfile"]},elixir:{lineComment:{start:"#"}},erb:{lineComment:{start:"<%#",end:"%>"}},erlang:{lineComment:{start:"%"}},fsharp:{lineComment:{start:"//"},aliases:["F#","FSharp","fsharp"],extensions:[".fs",".fsi",".fsx",".fsscript"]},go:{lineComment:{start:"//"},aliases:["Go"],extensions:[".go"]},groovy:{lineComment:{start:"//"},aliases:["Groovy","groovy"],extensions:[".groovy",".gvy",".gradle",".jenkinsfile",".nf"]},haml:{lineComment:{start:"-#"}},handlebars:{lineComment:{start:"{{!",end:"}}"},extensions:[".hbs",".handlebars"]},haskell:{lineComment:{start:"--"}},html:{lineComment:{start:"<!--",end:"-->"},aliases:["HTML","htm","html","xhtml"],extensions:[".html",".htm",".shtml",".xhtml",".xht",".mdoc",".jsp",".asp",".aspx",".jshtm",".volt",".ejs",".rhtml"]},ini:{lineComment:{start:";"}},java:{lineComment:{start:"//"},extensions:[".java",".class"]},javascript:{lineComment:{start:"//"},aliases:["JavaScript","javascript","js"],extensions:[".js",".es6",".mjs",".cjs",".pac"]},javascriptreact:{lineComment:{start:"//"},aliases:["JavaScript JSX","JavaScript React","jsx"],extensions:[".jsx"]},json:{extensions:[".json"],lineComment:{start:"//"}},jsonc:{lineComment:{start:"//"}},jsx:{lineComment:{start:"//"}},julia:{lineComment:{start:"#"},aliases:["Julia","julia"],extensions:[".jl"]},kotlin:{lineComment:{start:"//"}},latex:{lineComment:{start:"%"},aliases:["LaTeX","latex"],extensions:[".tex",".ltx",".ctx"]},less:{lineComment:{start:"//"},aliases:["Less","less"],extensions:[".less"]},lua:{lineComment:{start:"--"},aliases:["Lua","lua"],extensions:[".lua"]},makefile:{lineComment:{start:"#"},aliases:["Makefile","makefile"],extensions:[".mak",".mk"]},markdown:{lineComment:{start:"//"},aliases:["Markdown","markdown"],extensions:[".md",".mkd",".mdwn",".mdown",".markdown",".markdn",".mdtxt",".mdtext",".workbook"]},"objective-c":{lineComment:{start:"//"},aliases:["Objective-C"],extensions:[".m"]},"objective-cpp":{lineComment:{start:"//"},aliases:["Objective-C++"],extensions:[".mm"]},perl:{lineComment:{start:"#"},aliases:["Perl","perl"],extensions:[".pl",".pm",".pod",".t",".PL",".psgi"]},php:{lineComment:{start:"//"},aliases:["PHP","php"],extensions:[".php",".php4",".php5",".phtml",".ctp"]},powershell:{lineComment:{start:"#"},aliases:["PowerShell","powershell","ps","ps1"],extensions:[".ps1",".psm1",".psd1",".pssc",".psrc"]},pug:{lineComment:{start:"//"}},python:{lineComment:{start:"#"},aliases:["Python","py"],extensions:[".py",".rpy",".pyw",".cpy",".gyp",".gypi",".pyi",".ipy",".pyt"]},ql:{lineComment:{start:"//"}},r:{lineComment:{start:"#"},aliases:["R","r"],extensions:[".r",".rhistory",".rprofile",".rt"]},razor:{lineComment:{start:"<!--",end:"-->"},aliases:["Razor","razor"],extensions:[".cshtml",".razor"]},ruby:{lineComment:{start:"#"},aliases:["Ruby","rb"],extensions:[".rb",".rbx",".rjs",".gemspec",".rake",".ru",".erb",".podspec",".rbi"]},rust:{lineComment:{start:"//"},aliases:["Rust","rust"],extensions:[".rs"]},sass:{lineComment:{start:"//"}},scala:{lineComment:{start:"//"}},scss:{lineComment:{start:"//"},aliases:["SCSS","scss"],extensions:[".scss"]},shellscript:{lineComment:{start:"#"},aliases:["Shell Script","shellscript","bash","fish","sh","zsh","ksh","csh"],extensions:[".sh",".bash",".bashrc",".bash_aliases",".bash_profile",".bash_login",".ebuild",".profile",".bash_logout",".xprofile",".xsession",".xsessionrc",".Xsession",".zsh",".zshrc",".zprofile",".zlogin",".zlogout",".zshenv",".zsh-theme",".fish",".ksh",".csh",".cshrc",".tcshrc",".yashrc",".yash_profile"]},slim:{lineComment:{start:"/"}},solidity:{lineComment:{start:"//"}},sql:{lineComment:{start:"--"},aliases:["SQL"],extensions:[".sql",".dsql"]},stylus:{lineComment:{start:"//"}},svelte:{lineComment:{start:"<!--",end:"-->"}},swift:{lineComment:{start:"//"},aliases:["Swift","swift"],extensions:[".swift"]},terraform:{lineComment:{start:"#"}},tex:{lineComment:{start:"%"},aliases:["TeX","tex"],extensions:[".sty",".cls",".bbx",".cbx"]},typescript:{lineComment:{start:"//"},aliases:["TypeScript","ts","typescript"],extensions:[".ts",".cts",".mts"]},typescriptreact:{lineComment:{start:"//"},aliases:["TypeScript JSX","TypeScript React","tsx"],extensions:[".tsx"]},vb:{lineComment:{start:"'"},aliases:["Visual Basic","vb"],extensions:[".vb",".brs",".vbs",".bas",".vba"]},verilog:{lineComment:{start:"//"}},"vue-html":{lineComment:{start:"<!--",end:"-->"}},vue:{lineComment:{start:"//"},extensions:[".vue"]},xml:{lineComment:{start:"<!--",end:"-->"},aliases:["XML","xml"],extensions:[".xml",".xsd",".ascx",".atom",".axml",".axaml",".bpmn",".cpt",".csl",".csproj",".csproj.user",".dita",".ditamap",".dtd",".ent",".mod",".dtml",".fsproj",".fxml",".iml",".isml",".jmx",".launch",".menu",".mxml",".nuspec",".opml",".owl",".proj",".props",".pt",".publishsettings",".pubxml",".pubxml.user",".rbxlx",".rbxmx",".rdf",".rng",".rss",".shproj",".storyboard",".svg",".targets",".tld",".tmx",".vbproj",".vbproj.user",".vcxproj",".vcxproj.filters",".wsdl",".wxi",".wxl",".wxs",".xaml",".xbl",".xib",".xlf",".xliff",".xpdl",".xul",".xoml"]},xsl:{lineComment:{start:"<!--",end:"-->"},aliases:["XSL","xsl"],extensions:[".xsl",".xslt"]},yaml:{lineComment:{start:"#"}}}),lx=new Map(Object.entries(eKe).map(([n,e])=>[n,{languageId:n,...e}]));function Rr(n){return PQ(typeof n=="string"?n:typeof n>"u"?"plaintext":n.languageId)}function PQ(n){return lx.get(n.toLowerCase())??{languageId:n,lineComment:{start:"//"}}}function fo(n){let e=fl(n).toLowerCase();for(let t of lx.values())if(t.extensions?.includes(e))return t;return Rr("plaintext")}function AQ(n){let e=n.matchAll(/^\s*(```+)/gm),t=Math.max(3,...Array.from(e,r=>r[1].length+1));return"`".repeat(t)}var $v="filepath:";function mo(n,e,t=!0,r){let o=AQ(e),s="";if(r){let a=Rr(n),{start:c,end:l}=a.lineComment;s=l?`${c} ${$v} ${r} ${l}
`:`${c} ${$v} ${r}
`}return`${o}${f6(n)}
${s}${t?e.trim():e}
${o}`}function f6(n){switch(n.trim().toLowerCase()){case"typescriptreact":return"tsx";case"javascriptreact":return"jsx";default:return n}}function m6(n){let e=fl(n).toLowerCase(),t=Object.keys(lx).find(r=>lx.get(r)?.extensions?.includes(e))||e.replace(/^\./,"");return f6(t)}function Is(n){let e=[],r=new RQ().parse(n,{});for(let o of lye(r))o.map&&o.type==="fence"&&e.push({startMarkup:o.markup,code:o.content.replace(/\n$/,""),language:o.info.trim(),startLine:o.map[0],endLine:o.map[1]});return e}function*lye(n){for(let e of n)e.children&&(yield*lye(e.children)),yield e}var NQ=q(ht()),mT=q(Ve()),LQ=q(require("path"));var ED=q(Ve()),DQ=q(require("path"));var h6=q(Ve());var Wv=class extends h6.PromptElement{constructor(t,r,o,s,a){super(t);this._contextService=r;this._telemetryService=o;this._logService=s;this._ignoreService=a}_handleFoulPrompt(){let t=new Error("BAD PROMPT");if(this._logService.internal.error(t),this._contextService.extensionMode!==vl.Production)throw t;this._telemetryService.sendMSFTTelemetryErrorEvent("prompt.invalidreference",{stack:t.stack})}};Wv=E([v(1,qt),v(2,ge),v(3,oe),v(4,Te)],Wv);var tt=class extends Wv{async render(){if(this.props.uri?await this._ignoreService.isCopilotIgnored(this.props.uri):!1)return this._handleFoulPrompt();let t=mo(this.props.languageId??"",this.props.code,this.props.shouldTrim??!0,this.props.includeFilepath?this.props.uri.scheme==="untitled"?this.props.uri.toString():this.props.uri.path:void 0);return vscpp(h6.TextChunk,null,this.props.references&&vscpp("references",{value:this.props.references}),t)}};var ux=class extends Wv{get insertLineBreakBefore(){return!1}async render(){if(await this._ignoreService.isCopilotIgnored(this.props.value))return this._handleFoulPrompt();let t;return this.props.mode===1?t=this.props.value.path:t=fc(this.props.value),vscpp(vscppf,null,t)}};var fT=class extends ED.PromptElement{constructor(t,r,o){super(t);this._ignoreService=r;this._tabsAndEditorsService=o}async render(t,r){let o=this._tabsAndEditorsService.activeTextEditor;if(!o)return;let s=o.visibleRanges,a=o.document;if(await this._ignoreService.isCopilotIgnored(a.uri))return vscpp("ignoredFiles",{value:[a.uri]});if(a.getText().trim().length===0)return vscpp(vscppf,null,vscpp(ED.UserMessage,{priority:this.props.priority},vscpp("references",{value:[new Xo.PromptReference(a.uri)]}),"The active ",a.languageId," file ",DQ.basename(a.uri.path)," is empty."));if(s.length!==0)return vscpp(vscppf,null,vscpp(ED.UserMessage,{priority:this.props.priority},s.map(l=>vscpp(vscppf,null,"Excerpt from active file ",DQ.basename(a.uri.path),", lines ",l.start.line+1," to ",l.end.line+1,":",vscpp("br",null),vscpp(tt,{code:a.getText(l),languageId:a.languageId,uri:a.uri,references:[new Xo.PromptReference({uri:a.uri,range:l})]}),vscpp("br",null),vscpp("br",null)))))}};fT=E([v(1,Te),v(2,$t)],fT);var zs=class extends mT.PromptElement{constructor(t,r,o,s,a){super(t);this.ignoreService=r;this.logger=o;this._tabsAndEditorsService=s;this._tokenizerProvider=a}static{this.variableInfo={name:"selection",fullName:NQ.t("Selection"),icon:"selection",description:NQ.t("The current selection in the active editor"),defaultEnablement:!0,registerTool:!0}}async prepare(t){if(!this.props.document)return{isIgnored:!1,exceedsTokenBudget:!1};let r=await this.ignoreService.isCopilotIgnored(this.props.document.uri),o=!1,s=zs.getCurrentSelection(this._tabsAndEditorsService);return s&&this._tokenizerProvider.acquireTokenizer(t.endpoint).tokenLength(s?.selectedText)*1.1>t.tokenBudget&&(o=!0),{isIgnored:r,exceedsTokenBudget:o}}render(t,r){let o=zs.getCurrentSelection(this._tabsAndEditorsService);if(!o)return vscpp(fT,null);let s=[new Xo.PromptReference(new ar(o.activeDocument.uri,o.range))],a=[o.activeDocument.uri];return t.isIgnored?vscpp("ignoredFiles",{value:a}):t.exceedsTokenBudget?(this.logger.internal.info(`Dropped current selection (${r.tokenBudget} / ${r.endpoint.modelMaxPromptTokens} tokens)`),vscpp(vscppf,null,vscpp(mT.AssistantMessage,{priority:this.props.priority,name:"selection-too-large"},"Your active selection (",o.fileName&&vscpp(vscppf,null,o.selectedText.split(`
`).length," lines from ",LQ.basename(o.fileName)),") exceeded my maximum context size and was dropped. Please reduce the selection to the most relevant part."))):vscpp(vscppf,null,vscpp(mT.UserMessage,{priority:this.props.priority},"Active selection:",vscpp("br",null),vscpp("br",null),vscpp("br",null),o.fileName&&vscpp(vscppf,null,"From the file: ",LQ.basename(o.fileName),vscpp("br",null)),vscpp(tt,{code:o.selectedText,languageId:o.languageId,uri:o.activeDocument.uri,references:s}),vscpp("br",null),vscpp("br",null)))}static getCurrentSelection(t,r=!1){let o=t.activeTextEditor,s=o?.document;if(s){let a=o.selection;if(a&&(!a.isEmpty||a.isEmpty&&r)){let c=s.languageId,l=s.getText(a);return{languageId:c,selectedText:l,activeDocument:s,range:a,fileName:s.fileName}}}}};zs=E([v(1,Te),v(2,oe),v(3,$t),v(4,Qn)],zs);var Kv=class{constructor(e){this._instantiationService=e;this.kind="current-selection";this.variableInfo=zs.variableInfo}async resolveContext(e){let{messages:t,references:r}=await Qi(this._instantiationService,e.endpoint,zs,{});if(t.length>0&&r.length>0)return{kind:this.kind,userMessages:t.map(o=>o.content),references:r}}static formatSelection(e){let t=e.fileName?`From the file: ${uye.basename(e.fileName)}
`:"",{trimmedLines:r}=bD(e.selectedText.split(/\r?\n/g));return`

${t}${mo(e.languageId,zn(r).join(`
`))}

`}};Kv=E([v(0,H)],Kv);zr.register(new fe(Kv));var $ye=q(ht()),NT=q(Ve());var b6=q(Ve());var Ts=re("ILanguageFeaturesService");function ph(n){return typeof n=="object"&&n!==null&&"targetUri"in n}var Fr={doesContain:(n,e)=>n.startIndex<=e.startIndex&&e.endIndex<=n.endIndex,ofSyntaxNode:n=>({startIndex:n.startIndex,endIndex:n.endIndex}),compare:(n,e)=>n.startIndex-e.startIndex||e.endIndex-n.endIndex,isEqual:(n,e)=>Fr.compare(n,e)===0,doIntersect:(n,e)=>{let t=Math.max(n.startIndex,e.startIndex),r=Math.min(n.endIndex,e.endIndex);return t<r},len:n=>n.endIndex-n.startIndex,intersectionSize:(n,e)=>{let t=Math.max(n.startIndex,e.startIndex),r=Math.min(n.endIndex,e.endIndex);return Math.max(r-t,0)},isTreeSitterOffsetRange(n){return typeof n.startIndex=="number"&&typeof n.endIndex=="number"}},Nd={isEqual(n,e){return n.row===e.row&&n.column===e.column},isBefore(n,e){return n.row<e.row||n.row===e.row&&n.column<e.column},isAfter(n,e){return Nd.isBefore(e,n)},isBeforeOrEqual(n,e){let t=Nd.isBefore(n,e),r=Nd.isEqual(n,e);return!!(t||r)},equals(n,e){return n.column===e.column&&n.row===e.row},isAfterOrEqual(n,e){return Nd.isBeforeOrEqual(e,n)},ofPoint:n=>({row:n.row,column:n.column})},Yv={doesContain:(n,e)=>Nd.isBeforeOrEqual(n.startPosition,e.startPosition)&&Nd.isAfterOrEqual(n.endPosition,e.endPosition),equals:(n,e)=>Nd.equals(n.startPosition,e.startPosition)&&Nd.equals(n.endPosition,e.endPosition),ofSyntaxNode:n=>({startPosition:n.startPosition,endPosition:n.endPosition})},Qv={ofSyntaxNode:n=>({type:n.type,startIndex:n.startIndex,endIndex:n.endIndex})},Ic={ofSyntaxNode:n=>({range:Yv.ofSyntaxNode(n),startIndex:n.startIndex,text:n.text,endIndex:n.endIndex})},Yp=class{constructor(e,t,r,o){this.startIndex=e;this.endIndex=t;this.kind=r;this.children=o;if(e>t)throw new Xt("startIndex must be less than endIndex");let s=e;for(let a of o){if(a.startIndex<s)throw new Xt("Invalid child startIndex");if(a.endIndex>t)throw new Xt("Invalid child endIndex");s=Math.max(a.endIndex,s)}}toString(){let e=[];function t(r,o=""){e.push(`${o}${r.kind} [${r.startIndex}, ${r.endIndex}]`),r.children.forEach(s=>t(s,o+"    "))}return t(this),e.join(`
`)}};function fye(n,e){let t=n.getText().split(/\r|\n|\r\n/g),r=e||{tabSize:4},o={getLineCount:()=>t.length,getLineContent:s=>t[s-1],getOptions:()=>r};try{let s=nKe(o,n.languageId),[a]=mye(n,s,void 0);return a.adjust(n,hye(n.languageId)),a.toOverlayNode(n,!0)}catch{return new g6(1,n.lineCount,[]).toOverlayNode(n,!0)}}function mye(n,e,t){if(typeof t<"u"&&t>=e.length)throw new Error(`Invalid region index ${t}`);let r=typeof t>"u"?1:e.getStartLineNumber(t),o=typeof t>"u"?n.lineCount:e.getEndLineNumber(t),s=[],a=null;for(t=typeof t>"u"?0:t+1;t<e.length;){let c=e.getStartLineNumber(t),l=e.getEndLineNumber(t);if(c>o||l>o)break;let u=a;if([a,t]=mye(n,e,t),u&&a.startLineNumber<=u.endLineNumber)throw new Xt("Invalid Folding Ranges: overlapping children");if(a.startLineNumber<r)throw new Xt("Invalid Folding Ranges: child starts before parent");s.push(a)}return[new g6(r,o,s),t]}var g6=class{constructor(e,t,r){this.startLineNumber=e;this.endLineNumber=t;this.children=r;if(e>t)throw new Xt("Invalid Folding Ranges: startLineNumber > endLineNumber")}adjust(e,t){t?this._adjustOffside():this._adjustRegular(e,e.lineCount)}_adjustOffside(){this.startLineNumber++;for(let e of this.children)e._adjustOffside()}_adjustRegular(e,t){if(this.endLineNumber<t){let r=e.lineAt(this.endLineNumber).text.trim(),o=/^[\}\]\)];?$/.test(r),s=/^<\/\w/.test(r);(o||s)&&this.endLineNumber++}for(let r=this.children.length-1;r>=0;r--){let o=this.children[r],s=r+1<this.children.length?this.children[r+1].startLineNumber-1:t;o._adjustRegular(e,s)}}toOverlayNode(e,t){let r=[],o=t&&this.startLineNumber===1?1:this.startLineNumber+1;for(let s of this.children){for(let a=o;a<s.startLineNumber;a++){let c=dye(e,a);c&&r.push(c)}r.push(s.toOverlayNode(e,!1)),o=s.endLineNumber+1}for(let s=o;s<this.endLineNumber;s++){let a=dye(e,s);a&&r.push(a)}return tKe(e,this.startLineNumber,this.endLineNumber,r)}};function dye(n,e){let t=n.lineAt(e-1);if(t.isEmptyOrWhitespace)return null;let r=n.offsetAt(t.range.start),o=n.offsetAt(t.range.end);return new Yp(r,o,"LINE",[])}function tKe(n,e,t,r){let o=n.offsetAt(new Sn(e-1,0)),s=n.offsetAt(new Sn(t-1,n.lineAt(t-1).text.length));return new Yp(o,s,"FOLD",r)}function nKe(n,e){return rKe(n,hye(e))}function hye(n){return["clojure","coffeescript","fsharp","latex","markdown","pug","python","sql","yaml"].includes(n)}function rKe(n,e){let t=n.getOptions().tabSize,r=new OQ,o=[],s=n.getLineCount()+1;o.push({indent:-1,endAbove:s,line:s});for(let a=n.getLineCount();a>0;a--){let c=n.getLineContent(a),l=oKe(c,t),u=o[o.length-1];if(l===-1){e&&(u.endAbove=a);continue}if(u.indent>l){do o.pop(),u=o[o.length-1];while(u.indent>l);let d=u.endAbove-1;d-a>=1&&r.insertFirst(a,d,l)}u.indent===l?u.endAbove=a:o.push({indent:l,endAbove:a,line:a})}return r.toIndentRanges()}var iKe=65535,dx=16777215,pye=4278190080,OQ=class{constructor(){this._startIndexes=[],this._endIndexes=[],this._indentOccurrences=[],this._length=0}insertFirst(e,t,r){if(e>dx||t>dx)return;let o=this._length;this._startIndexes[o]=e,this._endIndexes[o]=t,this._length++,r<1e3&&(this._indentOccurrences[r]=(this._indentOccurrences[r]||0)+1)}toIndentRanges(){let e=new Uint32Array(this._length),t=new Uint32Array(this._length);for(let r=this._length-1,o=0;r>=0;r--,o++)e[o]=this._startIndexes[r],t[o]=this._endIndexes[r];return new MQ(e,t)}};function oKe(n,e){let t=0,r=0,o=n.length;for(;r<o;){let s=n.charCodeAt(r);if(s===32)t++;else if(s===9)t=t-t%e+e;else break;r++}return r===o?-1:t}var MQ=class{constructor(e,t){this._startIndexes=e,this._endIndexes=t,this._parentsComputed=!1}ensureParentIndices(){if(!this._parentsComputed){this._parentsComputed=!0;let e=[],t=(r,o)=>{let s=e[e.length-1];return this.getStartLineNumber(s)<=r&&this.getEndLineNumber(s)>=o};for(let r=0,o=this._startIndexes.length;r<o;r++){let s=this._startIndexes[r],a=this._endIndexes[r];if(s>dx||a>dx)throw new Error("startLineNumber or endLineNumber must not exceed "+dx);for(;e.length>0&&!t(s,a);)e.pop();let c=e.length>0?e[e.length-1]:-1;e.push(r),this._startIndexes[r]=s+((c&255)<<24),this._endIndexes[r]=a+((c&65280)<<16)}}}get length(){return this._startIndexes.length}getStartLineNumber(e){return this._startIndexes[e]&dx}getEndLineNumber(e){return this._endIndexes[e]&dx}getParentIndex(e){this.ensureParentIndices();let t=((this._startIndexes[e]&pye)>>>24)+((this._endIndexes[e]&pye)>>>16);return t===iKe?-1:t}contains(e,t){return this.getStartLineNumber(e)<=t&&this.getEndLineNumber(e)>=t}findIndex(e){let t=0,r=this._startIndexes.length;if(r===0)return-1;for(;t<r;){let o=Math.floor((t+r)/2);e<this.getStartLineNumber(o)?r=o:t=o+1}return t-1}findRange(e){let t=this.findIndex(e);if(t>=0){if(this.getEndLineNumber(t)>=e)return t;for(t=this.getParentIndex(t);t!==-1;){if(this.contains(t,e))return t;t=this.getParentIndex(t)}}return-1}};var v6=class extends Error{constructor(e){super(`Unrecognized language: ${e}`)}},gye={python:"python",javascript:"javascript",javascriptreact:"javascript",jsx:"javascript",typescript:"typescript",typescriptreact:"tsx",tsx:"tsx",go:"go",ruby:"ruby",csharp:"csharp",cpp:"cpp",java:"java",rust:"rust"};function _l(n){if(n in gye)return gye[n]}async function vye(n,e,t,r,o,s,a,c){let l=n.getTreeSitterAST(s);if(!l)return[];let u=No(a,s),d=await Tc(e,t,s,c,()=>l.getCallExpressions(u),[]);async function p(y){let b=s.positionAt(y.startIndex);try{let _=await r.getImplementations(s.uri,b);return _.length?_:await r.getDefinitions(s.uri,b)}catch{return[]}}let f=await Tc(e,t,s,c*3,()=>Promise.all(d.map(p)),[]),m=[];for(let y=0;y<f.length;y++){let b=d[y],_=f[y];for(let x of _){let{uri:I,range:S}=ph(x)?{uri:x.targetUri,range:x.targetRange}:x,w=await o.openTextDocumentAndSnapshot(I),R=n.getTreeSitterAST(w);if(R){let V=(await R.getFunctionDefinitions()).find(F=>F.identifier===b.identifier);if(V){let F=No(S,w);m.push({uri:I,range:S,version:w.version,identifier:b.identifier,startIndex:F.startIndex,endIndex:F.endIndex,text:V.text})}}}}if(m.length!==0)return m;let h=await Tc(e,t,s,c,()=>l.getFunctionDefinitions(),[]),g=[];for(let y of h)for(let b of d)y.identifier===b.identifier&&g.push(y);return g.sort((y,b)=>y.startIndex-b.startIndex)}async function yye(n,e,t,r,o,s,a,c){let l=n.getTreeSitterAST(s);if(!l)return[];let u=No(a,s),d=await Tc(e,t,s,c,()=>l.getClassReferences(u),[]),p=await Tc(e,t,s,c*3,async()=>await Promise.all(d.map(async g=>{try{let y=s.positionAt(g.startIndex),b=await r.getImplementations(s.uri,y);return b.length?b:await r.getDefinitions(s.uri,y)}catch{return[]}})),[]),f=[];for(let g=0;g<p.length;g++){let y=d[g],b=p[g];for(let _ of b){let{uri:x,range:I}=ph(_)?{uri:_.targetUri,range:_.targetRange}:_,S=await o.openTextDocumentAndSnapshot(x),w=n.getTreeSitterAST(S);if(w){let R=(await w.getClassDeclarations()).find(k=>k.identifier===y.identifier);if(R){let k=No(I,S);f.push({uri:x,range:I,version:S.version,identifier:y.identifier,startIndex:k.startIndex,endIndex:k.endIndex,text:R.text})}}}}if(f.length!==0)return f;let m=await Tc(e,t,s,c,()=>l.getClassDeclarations(),[]),h=[];for(let g of m)for(let y of d)g.identifier===y.identifier&&h.push(g);return h.sort((g,y)=>g.startIndex-y.startIndex)}async function bye(n,e,t,r,o,s,a,c){let l=n.getTreeSitterAST(s);if(!l)return[];let u=No(a,s),d=await Tc(e,t,s,c,()=>l.getTypeReferences(u),[]),p=await Tc(e,t,s,c,()=>l.getTypeDeclarations(),[]),f=[];for(let m of p)for(let h of d)m.identifier===h.identifier&&f.push(m);return f.sort((m,h)=>m.startIndex-h.startIndex)}function sKe(n,e){return e===0?n.then(t=>({type:"success",value:t})):new Promise((t,r)=>{let o=setTimeout(()=>t({type:"timeout"}),e);n.then(s=>{clearTimeout(o),t({type:"success",value:s})}).catch(s=>{clearTimeout(o),r(s)})})}async function Tc(n,e,t,r,o,s){try{let a=await sKe(_ye(t,o,s),r);return a.type==="success"?a.value:(n.public.warn(`Computing async parser based result took longer than ${r}ms`),s)}catch(a){return a instanceof v6||(n.public.error(a,"Failed to compute async parser based result"),e.sendGHTelemetryException(a,"Failed to compute async parser based result")),s}}async function _ye(n,e,t,r=0){let o=n.version,s=await e();return n.version!==o?r<3?_ye(n,e,t,r+1):t:s}var y6=class n{static forDocument(e,t){return this.forUri(e,t.uri)}static forUri(e,t){return`${this.forLanguage(e)}: ${t.path}`}static forLanguage(e){return`${e.lineComment.start} FILEPATH`}static testLine(e,t){let r=n.forLanguage(e);return t.trimStart().startsWith(r)}};var hT=class{static begin(e,t){return typeof t>"u"?`${e.lineComment.start} BEGIN:`:`${e.lineComment.start} BEGIN: ${t}`}static end(e,t){return typeof t>"u"?`${e.lineComment.start} END:`:`${e.lineComment.start} END: ${t}`}};async function su(n,e,t){let o=await n.getTreeSitterAST(e)?.getStructure();return o||fye(e,t)}var gT=class extends Jl{constructor(t,r){super();this.wholeRange=t;this.contextInfo=r}};(e=>{function n(t){return t instanceof e}e.is=n})(gT||={});var Qp=class{constructor(e){this.charLimit=e;this._totalChars=0}get totalChars(){return this._totalChars}addLine(e){this._totalChars+=e.length+1}lineWouldFit(e){return this._totalChars+e.length+1<this.charLimit}},ba=class n{constructor(e,t,r,o){this.tracker=e;this.document=t;this.language=r;this.kindOrUniqueStr=o;this.lines=[];this.firstLineIndex=this.document.lineCount;this.lastLineIndex=-1;this.isComplete=!1;this.nonTrimWhitespaceCharCount=0;this._startMarker=hT.begin(r,o),this._endMarker=hT.end(r,o),this.lines=[],this.firstLineIndex=t.lineCount,this.lastLineIndex=-1}get startMarker(){return this._startMarker}get endMarker(){return this._endMarker}get lineCount(){return this.lines.length}get isVerySmallOrEmpty(){return this.nonTrimWhitespaceCharCount<10}get hasContent(){return this.lines.length===0||this.nonTrimWhitespaceCharCount===0?!1:this.lines.length>0}clone(){let e=new n(this.tracker,this.document,this.language,this.kindOrUniqueStr);return e._startMarker=this.startMarker,e._endMarker=this.endMarker,e.lines.push(...this.lines),e.firstLineIndex=this.firstLineIndex,e.lastLineIndex=this.lastLineIndex,e.nonTrimWhitespaceCharCount=this.nonTrimWhitespaceCharCount,e}clear(){this.lines.length=0,this.firstLineIndex=this.document.lineCount,this.lastLineIndex=-1,this.nonTrimWhitespaceCharCount=0}generatePrompt(e){if(!this.hasContent)return[];let t=[];return t.push("```"+this.language.languageId),t.push(y6.forDocument(this.language,this.document)),e&&t.push(`${this.startMarker}`),t.push(...this.lines),e&&t.push(`${this.endMarker}`),t.push("```"),t}prependLine(e){let r=this.document.lineAt(e).text;return this.tracker.lineWouldFit(r)?(this.firstLineIndex=Math.min(this.firstLineIndex,e),this.lastLineIndex=Math.max(this.lastLineIndex,e),this.lines.unshift(r),this.tracker.addLine(r),this.nonTrimWhitespaceCharCount+=r.trim().length,!0):!1}appendLine(e){let r=this.document.lineAt(e).text;return this.tracker.lineWouldFit(r)?(this.firstLineIndex=Math.min(this.firstLineIndex,e),this.lastLineIndex=Math.max(this.lastLineIndex,e),this.lines.push(r),this.tracker.addLine(r),this.nonTrimWhitespaceCharCount+=r.trim().length,!0):!1}trim(e){let t=e?Math.min(this.lastLineIndex,e.start.line):this.lastLineIndex;for(;this.firstLineIndex<t&&this.lines.length>0&&this.lines[0].trim().length===0;)this.firstLineIndex++,this.lines.shift();let r=e?Math.max(this.firstLineIndex,e.end.line):this.firstLineIndex;for(;r<this.lastLineIndex&&this.lines.length>0&&this.lines[this.lines.length-1].trim().length===0;)this.lastLineIndex--,this.lines.pop()}removeFirstNLines(e){if(e>=this.lineCount){let o=this.lines.slice(0),s=this.nonTrimWhitespaceCharCount;return this.clear(),{lines:o,nonTrimWhitespaceCharCount:s}}let t=this.lines.splice(0,e),r=0;for(let o of t)r+=o.trim().length;return this.firstLineIndex+=e,this.nonTrimWhitespaceCharCount-=r,{lines:t,nonTrimWhitespaceCharCount:r}}removeLastNLines(e){if(e>=this.lineCount){let o=this.lines.slice(0),s=this.nonTrimWhitespaceCharCount;return this.clear(),{lines:o,nonTrimWhitespaceCharCount:s}}let t=this.lines.splice(this.lines.length-e,e),r=0;for(let o of t)r+=o.trim().length;return this.lastLineIndex-=e,this.nonTrimWhitespaceCharCount-=r,{lines:t,nonTrimWhitespaceCharCount:r}}takeFromAbove(e,t){let{lines:r,nonTrimWhitespaceCharCount:o}=e.removeLastNLines(t);this.lines.unshift(...r),this.firstLineIndex-=r.length,this.nonTrimWhitespaceCharCount+=o}takeFromBelow(e,t){let{lines:r,nonTrimWhitespaceCharCount:o}=e.removeFirstNLines(t);this.lines.push(...r),this.lastLineIndex+=r.length,this.nonTrimWhitespaceCharCount+=o}mergeFromAbove(e){e.hasContent&&(this.lines.unshift(...e.lines),this.firstLineIndex=e.firstLineIndex,this.nonTrimWhitespaceCharCount+=e.nonTrimWhitespaceCharCount,e.clear())}mergeFromBelow(e){e.hasContent&&(this.lines.push(...e.lines),this.lastLineIndex=e.lastLineIndex,this.nonTrimWhitespaceCharCount+=e.nonTrimWhitespaceCharCount,e.clear())}toRange(){try{let e=this.lastLineIndex===-1?this.document.lineCount-1:this.lastLineIndex,t=new Me(this.firstLineIndex,0,e,this.document.lineAt(e).text.length);if(this.document.validateRange(t)===t)return t}catch{return}}toString(){return`{${this.firstLineIndex} -> ${this.lastLineIndex}}`}};var Xv=class extends b6.PromptElement{constructor(t,r,o,s){super(t);this._telemetryService=r;this._parserService=o;this._ignoreService=s}async prepare(t,r,o){if(await this._ignoreService.isCopilotIgnored(this.props.documentContext.document.uri))return{k:"ignored"};let s=this.props.nodeToDocument??await Jv(this._parserService,this._telemetryService,this.props.documentContext),a=aKe(this.props.endpointInfo,this.props.documentContext,s.range);return{k:"found",nodeToDocument:s,codeExcerptToDocument:a.range,metadata:new gT(this.props.documentContext.wholeRange,a)}}render(t,r){if(t.k==="ignored")return vscpp("ignoredFiles",{value:[this.props.documentContext.document.uri]});let o=t.codeExcerptToDocument.generatePrompt(!1).join(`
`);return vscpp(b6.UserMessage,null,vscpp("meta",{value:t.metadata}),"I have the following code in the selection:",o!==""?vscpp("br",null):"",t.codeExcerptToDocument.generatePrompt(!1).join(`
`))}};Xv=E([v(1,ge),v(2,ft),v(3,Te)],Xv);async function Jv(n,e,t){let r=No(t.selection,t.document),o=n.getTreeSitterAST(t.document);if(o===void 0)return{range:t.wholeRange};let s=Date.now(),a=await o.getNodeToDocument(r),c=Date.now()-s,l=No(t.wholeRange,t.document);cKe(e,r,l,a,t.document.languageId,c);let u=Gs(t.document,a.nodeToDocument);return{identifier:a.nodeIdentifier,range:u}}function aKe(n,e,t){let r=new Qp(n.modelMaxPromptTokens*4/3),o=new ba(r,e.document,e.language,"ed8c6549bwf9"),s=new ba(new Qp(0),e.document,e.language,"abpxx6d04wxr"),a=new ba(new Qp(0),e.document,e.language,"be15d9bcejpp");for(let c=t.start.line,l=t.end.line;c<=l&&!(c===l&&t.end.character===0||!o.appendLine(c));++c);return o.trim(e.selection),{language:e.language,above:s,range:o,below:a}}function cKe(n,e,t,r,o,s){n.sendMSFTTelemetryEvent("getNodeToDocument",{languageId:o,typeOfNodeToDocument:r.nodeToDocument.type,nodeToDocumentStart:r.nodeToDocument.startIndex.toString(),nodeToDocumentEnd:r.nodeToDocument.endIndex.toString(),selectionOffsetRangeStart:e.startIndex.toString(),selectionOffsetRangeEnd:e.endIndex.toString(),wholeRangeOffsetRangeStart:t.startIndex.toString(),wholeRangeOffsetRangeEnd:t.endIndex.toString()},{timeSpentMs:s})}var FQ=class{constructor(){this.spacesDiff=0;this.looksLikeAlignment=!1}};function lKe(n,e,t,r,o){o.spacesDiff=0,o.looksLikeAlignment=!1;let s;for(s=0;s<e&&s<r;s++){let f=n.charCodeAt(s),m=t.charCodeAt(s);if(f!==m)break}let a=0,c=0;for(let f=s;f<e;f++)n.charCodeAt(f)===32?a++:c++;let l=0,u=0;for(let f=s;f<r;f++)t.charCodeAt(f)===32?l++:u++;if(a>0&&c>0||l>0&&u>0)return;let d=Math.abs(c-u),p=Math.abs(a-l);if(d===0){o.spacesDiff=p,p>0&&0<=l-1&&l-1<n.length&&l<t.length&&t.charCodeAt(l)!==32&&n.charCodeAt(l-1)===32&&n.charCodeAt(n.length-1)===44&&(o.looksLikeAlignment=!0);return}if(p%d===0){o.spacesDiff=p/d;return}}function Sye(n){return{...Zv(n,4,!1)}}function Zv(n,e,t){let r=Math.min(UQ(n)?n.length:n.lineCount,1e4),o=0,s=0,a="",c=0,l=[2,4,6,8,3,5,7],u=8,d=[0,0,0,0,0,0,0,0,0],p=new FQ;for(let h=0;h<r;h++){let g=UQ(n)?n[h]:n.lineAt(h).text,y=g.length,b=!1,_=0,x=0,I=0;for(let w=0,R=y;w<R;w++){let k=g.charCodeAt(w);if(k===9)I++;else if(k===32)x++;else{b=!0,_=w;break}}if(!b||(I>0?o++:x>1&&s++,lKe(a,c,g,_,p),p.looksLikeAlignment&&!(t&&e===p.spacesDiff)))continue;let S=p.spacesDiff;S<=u&&d[S]++,a=g,c=_}let f=t;o!==s&&(f=o<s);let m=e;if(f){let h=f?0:.1*r;l.forEach(g=>{let y=d[g];y>h&&(h=y,m=g)}),m===4&&d[4]>0&&d[2]>0&&d[2]>=d[4]/2&&(m=2)}return{insertSpaces:f,tabSize:m}}function uKe(n,e){let t=0,r=0,o=n.length;for(;r<o;){let s=n.charCodeAt(r);if(s===32)t++;else if(s===9)t=t-t%e+e;else break;r++}return r===o?~t:t}function _6(n,e){let t=uKe(n,e);return t<0?Math.floor(~t/e):Math.floor(t/e)}function dKe(n,e){return n+e-n%e}function pKe(n,e,t){let r=0;for(let s=0;s<n.length;s++)n.charAt(s)==="	"?r=dKe(r,e):r++;let o="";if(!t){let s=Math.floor(r/e);r=r%e;for(let a=0;a<s;a++)o+="	"}for(let s=0;s<r;s++)o+=" ";return o}function BQ(n,e,t){let r=vhe(n);return r===-1&&(r=n.length),pKe(n.substring(0,r),e,t)+n.substring(r)}var e0=class n{constructor(e,t,r,o="",s=`
`){this.firstLineIndex=e;this.endLineIndex=t;this.lines=r;this.prefix=o;this.suffix=s}toTextEdit(){let e=this.lines.length>0?this.prefix+this.lines.join(`
`)+this.suffix:"";return $r.replace(new Me(this.firstLineIndex,0,this.endLineIndex,0),e)}apply(e){let t=e.slice(0,this.firstLineIndex),r=e.slice(this.endLineIndex);return t.concat(this.lines,r)}static insert(e,t){return new n(e,e,t)}static replace(e,t,r,o=!1){return o?new n(e,t,r,"",""):new n(e,t,r)}},px;(t=>{function n(r){return r.length===0?[]:r.split(/\r\n|\r|\n/g)}t.fromString=n;function e(r){if(r.lineCount===0)return[];let o=[];for(let s=0;s<r.lineCount;s++)o.push(r.lineAt(s).text);return o}t.fromDocument=e})(px||={});function UQ(n){return Array.isArray(n)&&typeof n[0]=="string"}function x6(n){return n.replace(/^\s+/g,"")}function vT(n,e){switch(e){case"java":return!!n.match(/^\s*import\s/);case"typescript":case"javascript":return!!n.match(/^\s*import[\s{*]|^\s*[var|const|let].*=\s*require\(/);case"php":return!!n.match(/^\s*use/);case"rust":return!!n.match(/^\s*use\s+[\w:{}, ]+\s*(as\s+\w+)?;/);case"python":return!!n.match(/^\s*from\s+[\w.]+\s+import\s+[\w, *]+$/)||!!n.match(/^\s*import\s+[\w, ]+$/);default:return!1}}async function*qQ(n,e,t){let r="",o=fKe(e);o.reverse();for await(let s of n){r+=s;let a,c=0,l="";for(;(a=r.indexOf(e,c))!==-1;)l+=r.slice(c,a)+t,c=a+e.length;c!==0&&(r=r.slice(c));for(let u of o)if(r.endsWith(u)){let d=r.length-u.length;l+=r.slice(0,d),r=r.slice(d);break}l.length>0&&(yield l)}r.length>0&&(yield r)}function fKe(n){let e=[];for(let t=0;t<=n.length;t++)e.push(n.substring(0,t));return e}var yT;(r=>{function n(){return o=>o}r.identity=n;function e(){return o=>nr.EMPTY}r.discard=e;function t(...o){return s=>o.reduce((a,c)=>c(a),s)}r.chain=t})(yT||={});function Iye(n,e){return(async()=>{for await(let t of n)e(t)})()}function Tye(n){let t=n.split(/\r?\n/).map(mKe),r=t.filter(s=>s===1).length,o=t.filter(s=>s===2).length;return r>o}function mKe(n){if(n.length===0)return 0;let e=0,t=0;if(["==","!=","===","!==",">=","<=","&&","||",">>",">>>","<<","<<<","+=","-=","*=","/=","%=","<<=","<<<=",">>=",">>>=","++","--","=>","->","...","??","??="].some(o=>n.includes(o))||n.match(/^\s/)||n.match(/^[;{}()\[\]`~?]/))return 1;n.charAt(0).match(/[A-Z]/)&&(e+=1),n[n.length-1]==="."&&(e+=1),XW(n)||(e+=1);{XW(n.charAt(0))&&!n.charAt(0).match(/[A-Z]/)&&(t+=1),n.match(/^\s/)&&(t+=1);let s=[";","{","}","(",")","[","]","`","~","#","$","%","^","&","*","_","=","+","\\","|","<",">"].map(a=>n.includes(a)?1:0).filter(a=>a).length;t+=s}return e>t?2:t>e?1:0}var _T=class{constructor(e,t,r,o,s=!0,a=kD.noop){this.myDocument=e;this.initialSelection=t;this.adjustedSelection=r;this.editStrategy=o;this.collectImports=s;this.lineFilter=a;this.replyIndentationTracker=null}async processStream(e){let t=nr.filter(e,this.lineFilter);this.collectImports&&(t=jQ(t,this.myDocument,this.adjustedSelection));let r=this.myDocument.firstSentLineIndex;for await(let o of this.findInitialAnchor(t))o instanceof I6?r=this.handleFirstReplyLine(o.anchor,o.line):r=this.handleSubsequentReplyLine(r,o.value);return this.myDocument.didReplaceEdits&&r<=this.adjustedSelection.end.line&&this.myDocument.deleteLines(r,this.adjustedSelection.end.line),new wD(this.myDocument.didNoopEdits,this.myDocument.didEdits,this.myDocument.additionalImports)}handleFirstReplyLine(e,t){if(e){this.replyIndentationTracker=new xT(this.myDocument,e.lineIndex,t);let s=this.replyIndentationTracker.reindent(t,this.myDocument.indentStyle);return this.myDocument.getLine(e.lineIndex).sentInCodeBlock===2?this.myDocument.replaceLines(this.adjustedSelection.start.line,e.lineIndex,s):this.myDocument.replaceLine(e.lineIndex,s)}let r=this.adjustedSelection.start.line;this.replyIndentationTracker=new xT(this.myDocument,r,t);let o=this.replyIndentationTracker.reindent(t,this.myDocument.indentStyle);if(this.initialSelection.isEmpty){let s=this.myDocument.getLine(r).content;if(/^\s*$/.test(s)||o.adjustedContent.startsWith(s))return this.myDocument.replaceLine(r,o,!0)}return this.editStrategy===1?this.myDocument.insertLineBefore(r,o):this.editStrategy===3||this.editStrategy===4?this.myDocument.insertLineAfter(r,o):this.myDocument.replaceLine(r,o)}handleSubsequentReplyLine(e,t){let r=this.replyIndentationTracker.reindent(t,this.myDocument.indentStyle);if(r.trimmedContent!==""||this.myDocument.didReplaceEdits){let s=this.matchReplyLine(r,e);if(s)return this.myDocument.replaceLines(e,s.lineIndex,r)}if(e>=this.myDocument.getLineCount())return this.myDocument.appendLineAtEndOfDocument(r);let o=this.myDocument.getLine(e);return!o.isSent||o.content===""||r.trimmedContent===""?this.myDocument.insertLineBefore(e,r):o.indentLevel<r.adjustedIndentLevel?this.myDocument.insertLineBefore(e,r):o.indentLevel===r.adjustedIndentLevel&&!this.myDocument.didReplaceEdits?this.myDocument.insertLineBefore(e,r):this.myDocument.replaceLine(e,r)}matchReplyLine(e,t){let r=e.trimmedContent.length<=3;for(let o=t;o<this.myDocument.getLineCount();o++){let s=this.myDocument.getLine(o);if(s.isSent){if(s.normalizedContent===e.adjustedContent)return new k6(o);if(s.trimmedContent.length>0&&s.indentLevel<e.adjustedIndentLevel||r&&s.trimmedContent.length>0)return null}}return null}findInitialAnchor(e){return new nr(async t=>{let r=[],o=0,s=!1;for await(let a of e)if(s)t.emitOne(a);else if(r.push(a),o+=a.value.trim().length,o>10){let c=this.searchForEqualSentLines(r);s=!0,t.emitOne(new I6(r[0].value,c)),t.emitMany(r.slice(1))}})}searchForEqualSentLines(e){let t=e.map(r=>r.value.trim());for(let r=this.myDocument.firstSentLineIndex,o=this.myDocument.getLineCount()-e.length;r<=o;r++){if(!this.myDocument.getLine(r).isSent)continue;let s=!0;for(let a=0;a<t.length;a++){let c=this.myDocument.getLine(r+a);if(!c.isSent||c.trimmedContent!==t[a]){s=!1;break}}if(s)return new k6(r)}return null}},r0=class{constructor(e,t,r=kD.noop){this._myDocument=e;this._cursorPosition=t;this._lineFilter=r;this.replyIndentationTracker=null}async processStream(e){let t=nr.filter(e,this._lineFilter);t=jQ(t,this._myDocument,new Me(this._cursorPosition,this._cursorPosition));let r=0;for await(let o of t)this.replyIndentationTracker?r=this.handleSubsequentReplyLine(r,o.value):r=this.handleFirstReplyLine(o.value);return new wD(this._myDocument.didNoopEdits,this._myDocument.didEdits,this._myDocument.additionalImports)}handleFirstReplyLine(e){let t=this._cursorPosition.line,r=this._myDocument.getLine(t).content,o=/^\s*$/.test(r)||e.trimStart().startsWith(r.trimStart()),s=o||this._myDocument.getLineCount()<=t+1?t:t+1;this.replyIndentationTracker=new xT(this._myDocument,s,e);let a=this.replyIndentationTracker.reindent(e,this._myDocument.indentStyle);return o?this._myDocument.replaceLine(t,a,!0):this._myDocument.insertLineAfter(t,a)}handleSubsequentReplyLine(e,t){let r=this.replyIndentationTracker.reindent(t,this._myDocument.indentStyle);return this._myDocument.insertLineBefore(e,r)}},S6=class{constructor(e,t,r=kD.noop){this._myDocument=e;this._selection=t;this._lineFilter=r;this.replyIndentationTracker=null}async processStream(e){let t=nr.filter(e,this._lineFilter);t=jQ(t,this._myDocument,this._selection);let r=0,o,s="";this._selection.end.line>this._selection.start.line&&this._selection.end.character===0?o=this._selection.end.line-this._selection.start.line:(o=this._selection.end.line-this._selection.start.line+1,s=this._myDocument.getLine(this._selection.end.line).content.substring(this._selection.end.character));for await(let a of t)if(this.replyIndentationTracker){let c=this.replyIndentationTracker.reindent(a.value,this._myDocument.indentStyle);o>0?(r=this._myDocument.replaceLine(r,c),o--):r=this._myDocument.insertLineAfter(r-1,c)}else{let c=this._selection.start.line;this.replyIndentationTracker=new xT(this._myDocument,c,a.value);let l=this.replyIndentationTracker.reindent(a.value,this._myDocument.indentStyle);r=this._myDocument.replaceLine(c,l),o--}return this._myDocument.didEdits&&o>0&&this._myDocument.deleteLines(r,r+o-1),this._myDocument.didEdits&&s.length>0&&this._myDocument.replaceLine(r-1,this._myDocument.getLine(r-1).content+s),new wD(this._myDocument.didNoopEdits,this._myDocument.didEdits,this._myDocument.additionalImports)}},wD=class{constructor(e,t,r){this.didNoopEdits=e;this.didEdits=t;this.additionalImports=r}},xT=class{constructor(e,t,r){let o=0;for(let a=t;a>=0;a--){let c=e.getLine(a);if(c.content.length>0){o=c.indentLevel,a!==t&&(c.content.endsWith("{")||e.languageId==="python"&&c.content.endsWith(":"))&&(o+=1);break}}this._replyIndentStyle=bT.guessIndentStyleFromLine(r);let s=_6(r,this._replyIndentStyle?.tabSize??4);this.indentDelta=s-o}reindent(e,t){if(e==="")return new w6("",0,"",0);this._replyIndentStyle||(this._replyIndentStyle=bT.guessIndentStyleFromLine(e));let r=0,o=0,s=c=>(r=c,o=Math.max(r-this.indentDelta,0),o),a=bT.reindentLine(e,this._replyIndentStyle??{insertSpaces:!0,tabSize:4},t,s);return new w6(e,r,a,o)}},I6=class{constructor(e,t){this.line=e;this.anchor=t}},T6=class{constructor(e,t){this.lineIndex=e;this.sentInCodeBlock=t}},C6=class{constructor(e,t){this.startLineIndex=e;this.endLineIndex=t}},E6=class{constructor(e,t,r,o,s,a,c){this.outputStream=e;this.uri=t;this.languageId=a;this._originalLines=[];this.lines=[];this._didNoopEdits=!1;this._didEdits=!1;this._didReplaceEdits=!1;this._additionalImports=[];this.indentStyle=bT.getDocumentIndentStyle(r,c),this._originalLines=r.split(/\r\n|\r|\n/g);for(let l=0;l<this._originalLines.length;l++)this.lines[l]=new t0(this._originalLines[l],this.indentStyle);this.firstSentLineIndex=Number.MAX_SAFE_INTEGER;for(let l of o)this.lines[l.lineIndex].markSent(l.sentInCodeBlock),this.firstSentLineIndex=Math.min(this.firstSentLineIndex,l.lineIndex);this.firstSentLineIndex=Math.min(this.firstSentLineIndex,s.startLineIndex)}get didNoopEdits(){return this._didNoopEdits}get didEdits(){return this._didEdits}get didReplaceEdits(){return this._didReplaceEdits}get additionalImports(){return this._additionalImports}getText(){return this.lines.map(e=>e.content).join(`
`)}getLineCount(){return this.lines.length}getLine(e){if(e<0||e>=this.lines.length)throw new Error("Invalid index");return this.lines[e]}addAdditionalImport(e){this._additionalImports.push(e)}replaceLine(e,t,r=!1){let o=typeof t=="string"?t:t.adjustedContent;return this.lines[e].content===o?(this._didNoopEdits=!0,e+1):(this.lines[e]=new t0(o,this.indentStyle),this.outputStream.textEdit(this.uri,[new $r(new Me(e,0,e,1073741824),o)]),this._didEdits=!0,this._didReplaceEdits=this._didReplaceEdits||!r,e+1)}replaceLines(e,t,r){if(e>t)throw new Error("Invalid range");return e===t?this.replaceLine(e,r):(this.lines.splice(e,t-e+1,new t0(r.adjustedContent,this.indentStyle)),this.outputStream.textEdit(this.uri,[new $r(new Me(e,0,t,1073741824),r.adjustedContent)]),this._didEdits=!0,this._didReplaceEdits=!0,e+1)}appendLineAtEndOfDocument(e){return this.lines.push(new t0(e.adjustedContent,this.indentStyle)),this.outputStream.textEdit(this.uri,[new $r(new Me(this.lines.length-1,1073741824,this.lines.length-1,1073741824),`
`+e.adjustedContent)]),this._didEdits=!0,this.lines.length}insertLineAfter(e,t){return this.lines.splice(e+1,0,new t0(t.adjustedContent,this.indentStyle)),this.outputStream.textEdit(this.uri,[new $r(new Me(e,1073741824,e,1073741824),`
`+t.adjustedContent)]),this._didEdits=!0,e+2}insertLineBefore(e,t){return e===this.lines.length?this.insertLineAfter(e-1,t):(this.lines.splice(e,0,new t0(t.adjustedContent,this.indentStyle)),this.outputStream.textEdit(this.uri,[new $r(new Me(e,0,e,0),t.adjustedContent+`
`)]),this._didEdits=!0,e+1)}deleteLines(e,t){return this.lines.splice(e,t-e+1),this.outputStream.textEdit(this.uri,[new $r(new Me(e,0,t+1,0),"")]),this._didEdits=!0,this._didReplaceEdits=!0,e+1}},w6=class{constructor(e,t,r,o){this.originalContent=e;this.originalIndentLevel=t;this.adjustedContent=r;this.adjustedIndentLevel=o;this.trimmedContent=this.originalContent.trim()}},k6=class{constructor(e){this.lineIndex=e}};var t0=class{constructor(e,t){this.content=e;this._indentStyle=t;this._sentInCodeBlock=0;this._trimmedContent=null;this._normalizedContent=null;this._indentLevel=-1}get isSent(){return this._sentInCodeBlock!==0}get sentInCodeBlock(){return this._sentInCodeBlock}get trimmedContent(){return this._trimmedContent===null&&(this._trimmedContent=this.content.trim()),this._trimmedContent}get normalizedContent(){return this._normalizedContent===null&&(this._normalizedContent=BQ(this.content,this._indentStyle.tabSize,this._indentStyle.insertSpaces)),this._normalizedContent}get indentLevel(){return this._indentLevel===-1&&(this._indentLevel=_6(this.content,this._indentStyle.tabSize)),this._indentLevel}markSent(e){this._sentInCodeBlock=e}},bT=class n{static getDocumentIndentStyle(e,t){return t||Zv(px.fromString(e),4,!1)}static guessIndentStyleFromLine(e){let t=n._getLeadingWhitespace(e);if(!(t===""||t===" "))return Zv([e],4,!1)}static reindentLine(e,t,r,o=s=>s){let s=_6(e,t.tabSize),a=o(s);for(;s>0;)e=this._outdent(e,t),s--;for(;s<a;)e="	"+e,s++;return BQ(e,r.tabSize,r.insertSpaces)}static _outdent(e,t){let r=0;for(;r<e.length;){let o=e.charCodeAt(r);if(o===9){r++;break}if(o!==32||r===t.tabSize)break;r++}return e.substring(r)}static _getLeadingWhitespace(e){for(let t=0;t<e.length;t++){let r=e.charCodeAt(t);if(r!==32&&r!==9)return e.substring(0,t)}return e}},kD=class{static combine(...e){return t=>e.every(r=>r?r(t):!0)}static{this.noop=()=>!0}static createCodeBlockFilter(){let e;(a=>(a[a.BeforeCodeBlock=0]="BeforeCodeBlock",a[a.InCodeBlock=1]="InCodeBlock",a[a.AfterCodeBlock=2]="AfterCodeBlock"))(e||={});let t=0;return r=>t===0?(/^```/.test(r.value)&&(t=1),!1):t===1?/^```/.test(r.value)?(t=2,!1):!0:!1}},i0=class{constructor(e){this.value=e;this.__lineOfTextBrand=void 0}};var n0=class{constructor(e,t){this.value=e;this.kind=t}},Zi=class n{static createCodeBlockClassifier(){return n.attemptToRecoverFromMissingCodeBlock(n.createFencedBlockClassifier("```"))}static attemptToRecoverFromMissingCodeBlock(e){return t=>new nr(async r=>{let o=[],s=!0;for await(let a of e(t))if(!s)r.emitOne(a);else if(a.kind===0)o.push(a);else{s=!1;for(let c of o)r.emitOne(c);o.length=0,r.emitOne(a)}if(s){let a=o.map(c=>c.value).join("");Tye(a)?r.emitOne(new n0(a,1)):r.emitOne(new n0(a,0))}})}static createAlwaysInsideCodeBlockClassifier(){return e=>nr.map(e,t=>new n0(t,1))}static createFencedBlockClassifier(e){return t=>new nr(async r=>{let o=new Xp(t[Symbol.asyncIterator]()),s=0;for(;!o.endOfStream;)if(await o.peek(e.length)!==e)for(;!o.endOfStream;){let c=o.readImmediateExcept(`
`);if(c.length>0&&r.emitOne(new n0(c,s)),await o.peek(1)===`
`){o.readImmediate(1),r.emitOne(new n0(`
`,s));break}}else{let c=await o.readLineIncludingLF();s=s===1?0:1,r.emitOne(new n0(c,2))}})}},Xp=class{constructor(e){this._source=e;this._buffer="";this._atEnd=!1}get endOfStream(){return this._buffer.length===0&&this._atEnd}async extendBuffer(){if(this._atEnd)return;let{value:e,done:t}=await this._source.next();t?this._atEnd=!0:this._buffer+=e}async waitForLength(e){for(;this._buffer.length<e&&!this._atEnd;)await this.extendBuffer()}async peek(e){return await this.waitForLength(e),this._buffer.substring(0,e)}async read(e){await this.waitForLength(e);let t=this._buffer.substring(0,e);return this._buffer=this._buffer.substring(e),t}async readUntil(e){let t="";for(;!this.endOfStream;){let r=this.readImmediateExcept(e);if(t+=r,await this.peek(1)===e)break}return t}async readLineIncludingLF(){let e=await this.readUntil(`
`);return e+=await this.read(1),e}async readLine(){let e=await this.readUntil(`
`);return await this.read(1),e}readImmediateExcept(e){let t=this._buffer.indexOf(e);return this.readImmediate(t===-1?this._buffer.length:t)}readImmediate(e){let t=this._buffer.substring(0,e);return this._buffer=this._buffer.substring(e),t}},R6=class{},P6=class n{constructor(e){this._source=e;this._buffer=[];this._atEnd=!1}static{this.EOS=new R6}get endOfStream(){return this._buffer.length===0&&this._atEnd}async extendBuffer(){if(this._atEnd)return;let{value:e,done:t}=await this._source.next();t?this._atEnd=!0:this._buffer.push(e)}async peek(){return this._buffer.length===0&&!this._atEnd&&await this.extendBuffer(),this._buffer.length===0?n.EOS:this._buffer[0]}async read(){return this._buffer.length===0&&!this._atEnd&&await this.extendBuffer(),this._buffer.length===0?n.EOS:this._buffer.shift()}async readWhile(e,t){do{let r=await this.peek();if(r instanceof R6||!e(r))break;await this.read(),await t(r)}while(!0)}async consumeToEnd(){for(;!this.endOfStream;)await this.read()}};function Cye(n){return new nr(async e=>{let t="";for await(let r of n){t+=r;do{let o=t.indexOf(`
`);if(o===-1)break;let s=t.substring(0,o);t=t.substring(o+1),e.emitOne(new i0(s))}while(!0)}t.length>0&&e.emitOne(new i0(t))})}function hKe(n,e){let t=e.start.character===0?e.start.line:e.start.line+1,r=n.getLine(e.end.line).content.length===e.end.character?e.end.line:e.end.line-1;for(let o=t;o<=r;o++)if(vT(n.getLine(o).content,n.languageId))return!0;return!1}function jQ(n,e,t){if(hKe(e,t))return n;let r=!1,o=!1;return n.filter(s=>vT(s.value,e.languageId)?(e.addAdditionalImport(x6(s.value)),r=!0,!1):s.value.trim().length===0&&r?o:(o=!0,!0))}var A6=class{constructor(e,t,r,o,s,a,c,l,u){this.sessionId=e;this.conversation=t;this.request=r;this.stream=o;this.token=s;this.documentContext=a;this.agentName=c;this.location=l;this.chatTelemetry=u;this.turn=t.getLatestTurn()}checkCancellation(){return this.token.isCancellationRequested?(this.turn.status="cancelled",!0):!1}},RD=class extends Error{constructor(e){super(typeof e=="string"?e:e.message),this.errorDetails=typeof e=="string"?{message:e}:e}},Eye=()=>({hasIgnoredFiles:!1,messages:[],omittedReferences:[],references:[],tokenCount:0,metadata:{get:()=>{},getAll:()=>[]}}),D6=class{};var $s=class extends Jl{constructor(t){super();this.replyInterpreter=t}},N6=class extends Jl{constructor(t){super();this.followUps=t}},L6=class{async processResponse(e,t,r,o){for await(let s of t)r.markdown(s.delta.text)}};function wye(n,e){let t=new Sc(n),r=e.map(o=>{let s=t.toOffsetRange(o.range);return{startOffset:s.start,endOffset:s.endExclusive,text:o.newText}});HQ(r,(o,s)=>o.startOffset-s.startOffset||o.endOffset-s.endOffset);for(let o=r.length-1;o>=0;o--){let s=r[o];n=n.substring(0,s.startOffset)+s.text+n.substring(s.endOffset)}return n}function HQ(n,e){if(n.length<=1)return n;let t=n.length/2|0,r=n.slice(0,t),o=n.slice(t);HQ(r,e),HQ(o,e);let s=0,a=0,c=0;for(;s<r.length&&a<o.length;)e(r[s],o[a])<=0?n[c++]=r[s++]:n[c++]=o[a++];for(;s<r.length;)n[c++]=r[s++];for(;a<o.length;)n[c++]=o[a++];return n}var Cs={Mute:yT.discard(),Emit:yT.identity()};var O6=class{constructor(e,t,r,o,s){this._outputStream=e;this._leadingMarkdownStreamPipe=t;this._earlyStopping=r;this._responseStream=new xv;this._lastLength=0;this._leftFirstCodeBlock=!1;let a=o(this._responseStream.asyncIterable);this._streamingPromise=this._process(a,s)}async _process(e,t){let r=new xv,o=this._leadingMarkdownStreamPipe(r.asyncIterable);Iye(o,d=>this._outputStream.markdown(d));let s=new xv,a=Cye(s.asyncIterable),c=t.processStream(a),l=e.filter(d=>d.kind!==2),u=new P6(l[Symbol.asyncIterator]());return await u.readWhile(d=>d.kind===0,d=>r.emitOne(d.value)),r.resolve(),await u.readWhile(d=>d.kind===1,d=>s.emitOne(d.value)),this._leftFirstCodeBlock=!0,await u.consumeToEnd(),s.resolve(),c}update(e){if(this._earlyStopping===1&&this._leftFirstCodeBlock)return{shouldFinish:!0};let t=e.slice(this._lastLength);return this._lastLength=e.length,this._responseStream.emitOne(t),{shouldFinish:!1}}async finish(){return this._responseStream.resolve(),await this._streamingPromise}};var IT=q(Ve());function kye(n){return n.includes("claude-3.5-sonnet")}function M6(n){return n.includes("claude-3.5-sonnet")}var Tt=class extends IT.PromptElement{render(e,t){let r=t.endpoint;return kye(r.family)?vscpp(IT.UserMessage,null,this.props.children):vscpp(IT.SystemMessage,null,this.props.children)}};var F6=class{constructor(e,t){this.kind=e;this.annotations=t}};function U6(n,e,t){let r=e.getText(),o=AD.convertToLinkedTree(r,Aye(n,r)),s=e.offsetAt(t.start),a=e.offsetAt(t.end);return{adjusted:yKe(o,s,a),original:new gt(s,a)}}function Aye(n,e){let t=gKe(n.startIndex,e),r=Math.max(t,vKe(n.endIndex,e)),o=n.children.map(s=>Aye(s,e));return t===n.startIndex&&r===n.endIndex&&Qm(o,n.children)?n:new Yp(t,r,n.kind,o)}function gKe(n,e){for(;n<e.length;){let t=e.charCodeAt(n);if(t!==32&&t!==9&&t!==10&&t!==13)return n;n++}return n}function vKe(n,e){for(;n>0;){let t=e.charCodeAt(n-1);if(t!==32&&t!==9&&t!==10&&t!==13)return n;n--}return n}function yKe(n,e,t){return[e,t]=bKe(n,e,t),_Ke(n,e,t)}function bKe(n,e,t){let r=n.text.substring(e,t);if(!/^\s*$/.test(r))return[e,t];let s=e,a=t,c=!0,l=!0;do{if(l&&a>=n.text.length&&(l=!1),l){let u=n.text.charCodeAt(a);if(u===13||u===10)l=!1;else{if(u!==32&&u!==9)return[a,a+1];a++}}if(c&&s===0&&(c=!1),c){let u=n.text.charCodeAt(s-1);if(u===13||u===10)c=!1;else{if(u!==32&&u!==9)return[s-1,s];s--}}}while(c||l);return[e,t]}function _Ke(n,e,t){e>0&&e<t&&n.text.charCodeAt(e-1)!==10&&n.text.charCodeAt(e)===10&&e++,e=Rye(n,e),t=Pye(n,t);let r=n.findLeaf2(e),o=n.findLeaf2(t),s=!1,a=l=>{l<e&&(e=Rye(n,l),s=!0,r=n.findLeaf2(e))},c=l=>{l>t&&(t=Pye(n,l),s=!0,o=n.findLeaf2(t))};do{if(s=!1,r instanceof DD){let l=r.isFirstGapInParent?r.parent.lastGap:null,u=r.hasSelectedContent(e,t),d=l&&l.hasSelectedContent(e,t),p=u||d;p&&a(r.firstNonWhitespaceIndex),p&&l&&c(l.lastNonWhitespaceIndex+1)}if(o instanceof DD){let l=o.isLastGapInParent?o.parent.firstGap:null,u=o.hasSelectedContent(e,t),d=l&&l.hasSelectedContent(e,t),p=u||d;p&&o.lastNonWhitespaceIndex+1>t&&c(o.lastNonWhitespaceIndex+1),p&&l&&a(l.firstNonWhitespaceIndex)}r instanceof AD&&n.hasContentInRange(new gt(e,t))&&r.startIndex<e&&a(r.startIndex),o instanceof AD&&n.hasContentInRange(new gt(e,t))&&o.endIndex>t&&c(o.endIndex)}while(s);return new gt(e,t)}function Rye(n,e){for(;e>0;){let t=n.text.charCodeAt(e-1);if(t!==32&&t!==9)break;e--}return e}function Pye(n,e){if((e>0?n.text.charCodeAt(e-1):0)===10)return e;for(;e<n.text.length;){let r=n.text.charCodeAt(e);if(r!==32&&r!==9)break;e++}return e}function Dye(n){return n.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")}var AD=class n{constructor(e,t,r,o,s,a,c){this._originalText=e;this.parent=t;this.startIndex=r;this.endIndex=o;this.kind=s;this.children=a;this.myIndex=c}static convertToLinkedTree(e,t){let r=new n(e,null,t.startIndex,t.endIndex,t.kind,[],0);return n._convertChildrenToLinkedTree(e,t,r),r}static _convertChildrenToLinkedTree(e,t,r){for(let o=0;o<t.children.length;o++){let s=t.children[o],a=new n(e,r,s.startIndex,s.endIndex,s.kind,[],o);r.children.push(a),n._convertChildrenToLinkedTree(e,s,a)}}get text(){return this._originalText.substring(this.startIndex,this.endIndex)}textAt(e){return e.substring(this._originalText)}hasContentInRange(e){let t=this.textAt(e);return!/^\s*$/s.test(t)}toString(){return`Node (${this.startIndex}-${this.endIndex}) ${Dye(this._originalText.substring(this.startIndex,this.endIndex))}`}gapBeforeChild(e){let t=e===0?this.startIndex:this.children[e-1].endIndex,r=e===this.children.length?this.endIndex:this.children[e].startIndex;return new DD(this._originalText,this,t,r,e)}childAt(e){return this.children[e]??null}get firstGap(){return this.children.length===0?null:this.gapBeforeChild(0)}get lastGap(){return this.children.length===0?null:this.gapBeforeChild(this.children.length)}findLeaf(e){if(this.children.length===0)return[this,0];let t=Ome(this.children.length,r=>{let o=this.children[r];return e>=o.startIndex&&e<=o.endIndex?0:e<o.startIndex?1:-1});return t<0?[this,t]:this.children[t].findLeaf(e)}findLeaf2(e){let[t,r]=this.findLeaf(e);return r<0?t.gapBeforeChild(~r):t}get nextLeaf(){let e=this;do{let t=e.nextSibling;if(t)return t.leftMostLeafChild;e=e.parent}while(e);return null}get leftMostLeafChild(){let e=this;for(;e.children.length>0;)e=e.children[0];return e}get prevSibling(){let e=this.parent,t=this.myIndex-1;return e&&t>=0?e.children[t]:null}get nextSibling(){let e=this.parent,t=this.myIndex+1;return e&&t<e.children.length?e.children[t]:null}},DD=class{constructor(e,t,r,o,s){this._originalText=e;this.parent=t;this.startIndex=r;this.endIndex=o;this.gapIndex=s;if(this.startIndex>this.endIndex)throw new Xt("Invalid gap")}get range(){return new gt(this.startIndex,this.endIndex)}get isFirstGapInParent(){return this.gapIndex===0}get isLastGapInParent(){return this.gapIndex===this.parent.children.length}toString(){return`NodeGap (${this.startIndex}-${this.endIndex}) ${Dye(this._originalText.substring(this.startIndex,this.endIndex))}`}get text(){return this._originalText.substring(this.startIndex,this.endIndex)}hasSelectedContent(e,t){let r=this.range.intersect(new gt(e,t)),o=r?this._originalText.substring(r.start,r.endExclusive):"";return!/^\s*$/s.test(o)}get firstNonWhitespaceIndex(){let e=this.startIndex;for(;e<this.endIndex;){let t=this._originalText.charCodeAt(e);if(t!==9&&t!==32&&t!==10)return e;e++}return this.endIndex}get lastNonWhitespaceIndex(){let e=this.endIndex-1;for(;e>=this.startIndex;){let t=this._originalText.charCodeAt(e);if(t!==9&&t!==32&&t!==10)return e;e--}return this.startIndex-1}get nextLeaf(){let e=this.parent.childAt(this.gapIndex);return e?e.leftMostLeafChild:this.parent.nextLeaf}};var Cc=class n{constructor(e,t){this.lineCount=e;this.columnCount=t}static{this.zero=new n(0,0)}static lengthDiffNonNegative(e,t){return t.isLessThan(e)?n.zero:e.lineCount===t.lineCount?new n(0,t.columnCount-e.columnCount):new n(t.lineCount-e.lineCount,t.columnCount)}static betweenPositions(e,t){return e.lineNumber===t.lineNumber?new n(0,t.column-e.column):new n(t.lineNumber-e.lineNumber,t.column-1)}static ofRange(e){return n.betweenPositions(e.getStartPosition(),e.getEndPosition())}static ofText(e){let t=0,r=0;for(let o of e)o===`
`?(t++,r=0):r++;return new n(t,r)}isZero(){return this.lineCount===0&&this.columnCount===0}isLessThan(e){return this.lineCount!==e.lineCount?this.lineCount<e.lineCount:this.columnCount<e.columnCount}isGreaterThan(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>e.columnCount}isGreaterThanOrEqualTo(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>=e.columnCount}equals(e){return this.lineCount===e.lineCount&&this.columnCount===e.columnCount}compare(e){return this.lineCount!==e.lineCount?this.lineCount-e.lineCount:this.columnCount-e.columnCount}add(e){return e.lineCount===0?new n(this.lineCount,this.columnCount+e.columnCount):new n(this.lineCount+e.lineCount,e.columnCount)}createRange(e){return this.lineCount===0?new De(e.lineNumber,e.column,e.lineNumber,e.column+this.columnCount):new De(e.lineNumber,e.column,e.lineNumber+this.lineCount,this.columnCount+1)}toRange(){return new De(1,1,this.lineCount+1,this.columnCount+1)}addToPosition(e){return this.lineCount===0?new Dt(e.lineNumber,e.column+this.columnCount):new Dt(e.lineNumber+this.lineCount,this.columnCount+1)}toString(){return`${this.lineCount},${this.columnCount}`}};var ND=class{constructor(e){this.text=e;this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let t=0;t<e.length;t++)e.charAt(t)===`
`&&this.lineStartOffsetByLineIdx.push(t+1)}getOffset(e){return this.lineStartOffsetByLineIdx[e.lineNumber-1]+e.column-1}getOffsetRange(e){return new gt(this.getOffset(e.getStartPosition()),this.getOffset(e.getEndPosition()))}getPosition(e){let t=vd(this.lineStartOffsetByLineIdx,s=>s<=e),r=t+1,o=e-this.lineStartOffsetByLineIdx[t]+1;return new Dt(r,o)}getRange(e){return De.fromPositions(this.getPosition(e.start),this.getPosition(e.endExclusive))}getTextLength(e){return Cc.ofRange(this.getRange(e))}get textLength(){let e=this.lineStartOffsetByLineIdx.length-1;return new Cc(e,this.text.length-this.lineStartOffsetByLineIdx[e])}};var B6=class{rangeToOffsetRange(e){return new gt(this.getOffsetAtPosition(e.start),this.getOffsetAtPosition(e.end))}offsetRangeToRange(e){return new Me(this.getPositionAtOffset(e.start),this.getPositionAtOffset(e.endExclusive))}},q6=class extends B6{constructor(t){super();this.document=t;this.uri=this.document.uri;this.languageId=this.document.languageId}getText(){return this.document.getText()}getTextInOffsetRange(t){return t.substring(this.document.getText())}getPositionAtOffset(t){return this.document.positionAt(t)}getOffsetAtPosition(t){return this.document.offsetAt(t)}},LD=class extends B6{constructor(t){super();this.value=t;this._transformer=new ND(this.value)}getText(){return this.value}getTextInOffsetRange(t){return t.substring(this.value)}getPositionAtOffset(t){return xKe(this._transformer.getPosition(t))}getOffsetAtPosition(t){return this._transformer.getOffset(SKe(t))}};function xKe(n){return new Sn(n.lineNumber-1,n.column-1)}function SKe(n){return new Dt(n.line+1,n.character+1)}function VQ(n,e){let t=e(n);return{...t,range:[t.range.start,t.range.endExclusive],children:t.children?.map(r=>VQ(r,e))}}function Nye(n,e){let t=uv(e,a=>a.endExclusive>=n.start),r=vd(e,a=>a.start<=n.endExclusive)+1;if(t===r)return[n];let o=[],s=n.start;for(let a=t;a<r;a++){let c=e[a];c.start>s&&o.push(new gt(s,c.start)),s=c.endExclusive}return s<n.endExclusive&&o.push(new gt(s,n.endExclusive)),o}var TT=class{constructor(e,t){this.originalText=e;this.edits=t;this._positionOffsetTransformer=new kr(()=>new Sc(this.text));this._originalPositionOffsetTransformer=new kr(()=>new Sc(this.originalText));this._text=new kr(()=>this.edits.apply(this.originalText))}get positionOffsetTransformer(){return this._positionOffsetTransformer.value}get originalPositionOffsetTransformer(){return this._originalPositionOffsetTransformer.value}get text(){return this._text.value}get lineCount(){return this.positionOffsetTransformer.getLineCount()}get isOriginal(){return this.edits.isEmpty||this.edits.isNoop(this.originalText)}project(e){return this.edits.applyToOffset(e)}projectOffsetRange(e){return this.edits.applyToOffsetRange(e)}projectRange(e){let t=this.originalPositionOffsetTransformer.toOffsetRange(e),r=this.projectOffsetRange(t);return this.positionOffsetTransformer.toRange(r)}projectOffsetEdit(e){return e.tryRebase(this.edits)}projectBack(e){return this.edits.applyInverseToOffset(e)}projectBackOffsetEdit(e){return e.tryRebase(this.edits.inverse(this.originalText))}projectBackTextEdit(e){let t=this.positionOffsetTransformer.toOffsetEdit(e),r=this.projectBackOffsetEdit(t);return this.originalPositionOffsetTransformer.toTextEdits(r)}};var j6=class{constructor(e,t,r,o,s){this.parent=e;this.overlayNode=t;this.range=r;this.children=o;this._document=s}get kind(){return this.overlayNode.kind}get text(){return this._document.getTextInOffsetRange(this.range)}},OD=class extends TT{constructor(t,r){super(t.getText(),r);this.baseDocument=t}getLanguageId(){return this.baseDocument.languageId}};function V6(n,e,t){let r=[],o=[],s=[];for(let c=0;c<t.length;c++){let{document:l,overlayNodeRoot:u,selection:d}=t[c],p=l.getText(),f=d?l.rangeToOffsetRange(d):void 0,m=Lye(u,l),h=GQ.fromRootNode(m,p),g=zQ.fromNode(h,!!e.tryPreserveTypeChecking);f&&g.visitAll(R=>R.node.range.intersectsOrTouches(f)?(R.node.children.length===0&&R.markAsSurviving(),!0):!1),r.push(g),o.push(g.getTextFragment());let y=R=>f?R.range.endExclusive<f.start?f.start-R.range.endExclusive:R.range.start>f.endExclusive?3*(R.range.start-f.endExclusive):0:0,b=new Zm(R=>f?R.children.length===0?R.range.intersectsOrTouches(f)?0:Number.MAX_SAFE_INTEGER:Math.min(...R.children.map(k=>b.get(k)))+1:0),_=new Zm(R=>{let k=R.parent?_.get(R.parent):Number.MAX_SAFE_INTEGER,V=b.get(R);return Math.min(k,V)}),x=!!e.tryPreserveTypeChecking,I=R=>x&&R.node?.kind==="import_statement"?0:100*_.get(R)+R.depth+10*(y(R)/p.length),S=typeof e.costFnOverride=="object"?e.costFnOverride.createCostFn(l):e.costFnOverride;if(S!==void 0){let R=I;I=k=>{let V=R(k);return V===!1?!1:k.node?S(k.node,V,l):V}}let w=g.getDescendantsAndSelf();for(let R of w){if(!R.node.node)continue;let k=I(R.node);k!==!1&&s.push({idx:c,node:R,cost:k})}}s.sort(y1(c=>c.cost,b1));for(let{node:c,idx:l}of s){if(c.markAsSurviving(),r.reduce((d,p)=>d+p.getTextFragment().length,0)>n)break;o[l]=r[l].getTextFragment()}let a=[];for(let c=0;c<o.length;c++){let l=o[c],{document:u}=t[c],d=new OD(u,l.toTextEditFromOriginal(u.getText().length)),p=d,f=r[c];p.getVisualization=()=>({$fileExtension:"ast.w",source:{value:d.originalText,decorations:Nye(gt.ofLength(d.originalText.length),d.edits.edits.map(m=>m.replaceRange)).map(m=>({range:[m.start,m.endExclusive],color:"lime"}))},root:VQ(f,m=>({label:(m.node.node?.kind||"unknown")+` (${s.find(h=>h.node===m)?.cost})`,range:m.node.range,children:m.childNodes,isMarked:m._surviving}))}),a.push(d)}return a}function Lye(n,e,t=void 0){let r=new gt(n.startIndex,n.endIndex),o=[],s=new j6(t,n,r,o,e);for(let a of n.children)o.push(Lye(a,e,s));return s}var GQ=class n{constructor(e,t,r,o,s,a){this.node=e;this.range=t;this.children=r;this.depth=o;this.parent=s;this.document=a}static fromRootNode(e,t){let r=new gt(0,t.length);if(e.range.equals(r))return n.fromNode(e,t);let o=new gt(0,e.range.start),s=new gt(e.range.endExclusive,t.length),a=[],c=new n(void 0,r,a,0,null,t);return o.isEmpty||a.push(new n(void 0,o,[],0,c,t)),a.push(n.fromNode(e,t,1,null)),s.isEmpty||a.push(new n(void 0,s,[],0,c,t)),c}static fromNode(e,t,r=0,o=null){let s=[],a=new n(e,e.range,s,r,o,t);if(e.children.length>0){let c=e.range.start;for(let u of e.children){let d=new gt(c,u.range.start);d.isEmpty||s.push(new n(void 0,d,[],r,a,t)),s.push(n.fromNode(u,t,r+1,a)),c=u.range.endExclusive}let l=new gt(c,e.range.endExclusive);l.isEmpty||s.push(new n(void 0,l,[],r,a,t))}return a}},zQ=class n{constructor(e,t,r,o){this.node=e;this.parent=t;this.childNodes=r;this._tryPreserveTypeChecking=o;this._surviving=!1;this._textFragment=null}static fromNode(e,t){return n.fromNodeParent(e,null,t)}static fromNodeParent(e,t,r){let o=[],s=new n(e,t,o,r);for(let a of e.children){let c=n.fromNodeParent(a,s,r);o.push(c)}return s}visitAll(e){if(e(this))for(let t of this.childNodes)t.visitAll(e)}markAsSurviving(){this._surviving||(this._surviving=!0,this.parent&&this.parent.markAsSurviving(),this.invalidate())}invalidate(){this._textFragment&&(this._textFragment=null,this.parent&&this.parent.invalidate())}getTextFragment(){return this._textFragment||(this._textFragment=this._computeSummarization()),this._textFragment}_computeSummarization(){if(this.childNodes.length===0&&(this._surviving||!this.node.node))return new o0(this.node.range,this.node.document);if(!this._surviving)return new CT("");let e=[];for(let t of this.childNodes){let r=t.getTextFragment();if(r.length===0){e.length>0&&e[e.length-1].length===0||e.push(r);continue}IKe(e,r)}for(let t=0;t<=e.length-3;t++){let r=e[t],o=e[t+1],s=e[t+2];if(o.length===0&&r instanceof o0&&s instanceof o0){let a=r.trimEnd(),c=s.trimStart();a.endsWith("{")&&c.startsWith("}")&&(e[t]=a,e[t+1]=new CT(this._tryPreserveTypeChecking?"/* ... */":"\u2026"),e[t+2]=c)}}return H6.from(e)}getDescendantsAndSelf(){let e=[];return this._getDescendantsAndSelf(e),e}_getDescendantsAndSelf(e){e.push(this);for(let t of this.childNodes)t._getDescendantsAndSelf(e)}},MD=class{toTextEditFromOriginal(e){let t=[],r=0,o="";function s(c){(r!==c||o.length>0)&&(t.push(new Pi(new gt(r,c),o)),o="")}function a(c){if(c instanceof H6)for(let l of c.fragments)a(l);else c instanceof CT?o+=c.text:c instanceof o0&&(s(c.range.start),r=c.range.endExclusive)}return a(this),s(e),new Rn(t)}},CT=class extends MD{constructor(t){super();this.text=t}get length(){return this.text.length}},o0=class n extends MD{constructor(t,r){super();this.range=t;this.originalText=r}get length(){return this.range.length}get text(){return this.range.substring(this.originalText)}trimStart(){let t=this.text.trimStart();return t.length===this.length?this:new n(new gt(this.range.endExclusive-t.length,this.range.endExclusive),this.originalText)}trimEnd(){let t=this.text.trimEnd();return t.length===this.length?this:new n(new gt(this.range.start,this.range.start+t.length),this.originalText)}startsWith(t){return this.text.startsWith(t)}endsWith(t){return this.text.endsWith(t)}tryJoin(t){return this.range.endExclusive===t.range.start?new n(new gt(this.range.start,t.range.endExclusive),this.originalText):null}},H6=class n extends MD{constructor(t){super();this.fragments=t;this.length=this.fragments.reduce((t,r)=>t+r.length,0)}static from(t){return t.length===0?new CT(""):t.length===1?t[0]:new n(t)}get text(){return this.fragments.map(t=>t.text).join("")}};function IKe(n,e){if(e.length===0)return;let t=n[n.length-1];if(t&&t instanceof o0&&e instanceof o0){let r=t.tryJoin(e);if(r){n[n.length-1]=r;return}}n.push(e)}var qa=class extends TT{constructor(t,r,o){super(t,r);this.languageId=o}};function $Q(n,e,t){return V6(n,e,t.map(o=>({document:new q6(o.document),selection:o.selection,overlayNodeRoot:o.overlayNodeRoot}))).map(o=>{let s=new qa(o.originalText,o.edits,o.baseDocument.languageId);return s.getVisualization=o.getVisualization,s})}function G6(n){return n*4}async function Oye(n,e,t,r,o,s){let a=await su(n,e,t),c=U6(a,e,r),l=Zp(G6(o),e,r,a,s);return{document:l,adjustedSelection:l.projectOffsetRange(c.adjusted),selection:l.projectOffsetRange(c.original)}}var Jp=class{constructor(e){this._parserService=e}summarizeDocument(e,t,r,o,s){return fx(this._parserService,e,t,r,o,s)}};Jp=E([v(0,ft)],Jp);async function fx(n,e,t,r,o,s){let a=await su(n,e,t);return Zp(G6(o),e,r,a,s)}function Zp(n,e,t,r,o={}){return $Q(n,o,[{document:e,overlayNodeRoot:r,selection:t}])[0]}async function Mye(n,e,t,r){let o=[];return await Promise.all(e.map(async s=>{let a=await su(n,s.document,s.formattingOptions);o.push({document:s.document,selection:s.selection,overlayNodeRoot:a})})),$Q(t,r??{},o)}var z6=class{constructor(e){this._derivedDocument=e;this._workingCopyOriginalDocument=new WQ(this._derivedDocument.originalText)}get originalText(){return this._workingCopyOriginalDocument.text}get text(){return this._derivedDocument.text}get languageId(){return this._derivedDocument.languageId}get derivedDocumentTransformer(){return this._derivedDocument.positionOffsetTransformer}get originalDocumentTransformer(){return this._workingCopyOriginalDocument.transformer}get allReportedEdits(){return this._workingCopyOriginalDocument.appliedEdits}createDerivedDocumentChatResponseStream(e){return new Ad(t=>{let r=this.applyAndTransformProgressItem(t);e.push(r)})}applyAndTransformProgressItem(e){if(!(e instanceof _c))return e;let t=this._workingCopyOriginalDocument,r=this._derivedDocument,o=r.edits,a=Fye(r.positionOffsetTransformer,e.edits).tryRebase(o.inverse(t.text)),c=o.tryRebase(a),l=new _c(e.uri,Uye(t.transformer,a));return this._workingCopyOriginalDocument.applyOffsetEdits(a),this._derivedDocument=new qa(this._workingCopyOriginalDocument.text,c,this._derivedDocument.languageId),l}rebaseEdits(e){let t=this._workingCopyOriginalDocument,r=this._derivedDocument,o=r.edits,a=Fye(r.positionOffsetTransformer,e).tryRebase(o.inverse(t.text));return Uye(t.transformer,a)}convertPostEditsOffsetToOriginalOffset(e){return this._derivedDocument.projectBack(e)}},WQ=class{constructor(e){this._text=e;this._transformer=null;this._appliedEdits=new Rn([]);this._eol=e.includes(`\r
`)?`\r
`:`
`}get text(){return this._text}get transformer(){return this._transformer||(this._transformer=new Sc(this._text)),this._transformer}get appliedEdits(){return this._appliedEdits}isNoop(e){return e.isNoop(this._text)}applyOffsetEdits(e){let t=e.normalizeEOL(this._eol),{edits:r}=t,o=this._text;for(let s=r.length-1;s>=0;s--){let a=r[s];o=o.substring(0,a.replaceRange.start)+a.newText+o.substring(a.replaceRange.endExclusive)}this._text=o,this._transformer&&this._transformer.applyOffsetEdits(t),this._appliedEdits=this._appliedEdits.compose(t)}},$6=class{constructor(e){this._text=e;this._transformer=null}get text(){return this._text}get transformer(){return this._transformer||(this._transformer=new Sc(this._text)),this._transformer}};function Fye(n,e){return n.toOffsetEdit(e)}function Uye(n,e){return n.toTextEdits(e)}async function FD(n,e,t,r,o){let s=await Oye(n,e,t,r,o);return new KQ(s.selection,s.adjustedSelection,s.document,e,t)}var KQ=class{constructor(e,t,r,o,s){this._selection=e;this._adjustedSelection=t;this._projectedDocument=r;this._document=o;this._formattingOptions=s}get uri(){return this._document.uri}get languageId(){return this._document.languageId}splitAroundAdjustedSelection(){return new ET(this._projectedDocument,this.uri,this._formattingOptions,this._adjustedSelection)}splitAroundOriginalSelectionEnd(){return new ET(this._projectedDocument,this.uri,this._formattingOptions,new gt(this._selection.endExclusive,this._selection.endExclusive))}},ET=class{constructor(e,t,r,o){this._projectedDocument=e;this._uri=t;this._formattingOptions=r;this._selection=this._projectedDocument.positionOffsetTransformer.toRange(o),this.codeAbove=this._projectedDocument.text.substring(0,o.start),this.codeSelected=this._projectedDocument.text.substring(o.start,o.endExclusive),this.codeBelow=this._projectedDocument.text.substring(o.endExclusive)}get hasCodeWithoutSelection(){return this.codeAbove.trim().length>0||this.codeBelow.trim().length>0}get hasContent(){return this.codeAbove.trim().length>0||this.codeSelected.trim().length>0||this.codeBelow.trim().length>0}get replaceSelectionStreaming(){return(e,t)=>new S6(t,this._selection,e)}get insertStreaming(){return(e,t)=>new r0(t,this._selection.end,e)}get insertOrReplaceStreaming(){return(e,t)=>new _T(t,this._selection,this._selection,3,!0,e)}createReplyInterpreter(e,t,r,o,s){return new s0(this._uri,this._projectedDocument,this._formattingOptions,e,t,r,o,s)}},s0=class{constructor(e,t,r,o,s,a,c,l){this._uri=e;this._fileIndentInfo=r;this._leadingMarkdownStreaming=o;this._earlyStopping=s;this._streamingStrategyFactory=a;this._textPieceClassifier=c;this._lineFilter=l;this._lastText=void 0;this._initialDocumentSnapshot=new $6(t.originalText),this._workingCopySummarizedDoc=new z6(t)}async processResponse(e,t,r,o){let s=this._workingCopySummarizedDoc.createDerivedDocumentChatResponseStream(r),a=new E6(s,this._uri,this._workingCopySummarizedDoc.text,this._workingCopySummarizedDoc.text.split(`
`).map((p,f)=>new T6(f,4)),new C6(0,0),this._workingCopySummarizedDoc.languageId,this._fileIndentInfo),c=new O6(s,this._leadingMarkdownStreaming,this._earlyStopping,this._textPieceClassifier,this._streamingStrategyFactory(this._lineFilter,a));for await(let p of t){this._lastText=p.text;let{shouldFinish:f}=c.update(p.text);if(f)break}let{didEdits:l,didNoopEdits:u,additionalImports:d}=await c.finish();if(l){let p=this._generateAdditionalImportsEdits(d),f=this._workingCopySummarizedDoc.allReportedEdits.inverse(this._initialDocumentSnapshot.text),m=f.edits.reduce((y,b)=>y.join(b.replaceRange),f.edits[0].replaceRange),h=this._workingCopySummarizedDoc.originalDocumentTransformer.toRange(m),g={lastDocumentContent:this._workingCopySummarizedDoc.originalText,lastWholeRange:h};r.textEdit(this._uri,p),e.storeInInlineSession(g);return}if(d.length>0){r.textEdit(this._uri,this._generateAdditionalImportsEdits(d));return}if(u){e.addAnnotations([{label:"noop edits",message:"Edits were not applied because they were having no actual effects.",severity:"info"}]);return}if(!this._lastText)throw new Error("No text");s.markdown(this._lastText)}_generateAdditionalImportsEdits(e){if(e.length===0)return[];let t=this._workingCopySummarizedDoc.originalText.split(/\r\n|\r|\n/g),r=NW(t,a=>vT(a,this._workingCopySummarizedDoc.languageId));if(r===-1)return[new $r(new Me(0,0,0,0),e.join(`
`)+`

`)];let o=new Set;for(let a=r;a>=0;a--){let c=t[a];if(c.trim()!=="")if(vT(c,this._workingCopySummarizedDoc.languageId))o.add(x6(c));else break}if(e=e.filter(a=>!o.has(a)),e.length===0)return[];let s=t[r].length;return[new $r(new Me(r,s,r,s),`
`+e.join(`
`))]}};var xl=q(Ve());var Et=re("IChatMLFetcher"),a0=class{constructor(){this._stream=new xv;this._seenAnnotationTypes=new Set}get stream(){return this._stream.asyncIterable}update(e,t){t.codeVulnAnnotations&&(!((e.match(/(^|\n)```/g)?.length??0)%2===1)||e.match(/(^|\n)```\w*\s*$/))&&(t.codeVulnAnnotations=void 0),t.codeVulnAnnotations&&(t.codeVulnAnnotations=t.codeVulnAnnotations.filter(r=>!this._seenAnnotationTypes.has(r.details.type)),t.codeVulnAnnotations.forEach(r=>this._seenAnnotationTypes.add(r.details.type))),this._stream.emitOne({text:e,delta:t})}resolve(){this._stream.resolve()}},W6=class{constructor(e){this.deltas=[];this.callback=async(t,r,o)=>{let s=e?await e(t,r,o):void 0;return this.deltas.push(o),s}}};var K6=re("IToolsService");var Y6=q(ht()),ef=q(Ve());var tf=class extends ef.PromptElement{constructor(t,r,o,s,a){super(t);this.workspaceService=r;this.ignoreService=o;this.instantiationService=s;this.logService=a}async render(t,r){let o="uri"in this.props.variableValue?this.props.variableValue.uri:this.props.variableValue;if(await this.ignoreService.isCopilotIgnored(o))return vscpp("ignoredFiles",{value:[o]});if(/\.(png|jpg|jpeg|bmp|gif|tiff)$/i.test(o.path)){let p={status:{description:Y6.t("Images cannot be read in Copilot"),kind:ef.ChatResponseReferencePartStatusKind.Omitted}};return this.props.omitReferences?void 0:vscpp(vscppf,null,vscpp("references",{value:[new ef.PromptReference(this.props.variableName?{variableName:this.props.variableName,value:this.props.variableValue}:this.props.variableValue,void 0,p)]}))}let s="range"in this.props.variableValue?this.props.variableValue.range:void 0,a;try{a=await this.workspaceService.openTextDocumentAndSnapshot(o)}catch(p){this.logService.public.error(p,`Error opening context for ${o}`);let f={status:{description:Y6.t("This file could not be read: {0}",p.message),kind:ef.ChatResponseReferencePartStatusKind.Omitted}};return this.props.omitReferences?void 0:vscpp(vscppf,null,vscpp("references",{value:[new ef.PromptReference(this.props.variableName?{variableName:this.props.variableName,value:this.props.variableValue}:this.props.variableValue,void 0,f)]}))}if(s){let p=this.props.omitReferences?void 0:[new ef.PromptReference(new ar(o,s))];return vscpp(vscppf,null,"# ",this.props.variableName.toUpperCase()," CONTEXT",vscpp("br",null),this.props.description?this.props.description+`:
`:"","Excerpt from ",fc(o),", lines ",s.start.line+1," to ",s.end.line+1,":",vscpp(tt,{includeFilepath:this.props.includeFilepath,languageId:a.languageId,uri:o,range:s,references:p,code:a.getText(s),variableName:this.props.variableName,isSummarized:!1}))}let l=await this.instantiationService.createInstance(Jp).summarizeDocument(a,void 0,s,r.tokenBudget,{costFnOverride:QQ}),u=l.isOriginal?void 0:{status:{description:Y6.t("Part of this file was not sent to the model due to context window limitations. Try attaching specific selections from your file instead."),kind:2}},d=this.props.omitReferences?void 0:[new ef.PromptReference(o,void 0,u)];return vscpp(vscppf,null,"# ",this.props.variableName.toUpperCase()," CONTEXT",vscpp("br",null),this.props.description?this.props.description+`:
`:"",vscpp(tt,{includeFilepath:this.props.includeFilepath,languageId:a.languageId,uri:o,range:s,references:d,code:l.text,variableName:this.props.variableName}))}};tf=E([v(1,Be),v(2,Te),v(3,H),v(4,oe)],tf);var QQ={createCostFn(n){let e=new Zm(t=>{if(n.languageId==="typescript"){let r=t.parent?e.get(t.parent):1,o=t.text.trim();if(o.startsWith("private "))return r*1.1;if(o.startsWith("export ")||o.startsWith("public "))return r*.9}return 1});return(t,r)=>{if(!t)return r;if(t.kind==="import_statement")return 1e3;let o=e.get(t);return r*o}}};var Bye=q(ht()),wT=q(Ve());var Q6=class extends wT.PromptElement{constructor(e){super(e)}async render(e,t){let r={status:{description:Bye.t("Images cannot be read in Copilot"),kind:wT.ChatResponseReferencePartStatusKind.Omitted}};if(this.props.omitReferences)return;let o=zt.parse("Pasted Image from Clipboard");return vscpp(vscppf,null,vscpp("references",{value:[new wT.PromptReference(this.props.variableName?{variableName:this.props.variableName,value:o}:o,void 0,r)]}))}};var DT=q(Ve());var qye=q(Ve());var X6=new class{constructor(){this._descriptors=[]}setIntents(n){this._descriptors=this._descriptors.concat(n)}getIntents(){return this._descriptors}};var Ld=re("IIntentService"),kT=class{constructor(e){this._instantiationService=e;this._intents=null}_getOrCreateIntents(){return this._intents||(this._intents=X6.getIntents().map(e=>this._instantiationService.createInstance(e))),this._intents}get unknownIntent(){let t=this._getOrCreateIntents().find(r=>r.id==="unknown");if(!t)throw new Error("Unknown intent not found");return t}getIntents(e){return this._getOrCreateIntents().filter(r=>r.locations.includes(e))}getIntent(e,t){return this.getIntents(t).find(r=>r.id===e)}getIntentByFunctionName(e,t){return this.getIntents(t).find(r=>r.intentDetectionInput.functionName===e)}};kT=E([v(0,H)],kT);var mx=re("ICommandService"),RT=class{constructor(e){this.intentService=e}getCommands(e){return this.intentService.getIntents(e).filter(t=>!t.commandInfo||!t.commandInfo.hiddenFromUser).map(t=>({commandId:t.id,intent:t,details:t.description,locations:t.locations}))}getCommand(e,t){return this.getCommands(t).find(r=>r.commandId===e)}};RT=E([v(0,Ld)],RT);var fh=class extends qye.PromptElement{constructor(t,r){super(t);this.commandService=r}getIntentDescription(t){let r=this.commandService.getCommand(t,this.props.location)?.intent;return!r||r.isListedCapability===!1?void 0:r.description}async prepare(){let t=new Set,r=Object.entries(oT).reduce((o,[s,a])=>{let c=this.getIntentDescription(s);if(c&&t.has(c))return o;c&&(t.has(c),o+=`
* ${c}`);for(let l of Object.values(a)){let u=this.getIntentDescription(l);u&&(o+=`
* ${u}`)}return o},"");return{modelName:this.props.endpoint.name,commandDescriptions:r}}render(t){return vscpp(vscppf,null,"You can answer general programming questions and perform the following tasks: ",t.commandDescriptions,vscpp("br",null),"You use the ",t.modelName," large language model.")}};fh=E([v(1,mx)],fh);var jye=q(Ve()),vn=class extends jye.PromptElement{render(){return vscpp(vscppf,null,'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.")}};var Hye=q(Ve());var TKe=["auto","en","fr","it","de","es","ru","zh-CN","zh-TW","ja","ko","cs","pt-br","tr","pl"],kt=class extends Hye.PromptElement{constructor(t,r,o){super(t);this.configurationService=r;this.envService=o}render(){let t=this.configurationService.getConfig(le.LocaleOverride);if(!TKe.find(o=>t===o))return;let r=t!=="auto"?t:this.envService.language;if(r!=="en")return vscpp(vscppf,null,"Respond in the following locale: ",r)}};kt=E([v(1,be),v(2,it)],kt);var Vye=q(Ve()),Ze=class extends Vye.PromptElement{render(){return vscpp(vscppf,null,"Follow Microsoft content policies.",vscpp("br",null),"Avoid content that violates copyrights.",vscpp("br",null),`If you are asked to generate content that is harmful, hateful, racist, sexist, lewd, violent, or completely irrelevant to software engineering, only respond with "Sorry, I can't assist with that."`,vscpp("br",null),"Keep your answers short and impersonal.",vscpp("br",null))}};var hx=q(Ve());var Es=class n{constructor(e){this._source=e;this._variables=null}_getVariables(){if(!this._variables){this._variables=[];for(let e=0;e<this._source.length;e++){let t=this._source[e];if(t.value){let r=t.name,o=this.uniqueFileName(r,this._source.slice(0,e));this._variables.push({reference:t,originalName:r,uniqueName:o,value:t.value,range:t.range})}}}return this._variables}reverse(){let e=this._source.slice(0);return e.reverse(),new n(e)}find(e){return this._getVariables().find(e)}filter(e){let t=[];for(let r of this._getVariables())e(r)&&t.push(r.reference);return new n(t)}*[Symbol.iterator](){yield*this._getVariables()}substituteVariablesWithReferences(e){let t=[];for(let r of this._getVariables())r.range&&t.push({start:r.range[0],end:r.range[1],newText:`[#${r.uniqueName}](#${r.uniqueName}-context)`});t.sort((r,o)=>o.end-r.end);for(let r of t)e=e.slice(0,r.start)+r.newText+e.slice(r.end);return e}hasVariables(){return this._getVariables().length>0}uniqueFileName(e,t){let r=t.filter(o=>o.name===e).length;return r===0?e:`${e}-${r}`}};var Nt=class extends hx.PromptElement{render(e,t){let r=t.endpoint,{children:o,...s}=this.props;if(!o?.some(c=>typeof c=="object"&&c.ctor===Tt))throw new Error("HistoryWithInstructions must have an InstructionMessage child");let a=M6(r.family);return vscpp(vscppf,null,a?vscpp(c0,{...s,priority:this.props.historyPriority}):void 0,...o,a?void 0:vscpp(c0,{...s,priority:this.props.historyPriority}))}},c0=class extends hx.PromptElement{render(e,t){let r=this.props.history;if(this.props.inline&&r.length>0){let s=`The current code is a result of a previous interaction with you. Here are my previous messages: 
- ${r.map(a=>a.request.message).join(`
- `)}`;r=[new nx({message:s,type:"user"})]}let o=[];return r.forEach((s,a)=>{if(s.request.type==="user"){let c=s.promptVariables&&!this.props.omitPromptVariables?this.removeDuplicateVars(s.promptVariables,this.props.currentTurnVars,r.slice(a+1)):new Es([]);o.push(vscpp($n,{priority:900,chatVariables:c,query:s.request.message,omitReferences:!0}))}s.response?.type==="model"&&!["off-topic","filtered"].includes(s.status)&&o.push(vscpp(hx.AssistantMessage,{name:s.response.name},s.response.message))}),vscpp(hx.PrioritizedList,{priority:this.props.priority,descending:!1},o)}removeDuplicateVars(e,t,r){return e.filter(o=>!(r.some(s=>s.promptVariables?.find(a=>Gye(o,a)))||t?.find(s=>Gye(o,s))))}};function Gye(n,e){return n.uniqueName!==e.uniqueName?!1:n.value instanceof zt&&e.value instanceof zt?n.value.toString()===e.value.toString():n.value instanceof ar&&e.value instanceof ar?JSON.stringify(n.value)===JSON.stringify(e.value):!1}var AT=q(Ve());var J6=re("ICustomInstructionsService"),CKe=".github/copilot-instructions.md";function EKe(n){return typeof n=="object"&&n!==null?typeof n.file=="string"&&(n.language===void 0||typeof n.language=="string"):!1}function wKe(n){return typeof n=="object"&&n!==null?typeof n.text=="string"&&(n.language===void 0||typeof n.language=="string"):!1}var PT=class{constructor(e,t,r,o){this.configurationService=e;this.envService=t;this.workspaceService=r;this.fileSystemService=o;this._configKeyToSettingsUri=new Map,this._configKeyToSettingsUri.set(le.CodeGenerationInstructions,zt.from({scheme:this.envService.uriScheme,authority:"settings",path:`/${le.CodeGenerationInstructions.fullyQualifiedId}`})),this._configKeyToSettingsUri.set(le.TestGenerationInstructions,zt.from({scheme:this.envService.uriScheme,authority:"settings",path:`/${le.TestGenerationInstructions.fullyQualifiedId}`})),this._configKeyToSettingsUri.set(le.CodeFeedbackInstructions,zt.from({scheme:this.envService.uriScheme,authority:"settings",path:`/${le.CodeFeedbackInstructions.fullyQualifiedId}`}))}async fetchInstructions(e){let t=[];return e.includeCodeGenerationInstructions&&t.push(this._collectUserSettingsInstructions(le.CodeGenerationInstructions)),e.includeTestGenerationInstructions&&t.push(this._collectUserSettingsInstructions(le.TestGenerationInstructions)),e.includeCodeFeedbackInstructions&&t.push(this._collectUserSettingsInstructions(le.CodeFeedbackInstructions)),(await Promise.allSettled(t)).filter(s=>s.status==="fulfilled").map(s=>s.value).flat()}async _collectUserSettingsInstructions(e){let t=[],r=[];this.configurationService.getConfig(le.UseInstructionFiles)&&await this._collectInstructionsFromFile(CKe,void 0,t);let o=this.configurationService.inspectConfig(e);o&&await this.collectInstructionsFromSettings([o.workspaceFolderValue,o.workspaceValue,o.globalValue],r,t);let s=this._configKeyToSettingsUri.get(e);return Vs(s!==void 0,"reference should not be undefined"),r.length>0&&t.push({kind:1,content:r,reference:s}),t}async collectInstructionsFromSettings(e,t,r){let o=new Set,s=new Set;for(let a of e)if(Array.isArray(a))for(let c of a)EKe(c)&&!o.has(c.file)&&(o.add(c.file),await this._collectInstructionsFromFile(c.file,c.language,r)),wKe(c)&&!s.has(c.text)&&(s.add(c.text),t.push({instruction:c.text,languageId:c.language}))}async _collectInstructionsFromFile(e,t,r){let o=this.workspaceService.getWorkspaceFolders().map(async s=>{let a=zt.joinPath(s,e),c=await this.readInstructionsFromFile(a);if(!c)return;let l=[],u=c.split(/\r\n|\r|\n/);for(let d of u){let p=d.trim();p!==""&&l.push({instruction:p,languageId:t})}l.length>0&&r.push({kind:0,content:l,reference:a})});await Promise.all(o)}async readInstructionsFromFile(e){try{let t=await this.fileSystemService.readFile(e);return new TextDecoder().decode(t)}catch{return}}};PT=E([v(0,be),v(1,it),v(2,Be),v(3,gn)],PT);var zye=q(Ve()),Rt=class n extends zye.PromptElement{static{this._regex=/^[a-zA-Z_][\w\.\-]*$/}render(){let{name:e}=this.props;if(!n._regex.test(e))throw new Error(`Invalid tag name: ${this.props.name}`);return vscpp(vscppf,null,"<",e,">"," ",vscpp("br",null),vscpp(vscppf,null,this.props.children," ",vscpp("br",null)),"</",e,">",vscpp("br",null))}};var sn=class extends AT.PromptElement{constructor(t,r){super(t);this.customInstructionsService=r}async render(t,r){let{includeCodeGenerationInstructions:o,includeTestGenerationInstructions:s,includeCodeFeedbackInstructions:a,customIntroduction:c}=this.props,l=await this.customInstructionsService.fetchInstructions({includeCodeGenerationInstructions:o??!0,includeTestGenerationInstructions:s??!1,includeCodeFeedbackInstructions:a??!1}),u=[];for(let p of l){let f=this.createInstructionElement(p);f&&u.push(f)}return u.length===0?void 0:vscpp(vscppf,null,c??"When generating code, please follow these user provided coding instructions."," You can ignore an instruction if it contradicts a system message.",vscpp("br",null),vscpp(Rt,{name:"instructions"},...u))}createInstructionElement(t){let r=[];for(let o of t.content)o.languageId?o.languageId===this.props.languageId&&r.push(`For ${o.languageId} code: ${o.instruction}`):r.push(o.instruction);if(r.length!==0)return vscpp(vscppf,null,vscpp("references",{value:[new Z6(t,r)]}),vscpp(vscppf,null,r.map(o=>vscpp(AT.TextChunk,null,o))))}};sn=E([v(1,J6)],sn);var Z6=class extends AT.PromptReference{constructor(t,r){super(t.reference);this.instructions=t;this.usedInstructions=r}};function XQ(n){let e=0,t=0,r=0,o=0,s=0;for(let a of n)a instanceof Z6&&(e+=a.usedInstructions.length,r+=a.usedInstructions.reduce((c,l)=>c+l.length,0),t+=Math.max(a.instructions.content.length-a.usedInstructions.length,0),a.instructions.kind===0?o++:s+=a.usedInstructions.length);return{codeGenInstructionsCount:e,codeGenInstructionsLength:r,codeGenInstructionsFilteredCount:t,codeGenInstructionFileCount:o,codeGenInstructionSettingsCount:s}}var l0=class extends DT.PromptElement{constructor(t,r,o,s){super(t);this.envService=r;this.experimentationService=o;this._configurationService=s}async render(t,r){let{query:o,history:s,chatVariables:a}=this.props.promptContext,c=this._configurationService.getExperimentBasedConfig(le.ProjectLabelsChat,this.experimentationService),l=this.envService.OS,u=this._configurationService.getExperimentBasedConfig(le.ChatPromptRewrite,this.experimentationService);return vscpp(vscppf,null,vscpp(DT.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),vscpp(vn,null),vscpp(Ze,null)),vscpp(Nt,{flexGrow:1,historyPriority:700,passPriority:!0,history:s,currentTurnVars:a},vscpp(Tt,{priority:1e3},u?vscpp(vscppf,null,"Provide thorough responses for complex questions, and concise answers for simpler tasks. Always aim for accuracy and brevity.",vscpp("br",null),"For programming or logic tasks, think through the problem step-by-step before responding.",vscpp("br",null),"If unable to perform a task, state so directly, without apology.",vscpp("br",null),"Avoid conversational language and filler phrases like 'Certainly' or 'Of course'. Be direct and clear.",vscpp("br",null),"Use Markdown, and always include the programming language in code blocks.",vscpp("br",null),vscpp("br",null),"The user is conversing with you within Visual Studio Code, potentially referring to context from selected code, the active file, other open editors, terminal, debugger output, source control, or other parts of the editor. Context is either explicitly attached by the user or implicitly added by the editor. If it seems like the user is referring to context that isn't available, clarify and ask the user to attach the relevant file into the chat conversation.",vscpp("br",null),"The user is working on ",l,", which you should consider when providing OS-specific commands.",vscpp("br",null),vscpp("br",null),vscpp(fh,{location:2,endpoint:this.props.endpoint}),vscpp("br",null)):vscpp(vscppf,null,vscpp(fh,{location:2,endpoint:this.props.endpoint}),vscpp("br",null),"First think step-by-step - describe your plan for what to build, then output the code.",vscpp("br",null),"Minimize any other prose.",vscpp("br",null),"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The user is working on a ",l," machine. Please respond with system specific commands if applicable.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn.",vscpp("br",null)),vscpp(kt,null))),c&&vscpp(Xi,{flexGrow:1,priority:600}),vscpp(DT.UserMessage,{flexGrow:1,priority:750},vscpp(sn,{languageId:void 0})),vscpp(tn,{priority:899,flexGrow:2,endpoint:this.props.endpoint,promptContext:this.props.promptContext}),vscpp($n,{flexGrow:2,priority:900,chatVariables:a,query:o}))}};l0=E([v(1,it),v(2,fn),v(3,be)],l0);var Ai=class extends xl.PromptElement{async render(e,t){let r=await e8(this.props.chatVariables);if(r.length!==0)return this.props.embeddedInsideUserMessage?vscpp(Do,{priority:this.props.priority},"<attachment>",...r,"</attachment>"):vscpp(vscppf,null,...r.map(o=>JQ(o,this.props.priority)))}},Oo=class extends xl.PromptElement{render(e,t){let r=this.props.chatVariables.substituteVariablesWithReferences(this.props.query);return vscpp(vscppf,null,r)}},$n=class extends xl.PromptElement{async render(e,t){let r=this.props.maintainOrder?this.props.chatVariables:this.props.chatVariables.reverse(),o=await e8(r,this.props.includeFilepath,this.props.omitReferences);return vscpp(vscppf,null,...o.map(s=>JQ(s,this.props.priority&&this.props.priority-1)),JQ(vscpp(Oo,{chatVariables:r,query:this.props.query}),this.props.priority))}};function JQ(n,e){return vscpp(xl.UserMessage,{priority:e},n)}async function e8(n,e,t){let r=[];for(let{uniqueName:o,value:s,reference:a}of n)s instanceof zt||s instanceof ar?r.push(vscpp(tf,{includeFilepath:e,variableName:o,variableValue:s,omitReferences:t,description:a.modelDescription})):typeof s=="string"?r.push(vscpp(xl.TextChunk,null,!t&&vscpp("references",{value:[new xl.PromptReference({variableName:o})]}),"# ",o.toUpperCase()," CONTEXT",vscpp("br",null),a.modelDescription?a.modelDescription+`:
`:"",s)):s instanceof Uve&&r.push(vscpp(Q6,{variableName:o,variableValue:await s.data(),omitReferences:t}));return r}var tn=class extends xl.PromptElement{constructor(t,r,o,s,a,c,l){super(t);this.chatFetcher=r;this.instantiationService=o;this.toolsService=s;this.logService=a;this.endpointProvider=c;this.tokenizerProvider=l}async render(t,r){let o=this.props.promptContext.tools;if(!o||!o.toolReferences.length)return;let s=[];for(let a of o.toolReferences){let c=this.toolsService.getTool(a.name);if(!c)throw new Error(`Unknown tool: "${a.name}"`);let l=await this.endpointProvider.getChatEndpoint("gpt-4o-mini"),u=await this.fetchToolArgs(c,l),d=await this.toolsService.invokeTool(c.name,{parameters:u,toolInvocationToken:o.toolInvocationToken},Zt.None),p=a.range?this.props.promptContext.query.slice(a.range[0],a.range[1]):void 0;s.push({name:p,value:d})}return this.props.embeddedInsideUserMessage?vscpp(Do,{priority:this.props.priority},"<attachment>",this._renderChatToolResults(s),"</attachment>"):vscpp(xl.UserMessage,{priority:this.props.priority},this._renderChatToolResults(s))}_renderChatToolResults(t){return vscpp(vscppf,null,...t.map(r=>this.renderChatToolResult(r)),"These attachments may have useful context for the user's query. The user may refer to these attachments directly using a term that starts with #.",vscpp("br",null))}renderChatToolResult(t){let r=t.name&&` (${t.name})`;return vscpp(vscppf,null,t.value.content.map(o=>{let s=o instanceof N5?vscpp("elementJSON",{data:o.value}):o instanceof cD?o.value:void 0;if(s)return vscpp(xl.TextChunk,null,"Attachment",r,":",vscpp("br",null),s,vscpp("br",null),vscpp("br",null))}))}async fetchToolArgs(t,r){let o={...this.props,promptContext:{...this.props.promptContext,tools:void 0}},s=this.tokenizerProvider.acquireTokenizer(r).countToolTokens([t]),{messages:a}=await Fe.create(this.instantiationService,{...r,modelMaxPromptTokens:r.modelMaxPromptTokens-s},l0,o).render(),c,l=await this.chatFetcher.fetchOne("fetchToolArgs",a,async(u,d,p)=>{p.copilotFunctionCalls&&(c=p.copilotFunctionCalls[0])},Zt.None,2,r,void 0,{tools:[{type:"function",function:{name:t.name,description:t.description,parameters:t.parametersSchema}}],tool_choice:{type:"function",function:{name:t.name}}});if(!c)throw new Error(`Failed to compute args for tool: "${t.name}"`);if(l.type!=="success")throw new Error(`Fetching tool args failed: ${l.type} ${l.reason}`);this.logService.internal.trace(`Function Call: ${c.arguments}`);try{return JSON.parse(c.arguments)}catch(u){throw new Error("Invalid tool arguments: "+u.message)}}};tn=E([v(1,Et),v(2,H),v(3,K6),v(4,oe),v(5,_e),v(6,Qn)],tn);var nf=class{constructor(e,t,r,o){this.endpointProvider=e;this.telemetryService=t;this.parserService=r;this.instaService=o;this.id=nf.ID;this.description=$ye.t("Add documentation comment for this symbol");this.locations=[1];this.commandInfo={}}static{this.ID="doc"}get intentDetectionInput(){let e="generate_documentation_for_code";return{functionName:e,sampleQuestion:"Add jsdoc to this method",functionCallingBlurb:`If the active selection contains a symbol and the user's message is related to documenting code, adding docstrings, adding documentation, or adding comments, you should use the '${e}' function.`}}async invoke(e){let{documentContext:t,request:r}=e;if(!t)throw new Error("Open a file to add documentation.");let o=await Jv(this.parserService,this.telemetryService,t),s=await this.endpointProvider.getChatEndpoint(r);return this.instaService.createInstance(UD,s,t,this,o)}};nf=E([v(0,_e),v(1,ge),v(2,ft),v(3,H)],nf);var UD=class{constructor(e,t,r,o,s,a,c){this.endpoint=e;this.context=t;this.intent=r;this.nodeToDocument=o;this.parserService=s;this.telemetryService=a;this.instantiationService=c;this.location=1}async buildPrompt(e,t,r){let{query:o,history:s,chatVariables:a}=e,c=this.nodeToDocument??await Jv(this.parserService,this.telemetryService,this.context);return await Fe.create(this.instantiationService,this.endpoint,ZQ,{userQuery:o,documentContext:this.context,nodeToDocument:c,endpointInfo:this.endpoint,history:s,chatVariables:a,promptContext:e}).render(t,r)}processResponse(e,t,r,o){let s=this.context.document,a=new qa(s.getText(),Rn.empty,s.languageId),c=this.nodeToDocument?.range??this.context.selection,l;if(s.languageId==="python"){let u=s.getText(c).split(`
`).filter(p=>p!=="").map(p=>p.trim()),d=new Set(u);l=new s0(this.context.document.uri,a,this.context.fileIndentInfo,Cs.Mute,1,(p,f)=>new r0(f,c.start,p),Zi.createCodeBlockClassifier(),p=>!p.value.includes("FILEPATH")&&!d.has(p.value.trim()))}else l=new s0(this.context.document.uri,a,this.context.fileIndentInfo,Cs.Mute,1,(u,d)=>new _T(d,c,c,1,!1,u),Zi.createCodeBlockClassifier(),u=>!u.value.includes("FILEPATH"));return l.processResponse(e,t,r,o)}};UD=E([v(4,ft),v(5,ge),v(6,H)],UD);var ZQ=class extends NT.PromptElement{render(e,t){let r=f6(this.props.documentContext.language.languageId),o=this.props.chatVariables.substituteVariablesWithReferences(this.props.userQuery),s=`${this.getQueryPrefix()} ${o}`.trim();return vscpp(vscppf,null,vscpp(NT.SystemMessage,null,"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You must follow user's requirements carefully.",vscpp("br",null),"You must follow Microsoft content policies.",vscpp("br",null),"You must avoid content that violates copyrights.",vscpp("br",null),"For questions not related to software development, you should give a reminder that you are an AI programming assistant.",vscpp("br",null)),vscpp(tn,{priority:750,endpoint:this.props.endpointInfo,promptContext:this.props.promptContext,flexGrow:1}),vscpp(Ai,{chatVariables:this.props.chatVariables}),vscpp(Xv,{documentContext:this.props.documentContext,nodeToDocument:this.props.nodeToDocument,endpointInfo:this.props.endpointInfo}),vscpp(Nt,{inline:!0,history:this.props.history,passPriority:!0,historyPriority:700},vscpp(Tt,null,"When user asks you to document something, you must answer in the form of a ",r," markdown code block.",vscpp("br",null))),vscpp(NT.UserMessage,null,s))}getQueryPrefix(){let e=this.props.nodeToDocument?.identifier,t=e!==void 0&&e!=="",r=t?e:"the selection",o;switch(this.props.documentContext.language.languageId){case"typescript":case"typescriptreact":o=t?"a TSDoc comment":"TSDoc comment";break;case"javascript":case"javascriptreact":o=t?"a JSDoc comment":"JSDoc comment";break;case"python":o="docstring";break;default:o="documentation comment"}return`Please, given ${r}, generate ${o} only. Do not repeat given code, only reply with ${o} in a code block.`}};var Kye=q(ht());var OT=q(Ve());var Wye=q(Ve()),ii=class extends Wye.PromptElement{render(){return vscpp(vscppf,null,"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn.",vscpp("br",null))}};var n8=q(ht()),vx=q(Ve());var t8=q(Ve());var au=class extends t8.PromptElement{constructor(t,r,o,s,a,c,l,u,d){super(t);this.ignoreService=r;this.extensionContext=o;this.tabsAndEditorsService=s;this.parserService=a;this.logService=c;this.telemetryService=l;this.languageFeaturesService=u;this.workspaceService=d}static{this.DEFAULT_TIMEOUT_MS=200}async prepare(){let t={implementations:[],activeDocument:void 0,isIgnored:!1},{document:r,range:o}=this.props;if(!r){let l=this.tabsAndEditorsService.activeTextEditor;if(!l)return t;r??=Bt.create(l.document),o??=l.selection}if(!o||o.isEmpty)return t;if(await this.ignoreService.isCopilotIgnored(r.uri))return{...t,isIgnored:!0};let s=this.extensionContext.extensionMode===vl.Test?0:this.props.timeoutMs===void 0?au.DEFAULT_TIMEOUT_MS:this.props.timeoutMs,a=[{header:"Relevant function implementations",findImpls:vye},{header:"Relevant class declarations",findImpls:yye},{header:"Relevant type declarations",findImpls:bye}],c=[];for(let{header:l,findImpls:u}of a){let d=await u(this.parserService,this.logService,this.telemetryService,this.languageFeaturesService,this.workspaceService,r,o,s);c.push([l,d])}return{implementations:c,activeDocument:r,isIgnored:!1}}render(t,r){if(!t.implementations.length||!t.activeDocument)return;let o=t.activeDocument.uri;if(t.isIgnored)return vscpp("ignoredFiles",{value:[o]});let s=[];for(let[a,c]of t.implementations){let{references:l,text:u,uris:d}=eX(t.activeDocument,c);if(u.length===0)continue;let p=vscpp(t8.UserMessage,{priority:this.props.priority},a,":",vscpp("br",null),vscpp("br",null),u.map((f,m)=>vscpp(vscppf,null,vscpp(tt,{code:f,languageId:t.activeDocument?.languageId,uri:d[m],references:[l[m]]}),vscpp("br",null))));s.push(p)}return vscpp(vscppf,null,...s)}};au=E([v(1,Te),v(2,qt),v(3,$t),v(4,ft),v(5,oe),v(6,ge),v(7,Ts),v(8,Be)],au);function eX(n,e){let t=[],r=new Set,o=[],s=[];for(let a of e){let c=a.uri??n.uri,l=a.range??Gs(n,a),u=`${c.toString()}-${l.start.line}-${l.start.character}-${l.end.line}-${l.end.character}`;r.has(u)||(r.add(u),t.push(new Xo.PromptReference(new ar(c,l))),o.push(a.text),s.push(c))}return{references:t,text:o,uris:s}}var Ws=class extends vx.PromptElement{constructor(t,r,o,s,a,c,l,u){super(t);this._ignoreService=r;this._configurationService=o;this._tabsAndEditorsService=s;this._scopeSelector=a;this._parserService=c;this._languageFeaturesService=l;this._workspaceService=u}static getSymbolAtCursor(t,r){let{selection:o,document:s}=r;if(!o||!s){let l=t.activeTextEditor;if(!l)return;o=l.selection,s=Bt.create(l.document)}if(!o.isEmpty)return;let a=s.getWordRangeAtPosition(o.active)??o;return{selectedText:s.getText(a),document:s,range:a}}static async getDefinitionAtRange(t,r,o,s,a){if(await t.isCopilotIgnored(o.uri))return;let l=r.getTreeSitterAST(o);if(l===void 0)return;let u=No(s,o),d;a&&(d=await l.getNodeToExplain(u)),d??=await l.getNodeToDocument(u);let{startIndex:p,endIndex:f}="nodeToDocument"in d?d.nodeToDocument:d.nodeToExplain,m=Gs(o,{startIndex:p,endIndex:f});return{identifier:d.nodeIdentifier,text:o.getText(m),range:m,uri:o.uri,startIndex:p,endIndex:f}}static async getSelectedScope(t,r,o,s,a,c){if(!c.document||await t.isCopilotIgnored(c.document.uri))return;let l=Ws.getSymbolAtCursor(o,c),u,d=l?await Ws.getDefinitionAtRange(t,a,l.document,l.range,!1):void 0;if(r.getConfig(le.ExplainScopeSelection)||l&&(d?.identifier!==l.selectedText||!l.selectedText)){let f=o.activeTextEditor;if(!f)return;let m=await s.selectEnclosingScope(f,{reason:n8.t("Select an enclosing range to explain"),includeBlocks:!0});if(m){let h=Bt.create(f.document),g=h.getText(m);if(!g)return;u={codeAtCursor:g,document:h,range:m,definitions:[],references:[]}}}return{symbolAtCursorState:u,definition:d,symbolAtCursor:l}}async prepare(t,r,o){let s=await Ws.getSelectedScope(this._ignoreService,this._configurationService,this._tabsAndEditorsService,this._scopeSelector,this._parserService,this.props).catch(()=>{});if(!s)return;let{symbolAtCursorState:a,definition:c,symbolAtCursor:l}=s;if(l){c?.identifier===l?.selectedText?a??={codeAtCursor:c.text,document:l.document,range:c.range,definitions:[],references:[]}:a??={codeAtCursor:l.document.lineAt(l.range.start).text,document:l.document,range:l.document.lineAt(l.range.start).range,definitions:[],references:[]},r.report(new Ri(n8.t("Searching for relevant definitions...")));try{for(let u of await this._languageFeaturesService.getDefinitions(l.document.uri,l.range.start)){let{uri:d,range:p}=ph(u)?{uri:u.targetUri,range:u.targetRange}:u;if(p.isEqual(l.range))continue;let f=await this._workspaceService.openTextDocumentAndSnapshot(d),m=await Ws.getDefinitionAtRange(this._ignoreService,this._parserService,f,p,!0);m&&a.definitions.push(m)}}catch{}r.report(new Ri(n8.t("Searching for relevant references...")));try{let u=new Set;for(let d of await this._languageFeaturesService.getReferences(l.document.uri,l.range.start)){let{uri:p,range:f}=ph(d)?{uri:d.targetUri,range:d.targetRange}:d;if(f.isEqual(l.range))continue;let m=`${p.toString()}-${f.start.line}-${f.start.character}-${f.end.line}-${f.end.character}`;if(u.has(m))continue;u.add(m);let h=await this._workspaceService.openTextDocumentAndSnapshot(p),g=await Ws.getDefinitionAtRange(this._ignoreService,this._parserService,h,f,!1);g&&a.references.push(g)}}catch{}return a}}render(t,r){if(!t)return;let o=[...t.definitions,...t.references];if(t.codeAtCursor){let{startIndex:a,endIndex:c}=No(t.range,t.document);o.push({version:t.document.version,uri:t.document.uri,range:t.range,text:t.codeAtCursor,startIndex:a,endIndex:c})}let{references:s}=eX(t.document,o);return vscpp(vscppf,null,vscpp("references",{value:s}),vscpp(vx.UserMessage,null,"I have the following  code in the active editor:",vscpp("br",null),vscpp(tt,{uri:t.document.uri,languageId:t.document.languageId,code:t.codeAtCursor}),vscpp("br",null),!!t.definitions.length&&vscpp(vscppf,null,"Here are some relevant definitions for the symbols in my code:",vscpp("br",null)),!!t.definitions.length&&vscpp(vx.PrioritizedList,{priority:this.props.priority,descending:!0},t.definitions.map(a=>vscpp(tt,{uri:t.document.uri,languageId:t.document.languageId,code:a.text}))),!!t.references.length&&vscpp(vscppf,null,vscpp("br",null),"Here are some places where the the symbols in my code are referenced:",vscpp("br",null)),!!t.references.length&&vscpp(vx.PrioritizedList,{priority:this.props.priority-t.definitions.length,descending:!0},t.references.map(a=>vscpp(vscppf,null,!!a.uri&&vscpp(vscppf,null,"From the file ",k1(a.uri.toString()),":",vscpp("br",null)),vscpp(tt,{uri:t.document.uri,languageId:t.document.languageId,code:a.text}),vscpp("br",null))))))}};Ws=E([v(1,Te),v(2,be),v(3,$t),v(4,bd),v(5,ft),v(6,Ts),v(7,Be)],Ws);var LT=class extends OT.PromptElement{constructor(t,r){super(t);this.languageService=r}async prepare(){let t=!1,{document:r,selection:o}=this.props;return r?.uri&&o&&(t=this.languageService.getDiagnostics(r.uri).filter(l=>!!l.range.intersection(o)).filter(l=>l.severity<=oD.Warning).length>0),{explainingDiagnostic:t}}render(t,r){let{query:o,history:s,chatVariables:a}=this.props.promptContext;return a=a.filter(c=>!c.reference.id.startsWith("vscode.implicit")),vscpp(vscppf,null,vscpp(OT.SystemMessage,{priority:1e3},"You are a world-class coding tutor. Your code explanations perfectly balance high-level concepts and granular details. Your approach ensures that students not only understand how to write code, but also grasp the underlying principles that guide effective programming.",vscpp("br",null),vscpp(vn,null),vscpp(Ze,null)),vscpp(Nt,{inline:this.props.isInlineChat,historyPriority:600,passPriority:!0,history:s},vscpp(Tt,{priority:1e3},vscpp(ii,null),vscpp(kt,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"Think step by step:",vscpp("br",null),"1. Examine the provided code selection and any other context like user question, related errors, project details, class definitions, etc.",vscpp("br",null),"2. If you are unsure about the code, concepts, or the user's question, ask clarifying questions.",vscpp("br",null),"3. If the user provided a specific question or error, answer it based on the selected code and additional provided context. Otherwise focus on explaining the selected code.",vscpp("br",null),"4. Provide suggestions if you see opportunities to improve code readability, performance, etc.",vscpp("br",null),vscpp("br",null),"Focus on being clear, helpful, and thorough without assuming extensive prior knowledge.",vscpp("br",null),"Use developer-friendly terms and analogies in your explanations.",vscpp("br",null),"Identify 'gotchas' or less obvious parts of the code that might trip up someone new.",vscpp("br",null),"Provide clear and relevant examples aligned with any provided context.")),vscpp(Xi,{priority:700}),vscpp(OT.UserMessage,{priority:750},vscpp(sn,{languageId:void 0})),vscpp(zs,{document:this.props.document,range:this.props.selection,priority:900}),vscpp(au,{document:this.props.document,range:this.props.selection,priority:800}),!t.explainingDiagnostic&&vscpp(Ws,{document:this.props.document,selection:this.props.selection,priority:800}),vscpp(tn,{priority:899,flexGrow:2,endpoint:this.props.endpoint,promptContext:this.props.promptContext}),vscpp($n,{priority:900,chatVariables:a,query:o}))}};LT=E([v(1,Ts)],LT);var r8="Write an explanation for the active selection as paragraphs of text.",MT=class extends ga{constructor(t,r,o,s,a){super(t,r,o);this.tabsAndEditorsService=s;this.instantiationService=a;this.defaultQuery="Write an explanation for the code above as paragraphs of text."}async buildPrompt(t,r,o){return t.query===""&&(t={...t,query:this.defaultQuery}),super.buildPrompt(t,r,o)}createRenderer(t,r,o,s){let a=this.tabsAndEditorsService.activeTextEditor;return Fe.create(this.instantiationService,r,LT,{promptContext:t,document:a?Bt.create(a?.document):void 0,selection:a?.selection,isInlineChat:this.location===1,endpoint:r})}};MT=E([v(3,$t),v(4,H)],MT);var tX=class extends MT{constructor(){super(...arguments);this.defaultQuery=r8}processResponse(t,r,o,s){return new L6().processResponse(t,r,o,s)}},FT=class{constructor(e,t){this.endpointProvider=e;this.instantiationService=t;this.id="explain";this.locations=[2,1];this.description=Kye.t("Explain how the code in your active editor works")}static{this.ID="explain"}get intentDetectionInput(){let e="explain_code_or_error";return{functionName:e,sampleQuestion:"Write an explanation for the code above as paragraphs of text.",functionCallingBlurb:`If the user's message asks for an explanation of code blocks or an error message, you should use the '${e}' function.`}}async invoke(e){let t=e.location,r=await this.endpointProvider.getChatEndpoint(e.request);return t===1?this.instantiationService.createInstance(tX,this,t,r):this.instantiationService.createInstance(MT,this,t,r)}};FT=E([v(0,_e),v(1,H)],FT);var Wbe=q(ht());var xx=q(Ve());var DX=q(ht()),b0=q(Ve());var nX;function rX(n,e,t){let r=n.replace(/\r\n/g,`
`);return nX=nX?.then(()=>t.getSemanticChunkTree(e,r))??t.getSemanticChunkTree(e,r),nX}function kKe(n){return n&&Array.isArray(n.text)&&(n.needsLeadingElipsis===void 0||typeof n.needsLeadingElipsis=="boolean")&&(n.needsTrailingElipsis===void 0||typeof n.needsTrailingElipsis=="boolean")}function RKe(n){return n&&typeof n.bodyIndent=="string"&&typeof n.fullRange=="object"&&n.body&&Array.isArray(n.body.content)&&(n.body.outline===void 0||kKe(n.body.outline))&&(n.suffix===void 0||typeof n.suffix=="string")&&(n.header===void 0||typeof n.header=="object"&&typeof n.header.original=="string"&&(n.header.outline===void 0||typeof n.header.outline=="string"))}var rf=class{constructor(e,t,r,o){this.lang=t;this._tokenizerProvider=r;this._parserService=o;this._naiveChunker=new Gp(e,this._tokenizerProvider);let s=rf.getFileChunkingOptions(t);this._inlineComment=s?.blockWrap??{start:"",end:""},this._elipsisPlaceholder=s?.elipsisPlaceholder??"...",this._lookForIndentInHeader=s?.lookForIndentInHeader??!0,this._tokenizer=this._tokenizerProvider.acquireTokenizer(e),this._numTokensInEllipsis=this._tokenizer.tokenLength(this._elipsisPlaceholder)+1}static getFileChunkingOptions(e){return e!=="python"&&e!=="ruby"?{elipsisPlaceholder:"/*...*/",blockWrap:{start:"{",end:"}"},lookForIndentInHeader:!1}:{}}get _summaryPlaceHolder(){return this._inlineComment.start+this._elipsisPlaceholder+this._inlineComment.end}async parse(e,t,r){let o=await this.createChunkTree(e,t,r);return o?this.createSummaryFromSemanticChunkTree(o):[]}async createChunkTree(e,t,r){let o=typeof e=="string"?await this.provideQueryTree(e):e;if(!r.isCancellationRequested)return this.createChunkTreeFromQueryTree(o,t,r)}async createSummaryFromSemanticChunkTree(e){return this._doCreateSummaryFromSemanticChunkTree(e,!0)}async _doCreateSummaryFromSemanticChunkTree(e,t=!1){let r=[];if(e.body.content.length!==0&&r.push(this._makeChunksFromStructure(e.bodyIndent,e.body.content,e.fullRange,!t,e.header?.original,e.suffix)),e.body.outline&&e.body.outline.text.length!==0){let o=e.header?.outline??e.header?.original;r.push(this._makeChunksFromStructure(e.bodyIndent,e.body.outline.text,e.fullRange,!0,o,e.suffix,e.body.outline.needsLeadingElipsis,e.body.outline.needsTrailingElipsis).then(s=>(t&&s.length===1&&(s[0]={...s[0],isFullFile:!0}),s)))}return Promise.all(r).then(o=>o.flat())}async createChunkTreeFromQueryTree(e,t,r){let o=De.lift(t.limitToRange);if(o)for(let d of e.roots){let p=Lo(d.info.mainBlock);if(o.containsRange(p)){let f=yD(e.syntaxTreeRoot,[]),m=this.chunkWholeText(f.text,f.range,t.maxTokenLength,0,void 0,o,t.rangeLimitStrategy,"");return{header:{original:"",outline:""},bodyIndent:"",body:{content:m.content.text},fullRange:Lo(e.syntaxTreeRoot)}}}let s=this._parseBlocks(e.roots,"",t.maxTokenLength,t.maxHeaderLengthFactor,o??void 0,t.rangeLimitStrategy),a=s.content.flat(),c=s.outline??[],l=o&&e.roots.some(d=>De.containsRange(Lo(d.info.mainBlock),o))?void 0:this.createOutlineSummaryBody(t.maxTokenLength,yD(e.syntaxTreeRoot,[]),c,"",o??void 0,t.rangeLimitStrategy);return{bodyIndent:"",fullRange:Lo(e.syntaxTreeRoot),body:{content:a,outline:l}}}provideQueryTree(e){return rX(e,this.lang,this._parserService)}chunkWholeText(e,t,r,o=0,s=t,a,c,l="",u,d=[]){if(e.trim().length===0)return{content:{text:[],isFull:!0}};let p=[];try{let f={range:t,text:e},m=s,h=f.text;if(a&&c!==1){let g=De.lift(s),y=_D(a,e,g);f=y.newTextRange;let b=g.intersectRanges(a);if(!b)throw Error("Invalid Body Text Range");m=b,h=this._constructLimitedRange(y.trimmedRight,y.trimmedLeft,f.text,l)}if(p=this._naiveChunker.genericChunking({lineRangeText:[{range:f.range,text:h,sources:[{start:o,end:h.length,range:m}]}],maxTokenLength:r,numTokensInEllipsis:this._numTokensInEllipsis,removeChunksOutsideOfRange:a&&c===1?a:void 0}),a&&p.length>0&&c===1){u||(u=l+this.findNewIndentFromText(l,f.text));let g=p[0].range.startLineNumber>f.range.startLineNumber,y=p[p.length-1].range.endLineNumber<f.range.endLineNumber;g&&(p[0].text=this._constructLimitedRange(!1,!0,p[0].text,u)),y&&(p[p.length-1].text=this._constructLimitedRange(!0,!1,p[p.length-1].text,u))}}catch{return{content:{text:[],isFull:!1},outline:[]}}return{content:{text:p,isFull:!0}}}_parseBlocks(e,t,r,o,s,a){return this._parseSemanticStructure(e,t,r,o,(c,l,u,d)=>{let p=d+l.text;if(this._tokenizer.tokenLength(p)<=u){let g=yl(/^\s*\n/g,p,l.range),y=yl(/(\n\s*$)/g,g.text,g.range);if(s&&a!==1){let b=_D(s,y.text,De.lift(y.range)),_=this._constructLimitedRange(b.trimmedRight,b.trimmedLeft,b.newTextRange.text,d);return{content:{text:[{sources:[{start:0,end:_.length,range:b.newTextRange.range}],range:b.newTextRange.range,text:_}],isFull:!0}}}else return{content:{text:[{sources:[{start:d.length,end:y.text.length,range:y.range}],range:y.range,text:y.text,keywords:[]}],isFull:!0}}}if(c.length===0)return this.chunkWholeText(p,l.range,u,s?0:d.length,void 0,s,a,d);let f=this._parseBlocks(c,d,u,o,s,a),m=f.content,h=f.outline;return{content:{text:m,isFull:!1},outline:h}},s,a)}_createOutlineBody(e,t){let r=e.text.split(`
`),o={lineNumber:e.range.startLineNumber,column:e.range.startColumn},s=[],a=o,c=p=>{let f=p.lineNumber-o.lineNumber,m=p.column;return o.lineNumber===p.lineNumber&&(m=p.column-o.column),{lineNumber:f,column:m}},l=p=>{let f=p.lineNumber-o.lineNumber,m=f>=r.length||p.column===r[f].length-1;return{newPosition:{lineNumber:p.lineNumber,column:p.column+1},isNewLine:m}},u=(p,f)=>{if(p.lineNumber>f.lineNumber||p.lineNumber===f.lineNumber&&p.column>f.column)return;let m=[],h=c(p),g=c(f),y=iu(p,f),b=r[h.lineNumber].substring(h.column);if(h.lineNumber===g.lineNumber){let I=b.substring(0,g.column-h.column),S=l(f);a=S.newPosition,S.isNewLine&&(I+=`
`),m.push(I)}else{let I=r[g.lineNumber].substring(0,g.column),S=l(f);a=S.newPosition,S.isNewLine&&(I+=`
`),m.push(b+`
`);for(let w=h.lineNumber+1;w<g.lineNumber;w++)m.push(r[w]+`
`);m.push(I)}let _=m.join(""),x=yl(/^\s+\n/,_,y);x.text.length>0&&s.push({sources:[{start:0,end:x.text.length,range:x.range}],text:x.text,range:y})},d=p=>{s.push({sources:p.sources,text:p.summary+`

`,range:p.range})};return t.sort((p,f)=>p.range.startLineNumber-f.range.startLineNumber||p.range.endLineNumber-f.range.endLineNumber),t.forEach(p=>{u(a,{lineNumber:p.range.startLineNumber,column:p.range.startColumn}),d(p),a=l({lineNumber:p.range.endLineNumber,column:p.range.endColumn}).newPosition}),u(a,{lineNumber:e.range.endLineNumber,column:e.range.endColumn}),s}createOutlineSummaryBody(e,t,r,o,s,a){let c=t;if(c.range.startColumn>=o.length){let f={startLineNumber:c.range.startLineNumber,startColumn:c.range.startColumn-o.length,endLineNumber:c.range.endLineNumber,endColumn:c.range.endColumn},m=o+c.text;c={text:m,range:f,sources:[{start:0,end:m.length,range:f}]}}let l=!1,u=!1;if(s&&a!==1){if(r.length===1&&De.lift(r[0].range).containsRange(s))return{text:[]};let f=_D(s,t.text,De.lift(t.range));u=f.trimmedLeft,l=f.trimmedRight,c={text:f.newTextRange.text,range:f.newTextRange.range,sources:[{start:0,end:f.newTextRange.text.length,range:f.newTextRange.range}]}}let d=this._createOutlineBody(c,r.map(f=>({sources:f.sources,summary:r0e(f.summary),range:f.range,needsTrailingElipsis:l,needsLeadingElipsis:u,keyword:f.keyword}))),p=[];try{if(p=this._naiveChunker.genericChunking({lineRangeText:d,removeEmptyLines:!1,maxTokenLength:e,numTokensInEllipsis:this._numTokensInEllipsis,removeChunksOutsideOfRange:s&&a===1?s:void 0}),s&&p.length>0&&a===1){let f=p[0].range.startLineNumber<t.range.startLineNumber,m=p[p.length-1].range.endLineNumber>t.range.endLineNumber;f&&(p[0].text=this._constructLimitedRange(!1,!0,p[0].text,o)),m&&(p[p.length-1].text=this._constructLimitedRange(!0,!1,p[p.length-1].text,o))}}catch(f){return console.error(`caught error in naive chunker: ${f}`),{text:[]}}return{text:p,needsLeadingElipsis:u,needsTrailingElipsis:l}}async _makeChunksFromStructure(e,t,r,o,s,a,c,l){return zn(await Promise.all(t.map(async(u,d)=>{let p;RKe(u)?p=await this._doCreateSummaryFromSemanticChunkTree(u):p=u;let f=s&&s.length>0?s:"";(c||o&&d!==0)&&(f+=`${e}${this._elipsisPlaceholder}
`);let m="";if((l||o&&d!==t.length-1)&&(m+=`
${e}${this._elipsisPlaceholder}`),a&&a.length>0&&(m+=a),Array.isArray(p))return zn(p.map(g=>{if(g.text.trim().length!==0)return{range:g.range,text:f+g.text+m,sources:g.sources.map(y=>({start:y.start+f.length,end:y.end+f.length,range:y.range}))}}));if(p.text.trim().length===0)return;let h={startColumn:(d===0?r:p.range).startColumn,startLineNumber:(d===0?r:p.range).startLineNumber,endColumn:r.endColumn,endLineNumber:r.endLineNumber};return{sources:p.sources.map(g=>({start:g.start+f.length,end:g.end+f.length,range:g.range})),range:h,text:f+p.text+m}}))).flat()}findNewIndent(e,t,r){let s=(this._lookForIndentInHeader?t.text.substring(0,r.startIndex-t.startIndex):r.text).match(new RegExp(`\\n+(\\s*)${e}${this._lookForIndentInHeader?"$":""}`));return s&&s.length>1?s[1]:""}findNewIndentFromText(e,t){let r=t.match(new RegExp(`\\n+(\\s*)${e}${this._lookForIndentInHeader?"$":""}`));return r&&r.length>1?r[1]:""}_constructLimitedRange(e,t,r,o){return r.length===0?"":(t?`${o}${this._elipsisPlaceholder}
`:"")+r+(e?`
${o}${this._elipsisPlaceholder}`:"")}};rf=E([v(2,Qn),v(3,ft)],rf);var cu=class extends rf{_parseSemanticStructure(e,t,r,o,s,a,c){let l=[],u=p=>{let f=p.info,m=f.mainBlock,h=f.detailBlocks.comments,g=f.detailBlocks.body,y=Lo(g),b=this._getInnerLineRangeText(g),_=g.startIndex-m.startIndex+b.prefix.length,x=this.findNewIndent(t,m,g),I="";for(let ae of h)I+=t+ae.text+`
`;let S=t+m.text.substring(0,_),w=I+S,R=Lo(m),k=iu(jv((h.length>0?h[0]:m).range.startPosition,0,-t.length),{column:R.endColumn,lineNumber:R.endLineNumber});if(a&&c!==1&&!De.lift(k).intersectRanges(a))return;let V=o*r,F=w.replace(/(\n*)(\n\s*)$/g,`
`),K=this._tokenizer.tokenLength(F);if(K>V&&(F=S.replace(/(\n*)(\n\s*)$/g,`
`),K=this._tokenizer.tokenLength(S),K>V)){F="",K=0;let ae=this.chunkWholeText(I+t+m.text,Lo(m),r,I.length+t.length,void 0,a,c,t);return{bodyIndent:t,body:{content:ae.content.text.map(Y=>({...Y,keywords:[]}))},fullRange:k}}let $=b.suffix+m.text.substring(g.endIndex-m.startIndex),j=this._tokenizer.tokenLength(F+`
`+$),D=r-j;k=iu({column:k.startColumn,lineNumber:k.startLineNumber},jv(m.range.endPosition));let A=ru(rx,m.text.substring(0,g.startIndex-m.startIndex),{startColumn:R.startColumn,startLineNumber:R.startLineNumber,endLineNumber:y.startLineNumber,endColumn:y.startColumn}),B,U=I+t;if(l.push({summary:U+A.text+" "+this._summaryPlaceHolder,range:k,sources:[{start:U.length,end:U.length+A.text.length,range:A.range}],keyword:""}),a&&c===1&&!De.lift(k).intersectRanges(a))return;let W;if(a){let ae=!1,Y=!1;for(let X of p.children){let Se=Lo(X.info.mainBlock);if(a.containsRange(Se)){Y=!0;break}if(a.intersectRanges(Se)!==null){if(ae===!0){Y=!0;break}ae=!0}}Y&&(W={content:{text:this.chunkWholeText(b.body.text,b.body.range,r,0,void 0,a,c,t,t+x).content.text,isFull:!1}})}return W||(W=s(p.children,b.body,D,t+x)),W.outline!==void 0&&(B=this.createOutlineSummaryBody(D,b.body,W.outline,t+x,a,c)),{header:{original:F},bodyIndent:t+x,body:{content:W.content.text,outline:B},fullRange:k,suffix:$}},d=zn(e.map(p=>u(p)));return{outline:l,content:d}}_getInnerLineRangeText(e){let t=Lo(e),r=e.text,o=yl(/^\s*\{\s*/,r,t),s=ru(/\s*\}\s*$/,o.text,o.range);return{prefix:r.slice(0,r.length-o.text.length),body:{sources:[{start:0,end:s.text.length,range:s.range}],text:s.text,range:s.range},suffix:o.text.slice(s.text.length)}}};var UT=class{constructor(e,t){this.naiveChunker=new Gp(e,t)}async parse(e,t,r){let o=t.rangeLimitStrategy,s=this._getLineRangeText(e,o!==1?t.limitToRange:void 0);return this.naiveChunker.genericChunking({lineRangeText:s,maxTokenLength:t.maxTokenLength,extraLineRangeSeparator:`

`,removeChunksOutsideOfRange:o===1?De.lift(t.limitToRange)??void 0:void 0})}_getLineRangeText(e,t){e=e.replace(/\r\n/g,`
`);let r=e.split(`
`),o=[],s={lineNumber:0,column:0},a=[],c=t?t.startLineNumber:0,l=t?t.startColumn:void 0,u=Math.min(t?t.endLineNumber+1:r.length,r.length),d=t?t.endColumn:void 0;for(let p=c;p<u;p++)if(p===0&&l?r[p]=r[p].substring(l):p===u-1&&d&&(r[p]=r[p].substring(0,d)),r[p].trim().length===0){if(o.length>0){let f=o.join(`
`),m=iu(s,{lineNumber:p-1,column:r[p-1].length});a.push({sources:[{start:0,end:f.length,range:m}],text:f,range:m}),o.length=0}s={lineNumber:p+1,column:0};continue}else o.push(r[p]);if(o.length>0){let p=o.join(`
`),f=iu(s,{lineNumber:r.length-1,column:r[r.length-1].length});a.push({sources:[{start:0,end:p.length,range:f}],text:p,range:f})}return a}};UT=E([v(1,Qn)],UT);var i8=class extends rf{_parseSemanticStructure(e,t,r,o,s,a,c){let l=[],u=p=>{let f=p.info,m=f.mainBlock,h=f.detailBlocks.decorator,g=f.detailBlocks.docstring,y=f.detailBlocks.body,b={start:0,end:0,range:null};if(g)b.end=g.endIndex-m.startIndex,b.range={startLineNumber:m.range.startPosition.row,startColumn:m.range.startPosition.column,endLineNumber:g.range.endPosition.row,endColumn:g.range.endPosition.column};else if(y)b.end=y.startIndex-m.startIndex,b.range={startLineNumber:m.range.startPosition.row,startColumn:m.range.startPosition.column,endLineNumber:y.range.startPosition.row,endColumn:y.range.startPosition.column};else{let A=ru(1,m.text,b.range);b.end=m.text.length,b.range=A.range}let _=this.findNewIndent(t,m,y),x=[],I="";h&&(I=t+h.text+`
`,x.push({start:t.length,end:h.text.length+t.length,range:Lo(h)}));let S=ru(rx,m.text.substring(0,b.end),b.range);x.push({start:I.length+t.length,end:I.length+t.length+S.text.length,range:S.range});let w=I+t+S.text+`
`,R=iu(jv(m.range.startPosition,0,-t.length),jv(m.range.endPosition));if(h&&(R=iu(jv(h.range.startPosition,0,-t.length),{column:R.endColumn,lineNumber:R.endLineNumber})),a&&c!==1&&!De.lift(R).intersectRanges(a))return;let k=o*r,V=w.replace(/\n+\s*$/g,`
`),F=this._tokenizer.tokenLength(V);if(F>k&&(V=t+S.text.substring(0,y.startIndex-m.startIndex),F=this._tokenizer.tokenLength(V),F>k)){V="",F=0;let A=yl(g?g.endIndex-y.startIndex:0,y.text,Lo(y)),B=this.chunkWholeText(w+`
`+A.text,Lo(m),r,w.length+1,A.range,a,c,t);return{fullRange:R,body:{content:B.content.text},bodyIndent:t}}if(R=iu({column:R.startColumn,lineNumber:R.startLineNumber},jv(m.range.endPosition)),l.push({summary:(g?w+_:w.slice(0,-1)+" ")+this._summaryPlaceHolder,sources:x,range:R,keyword:""}),a&&c===1&&!De.lift(R).intersectRanges(a))return;let K=yD(y,[]),$;if(a){let A=!1,B=!1;for(let U of p.children){let W=Lo(U.info.mainBlock);if(a.containsRange(W)){B=!0;break}if(a.intersectRanges(W)!==null){if(A===!0){B=!0;break}A=!0}}if(B){let U=yl(g?g.endIndex-y.startIndex:0,y.text,Lo(y));$={content:{text:this.chunkWholeText(U.text,Lo(m),r,0,U.range,a,c,t,t+_).content.text,isFull:!1}}}}$||($=s(p.children,K,r-F,t+_));let j=t+m.text.substring(0,y.startIndex-m.startIndex).replace(/\n+\s*$/g,`
`);$.content.isFull&&(V=j);let D;return $.outline!==void 0&&(D=this.createOutlineSummaryBody(r-F,K,$.outline,t+_,a,c)),{header:{original:V,outline:j},bodyIndent:t+_,body:{content:$.content.text,outline:D},fullRange:R}},d=zn(e.map(p=>u(p)));return{outline:l,content:d}}};var PKe=.6,qT=re("ChunkingService"),Yye=(n,e)=>({file:n,text:e.text,sources:e.sources.map(t=>({start:t.start,end:t.end,range:De.lift(t.range)})),range:De.lift(e.range),isFullFile:e.isFullFile}),BT=class{constructor(e,t,r,o){this.instantiationService=e;this.logService=t;this.parserService=r;this.tokenizerProvider=o;this.naiveChunkers=new Map;this.semanticChunkers=new Map}async getQueryMatchTreeForResource(e,t){let r=fo(e),o=_l(r.languageId);if(o)return await rX(t,o,this.parserService)}canSemanticallyChunk(e){return!!this.getSemanticChunker({tokenizer:"o200k_base"},e)}async chunkFileNaive(e,t,r,o,s){let a=o?.maxTokenLength??await Qye();if(s.isCancellationRequested)return[];let c;o&&o.limitToRange&&(o.includeExtraBodyOutsideRange===!0?c=1:o.includeExtraBodyOutsideRange===!1?c=0:c=1);let u=this.getNaiveChunker(e).genericWholeFileChunking(r,{maxTokenLength:a,rangeLimit:o?.limitToRange,rangeLimitStrategy:c}).map(d=>Yye(t,d));return o?.validateChunkLengths&&this.validateChunkLengths(u,a,e),u.filter(d=>d.text)}getNaiveChunker(e){let t=this.naiveChunkers.get(e.tokenizer);if(t)return t;let r=new Gp(e,this.tokenizerProvider);return this.naiveChunkers.set(e.tokenizer,r),r}async chunkFileSemantic(e,t,r,o,s){let a=o?.maxTokenLength??await Qye();if(s.isCancellationRequested)return[];let c;o&&o.limitToRange&&(o.includeExtraBodyOutsideRange===!0?c=1:o.includeExtraBodyOutsideRange===!1?c=0:c=1);let l=o?.maxHeaderLengthFactor??PKe,u=[];try{let d=await this.getSemanticChunker(e,t)?.parse(r,{maxTokenLength:a,maxHeaderLengthFactor:l,limitToRange:o?.limitToRange,rangeLimitStrategy:c},s);if(s.isCancellationRequested)return[];u.push(...Array.from(d??[],p=>Yye(t,p)))}catch(d){this.logService.public.error("Error parsing semantic chunks for the following file: "+t.fsPath),this.logService.public.error(d),u=[]}if(!u.length){let d=typeof r=="string"?r:r.syntaxTreeRoot.text;return this.chunkFileNaive(e,t,d,{maxTokenLength:a,validateChunkLengths:o?.validateChunkLengths,limitToRange:o?.limitToRange,includeExtraBodyOutsideRange:o?.includeExtraBodyOutsideRange},s)}return o?.validateChunkLengths&&this.validateChunkLengths(u,a,e),u.filter(d=>d.text)}validateChunkLengths(e,t,r){for(let o of e){let s=this.tokenizerProvider.acquireTokenizer(r).tokenLength(o.text);s>t*1.2&&console.warn("Produced chunk that is over length limit",{file:o.file+"",range:o.range,chunkTokenLength:s,maxLength:t})}}getSemanticChunker(e,t){let r=fo(t),o=`${r.languageId}+${e.tokenizer}`,s=this.semanticChunkers.get(o);if(s)return s;let a;switch(r.languageId){case"typescript":a=this.instantiationService.createInstance(cu,e,"typescript");break;case"typescriptreact":a=this.instantiationService.createInstance(cu,e,"tsx");break;case"javascript":case"javascriptreact":a=this.instantiationService.createInstance(cu,e,"javascript");break;case"python":a=this.instantiationService.createInstance(i8,e,"python");break;case"java":a=this.instantiationService.createInstance(cu,e,"java");break;case"cpp":case"c":a=this.instantiationService.createInstance(cu,e,"cpp");break;case"csharp":a=this.instantiationService.createInstance(cu,e,"csharp");break;case"go":a=this.instantiationService.createInstance(cu,e,"go");break;case"markdown":a=this.instantiationService.createInstance(UT,e);break;case"ruby":a=this.instantiationService.createInstance(cu,e,"ruby");break;case"rust":a=this.instantiationService.createInstance(cu,e,"rust");break}return a&&this.semanticChunkers.set(o,a),a}};BT=E([v(0,H),v(1,oe),v(2,ft),v(3,Qn)],BT);async function Qye(){return sT}function jT(n){return new Me(n.startLineNumber,n.startColumn,n.endLineNumber,n.endColumn)}async function Xye(n,e){let t=new Qo;try{let r=await n();return e(t.elapsed(),"success"),r}catch(r){throw e(t.elapsed(),wo(r)?"cancelled":"failed"),r}}async function Sl(n,e,t,r){return Xye(()=>(n.internal.debug(`${e} started`),t()),(o,s)=>{n.internal.debug(`${e} ${s}. Elapsed ${o}`),r?.(o,s)})}function Jo(n,e){return function(t,r,o){let s=o.value,a=0,c=t?.constructor?.name?t.constructor.name+"."+r:r;return o.value=async function(...l){let u=a++,d=n(this);return Sl(d,`${c}#${u}`,()=>s.apply(this,l),e?.bind(this))},o}}function o8(n){return function(e,t,r){let o=r.value;return r.value=function(...s){return Xye(()=>o.apply(this,s),n.bind(this))},r}}var RX=q(ht());var u0=re("ISimulationTestContext"),s8=class{constructor(){this.isInSimulationTests=!1}async writeFile(e,t,r){return""}};var Pbe=q(ht());var fX=q(vbe());function d8(n,e){return typeof e=="string"?fX.default.isMatch(n.fsPath,e,{dot:!0,windows:process.platform==="win32"}):fX.default.isMatch(n.fsPath,e.pattern,{dot:!0,windows:process.platform==="win32"})}function ybe(n,e){return e.exclude?.some(t=>d8(n,t))?!1:e.include?e.include.some(t=>d8(n,t)):!0}function bbe(n,e){let t=typeof n=="string"?n:n.baseUri.toString()+n.pattern,r=typeof e=="string"?e:e.baseUri.toString()+e.pattern;return t=t.replace(/\{.*\}/g,""),r=r.replace(/\{.*\}/g,""),`{${t},${r}}`}var Ks=re("IGitService");function VT(n){if(!n)return;if(n.remoteFetchUrls?.length===1)return mX(n.remoteFetchUrls[0]);let e=n.remotes.findIndex(r=>r===n.upstreamRemote);if(e!==-1){let r=n.remoteFetchUrls?.[e];if(r){let o=mX(r);if(o)return o}}let t=n.remotes.findIndex(r=>r==="origin");if(t!==-1){let r=n.remoteFetchUrls?.[t];if(r){let o=mX(r);if(o)return o}}}function mX(n){n=n.replace(/^git@/,"").replace(/\.git$/,"");try{let e=$e.parse(n);if(e.authority!=="github.com"&&e.scheme!=="github.com")return;let t=e.path.replace(/^\//,"").trim(),[r,o,s]=t.split("/");return r&&o?`${r}/${o}`:void 0}catch{return}}function p8(n){if(n.includes("@")&&n.includes(":")){let e="https://"+n.substring(n.indexOf("@")+1).replace(":","/"),t=new URL(e);return t.username="",t.password="",t.search="",t.toString()}else{let e=new URL(n);return e.protocol="https",e.username="",e.password="",e.search="",e.toString()}}var f8=re("codeSearchClient"),GT=re("docsSearchClient");var zT=class extends Error{constructor(t,r){super(r);this.repo=t}},HD=class extends zT{constructor(){super(...arguments);this.name="ERROR_TYPE_MISSING_INACCESSIBLE_REPO_ORG"}},hX=class extends zT{constructor(){super(...arguments);this.name="ERROR_TYPE_DOCS_EMBEDDINGS_UNAVAILABLE"}},VD=class extends zT{constructor(){super(...arguments);this.name="ERROR_TYPE_NOT_INDEXED"}},gX=class extends Error{constructor(){super(...arguments);this.name="ERROR_TYPE_MAX_RETRIES_EXCEEDED"}},vX=class extends Error{constructor(){super(...arguments);this.name="ERROR_TYPE_NO_ACCESS_TO_ENDPOINT"}};function _be({error:n,message:e,repo:t}){switch(n){case"ERROR_TYPE_MISSING_INACCESSIBLE_REPO_ORG":return new HD(t,e);case"ERROR_TYPE_DOCS_EMBEDDINGS_UNAVAILABLE":return new hX(t,e);case"ERROR_TYPE_NOT_INDEXED":return new VD(t,e);default:return new zT(t,e)}}function yX({error:n,message:e}){switch(n){case"ERROR_TYPE_MAX_RETRIES_EXCEEDED":return new gX(e);case"ERROR_TYPE_NO_ACCESS_TO_ENDPOINT":return new vX(e);default:return new Error(e)}}var kbe=q(Ibe()),Rbe=require("util");var h8=class n{constructor(e,t,r,o){this._uri=e,this._languageId=t,this._version=r,this._content=o,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){let t=this.offsetAt(e.start),r=this.offsetAt(e.end);return this._content.substring(t,r)}return this._content}update(e,t){for(let r of e)if(n.isIncremental(r)){let o=Cbe(r.range),s=this.offsetAt(o.start),a=this.offsetAt(o.end);this._content=this._content.substring(0,s)+r.text+this._content.substring(a,this._content.length);let c=Math.max(o.start.line,0),l=Math.max(o.end.line,0),u=this._lineOffsets,d=Tbe(r.text,!1,s);if(l-c===d.length)for(let f=0,m=d.length;f<m;f++)u[f+c+1]=d[f];else d.length<1e4?u.splice(c+1,l-c,...d):this._lineOffsets=u=u.slice(0,c+1).concat(d,u.slice(l+1));let p=r.text.length-(a-s);if(p!==0)for(let f=c+1+d.length,m=u.length;f<m;f++)u[f]=u[f]+p}else if(n.isFull(r))this._content=r.text,this._lineOffsets=void 0;else throw new Error("Unknown change event received");this._version=t}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=Tbe(this._content,!0)),this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let t=this.getLineOffsets(),r=0,o=t.length;if(o===0)return{line:0,character:e};for(;r<o;){let a=Math.floor((r+o)/2);t[a]>e?o=a:r=a+1}let s=r-1;return{line:s,character:e-t[s]}}offsetAt(e){let t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;let r=t[e.line],o=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(r+e.character,o),r)}get lineCount(){return this.getLineOffsets().length}static isIncremental(e){let t=e;return t!=null&&typeof t.text=="string"&&t.range!==void 0&&(t.rangeLength===void 0||typeof t.rangeLength=="number")}static isFull(e){let t=e;return t!=null&&typeof t.text=="string"&&t.range===void 0&&t.rangeLength===void 0}},$T;(function(n){function e(o,s,a,c){return new h8(o,s,a,c)}n.create=e;function t(o,s,a){if(o instanceof h8)return o.update(s,a),o;throw new Error("TextDocument.update: document must be created by TextDocument.create")}n.update=t;function r(o,s){let a=o.getText(),c=SX(s.map(yYe),(d,p)=>{let f=d.range.start.line-p.range.start.line;return f===0?d.range.start.character-p.range.start.character:f}),l=0,u=[];for(let d of c){let p=o.offsetAt(d.range.start);if(p<l)throw new Error("Overlapping edit");p>l&&u.push(a.substring(l,p)),d.newText.length&&u.push(d.newText),l=o.offsetAt(d.range.end)}return u.push(a.substr(l)),u.join("")}n.applyEdits=r})($T||($T={}));function SX(n,e){if(n.length<=1)return n;let t=n.length/2|0,r=n.slice(0,t),o=n.slice(t);SX(r,e),SX(o,e);let s=0,a=0,c=0;for(;s<r.length&&a<o.length;)e(r[s],o[a])<=0?n[c++]=r[s++]:n[c++]=o[a++];for(;s<r.length;)n[c++]=r[s++];for(;a<o.length;)n[c++]=o[a++];return n}function Tbe(n,e,t=0){let r=e?[t]:[];for(let o=0;o<n.length;o++){let s=n.charCodeAt(o);(s===13||s===10)&&(s===13&&o+1<n.length&&n.charCodeAt(o+1)===10&&o++,r.push(t+o+1))}return r}function Cbe(n){let e=n.start,t=n.end;return e.line>t.line||e.line===t.line&&e.character>t.character?{start:t,end:e}:n}function yYe(n){let e=Cbe(n.range);return e!==n.range?{newText:n.newText,range:e}:n}async function ja(n){if(!n)return;let e=await crypto.subtle.importKey("raw",new TextEncoder().encode(n),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),t=Math.floor(Date.now()/1e3).toString(),o=new TextEncoder().encode(t),s=await crypto.subtle.sign("HMAC",e,o),c=Array.from(new Uint8Array(s)).map(l=>l.toString(16).padStart(2,"0")).join("");return`${t}.${c}`}async function WT(n){let e=typeof n=="string"?new TextEncoder().encode(n):n,t=await crypto.subtle.digest("SHA-256",e),r=new Uint8Array(t),o="";for(let s of r)o+=s.toString(16).padStart(2,"0");return o}var KT=class{constructor(e,t){this.baseUri=e;this.pattern=t}get base(){throw new Error("Not implemented")}};var af=re("ISearchService"),g8=class{async findFilesWithDefaultExcludes(e,t,r){return this._findFilesWithDefaultExcludesAndExcludes(e,void 0,t,r)}async findFilesWithExcludes(e,t,r,o){return this._findFilesWithDefaultExcludesAndExcludes(e,t,r,o)}async _findFilesWithDefaultExcludesAndExcludes(e,t,r,o){let s={maxResults:r,exclude:t,useDefaultExcludes:!0,useDefaultSearchExcludes:!0},a=await this.findFiles(e,s,o);return r===1?a[0]:a}};var bYe=1e5,_Ye=1*1024*1024,xYe=new Set(["jpg","jpeg","jpe","png","gif","bmp","tif","tiff","tga","ico","webp","svg","eps","heif","heic","pdf","raw","mp4","m4v","mkv","webm","mov","avi","wmv","flv","mp3","wav","m4a","flac","ogg","wma","weba","aac","7z","bz2","gz","gz","rar","tar","xz","zip","vsix","db","bin","dat","hex","map","wasm","pyc","pdb","sym","git"]),SYe=["node_modules","out","dist",".git",".yarn",".npm",".venv","foo.asar",".vscode-test"],IYe=[".DS_Store","Thumbs.db","package-lock.json","yarn.lock"],TYe=[yr.vscode,yr.vscodeUserData,"output",yr.inMemory,yr.internal,yr.vscodeChatCodeBlock,yr.vscodeChatCodeCompareBlock,"git"];function CYe(n,e){if(TYe.includes(e.scheme))return!1;let t=n.get(Be);if(![yr.file,yr.untitled].includes(e.scheme)&&!t.getWorkspaceFolders().some(s=>e.scheme===s.scheme))return!1;let r=fl(e).replace(/\./,"").toLowerCase();return!(xYe.has(r)||IYe.includes(fc(e).toLowerCase())||e.fsPath.toLowerCase().split(/[/\\]/g).some(s=>SYe.includes(s)))}async function yx(n,e){let t=n.get(Te);return CYe(n,e)&&!await t.isCopilotIgnored(e)}async function Ebe(n,e,t){let r=n.get(Be),o=n.get(af),s=n.get(Te),a=n.get(H);if(await s.init(),t?.isCancellationRequested)return[];let c=new kn;for(let l of r.getWorkspaceFolders()??[]){if(c.size>=e)break;let u=await o.findFilesWithDefaultExcludes(new KT(l,"**/*"),e-c.size,t);if(t.isCancellationRequested)return[];for(let d of u){if(c.size>=e||t.isCancellationRequested)break;await a.invokeFunction(p=>yx(p,d))&&c.set(d)}}return c.keys()}var v8=class{constructor(e,t){this._uri=e;this._chunkingService=t;this._isDisposed=!1;this._disposedCts=new ko}dispose(){this._isDisposed=!0,this._disposedCts.cancel(),this._disposedCts.dispose()}get uri(){return this._uri}async getQueryMatchTree(e){return this._queryMatchTree??=this.getText(this._disposedCts.token).then(t=>{if(!this._isDisposed)return this._chunkingService.getQueryMatchTreeForResource(this._uri,t)}),await po(this._queryMatchTree,e)??void 0}async getBasicChunks(e,t){return this._basicChunks??=this.getText(this._disposedCts.token).then(r=>this._isDisposed?[]:this._chunkingService.chunkFileNaive(e,this._uri,r,{},this._disposedCts.token)),await po(this._basicChunks,t)??[]}async getSemanticChunks(e,t){return this._chunkingService.canSemanticallyChunk(this.uri)?(this._semanticChunks??=this.getQueryMatchTree(this._disposedCts.token).then(r=>this._isDisposed?[]:r?this._chunkingService.chunkFileSemantic(e,this._uri,r,{},this._disposedCts.token):this.getBasicChunks(e,t)),await po(this._semanticChunks,t)??[]):this.getBasicChunks(e,t)}async getHash(){return this._hash||(this._hash=(async()=>{let e=await this.getText(Zt.None);return this._disposedCts.token.isCancellationRequested?"":WT(e)})()),this._hash}},IX=class extends v8{constructor(t,r,o){super(t,r);this._fs=o}async getText(t){return this._text??=this._fs.readFile(this.uri).then(async r=>this._isDisposed||r.byteLength>=_Ye||await(0,kbe.isBinaryFile)(Buffer.from(r))||this._isDisposed?"":new Rbe.TextDecoder().decode(r),r=>""),await po(this._text,t)??""}async getDocument(){return this._doc||(this._doc=(async()=>{let t=await this.getText(Zt.None);return $T.create(this.uri.toString(),"",0,t)})()),this._doc}},y8=class extends v8{constructor(t,r){super(t.uri,r);this._textDocument=t}async getText(t){return this._textDocument.getText()}async getDocument(){return this._textDocument}},wc=re("workspaceFileIndex"),YT=class extends ye{constructor(t,r,o,s,a){super();this._chunkingService=t;this._fileSystem=r;this._instantiationService=o;this._telemetryService=s;this._workspaceService=a;this._textDocumentFiles=new kn;this._fsFiles=new kn;this._onDidCreateFile=this._register(new jt);this.onDidCreateFile=this._onDidCreateFile.event;this._onDidChangeFile=this._register(new jt);this.onDidChangeFile=this._onDidChangeFile.event;this._onDidDeleteFile=this._register(new jt);this.onDidDeleteFile=this._onDidDeleteFile.event;this._commonInit=new kr(async()=>{this.registerListeners(),await this._workspaceService.ensureWorkspaceIsFullyLoaded(),await Promise.all(this._workspaceService.textDocuments.map(async t=>{await this._instantiationService.invokeFunction(r=>yx(r,t.uri))&&this._textDocumentFiles.set(t.uri,new y8(t,this._chunkingService))}))})}get fileSystemFileCount(){return this._fsFiles.size}dispose(){super.dispose(),pv(this._fsFiles.values()),this._fsFiles.clear(),pv(this._textDocumentFiles.values()),this._textDocumentFiles.clear()}get(t){return this._textDocumentFiles.get(t)||this._fsFiles.get(t)}*values(){let t=new kn;for(let[r,o]of this._textDocumentFiles.entries())yield o,t.set(r);for(let[r,o]of this._fsFiles.entries())t.has(r)||(t.set(r),yield o)}registerListeners(){let t=async o=>{if(!await this._instantiationService.invokeFunction(c=>yx(c,o.uri)))return;let s=this._textDocumentFiles.get(o.uri),a=this._fsFiles.get(o.uri);s?.dispose(),this._textDocumentFiles.set(o.uri,new y8(o,this._chunkingService)),!s&&!a?this._onDidCreateFile.fire(o.uri):this._onDidChangeFile.fire(o.uri)};this._register(this._workspaceService.onDidOpenTextDocument(t)),this._register(this._workspaceService.onDidChangeTextDocument(o=>t(o.document))),this._register(this._workspaceService.onDidCloseTextDocument(o=>{let s=this._textDocumentFiles.get(o.uri);if(!s)return;this._textDocumentFiles.delete(o.uri),s.dispose(),this._fsFiles.get(o.uri)?this._onDidChangeFile.fire(o.uri):this._onDidDeleteFile.fire(o.uri)}));let r=this._register(this._fileSystem.createFileSystemWatcher("**/*"));this._register(r.onDidChange(async o=>{if(!await this._instantiationService.invokeFunction(a=>yx(a,o)))return;let s=this._fsFiles.has(o);this.createOrUpdateFsEntry(o),s?this._onDidChangeFile.fire(o):this._onDidCreateFile.fire(o)})),this._register(r.onDidCreate(async o=>{!await this._instantiationService.invokeFunction(a=>yx(a,o))||!((await this._fileSystem.stat(o)).type&1)||this._fsFiles.has(o)||(this.createOrUpdateFsEntry(o),this._onDidCreateFile.fire(o))})),this._register(r.onDidDelete(o=>{let s=this._fsFiles.get(o);if(!s){for(let[a,c]of this._fsFiles)a.scheme===o.scheme&&a.authority===o.authority&&a.path.startsWith(o.path+"/")&&(this._fsFiles.delete(c.uri),this._onDidDeleteFile.fire(c.uri));return}s.dispose(),this._fsFiles.delete(o),this._onDidDeleteFile.fire(o)}))}async preLoadWorkspaceFiles(t,r){switch(this._preloadWorkspaceFilesState?.type){case"full":return;case"partial":case"pending":if(this._preloadWorkspaceFilesState.count>=t)return;break}let o=(async()=>{await this._commonInit.value;let s=Array.from(await this._instantiationService.invokeFunction(a=>Ebe(a,t,r)));for(let a of s)this.createOrUpdateFsEntry(a);this._preloadWorkspaceFilesState?.type==="pending"&&this._preloadWorkspaceFilesState.p===o&&(r.isCancellationRequested?this._preloadWorkspaceFilesState=void 0:this._preloadWorkspaceFilesState=s.length<t?{type:"full"}:{type:"partial",count:t})})();return this._preloadWorkspaceFilesState={type:"pending",count:t,p:o},o}initialize(){return this._initialized??=(async()=>{switch(await this._commonInit.value,this._preloadWorkspaceFilesState?.type){case"full":break;case"partial":case"pending":default:{let t=Array.from(await this._instantiationService.invokeFunction(r=>Ebe(r,bYe,Zt.None)));for(let r of t)this.createOrUpdateFsEntry(r)}}this._telemetryService.sendMSFTTelemetryEvent("workspaceChunkIndex.initialize",{},{totalFileCount:ti.reduce(this.values(),t=>t+1,0)})})(),this._initialized}createOrUpdateFsEntry(t){let r=this._fsFiles.get(t);r&&r.dispose();let o=new IX(t,this._chunkingService,this._fileSystem);this._fsFiles.set(t,o)}};YT=E([v(0,qT),v(1,gn),v(2,H),v(3,ge),v(4,Be)],YT);async function b8(n,e,t,r,o){let s=n.get(wc),a=n.get(qT),c=new kn;for(let u of t){let d=c.get(u.file);d?d.push(u):c.set(u.file,[u])}let l=await Promise.all(Array.from(c,async([u,d])=>{let p=s.get(u);if(p&&a.canSemanticallyChunk(u)){let f=new Set;if(r.shouldUseRangedChunks)for(let m of d){let h=m.range,g=await EYe(p,e,h,o,a);if(o.isCancellationRequested)return[];g.length===0?f.add(m):g.forEach(y=>f.add(y))}else{let m=await p.getSemanticChunks(e,o);if(o.isCancellationRequested)return[];for(let h of d){let g=!1;for(let y of m)y.range.intersectRanges(h.range)&&(f.add(y),g=!0);g||f.add(h)}}return Array.from(f)}else return d}));return Array.from(new Set(l.flat()))}async function EYe(n,e,t,r,o){let s=l=>o.chunkFileNaive(e,n.uri,l,{limitToRange:t},r),a=l=>o.chunkFileSemantic(e,n.uri,l,{limitToRange:t},r);return await po((async()=>{let l=await n.getText(r);if(fo(n.uri).languageId==="markdown")return o.canSemanticallyChunk(n.uri)?a(l):s(l);let u=await n.getQueryMatchTree(r);return u?a(u):s(l)})(),r)??[]}var f0=class extends ye{constructor(t,r,o,s,a,c,l,u,d){super();this._logService=t;this._instantiationService=r;this._authenticationService=o;this._codeSearchClient=s;this._ignoreService=a;this._telemetryService=c;this._workspaceChunkIndex=l;this._workspaceService=u;this._gitService=d;this.id="codesearch";this.timeout=5e3}async searchFileChunks(t,r,o,s,a){let c;try{c=await this.getSimilarFilesFromCodeSearch(r,o,a)}catch(u){if(this._telemetryService.sendMSFTTelemetryEvent("codeSearchChunkSearch.search.error",{errorMessage:u instanceof Error?u.message:u.toString()}),u instanceof HD)try{if(this._authenticationService.permissiveGitHubSession)return{chunks:[]};let d=await this._authenticationService.getPermissiveGitHubSession({forceNewSession:{detail:Pbe.t("To show you more relevant Copilot Chat results, we need permission to read the contents of your repository on GitHub."),learnMore:$e.parse("https://aka.ms/copilotRepoScope")}});if(a.isCancellationRequested)throw new dt;d&&(c=await this.getSimilarFilesFromCodeSearch(r,o,a))}catch{}throw u}if(a.isCancellationRequested)throw new dt;if(!c)return{chunks:[]};this._telemetryService.sendMSFTTelemetryEvent("codeSearchChunkSearch.search.success",{},{chunkCount:c.chunks.length});let l=await Sl(this._logService,"toSemanticChunks",()=>this._instantiationService.invokeFunction(u=>b8(u,t,c.chunks,{shouldUseRangedChunks:!0},a)));if(a.isCancellationRequested)throw new dt;return{chunks:s.include?l.filter(u=>ybe(u.file,s.include)):l,couldBeOutdated:c.couldBeOutdated}}async isAvailable(){return!!this.getReposContext()}async getSimilarFilesFromCodeSearch(t,r,o){let s=this.getReposContext();if(!s)return;let a=s;if(!a.size)throw new Error("No repos to search through");let c=await t.resolveQuery(o);if(o.isCancellationRequested)throw new dt;let l=await this._codeSearchClient.search(c,{repo:Array.from(a.keys())},{rawChunks:!0,limit:r},o);if(o.isCancellationRequested)return;let u=await this.processResults(a,l,o);if(u)return{chunks:u.chunks.flat().sort((d,p)=>p.score-d.score),couldBeOutdated:u.couldBeOutdated}}getReposContext(){let t=this._workspaceService.getWorkspaceFolders(),r=this._gitService.repositories;if(!r.length||!t.length)return;let o=new Map;for(let s=0;s<r.length;s++){let a=t[s],c=r[s],l=VT(c)?.toLowerCase();l&&a&&o.set(l,a)}if(o.size)return o}_isOutdatedResponse(t,r){return t.commitOID?this._gitService.getRepository(r)?.headCommitHash!==t.commitOID:!1}async processResults(t,r,o){let s=!1,a=[],c=r.errors.filter(l=>!(l instanceof VD));if(c.length){let l=!0;for(let u of t.keys()){let d=c.filter(p=>p.repo===u);if(d){this._logService.internal.debug(`[${u}] Errors when searching codesearch: ${d.map(sF)}`);continue}l=!1}if(l)throw c.length===1?c[0]:new AggregateError(c)}for(let l of r.results){let u=l.repoOwner.toLowerCase()+"/"+l.repoName.toLowerCase(),d=t.get(u);if(!d){this._logService.public.error("Could not find workspace folder for repo: "+u);continue}!s&&this._isOutdatedResponse(l,d)&&(s=!0);let p=this._workspaceChunkIndex.get($e.joinPath(d,l.path));if(p&&!await this._ignoreService.isCopilotIgnored(p.uri)){if(o.isCancellationRequested)return;a.push({file:p.uri,score:l.score,text:l.contents,sources:[],range:new De(l.range.start,0,l.range.end+1,0)})}}return{chunks:a,couldBeOutdated:s}}};E([Jo(t=>t._logService,function(t,r){this._telemetryService.sendMSFTTelemetryEvent("codeSearchChunkSearch.perf.searchFileChunks",{status:r},{execTime:t})})],f0.prototype,"searchFileChunks",1),E([Jo(t=>t._logService)],f0.prototype,"getSimilarFilesFromCodeSearch",1),f0=E([v(0,oe),v(1,H),v(2,xt),v(3,f8),v(4,Te),v(5,ge),v(6,wc),v(7,Be),v(8,Ks)],f0);var Bbe=q(ht());var Fbe=q(ht());var wYe=30*1e3;function Abe(n,e,t,r,o,s,a,c,l,u,d,p){let f=typeof s=="string"?{modelMaxPromptTokens:0,url:s,family:"",tokenizer:"o200k_base",name:"",version:""}:s,m={Authorization:`Bearer ${a}`,"X-Request-Id":u,"X-GitHub-Api-Version":"2023-07-07","Openai-Organization":"github-copilot","Copilot-Integration-Id":e.isProduction()?"vscode-chat":"vscode-chat-dev","VScode-SessionId":e.sessionId,"VScode-MachineId":e.machineId,...e.getEditorVersionHeaders(),...f.getExtraHeaders?f.getExtraHeaders():{}};if(f.interceptBody&&f.interceptBody(d),l&&(m["OpenAI-Intent"]=l),!e.isProduction()&&f.url.includes(r.capiBaseURL)){if(!c)throw new Error("HMAC must be provided for non-production requests");m["Request-Hmac"]=c}let h={method:o,headers:m,json:d,timeout:wYe},g=n;if(p){let b=g.makeAbortController();p.onCancellationRequested(()=>{t.sendGHTelemetryEvent("networking.cancelRequest",{headerRequestId:u}),b.abort()}),h.signal=b.signal}return g.fetch(f.url,h).catch(b=>{if(b.code==="ECONNRESET"||b.code==="ETIMEDOUT"||b.code==="ERR_HTTP2_INVALID_SESSION"||b.code==="ERR_HTTP2_STREAM_CANCEL"||b.message==="ERR_HTTP2_GOAWAY_SESSION")return t.sendGHTelemetryEvent("networking.disconnectAll"),g.disconnectAll().then(()=>g.fetch(f.url,h));throw g.isAbortError(b)?new dt:b})}function cf(n,e,t,r,o,s,a,c,l,u,d){return Abe(n,e,t,r,"POST",o,s,a,c,l,u,d)}function CX(n,e,t,r,o,s,a,c,l,u,d){return Abe(n,e,t,r,"GET",o,s,a,c,l,u,d)}var Dbe=re("headerContributors"),_8=class{constructor(){this.contributors=[]}add(e){this.contributors.push(e)}remove(e){let t=this.contributors.indexOf(e);t!==-1&&this.contributors.splice(t,1)}contributeHeaders(e){for(let t of this.contributors)t.contributeHeaderValues(e)}size(){return this.contributors.length}};var QT=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,Lbe=new Set,EX=typeof process=="object"&&process?process:{},Obe=(n,e,t,r)=>{typeof EX.emitWarning=="function"?EX.emitWarning(n,e,t,r):console.error(`[${t}] ${e}: ${n}`)},x8=globalThis.AbortController,Nbe=globalThis.AbortSignal;if(typeof x8>"u"){Nbe=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(r,o){this._onabort.push(o)}},x8=class{constructor(){e()}signal=new Nbe;abort(r){if(!this.signal.aborted){this.signal.reason=r,this.signal.aborted=!0;for(let o of this.signal._onabort)o(r);this.signal.onabort?.(r)}}};let n=EX.env?.LRU_CACHE_IGNORE_AC_WARNING!=="1",e=()=>{n&&(n=!1,Obe("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}var kYe=n=>!Lbe.has(n),t$t=Symbol("type"),m0=n=>n&&n===Math.floor(n)&&n>0&&isFinite(n),Mbe=n=>m0(n)?n<=Math.pow(2,8)?Uint8Array:n<=Math.pow(2,16)?Uint16Array:n<=Math.pow(2,32)?Uint32Array:n<=Number.MAX_SAFE_INTEGER?XT:null:null,XT=class extends Array{constructor(e){super(e),this.fill(0)}},wX=class n{heap;length;static#t=!1;static create(e){let t=Mbe(e);if(!t)return[];n.#t=!0;let r=new n(e,t);return n.#t=!1,r}constructor(e,t){if(!n.#t)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new t(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}},S8=class n{#t;#i;#d;#n;#c;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#a;#m;#s;#r;#e;#p;#h;#u;#l;#v;#f;#_;#x;#y;#S;#E;#g;static unsafeExposeInternals(e){return{starts:e.#x,ttls:e.#y,sizes:e.#_,keyMap:e.#s,keyList:e.#r,valList:e.#e,next:e.#p,prev:e.#h,get head(){return e.#u},get tail(){return e.#l},free:e.#v,isBackgroundFetch:t=>e.#o(t),backgroundFetch:(t,r,o,s)=>e.#D(t,r,o,s),moveToTail:t=>e.#R(t),indexes:t=>e.#I(t),rindexes:t=>e.#T(t),isStale:t=>e.#b(t)}}get max(){return this.#t}get maxSize(){return this.#i}get calculatedSize(){return this.#m}get size(){return this.#a}get fetchMethod(){return this.#c}get dispose(){return this.#d}get disposeAfter(){return this.#n}constructor(e){let{max:t=0,ttl:r,ttlResolution:o=1,ttlAutopurge:s,updateAgeOnGet:a,updateAgeOnHas:c,allowStale:l,dispose:u,disposeAfter:d,noDisposeOnSet:p,noUpdateTTL:f,maxSize:m=0,maxEntrySize:h=0,sizeCalculation:g,fetchMethod:y,noDeleteOnFetchRejection:b,noDeleteOnStaleGet:_,allowStaleOnFetchRejection:x,allowStaleOnFetchAbort:I,ignoreFetchAbort:S}=e;if(t!==0&&!m0(t))throw new TypeError("max option must be a nonnegative integer");let w=t?Mbe(t):Array;if(!w)throw new Error("invalid max value: "+t);if(this.#t=t,this.#i=m,this.maxEntrySize=h||this.#i,this.sizeCalculation=g,this.sizeCalculation){if(!this.#i&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(y!==void 0&&typeof y!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.#c=y,this.#E=!!y,this.#s=new Map,this.#r=new Array(t).fill(void 0),this.#e=new Array(t).fill(void 0),this.#p=new w(t),this.#h=new w(t),this.#u=0,this.#l=0,this.#v=wX.create(t),this.#a=0,this.#m=0,typeof u=="function"&&(this.#d=u),typeof d=="function"?(this.#n=d,this.#f=[]):(this.#n=void 0,this.#f=void 0),this.#S=!!this.#d,this.#g=!!this.#n,this.noDisposeOnSet=!!p,this.noUpdateTTL=!!f,this.noDeleteOnFetchRejection=!!b,this.allowStaleOnFetchRejection=!!x,this.allowStaleOnFetchAbort=!!I,this.ignoreFetchAbort=!!S,this.maxEntrySize!==0){if(this.#i!==0&&!m0(this.#i))throw new TypeError("maxSize must be a positive integer if specified");if(!m0(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#U()}if(this.allowStale=!!l,this.noDeleteOnStaleGet=!!_,this.updateAgeOnGet=!!a,this.updateAgeOnHas=!!c,this.ttlResolution=m0(o)||o===0?o:1,this.ttlAutopurge=!!s,this.ttl=r||0,this.ttl){if(!m0(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#N()}if(this.#t===0&&this.ttl===0&&this.#i===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#t&&!this.#i){let R="LRU_CACHE_UNBOUNDED";kYe(R)&&(Lbe.add(R),Obe("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",R,n))}}getRemainingTTL(e){return this.#s.has(e)?1/0:0}#N(){let e=new XT(this.#t),t=new XT(this.#t);this.#y=e,this.#x=t,this.#L=(s,a,c=QT.now())=>{if(t[s]=a!==0?c:0,e[s]=a,a!==0&&this.ttlAutopurge){let l=setTimeout(()=>{this.#b(s)&&this.delete(this.#r[s])},a+1);l.unref&&l.unref()}},this.#w=s=>{t[s]=e[s]!==0?QT.now():0},this.#C=(s,a)=>{if(e[a]){let c=e[a],l=t[a];if(!c||!l)return;s.ttl=c,s.start=l,s.now=r||o();let u=s.now-l;s.remainingTTL=c-u}};let r=0,o=()=>{let s=QT.now();if(this.ttlResolution>0){r=s;let a=setTimeout(()=>r=0,this.ttlResolution);a.unref&&a.unref()}return s};this.getRemainingTTL=s=>{let a=this.#s.get(s);if(a===void 0)return 0;let c=e[a],l=t[a];if(!c||!l)return 1/0;let u=(r||o())-l;return c-u},this.#b=s=>{let a=t[s],c=e[s];return!!c&&!!a&&(r||o())-a>c}}#w=()=>{};#C=()=>{};#L=()=>{};#b=()=>!1;#U(){let e=new XT(this.#t);this.#m=0,this.#_=e,this.#k=t=>{this.#m-=e[t],e[t]=0},this.#O=(t,r,o,s)=>{if(this.#o(r))return 0;if(!m0(o))if(s){if(typeof s!="function")throw new TypeError("sizeCalculation must be a function");if(o=s(r,t),!m0(o))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return o},this.#P=(t,r,o)=>{if(e[t]=r,this.#i){let s=this.#i-e[t];for(;this.#m>s;)this.#A(!0)}this.#m+=e[t],o&&(o.entrySize=r,o.totalCalculatedSize=this.#m)}}#k=e=>{};#P=(e,t,r)=>{};#O=(e,t,r,o)=>{if(r||o)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#I({allowStale:e=this.allowStale}={}){if(this.#a)for(let t=this.#l;!(!this.#M(t)||((e||!this.#b(t))&&(yield t),t===this.#u));)t=this.#h[t]}*#T({allowStale:e=this.allowStale}={}){if(this.#a)for(let t=this.#u;!(!this.#M(t)||((e||!this.#b(t))&&(yield t),t===this.#l));)t=this.#p[t]}#M(e){return e!==void 0&&this.#s.get(this.#r[e])===e}*entries(){for(let e of this.#I())this.#e[e]!==void 0&&this.#r[e]!==void 0&&!this.#o(this.#e[e])&&(yield[this.#r[e],this.#e[e]])}*rentries(){for(let e of this.#T())this.#e[e]!==void 0&&this.#r[e]!==void 0&&!this.#o(this.#e[e])&&(yield[this.#r[e],this.#e[e]])}*keys(){for(let e of this.#I()){let t=this.#r[e];t!==void 0&&!this.#o(this.#e[e])&&(yield t)}}*rkeys(){for(let e of this.#T()){let t=this.#r[e];t!==void 0&&!this.#o(this.#e[e])&&(yield t)}}*values(){for(let e of this.#I())this.#e[e]!==void 0&&!this.#o(this.#e[e])&&(yield this.#e[e])}*rvalues(){for(let e of this.#T())this.#e[e]!==void 0&&!this.#o(this.#e[e])&&(yield this.#e[e])}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(e,t={}){for(let r of this.#I()){let o=this.#e[r],s=this.#o(o)?o.__staleWhileFetching:o;if(s!==void 0&&e(s,this.#r[r],this))return this.get(this.#r[r],t)}}forEach(e,t=this){for(let r of this.#I()){let o=this.#e[r],s=this.#o(o)?o.__staleWhileFetching:o;s!==void 0&&e.call(t,s,this.#r[r],this)}}rforEach(e,t=this){for(let r of this.#T()){let o=this.#e[r],s=this.#o(o)?o.__staleWhileFetching:o;s!==void 0&&e.call(t,s,this.#r[r],this)}}purgeStale(){let e=!1;for(let t of this.#T({allowStale:!0}))this.#b(t)&&(this.delete(this.#r[t]),e=!0);return e}info(e){let t=this.#s.get(e);if(t===void 0)return;let r=this.#e[t],o=this.#o(r)?r.__staleWhileFetching:r;if(o===void 0)return;let s={value:o};if(this.#y&&this.#x){let a=this.#y[t],c=this.#x[t];if(a&&c){let l=a-(QT.now()-c);s.ttl=l,s.start=Date.now()}}return this.#_&&(s.size=this.#_[t]),s}dump(){let e=[];for(let t of this.#I({allowStale:!0})){let r=this.#r[t],o=this.#e[t],s=this.#o(o)?o.__staleWhileFetching:o;if(s===void 0||r===void 0)continue;let a={value:s};if(this.#y&&this.#x){a.ttl=this.#y[t];let c=QT.now()-this.#x[t];a.start=Math.floor(Date.now()-c)}this.#_&&(a.size=this.#_[t]),e.unshift([r,a])}return e}load(e){this.clear();for(let[t,r]of e){if(r.start){let o=Date.now()-r.start;r.start=QT.now()-o}this.set(t,r.value,r)}}set(e,t,r={}){if(t===void 0)return this.delete(e),this;let{ttl:o=this.ttl,start:s,noDisposeOnSet:a=this.noDisposeOnSet,sizeCalculation:c=this.sizeCalculation,status:l}=r,{noUpdateTTL:u=this.noUpdateTTL}=r,d=this.#O(e,t,r.size||0,c);if(this.maxEntrySize&&d>this.maxEntrySize)return l&&(l.set="miss",l.maxEntrySizeExceeded=!0),this.delete(e),this;let p=this.#a===0?void 0:this.#s.get(e);if(p===void 0)p=this.#a===0?this.#l:this.#v.length!==0?this.#v.pop():this.#a===this.#t?this.#A(!1):this.#a,this.#r[p]=e,this.#e[p]=t,this.#s.set(e,p),this.#p[this.#l]=p,this.#h[p]=this.#l,this.#l=p,this.#a++,this.#P(p,d,l),l&&(l.set="add"),u=!1;else{this.#R(p);let f=this.#e[p];if(t!==f){if(this.#E&&this.#o(f)){f.__abortController.abort(new Error("replaced"));let{__staleWhileFetching:m}=f;m!==void 0&&!a&&(this.#S&&this.#d?.(m,e,"set"),this.#g&&this.#f?.push([m,e,"set"]))}else a||(this.#S&&this.#d?.(f,e,"set"),this.#g&&this.#f?.push([f,e,"set"]));if(this.#k(p),this.#P(p,d,l),this.#e[p]=t,l){l.set="replace";let m=f&&this.#o(f)?f.__staleWhileFetching:f;m!==void 0&&(l.oldValue=m)}}else l&&(l.set="update")}if(o!==0&&!this.#y&&this.#N(),this.#y&&(u||this.#L(p,o,s),l&&this.#C(l,p)),!a&&this.#g&&this.#f){let f=this.#f,m;for(;m=f?.shift();)this.#n?.(...m)}return this}pop(){try{for(;this.#a;){let e=this.#e[this.#u];if(this.#A(!0),this.#o(e)){if(e.__staleWhileFetching)return e.__staleWhileFetching}else if(e!==void 0)return e}}finally{if(this.#g&&this.#f){let e=this.#f,t;for(;t=e?.shift();)this.#n?.(...t)}}}#A(e){let t=this.#u,r=this.#r[t],o=this.#e[t];return this.#E&&this.#o(o)?o.__abortController.abort(new Error("evicted")):(this.#S||this.#g)&&(this.#S&&this.#d?.(o,r,"evict"),this.#g&&this.#f?.push([o,r,"evict"])),this.#k(t),e&&(this.#r[t]=void 0,this.#e[t]=void 0,this.#v.push(t)),this.#a===1?(this.#u=this.#l=0,this.#v.length=0):this.#u=this.#p[t],this.#s.delete(r),this.#a--,t}has(e,t={}){let{updateAgeOnHas:r=this.updateAgeOnHas,status:o}=t,s=this.#s.get(e);if(s!==void 0){let a=this.#e[s];if(this.#o(a)&&a.__staleWhileFetching===void 0)return!1;if(this.#b(s))o&&(o.has="stale",this.#C(o,s));else return r&&this.#w(s),o&&(o.has="hit",this.#C(o,s)),!0}else o&&(o.has="miss");return!1}peek(e,t={}){let{allowStale:r=this.allowStale}=t,o=this.#s.get(e);if(o===void 0||!r&&this.#b(o))return;let s=this.#e[o];return this.#o(s)?s.__staleWhileFetching:s}#D(e,t,r,o){let s=t===void 0?void 0:this.#e[t];if(this.#o(s))return s;let a=new x8,{signal:c}=r;c?.addEventListener("abort",()=>a.abort(c.reason),{signal:a.signal});let l={signal:a.signal,options:r,context:o},u=(g,y=!1)=>{let{aborted:b}=a.signal,_=r.ignoreFetchAbort&&g!==void 0;if(r.status&&(b&&!y?(r.status.fetchAborted=!0,r.status.fetchError=a.signal.reason,_&&(r.status.fetchAbortIgnored=!0)):r.status.fetchResolved=!0),b&&!_&&!y)return p(a.signal.reason);let x=m;return this.#e[t]===m&&(g===void 0?x.__staleWhileFetching?this.#e[t]=x.__staleWhileFetching:this.delete(e):(r.status&&(r.status.fetchUpdated=!0),this.set(e,g,l.options))),g},d=g=>(r.status&&(r.status.fetchRejected=!0,r.status.fetchError=g),p(g)),p=g=>{let{aborted:y}=a.signal,b=y&&r.allowStaleOnFetchAbort,_=b||r.allowStaleOnFetchRejection,x=_||r.noDeleteOnFetchRejection,I=m;if(this.#e[t]===m&&(!x||I.__staleWhileFetching===void 0?this.delete(e):b||(this.#e[t]=I.__staleWhileFetching)),_)return r.status&&I.__staleWhileFetching!==void 0&&(r.status.returnedStale=!0),I.__staleWhileFetching;if(I.__returned===I)throw g},f=(g,y)=>{let b=this.#c?.(e,s,l);b&&b instanceof Promise&&b.then(_=>g(_===void 0?void 0:_),y),a.signal.addEventListener("abort",()=>{(!r.ignoreFetchAbort||r.allowStaleOnFetchAbort)&&(g(void 0),r.allowStaleOnFetchAbort&&(g=_=>u(_,!0)))})};r.status&&(r.status.fetchDispatched=!0);let m=new Promise(f).then(u,d),h=Object.assign(m,{__abortController:a,__staleWhileFetching:s,__returned:void 0});return t===void 0?(this.set(e,h,{...l.options,status:void 0}),t=this.#s.get(e)):this.#e[t]=h,h}#o(e){if(!this.#E)return!1;let t=e;return!!t&&t instanceof Promise&&t.hasOwnProperty("__staleWhileFetching")&&t.__abortController instanceof x8}async fetch(e,t={}){let{allowStale:r=this.allowStale,updateAgeOnGet:o=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,ttl:a=this.ttl,noDisposeOnSet:c=this.noDisposeOnSet,size:l=0,sizeCalculation:u=this.sizeCalculation,noUpdateTTL:d=this.noUpdateTTL,noDeleteOnFetchRejection:p=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:f=this.allowStaleOnFetchRejection,ignoreFetchAbort:m=this.ignoreFetchAbort,allowStaleOnFetchAbort:h=this.allowStaleOnFetchAbort,context:g,forceRefresh:y=!1,status:b,signal:_}=t;if(!this.#E)return b&&(b.fetch="get"),this.get(e,{allowStale:r,updateAgeOnGet:o,noDeleteOnStaleGet:s,status:b});let x={allowStale:r,updateAgeOnGet:o,noDeleteOnStaleGet:s,ttl:a,noDisposeOnSet:c,size:l,sizeCalculation:u,noUpdateTTL:d,noDeleteOnFetchRejection:p,allowStaleOnFetchRejection:f,allowStaleOnFetchAbort:h,ignoreFetchAbort:m,status:b,signal:_},I=this.#s.get(e);if(I===void 0){b&&(b.fetch="miss");let S=this.#D(e,I,x,g);return S.__returned=S}else{let S=this.#e[I];if(this.#o(S)){let F=r&&S.__staleWhileFetching!==void 0;return b&&(b.fetch="inflight",F&&(b.returnedStale=!0)),F?S.__staleWhileFetching:S.__returned=S}let w=this.#b(I);if(!y&&!w)return b&&(b.fetch="hit"),this.#R(I),o&&this.#w(I),b&&this.#C(b,I),S;let R=this.#D(e,I,x,g),V=R.__staleWhileFetching!==void 0&&r;return b&&(b.fetch=w?"stale":"refresh",V&&w&&(b.returnedStale=!0)),V?R.__staleWhileFetching:R.__returned=R}}get(e,t={}){let{allowStale:r=this.allowStale,updateAgeOnGet:o=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,status:a}=t,c=this.#s.get(e);if(c!==void 0){let l=this.#e[c],u=this.#o(l);return a&&this.#C(a,c),this.#b(c)?(a&&(a.get="stale"),u?(a&&r&&l.__staleWhileFetching!==void 0&&(a.returnedStale=!0),r?l.__staleWhileFetching:void 0):(s||this.delete(e),a&&r&&(a.returnedStale=!0),r?l:void 0)):(a&&(a.get="hit"),u?l.__staleWhileFetching:(this.#R(c),o&&this.#w(c),l))}else a&&(a.get="miss")}#F(e,t){this.#h[t]=e,this.#p[e]=t}#R(e){e!==this.#l&&(e===this.#u?this.#u=this.#p[e]:this.#F(this.#h[e],this.#p[e]),this.#F(this.#l,e),this.#l=e)}delete(e){let t=!1;if(this.#a!==0){let r=this.#s.get(e);if(r!==void 0)if(t=!0,this.#a===1)this.clear();else{this.#k(r);let o=this.#e[r];if(this.#o(o)?o.__abortController.abort(new Error("deleted")):(this.#S||this.#g)&&(this.#S&&this.#d?.(o,e,"delete"),this.#g&&this.#f?.push([o,e,"delete"])),this.#s.delete(e),this.#r[r]=void 0,this.#e[r]=void 0,r===this.#l)this.#l=this.#h[r];else if(r===this.#u)this.#u=this.#p[r];else{let s=this.#h[r];this.#p[s]=this.#p[r];let a=this.#p[r];this.#h[a]=this.#h[r]}this.#a--,this.#v.push(r)}}if(this.#g&&this.#f?.length){let r=this.#f,o;for(;o=r?.shift();)this.#n?.(...o)}return t}clear(){for(let e of this.#T({allowStale:!0})){let t=this.#e[e];if(this.#o(t))t.__abortController.abort(new Error("deleted"));else{let r=this.#r[e];this.#S&&this.#d?.(t,r,"delete"),this.#g&&this.#f?.push([t,r,"delete"])}}if(this.#s.clear(),this.#e.fill(void 0),this.#r.fill(void 0),this.#y&&this.#x&&(this.#y.fill(0),this.#x.fill(0)),this.#_&&this.#_.fill(0),this.#u=0,this.#l=0,this.#v.length=0,this.#m=0,this.#a=0,this.#g&&this.#f){let e=this.#f,t;for(;t=e?.shift();)this.#n?.(...t)}}};var JT=class extends ye{constructor(t,r,o,s){super();this.path=t;this.version=r;this.options=o;this.fileSystem=s;this._cache=new S8(this.options),this._delayer=typeof o.autoWriteDelay=="number"?this._register(new _v(o.autoWriteDelay)):void 0}dispose(){super.dispose(),this._delayer=void 0}async initialize(){if(!this.path)return;let t;try{t=await this.fileSystem.readFile(this.path)}catch{return}try{let r=new TextDecoder().decode(t),o=JSON.parse(r);o.version===this.version&&this._cache.load(o.data)}catch(r){console.error(`Failed to load LRU cache at ${this.path}`,r)}}async get(t){return this._cache.get(await this.toKey(t))}async set(t,r){this._cache.set(await this.toKey(t),r),this._delayer?.trigger(()=>this.save()).catch(o=>{if(!(o instanceof dt))throw o})}async save(){if(!this.path)return;let t=JSON.stringify({version:this.version,data:this._cache.dump()});await this.fileSystem.writeFile(this.path,new TextEncoder().encode(t))}async toKey(t){let o=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",o);return Array.from(new Uint8Array(s)).map(l=>l.toString(16).padStart(2,"0")).join("")}};JT=E([v(3,gn)],JT);var ZT=class extends ye{constructor(t,r,o,s,a,c,l){super();this._embeddingEndpoint=t;this._embeddingsComputer=c;this._logService=l;this._isDisposed=!1;this._embeddingsCache=new kr(async()=>{let u=a.storageUri,d=u?$e.joinPath(u,`${r}-${t.endpoint.model}${t.dimensions??""}.json`):void 0,p=this._register(s.createInstance(JT,d,o,{max:5e3,autoWriteDelay:5e3}));return await p.initialize(),p})}dispose(){this._isDisposed=!0,super.dispose()}async computeEmbeddings(t,r){let o=this._embeddingEndpoint.endpoint.model,s=await this._embeddingsCache.value;if(this._isDisposed)return{model:o,embeddings:[]};let a=new Array(t.length),c=[];for(let[l,u]of t.entries()){let d=await s.get(u);d?a[l]=d:c.push({index:l,value:u})}if(c.length>0){let l=await this.computeEmbeddingsWithRetry(c.map(u=>u.value),r);for(let u=0;u<c.length;u++){if(this._isDisposed)return{model:o,embeddings:[]};let d=c[u],p=l.embeddings[u];if(typeof p>"u")throw new Error("Error computing embedding");a[d.index]=p,await s.set(d.value,p)}}return{model:o,embeddings:a}}async computeEmbeddingsWithRetry(t,r){let s=0,a;for(;s<3;)try{if(a=await this._embeddingsComputer.computeEmbeddings(this._embeddingEndpoint.endpoint,t,{parallelism:2,dimensions:this._embeddingEndpoint.dimensions},r),!a)throw new Error("Failed to compute embeddings");return a}catch(c){if(s++,s===3)throw c;if(r.isCancellationRequested)throw new Error("Cancelled computing embeddings");this._logService.public.warn(`Error computing embeddings. Retrying in ${s} seconds. Error: ${c}`),await new Promise(l=>setTimeout(l,1e3*s))}throw new Error("Failed to compute embeddings")}};ZT=E([v(3,H),v(4,qt),v(5,_s),v(6,oe)],ZT);var RYe="1.0.9",PYe="workspaceEmbeddingsCache",AYe=500,gh=class extends ye{constructor(t,r,o,s,a,c,l,u){super();this.tokenizationEndpoint=t;this._logService=o;this._configurationService=s;this._endpointProvider=a;this._experimentationService=c;this._workspaceIndex=l;this._workspaceService=u;this.shouldSearchTimeout=!0;this._embeddingsComputer=new kr(async()=>{let d={family:"text3small",dimensions:512},p=await this._endpointProvider.getEmbeddingsEndpoint(d.family);return this._register(r.createInstance(ZT,{endpoint:p,dimensions:d.dimensions},PYe,RYe))}),this._chunksEndpointEmbeddingComputer=this._register(r.createInstance(bx)),this.tryPreInit()}static{this._MAX_EMBEDDINGS_COMPUTATION_TIME=1e4}static{this._MAX_CHUNK_LENGTH=2e3}get fileSystemFileCount(){return this._workspaceIndex.fileSystemFileCount}initialize(){return this._initializePromise??=this._workspaceIndex.initialize(),this._initializePromise}async triggerIndexing(t,r){if(this._chunksEndpointEmbeddingComputer.isAvailable())return this._chunksEndpointEmbeddingComputer.triggerIndexing(t,r);{let o=await this.getChunksToSearch(r);if(r.isCancellationRequested)return;let s=await this._embeddingsComputer.value;if(r.isCancellationRequested)return;let{embeddings:a}=await s.computeEmbeddings(o.map(c=>this.chunkToIndexString(c)),r);this._logService.internal.debug(`Indexed ${a.length} chunks`)}}async searchAllChunks(t,r,o,s){if(this._chunksEndpointEmbeddingComputer.isAvailable())return this.searchAllChunksUsingEndpoint(t,r,o);let a=await this.getChunksToSearch(o);if(o.isCancellationRequested)throw new dt;return this.rankChunks(await t,a,r,o,s)}searchAllChunksUsingEndpoint(t,r,o){return this._chunksEndpointEmbeddingComputer.searchChunks(t,r,o)}async rankChunks(t,r,o,s,a){if(!r.length)return[];let c=[t,...r.map(f=>this.chunkToIndexString(f))],l=await this.computeEmbeddings(c,s);if(s.isCancellationRequested||!l)return[];if(l.embeddings.length<1)throw new Error("Invalid response");let[u,...d]=l.embeddings,p=d.map((f,m)=>[r[m],f]);return TY(l.model,u,p,o,a)}async getChunksToSearch(t){let r=(await Promise.all(Array.from(this._workspaceIndex.values(),o=>o.getSemanticChunks(this.tokenizationEndpoint,t)))).flat();return t.isCancellationRequested?[]:r.filter(o=>o.text.length<gh._MAX_CHUNK_LENGTH)}async computeEmbeddings(t,r){let o=await this._embeddingsComputer.value;if(r.isCancellationRequested)return;let s=this.shouldSearchTimeout?await Dp(o.computeEmbeddings(t,r),gh._MAX_EMBEDDINGS_COMPUTATION_TIME):await o.computeEmbeddings(t,r);if(!r.isCancellationRequested){if(!s)throw new Error("Timeout computing embeddings");return s}}chunkToIndexString(t){let r=wd(this._workspaceService,t.file);return this.toStringForEmbeddingsComputer(t,r)}async tryPreInit(){if(!this._configurationService.getExperimentBasedConfig(le.WorkspacePreInitEmbeddings,this._experimentationService))return!1;let r=new ko;try{await Dp((async()=>{let s=new Qo;if(this._logService.public.debug("Trying to preload workspace embeddings"),await this._workspaceIndex.preLoadWorkspaceFiles(AYe,r.token),r.token.isCancellationRequested){this._logService.public.debug("Preload indexing cancelled");return}this._logService.public.debug(`Preloaded ${this._workspaceIndex.fileSystemFileCount} files. Preload elapsed time: ${s.elapsed()}ms`),this._logService.public.debug(`Preloading trying to pre-compute embeddings for ${Array.from(this._workspaceIndex.values()).length} files`);let a=await this.getChunksToSearch(r.token);if(r.token.isCancellationRequested){this._logService.public.debug("Preload embedding compute cancelled");return}this._logService.public.debug(`Preloaded completed for ${a.length} chunks. Total preload time: ${s.elapsed()}ms`)})(),1e4,()=>(this._logService.public.debug("Preload timed out"),r.cancel()))}catch{}finally{r.dispose()}}toStringForEmbeddingsComputer(t,r){return`File: \`${r}\`
${mo(m6(t.file),t.text)}`}};gh=E([v(1,H),v(2,oe),v(3,be),v(4,_e),v(5,fn),v(6,wc),v(7,Be)],gh);var bx=class extends ye{constructor(t,r,o,s,a,c,l,u,d,p,f,m,h,g){super();this._endpointProvider=o;this._embeddingsComputer=s;this._authService=a;this._configurationService=c;this._domainService=l;this._envService=u;this._experimentationService=d;this._fetcherService=p;this._telemetryService=f;this._workspaceIndex=m;this._workspaceService=h;this._logService=g;this._requestLimiter=this._register(new Ap(4));this._requestHmac=new kr(()=>ja(process.env.HMAC_SECRET));this._cache=new kr(async()=>{let y=r.storageUri,b=y?$e.joinPath(y,bx.cacheFileName):void 0,_=await t.invokeFunction(x=>vh.load(x,b,this._workspaceIndex));return this._register(_)})}static{this.cacheFileName="workspace-chunks.json"}isAvailable(){return this._configurationService.getExperimentBasedConfig(le.WorkspaceUseChunksEndpoint,this._experimentationService)}async triggerIndexing(t,r){this.isAvailable()&&(await this._workspaceIndex.initialize(),await this.getAllWorkspaceEmbeddings(t,r))}async searchChunks(t,r,o){if(!this.isAvailable())return[];let[s,a]=await Promise.all([Sl(this._logService,"ChunksEndpoint.searchChunks.getQueryEmbeddings",async()=>{let c=await this._endpointProvider.getEmbeddingsEndpoint("text3small");return(await this._embeddingsComputer.computeEmbeddings(c,[await t],{dimensions:512},o))?.embeddings[0]}),Sl(this._logService,"ChunksEndpoint.searchChunks.getAllWorkspaceEmbeddings",()=>this.getAllWorkspaceEmbeddings(void 0,o))]);if(o.isCancellationRequested)throw new dt;return!s||!a.length?[]:TY("text-embedding-3-small",s,a.map(c=>[c.chunk,c.embedding]),r)}async getAllWorkspaceEmbeddings(t,r){let o=await this.tryGetAuthToken();if(!o)return[];let s=Array.from(this._workspaceIndex.values()),a=0,c=await Promise.all(s.map(async l=>{try{return await po(this.getChunksAndEmbeddings(l,o,r),r)}finally{++a,t?.report({progressMessage:(0,Fbe.t)("{0} of {1} files",a,s.length),progress:a/s.length})}}));return zn(c).flat()}async getChunksAndEmbeddings(t,r,o){let s=await this._cache.value,[a,c]=await Promise.all([s.get(t),t.getHash()]);if(o.isCancellationRequested)throw new dt;return a||s.update(t,c,l=>this.computeChunksAndEmbeddings(t,r,l))}async computeChunksAndEmbeddings(t,r,o){let a=t.getDocument(),c=await t.getText(o);if(o.isCancellationRequested)throw new dt;if(P1(c))return[];try{let l=await this._requestHmac.value,u=async(m=0)=>{if(o.isCancellationRequested)throw new dt;let h=await Sl(this._logService,`ChunksEndpointEmbeddingComputer.fetchChunksRequest(${t.uri}, attempt=${m})`,()=>cf(this._fetcherService,this._envService,this._telemetryService,this._domainService,this._domainService.chunksURL,r,l,"copilot-panel","",{content:c,path:wd(this._workspaceService,t.uri),embed:!0},o));if(o.isCancellationRequested)throw new dt;if(!h.ok){if((h.status===429||h.status===403)&&m<3){let g=this.getRequestRetryDelay(h,m);return this._logService.internal.trace(`ChunksEndpointEmbeddingComputer.fetchChunksRequest(${t.uri}, attempt=${m}) failed with status: ${h.status}. Retrying in ${g}s`),g>0&&await mc(g*1e3),u(m+1)}this._logService.internal.trace(`ChunksEndpointEmbeddingComputer.fetchChunksRequest(${t.uri}, attempt=${m}) failed with status: ${h.status}. Not attempting retry`)}return h},d=await this._requestLimiter.queue(()=>u());if(!d||!d.ok){d&&console.log("Error chunking",t.toString(),d.status,d.statusText,await d.text());return}let p=await d.json();if(!p.chunks.length)return[];let f=await a;return p.chunks.map(m=>{let h=f.positionAt(m.range.start),g=f.positionAt(m.range.end),y=new De(h.line,h.character,g.line,g.character),b=h.line===0&&g.line>=pl(c).length-1;return{chunk:{file:t.uri,text:m.text,rawText:Ube(m.text),range:y,isFullFile:b,sources:[]},embedding:m.embedding?.embedding||[]}})}catch(l){console.log(l);return}}getRequestRetryDelay(t,r){try{let s=t.headers.get("retry-after");if(s){let a=parseInt(s);if(!isNaN(a))return a}}catch{}try{let s=t.headers.get("x-ratelimit-reset");if(s){let a=parseInt(s);if(!isNaN(a)){let c=Math.floor(Date.now()/1e3);return a-c}}}catch{}return 5*(r+1)}async tryGetAuthToken(){return(await this._authService.getPermissiveGitHubSession({createIfNone:!0}))?.accessToken}};bx=E([v(0,H),v(1,qt),v(2,_e),v(3,_s),v(4,xt),v(5,be),v(6,xn),v(7,it),v(8,fn),v(9,hn),v(10,ge),v(11,wc),v(12,Be),v(13,oe)],bx);var vh=class extends ye{constructor(t,r,o,s){super();this.cachePath=t;this._workspaceIndex=r;this.fileSystem=o;this.logService=s;this._cache=new kn;this._isDisposed=!1;this._writeDelayer=this._register(new _v(5e3));this._register(this._workspaceIndex.onDidDeleteFile(a=>this._cache.delete(a)))}static{this.version="1.0.0"}static async load(t,r,o){let s=t.get(gn),a=t.get(oe),c=new vh(r,o,s,a);if(r){await o.initialize();let l;try{l=await s.readFile(r)}catch{}if(l)try{let u=JSON.parse(new TextDecoder().decode(l));if(u.version===vh.version){a.internal.debug(`Restoring workspace chunk + embeddings cache from ${r.fsPath}`);for(let[d,p]of Object.entries(u.entries)){let f=$e.parse(d);o.get(f)&&c._cache.set(f,{fileHash:p.hash,value:O1(async()=>p.entries.map(m=>({embedding:m.embedding,chunk:{file:f,text:m.text,rawText:Ube(m.text),range:De.lift(m.range),sources:[]}})))})}}}catch(u){console.error(u)}}return c}dispose(){this._isDisposed=!0,super.dispose()}async get(t){let r=this._cache.get(t.uri);if(!r)return;let[o,s]=await Promise.all([t.getHash(),r]);if(s.fileHash===o)return s.value}async update(t,r,o){let s=this._cache.get(t.uri);if(s?.fileHash===r)return s.value;s?.value.cancel();let a=O1(o);return this._cache.set(t.uri,{fileHash:r,value:a}),a.then(()=>this._writeDelayer.trigger(()=>this.save())),a}async save(){if(!this.cachePath||this._isDisposed)return;let t={};if(await Promise.all(Array.from(this._cache.entries(),async([o,s])=>{let a;try{a=await Dp(s.value,1e3)}catch{}a&&(t[o.toString()]={hash:s.fileHash,entries:a.map(c=>({text:c.chunk.text,range:c.chunk.range.toJSON(),embedding:c.embedding}))})})),this._isDisposed)return;let r={version:vh.version,entries:t};await this.fileSystem.writeFile(this.cachePath,new TextEncoder().encode(JSON.stringify(r))),this.logService.internal.debug(`Wrote workspace chunk + embeddings cache to ${this.cachePath.fsPath}`)}};vh=E([v(1,wc),v(2,gn),v(3,oe)],vh);function Ube(n){let e=pl(n);return e.length>=3&&e[0].startsWith("File: ")&&e[1].startsWith("```")&&e.at(-1)==="```"?e.slice(2,-1).join(`
`):n}var lf=class extends ye{constructor(t,r,o,s,a){super();this.instantiationService=r;this._logService=o;this._experimentationService=s;this._telemetryService=a;this.id="ada";this.timeout=2e3;this._state=0;this._disposeCts=this._register(new ko);this._onDidStartOrStopBuildingIndex=this._register(new jt);this.onDidChangeInitialIndexingStatus=this._onDidStartOrStopBuildingIndex.event;this._embeddingsIndex=this.instantiationService.createInstance(gh,{tokenizer:"o200k_base"}),t.isInSimulationTests&&(this._embeddingsIndex.shouldSearchTimeout=!1)}static{this.defaultAutomaticIndexingFileCap=500}static{this.defaultManualIndexingFileCap=2e3}async triggerLocalIndexing(){if(await this.initialize(),this._state===4){let t=this.getAutoIndexFileCap();return{errorDetails:(0,Bbe.t)(`@workspace's indexing currently is limited to {0} files. Found {1} potential files to index in the workspace.

A sparse local index will be used to answer question instead.`,t,this._embeddingsIndex.fileSystemFileCount)}}else this._state===3&&this.doInitialIndexing()}async searchFileChunks(t,r,o,s,a){let c=r.resolveQuery(a);if(await this.initialize(),a.isCancellationRequested)throw new dt;return this._state!==1&&this._state!==2?{chunks:[]}:{chunks:await this._embeddingsIndex.searchAllChunks(c,o,a,s.minimumRerankEmbeddingThreshold)}}async getState(){return await this.initialize(),this._state}async initialize(){this._init??=(async()=>{if(await this._embeddingsIndex.initialize(),this._disposeCts.token.isCancellationRequested)return;let t=this.getManualIndexFileCap();if(this._embeddingsIndex.fileSystemFileCount>t){this._logService.internal.debug(`EmbeddingsChunkSearch: Disabling all local embedding indexing due to too many files. Found ${this._embeddingsIndex.fileSystemFileCount} files. Max: ${t}`),this._state=4;return}let r=this.getAutoIndexFileCap();if(this._embeddingsIndex.fileSystemFileCount>r){this._logService.internal.debug(`EmbeddingsChunkSearch: skipping automatic indexing due to too many files. Found ${this._embeddingsIndex.fileSystemFileCount} files. Max: ${r}`),this._state=3;return}this._logService.internal.debug(`EmbeddingsChunkSearch: initialize found ${this._embeddingsIndex.fileSystemFileCount} files. Max: ${r}`),this.doInitialIndexing()})(),await this._init}doInitialIndexing(){this._initialIndexingPromise??=(async()=>{this._state=1,this._onDidStartOrStopBuildingIndex.fire("started"),this._logService.internal.debug("Starting indexing");try{await this._embeddingsIndex.triggerIndexing({report:t=>this._onDidStartOrStopBuildingIndex.fire(t)},this._disposeCts.token),this._state=2,this._logService.internal.debug("Workspace Chunk Embeddings Index initialized.")}catch(t){this._logService.internal.warn(`Failed to index workspace: ${t}`),this._initialIndexingPromise=void 0}finally{this._onDidStartOrStopBuildingIndex.fire("completed")}})()}rankChunks(t,r,o,s){return this._embeddingsIndex.rankChunks(t,r,o,s)}getAutoIndexFileCap(){return this._experimentationService.getTreatmentVariable("vscode","workspace.embeddingsCacheFileCap")??lf.defaultAutomaticIndexingFileCap}getManualIndexFileCap(){return this._experimentationService.getTreatmentVariable("vscode","workspace.manualEmbeddingsCacheFileCap")??lf.defaultManualIndexingFileCap}};E([Jo(t=>t._logService,function(t,r){this._telemetryService.sendMSFTTelemetryEvent("embeddingsChunkSearch.perf.searchFileChunks",{status:r},{execTime:t})})],lf.prototype,"searchFileChunks",1),lf=E([v(0,u0),v(1,H),v(2,oe),v(3,fn),v(4,ge)],lf);var jbe=q(require("path"));var qbe=require("worker_threads"),kX=class{constructor(e,t){this.handlers=new Map;this.nextId=1;this.worker=new qbe.Worker(e,t),this.worker.on("message",({id:r,err:o,res:s})=>{let a=this.handlers.get(r);a&&(this.handlers.delete(r),o?a.reject(o):a.resolve(s))}),this.worker.on("error",r=>this.handleError(r)),this.worker.on("exit",r=>{r!==0&&this.handleError(new Error(`Worker thread exited with code ${r}.`))})}terminate(){this.worker.removeAllListeners(),this.worker.terminate(),this.handlers.clear()}handleError(e){for(let t of this.handlers.values())t.reject(e);this.handlers.clear()}remoteCall(e,t){let r=this.nextId++,o,s,a=new Promise((c,l)=>{o=c,s=l});return this.handlers.set(r,{resolve:o,reject:s}),this.worker.postMessage({id:r,fn:e,args:t}),a}},h0=class{constructor(e,t){this.worker=new kX(e,t);let r={get:(o,s)=>(typeof s=="string"&&!o[s]&&(o[s]=(...a)=>{if(!this.worker)throw new Error("Worker was terminated!");return this.worker.remoteCall(s,a)}),o[s])};this.proxy=new Proxy(Object.create(null),r)}terminate(){this.worker.terminate()}};function zD(n,e){if(!n)return n;if(Array.isArray(n))return n.map(t=>zD(t,e));if(typeof n=="object"){let t=e(n);if(t)return t;let r={};for(let o in n)r[o]=zD(n[o],e);return r}return n}var DYe=jbe.default.join(__dirname,"tfidfWorker.js"),g0=class extends ye{constructor(t,r,o,s){super();this._logService=r;this._telemetryService=o;this._workspaceIndex=s;this.id="tfidf";this.timeout=500;this._isDisposed=!1;this._tfIdfWorker=new kr(()=>new h0(DYe,{name:"TfIdf Worker",workerData:{endpoint:t}}));let a=c=>{let l=this._workspaceIndex.get(c);l&&this.addOrUpdateTfidfEntries([l])};this._register(this._workspaceIndex.onDidCreateFile(a)),this._register(this._workspaceIndex.onDidChangeFile(a)),this._register(this._workspaceIndex.onDidDeleteFile(c=>{this._isDisposed||this._tfIdfWorker.value.proxy.delete(c)}))}dispose(){this._isDisposed=!0,super.dispose(),this._tfIdfWorker.rawValue?.terminate()}initialize(){return this._initializePromise??=this._initializeWorkspaceFiles(),this._initializePromise}async searchFileChunks(t,r,o,s){let[a,c]=await Promise.all([this.initialize(),t.resolveQueryAndKeywords(s)]);if(s.isCancellationRequested)throw new dt;if(this._isDisposed||!c)return{chunks:[]};let l=c.keywords.flatMap(d=>[d.keyword,...d.variations]),u=await Sl(this._logService,"search",()=>po(this._tfIdfWorker.value.proxy.search([l.length?l.join(", "):c.rephrasedQuery],{maxResults:r,include:o.include,maxSpread:.75}),s),(d,p)=>{this._telemetryService.sendMSFTTelemetryEvent("tfIdfChunkSearch.perf.tfidfSearch",{status:s.isCancellationRequested?"cancelled":p},{execTime:d})});return{chunks:LYe(u)}}async _initializeWorkspaceFiles(){await Sl(this._logService,"initialize workspaceIndex",()=>this._workspaceIndex.initialize()),!this._isDisposed&&await Sl(this._logService,"initialize tfidf",()=>this.addOrUpdateTfidfEntries(this._workspaceIndex.values()),(t,r)=>{this._telemetryService.sendMSFTTelemetryEvent("tfidfChunkSearch.perf.initializeTfidf",{status:r},{execTime:t,fileSystemFileCount:this._workspaceIndex.fileSystemFileCount})})}async addOrUpdateTfidfEntries(t){if(this._isDisposed)return;let r=new Ap(20),o;try{o=await Promise.all(Array.from(t,s=>r.queue(async()=>({uri:s.uri,content:await s.getText(Zt.None)}))))}finally{r.dispose()}this._isDisposed||this._tfIdfWorker.value.proxy.addOrUpdate(NYe(o))}};E([Jo(t=>t._logService)],g0.prototype,"initialize",1),E([Jo(t=>t._logService,function(t,r){this._telemetryService.sendMSFTTelemetryEvent("tfIdfChunkSearch.perf.searchFileChunks",{status:r},{execTime:t})})],g0.prototype,"searchFileChunks",1),g0=E([v(1,oe),v(2,ge),v(3,wc)],g0);function NYe(n){return zD(n,e=>{if($e.isUri(e))return{$mid:"uri",...e};if(e instanceof De)return{startLineNumber:e.startLineNumber,startColumn:e.startColumn,endLineNumber:e.endLineNumber,endColumn:e.endColumn}})}function LYe(n){return zD(n,e=>{if(e.$mid==="range")return new De(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn);if(e.$mid==="uri")return $e.revive(e)})}var _x=class extends ye{constructor(t,r,o){super();this._logService=t;this.instantiationService=r;this._telemetryService=o;this.id="tfidf";this.timeout=500;this._tfidf=this._register(r.createInstance(g0,{tokenizer:"o200k_base"}))}async searchFileChunks(t,r,o,s,a){this._logService.internal.debug("Performing full workspace search for chunks...");let l=(await this._tfidf.searchFileChunks(r,o*2,s,a)).chunks;if(a.isCancellationRequested||!l.length)return{chunks:[]};let u=await Sl(this._logService,"toSemanticChunks",()=>this.instantiationService.invokeFunction(d=>b8(d,t,l,{shouldUseRangedChunks:!0},a)));return a.isCancellationRequested||!u.length?{chunks:[]}:{chunks:u}}};E([Jo(t=>t._logService,function(t,r){this._telemetryService.sendMSFTTelemetryEvent("tfIdfWithSemanticChunkSearch.perf.searchFileChunks",{status:r},{execTime:t})})],_x.prototype,"searchFileChunks",1),_x=E([v(0,oe),v(1,H),v(2,ge)],_x);var yh=re("IWorkspaceChunkSearch"),v0=class extends ye{constructor(t,r,o,s,a){super();this._ignoreService=r;this._logService=o;this._simulationTestContext=s;this._telemetryService=a;this._onDidChangeLocalIndexingState=this._register(new jt);this.onDidChangeLocalIndexingState=this._onDidChangeLocalIndexingState.event;this._embeddingsChunkSearch=this._register(t.createInstance(lf)),this._register(this._embeddingsChunkSearch.onDidChangeInitialIndexingStatus(c=>this._onDidChangeLocalIndexingState.fire(c))),this._codeSearchChunkSearch=this._register(t.createInstance(f0)),this._tfIdfWithSemanticChunkSearch=this._register(t.createInstance(_x))}triggerLocalIndexing(){return this._embeddingsChunkSearch.triggerLocalIndexing()}async searchFileChunks(t,r,o,s,a){let c=new Qo,l=t.endpoint,u=this.getMaxChunks(t);this._logService.internal.debug(`Searching for ${u} chunks in workspace`);let d=await this.getStrategies();if(a.isCancellationRequested)throw new dt;let p=d.map(S=>O1(async w=>{let R=await S.searchFileChunks(l,r,u,o,w);return{chunks:R.chunks.map(k=>({...k,strategy:S.id})),strategy:S.id,couldBeOutdated:R.couldBeOutdated}}));a.onCancellationRequested(()=>p.forEach(S=>S.cancel()));for(let S of p)S.then(w=>{for(let R=0;R<p.length;R++)w.strategy==="ada"||this.isUpToDateCodeSearchResult(w)?p[R].cancel():Dp(p[R].catch(()=>{}),d[R].timeout,()=>{p[R].cancel(),this._logService.internal.warn(`WorkspaceChunkSearch strategy ${d[R].id} timed out`)})},()=>{});let f=await po(Promise.allSettled(p),a);if(a.isCancellationRequested)throw new dt;if(!f)return{chunks:[]};let m=[],h;for(let S=0;S<f.length;S++){let w=f[S],R=d[S];if(w.status==="fulfilled"){(!h||w.value.strategy==="ada"||this.isUpToDateCodeSearchResult(w.value))&&(h=w.value.strategy),m.push(w.value);continue}this._logService.public.debug(`Strategy, ${R.id}, failed with the following error: ${sF(w.reason)}`)}this._logService.internal.debug(`'${h}' was the top working workspace chunk search strategy`),this._telemetryService.sendMSFTTelemetryEvent("workspaceChunkSearchStrategy",{strategy:h??"none",allAttemptedStrategies:d.map(S=>S.id).join(","),allSuccessfulStrategies:f.filter(S=>S.status==="fulfilled").map(S=>S.value.strategy).join(",")},{execTime:c.elapsed()});let g=await this.filterIgnoredResults(m);if(this._simulationTestContext.isInSimulationTests&&!g.some(S=>S.chunks.length>0))throw new Error("No chunks returned");function y(S){return JSON.stringify(S.map(w=>({strategy:w.strategy,text:w.text})),null,2)}let b=async(S,w)=>{this._simulationTestContext.isInSimulationTests&&await this._simulationTestContext.writeFile(S+".txt",y(w),S)},_=[];g.length===1&&g[0].strategy==="tfidf"&&d.find(S=>S.id==="ada")&&_.push(RX.t("Still building the workspace index, response may be less accurate."));let x=g.flatMap(S=>S.chunks);b("workspace-chunk-search-pre-rerank",x);let I=await this.rerankChunks(l,r,g,u,s,a);return b("workspace-chunk-search-post-rerank",I),{chunks:I,warnings:_}}getMaxChunks(t){let r;if(typeof t.tokenBudget=="number"&&(r=Math.floor(t.tokenBudget/sT)),typeof t.maxResults=="number"&&(r=typeof r=="number"?Math.min(t.maxResults,r):t.maxResults),typeof r!="number")throw new Error("Either maxResults or tokenBudget must be provided");return r}async filterIgnoredResults(t){return Promise.all(t.map(async r=>({...r,chunks:zn(await Promise.all(r.chunks.map(async o=>await this._ignoreService.isCopilotIgnored(o.file)?null:o)))})))}async rerankChunks(t,r,o,s,a,c){let l=o.find(p=>p.strategy==="ada");if(l)return l.chunks.slice(0,s);let u=o.find(p=>this.isUpToDateCodeSearchResult(p));return u?u.chunks.slice(0,s):o.flatMap(p=>p.chunks).length?(a?.report(new Ri(RX.t("Filtering to most relevant information"))),this.rerankChunksUsingAda(r,o,s,c)):[]}async rerankChunksUsingAda(t,r,o,s){try{let a=await t.resolveQuery(s);if(s.isCancellationRequested)throw new dt;let c=r.flatMap(d=>d.chunks.map(p=>({...p,strategy:d.strategy}))).map((d,p)=>({...d,index:p})),l=await this._embeddingsChunkSearch.rankChunks(a,c,o,s),u=l.filter(d=>d.index<o).length;return this._telemetryService.sendMSFTTelemetryEvent("workspaceChunkSearch.adaRerank",{allStrategies:r.filter(d=>d.chunks.length).map(d=>d.strategy).join(","),topChunkInitialIndices:l.map(d=>d.index).join(","),topChunkStrategies:l.map(d=>d.strategy).join(",")},{originalChunkCount:c.length,maxResultCount:o,originalTopInTopAfterRerank:u/o}),l}catch(a){return wo(a)||this._logService.public.error(a,"Failed to search chunk embeddings index"),r.flatMap(c=>c.chunks).slice(0,o)}}async getStrategies(){let t=new Array,[r,o]=await Promise.all([this._codeSearchChunkSearch.isAvailable(),this._embeddingsChunkSearch.getState()]);return r&&t.push(this._codeSearchChunkSearch),o===2?t.push(this._embeddingsChunkSearch):o===1?t.push(this._embeddingsChunkSearch,this._tfIdfWithSemanticChunkSearch):t.push(this._tfIdfWithSemanticChunkSearch),this._logService.internal.debug(`Using ${t.map(s=>s.id).join(", ")} for chunk search`),t}isUpToDateCodeSearchResult(t){return t.strategy==="codesearch"&&t.chunks.length>0&&t.couldBeOutdated===!1}};E([Jo(t=>t._logService,function(t,r){this._telemetryService.sendMSFTTelemetryEvent("workspaceChunkSearch.perf.searchFileChunks",{status:r},{execTime:t})})],v0.prototype,"searchFileChunks",1),E([Jo(t=>t._logService),o8(function(t,r){this._telemetryService.sendMSFTTelemetryEvent("workspaceChunkSearch.perf.adaRerank",{status:r},{execTime:t})})],v0.prototype,"rerankChunksUsingAda",1),v0=E([v(0,H),v(1,Te),v(2,oe),v(3,u0),v(4,ge)],v0);var eC=q(Ve());var zbe=q(Ve());function Hbe(n){return n.reduce((t,r)=>t+r.value.length,0)+Math.max(0,n.length-1)}async function OYe(n,e=1/0,t){let r=Vbe(0,n,e),o=e-Hbe(r);for(;;){let s=!1,a=[];for(let c of r)if(c.type==="text")a.push(c);else if(c.type==="dir"){a.push({type:"text",value:c.value});let l=await c.getChildren();if(t?.isCancellationRequested)return"";let u=Vbe(c.level+1,l,o-1);u.length&&(s=!0,o-=Hbe(u)+1,a.push(...u))}if(r=a,!s)break}return r.map(s=>s.value).join(`
`)}function Vbe(n,e,t){let r="	".repeat(n),o=[],s=t;for(let a=0;a<e.length;++a){let c=e[a],l=r+c.name+(c.type===2?"/":"");if(l.length>s){let u=r+"...";for(;u.length>s&&o.length>0;)s+=o.pop().value.length+1;u.length<=s&&o.push({type:"text",value:u});break}c.type===2?o.push({type:"dir",level:n,value:l,getChildren:c.getChildren}):o.push({type:"text",value:l}),s-=l.length,a!==e.length-1&&(s-=1)}return o}async function Gbe(n,e,t,r){let o=n.get(gn),s=n.get(Te),a=n.get(H);async function c(u){let d;try{d=await o.readDirectory(u)}catch{return[]}return r?.isCancellationRequested?[]:(d.sort((p,f)=>p[0].localeCompare(f[0])),Promise.all(d.map(async p=>{let f=$e.joinPath(u,p[0]);return await a.invokeFunction(m=>yx(m,f))?p:null})).then(p=>p.filter(f=>f!==null).map(f=>f[1]===2?{type:2,name:f[0],getChildren:()=>c($e.joinPath(u,f[0]))}:{type:1,name:f[0]})))}if(await s.init(),r?.isCancellationRequested)return"";let l=await c(e);return r?.isCancellationRequested?"":OYe(l,t,r)}var ws=class extends zbe.PromptElement{constructor(t,r,o){super(t);this.instantiationService=r;this.workspaceService=o}async prepare(t,r,o){let s=this.workspaceService.getWorkspaceFolders().at(0);if(s)return this.instantiationService.invokeFunction(a=>Gbe(a,s,this.props.maxSize,o))}render(t,r){if(t)return vscpp(vscppf,null,"I am working in a workspace that has the following structure:",vscpp("br",null),vscpp("br",null),mo("",t))}};ws=E([v(1,H),v(2,Be)],ws);var PX=class extends eC.PromptElement{render(e,t){return vscpp(vscppf,null,vscpp(eC.SystemMessage,{priority:1e3},"You are a coding assistant who help the user answer questions about code in their workspace by providing a list of relevant keywords they can search for to answer the question.",vscpp("br",null),"The user will provide you with potentially relevant information from the workspace. This information may be incomplete.",vscpp("br",null)),vscpp(Nt,{historyPriority:500,passPriority:!0,history:this.props.history||[]},vscpp(Tt,{priority:1e3},"Respond in Markdown. First under a `# Question` header, output a rephrased version of the user's question that resolves all pronouns and ambiguous words like 'this' to the specific nouns they stand for.",vscpp("br",null),"Then under a `# Keywords` header, output a short markdown list of up to 8 relevant keywords that the user can search for to answer the question. You may include variations after each keyword.",vscpp("br",null),"DO NOT ask the user for additional information or clarification.",vscpp("br",null),"DO NOT answer the user's question directly.",vscpp("br",null),vscpp("br",null),"# Additional Rules",vscpp("br",null),vscpp("br",null),"Think step by step:",vscpp("br",null),"1. Read the user's question to understand what they are asking about their workspace.",vscpp("br",null),"2. If the question contains pronouns such as 'it' or 'that', try to understand what the pronoun refers to by looking at the rest of the question and the conversation history.",vscpp("br",null),"3. If the question contains an ambiguous word such as 'this', try to understand what is refers to by looking at the rest of the question, the user's active selection, and the conversation history.",vscpp("br",null),"4. After a `# Question` header, output a precise version of question that resolves all pronouns and ambiguous words like 'this' to the specific nouns they stand for. Be sure to preserve the exact meaning of the question by only changing ambiguous pronouns and words like 'this'.",vscpp("br",null),"5. Then after a `# Keywords` header, output a short markdown list of up to 8 relevant keywords that user could try searching for to answer their question. These keywords could used as file name, symbol names, abbreviations, or comments in the relevant code. Put the keywords most relevant to the question first. Do not include overly generic keywords. Do not repeat keywords.",vscpp("br",null),"6. For each keyword in the markdown list of related keywords, if applicable add a comma separated list of variations after it. For example: for 'encode' possible variations include 'encoding', 'encoded', 'encoder', 'encoders'. Consider synonyms and plural forms. Do not repeat variations.",vscpp("br",null),vscpp("br",null),"Examples",vscpp("br",null),vscpp("br",null),"User: Where's the code for base64 encoding?",vscpp("br",null),vscpp("br",null),"Assistant:",vscpp("br",null),"# Question",vscpp("br",null),"Where's the code for base64 encoding?",vscpp("br",null),vscpp("br",null),"# Keywords",vscpp("br",null),"- base64 encoding, base64 encoder, base64 encode",vscpp("br",null),"- base64, base 64",vscpp("br",null),"- encode, encoded, encoder, encoders")),vscpp(eC.UserMessage,{priority:700},vscpp(ws,{maxSize:1e3})),vscpp($n,{flexGrow:2,priority:1e3,chatVariables:this.props.chatVariables,query:this.props.query}))}};async function $be(n,{query:e,history:t,chatVariables:r},o){let s=n.get($t).activeTextEditor;return Fe.create(n.get(H),o,PX,{chatVariables:r,query:e,history:t,document:s?Bt.create(s?.document):void 0,selection:s?.selection}).render()}var MYe=/^[\*\-]\s*(.+)/m;function AX(n,e){let t=e.match(/#+\s*Question\n(?<question>.+?)#+\s*Keywords\n(?<keywords>.+)/si);if(!t?.groups)return{rephrasedQuestion:n.trim(),keywords:[]};let r=[];for(let o of t.groups.keywords.trim().split(`
`)){let s=o.match(MYe);if(s){let a=s[1].split(/,/g).map(c=>c.trim());a.length&&r.unshift({keyword:a[0],variations:a.slice(1)})}}return{rephrasedQuestion:t.groups.question.trim(),keywords:r}}var FYe=128,UYe=32e3,bh=class extends b0.PromptElement{constructor(t,r,o,s,a){super(t);this.logService=r;this.telemetryService=o;this.workspaceChunkSearch=s;this.workspaceService=a}async prepare(t,r,o=Zt.None){r?.report(new Ri(DX.t("Collecting workspace information")));let s=await this.workspaceChunkSearch.searchFileChunks({...t,tokenBudget:Math.min(Math.floor(t.tokenBudget*.7),UYe),maxResults:this.props.maxResults??FYe},this.props.query,{include:this.props.include},r,o);if(o.isCancellationRequested)throw new dt;if(s.warnings)for(let l of s.warnings)r?.report(new P5(l));let a=new kn;for(let l of s.chunks){let u=a.get(l.file)??[];l.isFullFile?u=[l]:u.some(d=>d.isFullFile||d.range.containsRange(l.range))||(u=[...u.filter(d=>!l.range.containsRange(d.range)),l]),a.set(l.file,u)}let c=Array.from(a.values()).flatMap(l=>l.sort((u,d)=>De.compareRangesUsingStarts(u.range,d.range)).map(u=>new Xo.PromptReference(u.isFullFile?u.file:new ar(u.file,jT(u.range)))));return{result:s,references:c}}render(t,r){if(t.result.chunks.length)return vscpp(vscppf,null,vscpp("references",{value:t.references}),t.result.chunks.map((o,s)=>{let a=typeof this.props.priority<"u"?this.props.priority+(1-(s+1)/t.result.chunks.length):void 0;return{chunk:o,priority:a}}).reverse().map(({chunk:o,priority:s})=>{let a=wd(this.workspaceService,o.file);return vscpp(b0.TextChunk,{priority:s},o.isFullFile?`Here is the full contents of \`${a}\`:`:`Here is a potentially relevant excerpt in \`${a}\` starting at line ${o.range.startLineNumber}:`,vscpp("br",null),mo(m6(o.file),o.rawText??o.text),vscpp("br",null),vscpp("br",null))}))}};E([Jo(t=>t.logService,function(t,r){this.telemetryService.sendMSFTTelemetryEvent("workspaceContext.perf.prepareWorkspaceChunks",{status:r},{execTime:t})})],bh.prototype,"prepare",1),bh=E([v(1,oe),v(2,ge),v(3,yh),v(4,Be)],bh);var y0=class extends b0.PromptElement{constructor(t,r,o,s,a,c,l){super(t);this.instantiationService=r;this.logService=o;this.chatFetcher=s;this.telemetryService=a;this.tokenizerProvider=c;this.endpointProvider=l}async prepare(t,r,o){let s=this.props,a=s.promptContext.query;if(!a)return;let c=await this.endpointProvider.getChatEndpoint("gpt-4o-mini");if(o.isCancellationRequested)throw new dt;let{messages:l}=await this.instantiationService.invokeFunction(d=>$be(d,this.props.promptContext,c));if(o.isCancellationRequested)throw new dt;let u=new kr(()=>{this.logService.internal.debug("[Workspace Resolver] Asking the model to update the user question and provide queries...");let d=this.tokenizerProvider.acquireTokenizer(c).tokenLength(a),p=200,f=new ys,m=this.chatFetcher.fetchOne("workspaceContext",l,async h=>{!f.isSettled&&/^#+\s*Keywords/gm.test(h)&&f.complete(AX(a,h).rephrasedQuestion)},o,2,c,void 0,{temperature:0,max_tokens:d+p}).then(h=>{if(o.isCancellationRequested)throw new dt;let g;if(h.type!=="success")if(this.telemetryService.sendMSFTTelemetryEvent("workspaceResolver.error",{type:h.type,reason:h.reason,requestId:h.requestId}),h.type==="length")g=h.truncatedValue;else throw new Error(DX.t("Encountered an error while deciding what workspace information to collect: ({0}) {1}",h.type,h.reason));else g=h.value;let y=AX(a,g);return this.telemetryService.sendMSFTTelemetryEvent("workspaceResolver.success",{type:h.type,requestId:h.requestId},{totalKeywordCount:y.keywords.flatMap(b=>[b.keyword,b.variations]).length}),{rephrasedQuery:y.rephrasedQuestion,keywords:y.keywords}});return{query:f.p,queryAndKeywords:m}});return new class{constructor(){this.rawQuery=a}resolveQueryAndKeywords(d){return u.value.queryAndKeywords}async resolveQuery(d){return this.maySkipResolve()?a:await po(Promise.race([u.value?.query,u.value.queryAndKeywords.then(p=>p?.rephrasedQuery)]),d)??a}maySkipResolve(){return s.promptContext.chatVariables.hasVariables()?!1:!/\b(it|that|this)\b/i.test(a)}}}render(t,r){if(!t)return;let o=this.props.include??{workspaceStructure:!0,workspaceChunks:!0};return vscpp(vscppf,null,o.workspaceStructure&&vscpp(ws,{flexGrow:1,maxSize:500,...this.props}),o.workspaceChunks&&vscpp(bh,{priority:this.props.priority,query:t}))}};E([o8(function(t,r){this.telemetryService.sendMSFTTelemetryEvent("workspaceContext.perf.prepare",{status:r},{execTime:t})})],y0.prototype,"prepare",1),y0=E([v(1,H),v(2,oe),v(3,Et),v(4,ge),v(5,Qn),v(6,_e)],y0);var tC=class extends b0.PromptElement{render(e,t){return vscpp(b0.UserMessage,null,vscpp(y0,{...this.props}))}};var I8=class extends xx.PromptElement{render(e,t){let{query:r,history:o,chatVariables:s}=this.props.promptContext;return vscpp(vscppf,null,vscpp(xx.SystemMessage,{priority:1e3},"You are a software engineer with expert knowledge of the codebase the user has open in their workspace.",vscpp("br",null),vscpp("br",null),vscpp(vn,null),vscpp(Ze,null)),vscpp(Nt,{flexGrow:2,historyPriority:400,history:o,passPriority:!0},vscpp(Tt,{priority:1e3},vscpp(ii,null),vscpp(kt,null),"# Additional Rules",vscpp("br",null),"Think step by step:",vscpp("br",null),"1. Read the provided relevant workspace information (code excerpts, file names, and symbols) to understand the user's workspace.",vscpp("br",null),"2. Consider how to answer the user's prompt based on the provided information and your specialized coding knowledge. Always assume that the user is asking about the code in their workspace instead of asking a general programming question. Prefer using variables, functions, types, and classes from the workspace over those from the standard library.",vscpp("br",null),"3. Generate a response that clearly and accurately answers the user's question. In your response, add fully qualified links for referenced symbols (example: [`namespace.VariableName`](path/to/file.ts)) and links for files (example: [path/to/file](path/to/file.ts)) so that the user can open them. If you do not have enough information to answer the question, respond with \"I'm sorry, I can't answer that question with what I currently know about your workspace\".",vscpp("br",null),vscpp("br",null),"DO NOT mention that you cannot read files in the workspace.",vscpp("br",null),"DO NOT ask the user to provide additional information about files in the workspace.",vscpp("br",null),"Remember that you MUST add links for all referenced symbols from the workspace and fully qualify the symbol name in the link, for example: [`namespace.functionName`](path/to/util.ts).",vscpp("br",null),"Remember that you MUST add links for all workspace files, for example: [path/to/file.js](path/to/file.js)",vscpp("br",null),vscpp("br",null),"# Examples",vscpp("br",null),"Question:",vscpp("br",null),"What file implements base64 encoding?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"Base64 encoding is implemented in [src/base64.ts](src/base64.ts) as [`encode`](src/base64.ts) function.",vscpp("br",null),vscpp("br",null),vscpp("br",null),"Question:",vscpp("br",null),"How can I join strings with newlines?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"You can use the [`joinLines`](src/utils/string.ts) function from [src/utils/string.ts](src/utils/string.ts) to join multiple strings with newlines.",vscpp("br",null),vscpp("br",null),vscpp("br",null),"Question:",vscpp("br",null),"How do I build this project?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"To build this TypeScript project, run the `build` script in the [package.json](package.json) file:",vscpp("br",null),vscpp("br",null),"```sh",vscpp("br",null),"npm run build",vscpp("br",null),"```",vscpp("br",null),vscpp("br",null),vscpp("br",null),"Question:",vscpp("br",null),"How do I read a file?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"To read a file, you can use a [`FileReader`](src/fs/fileReader.ts) class from [src/fs/fileReader.ts](src/fs/fileReader.ts).",vscpp("br",null))),vscpp(xx.UserMessage,{priority:725},vscpp(sn,{languageId:void 0})),vscpp(xx.UserMessage,{flexGrow:1},vscpp(y0,{priority:800,...this.props})),vscpp(tn,{priority:899,flexGrow:3,endpoint:this.props.endpoint,promptContext:this.props.promptContext}),vscpp($n,{flexGrow:3,priority:900,chatVariables:s,query:r}))}};var WD="workspace",$D=class extends ga{constructor(t,r,o,s,a){super(t,r,o);this.instantiationService=s;this.tabsAndEditorsService=a}createRenderer(t,r,o,s){let a=this.tabsAndEditorsService.activeTextEditor;return Fe.create(this.instantiationService,r,I8,{promptContext:t,document:a?Bt.create(a?.document):void 0,selection:a?.selection,endpoint:r})}};$D=E([v(3,H),v(4,$t)],$D);var _0=class{constructor(e,t){this.instantiationService=e;this.endpointProvider=t;this.id=_0.ID;this.description=Wbe.t("Ask a question about the files in your current workspace");this.locations=[2];this.commandInfo={allowsEmptyArgs:!1,defaultEnablement:!0}}static{this.ID=WD}get intentDetectionInput(){let e="workspace_questions";return{functionName:e,sampleQuestion:"How do I build this project?",functionCallingBlurb:`If the user's message is about files in the current project, repository, or workspace, you should use the '${e}' function.`}}async invoke(e){let t=e.location,r=await this.endpointProvider.getChatEndpoint(e.request);return this.instantiationService.createInstance($D,this,t,r)}};_0=E([v(0,H),v(1,_e)],_0);var Mo=q(require("vscode"));var nC={location:"sameFolder",prefix:"test_",suffixes:[".test",".spec","_test","Test","_spec","_test","Tests",".Tests","Spec"]},rC={csharp:{suffixes:["Test"],location:"testFolder"},dart:{suffixes:["_test"],location:"testFolder"},go:{suffixes:["_test"],location:"sameFolder"},java:{suffixes:["Test"],location:"testFolder"},javascript:{suffixes:[".test",".spec"],location:"sameFolder"},javascriptreact:{suffixes:[".test",".spec"],location:"sameFolder"},kotlin:{suffixes:["Test"],location:"testFolder"},php:{suffixes:["Test"],location:"testFolder"},powershell:{suffixes:[".Tests"],location:"testFolder"},python:{prefix:"test_",suffixes:["_test"],location:"testFolder"},ruby:{suffixes:["_test","_spec"],location:"testFolder"},rust:{suffixes:[""],location:"testFolder"},swift:{suffixes:["Tests"],location:"testFolder"},typescript:{suffixes:[".test",".spec"],location:"sameFolder"},typescriptreact:{suffixes:[".test",".spec"],location:"sameFolder"}},BYe={cs:"csharp",dart:"dart",go:"go",java:"java",js:"javascriptreact",kt:"kotlin",php:"php",ps1:"powershell",py:"python",rb:"ruby",rs:"rust",swift:"swift",ts:"typescript",tsx:"typescriptreact"},qYe=function(){let n={};for(let[e,t]of Object.entries(BYe))n[e]=rC[t];return n}(),uf=class{constructor(e,t){this._search=e;this._tabs=t}_findTabMatchingPattern(e){return this._tabs.tabs.find(r=>r.uri&&r.uri.scheme!==yr.untitled&&d8(r.uri,e))?.uri}async findTestFileForSourceFile(e,t){if(e.isUntitled)return;let r=fc(e.uri),o=fl(e.uri),s=rC[e.languageId]??nC,a=[];if(s.prefix&&a.push(s.prefix+r),s.suffixes)for(let u of s.suffixes??[]){let d=r.replace(`${o}`,`${u}${o}`);a.push(d)}let c=a.length===1?`**/${a[0]}`:`**/{${a.join(",")}}`,l=this._findTabMatchingPattern(c);return l||(e.languageId==="python"?l=await this._search.findFilesWithExcludes(c,"**/*.pyc",1,t):l=await this._search.findFilesWithDefaultExcludes(c,1,t)),l}async findAnyTestFileForSourceFile(e,t){let r=rC[e.languageId]??nC,o=[];if(r.prefix&&o.push(`${r.prefix}*`),r.suffixes){let c=fl(e.uri);for(let l of r.suffixes??[])o.push(`*${l}${c}`)}let s=o.length===1?`**/${o[0]}`:`**/{${o.join(",")}}`,a=this._findTabMatchingPattern(s);return a||(e.languageId==="python"?a=await this._search.findFilesWithExcludes(s,"**/*.pyc",1,t):a=await this._search.findFilesWithDefaultExcludes(s,1,t)),a}async findFileForTestFile(e,t){let r=rC[e.languageId]??nC,o=fc(e.uri),s=[];r.suffixes&&s.splice(0,0,...r.suffixes),r.prefix&&s.splice(0,0,r.prefix);for(let a of s){let c=o.replace(a,"");if(c!==o){let l=`**/${c}`,u=this._findTabMatchingPattern(l);if(u||(u=await this._search.findFilesWithDefaultExcludes(l,1,t)),u)return u}}}};uf=E([v(0,af),v(1,$t)],uf);function x0(n){let e;$e.isUri(n)||(e=rC[n.languageId],n=n.uri);let t=fc(n),r=fl(n);if(e??=qYe[r.replace(".","")],e){if(e.suffixes&&e.suffixes.some(s=>t.endsWith(s+r))||e.prefix&&t.startsWith(e.prefix))return!0}else if(nC.suffixes.some(s=>t.endsWith(s+r))||t.startsWith(nC.prefix))return!0;return!1}function jYe(n){let e=rC[n.languageId]??nC,t=fc(n.uri);if(e.prefix)return e.prefix+t;let r=fl(n.uri),o=e.suffixes&&e.suffixes.length>0?e.suffixes[0]:".test";return t.replace(`${r}`,`${o}${r}`)}function HYe(n){let e=Rhe(n.uri,"..");if(n.languageId==="java"){let t=e.path;if(t.includes("/src/main/")){let r=t.replace("/src/main/","/src/test/");return e.with({path:r})}}return e}function T8(n){let e=jYe(n),t=HYe(n);return $e.joinPath(t,e).with({scheme:yr.untitled})}var iC=re("ITestGenInfoStorage"),C8=class{constructor(){this.sourceFileToTest=void 0}};var oC=class{constructor(e,t,r,o,s){this.instaService=e;this.parserService=t;this.testGenInfoStorage=r;this.tabsAndEditorsService=o;this.ignoreService=s}async runCommand(e){let t,r;if(e)t=Bt.create(e.document),r=e.selection;else{let o=Mo.window.activeTextEditor;if(o===void 0)return;t=Bt.create(o.document),r=o.selection}if(x0(t.uri))return Mo.commands.executeCommand("vscode.editorChat.start",{message:"/tests ",autoSend:!0,initialRange:r});{let o=await this.identifyTestableNode(t,r);this.updateTestGenInfo(t,o,r);let s=await this.findOrCreateTestFile(t),a=await Mo.workspace.openTextDocument(s),c=await this.determineTestInsertPosition(a),l=await Mo.window.showTextDocument(a,this.getTabGroupByUri(s));return l.selection=new Mo.Selection(c.start,c.end),l.revealRange(c,Mo.TextEditorRevealType.InCenter),c.end.line===0&&c.end.character===0||await l.edit(d=>{d.insert(c.start,`

`)}),Mo.commands.executeCommand("vscode.editorChat.start",{message:"/tests",autoSend:!0})}}async determineTestInsertPosition(e){let t=this.parserService.getTreeSitterAST(e),r=t?await t.findLastTest():null,o;if(r===null){let s=e.lineAt(e.lineCount-1);o=new Mo.Range(s.range.end,s.range.end)}else{let s=e.positionAt(r.endIndex),a=e.lineAt(s).range.end;o=new Mo.Range(a,a)}return o}updateTestGenInfo(e,t,r){this.testGenInfoStorage.sourceFileToTest={uri:e.uri,target:t?.range??r,identifier:t?.identifier}}async identifyTestableNode(e,t){let r=this.parserService.getTreeSitterAST(e);if(!r)return null;let o=await r.getTestableNode({startIndex:e.offsetAt(t.start),endIndex:e.offsetAt(t.end)});if(!o)return null;let{startIndex:s,endIndex:a}=o.node,c=new Mo.Range(e.positionAt(s),e.positionAt(a));return{identifier:o.identifier.name,range:c}}async findOrCreateTestFile(e){let r=await this.instaService.createInstance(uf).findTestFileForSourceFile(e,Zt.None);return r!==void 0&&await this.ignoreService.isCopilotIgnored(r)&&(r=void 0),r===void 0&&(r=T8(e)),r}getTabGroupByUri(e){for(let r of this.tabsAndEditorsService.tabs)if(r.uri?.toString()===e.toString())return r.tab.group.viewColumn;let t=this.tabsAndEditorsService.activeTextEditor?.viewColumn;return t===void 0?Mo.ViewColumn.Two:t>Mo.ViewColumn.One?t-1:Mo.ViewColumn.Beside}};oC=E([v(0,H),v(1,ft),v(2,iC),v(3,$t),v(4,Te)],oC);var v_e=q(ht());function Kbe(n){let e=(o,s,a)=>{let c="",l=a?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ";if(s===1?c=`${l}${o.name}
`:s>1&&(c=`|   ${"    ".repeat(s-2)}${l}${o.name}
`),o.children){let u=o.children.length-1;o.children.forEach((d,p)=>{c+=e(d,s+1,p===u)})}return c},t=`${n.baseUri.path.replace("/","")}
`,r=n.value.length-1;return n.value.forEach((o,s)=>{t+=e(o,1,s===r)}),`\`\`\`filetree
${t}\`\`\`
`}var Md=re("IConversationStore"),E8=class{constructor(){this.conversationMap=new kp(1e3)}addConversation(e,t){this.conversationMap.set(e,t)}getConversation(e){return this.conversationMap.get(e)}get lastConversation(){return this.conversationMap.last}};var u_e=q(ht());var VYe="vscode-notebook-cell";function an(n){return n.scheme===VYe||n.scheme==="untitled"&&n.fragment.startsWith("notebook-chat-input")}var Ix=q(Ve());var Xbe=q(Ve());var _h=q(Ve());var Qbe=q(Ve());function Ybe(n,e,t){return Math.min(Math.max(n,e),t)}async function zYe(n,e,t){let r=n.get(M1),o=n.get(ft),s=n.get(be),a=n.get(fn),c=await r.getEntries(),l=new kn,u=Date.now(),d=1e3*Ybe(s.getExperimentBasedConfig(le.TemporalContextMaxAge,a),0,Number.MAX_SAFE_INTEGER),p=[],f=Number.MAX_SAFE_INTEGER,m=0;for(let[_,x]of c)if(!t.some(I=>th(_.uri,I.uri))&&(x=x.filter(I=>u-I.timestamp<=d),x.length!==0)){p.push({document:Bt.create(_),formattingOptions:void 0,selection:void 0}),l.set(_.uri,x);for(let I of x)I.timestamp<f&&(f=I.timestamp),I.timestamp>m&&(m=I.timestamp)}let h=m-f;if(p.length===0)return new Map;let g=s.getExperimentBasedConfig(le.TemporalContextPreferSameLang,a),y=await Mye(o,p,e,{costFnOverride:(_,x,I)=>{let S=l.get(I.uri);if(!S)return!1;let w=g&&t.some(k=>I.languageId!==k.languageId)?1:0,R=Number.MAX_SAFE_INTEGER;for(let k of S){if(_.range.contains(k.offset)){let V=h&&1-(k.timestamp-f)/h;return _.children.length===0?1+w+V:3+w+V+x}R=Math.min(R,Math.abs(k.offset-_.range.start),Math.abs(k.offset-_.range.endExclusive))}return 1+R+w+x}}),b=new Map;for(let _=0;_<y.length;_++)P1(y[_].text)||b.set(p[_].document.uri.toString(),{doc:p[_].document,projectedDoc:y[_]});return b}var Sx=class extends D6{constructor(t,r){super();this.documentCount=t;this.totalCharLength=r}},kc=class extends Qbe.PromptElement{constructor(t,r,o,s){super(t);this.instantiationService=r;this.configurationService=o;this.experimentationService=s}async render(t,r){if(!this.configurationService.getExperimentBasedConfig(le.TemporalContextEnabled,this.experimentationService))return;let s=await this.instantiationService.invokeFunction(zYe,r.tokenBudget,Bme(this.props.context));if(s.size!==0)return vscpp(Rt,{name:"recentDocuments"},"I have read or edited some files recently, they may be helpful for answering the user's question",vscpp("br",null),vscpp(Rt,{name:"note"},"These documents are provided as extra insights but are not meant to be edited or changed in anyway."),Array.from(ti.map(s,([a,{doc:c,projectedDoc:l}])=>vscpp(vscppf,null,vscpp(Rt,{name:l.isOriginal?"document":"documentFragment"},"From `",vscpp(ux,{value:c.uri,mode:1}),"` I have read or edited:",vscpp("br",null),vscpp(tt,{includeFilepath:this.props.includeFilePaths,languageId:c.languageId,uri:c.uri,code:l.text})),vscpp("br",null)))),vscpp("meta",{value:new Sx(s.size,ti.reduce(s.values(),(a,{projectedDoc:c})=>a+c.text.length,0))}))}};kc=E([v(1,H),v(2,be),v(3,fn)],kc);var sC=class extends _h.PromptElement{constructor(t,r,o){super(t);this._ignoreService=r;this._instantiationService=o}async render(t,r){let o=this.props.documentContext,s=o.document,a=s.languageId;if(an(this.props.documentContext.document.uri))throw ur("InlineChatGenerateMarkdownPrompt should not be used with a notebook!");if(a!=="markdown")throw ur("InlineChatGenerateMarkdownPrompt should only be used with markdown documents!");if(await this._ignoreService.isCopilotIgnored(o.document.uri))return vscpp("ignoredFiles",{value:[this.props.documentContext.document.uri]});let{query:l,history:u,chatVariables:d}=this.props.promptContext,p=await this._instantiationService.invokeFunction(lu.create,o.document,o.fileIndentInfo,o.wholeRange,1),f=m=>m.createReplyInterpreter(Cs.Mute,0,m.insertStreaming,Zi.createFencedBlockClassifier(Rc.FenceSequence),h=>h.value.trim()!==p.placeholderText);return vscpp(vscppf,null,vscpp(_h.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You are a world class markdown editor, very well versed in programming.",vscpp("br",null),vscpp(Ze,null)),vscpp(Nt,{inline:!0,historyPriority:700,passPriority:!0,history:u},vscpp(Tt,{priority:1e3},"The user needs help to write some new markdown.",vscpp("br",null),"The markdown is always delimited by ",Rc.FenceSequence,".",vscpp("br",null),p.hasContent&&vscpp(vscppf,null,"The user includes existing markdown and marks with ",p.placeholderText," where the new code should go.",vscpp("br",null)),p.hasContent&&vscpp(vscppf,null,'DO NOT include the text "',p.placeholderText,'" in your reply.',vscpp("br",null)),p.hasContent&&vscpp(vscppf,null,"DO NOT repeat any markdown from the user in your reply.",vscpp("br",null)),!p.hasContent&&vscpp(vscppf,null,"Your answer must begin and end with ",Rc.FenceSequence,vscpp("br",null)))),vscpp(_h.UserMessage,{priority:725},vscpp(sn,{languageId:a}),vscpp(kc,{context:s})),vscpp(tn,{priority:750,endpoint:r.endpoint,promptContext:this.props.promptContext,flexGrow:1}),vscpp(Ai,{priority:750,chatVariables:d}),vscpp(_h.UserMessage,{priority:900,flexGrow:2,flexReserve:r.endpoint.modelMaxPromptTokens/3},vscpp(Pc,{flexGrow:1,tokenBudget:"usePromptSizingBudget",documentData:p,createReplyInterpreter:f}),vscpp(Rt,{name:"userPrompt"},vscpp(Oo,{chatVariables:d,query:l}),vscpp("br",null)),p.hasContent&&vscpp(vscppf,null,"Remember to start and end your answer with ",Rc.FenceSequence,". The markdown that would fit at ",p.placeholderText," is:")))}};sC=E([v(1,Te),v(2,H)],sC);var Rc=class n extends Wv{static{this.FenceSequence="-+-+-+-+-+"}async render(e){if(this.props.uri?await this._ignoreService.isCopilotIgnored(this.props.uri):!1)return this._handleFoulPrompt();let r=n.FenceSequence,o=`${r}
${this.props.code}
${r}`;return vscpp(_h.TextChunk,null,o)}};function $Ye(n){return n!==null&&typeof n=="object"&&typeof n.get=="function"}var lu=class n{constructor(e,t,r,o,s,a){this.document=e;this.formattingOptions=t;this.structure=r;this.selection=o;this.offsetSelections=s;this.kind=a;let c=a===0?s.adjusted:s.original,l=e.getText(),u=l.substring(c.start,c.endExclusive),d=l.substring(0,c.start),p=l.substring(c.endExclusive);this.hasCodeWithoutSelection=d.trim().length>0||p.trim().length>0,this.hasContent=u.trim().length>0||d.trim().length>0||p.trim().length>0,this.placeholderText=c.isEmpty?"$PLACEHOLDER$":"$SELECTION_PLACEHOLDER$"}static async create(e,t,r,o,s){$Ye(e)&&(e=e.get(ft));let a=await su(e,t,r);o=t.validateRange(o);let c=U6(a,t,o);return new n(t,r,a,o,c,s)}summarizeDocument(e){let t=Zp(G6(e),this.document,this.selection,this.structure),r;return this.kind===0?r=t.projectOffsetRange(this.offsetSelections.adjusted):r=t.projectOffsetRange(new gt(this.offsetSelections.original.endExclusive,this.offsetSelections.original.endExclusive)),new ET(t,this.document.uri,this.formattingOptions,r)}},Pc=class extends Xbe.PromptElement{constructor(t,r,o){super(t);this.logger=r;this.ignoreService=o}async render(t,r){let{createReplyInterpreter:o,documentData:s}=this.props;if(await this.ignoreService.isCopilotIgnored(s.document.uri))return vscpp("ignoredFiles",{value:[s.document.uri]});let{tokenBudget:c}=this.props;c==="usePromptSizingBudget"&&(c=r.tokenBudget*.85-300);let l=s.summarizeDocument(c);for(let I=0;I<5;I++){let S=l.codeAbove+l.codeSelected+l.codeBelow;if(await r.countTokens(S)<=c)break;c*=.85,l=s.summarizeDocument(c)}this.logger.internal.info(`Summarized doc to fit token budget (${c} / ${r.endpoint.modelMaxPromptTokens}): ${l.codeAbove.length} + ${l.codeSelected.length} + ${l.codeBelow.length}`);let{uri:u,languageId:d}=s.document,p=d==="markdown",f=p?"markdown":"code",{codeAbove:m,codeSelected:h,codeBelow:g,hasCodeWithoutSelection:y,hasContent:b}=l,_=`${m}${s.placeholderText}${g}`,x=o?o(l):l.createReplyInterpreter(Cs.Mute,1,l.replaceSelectionStreaming,Zi.createCodeBlockClassifier(),I=>I.value.trim()!==s.placeholderText);return vscpp(Rt,{name:"currentDocument"},vscpp("meta",{value:new $s(x)}),!b&&vscpp(vscppf,null,"I am in an empty file `",vscpp(ux,{value:u,mode:1}),"`."),b&&vscpp(vscppf,null,"I have the following ",f," in a file called `",vscpp(ux,{value:u,mode:1}),"`:",vscpp("br",null)),!p&&y&&vscpp(vscppf,null,vscpp(tt,{uri:u,languageId:d,code:_,shouldTrim:!1}),vscpp("br",null)),p&&y&&vscpp(vscppf,null,vscpp(Rc,{uri:u,code:_}),vscpp("br",null)),(!P1(h)||this.props._allowEmptySelection)&&vscpp(Rt,{name:"selection"},!p&&y&&vscpp(vscppf,null,"The ",s.placeholderText," code is:",vscpp("br",null)),p&&y&&vscpp(vscppf,null,"I need your help with the following content:"),!p&&vscpp(tt,{uri:u,languageId:d,code:h,shouldTrim:!1}),p&&vscpp(Rc,{uri:u,code:h})))}};Pc=E([v(1,oe),v(2,Te)],Pc);var aC=class extends Ix.PromptElement{constructor(t,r,o,s,a){super(t);this._ignoreService=r;this._parserService=o;this._experimentationService=s;this._configurationService=a}async render(t,r){let o=this.props.documentContext,s=o.document,a=s.languageId;if(an(s.uri))throw ur("InlineChatEditCodePrompt should not be used with a notebook!");if(a==="markdown")throw ur("InlineChatEditCodePrompt should not be used with a markdown document!");if(await this._ignoreService.isCopilotIgnored(s.uri))return vscpp("ignoredFiles",{value:[s.uri]});let{query:l,history:u,chatVariables:d}=this.props.promptContext,p=this._configurationService.getExperimentBasedConfig(le.ProjectLabelsInline,this._experimentationService),f=await lu.create(this._parserService,s,o.fileIndentInfo,o.wholeRange,0),m=h=>h.createReplyInterpreter(Cs.Mute,1,h.replaceSelectionStreaming,Zi.createCodeBlockClassifier(),g=>g.value.trim()!==f.placeholderText);return vscpp(vscppf,null,vscpp(Ix.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You are a world class expert in programming, and especially good at ",a,".",vscpp("br",null),vscpp(Ze,null)),vscpp(Nt,{inline:!0,historyPriority:700,passPriority:!0,history:u},vscpp(Tt,{priority:1e3},"Source code is always contained in ``` blocks.",vscpp("br",null),"The user needs help to modify some code.",vscpp("br",null),f.hasCodeWithoutSelection&&vscpp(vscppf,null,"The user includes existing code and marks with ",f.placeholderText," where the selected code should go.",vscpp("br",null)))),p&&vscpp(Xi,{priority:600}),vscpp(Ix.UserMessage,null,vscpp(sn,{priority:725,languageId:a}),vscpp(kc,{priority:600,context:s})),vscpp(tn,{priority:750,endpoint:r.endpoint,promptContext:this.props.promptContext,flexGrow:1}),vscpp(Ai,{priority:750,chatVariables:d}),vscpp(Ix.UserMessage,{priority:900,flexGrow:2,flexReserve:r.endpoint.modelMaxPromptTokens/3},vscpp(Pc,{flexGrow:1,tokenBudget:"usePromptSizingBudget",documentData:f,createReplyInterpreter:m}),vscpp(Rt,{name:"userPrompt"},vscpp(Oo,{chatVariables:d,query:l}),vscpp("br",null)),f.hasCodeWithoutSelection&&vscpp(vscppf,null,"The modified ",f.placeholderText," code with ``` is:")))}};aC=E([v(1,Te),v(2,ft),v(3,fn),v(4,be)],aC);var Tx=q(Ve());var cC=class extends Tx.PromptElement{constructor(t,r,o){super(t);this._ignoreService=r;this._instantiationService=o}async render(t,r){let o=this.props.documentContext,s=o.document,a=s.languageId;if(an(this.props.documentContext.document.uri))throw ur("InlineChatEditMarkdownPrompt should not be used with a notebook!");if(a!=="markdown")throw ur("InlineChatEditMarkdownPrompt should only be used with markdown documents!");if(await this._ignoreService.isCopilotIgnored(o.document.uri))return vscpp("ignoredFiles",{value:[this.props.documentContext.document.uri]});let l=await this._instantiationService.invokeFunction(lu.create,s,o.fileIndentInfo,o.wholeRange,0),{query:u,history:d,chatVariables:p}=this.props.promptContext,f=m=>m.createReplyInterpreter(Cs.Mute,0,m.replaceSelectionStreaming,Zi.createFencedBlockClassifier(Rc.FenceSequence),h=>h.value.trim()!==l.placeholderText);return vscpp(vscppf,null,vscpp(Tx.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You are a world class markdown editor, very well versed in programming.",vscpp("br",null),"The user needs help to modify some markdown content.",vscpp("br",null),vscpp(Ze,null)),vscpp(Nt,{inline:!0,historyPriority:700,passPriority:!0,history:d},vscpp(Tt,{priority:1e3},"The markdown is always delimited by ",Rc.FenceSequence,".",vscpp("br",null),"Your answer must begin and end with ",Rc.FenceSequence,".",vscpp("br",null))),vscpp(Tx.UserMessage,{priority:725},vscpp(sn,{languageId:a})),vscpp(tn,{priority:750,endpoint:r.endpoint,promptContext:this.props.promptContext,flexGrow:1}),vscpp(Ai,{priority:750,chatVariables:p}),vscpp(Tx.UserMessage,{priority:900,flexGrow:2,flexReserve:r.endpoint.modelMaxPromptTokens/3},vscpp(Pc,{documentData:l,createReplyInterpreter:f,tokenBudget:"usePromptSizingBudget"}),vscpp(Rt,{name:"userPrompt"},vscpp(Oo,{chatVariables:p,query:u}),vscpp("br",null),"The rewritten markdown content that would fit at ",l.placeholderText," wrapped with ",Rc.FenceSequence," is:")))}};cC=E([v(1,Te),v(2,H)],cC);var Cx=q(Ve());var lC=class extends Cx.PromptElement{constructor(t,r,o,s,a){super(t);this._ignoreService=r;this._parserService=o;this._experimentationService=s;this._configurationService=a}async render(t,r){let o=this.props.documentContext,s=o.document,a=s.languageId;if(an(s.uri))throw ur("InlineChatGenerateCodePrompt should not be used with a notebook!");if(a==="markdown")throw ur("InlineChatGenerateCodePrompt should not be used with a markdown document!");if(await this._ignoreService.isCopilotIgnored(s.uri))return vscpp("ignoredFiles",{value:[s.uri]});let{query:l,history:u,chatVariables:d}=this.props.promptContext,p=this._configurationService.getExperimentBasedConfig(le.ProjectLabelsInline,this._experimentationService),f=await lu.create(this._parserService,s,o.fileIndentInfo,o.wholeRange,1),m=h=>h.createReplyInterpreter(Cs.Mute,1,r.endpoint.family!=="gpt-3.5-turbo"?h.insertStreaming:h.insertOrReplaceStreaming,Zi.createCodeBlockClassifier(),g=>g.value.trim()!==f.placeholderText);return vscpp(vscppf,null,vscpp(Cx.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You are a world class expert in programming, and especially good at ",a,".",vscpp("br",null),vscpp(Ze,null)),vscpp(Nt,{inline:!0,historyPriority:700,history:u,passPriority:!0},vscpp(Tt,{priority:1e3},"Source code is always contained in ``` blocks.",vscpp("br",null),"The user needs help to write some new code.",vscpp("br",null),f.hasContent&&vscpp(vscppf,null,"The user includes existing code and marks with ",f.placeholderText," where the new code should go.",vscpp("br",null)),f.hasContent&&vscpp(vscppf,null,'DO NOT include the text "',f.placeholderText,'" in your reply.',vscpp("br",null)),f.hasContent&&vscpp(vscppf,null,"DO NOT repeat any code from the user in your reply.",vscpp("br",null)),!f.hasContent&&vscpp(vscppf,null,"Your must generate a code block surrounded with ``` that will be used in a new file",vscpp("br",null)))),p&&vscpp(Xi,{priority:600}),vscpp(Cx.UserMessage,{priority:725},vscpp(sn,{languageId:a}),vscpp(kc,{context:s})),vscpp(tn,{priority:750,endpoint:r.endpoint,promptContext:this.props.promptContext,flexGrow:1}),vscpp(Ai,{priority:750,chatVariables:d}),vscpp(Cx.UserMessage,{priority:900,flexGrow:2,flexReserve:r.endpoint.modelMaxPromptTokens/3},vscpp(Pc,{flexGrow:1,tokenBudget:"usePromptSizingBudget",documentData:f,createReplyInterpreter:m}),vscpp(Rt,{name:"userPrompt"},vscpp(Oo,{chatVariables:d,query:l}),vscpp("br",null)),f.hasContent&&vscpp(vscppf,null,"The code that would fit at ",f.placeholderText," with ``` is:")))}};lC=E([v(1,Te),v(2,ft),v(3,fn),v(4,be)],lC);var Ys=q(Ve());var uC=re("INotebookService");function S0(n){return an(n)?n.path.endsWith(".ipynb"):!1}function Jbe(n,e){return n.notebookDocuments.find(r=>r.uri.fsPath===e.fsPath)?.notebookType}var NX={core:1e3,context:800,runtimeCore:600,history:500,other:100};var Ud=q(Ve());var hi=q(Ve());function Zbe(n,e,t,r,o,s){if(t.start.line!==t.end.line&&t.end.character===0){let p=n.lineAt(t.end.line-1);t=new Me(t.start,new Sn(t.end.line-1,p.text.length))}else if(e.end.character===0&&e.end.line!==e.start.line&&(t.start.line===e.start.line&&t.start.character===0&&t.end.line===e.end.line&&t.end.character===n.lineAt(t.end.line).text.length||t.isEqual(e))){let p=n.lineAt(t.end.line-1);t=new Me(t.start,new Sn(t.end.line-1,p.text.length))}let a=new ba(s,n,o,"ed8c6549bwf9"),c=new ba(s,n,o,"abpxx6d04wxr"),l=new ba(s,n,o,"be15d9bcejpp"),u=()=>(c.trim(),a.trim(e),l.trim(),{language:o,above:c,range:a,below:l});for(let p=t.end.line;p>=t.start.line;p--)if(!a.prependLine(p))return u();let d={aboveLineIndex:t.start.line-1,belowLineIndex:t.end.line+1,minimumLineIndex:Math.max(0,r.start.line),maximumLineIndex:Math.min(n.lineCount-1,r.end.line)};return LX(d,c,l),u()}function LX(n,e,t){let r=n.aboveLineIndex,o=!0,s=n.belowLineIndex,a=!0;for(let c=0;c<100&&(o||a);c++)!o||a&&c%4===3?s<=n.maximumLineIndex&&t.appendLine(s)?s++:a=!1:r>=n.minimumLineIndex&&e.prependLine(r)?r--:o=!1;e.isComplete=r<n.minimumLineIndex,t.isComplete=s>n.maximumLineIndex}function k8(n,e,t,r,o){let s={...r,aboveCells:[],belowCells:[]},a,c,l;if(t.document.uri.scheme==="vscode-notebook-cell"){a=e.notebookDocuments.find(I=>I.uri.fsPath===t.document.uri.fsPath&&I.getCells().find(S=>S.document.uri.toString()===t.document.uri.toString()));let x=a?.getCells().findIndex(I=>I.document.uri.toString()===t.document.uri.toString());if(x===void 0||x===-1)return s;c=x-1,l=x+1}else{if(n.activeNotebookEditor?.notebook.uri.path!==t.document.uri.path)return s;let x=n.activeNotebookEditor;a=x?.notebook;let I=x.selection.start;c=I-1,l=I}if(!a)return s;let{language:u,above:d,range:p,below:f}=r,m=d.lines.length+p.lines.length+f.lines.length,h=[],g=[],y=()=>(h.forEach(x=>x.trim()),g.forEach(x=>x.trim()),{language:u,aboveCells:h,belowCells:g}),b=!0,_=!0;for(let x=m;x<100&&(b||_);x++)if(b)if(c>=0){let S=a.cellAt(c).document,w=Bt.create(S),R=new ba(o,w,Rr(w),"CELL:"+w.uri.fragment);for(let k=0;k<w.lineCount;k++)R.appendLine(k);h.unshift(R),c--}else b=!1;else if(l<a.cellCount){let S=a.cellAt(l).document,w=Bt.create(S),R=new ba(o,w,Rr(w),"CELL:"+w.uri.fragment);for(let k=0;k<w.lineCount;k++)R.appendLine(k);g.push(R),l++}else _=!1;return y()}var P8=q(Ve());var I0="---",Pn;(o=>(o.FILEPATH=I0+"FILEPATH",o.FIND=I0+"FIND",o.REPLACE=I0+"REPLACE",o.COMPLETE=I0+"COMPLETE"))(Pn||={});var Il=class extends P8.PromptElement{render(){return vscpp(vscppf,null,"When proposing a code change, provide one or more modifications in the following format:",vscpp("br",null),"Each modification consist of three sections headed by `",Pn.FILEPATH,"`, `",Pn.FIND,"` and `",Pn.REPLACE,"`.",vscpp("br",null),"After ",Pn.FILEPATH," add the path to the file that needs to be changed.",vscpp("br",null),"After ",Pn.FIND," add a code block containing a section of the program that will be replaced.",vscpp("br",null),"Add multiple lines so that a find tool can find and identify a section of the programm. Start and end with a line that will not be modified. ",vscpp("br",null),"Include all comments and empty lines exactly as they appear in the original source code. Do not abreviate any line or summarize the code with `...`. ",vscpp("br",null),"After ",Pn.REPLACE," add a code block with the updated version of the original code in the find section. Maintain the same indentation and code style as in the original code.",vscpp("br",null),"After all modifications, add ",Pn.COMPLETE,".",vscpp("br",null))}},xh=class extends P8.PromptElement{render(){return vscpp(vscppf,null,this.props.fileName?Fd(this.props.fileName)+`
`:"","```",this.props.language??"",vscpp("br",null),this.props.code.join(`
`),vscpp("br",null),"```")}},uu=class extends P8.PromptElement{render(){return vscpp(vscppf,null,this.props.changes.map(e=>vscpp(vscppf,null,Fd(e.fileName),vscpp("br",null),Pn.FIND,vscpp("br",null),"```",vscpp("br",null),e.find.join(`
`),vscpp("br",null),"```",vscpp("br",null),Pn.REPLACE,vscpp("br",null),"```",vscpp("br",null),e.replace.join(`
`),vscpp("br",null),"```",vscpp("br",null))),Pn.COMPLETE)}};function Fd(n){return`${Pn.FILEPATH} ${L1(n)}`}function r_e(n){return`${I0}${n}`}function R8(n){return!n.match(/\S/)}function FX(n,e,t,r){let o=0;for(;o<e.length&&R8(e[o]);)o++;if(o===e.length){let d=Zv(n,4,!1),p=n.length>0?t_e(n,0,n.length-1,d.tabSize):0,f=e_e(t,p,d);return e0.insert(r,f)}let s=e[o],a=OX(s),c,l=0,u=o;e:for(;l<n.length;){for(;l<n.length&&!n_e(n[l],s,a);)l++;if(l===n.length)return c??{message:"First find line not found",label:"invalid patch",severity:"error"};let d=l,p=-1;for(;l<n.length&&u<e.length;){let f=n[l];if(OX(f)===f.length){l++;continue}let h=e[u],g=OX(h);if(g===h.length){u++;continue}if(n_e(f,h,g))p=l,l++,u++;else{l=d+1,u=o,h.indexOf("...")!==-1?c={message:"Find contains ellipses",label:"patch lazy",severity:"error"}:WYe(f)?c={message:"Find not matching a comment",label:"patch no comment",severity:"error"}:c={message:`Find line ${u} does not match line ${l}`,label:"invalid patch",severity:"error"};continue e}}for(;u<e.length&&R8(e[u]);)u++;if(u===e.length&&d!==-1&&p!==-1){let f=Zv(n,4,!1),m=t_e(n,d,p,f.tabSize),h=e_e(t,m,f);return e0.replace(d,p+1,h,p===n.length-1)}}return c??{message:"Not all lines of find found",label:"invalid patch",severity:"error"}}function i_e(n){return n===32||n===9}function WYe(n){return n.match(/^\s*(\/\/|\/\*|#)/)!==null}function e_e(n,e,t){let r,o=0;for(r=0;r<n.length&&R8(n[r]);r++);if(r===n.length)return[];for(o=n.length;o>r&&R8(n[o-1]);o--);if(r===o)return[];let s=Number.MAX_SAFE_INTEGER,a=[];for(let l=r;l<o;l++){let u=n[l],d=o_e(u,t.tabSize);d.length!==u.length&&d.level<s&&(s=d.level),a.push(d)}let c=[];for(let l=r;l<o;l++){let u=n[l],{level:d,length:p}=a[l-r],f=Math.max(0,e+d-s),m=t.insertSpaces?" ".repeat(t.tabSize*f):"	".repeat(f);c.push(m+u.substring(p))}return c}function OX(n){let e=0;for(;e<n.length&&i_e(n.charCodeAt(e));)e++;return e}function t_e(n,e,t,r){let o=Number.MAX_SAFE_INTEGER;for(let s=e;s<=t;s++){let a=n[s],c=o_e(a,r);c.length!==a.length&&c.level<o&&(o=c.level)}return o!==Number.MAX_SAFE_INTEGER?o:0}function o_e(n,e){let t=0,r=0,o=0,s=0,a=n.length;for(;o<a;){let c=n.charCodeAt(o);if(c===32)t++,t===e&&(r++,t=0,s=o+1);else if(c===9)r++,t=0,s=o+1;else break;o++}return{level:r,length:s}}function n_e(n,e,t){let r=n.length-1,o=e.length-1;for(;r>=0&&o>=t&&n.charCodeAt(r)===e.charCodeAt(o);)r--,o--;if(o>=t)return!1;for(;r>=0&&i_e(n.charCodeAt(r));)r--;return r<0}function s_e(n){let e=new Set;for(let t of c_e(MX(n)))t.marker===Pn.FILEPATH&&e.add(t.content.join(`
`).trim());return[...e]}function T0(){return{getFirstParagraph(n){let e=[];for(let t of MX(n)){if(t.length===0||t.startsWith(I0))break;e.push(t)}return e.join(`
`)},process(n,e,t,r=0){let o,s,a=[],c=[],l=[],u=[],d=[],p=[],f=new Set,m=[],h=[];e:for(let g of c_e(MX(n)))switch(g.marker){case void 0:m=g.content;break;case Pn.FILEPATH:s=g.content.join(`
`).trim();break;case Pn.FIND:o=g.content;break;case Pn.REPLACE:{g.content&&o&&s&&(l.push({fileName:s,find:o,replace:g.content}),f.add(s));break}case Pn.COMPLETE:h=g.content;break e;default:c.push(g);break}if(l.length===0)return a.push({message:"No patch sections found",label:"no patch",severity:"error"}),{edits:u,contentAfter:h,contentBefore:m,appliedPatches:[],otherSections:c,invalidPatches:d,otherPatches:p,annotations:a};if(t){let g=L1(t.fsPath);f.has(g)||a.push({message:`No patch for input document: ${g}, patches for ${[...f.keys()].join(", ")}`,label:"other file",severity:"warning"}),f.size>1&&a.push({message:`Multiple files modified: ${[...f.keys()].join(", ")}`,label:"multi file",severity:"warning"});let y=[];for(let b of l)b.fileName!==g?p.push(b):y.push(b);l=y}if(l.length!==0){let g=px.fromString(e);for(let y of l){if(Qm(y.find,y.replace)){a.push({message:"Patch is a no-op",label:"patch no op",severity:"error"}),d.push(y);continue}y.find.length<=1&&a.push({message:`Small patch: ${Math.min(y.find.length)}`,label:"patch small",severity:"warning"});let b=FX(g,KD(y.find),KD(y.replace),r);b instanceof e0?KYe(u,b.toTextEdit())||(a.push({message:"Overlapping edits",label:"overlapping edit",severity:"error"}),d.push(y)):(a.push(b),d.push(y))}}return{edits:u,appliedPatches:l,otherSections:c,invalidPatches:d,otherPatches:p,annotations:a,contentBefore:m,contentAfter:h}}}}function KYe(n,e){for(let t=0;t<n.length;t++){let r=n[t];if(e.range.end.isBeforeOrEqual(r.range.start))return n.splice(t,0,e),!0;if(e.range.start.isBefore(r.range.end))return!1}return n.push(e),!0}function KD(n){let e=[],t,r=/^`{3,}/;for(let o of n){let s=o.match(r);if(s)if(t){if(s[0]===t)return e;e.push(o)}else t=s[0];else t&&e.push(o)}return n}async function*a_e(n){let e,t=[],r=nr.map(n,a=>a.delta.text),o=new Xp(r[Symbol.asyncIterator]());for(;!o.endOfStream;){let a=await o.readLineIncludingLF(),c;if(a.startsWith(I0)){a.startsWith(Pn.FILEPATH)?c=Pn.FILEPATH:a.startsWith(Pn.FIND)?c=Pn.FIND:a.startsWith(Pn.REPLACE)?c=Pn.REPLACE:a.startsWith(Pn.COMPLETE)?c=Pn.COMPLETE:c=s(a),yield{marker:e,content:t},t=[s(a.substring(c.length))],e=c;continue}t.push(s(a))}yield{marker:e,content:t};function s(a){return a.endsWith(`
`)?a.slice(0,-1):a}}function*c_e(n){let e,t=[];for(let r of n){let o;if(r.startsWith(I0)){r.startsWith(Pn.FILEPATH)?o=Pn.FILEPATH:r.startsWith(Pn.FIND)?o=Pn.FIND:r.startsWith(Pn.REPLACE)?o=Pn.REPLACE:r.startsWith(Pn.COMPLETE)?o=Pn.COMPLETE:o=r,yield{marker:e,content:t},t=[r.substring(o.length)],e=o;continue}t.push(r)}yield{marker:e,content:t}}function*MX(n){let e=0,t=0;for(;t<n.length;){let r=n.charCodeAt(t);r===13||r===10?(yield n.substring(e,t),t++,r===13&&n.charCodeAt(t)===10&&t++,e=t):t++}e<n.length&&(yield n.substring(e))}var A8=class extends hi.PromptElement{render(e,t){if(!an(this.props.documentContext.document.uri))throw ur("InlineChatNotebookSelectionRenderer should be used only with a notebook!");let r=S0(this.props.documentContext.document.uri),{projectedDocument:o,aboveCells:s,belowCells:a,ignoreExample:c}=this.props,l=s||[],u=a||[],d=this.props.documentContext.language;return vscpp(vscppf,null,r?vscpp(vscppf,null,(l.length>0||u.length>0)&&vscpp(UX,{documentContext:this.props.documentContext,aboveCells:l,belowCells:u,ignoreExample:c}),d.languageId==="markdown"?vscpp(HX,{cellIndex:l.length,document:this.props.document,projectedDocument:o,language:d,diagnostics:this.props.diagnostics,selection:this.props.selection,adjustedSelection:this.props.adjustedSelection,isSummarized:this.props.isSummarized,selectedLinesContent:this.props.selectedLinesContent}):vscpp(VX,{cellIndex:l.length,document:this.props.document,projectedDocument:o,language:d,diagnostics:this.props.diagnostics,selection:this.props.selection,adjustedSelection:this.props.adjustedSelection,isSummarized:this.props.isSummarized,selectedLinesContent:this.props.selectedLinesContent})):vscpp(vscppf,null,vscpp(C0,{documentContext:this.props.documentContext}),vscpp(dC,{documentContext:this.props.documentContext,aboveCells:l,belowCells:u}),d.languageId==="markdown"?vscpp(qX,{cellIndex:l.length,document:this.props.document,projectedDocument:o,language:d,diagnostics:this.props.diagnostics,selection:this.props.selection,adjustedSelection:this.props.adjustedSelection,isSummarized:this.props.isSummarized,selectedLinesContent:this.props.selectedLinesContent}):vscpp(jX,{cellIndex:l.length,document:this.props.document,projectedDocument:o,language:d,diagnostics:this.props.diagnostics,selection:this.props.selection,adjustedSelection:this.props.adjustedSelection,isSummarized:this.props.isSummarized,selectedLinesContent:this.props.selectedLinesContent})))}},UX=class extends hi.PromptElement{render(e,t){if(!an(this.props.documentContext.document.uri))throw ur("InlineChatNotebookSelectionRenderer should be used only with a notebook!");let{aboveCells:r,belowCells:o,ignoreExample:s}=this.props,a=this.props.documentContext.language;return vscpp(vscppf,null,(r.length>0||o.length>0)&&vscpp(hi.UserMessage,null,"I am working on a Jupyter notebook.",vscpp("br",null),"This Jupyter Notebook already contains multiple cells.",vscpp("br",null),"The content of cells are listed below, each cell starts with CELL INDEX and a code block started with ```",a.languageId,vscpp("br",null),"Each cell is a block of code that can be executed independently.",vscpp("br",null),"Since it is Jupyter Notebook, if a module is already imported in a cell, it can be used in other cells as well.",vscpp("br",null),"For the same reason, if a variable is defined in a cell, it can be used in other cells as well.",vscpp("br",null),"We should not repeat the same import or variable definition in multiple cells, unless we want to overwrite the previous definition.",vscpp("br",null),"Do not generate CELL INDEX in your answer, it is only used to help you understand the context.",vscpp("br",null),vscpp("br",null),!s&&vscpp(vscppf,null,"Below you will find a set of examples of what you should respond with. Please follow the exmaples on how to avoid repeating code.",vscpp("br",null),"## Examples starts here",vscpp("br",null),"Here are the cells in this Jupyter Notebook:",vscpp("br",null),"`CELL INDEX: 0",vscpp("br",null),"```python",vscpp("br",null),"import pandas as pd",vscpp("br",null),vscpp("br",null),"# create a dataframe with sample data",vscpp("br",null),"df = pd.DataFrame({'Name': ['Alice', 'Bob', 'Charlie'], 'Age': [25, 30, 35], 'Gender': ['F', 'M', 'M']})",vscpp("br",null),"print(df)",vscpp("br",null),"```",vscpp("br",null),"---------------------------------",vscpp("br",null),"USER:",vscpp("br",null),"Now I create a new cell in this Jupyter Notebook document at index 1.",vscpp("br",null),"I have the following code open in this cell, starting from line 1 to line 1.",vscpp("br",null),"```python",vscpp("br",null),"```",vscpp("br",null),"---------------------------------",vscpp("br",null),"USER:",vscpp("br",null),"plot the data frame",vscpp("br",null),vscpp("br",null),"---------------------------------",vscpp("br",null),"Assistant Answer",vscpp("br",null),"---------------------------------",vscpp("br",null),"To plot the dataframe, we can use the `plot()` method of pandas dataframe.",vscpp("br",null),vscpp("br",null),"---FILEPATH Untitled-1",vscpp("br",null),"---FIND",vscpp("br",null),"---REPLACE",vscpp("br",null),"```python",vscpp("br",null),"df.plot(x='Name', y='Age', kind='bar')",vscpp("br",null),"```",vscpp("br",null),"---COMPLETE",vscpp("br",null),"## Example ends here",vscpp("br",null)),r.length>0&&vscpp(E0,{cells:r,title:`Here are the cells in this Jupyter Notebook:
`}),o.length>0&&vscpp(E0,{cells:o,cellIndexDelta:r.length+1,title:`Here are the cells below the current cell that I am editing in this Jupyter Notebook:
`})))}},l_e=[{viewType:"polyglot-notebook",exampleCells:[{lan:"markdown",source:"Samples"},{lan:"csharp",source:"using Microsoft.Data.Analysis;"},{lan:"csharp",source:`DateTimeDataFrameColumn dateTimes = new DateTimeDataFrameColumn("DateTimes");
 Int32DataFrameColumn ints = new Int32DataFrameColumn("Ints", 6);
 StringDataFrameColumn strings = new StringDataFrameColumn("Strings", 6);`},{lan:"csharp",source:'dateTimes.Append(DateTime.Parse("2019/01/01"));'}]},{viewType:"sql-notebook",exampleCells:[{lan:"sql",source:"SELECT * FROM users;"}]},{viewType:"node-notebook",exampleCells:[{lan:"javascript",source:'console.log("Hello World");'},{lan:"javascript",source:"const {display} = require('node-kernel');"},{lan:"markdown",source:"# Plain text output"},{lan:"javascript",source:"display.text('Hello World');"}]},{viewType:"sas-notebook",exampleCells:[{lan:"sas",source:"proc print data=sashelp.class; run;"},{lan:"sas",source:`data race;
pr = probnorm(-15/sqrt(325));
run;

proc print data=race;
var pr;
run;
`}]},{viewType:"http-notebook",exampleCells:[{lan:"http",source:"GET https://httpbin.org/get"},{lan:"http",source:"POST https://httpbin.org/post"}]},{viewType:"powerbi-notebook",exampleCells:[{lan:"markdown",source:"# Get Groups"},{lan:"powerbi-api",source:"GET /groups"},{lan:"powerbi-api",source:`%dax /groups/ccce57d1-10af-1234-1234-665f8bbd8458/datasets/51ba6d4b-1234-1234-8635-a7d743a5ea89
EVALUATE INFO.TABLES()
This`}]},{viewType:"wolfram-language-notebook",exampleCells:[{lan:"wolfram",source:"Plot[Sin[x], {x, 0, 2 Pi}]"}]},{viewType:"github-issues",exampleCells:[{lan:"github-issues",source:`$vscode=repo:microsoft/vscode
$milestone=milestone:"May 2020"`},{lan:"github-issues",source:"$vscode $milestone is:closed author:@me -assignee:@me label:bug -label:verified"},{lan:"github-issues",source:"$vscode assignee:@me is:open label:freeze-slow-crash-leak"}]},{viewType:"rest-book",exampleCells:[{lan:"rest-book",source:"GET google.com"},{lan:"rest-book",source:`GET https://www.google.com
    ?query="fun"
    &page=2
    User-Agent: rest-book
    Content-Type: application/json`}]}],BX=class extends hi.PromptElement{render(){let e=this.props.viewType,t=l_e.find(o=>o.viewType===this.props.viewType);if(!t)return vscpp(vscppf,null);let{exampleCells:r}=t;return vscpp(hi.UserMessage,null,"Below you will find a set of example cells for a ",e," notebook.",vscpp("br",null),r.map((o,s)=>vscpp(vscppf,null,"CELL INDEX: ",s,":",vscpp("br",null),"```",o.lan,vscpp("br",null),o.source,vscpp("br",null),vscpp("br",null),"```")))}},C0=class extends hi.PromptElement{constructor(t,r){super(t);this.workspaceService=r}render(t,r){if(!an(this.props.documentContext.document.uri))throw ur("InlineChatCustomNotebookInfoRenderer should be used only with a notebook!");let o=Jbe(this.workspaceService,this.props.documentContext.document.uri),s=l_e.find(c=>c.viewType===o),a=s?o:"custom";return vscpp(vscppf,null,vscpp(hi.UserMessage,null,"I am working on a ",a," notebook in VS Code.",vscpp("br",null),a," notebooks in VS Code are documents that contain a mix of rich Markdown, executable code snippets, ",vscpp("br",null),"and accompanying rich output. These are all separated into distinct cells and can be interleaved in any order ",vscpp("br",null),"A ",a," notebook contains multiple cells.",vscpp("br",null)),s&&vscpp(BX,{viewType:s.viewType}))}};C0=E([v(1,Be)],C0);var dC=class extends hi.PromptElement{render(e,t){if(!an(this.props.documentContext.document.uri))throw ur("InlineChatCustomNotebookCellsContextRenderer should be used only with a notebook!");let{aboveCells:r,belowCells:o,documentContext:s}=this.props,a=r||[],c=o||[],l=s.language;return vscpp(vscppf,null,(a.length>0||c.length>0)&&vscpp(hi.UserMessage,null,"The content of cells are listed below, each cell starts with CELL INDEX and a code block started with ```",l.languageId,vscpp("br",null),"Each cell is a block of code that can be executed independently.",vscpp("br",null),"Do not generate CELL INDEX in your answer, it is only used to help you understand the context.",vscpp("br",null),vscpp("br",null),"Below you will find a set of examples of what you should respond with. Please follow the exmaples on how to avoid repeating code.",vscpp("br",null),a.length>0&&vscpp(E0,{cells:a,title:`Here are the cells in this custom notebook:
`}),c.length>0&&vscpp(E0,{cells:c,cellIndexDelta:a.length+1,title:`Here are the cells below the current cell that I am editing in this custom notebook:
`})))}},pC=class extends hi.PromptElement{render(){let{document:e,projectedDocument:t,diagnostics:r,language:o,selection:s,adjustedSelection:a,isSummarized:c,selectedLinesContent:l}=this.props,u=o.languageId==="markdown";return vscpp(vscppf,null,vscpp(Do,null,t.text.length>0?vscpp(vscppf,null,u?vscpp(vscppf,null,"I have the following markdown content in this cell, starting from line 1 to line ",t.lineCount,".",vscpp("br",null)):vscpp(vscppf,null,"I have the following code in this cell, starting from line 1 to line ",t.lineCount,".",vscpp("br",null)),Fd(e.fileName),vscpp("br",null),vscpp(tt,{uri:e.uri,languageId:o.languageId,code:t.text,shouldTrim:!1,isSummarized:c}),vscpp("br",null)):vscpp(vscppf,null,"I am in an empty file:",Fd(e.fileName),vscpp("br",null))),vscpp(Do,null,s.isEmpty?vscpp(vscppf,null,"I have the selection at line ",a.start.line+1,", column ",a.start.character+1,vscpp("br",null)):vscpp(vscppf,null,"I have currently selected from line ",a.start.line+1,", column ",a.start.character+1," to line ",a.end.line+1," column ",a.end.character+1,".",vscpp("br",null))),vscpp(Do,null,l.length&&!r.some(d=>d.range.contains(s))&&vscpp(vscppf,null,"The content of the lines at the selection is",vscpp(tt,{uri:e.uri,languageId:o.languageId,code:l,shouldTrim:!1}),vscpp("br",null))))}},qX=class extends hi.PromptElement{render(){let{cellIndex:e,document:t,projectedDocument:r,diagnostics:o,language:s,selection:a,adjustedSelection:c,isSummarized:l,selectedLinesContent:u}=this.props;return vscpp(vscppf,null,vscpp(hi.UserMessage,null,"Now I create a new cell in this custom Notebook document at index ",this.props.cellIndex,".",vscpp("br",null),"This is a markdown cell. Markdown cell is used to describe and document your workflow.",vscpp("br",null),vscpp(pC,{cellIndex:e,document:t,projectedDocument:r,diagnostics:o,language:s,selection:a,adjustedSelection:c,isSummarized:l,selectedLinesContent:u})))}},jX=class extends hi.PromptElement{render(){let{cellIndex:e,document:t,projectedDocument:r,diagnostics:o,language:s,selection:a,adjustedSelection:c,isSummarized:l,selectedLinesContent:u}=this.props;return vscpp(vscppf,null,vscpp(hi.UserMessage,null,"Now I create a new cell in this custom Notebook document at index ",this.props.cellIndex,".",vscpp("br",null),vscpp(pC,{cellIndex:e,document:t,projectedDocument:r,diagnostics:o,language:s,selection:a,adjustedSelection:c,isSummarized:l,selectedLinesContent:u})))}},YD=class extends hi.PromptElement{render(e,t){if(!an(this.props.documentContext.document.uri))throw ur("InlineChatNotebookSelectionRenderer should be used only with a notebook!");let{aboveCells:r,belowCells:o,ignoreExample:s}=this.props,a=this.props.documentContext.language;return vscpp(vscppf,null,(r.length>0||o.length>0)&&vscpp(hi.UserMessage,null,"I am working on a Jupyter notebook.",vscpp("br",null),"This Jupyter Notebook already contains multiple cells.",vscpp("br",null),"The content of cells are listed below, each cell starts with CELL INDEX and a code block started with ```",a.languageId,vscpp("br",null),"Each cell is a block of code that can be executed independently.",vscpp("br",null),"Since it is Jupyter Notebook, if a module is already imported in a cell, it can be used in other cells as well.",vscpp("br",null),"For the same reason, if a variable is defined in a cell, it can be used in other cells as well.",vscpp("br",null),"We should not repeat the same import or variable definition in multiple cells, unless we want to overwrite the previous definition.",vscpp("br",null),"Do not generate CELL INDEX in your answer, it is only used to help you understand the context.",vscpp("br",null),vscpp("br",null),!s&&vscpp(vscppf,null,"Below you will find a set of examples of what you should respond with. Please follow the exmaples on how to avoid repeating code.",vscpp("br",null),"## Examples starts here",vscpp("br",null),"Here are the cells in this Jupyter Notebook:",vscpp("br",null),"`CELL INDEX: 0",vscpp("br",null),"```python",vscpp("br",null),"import pandas as pd",vscpp("br",null),vscpp("br",null),"# create a dataframe with sample data",vscpp("br",null),"df = pd.DataFrame({'Name': ['Alice', 'Bob', 'Charlie'], 'Age': [25, 30, 35], 'Gender': ['F', 'M', 'M']})",vscpp("br",null),"print(df)",vscpp("br",null),"```",vscpp("br",null),"---------------------------------",vscpp("br",null),"USER:",vscpp("br",null),"Now I create a new cell in this Jupyter Notebook document at index 1.",vscpp("br",null),"In this new cell, I am working with the following code:",vscpp("br",null),"```python",vscpp("br",null),"```",vscpp("br",null),"---------------------------------",vscpp("br",null),"USER:",vscpp("br",null),"plot the data frame",vscpp("br",null),vscpp("br",null),"---------------------------------",vscpp("br",null),"ChatGPT Answer",vscpp("br",null),"---------------------------------",vscpp("br",null),"To plot the dataframe, we can use the `plot()` method of pandas dataframe. Here's the code:",vscpp("br",null),vscpp("br",null),"```python",vscpp("br",null),"df.plot(x='Name', y='Age', kind='bar')",vscpp("br",null),"```",vscpp("br",null),"## Example ends here",vscpp("br",null)),r.length>0&&vscpp(E0,{cells:r,title:`Here are the cells in this Jupyter Notebook:
`}),o.length>0&&vscpp(E0,{cells:o,cellIndexDelta:r.length+1,title:`Here are the cells below the current cell that I am editing in this Jupyter Notebook:
`})))}},HX=class extends hi.PromptElement{render(){let{cellIndex:e,document:t,projectedDocument:r,diagnostics:o,language:s,selection:a,adjustedSelection:c,isSummarized:l,selectedLinesContent:u}=this.props;return vscpp(vscppf,null,vscpp(hi.UserMessage,null,"Now I create a new cell in this Jupyter Notebook document at index ",this.props.cellIndex,".",vscpp("br",null),"This is a markdown cell. Markdown cell is used to describe and document your workflow.",vscpp("br",null),vscpp(pC,{cellIndex:e,document:t,projectedDocument:r,diagnostics:o,language:s,selection:a,adjustedSelection:c,isSummarized:l,selectedLinesContent:u})))}},VX=class extends hi.PromptElement{render(){let{cellIndex:e,document:t,projectedDocument:r,diagnostics:o,language:s,selection:a,adjustedSelection:c,isSummarized:l,selectedLinesContent:u}=this.props;return vscpp(vscppf,null,vscpp(hi.UserMessage,null,"Now I create a new cell in this Jupyter Notebook document at index ",this.props.cellIndex,".",vscpp("br",null),vscpp(pC,{cellIndex:e,document:t,projectedDocument:r,diagnostics:o,language:s,selection:a,adjustedSelection:c,isSummarized:l,selectedLinesContent:u})))}},E0=class extends hi.PromptElement{render(){return vscpp(vscppf,null,this.props.title,vscpp("br",null),this.props.cells.map((e,t)=>vscpp(GX,{index:t+(this.props.cellIndexDelta??0),cell:e})))}},GX=class extends hi.PromptElement{render(){return vscpp(vscppf,null,"CELL INDEX: ",this.props.index,vscpp("br",null),"```",this.props.cell.language.languageId,vscpp("br",null),this.props.cell.lines.join(`
`),vscpp("br",null),"```")}};function zX(n,e,t,r,o){let s=n*4,a=new Qp(s),c=Zbe(e.document,e.selection,t,new Me(0,0,e.document.lineCount,0),e.language,a);return k8(r,o,e,c,a)}var fC=class extends Ud.PromptElement{constructor(t,r,o){super(t);this.tabsAndEditorsService=r;this.workspaceService=o}async prepare(){let{document:t,wholeRange:r}=this.props.documentContext;return{wholeRange:t.validateRange(r)}}render(t,r){if(!an(this.props.documentContext.document.uri))throw ur("InlineChatNotebookSelection should be used only with a notebook!");let{wholeRange:o}=t,s=zX(r.endpoint.modelMaxPromptTokens/3,this.props.documentContext,o,this.tabsAndEditorsService,this.workspaceService),a=this.props.documentContext.document,c=S0(this.props.documentContext.document.uri),{hasCodeWithoutSelection:l,codeWithoutSelection:u,codeSelected:d}=this.props,{aboveCells:p,belowCells:f}=s,m=p||[],h=f||[],g=this.props.documentContext.language,y=g.languageId==="markdown",b=l||d.length>0;return vscpp(vscppf,null,c?vscpp(vscppf,null,(m.length>0||h.length>0)&&vscpp(YD,{documentContext:this.props.documentContext,aboveCells:m,belowCells:h}),vscpp(Ud.UserMessage,null,y?vscpp(vscppf,null,b&&vscpp(vscppf,null,"Now I edit a markdown cell in this Jupyter Notebook document at index ",m.length,".",vscpp("br",null)),!b&&vscpp(vscppf,null,"Now I create a new markdown cell in this Jupyter Notebook document at index ",m.length,".",vscpp("br",null)),"This is a markdown cell. Markdown cell is used to describe and document your workflow.",vscpp("br",null),l&&vscpp(vscppf,null,vscpp(tt,{uri:a.uri,languageId:g.languageId,code:u,shouldTrim:!1}),vscpp("br",null)),l&&vscpp(vscppf,null,"The $SELECTION_PLACEHOLDER$ code is:",vscpp("br",null)),vscpp(tt,{uri:a.uri,languageId:g.languageId,code:d,shouldTrim:!1})):vscpp(vscppf,null,b&&vscpp(vscppf,null,"Now I edit a cell in this Jupyter Notebook document at index ",m.length,".",vscpp("br",null)),!b&&vscpp(vscppf,null,"Now I create a new cell in this Jupyter Notebook document at index ",m.length,".",vscpp("br",null)),l&&vscpp(vscppf,null,vscpp(tt,{uri:a.uri,languageId:g.languageId,code:u,shouldTrim:!1}),vscpp("br",null)),d.length>0&&vscpp(vscppf,null,"The $SELECTION_PLACEHOLDER$ code is:",vscpp("br",null)),vscpp(tt,{uri:a.uri,languageId:g.languageId,code:d,shouldTrim:!1})))):vscpp(vscppf,null,vscpp(C0,{documentContext:this.props.documentContext}),vscpp(dC,{documentContext:this.props.documentContext,aboveCells:m,belowCells:h}),vscpp(Ud.UserMessage,null,y?vscpp(vscppf,null,l&&vscpp(vscppf,null,"Now I edit a markdown cell in this custom Notebook document at index ",m.length,".",vscpp("br",null)),!l&&vscpp(vscppf,null,"Now I create a new markdown cell in this custom Notebook document at index ",m.length,".",vscpp("br",null)),"This is a markdown cell. Markdown cell is used to describe and document your workflow.",vscpp("br",null),l&&vscpp(vscppf,null,vscpp(tt,{uri:a.uri,languageId:g.languageId,code:u,shouldTrim:!1}),vscpp("br",null)),l&&vscpp(vscppf,null,"The $SELECTION_PLACEHOLDER$ code is:",vscpp("br",null)),vscpp(tt,{uri:a.uri,languageId:g.languageId,code:d,shouldTrim:!1})):vscpp(vscppf,null,l&&vscpp(vscppf,null,"Now I edit a cell in this custom Notebook document at index ",m.length,".",vscpp("br",null)),!l&&vscpp(vscppf,null,"Now I create a new cell in this custom Notebook document at index ",m.length,".",vscpp("br",null)),l&&vscpp(vscppf,null,vscpp(tt,{uri:a.uri,languageId:g.languageId,code:u,shouldTrim:!1}),vscpp("br",null)),l&&vscpp(vscppf,null,"The $SELECTION_PLACEHOLDER$ code is:",vscpp("br",null)),vscpp(tt,{uri:a.uri,languageId:g.languageId,code:d,shouldTrim:!1})))))}};fC=E([v(1,$t),v(2,Be)],fC);var mC=class extends Ud.PromptElement{constructor(t,r,o,s,a,c){super(t);this.configurationService=r;this.notebookService=o;this.tabsAndEditorsService=s;this.experimentationService=a;this.workspaceService=c}async prepare(){let{document:t,wholeRange:r}=this.props.documentContext,o=this.experimentationService.getTreatmentVariable("vscode","copilotchat.notebookSummary")||this.configurationService.getConfig(le.NotebookSummaryExperimentEnabled),s;return o&&this.tabsAndEditorsService.activeNotebookEditor?.notebook&&this.tabsAndEditorsService.activeNotebookEditor?.notebook.uri.path===t.uri.path&&(s=this.notebookService.getCellExecutions(this.tabsAndEditorsService.activeNotebookEditor.notebook.uri)),{wholeRange:t.validateRange(r),executedCells:s}}render(t,r){if(!an(this.props.documentContext.document.uri))throw ur("InlineChatNotebookSelection should be used only with a notebook!");let{wholeRange:o}=t,s=zX(r.endpoint.modelMaxPromptTokens/3,this.props.documentContext,o,this.tabsAndEditorsService,this.workspaceService),a=this.props.documentContext.document,c=S0(this.props.documentContext.document.uri),{hasContent:l,code:u}=this.props,{aboveCells:d,belowCells:p}=s,f=d||[],m=p||[],h=this.props.documentContext.language,g=h.languageId==="markdown",y=t.executedCells||[];return vscpp(vscppf,null,c?vscpp(vscppf,null,y.length>0&&vscpp($X,{documentContext:this.props.documentContext,executedCells:y}),y.length===0&&(f.length>0||m.length>0)&&vscpp(YD,{documentContext:this.props.documentContext,aboveCells:f,belowCells:m}),vscpp(Ud.UserMessage,null,g?vscpp(vscppf,null,l&&vscpp(vscppf,null,"Now I edit a markdown cell in this Jupyter Notebook document at index ",f.length,".",vscpp("br",null)),!l&&vscpp(vscppf,null,"Now I create a new markdown cell in this Jupyter Notebook document at index ",f.length,".",vscpp("br",null)),"This is a markdown cell. Markdown cell is used to describe and document your workflow.",vscpp("br",null),l&&vscpp(vscppf,null,vscpp(tt,{uri:a.uri,languageId:h.languageId,code:u,shouldTrim:!1}),vscpp("br",null))):vscpp(vscppf,null,l&&vscpp(vscppf,null,"Now I edit a cell in this Jupyter Notebook document at index ",f.length,".",vscpp("br",null)),!l&&vscpp(vscppf,null,"Now I create a new cell in this Jupyter Notebook document at index ",f.length,".",vscpp("br",null)),l&&vscpp(vscppf,null,vscpp(tt,{uri:a.uri,languageId:h.languageId,code:u,shouldTrim:!1}),vscpp("br",null))))):vscpp(vscppf,null,vscpp(C0,{documentContext:this.props.documentContext}),vscpp(dC,{documentContext:this.props.documentContext,aboveCells:f,belowCells:m}),vscpp(Ud.UserMessage,null,g?vscpp(vscppf,null,l&&vscpp(vscppf,null,"Now I edit a markdown cell in this custom Notebook document at index ",f.length,".",vscpp("br",null)),!l&&vscpp(vscppf,null,"Now I create a new markdown cell in this custom Notebook document at index ",f.length,".",vscpp("br",null)),"This is a markdown cell. Markdown cell is used to describe and document your workflow.",vscpp("br",null),l&&vscpp(vscppf,null,vscpp(tt,{uri:a.uri,languageId:h.languageId,code:u,shouldTrim:!1}),vscpp("br",null))):vscpp(vscppf,null,l&&vscpp(vscppf,null,"Now I edit a cell in this custom Notebook document at index ",f.length,".",vscpp("br",null)),!l&&vscpp(vscppf,null,"Now I create a new cell in this custom Notebook document at index ",f.length,".",vscpp("br",null)),l&&vscpp(vscppf,null,vscpp(tt,{uri:a.uri,languageId:h.languageId,code:u,shouldTrim:!1}),vscpp("br",null))))))}};mC=E([v(1,be),v(2,uC),v(3,$t),v(4,fn),v(5,Be)],mC);var $X=class extends Ud.PromptElement{render(e,t){if(!an(this.props.documentContext.document.uri))throw ur("InlineChatJupyterNotebookCellSummaryContextRenderer should be used only with a notebook!");let r=this.props.documentContext.language,o=this.props.executedCells||[];return vscpp(vscppf,null,vscpp(Ud.UserMessage,null,"I am working on a Jupyter notebook.",vscpp("br",null),"Users have executed the following cells in this notebook",vscpp("br",null),"Each cell contains a code block started with ```",r.languageId,vscpp("br",null),"Since it is Jupyter Notebook, if a module is already imported in a cell, it can be used in other cells as well.",vscpp("br",null),"For the same reason, if a variable is defined in a cell, it can be used in other cells as well.",vscpp("br",null),"We should not repeat the same import or variable definition in multiple cells, unless we want to overwrite the previous definition.",vscpp("br",null),"Do not generate CELL INDEX in your answer, it is only used to help you understand the context.",vscpp("br",null),vscpp("br",null),"Below you will find a set of examples of what you should respond with. Please follow the exmaples on how to avoid repeating code.",vscpp("br",null),"## Examples starts here",vscpp("br",null),"Here are the executed cells in this Jupyter Notebook:",vscpp("br",null),"```python",vscpp("br",null),"import pandas as pd",vscpp("br",null),vscpp("br",null),"df = pd.DataFrame({'Name': ['Alice', 'Bob', 'Charlie'], 'Age': [25, 30, 35], 'Gender': ['F', 'M', 'M']})",vscpp("br",null),"print(df)",vscpp("br",null),"```",vscpp("br",null),"---------------------------------",vscpp("br",null),"USER:",vscpp("br",null),"Now I create a new cell in this Jupyter Notebook document at index 1.",vscpp("br",null),"USER:",vscpp("br",null),"plot the data frame",vscpp("br",null),vscpp("br",null),"---------------------------------",vscpp("br",null),"ChatGPT Answer",vscpp("br",null),"---------------------------------",vscpp("br",null),"To plot the dataframe, we can use the `plot()` method of pandas dataframe. Here's the code:",vscpp("br",null),vscpp("br",null),"```python",vscpp("br",null),"df.plot(x='Name', y='Age', kind='bar')",vscpp("br",null),"```",vscpp("br",null),"## Example ends here",vscpp("br",null),o.map(s=>vscpp(WX,{cell:s}))))}},WX=class extends Ud.PromptElement{render(){return vscpp(vscppf,null,"```",this.props.cell.document.languageId,vscpp("br",null),this.props.cell.document.getText(),vscpp("br",null),"```")}};var hC=class extends Ys.PromptElement{constructor(t,r,o){super(t);this.tabsAndEditorsService=r;this.notebookService=o}async prepare(){if(this.tabsAndEditorsService.activeNotebookEditor?.notebook.uri.path!==this.props.documentContext.document.uri.path)return{variables:[],packages:[]};let r=this.tabsAndEditorsService.activeNotebookEditor?.notebook;if(!r)return{variables:[],packages:[]};let o=this.notebookService.getVariables(r.uri),s=Promise.resolve([]),[a,c]=await Promise.all([o,s]);return{variables:a,packages:c}}render(t){let{priorities:r}=this.props;return vscpp(vscppf,null,t.variables.length!==0&&vscpp(vscppf,null,vscpp(Ys.UserMessage,{priority:r.runtimeCore},"The following variables are present in this Jupyter Notebook:",t.variables.map(o=>vscpp(vscppf,null,vscpp(Ys.TextChunk,null,"Name: ",o.variable.name,vscpp("br",null),o.variable.type&&vscpp(vscppf,null,"Type: ",o.variable.type),vscpp("br",null),"Value: ",o.variable.value,vscpp("br",null),o.indexedChildrenCount>0&&vscpp(vscppf,null,"Length: ",o.indexedChildrenCount),vscpp("br",null),o.variable.summary&&vscpp(vscppf,null,"Summary: ",o.variable.summary)))))),t.packages.length!==0&&vscpp(vscppf,null,vscpp(Ys.UserMessage,{priority:r.other},"The following pip packages are available in this Jupyter Notebook:",t.packages.map(o=>vscpp(vscppf,null,vscpp(Ys.TextChunk,null,o.name,"==",o.version),vscpp("br",null))))))}};hC=E([v(1,$t),v(2,uC)],hC);var gC=class extends Ys.PromptElement{constructor(t,r,o){super(t);this.ignoreService=r;this.parserService=o}async prepare(t){let{documentContext:r}=this.props,o=await this.ignoreService.isCopilotIgnored(r.document.uri),s=r.document.validateRange(r.wholeRange);return{summarizedDocument:await FD(this.parserService,r.document,r.fileIndentInfo,s,t.endpoint.modelMaxPromptTokens/3),isIgnored:o,priorities:NX}}render(t,r){if(!an(this.props.documentContext.document.uri))throw ur("InlineChatNotebookBasePrompt should be used only with a notebook!");let{query:o,history:s,chatVariables:a}=this.props.promptContext,{language:c}=this.props.documentContext,l=c.languageId!=="markdown",u=S0(this.props.documentContext.document.uri),d=t.summarizedDocument.splitAroundOriginalSelectionEnd(),{codeAbove:p,hasContent:f,codeBelow:m}=d,h=`${p}$PLACEHOLDER$${m}`,g=d.createReplyInterpreter(Cs.Mute,l?1:0,d.insertOrReplaceStreaming,l?Zi.createCodeBlockClassifier():Zi.createAlwaysInsideCodeBlockClassifier(),b=>b.value.trim()!=="$PLACEHOLDER$"),y=t.priorities;return vscpp(vscppf,null,vscpp("meta",{value:new $s(g)}),vscpp(Ys.SystemMessage,{priority:y.core},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You are a world class expert in programming, and especially good at ",c.languageId,".",vscpp("br",null),"Source code is always contained in ``` blocks.",vscpp("br",null),"The user needs help to write some new code.",vscpp("br",null),vscpp(Ze,null)),vscpp(Nt,{inline:!0,historyPriority:y.history??700,passPriority:!0,history:s},vscpp(Tt,{priority:1e3},u&&vscpp(vscppf,null,"When dealing with Jupyter Notebook, if a module is already imported in a cell, it can be used in other cells directly without importing it again. For the same reason, if a variable is defined in a cell, it can be used in other cells as well",vscpp("br",null),"When dealing with Jupyter Notebook, cells below the current cell can be executed before the current cell, you must use the variables defined in the cells below, unless you want to overwrite them.",vscpp("br",null),"When dealing with Jupyter Notebook, do not generate CELL INDEX in the code blocks in your answer, it is only used to help you understand the context.",vscpp("br",null),"If the Jupyter Notebook already contains variables, you should respect the name and value of the variables, and use them in your code when necessary.",vscpp("br",null)),f&&vscpp(vscppf,null,"The user includes existing code and marks with $PLACEHOLDER$ where the new code should go.",vscpp("br",null)),f&&vscpp(vscppf,null,'DO NOT include the text "$PLACEHOLDER$" in your reply.',vscpp("br",null)),f&&vscpp(vscppf,null,"DO NOT repeat any code from the user in your reply.",vscpp("br",null)),!f&&l&&vscpp(vscppf,null,"Your must generate a code block surrounded with ``` that will be used in a new file",vscpp("br",null)),!l&&vscpp(vscppf,null,"When generating content for markdown cell, provide the answer directly without any additional introductory text. Ensure that the response is structured in Markdown format to seamlessly integrate into the markdown file."))),vscpp(Ys.UserMessage,{priority:725},vscpp(sn,{languageId:c.languageId})),vscpp(tn,{priority:y.core,endpoint:r.endpoint,promptContext:this.props.promptContext,flexGrow:1}),vscpp(Ai,{priority:y.context,chatVariables:a}),vscpp(mC,{documentContext:this.props.documentContext,hasContent:f,code:h,priority:y.core}),vscpp(hC,{documentContext:this.props.documentContext,priorities:y,query:o}),vscpp(Ys.UserMessage,{priority:y.core},vscpp(Oo,{chatVariables:a,query:o}),vscpp("br",null),f&&l&&vscpp(vscppf,null,"The code that would fit at $PLACEHOLDER$ with ``` is:"),f&&!l&&vscpp(vscppf,null,"The code that would fit at $PLACEHOLDER$ without ``` is:")))}};gC=E([v(1,Te),v(2,ft)],gC);var vC=class extends Ys.PromptElement{constructor(t,r,o){super(t);this.ignoreService=r;this.parserService=o}async prepare(t){let{documentContext:r}=this.props,o=await this.ignoreService.isCopilotIgnored(r.document.uri),s=r.document.validateRange(r.wholeRange);return{summarizedDocument:await FD(this.parserService,r.document,r.fileIndentInfo,s,t.endpoint.modelMaxPromptTokens/3),isIgnored:o,priorities:NX}}render(t,r){if(!an(this.props.documentContext.document.uri))throw ur("InlineChatNotebookEditPrompt should be used only with a notebook!");if(t.isIgnored)return vscpp("ignoredFiles",{value:[this.props.documentContext.document.uri]});let{query:o,history:s,chatVariables:a}=this.props.promptContext,c=S0(this.props.documentContext.document.uri),{language:l}=this.props.documentContext,u=l.languageId==="markdown",d=t.summarizedDocument.splitAroundAdjustedSelection(),{codeAbove:p,codeSelected:f,codeBelow:m,hasCodeWithoutSelection:h}=d,g=`${p}$SELECTION_PLACEHOLDER$${m}`,y=d.createReplyInterpreter(Cs.Mute,1,d.replaceSelectionStreaming,Zi.createCodeBlockClassifier(),_=>_.value.trim()!=="$SELECTION_PLACEHOLDER$"),b=t.priorities;return vscpp(vscppf,null,vscpp("meta",{value:new $s(y)}),vscpp(Ys.SystemMessage,{priority:b.core},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You are a world class expert in programming, and especially good at ",l.languageId,".",vscpp("br",null),"Source code is always contained in ``` blocks.",vscpp("br",null),"The user needs help to modify some code.",vscpp("br",null),h&&vscpp(vscppf,null,"The user includes existing code and marks with $SELECTION_PLACEHOLDER$ where the selected code should go.",vscpp("br",null)),vscpp(Ze,null)),vscpp(Nt,{inline:!0,passPriority:!0,historyPriority:b.history??700,history:s},vscpp(Tt,{priority:1e3},c&&vscpp(vscppf,null,"When dealing with Jupyter Notebook, if a module is already imported in a cell, it can be used in other cells directly without importing it again. For the same reason, if a variable is defined in a cell, it can be used in other cells as well",vscpp("br",null),"When dealing with Jupyter Notebook, cells below the current cell can be executed before the current cell, you must use the variables defined in the cells below, unless you want to overwrite them.",vscpp("br",null),"When dealing with Jupyter Notebook, do not generate CELL INDEX in the code blocks in your answer, it is only used to help you understand the context.",vscpp("br",null),"If the Jupyter Notebook already contains variables, you should respect the name and value of the variables, and use them in your code when necessary.",vscpp("br",null)),u&&vscpp(vscppf,null,"When generating content for markdown cell, provide the answer directly without any additional introductory text. Ensure that the response is structured in Markdown format to seamlessly integrate into the markdown file."),h&&vscpp(vscppf,null,"The user includes existing code and marks with $SELECTION_PLACEHOLDER$ where the selected code should go.",vscpp("br",null)))),vscpp(fC,{documentContext:this.props.documentContext,hasCodeWithoutSelection:h,codeWithoutSelection:g,codeSelected:f,priority:b.core}),vscpp(Ys.UserMessage,{priority:b.context},vscpp(sn,{languageId:l.languageId})),vscpp(tn,{priority:b.core,endpoint:r.endpoint,promptContext:this.props.promptContext,flexGrow:1}),vscpp(Ai,{priority:b.context,chatVariables:a}),vscpp(hC,{documentContext:this.props.documentContext,priority:b.core,priorities:b,query:o}),vscpp(Ys.UserMessage,{priority:b.core},vscpp(Oo,{chatVariables:a,query:o}),vscpp("br",null),h&&u&&vscpp(vscppf,null,"The modified $SELECTION_PLACEHOLDER$ code without ``` is:"),h&&!u&&vscpp(vscppf,null,"The modified $SELECTION_PLACEHOLDER$ code with ``` is:")))}};vC=E([v(1,Te),v(2,ft)],vC);var df=class{constructor(e,t,r,o,s,a){this.intent=e;this.location=t;this.endpoint=r;this.documentContext=o;this.editStrategy=s;this.instantiationService=a;this.replyInterpreter=null}async buildPrompt(e,t,r){let o;an(this.documentContext.document.uri)?o=this.editStrategy===4?gC:vC:this.documentContext.document.languageId==="markdown"?o=this.editStrategy===4?sC:cC:o=this.editStrategy===4?lC:aC;let a=await Fe.create(this.instantiationService,this.endpoint,o,{documentContext:this.documentContext,promptContext:e}).render(t,r);this.replyInterpreter=a.metadata.get($s)?.replyInterpreter??null;let c=a.metadata.get(Sx);return{...a,telemetryData:c&&[c]}}processResponse(e,t,r,o){if(!this.replyInterpreter)throw new Error("Could not process response without a reply interpreter!");return this.replyInterpreter.processResponse(e,t,r,o)}};df=E([v(5,H)],df);var w0=class extends ga{constructor(t,r,o,s=l0,a,c){super(t,r,o);this.prompt=s;this.documentContext=a;this.instantiationService=c}createRenderer(t,r,o,s){return Fe.create(this.instantiationService,r,this.prompt,{documentContext:this.documentContext,endpoint:r,promptContext:t})}};w0=E([v(5,H)],w0);var Ac=class{constructor(e,t){this.instantiationService=e;this.endpointProvider=t;this.id=Ac.ID;this.locations=[1,2];this.description=u_e.t("Intent of this command is unclear or is not related to information technologies");this.commandInfo={hiddenFromUser:!0};this.intentDetectionInput={sampleQuestion:"Add a dog to this comment."}}static{this.ID="unknown"}async invoke(e){let{location:t,documentContext:r,request:o}=e,s=await this.endpointProvider.getChatEndpoint(o);if(t===1){if(!r)throw new Error("Open a file to add code.");return this.instantiationService.createInstance(df,this,t,s,r,2)}return this.instantiationService.createInstance(w0,this,t,s,void 0,r)}};Ac=E([v(0,H),v(1,_e)],Ac);var Zo=re("ILanguageDiagnosticService"),yC=class{constructor(e){this._ignoreService=e}waitForNewDiagnostics(e,t,r=5e3){let o,s,a;return new Promise(c=>{o=t.onCancellationRequested(()=>c([])),a=setTimeout(()=>c(this.getDiagnostics(e)),r),s=this.onDidChangeDiagnostics(l=>{for(let u of l.uris)if(th(u,e)){c(this.getDiagnostics(e));break}})}).finally(()=>{o.dispose(),s.dispose(),clearTimeout(a)})}};yC=E([v(0,Te)],yC);function d_e(n){return n.map(e=>e.range).reduce((e,t)=>e.union(t))}function KX(n,e,t=[oD.Error,oD.Warning]){return n.find(r=>r.range.contains(e)&&t.includes(r.severity))}var D8=class{constructor(e){this._currentDocument=e;this._annotations=[];this._seenMarkdown=!1;this._seenEdits=new _1;this._seenNoOpEdits=!1;this.store=void 0}get _interactionOutcomeKind(){return this._seenEdits.size>0?this._seenEdits.size===1&&this._currentDocument&&this._seenEdits.has(this._currentDocument)?"inlineEdit":"workspaceEdit":this._seenMarkdown?"conversational":this._seenNoOpEdits?"noopEdit":"none"}get interactionOutcome(){return new F6(this._interactionOutcomeKind,this._annotations)}spyOnStream(e){return Ad.spy(e,t=>{t instanceof ki&&this._markEmittedMarkdown(t.value),t instanceof _c&&this._markEmittedEdits(t.uri,t.edits)})}_markEmittedMarkdown(e){this._seenMarkdown=!0}_markEmittedEdits(e,t){this._seenEdits.add(e)}addAnnotations(e=[]){this._seenNoOpEdits=this._seenNoOpEdits||e.some(t=>t.label==="noop edits"),this._annotations=this._annotations.concat(e)}storeInInlineSession(e){this.store=e}},N8=class{constructor(e,t,r){this.turn=e;this.messages=t;this._interactionOutcomeComputer=r}addAnnotations(e){this._interactionOutcomeComputer.addAnnotations(e)}storeInInlineSession(e){this._interactionOutcomeComputer.storeInInlineSession(e)}};function L8(n,e){let t=e.filter(u=>n.intersection(u.range)),r={problems:e.map(u=>u.message).join(", "),problemsCount:e.length,diagnosticCodes:"",diagnosticsCount:0},o={problems:t.map(u=>u.message).join(", "),problemsCount:t.length,diagnosticCodes:"",diagnosticsCount:0},s=new Map,a=new Map;e.forEach(u=>{let d=u.code,p=typeof d=="string"||typeof d=="number"?d.toString():d?d.value.toString():"",f=u.source?`${u.source}@${p}`:p;s.set(f,(s.get(f)||0)+1),n.intersection(u.range)&&a.set(f,(a.get(f)||0)+1)});let c=u=>{let d="";return u.forEach((p,f)=>{d+=`${f}:${p},`}),d};r.diagnosticCodes=c(s),r.diagnosticsCount=s.size,o.diagnosticCodes=c(a),o.diagnosticsCount=a.size;let l=e.length>0?e[0].source??"":"";return{fileDiagnosticsTelemetry:r,selectionDiagnosticsTelemetry:o,diagnosticsProvider:l}}var YYe=3,QYe=3,XYe=1;function bC(n,e){let t=0;for(let r of e)t+=JYe(n,r);return t+=YYe,t}function JYe(n,e){let t=QYe;for(let[r,o]of Object.entries(e))o&&(t+=n.tokenLength(o),r==="name"&&(t+=XYe));return t}function O8(){let n=Gt(),e=mi.createAndMarkAsIssued({messageId:n});return new YX(e)}var YX=class n{constructor(e){this.raw=e}get properties(){return this.raw.properties}get measurements(){return this.raw.measurements}markAsDisplayed(){this.raw.markAsDisplayed()}extendedBy(e,t){let r=this.raw.extendedBy(e,t);return new n(r)}};function p_e(n,e,t,r,o,s,a){let c=n.turns[n.turns.length-1].contextParts.map(d=>d.kind).sort(),l={source:"user",turnIndex:(n.turns.length-1).toString(),conversationId:e,uiKind:lt.toString(t),inputSources:c.join(",")},u={promptTokenLen:o,messageCharLen:r.length};return s&&(l.suggestion=s),a=a.extendedBy(l,u),a}function f_e(n,e,t,r,o,s,a){o!==void 0&&(a=a.extendedBy({offTopic:o.toString()})),a=a.extendedBy({headerRequestId:t}),QX(n,s,e,r,{},{},a)}function M8(n,e,t,r,o,s,a,c){let l=XX(o);QX(n,a,r,o,{source:"model",turnIndex:e.turns.length.toString(),conversationId:t,headerRequestId:s,uiKind:lt.toString(r),codeBlockLanguages:JSON.stringify({...l})},{messageCharLen:o.length,numCodeBlocks:l.length},c)}function m_e(n,e,t,r,o,s,a,c){QX(n,a,r,o,{source:"offTopic",turnIndex:e.turns.length.toString(),conversationId:t,userMessageId:s,uiKind:lt.toString(r)},{messageCharLen:o.length},c)}function QX(n,e,t,r,o,s,a){let c={...r?{messageText:r}:{},...o};e&&(o.languageId=e.languageId,s.documentLength=e.getText().length);let l=a.extendedBy(o,s),u=a.extendedBy(c),d=ZYe(t);return n.sendGHTelemetryEvent(`${d}.message`,l.raw.properties,l.raw.measurements),n.sendRestrictedGHTelemetryEvent(`${d}.messageText`,u.raw.properties,u.raw.measurements),l.raw}function F8(n,e,t,r,o){return k0(n,o,{suggestion:e,messageId:t,suggestionId:r},{},"conversation.suggestionShown")}function k0(n,e,t,r,o,s){let a=s??mi.createAndMarkAsIssued();e&&(t.languageId=e.languageId,r.documentLength=e.getText().length);let c=a.extendedBy(t,r);return n.sendGHTelemetryEvent(o,c.properties,c.measurements),c}function ZYe(n){switch(n){case 1:return"inlineConversation";case 3:return"editingSession";case 2:default:return"conversation"}}function XX(n){let e=n.split(`
`),t=[],r;for(let o=0;o<e.length;o++){let s=e[o];if(r)new RegExp(`^\\s*${r.delimiter}\\s*$`).test(s)&&(t.push(r.languageId),r=void 0);else{let a=s.match(/^(\s*)(`{3,}|~{3,})(\w*)/);a&&(r={delimiter:a[2],languageId:a[3]})}}return t}var _C=class{constructor(e,t,r,o,s,a,c,l){this._startTime=e;this._sessionId=t;this._documentContext=r;this._firstTurn=o;this._request=s;this._telemetryService=a;this._languageDiagnosticsService=c;this._tokenizerProvider=l;this.baseUserTelemetry=O8()}get telemetryMessageId(){return this.baseUserTelemetry.properties.messageId}makeRequest(e,t,r,o,s,a,c,l){let u=t===1?XD:QD;return new u(this._sessionId,this._documentContext,this._firstTurn,this._request,this._startTime,this.baseUserTelemetry,r,o,e,s,a,this._tokenizerProvider.acquireTokenizer(c),c,l,this._telemetryService,this._languageDiagnosticsService)}};_C=E([v(5,ge),v(6,Zo),v(7,Qn)],_C);var xC=class{constructor(e,t,r,o,s,a,c,l,u,d,p,f,m,h,g,y){this._location=e;this._sessionId=t;this._documentContext=r;this._firstTurn=o;this._request=s;this._startTime=a;this._conversation=l;this._queryWithoutCommand=u;this._intent=d;this._messages=p;this._references=f;this._tokenizer=m;this._endpoint=h;this._genericTelemetryData=g;this._telemetryService=y;this._requestStartTime=Date.now();this._firstTokenTime=0;this._addedLinkCount=0;this._markdownCharCount=0;this._editCount=0;this._editLineCount=0;this._userTelemetry=p_e(this._conversation,this._sessionId,this._location,this._request.prompt,bC(this._tokenizer,this._messages),this._intent.id,c),queueMicrotask(()=>this._sendInternalRequestTelemetryEvent())}get telemetryMessageId(){return this._userTelemetry.properties.messageId}get editCount(){return this._editCount}get editLineCount(){return this._editLineCount}markReceivedToken(){this._firstTokenTime===0&&(this._firstTokenTime=Date.now())}markAddedLinks(e){this._addedLinkCount+=e}markEmittedMarkdown(e){this._markdownCharCount+=e.value.length}markEmittedEdits(e,t){this._editCount+=t.length,this._editLineCount+=t.reduce((r,o)=>r+o.newText.split(`
`).length,0)}sendTelemetry(e,t,r,o){f_e(this._telemetryService,this._location,e,this._request.prompt,t==="offTopic",this._documentContext?.document,this._userTelemetry),t==="offTopic"&&m_e(this._telemetryService,this._conversation,this._sessionId,this._location,this._request.prompt,this.telemetryMessageId,this._documentContext?.document,this._userTelemetry),t==="success"&&M8(this._telemetryService,this._conversation,this._sessionId,this._location,r,this.telemetryMessageId,this._documentContext?.document,this._userTelemetry.extendedBy({replyType:o.kind})),this._sendResponseTelemetryEvent(t,r,o),this._sendResponseInternalTelemetryEvent(t,r)}_getTelemetryData(e){return this._genericTelemetryData.find(t=>t instanceof e)}};xC=E([v(15,ge)],xC);var QD=class extends xC{constructor(e,t,r,o,s,a,c,l,u,d,p,f,m,h,g){super(2,e,t,r,o,s,a,c,l,u,d,p,f,m,h,g)}_sendInternalRequestTelemetryEvent(){let e=this._conversation.getLatestTurn()?.contextParts.map(t=>t.kind)??[];this._telemetryService.sendInternalMSFTTelemetryEvent("interactiveSessionMessage",{intent:this._intent.id,isParticipantDetected:String(this._request.isParticipantDetected),detectedIntent:this._request.enableCommandDetection?this._intent?.id:"none",contextTypes:e.join(","),query:this._request.prompt},{})}_sendResponseTelemetryEvent(e,t,r){let o=this._conversation.getLatestTurn(),s=t?XX(t):[],a=["programming-related tasks","programming related questions","software development topics","related to programming","expertise is limited","sorry, i can't assist with that"],c=0;e==="success"&&!t.trim().includes(`
`)&&a.some(l=>t.toLowerCase().includes(l))&&(c=1),this._telemetryService.sendMSFTTelemetryEvent("panel.request",{command:this._intent.id,contextTypes:o.contextParts.map(l=>l.kind).join(",")??"none",promptTypes:this._messages.map(l=>`${l.role}${"name"in l&&l.name?`-${l.name}`:""}:${l.content?.length}`).join(","),conversationId:this._sessionId,requestId:o.requestId,responseId:o.requestId,responseType:e,languageId:this._documentContext?.document.languageId,codeBlocks:s.join(","),model:this._endpoint.model,isParticipantDetected:String(this._request.isParticipantDetected)},{turn:this._conversation.turns.length,textBlocks:s.length?-1:t.split(/\n{2,}/).length??0,links:this._addedLinkCount,maybeOffTopic:c,messageTokenCount:this._tokenizer.tokenLength(o.request.message),promptTokenCount:bC(this._tokenizer,this._messages),userPromptCount:this._messages.filter(l=>l.role==="user").length,responseTokenCount:this._tokenizer.tokenLength(t)??0,timeToRequest:this._requestStartTime-this._startTime,timeToFirstToken:this._firstTokenTime?this._firstTokenTime-this._startTime:-1,timeToComplete:Date.now()-this._startTime,...XQ(o.references)})}_sendResponseInternalTelemetryEvent(e,t){this._telemetryService.sendInternalMSFTTelemetryEvent("interactiveSessionResponse",{chatLocation:"panel",intent:this._intent.id,request:this._request.prompt,response:t??"",isParticipantDetected:String(this._request.isParticipantDetected),sessionId:this._sessionId},{turnNumber:this._conversation.turns.length})}};QD=E([v(14,ge)],QD);var XD=class extends xC{constructor(t,r,o,s,a,c,l,u,d,p,f,m,h,g,y,b){super(1,t,r,o,s,a,c,l,u,d,p,f,m,h,g,y);this._languageDiagnosticsService=b;this._diagnosticsTelemetryData=L8(this._documentContext.selection,this._languageDiagnosticsService.getDiagnostics(this._documentContext.document.uri))}get _isNotebookDocument(){return an(this._documentContext.document.uri)?1:0}_sendInternalRequestTelemetryEvent(){this._telemetryService.sendInternalMSFTTelemetryEvent("interactiveSessionRequest",{conversationId:this._sessionId,requestId:this.telemetryMessageId,chatLocation:"inline",intent:this._intent.id,language:this._documentContext.document.languageId,prompt:this._messages.map(t=>`${t.role.toUpperCase()}:
${t.content}`).join(`
---
`),model:this._endpoint.model},{isNotebook:this._isNotebookDocument})}_sendResponseTelemetryEvent(t,r,o){let s=this._getTelemetryData(Sx);this._telemetryService.sendMSFTTelemetryEvent("inline.request",{command:this._intent.id,contextTypes:"none",promptTypes:this._messages.map(a=>`${a.role}${"name"in a&&a.name?`-${a.name}`:""}:${a.content.length}`).join(","),conversationId:this._sessionId,requestId:this.telemetryMessageId,languageId:this._documentContext.document.languageId,responseType:t,replyType:o.kind,model:this._endpoint.model,diagnosticsProvider:this._diagnosticsTelemetryData.diagnosticsProvider,diagnosticCodes:this._diagnosticsTelemetryData.fileDiagnosticsTelemetry.diagnosticCodes,selectionDiagnosticCodes:this._diagnosticsTelemetryData.selectionDiagnosticsTelemetry.diagnosticCodes,outcomeAnnotations:o.annotations?.map(a=>a.label).join(",")},{firstTurn:this._firstTurn?1:0,isNotebook:this._isNotebookDocument,withIntentDetection:this._request.enableCommandDetection?1:0,messageTokenCount:this._tokenizer.tokenLength(this._queryWithoutCommand),promptTokenCount:bC(this._tokenizer,this._messages),responseTokenCount:t==="success"?this._tokenizer.tokenLength(r):-1,implicitCommand:this._request.prompt.trim().startsWith(`/${this._intent.id}`)?0:1,attemptCount:this._request.attempt||0,selectionLineCount:Math.abs(this._documentContext.selection.end.line-this._documentContext.selection.start.line)+1,wholeRangeLineCount:Math.abs(this._documentContext.wholeRange.end.line-this._documentContext.wholeRange.start.line)+1,editCount:this._editCount>0?this._editCount:-1,editLineCount:this._editLineCount>0?this._editLineCount:-1,markdownCharCount:this._markdownCharCount,problemsCount:this._diagnosticsTelemetryData.fileDiagnosticsTelemetry.problemsCount,selectionProblemsCount:this._diagnosticsTelemetryData.selectionDiagnosticsTelemetry.problemsCount,diagnosticsCount:this._diagnosticsTelemetryData.fileDiagnosticsTelemetry.diagnosticsCount,selectionDiagnosticsCount:this._diagnosticsTelemetryData.selectionDiagnosticsTelemetry.diagnosticsCount,timeToRequest:this._requestStartTime-this._startTime,timeToFirstToken:this._firstTokenTime?this._firstTokenTime-this._startTime:-1,timeToComplete:Date.now()-this._startTime,...XQ(this._references),temporalCtxFileCount:s?.documentCount??-1,temporalCtxTotalCharCount:s?.totalCharLength??-1})}_sendResponseInternalTelemetryEvent(t,r){this._telemetryService.sendInternalMSFTTelemetryEvent("interactiveSessionResponse",{chatLocation:"inline",intent:this._intent.id,request:this._request.prompt,response:r,conversationId:this._sessionId,requestId:this.telemetryMessageId,responseType:t,problems:this._diagnosticsTelemetryData.fileDiagnosticsTelemetry.problems,selectionProblems:this._diagnosticsTelemetryData.selectionDiagnosticsTelemetry.problems,diagnosticCodes:this._diagnosticsTelemetryData.fileDiagnosticsTelemetry.diagnosticCodes,selectionDiagnosticCodes:this._diagnosticsTelemetryData.selectionDiagnosticsTelemetry.diagnosticCodes,diagnosticsProvider:this._diagnosticsTelemetryData.diagnosticsProvider,language:this._documentContext.document.languageId},{isNotebook:this._isNotebookDocument})}};XD=E([v(14,ge),v(15,Zo)],XD);var RC=q(ht());var SC=re("IDiffService");var R0=class{constructor(e,t){this.initialText=e;this._diffService=t;this._document=new JX(e)}addEdits(e){let t=eQe(e,this._document);this._document.apply(t)}getText(){return this._document.getValue()}async getEdits(){let e=this.getText();return await Rn.fromDiff(this.initialText,e,this._diffService)}};R0=E([v(1,SC)],R0);var U8=class{constructor(){this.initialText=""}addEdits(e){}getText(){return""}async getEdits(){return Rn.empty}};function eQe(n,e){return new Rn(n.map(t=>{let r=e.positionToOffset(t.range.start),o=e.positionToOffset(t.range.end);return new Pi(new gt(r,o),t.newText)}))}var JX=class{constructor(e=""){this._converter=void 0;this._value="";this._value=e}getValue(){return this._value}apply(e){this._value=e.apply(this._value),this._converter=void 0}positionToOffset(e){return this._converter||(this._converter=new xc(this._value)),this._converter.positionToOffset(new Dt(e.line+1,e.character+1))}};var pf=re("ISurveyService");var IC=class{constructor(e,t){this.value=e;this.title=t}},P0=class{constructor(e,t){this.symbolInformation=e;this.resolve=t}};function JD(n){let e=[];for(let t of n){let r=e.at(-1);typeof t=="string"&&typeof r=="string"?e[e.length-1]=r+t:e.push(t)}return e}var tQe=new RegExp([/\[(`?)([^`\s]+)\1\]\((?<path1>\2)\)/.source,/(?<!\[)`(?<path2>[^`\s]+)`(?!\])/.source,/(?<![\[`()<])(?<path3>\S+\.\S+)(?![\]`])/.source].join("|"),"gu"),TC=class{constructor(e,t){this.fileSystem=e;this.workspaceService=t}async linkify(e,t,r){let o=[],s=0;for(let c of e.matchAll(tQe)){let l=e.slice(s,c.index);l&&o.push(l);let u=c[0],d=c.groups?.path1??c.groups?.path2??c.groups?.path3??"",p=await this.resolvePathText(d,t);if(r.isCancellationRequested)throw new dt;p?o.push(new IC(p)):o.push(u),s=c.index+u.length}let a=e.slice(s);return a&&o.push(a),{parts:JD(o)}}async resolvePathText(e,t){let r=this.workspaceService.getWorkspaceFolders();if(/^[\w\-_]+:/.test(e)||!r.length||e.length<2)return;if(e.startsWith("/"))try{let a=zt.file(e);if(await this.exists(a))return a}catch{}for(let a of r){let c=zt.joinPath(a,e);if(await this.exists(c))return c}let o=k1(e);return t.references.map(a=>"variableName"in a.anchor?D2(a.anchor.value)?a.anchor.value:a.anchor.value?.uri:D2(a.anchor)?a.anchor:a.anchor.uri).filter(a=>!!a).find(a=>fc(a)===o)}async exists(e){try{return await this.fileSystem.stat(e),!0}catch{return!1}}};TC=E([v(0,gn),v(1,Be)],TC);var du;(s=>{let n;(u=>(u[u.Default=0]="Default",u[u.CodeBlock=1]="CodeBlock",u[u.Accumulating=2]="Accumulating"))(n=s.Type||={});let e;(u=>(u[u.Word=0]="Word",u[u.InlineCode=1]="InlineCode",u[u.PotentialLink=2]="PotentialLink"))(e=s.AccumulationType||={}),s.Default={type:0};class r{constructor(c,l,u=""){this.fence=c;this.indent=l;this.contents=u;this.type=1}appendContents(c){return new r(this.fence,this.indent,this.contents+c)}}s.CodeBlock=r;class o{constructor(c,l=0){this.pendingText=c;this.accumulationType=l;this.type=2}}s.Accumulating=o})(du||={});var B8=class{constructor(e,t=[]){this.context=e;this.linkifiers=t;this._state=du.Default;this._appliedText="";this._totalAddedLinkCount=0}get totalAddedLinkCount(){return this._totalAddedLinkCount}async append(e,t){let r=[];for(let o of e.split(/(\s+)/))if(o.length)switch(this._state.type){case 0:{/^\s+$/.test(o)?r.push(this.doAppend(o)):/^[^\[`]*`[^`]*$/.test(o)?this._state=new du.Accumulating(o,1):/^\s*\[[^\]]+$/.test(o)?this._state=new du.Accumulating(o,2):this._state=new du.Accumulating(o);break}case 1:{if(new RegExp("(^|\\n)"+this._state.fence+"($|\\n)").test(o)||this._state.contents.length>2&&new RegExp("(^|\\n)\\s*"+this._state.fence+"($|\\n\\s*$)").test(this._appliedText+o)){let s=this._appliedText.match(/(\n|^)([ \t]*)[`~]*$/);if(s&&s[2].length<=this._state.indent.length){this._state=du.Default,r.push(this.doAppend(o));break}}this._state=this._state.appendContents(o),r.push(this.doAppend(o));break}case 2:{let s=async a=>{let c=a.pendingText+o;this._state=du.Default;let l=await this.doLinkifyAndAppend(c,t);r.push(...l.parts)};if(this._state.accumulationType===2){if(/]/.test(o)){this._state=new du.Accumulating(this._state.pendingText+o,0);break}else if(/\n/.test(o)){await s(this._state);break}}else if(this._state.accumulationType===1&&/`/.test(o)){await s(this._state);break}else if(this._state.accumulationType===0&&/\s/.test(o)){let a=this._state.pendingText+o;this._state=du.Default;let c=a.match(/(^|\n)\s*(`{3,}|~{3,})/);if(c){let l=this._appliedText.match(/(\n|^)([ \t]*)$/);this._state=new du.CodeBlock(c[2],l?.[2]??""),r.push(this.doAppend(a))}else{let l=await this.doLinkifyAndAppend(a,t);r.push(...l.parts)}break}this._state=new du.Accumulating(this._state.pendingText+o,this._state.accumulationType);break}}return{parts:JD(r)}}async flush(e){let t;switch(this._state.type){case 1:{t={parts:[this.doAppend(this._state.contents)]};break}case 2:{let r=this._state.pendingText;t=await this.doLinkifyAndAppend(r,e);break}}return this._state=du.Default,t}doAppend(e){return this._appliedText=this._appliedText+e,e}async doLinkifyAndAppend(e,t){this.doAppend(e);let r=[e];for(let o of this.linkifiers){let s=[];for(let a of r)if(typeof a=="string"){let c=await o.linkify(a,this.context,t);if(t.isCancellationRequested)throw new dt;c?s.push(...c.parts):s.push(a)}else s.push(a);r=JD(s)}return r=r.map(o=>typeof o=="string"?o.replace(/\[([^\[\]]+)]\(([^\s\)]+)\)/g,(s,a,c)=>/^\w+:/.test(c)?s:a):o),this._totalAddedLinkCount+=r.filter(o=>typeof o!="string").length,{parts:r}}};var EC=re("ILinkifyService"),CC=class{constructor(e,t){this.globalLinkifiers=new Set;this.registerGlobalLinkifier({create:()=>new TC(e,t)})}registerGlobalLinkifier(e){if(this.globalLinkifiers.has(e))throw new Error("Linkifier already registered");return this.globalLinkifiers.add(e),{dispose:()=>this.globalLinkifiers.delete(e)}}createLinkifier(e,t){return new B8(e,[...t||[],...this.globalLinkifiers].map(r=>r.create()))}};CC=E([v(0,gn),v(1,Be)],CC);var wC=class{constructor(e,t,r,o,s){this.sequencer=Promise.resolve();this._linkifier=s.createLinkifier(e,r),this._progress=t,this._token=o}get totalAddedLinkCount(){return this._linkifier.totalAddedLinkCount}markdown(e){return this.appendMarkdown(typeof e=="string"?new Ao(e):e),this}anchor(e,t){return this.enqueue(()=>this._progress.anchor(e,t),!1),this}button(e){return this.enqueue(()=>this._progress.button(e),!0),this}filetree(e,t){return this.enqueue(()=>this._progress.filetree(e,t),!0),this}progress(e){return this.enqueue(()=>this._progress.progress(e),!1),this}warning(e){return this.enqueue(()=>this._progress.warning(e),!1),this}reference(e){return this.enqueue(()=>this._progress.reference(e),!1),this}reference2(e){return this.enqueue(()=>this._progress.reference(e),!1),this}codeCitation(e,t,r){return this.enqueue(()=>this._progress.codeCitation(e,t,r),!1),this}push(e){return e instanceof ki?this.appendMarkdown(e.value):this.enqueue(()=>this._progress.push(e),this.isBlockPart(e)),this}isBlockPart(e){return e instanceof Td||e instanceof ex||e instanceof _c||e instanceof A5}textEdit(e,t){return this.enqueue(()=>this._progress.textEdit(e,t),!0),this}markdownWithVulnerabilities(e,t){return this.enqueue(()=>this._progress.markdownWithVulnerabilities(e,t),!1),this}codeblockUri(e){"codeblockUri"in this._progress&&this.enqueue(()=>this._progress.codeblockUri(e),!1)}detectedParticipant(e,t){return this.enqueue(()=>this._progress.detectedParticipant(e,t),!1),this}confirmation(e,t,r){return this.enqueue(()=>this._progress.confirmation(e,t,r),!0),this}enqueue(e,t){return t&&(this.sequencer=this.sequencer.then(()=>this.doFinalize())),this.sequencer=this.sequencer.then(e),this.sequencer}async appendMarkdown(e){e.value&&this.enqueue(async()=>{let t=await this._linkifier.append(e.value,this._token);this._token.isCancellationRequested||this.outputMarkdown(t)},!1)}async finalize(){await this.enqueue(()=>this.doFinalize(),!1)}async doFinalize(){let e=await this._linkifier.flush(this._token);this._token.isCancellationRequested||e&&this.outputMarkdown(e)}outputMarkdown(e){for(let t of e.parts)if(typeof t=="string"){if(!t.length)continue;let r=new Ao(t);this._progress.markdown(r)}else if(t instanceof P0){let r=new Z1(t.symbolInformation);t.resolve&&(r.resolve=()=>t.resolve(this._token)),this._progress.push(r)}else this._progress.anchor(t.value,t.title)}};wC=E([v(4,EC)],wC);var h_e=q(ht());var kC=class{constructor(e,t){this.stopStartMappings=e;this.processNonReportedDelta=t;this.stagedDeltasToApply=[];this.currentStartStop=void 0;this.nonReportedDeltas=[]}async processResponse(e,t,r,o){return this.doProcessResponse(t,r,o)}async doProcessResponse(e,t,r){for await(let{delta:o}of e){if(r.isCancellationRequested)return;this.applyDelta(o,t)}}applyDeltaToProgress(e,t){let r=e.ipCitations;r?.length&&r.forEach(s=>{let a=s.citations.license==="NOASSERTION"?h_e.t("unknown"):s.citations.license;t.codeCitation($e.parse(s.citations.url),a,s.citations.snippet)});let o=e.codeVulnAnnotations?.map(s=>({title:s.details.type,description:s.details.description}));o?.length?t.markdownWithVulnerabilities(e.text??"",o):e.text&&t.markdown(e.text)}updateStagedDeltasUpToIndex(e,t){let r=[];for(let o=0;o<e+t;){let s=this.stagedDeltasToApply.shift();if(s){if(o+s.text.length<=e)r.push(s);else if(o<e||o<e+t){if(o<e){let c={...s};c.text=s.text.substring(0,e-o),r.push(c)}let a={...s};a.text=s.text.substring(e-o+t),a.text&&this.stagedDeltasToApply.unshift(a)}o+=s.text.length}else break}return r}checkForKeyWords(e,t,r){let o=this.stagedDeltasToApply.map(s=>s.text).join("")+t.text;for(let s of e){let a=o.indexOf(s);if(a===-1)continue;return this.stagedDeltasToApply.push(t),this.updateStagedDeltasUpToIndex(a,s.length).forEach(l=>r(l)),s}for(let s of e)for(let a=s.length-1;a>0;a--){let c=s.substring(0,a);if(o.endsWith(c)){this.stagedDeltasToApply=[...this.stagedDeltasToApply,t];return}}[...this.stagedDeltasToApply,t].forEach(s=>{r(s)}),this.stagedDeltasToApply=[]}postReportRecordProgress(e){this.nonReportedDeltas.push(e)}applyDelta(e,t){if(this.currentStartStop===void 0){let r=this.checkForKeyWords(this.stopStartMappings.map(o=>o.stop),e,o=>this.applyDeltaToProgress(o,t));r&&(this.currentStartStop=this.stopStartMappings.find(o=>o.stop===r));return}else{if(!this.currentStartStop.start)return;this.checkForKeyWords([this.currentStartStop.start],e,this.postReportRecordProgress.bind(this))&&(this.processNonReportedDelta&&this.processNonReportedDelta(this.nonReportedDeltas).forEach(s=>this.applyDeltaToProgress({text:s},t)),this.currentStartStop=void 0,this.stagedDeltasToApply.length>0&&this.applyDelta({text:""},t))}}};var ZD={errorDetails:{message:RC.t("Cancelled")}},ff=class extends A6{constructor(t,r,o,s,a,c,l,u,d,p,f,m,h,g,y,b){super(r,o,s,a,c,l,u,d,p);this.intent=t;this._instantiationService=f;this.options=m;this._telemetryService=h;this._logService=g;this._chatMLFetcher=y;this._surveyService=b}async getResult(){if(this.checkCancellation())return ZD;try{let t=this.documentContext?.document.getText(),r=this.turn.request.message,o=this.request.references,s=new Es(o),a=this.conversation.turns.slice(0,-1);if(this.checkCancellation())return ZD;this.intent&&(this.turn.request={message:r,type:"user"}),this._logService.public.trace("Processing intent");let c=await this.intent.invoke({location:this.location,documentContext:this.documentContext,request:this.request});if(this.checkCancellation())return ZD;this._logService.public.trace("Processed intent"),this.turn.intentInvocation=c;let l=c.endpoint,u=await this.handleConfirmationsIfNeeded();if(u)return u;let d,p={query:this.turn.request.message,history:a,chatVariables:s,tools:{toolReferences:this.request.toolReferences,toolInvocationToken:this.request.toolInvocationToken}};try{d=await this.buildPrompt(c,p,this.stream,this.token);let[I,S]=[d.references,d.omittedReferences].map(w=>w.reduce((R,k)=>("variableName"in k.anchor&&R.add(k.anchor.variableName),R),new Set));for(let w of d.references){let R=w.options??("variableName"in w.anchor&&S.has(w.anchor.variableName)?{status:{kind:2,description:RC.t("Part of this attachment was not sent to the model due to context window limitations.")}}:void 0);this.stream.reference2(w.anchor,void 0,R)}for(let w of d.omittedReferences)"variableName"in w.anchor&&!I.has(w.anchor.variableName)&&this.stream.reference2(w.anchor,void 0,{status:{kind:3,description:RC.t("This attachment was not sent to the model due to context window limitations.")}});this.turn.addReferences(d.references)}catch(I){if(wo(I))return ZD;throw I}if(this.checkCancellation())return ZD;let f=this.chatTelemetry.makeRequest(this.intent,this.location,this.conversation,this.request.prompt,d.messages,d.references,c.endpoint,d.telemetryData??[]);this._logService.public.trace("Built prompt"),this.turn.chatMessages=d.messages,this.fixMessageNames(this.intent,d.messages);let m=new D8(this.documentContext?.document.uri),h=this,g=new class{constructor(){this.context=new N8(h.turn,d.messages,m)}processResponse(I,S,w,R,k){return typeof c.processResponse=="function"?c.processResponse(this.context,w,R,k):h._instantiationService.createInstance(kC,[{stop:"[COMMANDS START]"}],void 0).processResponse(this.context,w,R,k)}};this._logService.public.trace("Sending prompt to model");let y=this.stream,b=new U8;this.documentContext&&this.location===1&&(b=this.conversation.turns.find(S=>S.inlineResponseInfo?.aiEditCollector)?.inlineResponseInfo?.aiEditCollector??this._instantiationService.createInstance(R0,this.documentContext.document.getText()),y=Ad.spy(y,S=>{S instanceof _c&&b.addEdits(S.edits)}));let _=this.location===1?"inline":"chat",x=await this.fetchConversationResponse(`${lt.toStringShorter(this.location)}/${this.intent.id}`,y,l,r,d.messages,m,g,c.linkification,{messageId:this.chatTelemetry.telemetryMessageId,messageSource:this.intent?.id&&this.intent.id!==Ac.ID?`${_}.${this.intent.id}`:`${_}.user`},f);return d.hasIgnoredFiles&&y.markdown(RC.t(NF)),this.turn.interactionOutcome=m.interactionOutcome,this.documentContext&&(this.turn.inlineResponseInfo={kind:"ok",promptQuery:{...this.documentContext,intent:this.intent,query:this.request.prompt},store:m.store,aiEditCollector:b,messageId:this.chatTelemetry.telemetryMessageId,telemetry:f},this.turn.requestDebugInformation={uri:this.documentContext.document.uri,intentId:this.intent.id,languageId:this.documentContext.document.languageId,initialDocumentText:t,userPrompt:this.request.prompt,userSelection:this.documentContext.selection}),x}catch(t){this._logService.public.error(t),this._telemetryService.sendGHTelemetryException(t,"Error");let r=t.message;return this.turn.status="error",this.turn.response={message:r,type:"meta"},{errorDetails:{message:r}}}}async buildPrompt(t,r,o,s){let a={report(c){o.push(c)}};return await t.buildPrompt(r,a,s)}async handleConfirmationsIfNeeded(){if((this.request.acceptedConfirmationData?.length||this.request.rejectedConfirmationData?.length)&&this.turn.intentInvocation.confirmationHandler)return await this.turn.intentInvocation.confirmationHandler(this.request.acceptedConfirmationData,this.request.rejectedConfirmationData,this.stream),{}}fixMessageNames(t,r){r.forEach(o=>{o.role!=="system"&&"name"in o&&o.name===t?.id&&(o.name=void 0)})}async fetchConversationResponse(t,r,o,s,a,c,l,u,d,p){let f=O8();this.turn.requestId=this.chatTelemetry.telemetryMessageId,this.turn.modelMessageId=f.properties.messageId,r=c.spyOnStream(r);let m=u?.disable?void 0:this._instantiationService.createInstance(wC,{requestId:this.turn.requestId,references:this.turn.references},r,u?.additionaLinkifiers??[],this.token);r=m??r,r=Ad.spy(r,I=>{I instanceof ki&&p.markEmittedMarkdown(I.value),I instanceof _c&&p.markEmittedEdits(I.uri,I.edits)});let h=new a0,g=l.processResponse(this.turn,a,h.stream,r,this.token);if(a.length===0)return h.resolve(),await g,await m?.finalize(),{};let y=!1;g.finally(()=>{y=!0});let b=await this._chatMLFetcher.fetchOne(t,a,async(I,S,w)=>(p.markReceivedToken(),h.update(I,w),y?I.length:void 0),this.token,this.location,o,void 0,{temperature:this.calculateTemperature()},d,{intent:!0});h.resolve();let _=await g,x=b.type==="success"?b.value:"";if(m){try{await m.finalize()}catch(I){if(!wo(I))throw I}p.markAddedLinks(m.totalAddedLinkCount)}if(this.location===1&&b.type==="success"&&b.value.length===0)return p.sendTelemetry(b.requestId,"unknown","Empty response",c.interactionOutcome),{};switch(this._surveyService.signalUsage(`${this.location===1?"inline":"panel"}.${this.intent.id}`,this.documentContext?.document.languageId),p.sendTelemetry(b.requestId,b.type,x,c.interactionOutcome),b.type){case"success":return await this.processSuccessfulFetchResult(x,b.requestId,_??{},f);case"offTopic":return this.processOffTopicFetchResult(s);case"canceled":{let I=Cd(b);return this.turn.status="cancelled",this.turn.response={message:I.message,type:"user"},{errorDetails:I}}case"rateLimited":{let I=Cd(b);return this.turn.status="error",{errorDetails:I}}case"badRequest":case"failed":{let I=Cd(b);return this.turn.status="error",this.turn.response={message:I.message,type:"server"},{errorDetails:I}}case"filtered":{let I=Cd(b);return this.turn.status="filtered",{errorDetails:I}}case"agent_unauthorized":return this.turn.status="error",{};case"agent_failed_dependency":{let I=Cd(b);return this.turn.status="error",{errorDetails:I}}case"length":{let I=Cd(b);return this.turn.status="error",{errorDetails:I}}case"unknown":{let I=Cd(b);return this.turn.status="error",{errorDetails:I}}case"extensionBlocked":{let I=Cd(b);return this.turn.status="error",{errorDetails:I}}}}async processSuccessfulFetchResult(t,r,o,s){if(t.length===0){let a=RC.t("The model unexpectedly did not return a response, which may indicate a service issue. Please report a bug.");return this.turn.status="error",this.turn.response={type:"meta",message:a},{errorDetails:{message:a}}}return this.turn.status="success",this.turn.response={message:t,type:"model"},s.markAsDisplayed(),M8(this._telemetryService,this.conversation,this.sessionId,this.location,t,r,this.documentContext?.document,s),o}processOffTopicFetchResult(t){return this.stream.markdown(this.options.rejectionMessage),this.turn.response={message:this.options.rejectionMessage,type:"offtopic-detection"},this.turn.status="off-topic",{}}calculateTemperature(){return this.request.attempt>0?Math.min(this.options.temperature*(this.request.attempt+1),2):this.options.temperature}};ff=E([v(10,H),v(11,va),v(12,ge),v(13,oe),v(14,Et),v(15,pf)],ff);var mf=q(Ve());var Tl=re("ITestProvider");var A0=class{constructor(e,t,r,o,s,a,c,l,u,d){this.location=e;this.logService=t;this.chatMLFetcher=r;this.endpointProvider=o;this.telemetryService=s;this.configurationService=a;this.testProvider=c;this.intentService=l;this.instantiationService=u;this.tabsAndEditorsService=d}async provideParticipantDetection(e,t,r,o){if(r.location!==1||this.configurationService.getNonExtensionConfig("chat.experimental.detectParticipant.enabled")===!1||(await this.endpointProvider.getChatEndpoint(e)).family.startsWith("o1"))return;let a=new Es(e.references),c=new Vp;this.instantiationService.invokeFunction(u=>eN(u,c,t.history));let l;try{let u=await this.detectIntent(void 0,e.prompt,void 0,o,void 0,void 0,void 0,a,c.turns),d=r.participants?.filter(p=>p.participant!==EY&&!p.participant.startsWith(IY)&&p.disambiguation.length)??[];if(u&&"participant"in u)return l=u,u;if(u){l=u.id;let p=K5(u.id);if(p)return{participant:Bv(p.agent),command:p.command}}else if(d.length){let p=await this.detectIntent(void 0,e.prompt,void 0,o,void 0,void 0,!0,new Es(e.references),c.turns,d);if(p&&"participant"in p)return l=p,p}}finally{if(l){let u=this.tabsAndEditorsService.activeTextEditor?.document,d=u?Bt.create(u):void 0;this.collectIntentDetectionContextInternal(e.prompt,l,a,c.turns.slice(0,-1),d)}}}async detectIntent(e,t,r,o,s,a,c,l,u,d){this.logService.public.trace("Building intent detector");let p=await this.endpointProvider.getChatEndpoint("gpt-4o-mini"),f=Fe.create(this.instantiationService,p,this.location===1?Sh:tJ,{preferredIntent:a,location:this.location,userQuestion:t,documentContext:e,history:u,chatVariables:l,thirdPartyParticipants:d}),{messages:m,metadata:h}=await f.render(void 0,o);this.logService.public.trace("Built intent detector");let g=[],y=async(S,w,R)=>{if(R.copilotFunctionCalls)for(let k of R.copilotFunctionCalls)g.push({name:k.name,arguments:JSON.parse(k.arguments)})},b=await this.chatMLFetcher.fetchMany("intentDetection",m,y,o,this.location,p,void 0,{stop:[";"],n:1}),_=this.validateResult(b,s,t,g.map(S=>S.name),a,d),x=_&&"id"in _?_?.id:_?.participant;this.sendTelemetry(a,x,e?.language.languageId,c);let I=h.get(q8);return this.sendInternalTelemetry(t,a,I?.filePath,I?.fileExcerpt,x,e?.language.languageId,c,m.slice(0,-1)),_}async collectIntentDetectionContextInternal(e,t,r,o=[],s){let a=await this.endpointProvider.getChatEndpoint("gpt-4o-mini"),{messages:c}=await Qi(this.instantiationService,a,zs,{document:s}),{messages:l}=await Qi(this.instantiationService,a,c0,{history:o,priority:1e3},void 0,void 0,{validate:!1}).catch(()=>({messages:[]})),{history:u,fileExcerpt:d,attachedContext:p,fileExcerptExceedsBudget:f}=this.prepareInternalTelemetryContext(c?.[0]?.content,l,r);this.telemetryService.sendInternalMSFTTelemetryEvent("participantDetectionContext",{chatLocation:lt.toString(this.location),userQuery:e,history:u.join(""),assignedIntent:typeof t=="string"?t:void 0,assignedThirdPartyChatParticipant:typeof t!="string"?t.participant:void 0,assignedThirdPartyChatCommand:typeof t!="string"?t.command:void 0,fileExcerpt:d??(f?"<truncated>":"<none>"),attachedContext:p.join(";")},{})}getFunctions(e){let t=e!==void 0&&an(e.document.uri);return Sh.getDetectableIntents(this.location,t,this.intentService,this.configurationService,this.testProvider).map(r=>({name:r.id,functionName:r.intentDetectionInput.functionName,description:r.intentDetectionInput.modelDescription||r.description}))}validateResult(e,t,r,o,s,a){if(e.type!=="success"){t&&this.sendPromptIntentErrorTelemetry(t,e);return}let c=o?.length?o.map(p=>{let[f,m]=p.replaceAll("```","").split(".");return(m??f).replaceAll("'","")}):e.value.map(p=>p.trimStart().split(`
`)[0].replaceAll("```","").replace(/function id:|response:/i,"").trim());if(c=c.filter(p=>p!==Ac.ID),!c.length&&s&&(c=[s]),c[0]==="github_questions"||c[0]==="web_questions")return{participant:EY};let l=a?.reduce((p,f)=>(f.disambiguation.forEach(m=>{p[m.category??m.categoryName]={participant:f.participant,command:f.command}}),p),{}),u=c.map(p=>this.intentService.getIntent(p,this.location)??(this.location===1?this.intentService.getIntentByFunctionName(p,this.location):void 0)??(g_e[p]&&this.intentService.getIntent(g_e[p],this.location))??l?.[p]).filter(p=>p!==void 0)?.[0],d=u&&"id"in u?u?.id:u?.participant;if(this.logService.internal.debug(`picked intent "${d}" from ${JSON.stringify(e.value,null,"	")}`),t){let p=t.extendedBy({messageText:r,promptContext:c.join(),intent:d||"unknown"});this.telemetryService.sendRestrictedGHTelemetryEvent("conversation.promptIntent",p.raw.properties,p.raw.measurements)}return u}sendPromptIntentErrorTelemetry(e,t){let r=e.extendedBy({resultType:t.type,reason:t.reason});this.telemetryService.sendRestrictedGHTelemetryErrorEvent("conversation.promptIntentError",r.raw.properties,r.raw.measurements)}sendTelemetry(e,t,r,o){this.telemetryService.sendMSFTTelemetryEvent("intentDetection",{chatLocation:lt.toString(this.location),preferredIntent:e??"<none>",detectedIntent:t??"<none>",languageId:r??"<none>",isRerunWithoutIntentDetection:String(o)??"<none>"})}prepareInternalTelemetryContext(e,t,r){let o=5e3,s=[];if(r)for(let l of r){let u=Buffer.byteLength(l.uniqueName,"utf8");if(o-u<0)break;o-=u,s.push(l.uniqueName)}let a=!1;if(e){let l=Buffer.byteLength(e,"utf8");l>o?(a=!0,e=void 0):o-=l}else e=void 0;let c=[];for(let l=t.length-1;l>=0;l-=1){let u=t[l],d=`${u.role.toUpperCase()}: ${u.content}

`,p=Buffer.byteLength(d,"utf8");if(o-p<0)break;c.push(d),o-=p}return{fileExcerpt:e,fileExcerptExceedsBudget:a,history:c.reverse(),attachedContext:s}}sendInternalTelemetry(e,t,r,o,s,a,c,l){let{fileExcerpt:u,history:d}=this.prepareInternalTelemetryContext(o,l);this.telemetryService.sendInternalMSFTTelemetryEvent("intentDetection",{chatLocation:lt.toString(this.location),request:e,preferredIntent:t??"<none>",filePath:r??"<none>",fileExerpt:u??"<none>",detectedIntent:s??"<none>",languageId:a??"<none>",isRerunWithoutIntentDetection:String(c)??"<none>",history:d.join("")},{})}};A0=E([v(1,oe),v(2,Et),v(3,_e),v(4,ge),v(5,be),v(6,Tl),v(7,Ld),v(8,H),v(9,$t)],A0);var q8=class extends mf.PromptMetadata{constructor(t,r){super();this.fileExcerpt=t;this.filePath=r}},Sh=class extends mf.PromptElement{constructor(t,r,o,s,a,c){super(t);this._ignoreService=r;this._configurationService=o;this._testProvider=s;this._intentService=a;this._authService=c}static getDetectableIntents(t,r,o,s,a){let c=o.getIntents(t),l=[];for(let u=0;u<c.length;u++){let d=c[u];d.id==="review"&&!s.getConfig(le.ReviewIntent)||d.id==="fixTestFailure"&&(!a.isEnabled.get()||ti.isEmpty(a.getAllFailures()))||d.id==="tests"&&r||d.commandInfo?.defaultEnablement===!1||d.intentDetectionInput.disabled&&t===2||l.push(d)}return l}async prepare(t,r,o){let{documentContext:s}=this.props,a=!1;return s!==void 0&&(a=await this._ignoreService.isCopilotIgnored(s.document.uri)),{isDocumentCopilotIgnored:a}}render(t){let{preferredIntent:r,location:o,userQuestion:s,documentContext:a}=this.props,c,l,u;try{if(a!==void 0&&!t.isDocumentCopilotIgnored){let{document:h,selection:g}=a;c=h.uri;let y=new Me(new Sn(Math.max(g.start.line-5,0),0),new Sn(Math.min(g.end.line+5,h.lineCount),h.lineAt(g.end.line).text.length));l=h.getText(y),u=l.trim().length>0?vscpp(tt,{uri:c,languageId:h.languageId,code:l,shouldTrim:!1}):void 0}}catch{}let d=new q8(l,c?.path),p=a!==void 0&&an(a.document.uri),f=Sh.getDetectableIntents(o,p,this._intentService,this._configurationService,this._testProvider),m=(r?this._intentService.getIntent(r,o)?.intentDetectionInput.functionName:void 0)??r;return vscpp(vscppf,null,vscpp("meta",{value:d}),vscpp(mf.SystemMessage,null,'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.",vscpp("br",null)),vscpp(mf.UserMessage,null,"A software developer is using an AI chatbot in a code editor",c&&` in file ${c.path}`,".",vscpp("br",null),u===void 0?vscpp("br",null):vscpp(vscppf,null,"Current active file contains following excerpt:",vscpp("br",null),u,vscpp("br",null)),"The developer added the following request to the chat and your goal is to select a function to perform the request.",vscpp("br",null),m&&`The developer probably wants Function Id '${m}', pick different only if you're certain.`,vscpp("br",null),"Request: ",s,vscpp("br",null),vscpp("br",null),"Available functions:",vscpp("br",null),f.map(h=>vscpp(vscppf,null,"Function Id: ",h.id,vscpp("br",null),"Function Description: ",h.intentDetectionInput.modelDescription||h.description,vscpp("br",null),vscpp("br",null))),vscpp("br",null),"Here are some examples to make the instructions clearer:",vscpp("br",null),f.map(h=>vscpp(vscppf,null,"Request: ",h.intentDetectionInput.sampleQuestion,vscpp("br",null),"Response: ",h.id,vscpp("br",null),vscpp("br",null))),"Request: ",s,vscpp("br",null),"Response:"))}};Sh=E([v(1,Te),v(2,be),v(3,Tl),v(4,Ld),v(5,xt)],Sh);var g_e={workspace_questions:"workspace",create_workspace_or_extension:"unknown",create_new_workspace:"unknown",create_jupyter_notebook:"newNotebook",create_new_jupyter_notebook:"newNotebook",vscode_questions:"unknown",github_questions:"github",web_questions:"github",create_tests:"tests",generate_test_for_code:"tests",set_up_tests:"setupTests",terminal_state_questions:"terminalExplain",configure_python_environment:"vscode",generate_with_workspace_context:"workspace",generate_code_sample:"unknown",unknown:"unknown"},ZX=class extends mf.PromptElement{render(){let{includeSetupTests:e}=this.props;return vscpp(vscppf,null,'| workspace_questions | The user wants to learn about the code or files in their current workspace. Questions in this category may be about understanding what the whole workspace does or locating the implementation of some code. | "What does this project do?" |',vscpp("br",null),'| generate_with_workspace_context | The user wants to generate code based on multiple files in the workspace and did not specify which files to reference. | "Create a README for this project." |',vscpp("br",null),'| generate_code_sample | The user wants to generate code snippets without referencing the contents of the current workspace. This category does not include generating entire projects. | "Write an example of computing a SHA256 hash." |',vscpp("br",null),'| create_workspace_or_extension | The user wants to create a complete workspace from scratch in Visual Studio Code, such as a new application or Visual Studio Code extension. The user may have specified individual files that you should refer to. This does not include requests to generate individual methods or files. | "Scaffold a Node server." |',vscpp("br",null),'| configure_python_environment | The user wants to set up their Python environment. | "Create a virtual environment for my project." |',vscpp("br",null),'| create_tests | The user wants to generate unit tests. | "Generate tests for my selection using pytest." |',vscpp("br",null),e&&vscpp(vscppf,null,'| set_up_tests | The user wants to configure project test setup, framework, or test runner. | "Set up tests for this project." |',vscpp("br",null)),'| create_jupyter_notebook | The user wants to create a new Jupyter notebook in Visual Studio Code. | "Create a notebook to analyze this CSV file." |',vscpp("br",null),'| vscode_questions | The user wants to learn about, use, or configure the editor, terminal, debugger, tasks, extensions, commands, or settings in Visual Studio Code. This category does not include creating VS Code extensions or generating and explaining code. | "Switch to light mode." |',vscpp("br",null),'| terminal_state_questions | The user wants to learn about specific state such as the selection, command, or failed command in the integrated terminal in Visual Studio Code. | "Why did the latest terminal command fail?" |',vscpp("br",null),'| github_questions | The user is asking about an issue, pull request, branch, commit hash, diff, discussion, repository, or published release on GitHub.com.  This category does not include performing local Git operations using the CLI. | "What has been changed in the pull request 1361 in browserify/browserify repo?" |',vscpp("br",null),'| web_questions | The user is asking a question that requires current knowledge from a web search engine. Such questions often reference time periods that exceed your knowledge cutoff. | "What is the latest LTS version of Node.js?" |',vscpp("br",null),`| unknown | The user's question does not fit exactly one of the categories above, is about a product other than Visual Studio Code or GitHub, or is a general question about code, code errors, or software engineering. | "How do I center a div in CSS?" |`,vscpp("br",null))}},eJ=class extends mf.PromptElement{render(){return vscpp(vscppf,null,this.props.participants.flatMap(e=>e.disambiguation.map(t=>vscpp(vscppf,null,"| ",t.category??t.categoryName," | ",t.description," | ",t.examples[0]?`"${t.examples[0]}"`:"--"," |",vscpp("br",null)))),vscpp("br",null),`| unknown | The user's question does not fit exactly one of the categories above or is a general question about code, code errors, or software engineering. | "How do I center a div in CSS?" |`,vscpp("br",null))}},tJ=class extends Sh{render(){let{history:e,chatVariables:t,userQuestion:r}=this.props,o=!!this._authService.copilotToken?.isInternal,s=this._configurationService.getConfig(le.SetupTests);return vscpp(vscppf,null,vscpp(Nt,{history:e||[],passPriority:!0,historyPriority:800},vscpp(Tt,null,`You are a helpful AI programming assistant to a user who is a software engineer, acting on behalf of the Visual Studio Code editor. Your task is to choose one category from the Markdown table of categories below that matches the user's question. Carefully review the user's question, any previous messages, and any provided context such as code snippets. Respond with just the category name. Your chosen category will help Visual Studio Code provide the user with a higher-quality response, and choosing incorrectly will degrade the user's experience of using Visual Studio Code, so you must choose wisely. If you cannot choose just one category, or if none of the categories seem like they would provide the user with a better result, you must always respond with "unknown".`,vscpp("br",null),vscpp("br",null),"| Category name | Category description | Example of matching question |",vscpp("br",null),"| -- | -- | -- |",vscpp("br",null),this.props.thirdPartyParticipants?vscpp(eJ,{participants:this.props.thirdPartyParticipants}):vscpp(ZX,{includeSetupTests:o&&s}))),vscpp($n,{query:r,chatVariables:t,priority:900}))}};var Ex;(e=>{function n(t,r){let{options:o,document:s,selection:a,visibleRanges:c}=t,l=Bt.create(s),u={insertSpaces:o.insertSpaces,tabSize:o.tabSize},d=Rr(l);return r||(c.length===1?r=c[0]:c.length>1?r=c[0].union(c[c.length-1]):r=a),{document:l,fileIndentInfo:u,language:d,selection:a,wholeRange:r}}e.fromEditor=n})(Ex||={});var D0=class{constructor(e,t,r,o,s,a,c,l,u,d,p,f){this.request=t;this.stream=r;this.token=o;this.chatAgentArgs=s;this._instantiationService=a;this._commandService=c;this._ignoreService=l;this._intentService=u;this._conversationStore=d;this._logService=f;this.location=oQe(t),this.intentDetector=this._instantiationService.createInstance(A0,this.location),this.conversation=new Vp;let m=a.invokeFunction(h=>eN(h,this.conversation,e));this._sessionId=m??Gt(),this.turn=this.newTurn(this.request),this.documentContext=this._inferDocumentContext(p.activeTextEditor,e),this.chatTelemetry=this._instantiationService.createInstance(_C,Date.now(),this._sessionId,this.documentContext,this.conversation.turns.length===1,this.request),this.turn.userMessageId=this.chatTelemetry.telemetryMessageId}async sanitizeVariables(){let e=this.request.references.map(async r=>{let o=!1;return r.value instanceof zt&&(o=await this._ignoreService.isCopilotIgnored(r.value)),o&&r.range&&(this.turn.request.message=this.turn.request.message.slice(0,r.range[0])+this.turn.request.message.slice(r.range[1])),o?null:r}),t=zn(await Promise.all(e));return{...this.request,references:t}}async getResult(){this._logService.public.trace(`[${lt.toStringShorter(this.location)}] chat request received from extension host`);try{this.request=await this.sanitizeVariables();let e=this.chatAgentArgs.intentId?this._commandService.getCommand(this.chatAgentArgs.intentId,this.location):void 0,t=this.checkCommandUsage(e);if(!t){let r=this.conversation.turns.slice(0,-1),o=await this.selectIntent(e,this.turn,r),s;typeof o.requestHandler=="function"?s=this._instantiationService.createInstance(o.requestHandler,o,this._sessionId,this.conversation,this.request,this.stream,this.token,this.documentContext,this.chatAgentArgs.agentName,this.location,this.chatTelemetry):s=this._instantiationService.createInstance(ff,o,this._sessionId,this.conversation,this.request,this.stream,this.token,this.documentContext,this.chatAgentArgs.agentName,this.location,this.chatTelemetry),this.request.isParticipantDetected||this.intentDetector.collectIntentDetectionContextInternal(this.turn.request.message,this.request.enableCommandDetection?o.id:"none",new Es(this.request.references),r,this.documentContext?.document),t=await s.getResult()}return this._conversationStore.addConversation(this.turn.requestId,this.conversation),{...t,metadata:{...t.metadata,modelMessageId:this.turn.modelMessageId??"",responseId:this.turn.requestId,sessionId:this._sessionId,agentId:this.chatAgentArgs.agentId,command:this.request.command}}}catch(e){throw e}}newTurn(e){let t={message:e.prompt,type:"user"},r=new nx(t,this._sessionId);return r.promptVariables=new Es(e.references),this.conversation.addTurn(r),r}_inferDocumentContext(e,t){let r;if(this.request.location2 instanceof fY){let{document:o,wholeRange:s,selection:a}=this.request.location2;r={document:Bt.create(o),language:Rr(o),wholeRange:s,selection:a,fileIndentInfo:void 0}}else if(this.request.location2 instanceof mY){let{cell:o}=this.request.location2;r={document:Bt.create(o),language:Rr(o),wholeRange:new Me(0,0,0,0),selection:new Hp(0,0,0,0),fileIndentInfo:void 0}}else e&&(r=Ex.fromEditor(e));if(r){let s=aF(this.conversation.turns,a=>!!a.inlineResponseInfo)?.inlineResponseInfo;s&&s.store&&s.store.lastDocumentContent===r.document.getText()&&(r.wholeRange=s.store.lastWholeRange,this._logService.public.debug("Ignoring passed in whole range and using the whole range from the previous turn"))}return e&&e?.document.uri.toString()===r?.document.uri.toString()&&!r.fileIndentInfo&&(r.fileIndentInfo={insertSpaces:e.options.insertSpaces,tabSize:e.options.tabSize}),r}async selectIntent(e,t,r){let o=e?.intent;if(!o&&this.location===1){let s;this.location===1&&this.documentContext&&this.request.attempt===0&&r.length===0&&(this.documentContext.selection.isEmpty&&this.documentContext.document.lineAt(this.documentContext.selection.start.line).text.trim()===""?s="generate":!this.documentContext.selection.isEmpty&&this.documentContext.selection.start.line!==this.documentContext.selection.end.line&&(s="edit"));let a=this.request.enableCommandDetection,c=this.intentDetector.detectIntent(this.documentContext,this.request.prompt,this.chatAgentArgs.agentId,this.token,this.chatTelemetry.baseUserTelemetry,s,this.request.attempt>0&&this.request.enableCommandDetection,new Es([]),r,[]);if(a&&(o=await c,this.location===1&&o?.id==="edit"&&this.documentContext&&this.documentContext.selection.isEmpty&&this.documentContext.document.lineAt(this.documentContext.selection.start.line).text.trim()===""&&(o=this._intentService.getIntent("generate",1)),o)){let l=this._commandService.getCommand(o.id,this.location);l&&this.stream.detectedParticipant(this.chatAgentArgs.agentId,{name:l.commandId,description:l.details})}}return o??this._intentService.unknownIntent}checkCommandUsage(e){if(e?.intent&&!(e.intent.commandInfo?.allowsEmptyArgs??!0)&&!this.turn.request.message){let t=K5(e.intent.id),r="";t&&(r=`@${t.agent} `,t.command&&(r+=` /${t.command}`),r+=` ${e.details}`);let o=v_e.t(`Please specify a question when using this command.

Usage: {0}`,r);return this.turn.response={type:"meta",message:o},this.turn.status="error",{errorDetails:{message:o}}}}};D0=E([v(5,H),v(6,mx),v(7,Te),v(8,Ld),v(9,Md),v(10,$t),v(11,oe)],D0);function eN(n,e,t){let r=n.get(mx),o=n.get(Md),s=n.get(Be),a,c;for(let l of t)if(l instanceof Lve)c=l;else{let u=nQe(o,l);if(u)e.addTurn(u);else if(c){let p=iQe(c,l,r,s);c=void 0,e.addTurn(p)}let d=l.result;typeof d.metadata?.sessionId=="string"&&(a=d.metadata.sessionId)}return a}function nQe(n,e){let t=rQe(e);return(t?n.getConversation(t):void 0)?.turns.find(o=>o.requestId===t)}function rQe(n){if(n instanceof Ove)return n.result?.metadata?.responseId}function iQe(n,e,t,r){let o=new nx({message:n.prompt,type:"user"});o.promptVariables=new Es(n.references);let s=e.response.map(l=>l instanceof ki?l.value.value:l instanceof Td?Kbe(l):"content"in l?l.content:l instanceof Z1?sQe(r,l):null).filter(Boolean).join(""),a=e.command||Qve(e.participant),c=t.getCommand(a,2);return o.response={message:s,type:"model",name:c?.commandId||Ac.ID},e.result.errorDetails?e.result.errorDetails?.responseIsFiltered?o.status="filtered":e.result.errorDetails.message==="Cancelled"?o.status="cancelled":o.status="error":o.status="success",o}function oQe(n){if(n.location2 instanceof fY)return 1;if(n.location2 instanceof mY)return 5;switch(n.location){case aD.Editor:return 1;case aD.Panel:return 2;case aD.EditingSession:return 3;case aD.Terminal:return 4;default:return 5}}function sQe(n,e){let t,r;if($e.isUri(e.value))r=wd(n,e.value),t=`\`${r}\``;else if(jp(e.value))r=wd(n,e.value.uri),t=`\`${r}\``;else if(wve(e.value))r=wd(n,e.value.location.uri),t=`\`${e.value.name}\``;else return"";return`[${t}](${r} ${e.title?`"${e.title}"`:""})`}var V8=q(ht()),nJ=q(require("path"));var DC=q(Ve());var PC=q(Ve());var dr=class extends PC.PromptElement{constructor(t,r,o,s){super(t);this.parserService=r;this.ignoreService=o;this.tokenizerProvider=s}async prepare(t){let r=this.tokenizerProvider.acquireTokenizer(t.endpoint),o=[];for(let l of this.props.input)await this.ignoreService.isCopilotIgnored(l.document.uri)||o.push(l);let s=o.map(l=>{let{document:u,change:d,selection:p}=l,f;if(d?.hunks.length){let m=d.hunks[0];f=[m.range.start.line>0?dr.enumeratedLines(u,0,m.range.start.line):"",...d.hunks.map((h,g,y)=>{let b=g+1<y.length?y[g+1].range.start.line:u.lineCount;return[dr.enumeratedChangeLines(h.text,h.range.start.line),`
`,h.range.end.line<b?dr.enumeratedLines(u,h.range.end.line,b):""]}).flat()].join("")}else if(p){let m=p.end.line+(p.end.character>0?1:0);f=dr.enumeratedSelectedLines(u,0,u.lineCount,p.start.line,m)}else f=dr.enumeratedLines(u,0,u.lineCount);return{input:l,hunks:[{range:new Me(0,0,l.document.lineCount,0),text:f}],tokens:r.tokenLength(f)}}),a=s.reduce((l,{tokens:u})=>l+u,0);if(this.props.logService.internal.info(`[CurrentChange] Full documents: ${a} tokens, ${t.tokenBudget} budget`),a<=t.tokenBudget)return{input:s.map(({input:l,hunks:u})=>({input:l,hunks:u}))};let c=s.slice().sort((l,u)=>u.tokens-l.tokens);for(let l of c){let{input:u,tokens:d}=l,{document:p,change:f,selection:m}=u;if(f?.hunks.length){let h=[],g=0;for(let y of f.hunks){let b=await Ws.getDefinitionAtRange(this.ignoreService,this.parserService,p,y.range,!1);if(b){let _=b.range.end.line+(b.range.end.character>0?1:0),x=y.range.end.line+(y.range.end.character>0?1:0),I=[y.range.start.line>b.range.start.line?dr.enumeratedLines(p,b.range.start.line,y.range.start.line):"",dr.enumeratedChangeLines(y.text,y.range.start.line),`
`,_>x?dr.enumeratedLines(p,x,_):""].join("");h.push({range:new Me(Math.min(y.range.start.line,b.range.start.line),0,Math.max(_,x),0),text:I}),g+=r.tokenLength(I)}else{let _=dr.enumeratedChangeLines(y.text,y.range.start.line),x=y.range.end.line+(y.range.end.character>0?1:0);h.push({range:new Me(y.range.start.line,0,x,0),text:_}),g+=r.tokenLength(_)}}l.hunks=h,l.tokens=g,a+=l.tokens-d}else if(m){let h=await Ws.getDefinitionAtRange(this.ignoreService,this.parserService,p,m,!1);if(h){let g=h.range.end.line+(h.range.end.character>0?1:0),y=m.end.line+(m.end.character>0?1:0),b=dr.enumeratedSelectedLines(p,h.range.start.line,g,m.start.line,y),_=r.tokenLength(b);l.hunks=[{range:h.range,text:b}],l.tokens=_,a+=l.tokens-d}else{let g=m.end.line+(m.end.character>0?1:0),y=dr.enumeratedSelectedLines(p,m.start.line,g,m.start.line,g);l.hunks=[{range:new Me(m.start.line,0,g,0),text:y}],l.tokens=r.tokenLength(y),a+=l.tokens-d}}else l.hunks=[],l.tokens=0,a+=l.tokens-d;if(this.props.logService.internal.info(`[CurrentChange] Reduced ${u.relativeDocumentPath} to defintions: ${a} tokens, ${t.tokenBudget} budget`),a<=t.tokenBudget)return{input:s.map(({input:h,hunks:g})=>({input:h,hunks:g}))}}if(this.props.logService.public.info(`[CurrentChange] Still too large: ${a} tokens, ${t.tokenBudget} budget, ${s.length} inputs`),s.length>1){let l=new Error("Split prompt.");throw l.code="split_input",l}return{input:s.map(({input:l,hunks:u})=>({input:l,hunks:u}))}}render(t,r){let o=t.input.filter(s=>s.hunks.length>0);if(o.length)return vscpp(vscppf,null,vscpp(PC.UserMessage,{priority:this.props.priority},o.map(s=>vscpp(vscppf,null,s.input.change?vscpp(vscppf,null,"Change at cursor:",vscpp("br",null),vscpp("br",null),"Each line is annotated with the line number in the file.",vscpp("br",null)):vscpp(vscppf,null,"Current selection with the selected lines labeled as such:",vscpp("br",null)),vscpp("br",null),"From the file: ",s.input.relativeDocumentPath,vscpp("br",null),s.hunks.map(a=>vscpp(tt,{references:[new PC.PromptReference(new ar(s.input.document.uri,a.range))],uri:s.input.document.uri,range:a.range,code:a.text,languageId:`${s.input.document.languageId}/${s.input.relativeDocumentPath}: FROM_LINE: ${a.range.start.line+1} - TO_LINE: ${a.range.end.line}`})),vscpp("br",null),vscpp("br",null)))))}static async getCurrentChanges(t,r){let o=t.getExtensionApi();return o?(await Promise.all(o.repositories.map(async a=>{let c=await(r==="index"?a.diffIndexWithHEAD():r==="workingTree"?a.diffWithHEAD():a.diffWith("HEAD"));return await Promise.all(c.map(async u=>{let d=await(r==="index"?a.diffIndexWithHEAD(u.uri.fsPath):a.diffWithHEAD(u.uri.fsPath));return{repository:a,uri:u.uri,hunks:dr.parseDiff(d).map(p=>dr.gitHunkToHunk(p))}}))}))).flat():[]}static async getCurrentChange(t,r,o){let s=Bt.create(r),c=t.get(Ji).getExtensionApi();if(!c)return;let l=c.getRepository(s.uri);if(!l)return;let u=await l.diffWithHEAD(s.uri.fsPath);if(!u)return;let p=dr.parseDiff(u).find(f=>f.additions.some(m=>{let h=m.start-1,g=h+m.length-1;return o.line>=h&&o.line<=g}));if(p)return{repository:l,uri:s.uri,hunks:[dr.gitHunkToHunk(p)]}}static async getChanges(t,r,o,s){let a=t.getExtensionApi();if(!a)return;let c=dr.parseDiff(s),l=a.repositories.find(u=>u.rootUri.toString().toLowerCase()===r.toString().toLowerCase());if(l)return{repository:l,uri:o,hunks:c.map(u=>dr.gitHunkToHunk(u))}}static gitHunkToHunk(t){return{range:new Me(t.startAddedLine-1,0,t.startAddedLine-1+t.addedLines,0),text:t.diffText}}static parseDiff(t){let r=t.split(`
@@`);return r.length&&r[r.length-1].endsWith(`
`)&&(r[r.length-1]=r[r.length-1].slice(0,-1)),r.map(s=>{let a=s.match(/-(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))?/);if(a){let c=parseInt(a[1]),l=a[2]?parseInt(a[2]):1,u=parseInt(a[3]),d=a[4]?parseInt(a[4]):1,p=[],f=s.split(`
`).slice(1),m=0,h;for(let g of f){let y=g.charAt(0);y==="+"?(h===void 0&&(h=u+m),m++):(h!==void 0&&(p.push({start:h,length:u+m-h}),h=void 0),y===" "&&m++)}return h!==void 0&&(p.push({start:h,length:u+m-h}),h=void 0),c===0&&(c=1),u===0&&(u=1),{startDeletedLine:c,deletedLines:l,startAddedLine:u,addedLines:d,additions:p,diffText:f.join(`
`)}}return null}).filter(Boolean)}static enumeratedLines(t,r,o){return t.getText(new Me(r,0,o,0)).split(`
`).map((l,u)=>u===o-r?l:`/* Line ${r+u+1} */${l}`).join(`
`)}static enumeratedSelectedLines(t,r,o,s,a){return t.getText(new Me(r,0,o,0)).split(`
`).map((d,p)=>{if(p===o-r)return d;let f=r+p;return`/* ${s<=f&&f<a?"Selected ":""}Line ${f+1} */${d}`}).join(`
`)}static enumeratedChangeLines(t,r){let o=0;return t.split(`
`).filter(a=>a[0]!=="-").map((a,c)=>{let l=a[0],u=l==="-";return u&&o++,`/* ${u?"Removed Line":`${l==="+"?"Changed ":""}Line ${r+c-o+1}`} */${a.substring(1)}`}).join(`
`)}};dr=E([v(1,ft),v(2,Te),v(3,Qn)],dr);var AC=class extends DC.PromptElement{render(e,t){return vscpp(vscppf,null,vscpp(DC.SystemMessage,{priority:1001},"You are a world-class software engineer and the author and maintainer of the discussed code. Your feedback prefectly combines detailed feedback and explanation of context.",vscpp("br",null),vscpp(vn,null),vscpp(Ze,null),vscpp(ii,null),vscpp(kt,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"Think step by step:",vscpp("br",null),"1. Examine the provided code and any other context like user question, related errors, project details, class definitions, etc.",vscpp("br",null),"2. Provide feedback on the current ",this.props.input[0]?.change?vscpp(vscppf,null,"change"):vscpp(vscppf,null,"selection")," on where it can be improved or introduces a problem.",vscpp("br",null),"2a. Focus on naming conventions, readability, style and local logical correctness.",vscpp("br",null),"2b. Avoid commenting on correct code.",vscpp("br",null),"2c. Avoid commenting on commented out code.",vscpp("br",null),"2d. Keep scoping rules in mind.",vscpp("br",null),"3. Reply with an enumerated list of feedback with source line number, filepath, kind (bug, performance, consistency, documentation, naming, readability, style, other), severity (low, medium, high), and feedback text.",vscpp("br",null),"3a. E.g.: 1. Line 357 in src/flow.js, bug, high severity: `i` is not incremented.",vscpp("br",null),"3b. E.g.: 2. Line 361 in src/arrays.js, documentation, low severity: Function `binarySearch` is not documented.",vscpp("br",null),"3c. E.g.: 3. Line 176 in src/vs/platform/actionWidget/browser/actionWidget.ts, consistency, medium severity: The color id `'background.actionBar'` is not consistent with the other color ids used. Use `'actionBar.background'` instead.",vscpp("br",null),"3d. E.g.: 4. Line 410 in src/search.js, documentation, medium severity: Returning `-1` when the target is not found is a common convention, but it should be documented.",vscpp("br",null),"3e. E.g.: 5. Line 51 in src/account.py, bug, high severity: The deposit method is not thread-safe. You should use a lock to ensure that the balance update is an atomic operation.",vscpp("br",null),"3f. E.g.: 6. Line 220 in src/account.py, readability, low severity: The withdraw method is very long and combines multipe logical steps, consider splitting it into multiple methods.",vscpp("br",null),"4. Try to sort the feedback by file and line number.",vscpp("br",null),'5. When there is no feedback to provide, reply with "No feedback to provide."',vscpp("br",null),vscpp("br",null),"Focus on being clear, helpful, and thorough.",vscpp("br",null),"Use developer-friendly terms and analogies in your explanations.",vscpp("br",null),"Provide clear and relevant examples when helpful."),vscpp(Xi,{flexGrow:1,priority:700}),vscpp(DC.UserMessage,null,vscpp(sn,{priority:725,languageId:this.props.input[0]?.document.languageId,customIntroduction:"When providing feedback for code, please check for these user provided coding guidelines.",includeCodeFeedbackInstructions:!0})),vscpp(dr,{input:this.props.input,logService:this.props.logService,priority:1e3,flexGrow:2}),this.props.input.map(r=>vscpp(au,{document:r.document,range:r.selection,priority:800})),this.props.chatVariables&&this.props.query&&vscpp($n,{flexGrow:3,priority:900,chatVariables:this.props.chatVariables,query:this.props.query}))}};var j8=class{constructor(e,t){this.originalText=e;this._combinedEditsSinceStart=Rn.empty;this._text=t.apply(this.originalText),this._textAfterTrackedEdits=this._text,this._originalEdits=t}handleEdits(e){let t=e.apply(this._text),r=this._combinedEditsSinceStart.compose(e);r=r.removeCommonSuffixPrefix(this._textAfterTrackedEdits),this._combinedEditsSinceStart=r,this._text=t}computeTrackedEditsSurvivalScore(){let e=0,t=0,r=0,o=0,s=this._originalEdits.getNewTextRanges(),a=aQe(s,this._combinedEditsSinceStart);for(let c=0;c<s.length;c++){let l=this._originalEdits.edits[c],u=this.originalText.substring(l.replaceRange.start,l.replaceRange.endExclusive),d=l.newText,p=a[c],f=this._text.substring(p.start,p.endExclusive),m=tN(f,d),h=tN(d,u),g=tN(f,u);if(h!==1){let _=1-Math.max(g-h,0)/(1-h);r+=l.replaceRange.length*_,o+=l.replaceRange.length}let y=l.newText.length*m,b=l.newText.length;e+=y,t+=b}return{fourGram:t===0?1:e/t,noRevert:o===0?1:r/o}}};function tN(n,e){if(n.length<4||e.length<4)return n===e?1:0;let r=new Map;for(let c=0;c<=n.length-4;c++){let l=n.substring(c,c+4),u=r.get(l)||0;r.set(l,u+1)}for(let c=0;c<=e.length-4;c++){let l=e.substring(c,c+4),u=r.get(l)||0;r.set(l,u-1)}let o=n.length-4+1+e.length-4+1,s=0;for(let c of r.values())s+=Math.abs(c);return(o-s)/o}function aQe(n,e){n=n.slice();let t=[],r=0;for(let o of e.edits){for(;;){let a=n[0];if(!a||a.endExclusive>=o.replaceRange.start)break;n.shift(),t.push(a.delta(r))}let s=[];for(;;){let a=n[0];if(!a||!a.intersectsOrTouches(o.replaceRange))break;n.shift(),s.push(a)}for(let a=s.length-1;a>=0;a--){let c=s[a],l=c.intersect(o.replaceRange).length;c=c.deltaEnd(-l+(a===0?o.newText.length:0));let u=c.start-o.replaceRange.start;u>0&&(c=c.delta(-u)),a!==0&&(c=c.delta(o.newText.length)),c=c.delta(-(o.newText.length-o.replaceRange.length)),n.unshift(c)}r+=o.newText.length-o.replaceRange.length}for(;;){let o=n[0];if(!o)break;n.shift(),t.push(o.delta(r))}return t}var hf=class{constructor(e,t,r,o,s,a,c,l){this._document=e;this._originalDocumentText=t;this._edits=r;this._sendTelemetryEvent=s;this._gitService=c;this._telemetryService=l;this._editSurvivalTracker=new j8(this._originalDocumentText,this._edits);this._store=new _t;this._store.add(a.onDidChangeTextDocument(u=>{if(u.document!==this._document)return;let d=Rn.from(u.contentChanges);this._editSurvivalTracker.handleEdits(d)})),this._editSurvivalTracker.handleEdits(o),this._initialBranchName=this._getCurrentBranchName(),this._reportAfter(30*1e3),this._reportAfter(120*1e3),this._reportAfter(300*1e3),this._reportAfter(600*1e3,()=>{this._store.dispose()})}_getCurrentBranchName(){return this._gitService.getRepository(this._document.uri)?.headBranchName}_reportAfter(e,t){let r=new wF(()=>{this._report(e),r.dispose(),t&&t()},e);this._store.add(r)}_report(e){let t=this._editSurvivalTracker.computeTrackedEditsSurvivalScore(),o=this._getCurrentBranchName()!==this._initialBranchName;this._sendTelemetryEvent({telemetryService:this._telemetryService,fourGram:t.fourGram,noRevert:t.noRevert,timeDelayMs:e,didBranchChange:o})}};hf=E([v(5,Be),v(6,Ks),v(7,ge)],hf);function H8(n,e){return t=>{t.telemetryService.sendMSFTTelemetryEvent("inline.trackEditSurvival",n,{...e,survivalRateFourGram:t.fourGram,survivalRateNoRevert:t.noRevert,timeDelayMs:t.timeDelayMs,didBranchChange:t.didBranchChange?1:0})}}var N0=class{constructor(e,t,r,o,s,a){this.telemetryService=e;this.endpointProvider=t;this.fetcher=r;this.logService=o;this.instantiationService=s;this.ignoreService=a}async generateComments(e,t,r){let o=Date.now(),s=this.ignoreService,a=await Promise.all(e.map(_=>s.isCopilotIgnored(_.document.uri))),c=e.filter((_,x)=>!a[x]);if(c.length===0)return this.logService.public.info("All input documents are ignored. Skipping feedback generation."),{type:"error",severity:"info",reason:V8.t("All input documents are ignored by configuration. Check your .copilotignore file.")};let l=await this.endpointProvider.getChatEndpoint("gpt-4"),u=[],d=[c];for(;d.length;){let _=d.shift();try{let I=await Fe.create(this.instantiationService,l,AC,{input:_,logService:this.logService}).render();this.logService.internal.debug(`[FeedbackGenerator] Rendered batch of ${_.length} inputs.`),u.push(I)}catch(x){if(x.code==="split_input"){let I=Math.floor(_.length/2);d.unshift(_.slice(0,I),_.slice(I)),this.logService.internal.debug(`[FeedbackGenerator] Splitting in batches of ${d[0].length} and ${d[1].length} inputs due to token limit.`)}else throw x}}if(t.isCancellationRequested)return{type:"cancelled"};let p=c[0]?.selection?"selection":"change";if(u.length>10)return{type:"error",reason:p==="selection"?V8.t("There is too much text to review, try reviewing a smaller selection."):V8.t("There are too many changes to review, try reviewing a smaller set of changes.")};let m={source:"vscodeCopilotChat",promptCount:u.length,messageId:Gt(),inputType:p,inputRanges:c.map(_=>({uri:_.document.uri,ranges:_.selection?[_.selection]:_.change?.hunks.map(x=>x.range)||[]}))},h=Date.now(),g=await Promise.all(u.map(async _=>{let x=[],I=r?async R=>{let k=nN(m,c,R,!0);k.length>x.length&&(r.report(k.slice(x.length)),x=k)}:void 0,S=await this.fetcher.fetchOne("feedbackGenerator",_.messages,I,t,5,l,void 0,void 0,{messageId:m.messageId}),w=S.type==="success"?nN(m,c,S.value,!1):[];return r&&w&&w.length>x.length&&(r.report(w.slice(x.length)),x=w),{fetchResult:S,comments:w}})),y=g.find(_=>_.fetchResult.type!=="success")?.fetchResult||g[0].fetchResult,b=g.map(_=>_.comments).flat();return this.telemetryService.sendMSFTTelemetryEvent("feedback.generateDiagnostics",{model:l.model,requestId:y.requestId,responseType:y.type,source:m.source,messageId:m.messageId,documentType:c[0]&&an(c[0]?.document.uri)?"notebook":"text",languageId:c[0]?.document.languageId,inputType:m.inputType,commentTypes:[...new Set(b?.map(_=>rJ.has(_.kind)?_.kind:"unknown")).values()].sort().join(",")||void 0},{promptCount:u.length,numberOfDiagnostics:b?.length??-1,inputDocumentCount:m.inputRanges.length,inputLineCount:m.inputRanges.reduce((_,x)=>_+x.ranges.reduce((I,S)=>I+(S.end.line-S.start.line),0),0),timeToRequest:h-o,timeToComplete:Date.now()-o}),t.isCancellationRequested?{type:"cancelled"}:y.type==="success"?{type:"success",comments:b||[]}:{type:"error",reason:y.reason}}};N0=E([v(0,ge),v(1,_e),v(2,Et),v(3,oe),v(4,H),v(5,Te)],N0);var rJ=new Set(["bug","performance","consistency","documentation","naming","readability","style","other"]);function nN(n,e,t,r=!1){let o=[];for(let s of iJ(t,r)){let{relativeDocumentPath:a,from:c,to:l,kind:u,severity:d,content:p}=s;if(!rJ.has(u))continue;let f=a&&e.find(I=>I.relativeDocumentPath===a);if(!f)continue;let m=f.document,h=f.selection?[f.selection]:f.change?.hunks.map(I=>I.range),g=m.lineAt(c>=0?c:0),y=m.lineAt((l<=m.lineCount?l:m.lineCount)-1),b=y.text.trimEnd().length,_=new Me(g.lineNumber,g.firstNonWhitespaceCharacterIndex,y.lineNumber,b);if(h&&!h.some(I=>I.intersection(_)))continue;let x={request:n,document:m,uri:m.uri,languageId:m.languageId,range:_,body:new Ao(p),kind:u,severity:d,originalIndex:o.length,actionCount:0};o.push(x)}return o}function iJ(n,e=!1){let t=/(?<num>\d+)\. Line (?<from>\d+)(-(?<to>\d+))?([^:]*)( in `?(?<relativeDocumentPath>[^,:`]+))`?(, (?<kind>\w+))?(, (?<severity>\w+) severity)?: (?<content>.+?)((?=\n\d+\.|\n\n)|(?<earlyEnd>$))/gs;return zn(Array.from(n.matchAll(t),r=>{let o=r.groups;if(e&&typeof o.earlyEnd=="string")return;let s=parseInt(o.from)-1,a=o.to?parseInt(o.to):s+1,c=o.relativeDocumentPath?.replaceAll(nJ.default.sep==="/"?"\\":"/",nJ.default.sep),l=o.kind||"other",u=o.severity||"unknown",d=o.content.trim();if(d.endsWith("```")){let f=d.lastIndexOf("```",d.length-4);f!==-1&&(d=d.substring(0,f).trim())}let p=[...d.matchAll(/```/g)];if(p.length%2){let f=p[p.length-1];d=d.substring(0,f.index).trim()}return{relativeDocumentPath:c,from:s,to:a,linkOffset:r.index+o.num.length+2,linkLength:5+o.from.length+(o.to?o.to.length+1:0),kind:l,severity:u,content:d}}))}function L0(n,e,t,r,o,s){r.public.debug("[FeedbackGenerator] user feedback received");let a=Array.isArray(n)?n:[n],c=a[0];if(!c){r.public.warn("[FeedbackGenerator] No review comment found for user feedback");return}let l={source:c.request.source,messageId:c.request.messageId,userAction:t},u=rJ.has(c.kind)?c.kind:"unknown",d={source:c.request.source,requestId:c.request.messageId,documentType:an(c.uri)?"notebook":"text",languageId:c.languageId,inputType:c.request.inputType,commentType:u,userAction:t},p={commentIndex:c.originalIndex,actionCount:c.actionCount,inputDocumentCount:c.request.inputRanges.length,inputLineCount:c.request.inputRanges.reduce((f,m)=>f+m.ranges.reduce((h,g)=>h+(g.end.line-g.start.line),0),0),promptCount:c.request.promptCount,totalComments:e,comments:a.length,commentLength:a.reduce((f,m)=>f+(typeof m.body=="string"?m.body.length:m.body.value.length),0)};if(t==="helpful"||t==="unhelpful"?(o.sendMSFTTelemetryEvent("review.comment.vote",d,p),o.sendInternalMSFTTelemetryEvent("review.comment.vote",d),k0(o,void 0,l,{},"review.comment.vote")):(c.actionCount++,o.sendMSFTTelemetryEvent("review.comment.action",d,p),o.sendInternalMSFTTelemetryEvent("review.comment.action",d),k0(o,void 0,l,{},"review.comment.action")),t==="discardComment"){let{document:f,range:m}=c,h=f.offsetAt(m.start),g=f.offsetAt(m.end),y=f.getText(m);s.createInstance(hf,f.document,f.getText(),Rn.single(gt.ofStartAndLength(h,g-h),y),Rn.empty,cQe(d,p))}}function cQe(n,e){return t=>{t.telemetryService.sendMSFTTelemetryEvent("review.discardCommentRangeSurvival",n,{...e,survivalRateFourGram:t.fourGram,survivalRateNoRevert:t.noRevert,timeDelayMs:t.timeDelayMs,didBranchChange:t.didBranchChange?1:0})}}var iN=q(require("path")),Di=q(require("vscode"));var O0=require("vscode"),oJ,G8=class{constructor(e){this._outputChannel=O0.window.createOutputChannel("GitHub Copilot Chat",{log:!0});oJ=this._outputChannel,e.subscriptions.push(this._outputChannel)}logIt(e,t,...r){switch(e){case O0.LogLevel.Trace:this._outputChannel.trace(t);break;case O0.LogLevel.Debug:this._outputChannel.debug(t);break;case O0.LogLevel.Info:this._outputChannel.info(t);break;case O0.LogLevel.Warning:this._outputChannel.warn(t);break;case O0.LogLevel.Error:this._outputChannel.error(t);break}}};var sJ=q(require("path")),y_e=q(require("readline")),pu=q(require("vscode"));var lQe="github-code-review",uQe=!1;async function b_e(n,e,t,r,o,s,a,c,l,u){let d=e.getExtensionApi();if(!d)return{type:"success",comments:[]};let p=(typeof c=="string"?(await Promise.all(d.repositories.map(async _=>{let x=await(c==="index"?_.diffIndexWithHEAD():c==="workingTree"?_.diffWithHEAD():_.diffWith("HEAD"));return await Promise.all(x.map(async S=>{let w=await pu.workspace.openTextDocument(S.uri).then(void 0,()=>{});if(!w)return;let R=await(c==="index"||c==="all"?_.show("HEAD",S.uri.fsPath).catch(()=>""):_.show("",S.uri.fsPath).catch(()=>"")),k=c==="index"?await _.show("",S.uri.fsPath).catch(()=>""):w.getText(),V=sJ.relative(_.rootUri.fsPath,S.uri.fsPath);return{repository:_,uri:S.uri,relativePath:process.platform==="win32"?V.replace(/\\/g,"/"):V,before:R,after:k,document:w}}))}))).flat():await Promise.all(c.patches.map(async _=>{let x=pu.Uri.parse(_.fileUri),I=await pu.workspace.openTextDocument(x).then(void 0,()=>{});if(!I)return;let S=I.getText(),w=hQe(S,_.patch),R=sJ.relative(c.repositoryRoot,x.fsPath);return{repository:d.getRepository(pu.Uri.parse(c.repositoryRoot)),relativePath:process.platform==="win32"?R.replace(/\\/g,"/"):R,before:w,after:S,document:I}}))).filter(_=>!!_);if(!p.length)return{type:"success",comments:[]};let f=await Promise.all(p.map(_=>a.isCopilotIgnored(_.document.uri))),m=p.filter((_,x)=>!f[x]);if(m.length===0)return n.public.info("All input documents are ignored. Skipping feedback generation."),{type:"error",severity:"info",reason:pu.l10n.t("All input documents are ignored by configuration. Check your .copilotignore file.")};n.public.debug(`[github review agent] files: ${m.map(_=>_.relativePath).join(", ")}`);let{requestId:h,rl:g}=uQe?{requestId:"test-request-id",rl:["data: ...","data: [DONE]"]}:await mQe(n,t,r,o,s,m[0].repository,m.map(_=>({path:_.relativePath,content:_.before})),m.map(_=>({path:_.relativePath,content:_.after})),u);if(!g||u.isCancellationRequested)return{type:"cancelled"};n.public.info(`[github review agent] request id: ${h}`);let y={source:"githubReviewAgent",promptCount:-1,messageId:h||Gt(),inputType:"change",inputRanges:[]},b=[];for await(let _ of g){if(u.isCancellationRequested)return{type:"cancelled"};n.public.debug(`[github review agent] response line: ${_}`);for(let x of fQe(_)){let I=m.find($=>$.relativePath===x.data.path);if(!I)continue;let S=I.document,w=S.lineAt(x.data.line-1),R=w.text.trimEnd().length,k=new pu.Range(w.lineNumber,w.firstNonWhitespaceCharacterIndex,w.lineNumber,R),V=x.data.body,F=pQe(V),K={request:y,document:Bt.create(S),uri:S.uri,languageId:S.languageId,range:k,body:new pu.MarkdownString(F),kind:"bug",severity:"medium",originalIndex:b.length,actionCount:0};b.push(K),l.report([K])}}return{type:"success",comments:b}}var dQe=/```suggestion(\u0020*(\r\n|\n))((?<suggestion>[\s\S]*?)(\r\n|\n))?```/g;function pQe(n){return n.replaceAll(dQe,"")}var fQe=n=>{if(n==="data: [DONE]")return[];if(n==="")return[];let e=JSON.parse(n.replace("data: ",""));return Array.isArray(e.copilot_references)&&e.copilot_references.length>0?e.copilot_references.filter(r=>r.type==="github.generated-pull-request-comment"):[]};async function mQe(n,e,t,r,o,s,a,c,l){let u=s?await yQe(n,e,r,t,s):[],d={messages:[{role:"user",copilot_references:[{type:"github.pull_request",id:"1",data:{type:"pull-request",headFileContents:c,baseFileContents:a}},...u]}]},p=o.isProduction(),f=p?void 0:await ja(process.env.HMAC_SECRET),m=r.makeAbortController(),h=l.onCancellationRequested(()=>m.abort()),g;try{let _=await e.getCopilotToken();g=await r.fetch(`${t.remoteAgentsURL}/${lQe}`,{method:"POST",headers:{Authorization:"Bearer "+_.token,"Copilot-Integration-Id":p?"vscode-chat":"vscode-chat-dev",...f?{"Request-Hmac":f}:void 0,"X-Copilot-Code-Review-Mode":"ide",...o.getEditorVersionHeaders()},body:JSON.stringify(d),signal:m.signal})}catch(_){if(r.isAbortError(_))return{requestId:void 0,rl:void 0};throw _}finally{h.dispose()}let y=g.headers.get("x-github-request-id")||void 0;if(!g.ok){let _=await g.text();throw new Error(`Agent returned an unexpected HTTP ${g.status} error (request id ${y}): ${_}`)}let b=await g.body();if(!b)throw new Error(`Agent returned an unexpected response: got 200 OK, but response body was empty (request id ${y}).`);return{requestId:y,rl:y_e.createInterface({input:b})}}function hQe(n,e){let t=gQe(e.split(/\r?\n/));return vQe(n.split(/\r?\n/),t).join(`
`)}function gQe(n){let e=[],t=-1;for(let r of n)if(r.startsWith("@@")){let o=/@@ -(\d+),\d+ \+\d+,\d+ @@/.exec(r);o&&(t=parseInt(o[1],10))}else t!==-1&&(r.startsWith("+")?e.push({beforeLineNumber:t,content:r.slice(1),type:"add"}):(r.startsWith("-")&&e.push({beforeLineNumber:t,content:r.slice(1),type:"remove"}),t++));return e}function vQe(n,e){for(let t of e)t.type==="add"?n.splice(t.beforeLineNumber-1,1):t.type==="remove"&&n.splice(t.beforeLineNumber-1,0,t.content);return n}async function yQe(n,e,t,r,o){let{state:s}=o,a=s.HEAD?.upstream?.remote||s.HEAD?.remote,c=a&&s.remotes.find(y=>y.name===a)?.pushUrl||s.remotes.find(y=>y.pushUrl)?.pushUrl;if(!c)return[];let l=new URL(p8(c));if(l.hostname!=="github.com")return[];let u=l.pathname.split("/"),d=u[1],p=u[2].endsWith(".git")?u[2].substring(0,u[2].length-4):u[2],f=(await e.getAnyGitHubSession())?.accessToken;if(!f)return n.public.info(`Failed to fetch coding guidelines for ${d}/${p}: Not signed in.`),[];let m=await t.fetch(`${r.dotComAPIURL}/repos/${d}/${p}/copilot_internal/coding_guidelines`,{headers:{Authorization:`Bearer ${f}`}});return m.ok?(await m.json()).map((y,b)=>({type:"github.coding_guideline",id:`${b+2}`,data:{id:b+2,type:"coding-guideline",name:y.name,description:y.description,filePatterns:y.filePatterns}})):(m.status!==404&&n.public.info(`Failed to fetch coding guidelines for ${d}/${p}: ${m.statusText}`),[])}function bQe(n,e){let t=new ko,r=n.onCancellationRequested(()=>{t.cancel(),s()}),o=e.onCancellationRequested(()=>{t.cancel(),s()});function s(){r.dispose(),o.dispose()}return t.token}var rN;async function wx(n,e,t,r,o,s,a,c,l,u,d,p){let f=Di.window.activeTextEditor,m=f?.selection;if(d==="selection"){if(!f)return;if(!m||m.isEmpty)try{let g=await n.selectEnclosingScope(f,{reason:Di.l10n.t("Select an enclosing range to review"),includeBlocks:!0});if(!g)return;m=g}catch(g){if(wo(g))return}}let h=d==="selection"?Di.l10n.t("Reviewing selected code in {0}...",iN.default.posix.basename(f.document.uri.path)):d==="index"?Di.l10n.t("Reviewing staged changes..."):d==="workingTree"?Di.l10n.t("Reviewing unstaged changes..."):Di.l10n.t("Reviewing changes...");return Di.window.withProgress({location:Di.ProgressLocation.Notification,title:h,cancellable:!0},async(g,y)=>{rN&&rN.cancel();let b=rN=new ko(p?bQe(p,y):y);t.removeReviewComments(t.getReviewComments());let _={report:I=>{b.token.isCancellationRequested||t.addReviewComments(I)}},x;try{let I=await r.getCopilotToken();x=(d==="index"||d==="workingTree"||d==="all"||typeof d=="object")&&I.isCopilotCodeReviewEnabled?await b_e(o,s,r,a,c,l,u,d,_,b.token):await _Qe(e,s,d,f,_,b.token)}catch(I){x={type:"error",reason:I.message}}finally{b===rN&&(rN=void 0),b.dispose()}if(b.token.isCancellationRequested)return{type:"cancelled"};if(x.type==="error"){let I=Di.l10n.t("Show Log");await Di.window.showInformationMessage(x.severity==="info"?Di.l10n.t("Reviewing your code did not provide any feedback."):Di.l10n.t("Code review generation failed."),{modal:!0,detail:x.reason},...x.severity==="info"?[]:[I])===I&&oJ.show()}else x.type==="success"&&x.comments.length===0&&await Di.window.showInformationMessage(Di.l10n.t("Reviewing your code did not provide any feedback."),{modal:!0});return x})}async function _Qe(n,e,t,r,o,s){let a=n.createInstance(N0),c=[];if(t==="index"||t==="workingTree"||t==="all"){let l=await dr.getCurrentChanges(e,t);(await Promise.all(l.map(async d=>{try{let p=await Di.workspace.openTextDocument(d.uri);return{document:Bt.create(p),relativeDocumentPath:iN.default.relative(d.repository.rootUri.fsPath,d.uri.fsPath),change:d}}catch(p){try{if((await Di.workspace.fs.stat(d.uri)).type===Di.FileType.File)throw p;return}catch(f){if(f.code==="FileNotFound")return;throw p}}}))).map(d=>{d&&c.push(d)})}else if(t==="selection")c.push({document:Bt.create(r.document),relativeDocumentPath:iN.default.basename(r.document.uri.fsPath),selection:r.selection});else for(let l of t.patches){let u=$e.parse(l.fileUri);c.push({document:Bt.create(await Di.workspace.openTextDocument(u)),relativeDocumentPath:iN.default.relative(t.repositoryRoot,u.fsPath),change:await dr.getChanges(e,$e.file(t.repositoryRoot),u,l.patch)})}return a.generateComments(c,s,o)}var gi=q(require("vscode"));var M0=class extends gi.CodeAction{constructor(){super(...arguments);this.isAI=!0}},Ha=class{constructor(e,t,r){this.configurationService=e;this.ignoreService=t;this.reviewService=r}static{this.fixKind=gi.CodeActionKind.QuickFix.append("copilot")}static{this.explainKind=gi.CodeActionKind.QuickFix.append("explain").append("copilot")}static{this.reviewKind=gi.CodeActionKind.RefactorRewrite.append("review").append("copilot")}static{this.providedCodeActionKinds=[this.fixKind,this.explainKind,this.reviewKind]}static getSevereDiagnostics(e){let t=e.filter(r=>r.severity<=gi.DiagnosticSeverity.Warning);return t.length===0?[]:t}static getDiagnosticsAsText(e){return e.map(t=>t.message).join(", ")}async provideCodeActions(e,t,r){if(!this.configurationService.getConfig(le.EnableCodeActions)||await this.ignoreService.isCopilotIgnored(e.uri))return;let s=[],a=gi.window.activeTextEditor;if(!a)return s;if(this.reviewService.isCodeFeedbackEnabled()&&!a.selection.isEmpty){let h=new M0(gi.l10n.t("Review using Copilot"),Ha.reviewKind);h.command={title:h.title,command:"github.copilot.chat.review"},s.push(h)}let c=Ha.getSevereDiagnostics(r.diagnostics);if(c.length===0)return s;let l=c.map(h=>h.range).reduce((h,g)=>h.union(g)),u=new gi.Selection(l.start,l.end),d=Ha.getDiagnosticsAsText(c),p=new M0(gi.l10n.t("Fix using Copilot"),Ha.fixKind);p.diagnostics=c,p.command={title:p.title,command:"vscode.editorChat.start",arguments:[{autoSend:!0,message:`/fix ${d}`,position:l.start,initialSelection:u,initialRange:l}]};let f=new M0(gi.l10n.t("Explain using Copilot"),Ha.explainKind);f.diagnostics=c;let m=`@${WD} /explain ${d}`;return f.command={title:f.title,command:"github.copilot.chat.explain",arguments:[m]},s.push(p,f),s}};Ha=E([v(0,be),v(1,Te),v(2,ya)],Ha);var Bd=class{constructor(e,t,r,o,s){this.logger=e;this.configurationService=t;this.ignoreService=r;this.parserService=o;this.telemetryService=s}static{this.generateOrModifyKind=gi.CodeActionKind.RefactorRewrite.append("copilot")}static{this.generateDocsKind=gi.CodeActionKind.RefactorRewrite.append("generateDocs").append("copilot")}static{this.generateTestsKind=gi.CodeActionKind.RefactorRewrite.append("generateTests").append("copilot")}static{this.providedCodeActionKinds=[this.generateOrModifyKind,this.generateDocsKind,this.generateTestsKind]}async provideCodeActions(e,t,r){if(!this.configurationService.getConfig(le.EnableCodeActions)||await this.ignoreService.isCopilotIgnored(e.uri))return;let s=this.provideGenerateUsingCopilotCodeAction(e,t),a=await this.provideDocGenCodeAction(e,t),c=await this.provideTestGenCodeAction(e,t);return zn([a,s,c])}provideGenerateUsingCopilotCodeAction(e,t){let r;if(t.isEmpty){let s=e.lineAt(t.start.line).text;t.end.character===s.length&&/^\s*$/g.test(s)&&(r=gi.l10n.t("Generate using Copilot"))}else{let s=e.getText(t);/^\s*$/g.test(s)||(r=gi.l10n.t("Modify using Copilot"))}if(r===void 0)return;let o=new M0(r,Bd.generateOrModifyKind);return o.command={title:o.title,command:"vscode.editorChat.start",arguments:[{position:t.start,initialSelection:new gi.Selection(t.start,t.end),initialRange:t}]},o}async provideDocGenCodeAction(e,t){let r=e.offsetAt(t.start),o=e.offsetAt(t.end),s={startIndex:r,endIndex:o},a,c=this.parserService.getTreeSitterAST(e);if(c)try{a=await c.getDocumentableNodeIfOnIdentifier(s)}catch(p){this.logger.internal.error(p,"RefactorsProvider: getDocumentableNodeIfOnIdentifier failed"),this.telemetryService.sendGHTelemetryException(p,"RefactorsProvider: getDocumentableNodeIfOnIdentifier failed")}if(a===void 0)return;let l=gi.l10n.t("Generate Documentation using Copilot"),u=new M0(l,Bd.generateDocsKind),d=a.nodeRange===void 0?void 0:new Me(e.positionAt(a.nodeRange.startIndex),e.positionAt(a.nodeRange.endIndex));return u.command={title:l,command:"vscode.editorChat.start",arguments:[{autoSend:!0,message:"/doc",initialRange:d}]},u}async provideTestGenCodeAction(e,t){let r=Bt.create(e),o=r.offsetAt(t.start),s=r.offsetAt(t.end),a={startIndex:o,endIndex:s},c=null,l=this.parserService.getTreeSitterAST(r);if(l)try{c=await l.getTestableNode(a)}catch(f){this.logger.internal.error(f,"RefactorsProvider: getTestableNode failed"),this.telemetryService.sendGHTelemetryException(f,"RefactorsProvider: getTestableNode failed")}if(!c||!Gs(r,c.identifier.range).contains(t))return;let d=gi.l10n.t("Generate Tests using Copilot"),p=new M0(d,Bd.generateTestsKind);return p.command={title:d,command:"github.copilot.chat.generateTests"},p}};Bd=E([v(0,oe),v(1,be),v(2,Te),v(3,ft),v(4,ge)],Bd);var aJ=q(ht()),__e=require("util"),F0=q(require("vscode"));var xQe="application/vnd.code.notebook.error",NC=class{constructor(e){this.logService=e}async provideCellStatusBarItems(e,t){if(F0.workspace.getConfiguration("notebook").get("cellFailureDiagnostics"))return[];if(e.kind===F0.NotebookCellKind.Markup){let a=F0.workspace.getConfiguration("notebook.experimental").get("cellChat");if(!a)return[];let c=e.document.getText().trim();if(!a||c.length===0)return[];let l=aJ.t("Generate code from markdown content"),u=c;return[{text:"$(sparkle)",alignment:F0.NotebookCellStatusBarAlignment.Left,priority:Number.MAX_SAFE_INTEGER-1,tooltip:l,command:{title:l,command:"notebook.cell.chat.start",arguments:[{index:e.index+1,input:u,autoSend:!0}]}}]}let o=e.outputs.flatMap(a=>a.items).find(a=>a.mime===xQe);if(!o)return[];let s;try{let a=new __e.TextDecoder;if(s=JSON.parse(a.decode(o.data)),!s.name&&!s.message)return[];let c=aJ.t("Fix using Copilot"),l=[s.name,s.message].filter(Boolean).join(": ").replace(/\s*\(\S+,\s*line\s*\d+\)/,"");return[{text:"$(sparkle)",alignment:F0.NotebookCellStatusBarAlignment.Left,priority:Number.MAX_SAFE_INTEGER-1,tooltip:c,command:{title:c,command:"vscode.editorChat.start",arguments:[{autoSend:!0,message:`/fix ${l}`}]}}]}catch(a){this.logService.public.error(`Failed to parse error output ${a}`)}return[]}};NC=E([v(0,oe)],NC);function S_e(n){let e=n.get(H),t=n.get($t),r=n.get(Te),o=n.get(ya),s=n.get(oe),a=n.get(ge),c=n.get(qt),l=new _t,u=async(k,V)=>{let F=`@${WD} /explain `,K,$,j=!1;if(typeof k=="string"&&k)F=k;else{let D=zs.getCurrentSelection(t,!0);if(D){let B=Ct.languages.getDiagnostics(D.activeDocument.uri),U=B.filter(ae=>!!ae.range.intersection(D.range));Ha.getSevereDiagnostics(U).length&&(F+=Ha.getDiagnosticsAsText(B),j=!0)}let A=zs.getCurrentSelection(t);if(!j&&A&&(F+=r8,K=Kv.formatSelection({languageId:A.languageId,selectedText:A.selectedText}),$=A.activeDocument.uri),!j&&D&&V)try{let B=await Ws.getSelectedScope(r,n.get(be),t,n.get(bd),n.get(ft),{document:Bt.create(D.activeDocument),selection:D.range});if(B&&B.symbolAtCursorState&&B.symbolAtCursorState.codeAtCursor){F+=r8;let U=B.symbolAtCursorState.document.languageId??"";K=Kv.formatSelection({languageId:U,selectedText:B.symbolAtCursorState.codeAtCursor}),$=D.activeDocument.uri}}catch(B){if(B instanceof dt)return}}$&&K&&!await r.isCopilotIgnored($)&&(F+=K),Ct.commands.executeCommand("workbench.action.chat.open",{query:F})},d=async(k,V=!1)=>{let F=o.findReviewComment(k);if(!F||!F.suggestion)return;let K=Ct.window.activeTextEditor;if(!K||K.document.uri.toString()!==F.document.uri.toString())return;let{edits:$}=await F.suggestion;K.edit(D=>{$.forEach(A=>{D.replace(A.range,A.newText)})}),V&&_(k,1);let j=o.getReviewComments().length;o.removeReviewComments([F]),L0(F,j,"applySuggestion",s,a,e)},p=async k=>{let V=o.findReviewComment(k);if(!V)return;let F=o.getReviewComments().length,K=V.body instanceof Ct.MarkdownString?V.body.value:V.body;o.removeReviewComments([V]),await Ct.commands.executeCommand("vscode.editorChat.start",{initialRange:k.range,message:`/fix ${K}`,autoSend:!0}),L0(V,F,"continueInInlineChat",s,a,e)},f=async k=>{let V=o.findReviewComment(k);if(!V)return;let F=o.getReviewComments().length,K=V.body instanceof Ct.MarkdownString?V.body.value:V.body;await Ct.commands.executeCommand("workbench.action.chat.open",{query:"Explain your comment.",isPartialQuery:!0,previousRequests:[{request:"Review my code.",response:`In file \`${x_e.default.basename(V.uri.fsPath)}\` at line ${V.range.start.line+1}:

${K}`}]}),L0(V,F,"continueInChat",s,a,e)},m=async(k,V=!1)=>{V&&_(k,1);let F=o.findReviewComment(k);if(F){let K=o.getReviewComments().length;o.removeReviewComments([F]),L0(F,K,"discardComment",s,a,e)}},h=async()=>{let k=o.getReviewComments();k.length&&(o.removeReviewComments(k),L0(k,k.length,"discardAllComments",s,a,e))},g=async k=>{let V=o.findReviewComment(k);if(V){let F=o.getReviewComments().length;L0(V,F,"helpful",s,a,e)}},y=async k=>{let V=o.findReviewComment(k);if(V){let F=o.getReviewComments().length;L0(V,F,"unhelpful",s,a,e)}},b=c.extensionMode;typeof b=="number"&&b!==Ct.ExtensionMode.Test&&o.updateContextValues();let _=(k,V)=>{let F;if(k){let $=o.findReviewComment(k);if(!$)return;let j=o.getReviewComments(),A=(j.indexOf($)+V+j.length)%j.length;F=j[A]}else{let $=o.getReviewComments();F=$[V>0?0:$.length-1]}let K=F&&o.findCommentThread(F);K&&(V!==0&&K.reveal(),e.invokeFunction(SQe,K))},x=()=>Ct.commands.executeCommand("vscode.editorChat.start",{message:"/generate "}),I=()=>Ct.commands.executeCommand("vscode.editorChat.start",{message:`/${nf.ID} `,autoSend:!0,initialRange:Ct.window.activeTextEditor?.selection}),S=k=>{let V=k&&typeof k=="object"&&"document"in k&&k.document&&typeof k.document=="object"&&"getText"in k.document&&"selection"in k&&k.selection instanceof Ct.Range?k:void 0;return e.createInstance(oC).runCommand(V)},w=()=>{let k=Ct.window.activeTextEditor;if(!k)return;let V=k.selection,F=Ct.languages.getDiagnostics(k.document.uri).filter(K=>!!V.intersection(K.range)).map(K=>K.message).join(", ");return Ct.commands.executeCommand("vscode.editorChat.start",{message:`/fix ${F}`,autoSend:!0,initialRange:Ct.window.activeTextEditor?.selection})},R=k=>[k.get(bd),k.get(H),k.get(ya),k.get(xt),k.get(oe),k.get(Ji),k.get(xn),k.get(hn),k.get(it),k.get(Te)];return l.add(Ct.commands.registerCommand("github.copilot.chat.explain",u)),l.add(Ct.commands.registerCommand("github.copilot.chat.explain.palette",()=>u(void 0,!0))),l.add(Ct.commands.registerCommand("github.copilot.chat.review",()=>wx(...e.invokeFunction(R),"selection"))),l.add(Ct.commands.registerCommand("github.copilot.chat.review.stagedChanges",()=>wx(...e.invokeFunction(R),"index"))),l.add(Ct.commands.registerCommand("github.copilot.chat.review.unstagedChanges",()=>wx(...e.invokeFunction(R),"workingTree"))),l.add(Ct.commands.registerCommand("github.copilot.chat.review.changes",()=>wx(...e.invokeFunction(R),"all"))),l.add(Ct.commands.registerCommand("github.copilot.chat.review.apply",d)),l.add(Ct.commands.registerCommand("github.copilot.chat.review.applyAndNext",k=>d(k,!0))),l.add(Ct.commands.registerCommand("github.copilot.chat.review.applyShort",k=>d(k,!0))),l.add(Ct.commands.registerCommand("github.copilot.chat.review.continueInInlineChat",p)),l.add(Ct.commands.registerCommand("github.copilot.chat.review.continueInChat",f)),l.add(Ct.commands.registerCommand("github.copilot.chat.review.discard",m)),l.add(Ct.commands.registerCommand("github.copilot.chat.review.discardAndNext",k=>m(k,!0))),l.add(Ct.commands.registerCommand("github.copilot.chat.review.discardShort",k=>m(k,!0))),l.add(Ct.commands.registerCommand("github.copilot.chat.review.discardAll",h)),l.add(Ct.commands.registerCommand("github.copilot.chat.review.markHelpful",g)),l.add(Ct.commands.registerCommand("github.copilot.chat.review.markUnhelpful",y)),l.add(Ct.commands.registerCommand("github.copilot.chat.review.previous",k=>_(k,-1))),l.add(Ct.commands.registerCommand("github.copilot.chat.review.next",k=>_(k,1))),l.add(Ct.commands.registerCommand("github.copilot.chat.review.current",k=>_(k,0))),l.add(Ct.commands.registerCommand("github.copilot.chat.generate",x)),l.add(Ct.commands.registerCommand("github.copilot.chat.generateDocs",I)),l.add(Ct.commands.registerCommand("github.copilot.chat.generateTests",S)),l.add(Ct.commands.registerCommand("github.copilot.chat.fix",w)),l.add(Ct.languages.registerCodeActionsProvider("*",e.createInstance(Ha),{providedCodeActionKinds:Ha.providedCodeActionKinds})),l.add(Ct.languages.registerCodeActionsProvider("*",e.createInstance(Bd),{providedCodeActionKinds:Bd.providedCodeActionKinds})),l.add(Ct.notebooks.registerNotebookCellStatusBarItemProvider("jupyter-notebook",e.createInstance(NC))),l}function SQe(n,e){let t=n.get(oe),r=n.get(ya),o=n.get(H),s=r.findReviewComment(e);!s||s.suggestion||s.skipSuggestion||(s.suggestion=(async()=>{let a=s.body instanceof Ct.MarkdownString?s.body.value:s.body,c=s.document,l=new Ct.Selection(s.range.start,s.range.end),u="fix",d=a,p={location:Ct.ChatLocation.Editor,location2:new Ct.ChatRequestEditorData(c.document,l,l),command:u,prompt:d,references:[],attempt:0,enableCommandDetection:!1,isParticipantDetected:!1,toolReferences:[],toolInvocationToken:void 0,model:null},f="",m=[],h=new Ad(_=>{_ instanceof Ct.ChatResponseTextEditPart&&_.edits.length>0?m.push(..._.edits.map(x=>({range:x.range,newText:x.newText,oldText:c.getText(x.range)})).filter(x=>x.newText!==x.oldText)):_ instanceof Ct.ChatResponseMarkdownPart&&(f+=_.value.value)}),y=await o.createInstance(D0,[],p,h,Zt.None,{agentId:Bv(fD),agentName:fD,intentId:p.command}).getResult();if(y.errorDetails)throw new Error(y.errorDetails.message);let b={markdown:f,edits:m};return s.suggestion=b,r.updateReviewComment(s),e.contextValue=m.length?"hasSuggestion":"hasNoSuggestion",b})().catch(a=>(t.public.error(a,"Error fetching suggestion"),s.suggestion={markdown:`Error fetching suggestion: ${a?.message}`,edits:[]},r.updateReviewComment(s),s.suggestion)),r.updateReviewComment(s))}var Ih=q(ht());function z8(n,e=!1){let t=n.length,r=0,o="",s=0,a=16,c=0,l=0,u=0,d=0,p=0;function f(x,I){let S=0,w=0;for(;S<x||!I;){let R=n.charCodeAt(r);if(R>=48&&R<=57)w=w*16+R-48;else if(R>=65&&R<=70)w=w*16+R-65+10;else if(R>=97&&R<=102)w=w*16+R-97+10;else break;r++,S++}return S<x&&(w=-1),w}function m(x){r=x,o="",s=0,a=16,p=0}function h(){let x=r;if(n.charCodeAt(r)===48)r++;else for(r++;r<n.length&&LC(n.charCodeAt(r));)r++;if(r<n.length&&n.charCodeAt(r)===46)if(r++,r<n.length&&LC(n.charCodeAt(r)))for(r++;r<n.length&&LC(n.charCodeAt(r));)r++;else return p=3,n.substring(x,r);let I=r;if(r<n.length&&(n.charCodeAt(r)===69||n.charCodeAt(r)===101))if(r++,(r<n.length&&n.charCodeAt(r)===43||n.charCodeAt(r)===45)&&r++,r<n.length&&LC(n.charCodeAt(r))){for(r++;r<n.length&&LC(n.charCodeAt(r));)r++;I=r}else p=3;return n.substring(x,I)}function g(){let x="",I=r;for(;;){if(r>=t){x+=n.substring(I,r),p=2;break}let S=n.charCodeAt(r);if(S===34){x+=n.substring(I,r),r++;break}if(S===92){if(x+=n.substring(I,r),r++,r>=t){p=2;break}switch(n.charCodeAt(r++)){case 34:x+='"';break;case 92:x+="\\";break;case 47:x+="/";break;case 98:x+="\b";break;case 102:x+="\f";break;case 110:x+=`
`;break;case 114:x+="\r";break;case 116:x+="	";break;case 117:let R=f(4,!0);R>=0?x+=String.fromCharCode(R):p=4;break;default:p=5}I=r;continue}if(S>=0&&S<=31)if(oN(S)){x+=n.substring(I,r),p=2;break}else p=6;r++}return x}function y(){if(o="",p=0,s=r,l=c,d=u,r>=t)return s=t,a=17;let x=n.charCodeAt(r);if(cJ(x)){do r++,o+=String.fromCharCode(x),x=n.charCodeAt(r);while(cJ(x));return a=15}if(oN(x))return r++,o+=String.fromCharCode(x),x===13&&n.charCodeAt(r)===10&&(r++,o+=`
`),c++,u=r,a=14;switch(x){case 123:return r++,a=1;case 125:return r++,a=2;case 91:return r++,a=3;case 93:return r++,a=4;case 58:return r++,a=6;case 44:return r++,a=5;case 34:return r++,o=g(),a=10;case 47:let I=r-1;if(n.charCodeAt(r+1)===47){for(r+=2;r<t&&!oN(n.charCodeAt(r));)r++;return o=n.substring(I,r),a=12}if(n.charCodeAt(r+1)===42){r+=2;let S=t-1,w=!1;for(;r<S;){let R=n.charCodeAt(r);if(R===42&&n.charCodeAt(r+1)===47){r+=2,w=!0;break}r++,oN(R)&&(R===13&&n.charCodeAt(r)===10&&r++,c++,u=r)}return w||(r++,p=1),o=n.substring(I,r),a=13}return o+=String.fromCharCode(x),r++,a=16;case 45:if(o+=String.fromCharCode(x),r++,r===t||!LC(n.charCodeAt(r)))return a=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return o+=h(),a=11;default:for(;r<t&&b(x);)r++,x=n.charCodeAt(r);if(s!==r){switch(o=n.substring(s,r),o){case"true":return a=8;case"false":return a=9;case"null":return a=7}return a=16}return o+=String.fromCharCode(x),r++,a=16}}function b(x){if(cJ(x)||oN(x))return!1;switch(x){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}function _(){let x;do x=y();while(x>=12&&x<=15);return x}return{setPosition:m,getPosition:()=>r,scan:e?_:y,getToken:()=>a,getTokenValue:()=>o,getTokenOffset:()=>s,getTokenLength:()=>r-s,getTokenStartLine:()=>l,getTokenStartCharacter:()=>s-d,getTokenError:()=>p}}function cJ(n){return n===32||n===9}function oN(n){return n===10||n===13}function LC(n){return n>=48&&n<=57}var I_e;(function(n){n[n.lineFeed=10]="lineFeed",n[n.carriageReturn=13]="carriageReturn",n[n.space=32]="space",n[n._0=48]="_0",n[n._1=49]="_1",n[n._2=50]="_2",n[n._3=51]="_3",n[n._4=52]="_4",n[n._5=53]="_5",n[n._6=54]="_6",n[n._7=55]="_7",n[n._8=56]="_8",n[n._9=57]="_9",n[n.a=97]="a",n[n.b=98]="b",n[n.c=99]="c",n[n.d=100]="d",n[n.e=101]="e",n[n.f=102]="f",n[n.g=103]="g",n[n.h=104]="h",n[n.i=105]="i",n[n.j=106]="j",n[n.k=107]="k",n[n.l=108]="l",n[n.m=109]="m",n[n.n=110]="n",n[n.o=111]="o",n[n.p=112]="p",n[n.q=113]="q",n[n.r=114]="r",n[n.s=115]="s",n[n.t=116]="t",n[n.u=117]="u",n[n.v=118]="v",n[n.w=119]="w",n[n.x=120]="x",n[n.y=121]="y",n[n.z=122]="z",n[n.A=65]="A",n[n.B=66]="B",n[n.C=67]="C",n[n.D=68]="D",n[n.E=69]="E",n[n.F=70]="F",n[n.G=71]="G",n[n.H=72]="H",n[n.I=73]="I",n[n.J=74]="J",n[n.K=75]="K",n[n.L=76]="L",n[n.M=77]="M",n[n.N=78]="N",n[n.O=79]="O",n[n.P=80]="P",n[n.Q=81]="Q",n[n.R=82]="R",n[n.S=83]="S",n[n.T=84]="T",n[n.U=85]="U",n[n.V=86]="V",n[n.W=87]="W",n[n.X=88]="X",n[n.Y=89]="Y",n[n.Z=90]="Z",n[n.asterisk=42]="asterisk",n[n.backslash=92]="backslash",n[n.closeBrace=125]="closeBrace",n[n.closeBracket=93]="closeBracket",n[n.colon=58]="colon",n[n.comma=44]="comma",n[n.dot=46]="dot",n[n.doubleQuote=34]="doubleQuote",n[n.minus=45]="minus",n[n.openBrace=123]="openBrace",n[n.openBracket=91]="openBracket",n[n.plus=43]="plus",n[n.slash=47]="slash",n[n.formFeed=12]="formFeed",n[n.tab=9]="tab"})(I_e||(I_e={}));var $8;(function(n){n.DEFAULT={allowTrailingComma:!1}})($8||($8={}));function T_e(n,e=[],t=$8.DEFAULT){let r=null,o=[],s=[];function a(l){Array.isArray(o)?o.push(l):r!==null&&(o[r]=l)}return lJ(n,{onObjectBegin:()=>{let l={};a(l),s.push(o),o=l,r=null},onObjectProperty:l=>{r=l},onObjectEnd:()=>{o=s.pop()},onArrayBegin:()=>{let l=[];a(l),s.push(o),o=l,r=null},onArrayEnd:()=>{o=s.pop()},onLiteralValue:a,onError:(l,u,d)=>{e.push({error:l,offset:u,length:d})}},t),o[0]}function lJ(n,e,t=$8.DEFAULT){let r=z8(n,!1),o=[];function s($){return $?()=>$(r.getTokenOffset(),r.getTokenLength(),r.getTokenStartLine(),r.getTokenStartCharacter()):()=>!0}function a($){return $?()=>$(r.getTokenOffset(),r.getTokenLength(),r.getTokenStartLine(),r.getTokenStartCharacter(),()=>o.slice()):()=>!0}function c($){return $?j=>$(j,r.getTokenOffset(),r.getTokenLength(),r.getTokenStartLine(),r.getTokenStartCharacter()):()=>!0}function l($){return $?j=>$(j,r.getTokenOffset(),r.getTokenLength(),r.getTokenStartLine(),r.getTokenStartCharacter(),()=>o.slice()):()=>!0}let u=a(e.onObjectBegin),d=l(e.onObjectProperty),p=s(e.onObjectEnd),f=a(e.onArrayBegin),m=s(e.onArrayEnd),h=l(e.onLiteralValue),g=c(e.onSeparator),y=s(e.onComment),b=c(e.onError),_=t&&t.disallowComments,x=t&&t.allowTrailingComma;function I(){for(;;){let $=r.scan();switch(r.getTokenError()){case 4:S(14);break;case 5:S(15);break;case 3:S(13);break;case 1:_||S(11);break;case 2:S(12);break;case 6:S(16);break}switch($){case 12:case 13:_?S(10):y();break;case 16:S(1);break;case 15:case 14:break;default:return $}}}function S($,j=[],D=[]){if(b($),j.length+D.length>0){let A=r.getToken();for(;A!==17;){if(j.indexOf(A)!==-1){I();break}else if(D.indexOf(A)!==-1)break;A=I()}}}function w($){let j=r.getTokenValue();return $?h(j):(d(j),o.push(j)),I(),!0}function R(){switch(r.getToken()){case 11:let $=r.getTokenValue(),j=Number($);isNaN(j)&&(S(2),j=0),h(j);break;case 7:h(null);break;case 8:h(!0);break;case 9:h(!1);break;default:return!1}return I(),!0}function k(){return r.getToken()!==10?(S(3,[],[2,5]),!1):(w(!1),r.getToken()===6?(g(":"),I(),K()||S(4,[],[2,5])):S(5,[],[2,5]),o.pop(),!0)}function V(){u(),I();let $=!1;for(;r.getToken()!==2&&r.getToken()!==17;){if(r.getToken()===5){if($||S(4,[],[]),g(","),I(),r.getToken()===2&&x)break}else $&&S(6,[],[]);k()||S(4,[],[2,5]),$=!0}return p(),r.getToken()!==2?S(7,[2],[]):I(),!0}function F(){f(),I();let $=!0,j=!1;for(;r.getToken()!==4&&r.getToken()!==17;){if(r.getToken()===5){if(j||S(4,[],[]),g(","),I(),r.getToken()===4&&x)break}else j&&S(6,[],[]);$?(o.push(0),$=!1):o[o.length-1]++,K()||S(4,[],[4,5]),j=!0}return m(),$||o.pop(),r.getToken()!==4?S(8,[4],[]):I(),!0}function K(){switch(r.getToken()){case 3:return F();case 1:return V();case 10:return w(!0);default:return R()}}return I(),r.getToken()===17?t.allowEmptyContent?!0:(S(4,[],[]),!1):K()?(r.getToken()!==17&&S(9,[],[]),!0):(S(4,[],[]),!1)}var C_e;(function(n){n[n.None=0]="None",n[n.UnexpectedEndOfComment=1]="UnexpectedEndOfComment",n[n.UnexpectedEndOfString=2]="UnexpectedEndOfString",n[n.UnexpectedEndOfNumber=3]="UnexpectedEndOfNumber",n[n.InvalidUnicode=4]="InvalidUnicode",n[n.InvalidEscapeCharacter=5]="InvalidEscapeCharacter",n[n.InvalidCharacter=6]="InvalidCharacter"})(C_e||(C_e={}));var E_e;(function(n){n[n.OpenBraceToken=1]="OpenBraceToken",n[n.CloseBraceToken=2]="CloseBraceToken",n[n.OpenBracketToken=3]="OpenBracketToken",n[n.CloseBracketToken=4]="CloseBracketToken",n[n.CommaToken=5]="CommaToken",n[n.ColonToken=6]="ColonToken",n[n.NullKeyword=7]="NullKeyword",n[n.TrueKeyword=8]="TrueKeyword",n[n.FalseKeyword=9]="FalseKeyword",n[n.StringLiteral=10]="StringLiteral",n[n.NumericLiteral=11]="NumericLiteral",n[n.LineCommentTrivia=12]="LineCommentTrivia",n[n.BlockCommentTrivia=13]="BlockCommentTrivia",n[n.LineBreakTrivia=14]="LineBreakTrivia",n[n.Trivia=15]="Trivia",n[n.Unknown=16]="Unknown",n[n.EOF=17]="EOF"})(E_e||(E_e={}));var gf=T_e;var k_e=lJ;var w_e;(function(n){n[n.InvalidSymbol=1]="InvalidSymbol",n[n.InvalidNumberFormat=2]="InvalidNumberFormat",n[n.PropertyNameExpected=3]="PropertyNameExpected",n[n.ValueExpected=4]="ValueExpected",n[n.ColonExpected=5]="ColonExpected",n[n.CommaExpected=6]="CommaExpected",n[n.CloseBraceExpected=7]="CloseBraceExpected",n[n.CloseBracketExpected=8]="CloseBracketExpected",n[n.EndOfFileExpected=9]="EndOfFileExpected",n[n.InvalidCommentToken=10]="InvalidCommentToken",n[n.UnexpectedEndOfComment=11]="UnexpectedEndOfComment",n[n.UnexpectedEndOfString=12]="UnexpectedEndOfString",n[n.UnexpectedEndOfNumber=13]="UnexpectedEndOfNumber",n[n.InvalidUnicode=14]="InvalidUnicode",n[n.InvalidEscapeCharacter=15]="InvalidEscapeCharacter",n[n.InvalidCharacter=16]="InvalidCharacter"})(w_e||(w_e={}));var F_e=q(require("path"));var P_e="_github.copilot.openRelativePath",A_e="_github.copilot.openSymbolInFile";function W8(n,e){return`command:${n}?${encodeURIComponent(JSON.stringify(e))}`}function K8(n,e){let t=n.trim().split(`
`),r=[],o,s={name:"",children:[]};r[0]=s;for(let c of t){let l=PQe(c),u=c.lastIndexOf("\u2500\u2500 "),d=u>=0?c.substring(u+3):c,p={name:d};if(l===0){o=e(d),s.name=d;continue}else{for(;l>0&&r[l-1]===void 0;)l--;r[l-1].children===void 0?r[l-1].children=[p]:r[l-1].children?.push(p),r[l]=p}}if(o===void 0)throw new Error("Base URI is undefined");let a=N_e(s.children);return s.children=a.sort((c,l)=>c.children&&!l.children?-1:1),{chatResponseTree:new Td([s],o),projectName:s.name}}function D_e(n){let e=n.map(r=>({node:r,path:r.name})),t=[];for(;e.length>0;){let{node:r,path:o}=e.shift();if(r.children&&r.children.length>0)for(let s of r.children)e.push({node:s,path:`${o}/${s.name}`});else t.push(o)}return t}function PQe(n){let e=(n.match(/   /g)||[]).length;return e+=(n.match(/\|   /g)||[]).length,e+=(n.match(/    /g)||[]).length,e+=(n.match(/ /g)||[]).length,e+=(n.match(/ /g)||[]).length,e}var AQe=["node_modules","out","bin","debug","obj","lib",".dll",".pdb",".lib",".jpg",".png",".ico",".gif",".svg",".jpeg",".tiff",".bmp",".webp",".jpeg",".gitignore","LICENSE.txt","yarn.lock","package-lock.json"];function N_e(n){let e=[];for(let t of n)DQe(t)||(t.children&&(t.children=N_e(t.children)),e.push(t));return e}function DQe(n){return!!AQe.includes(n.name)}var sN=q(ht()),vf=q(Ve()),L_e=q(require("path"));var Y8=re("IProjectTemplatesIndex"),OC=class{constructor(e=!0,t,r){this._isIndexLoaded=!1;let o=ch(t.getEditorInfo().version);this.embeddingsCache=e?r.createInstance(nu,1,"projectTemplateEmbeddings",o,"project-templates"):r.createInstance(kd,1,"projectTemplateEmbeddings",o)}async updateIndex(){this._isIndexLoaded||(this._isIndexLoaded=!0,this._embeddings=await this.embeddingsCache.getCache())}async nClosestValues(e,t,r=0){if(await this.updateIndex(),!this._embeddings)return[];let o=Object.entries(this._embeddings).map(s=>{if(!s[1].embedding)return{key:`${s[0]}`,similarity:0};let a=qv(e,s[1].embedding);return{key:`${s[0]} `,similarity:a}});return o=o.filter(s=>s.similarity>r),o.sort((s,a)=>a.similarity-s.similarity),o.slice(0,t).map(s=>s.key)}};OC=E([v(1,it),v(2,H)],OC);async function kx(n,e,t,r){let o=null,s=!1;o=setTimeout(()=>{s||n.report(e)},r);try{let a=await t;return s=!0,a}finally{o&&clearTimeout(o)}}var Q8=q(Ve());var Pr=class extends Q8.PromptElement{async render(){let e=mo(this.props.languageId??"",this.props.code,this.props.shouldTrim??!0);return vscpp(Q8.TextChunk,null,e)}};function NQe(n){let e=n.split(`
`),t={};return e.forEach((r,o)=>{r.startsWith("# Intent")?t.intent=e[o+1]?.trim():r.startsWith("# Question")&&(t.question=e[o+1]?.trim())}),t}var MC=class extends vf.PromptElement{constructor(t,r,o,s,a,c,l){super(t);this.chatMLFetcher=r;this.instantiationService=o;this.embeddingsComputer=s;this.endPointProvider=a;this.projectTemplatesIndex=c;this.repositoryService=l}async prepare(t,r,o){if(!r)throw new Error("Progress is required");r?.report(new Ri(sN.t("Determining user intent...")));let s=await this.endPointProvider.getChatEndpoint("gpt-4o-mini"),{messages:a}=await LQe(this.instantiationService,s,this.props.promptContext);if(o.isCancellationRequested)return{};let c=await this.chatMLFetcher.fetchOne("newWorkspace",a,void 0,o,2,s,void 0,{temperature:0});if(c.type==="success"){let l=NQe(c.value);if(l.intent==="File")return{intent:l};if(l.intent==="Project"){if(this.props.useTemplates){let u=await this.endPointProvider.getEmbeddingsEndpoint("text3small"),d=await this.embeddingsComputer.computeEmbeddings(u,[l.question],{dimensions:512},void 0);if(d){r.report(new Ri(sN.t("Searching project template index...")));let p=await this.projectTemplatesIndex.nClosestValues(d.embeddings[0],1);if(p.length>0){let f=p[0]?.split(":"),m=f[0].trim(),h=f[1].trim(),g=f[2].trim()===""?".":f[2].trim();if(m&&h&&g){let y=await kx(r,new Ri(sN.t("Fetching project contents...")),this.repositoryService.getRepositoryItems(m,h,g),500);if(y.length>0){let b;return g==="."?b=`httpx://github.com/${m}/${h}`:b=L_e.default.dirname(y[0].html_url),this._metadata=new Rx(m,h,g,y),{url:b}}}}}}return{intent:l}}else return{intent:{intent:"Project",question:this.props.promptContext.query}}}else throw new Error(sN.t("Encountered an error while determining user intent: ({0}) {1}",c.type,c.reason))}render(t){let{query:r,history:o,chatVariables:s}=this.props.promptContext;return vscpp(vscppf,null,vscpp(c0,{priority:600,history:o.filter(a=>a.response?.name===dJ&&a.request.type==="user")}),t.intent?.intent==="File"&&vscpp(vscppf,null,vscpp(Tt,{priority:1e3},"You are a Visual Studio Code assistant. Your job is to generate the contents of a new file based on the user's query.",vscpp("br",null),"If a code snippet or markdown is provided, consider it as part of the file content creation process.",vscpp("br",null),"The code should not contain bugs and should adhere to best practices.",vscpp("br",null),"Your response should be just two code blocks - the first one with the file contents and the second JSON code block with a file name.",vscpp("br",null),"Your response should not contain any other information or explanation.",vscpp("br",null),"# Response Template",vscpp("br",null),vscpp(Pr,{code:`
    def greet(name):
      print(f"Hello, {name}!")
    greet("John Doe")
  `,languageId:"python"}),vscpp(Pr,{code:`
    'fileName': 'suggestedFileName',
`,languageId:"json"}),vscpp("br",null),"Examples:",vscpp("br",null),"User: Generate the contents of the new file based on this query:",vscpp("br",null),"python hello world file",vscpp("br",null),"Assistant:",vscpp("br",null),vscpp(Pr,{code:`
    def greet(name):
      print(f"Hello, {name}!")

    greet("John Doe")
  `,languageId:"python"}),vscpp(Pr,{code:`
    {
    'fileName': 'sampleHelloWorld.py',
    }
`,languageId:"json"}),vscpp(kt,null)),vscpp(tn,{priority:899,flexGrow:2,endpoint:this.props.endpoint,promptContext:this.props.promptContext}),vscpp($n,{priority:900,chatVariables:s,query:t.intent.question})),t.intent?.intent==="Project"&&!this._metadata&&vscpp(vscppf,null,vscpp(Tt,{priority:1e3},"You are a VS Code assistant. Your job is to suggest a filetree directory structure for a project that a user wants to create.",vscpp("br",null),"If a step does not relate to filetree directory structures, do not respond. Please do not guess a response and instead just respond with a polite apology if you are unsure. ## Additional Rules ##",vscpp("br",null),'If the user does not specify "app" or "project" in their query, assume they are asking for a project.',vscpp("br",null),`You should always start your response to the user with "Sure, here's a proposed directory structure for a [project type] app:"`,vscpp("br",null),"You should generate a markdown file tree structure for the sample project and include it in your response if you are proposing a sample.",vscpp("br",null),"You should only list common files for the user's desired project type if you are proposing a sample.",vscpp("br",null),"You should always include a README.md file which describes the project if you are proposing a sample.",vscpp("br",null),"Do not include folders and files generated after compiling, building or running the project such as node_modules, dist, build, out.",vscpp("br",null),"Do not include image files such as png, jpg, ico, etc.",vscpp("br",null),"Do not include any descriptions or explanations in your response other than what is shown in the response templates.",vscpp("br",null),"If the user asks for a file content to be modified, respond with the same file tree structure and ask them to open the file to view the modifications.",vscpp("br",null),"Do not attempt to modify the file content your self and simply respond with the same file tree structure.",vscpp("br",null),vscpp(vn,null),vscpp(Ze,null),vscpp(ii,null),vscpp(kt,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"## Response template ##",vscpp("br",null),"Sure, here's a proposed directory structure for a [project type] app:",vscpp("br",null),"\\`\\`\\`filetree",vscpp("br",null),"[project-name]",vscpp("br",null),"\u251C\u2500\u2500 src",vscpp("br",null),"\u2502   \u251C\u2500\u2500 app.ts",vscpp("br",null),"\u2502   \u2514\u2500\u2500 types",vscpp("br",null),"\u2502       \u2514\u2500\u2500 index.ts",vscpp("br",null),"\u251C\u2500\u2500 package.json",vscpp("br",null),"\u251C\u2500\u2500 tsconfig.json",vscpp("br",null),"\u2514\u2500\u2500 README.md",vscpp("br",null),"\\`\\`\\`",vscpp("br",null),["","Examples for response templates above. Please follow these examples as closely as possible.","","## Valid setup question","","User: Create a TypeScript express app","Assistant:","","Sure, here's a proposed directory structure for a TypeScript Express app:","","```filetree","my-express-app","\u251C\u2500\u2500 src","\u2502   \u251C\u2500\u2500 app.ts","\u2502   \u251C\u2500\u2500 controllers","\u2502   \u2502   \u2514\u2500\u2500 index.ts","\u2502   \u251C\u2500\u2500 routes","\u2502   \u2502   \u2514\u2500\u2500 index.ts","\u2502   \u2514\u2500\u2500 types","\u2502       \u2514\u2500\u2500 index.ts","\u251C\u2500\u2500 package.json","\u251C\u2500\u2500 tsconfig.json","\u2514\u2500\u2500 README.md","```","","## Invalid setup question","","User: Create a horse project","Assistant: Sorry, I don't know how to set up a horse project."].join(`
`),vscpp(kt,null)),vscpp(vf.UserMessage,{priority:750},vscpp(sn,{languageId:void 0})),vscpp(tn,{priority:899,flexGrow:2,endpoint:this.props.endpoint,promptContext:this.props.promptContext}),vscpp($n,{priority:900,chatVariables:s,query:t.intent.question})),!t.intent&&this._metadata&&vscpp(vscppf,null,vscpp(Tt,{priority:1e3},"You are a Visual Studio Code assistant. The user has identified a project URL for a new project they want to create. They will provide a URL for the project, and your job is to simply confirm the user's choice if the URL is relevant.",vscpp("br",null),"If the URL is not relevant, you should ignore the URL and simply suggest a file tree directory structure for a project that the user wants to create. Do not attempt to clarify the URL to the user.",vscpp("br",null),"Please do not guess a response and instead just respond with a polite apology if you are unsure.",vscpp("br",null),vscpp(vn,null),vscpp(Ze,null),vscpp(ii,null),vscpp(kt,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"## Response template when the user has provided a project URL but it is irrelevant. Notice how the response ignores the provided URL entirely and does not attempt to clarify this to the user. ##",vscpp("br",null),"Sure, here's a proposed directory structure for a [project type] app:",vscpp("br",null),"\\`\\`\\`filetree",vscpp("br",null),"[project-name]",vscpp("br",null),"\u251C\u2500\u2500 src",vscpp("br",null),"\u2502   \u251C\u2500\u2500 app.ts",vscpp("br",null),"\u2502   \u2514\u2500\u2500 types",vscpp("br",null),"\u2502       \u2514\u2500\u2500 index.ts",vscpp("br",null),"\u251C\u2500\u2500 package.json",vscpp("br",null),"\u251C\u2500\u2500 tsconfig.json",vscpp("br",null),"\u2514\u2500\u2500 README.md",vscpp("br",null),"\\`\\`\\`",vscpp("br",null),["","Examples for response templates above. Please follow these examples as closely as possible.","","## Valid setup question with an irrelevant URL ##","","User: Create a TypeScript express app","URL: https://github.com/microsoft/vscode-extension-samples/tree/main/getting-started-sample","Assistant:","","Sure, here's a proposed directory structure for a TypeScript Express app:","","```filetree","my-express-app","\u251C\u2500\u2500 src","\u2502   \u251C\u2500\u2500 app.ts","\u2502   \u251C\u2500\u2500 controllers","\u2502   \u2502   \u2514\u2500\u2500 index.ts","\u2502   \u251C\u2500\u2500 routes","\u2502   \u2502   \u2514\u2500\u2500 index.ts","\u2502   \u2514\u2500\u2500 types","\u2502       \u2514\u2500\u2500 index.ts","\u251C\u2500\u2500 package.json","\u251C\u2500\u2500 tsconfig.json","\u2514\u2500\u2500 README.md","```","","## Invalid setup question ##","","User: Create a horse project","Assistant: Sorry, I don't know how to set up a horse project."].join(`
`),"## Response template when the user has provided a project URL that is relevant ##",vscpp("br",null),"# USING_URL ",vscpp("br",null),"Sure, here's a GitHub sample project to help you get started on [project type]: [Project Type Sample](url)",vscpp("br",null),["","Examples for response template with a relevant URL described above. Please follow this example as closely as possible.","","## Valid setup question with a relevant project URL. Notice how you should not propose a file directory structure in this case. ##","","User: Create a VSCode extension sample for contributing getting started walkthrough.","URL: https://github.com/microsoft/vscode-extension-samples/tree/main/getting-started-sample","Assistant:","","# USING_URL","Sure, here's a GitHub sample project to help you get started on creating a VSCode extension with a walkthrough contribution: [Walkthrough Sample](https://github.com/microsoft/vscode-extension-samples/tree/main/getting-started-sample)",""].join(`
`),vscpp("br",null),"## Additional Rules for Project Tree generation ##",vscpp("br",null),"You should only generate a file tree structure if the URL procvided by the user is not relevant.",vscpp("br",null),"You should generate a markdown file tree structure for the sample project and include it in your response if you are proposing a sample.",vscpp("br",null),"You should only list common files for the user's desired project type if you are proposing a sample.",vscpp("br",null),"You should always include a README.md file which describes the project if you are proposing a sample.",vscpp("br",null),"Do not include folders and files generated after compiling, building, or running the project such as node_modules, dist, build, out.",vscpp("br",null),"Do not include image files such as png, jpg, ico, etc.",vscpp("br",null),"Do not include any descriptions or explanations in your response other than what is shown in the response templates.",vscpp("br",null),"If the user asks for a file content to be modified, respond with the same file tree structure and ask them to open the file to view the modifications.",vscpp("br",null),"Do not attempt to modify the file content yourself and simply respond with the same file tree structure.",vscpp("br",null),vscpp(kt,null)),vscpp(vf.UserMessage,{priority:750},vscpp(sn,{languageId:void 0})),vscpp(vf.UserMessage,{priority:900},t.url&&vscpp(vscppf,null,"Below is the URL you should consider for your response.",vscpp("br",null),"URL: ",t.url,vscpp("br",null))),vscpp(tn,{priority:899,flexGrow:2,endpoint:this.props.endpoint,promptContext:this.props.promptContext}),vscpp($n,{priority:900,chatVariables:s,query:r}),this._metadata&&vscpp(vscppf,null,vscpp("meta",{value:this._metadata}))))}};MC=E([v(1,Et),v(2,H),v(3,_s),v(4,_e),v(5,Y8),v(6,Id)],MC);var Rx=class extends Jl{constructor(t,r,o,s){super();this.org=t;this.repo=r;this.path=o;this.githubRepoItems=s}};(e=>{function n(t){return t instanceof e}e.is=n})(Rx||={});async function LQe(n,e,t){return Fe.create(n,e,uJ,{promptContext:t,endpoint:e}).render()}var uJ=class extends vf.PromptElement{render(e,t){let{query:r,history:o,chatVariables:s}=this.props.promptContext;return vscpp(vscppf,null,vscpp(vf.SystemMessage,{priority:1e3},"You are a Visual Studio Code assistant focused on aiding users in crafting clear and specific specifications about project or file creation within Visual Studio Code. Your role involves:",vscpp("br",null),"- Helping users articulate their intent about creating projects for various platforms and programming languages.",vscpp("br",null),"- Assessing the user's intent to determine whether it pertains to project or file creation.",vscpp("br",null),"- Identifying the programming language the user is inquiring about, or inferring it based on the platform or project type mentioned.",vscpp("br",null),"- Rewriting the user's query to eliminate ambiguity and ensure clarity.",vscpp("br",null),"- Resolving any pronouns and vague terms to their specific referents.",vscpp("br",null),"- Responding with a rephrased question that accurately reflects the user's intent.",vscpp("br",null),`- Using the additional context to resolve ambiguities in the user's query, such as "it" or "that".`,vscpp("br",null)),vscpp(Nt,{historyPriority:500,passPriority:!0,history:o||[]},vscpp(Tt,{priority:1e3},"- If the user does not specify an application logic or feature, you should assume that the user is new to programming and provide a basic project structure to help with a simple Hello World project.",vscpp("br",null),'- If the user does not specify "app," "project," or "file" in their query, assume they are asking for a project. - If it is not clear what the user is asking for or if the question appears to be unrelated to Visual Studio Code, do not try to rephrase the question and simply return the original question.',vscpp("br",null),"- DO NOT ask the user for additional information or clarification.",vscpp("br",null),"- DO NOT answer the user's question directly.",vscpp("br",null),vscpp("br",null),"Guidelines for rewriting questions:",vscpp("br",null),"- Understand the user's intent by carefully reading their question.",vscpp("br",null),"- Clarify pronouns ('it', 'that') by deducing their referents from the question or conversation context.",vscpp("br",null),"- Resolve ambiguous terms ('this') to their specific meanings based on the question or conversation context.",vscpp("br",null),"- Rephrase the question under a `# Question` header, ensuring all vague terms are clarified without altering the original intent.",vscpp("br",null),vscpp("br",null),"When responding:",vscpp("br",null),"- Use Markdown to format your response, starting with a `# Question` header followed by the rephrased question.",vscpp("br",null),"- If the user's intent is unclear or unrelated to Visual Studio Code, simply return the original question without modification.",vscpp("br",null),"- If the user has not explicitly mentioned that they are looking for a project or a file, assume that they are asking for a Visual Studio project.",vscpp("br",null),"- Avoid requesting additional information or directly answering the question.",vscpp("br",null),"- Use the template below to report the identified intent, rephrased question, and any application logic or feature that may be relevant.",vscpp("br",null),vscpp("br",null),"# Response Template",vscpp("br",null),"# Intent",vscpp("br",null),"Project|File",vscpp("br",null),"# Question",vscpp("br",null),"Rephrased question here.",vscpp("br",null),vscpp("br",null),"# Examples:",vscpp("br",null),"User: Python game.",vscpp("br",null),"Assistant:",vscpp("br",null),"# Intent",vscpp("br",null),"Project",vscpp("br",null),"# Question",vscpp("br",null),"Create a new Python sample game project.",vscpp("br",null),vscpp("br",null),"User: Node.js server",vscpp("br",null),"Assistant:",vscpp("br",null),"# Intent",vscpp("br",null),"Project",vscpp("br",null),"# Question",vscpp("br",null),"Create a new Node.js development environment.",vscpp("br",null),vscpp("br",null),"User: TS web app",vscpp("br",null),"Assistant:",vscpp("br",null),"# Intent",vscpp("br",null),"Project",vscpp("br",null),"# Question",vscpp("br",null),'Create a new TypeScript project with a basic "Hello World" web application.',vscpp("br",null),vscpp("br",null),"User: VS Code extension custom sidebar",vscpp("br",null),"Assistant:",vscpp("br",null),"# Intent",vscpp("br",null),"Project",vscpp("br",null),"# Question",vscpp("br",null),"Create a Visual Studio Code extension sample that adds a custom sidebar.",vscpp("br",null),vscpp("br",null),vscpp(kt,null))),vscpp(vf.UserMessage,{flexGrow:1,priority:750},vscpp(sn,{languageId:void 0})),vscpp(tn,{priority:899,flexGrow:2,endpoint:this.props.endpoint,promptContext:this.props.promptContext}),vscpp($n,{flexGrow:2,priority:900,chatVariables:s,query:r}))}};var Dc=q(Ve());var X8=class extends Dc.PromptElement{render(){return vscpp(vscppf,null,this.props.history&&vscpp(Z8,{messages:this.props.history}),vscpp(Dc.SystemMessage,{priority:1e3},"You are a VS Code assistant. Your job is to generate the contents of a file in a project when given the user description, specification and tree structure of the project that a user wants to create. ",vscpp("br",null),vscpp(vn,null),vscpp(Ze,null),vscpp(kt,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"Think step by step and give me contents for just the file requested by the user. The code should not contain bugs.",vscpp("br",null),"If the user has asked for modifications to an existing file, please use the File path and File contents provided below if applicable.",vscpp("br",null),"If the file is supposed to be empty, please respond with a code comment saying that this file is intentionally left blank.",vscpp("br",null),"Do not include comments in json files.",vscpp("br",null),"Do not use code blocks or backticks.",vscpp("br",null),"Do not include product names such as Visual Studio in the comments.",vscpp("br",null)),this.props.relavantFiles&&this.props.relavantFiles.size>0&&vscpp(vscppf,null,vscpp(Dc.UserMessage,{priority:500},"Below, you will find a list of file paths and their contents previously used",vscpp("br",null),Array.from(this.props.relavantFiles).map(([e,t])=>`File path: ${e}
File contents: ${t}
`).join(`
`))),vscpp(Dc.UserMessage,{priority:900},"Generate the contents of the file: ",this.props.filePath," ",vscpp("br",null),"This is the project tree structure:",vscpp("br",null),"\\`\\`\\`filetree' ",vscpp("br",null),this.props.fileTreeStr,vscpp("br",null),"\\`\\`\\`",vscpp("br",null),"The project should adhere to the following specification:",vscpp("br",null),this.props.projectSpecification,vscpp("br",null)))}},J8=class extends Dc.PromptElement{render(){return vscpp(vscppf,null,this.props.history&&vscpp(Z8,{messages:this.props.history}),vscpp(Dc.SystemMessage,{priority:1e3},"You are a VS Code assistant. Your job is to generate the project specification when given the user description and file tree structure of the project that a user wants to create. ",vscpp("br",null),vscpp(vn,null),vscpp(Ze,null),vscpp(kt,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"Think step by step and respond with a text description that lists and summarizes each file inside this project.",vscpp("br",null),"List the classes, types, interfaces, functions, and constants it exports and imports if it is a code file.",vscpp("br",null),"Consider filenames and file extensions when determining the programming languages used in the project. List any special configurations or settings required for configuration files such as package.json or tsconfig.json to help compile the project successfully",vscpp("br",null),"You should be as specific as possible when listing the public properties and methods for each exported class.",vscpp("br",null),"Do not use code blocks or backticks. Do not include any text before or after the file contents.",vscpp("br",null),"Do not include comments in json files.",vscpp("br",null),"Do not use code blocks or backticks.",vscpp("br",null),"Do not include product names such as Visual Studio in the comments.",vscpp("br",null),"Below you will find a set of examples of what you should respond with. Please follow these examples as closely as possible.",vscpp("br",null),vscpp("br",null),"## Valid question",vscpp("br",null),"User: I want to set up the following project: Create a TypeScript Express app",vscpp("br",null),"This is the project tree structure:",vscpp("br",null),"\\`\\`\\`markdown ",vscpp("br",null),"my-express-app",vscpp("br",null),"\u251C\u2500\u2500 src",vscpp("br",null),"\u2502   \u251C\u2500\u2500 app.ts",vscpp("br",null),"\u2502   \u251C\u2500\u2500 controllers",vscpp("br",null),"\u2502   \u2502   \u2514\u2500\u2500 index.ts",vscpp("br",null),"\u2502   \u251C\u2500\u2500 routes",vscpp("br",null),"\u2502   \u2502   \u2514\u2500\u2500 index.ts",vscpp("br",null),"\u2502   \u2514\u2500\u2500 types",vscpp("br",null),"\u2502       \u2514\u2500\u2500 index.ts",vscpp("br",null),"\u251C\u2500\u2500 package.json",vscpp("br",null),"\u251C\u2500\u2500 tsconfig.json",vscpp("br",null),"\u2514\u2500\u2500 README.md",vscpp("br",null),"\\`\\`\\`",vscpp("br",null),"## Valid response",vscpp("br",null),"Assistant: The project has the following files:",vscpp("br",null),"\\`src/app.ts\\`: This file is the entry point of the application. It creates an instance of the express app and sets up middleware and routes.",vscpp("br",null),"\\`src/controllers/index.ts\\`: This file exports a class \\`IndexController\\` which has a method \\`getIndex\\` that handles the root route of the application.",vscpp("br",null),"\\`src/routes/index.ts\\`: This file exports a function \\`setRoutes\\` which sets up the routes for the application. It uses the \\`IndexController\\` to handle the root route.",vscpp("br",null),"\\`src/types/index.ts\\`: This file exports interfaces \\`Request\\` and \\`Response\\` which extend the interfaces from the \\`express\\` library.",vscpp("br",null),"\\`tsconfig.json\\`: This file is the configuration file for TypeScript. It specifies the compiler options and the files to include in the compilation.",vscpp("br",null),"\\`package.json\\`: This file is the configuration file for npm. It lists the dependencies and scripts for the project.",vscpp("br",null),"\\`README.md\\`: This file contains the documentation for the project.",vscpp("br",null)),vscpp(Dc.UserMessage,{priority:900},"I want to set up the following project: ",this.props.query,vscpp("br",null),"This is the project tree structure:",vscpp("br",null),"\\`\\`\\`markdown' ",vscpp("br",null),this.props.fileTreeStr,vscpp("br",null),"\\`\\`\\`",vscpp("br",null)))}},Z8=class extends Dc.PromptElement{render(e,t){let r=[];for(let o of this.props.messages)switch(o.role){case"user":r.push(vscpp(Dc.UserMessage,{priority:600},o.content));break;case"assistant":r.push(vscpp(Dc.AssistantMessage,{priority:800},o.content));break;default:break}return vscpp(vscppf,null,r)}};var FC=class{constructor(e,t,r,o){this.promptType=e;this.endpointProvider=t;this.instantiationService=r;this.chatMLFetcher=o}async generate(e,t){let r=await this.endpointProvider.getChatEndpoint("gpt-4o-mini"),s=await Fe.create(this.instantiationService,r,this.promptType,e).render(),a=await this.chatMLFetcher.fetchOne("newWorkspaceContentGenerator",s.messages,void 0,t,5,r,void 0,void 0);return a.type==="success"?e.filePath?this.parseContents(e.filePath,a.value):a.value:""}};FC=E([v(1,_e),v(2,H),v(3,Et)],FC);var UC=class extends FC{constructor(e,t,r){super(J8,e,t,r)}parseContents(e,t){throw new Error("Method not implemented.")}};UC=E([v(0,_e),v(1,H),v(2,Et)],UC);var BC=class extends FC{constructor(e,t,r){super(X8,e,t,r)}parseContents(e,t){function r(o,s){try{let a=s.exec(o.trim());if(a&&a.length>2)return a[2]}catch(a){console.error(a)}return o}if(e.endsWith(".md")){let o=r(t,/^```([a-zA-Z]+)?\s*([\s\S]+?)\s*```$/),[s,...a]=o.split("#");return s.length?["",...a].join("#"):o}else return r(t,/```([^\n]+)?\s*\n([\s\S]+?)\s*```/g)}};BC=E([v(0,_e),v(1,H),v(2,Et)],BC);var uN=re("INewWorkspacePreviewContentManager"),gJ="github.copilot.createProject",vJ="github.copilot.createFile",e9="github.copilot.openFile",qC=class{constructor(e){this.responseScopedData=new Map;this.prevFileContents=new Map;this.copilotContentManager=e.createInstance(aN),this.githubContentManager=e.createInstance(cN),this.fileContentManager=new pJ}set(e,t,r,o){this.responseScopedData.set(e,r),mJ(r.baseUri)?this.githubContentManager.set(e,t,r,o):hJ(r.baseUri)?this.fileContentManager.set(e,t,r,o):this.copilotContentManager.set(e,t,r,o)}get(e){this.prevResponseId!==e.authority&&(this.prevFileContents.clear(),this.prevResponseId=e.authority);let t;return mJ(e)?t=this.githubContentManager.get(e.authority,e.path):hJ(e)?t=this.fileContentManager.get(e.authority,e.path):t=this.copilotContentManager.get(e.authority,e.path,this.prevFileContents),t?.content?.then(r=>{if(this.prevFileContents.has(e.path))return;let s=new TextDecoder().decode(r);this.prevFileContents.set(e.path,s)}),t}getFileTree(e){return this.responseScopedData.get(e)}};qC=E([v(0,H)],qC);var aN=class{constructor(e){this.instantiationService=e;this.promises=[];this.responseScopedData=new Map;this.generatePlanPrompt=this.instantiationService.createInstance(UC);this.generateFilePrompt=this.instantiationService.createInstance(BC)}set(e,t,r,o){let{userPrompt:s,projectStructure:a,chatMessages:c}=o,l={query:s,fileTreeStr:a,history:c},u=this.generatePlanPrompt.generate(l,Zt.None);this.promises.push(u);let d=this._getResponseScopedData(e),p={userPrompt:s,projectSpecification:u,projectStructure:a,fileTree:r,chatMessages:c};d.set(t,p)}get(e,t,r){let{projectName:o,path:s}=this._getProjectMetadata(t),c=this._getResponseScopedData(e).get(o);if(!c)return;let l=c.fileTree.value,u=yJ(l,s);if(u&&!u?.content){let d=u;d.content=this._getFileContent(c.userPrompt,c.projectStructure,c.projectSpecification,t,c.chatMessages,r).catch(()=>d.content=void 0)}return u}_prefetch(e,t,r,o,s){let a=Date.now();return o.children?{...o,type:2,children:o.children.map(c=>this._prefetch(e,t,r,c,s)),ctime:a}:{...o,type:1,content:void 0,ctime:a}}async _getFileContent(e,t,r,o,s,a){let c={query:e,fileTreeStr:t,filePath:o,projectSpecification:await r,history:s,relavantFiles:a.has(o)?new Map([[o,a.get(o)]]):void 0};return this.generateFilePrompt.generate(c,Zt.None).then(l=>Buffer.from(l))}_getResponseScopedData(e){let t=this.responseScopedData.get(e);return t||(t=new Map,this.responseScopedData.set(e,t)),t}_getProjectMetadata(e){let[,t,...r]=e.split("/");return{projectName:t,path:r}}};aN=E([v(0,H)],aN);var cN=class{constructor(e){this.repositoryService=e;this.responseScopedData=new Map}set(e,t,r,o){let s=o,a=this._getResponseScopedData(e),c={...s,fileTree:r};a.set(t,c)}get(e,t){let{projectName:r,path:o}=this._getProjectMetadata(t),a=this._getResponseScopedData(e).get(r);if(!a)return;let c=a.fileTree.value,l=yJ(c,o);if(l&&!l?.content&&!l?.children){let u=l,d=a.path==="."?F_e.relative(a.repo,t):t.slice(1);u.content=this.repositoryService.getRepositoryItemContent(a.org,a.repo,d).catch(()=>u.content=void 0)}return l}_getProjectMetadata(e){let[,t,...r]=e.split("/");return{projectName:t,path:r}}_getResponseScopedData(e){let t=this.responseScopedData.get(e);return t||(t=new Map,this.responseScopedData.set(e,t)),t}};cN=E([v(0,Id)],cN);var pJ=class{constructor(){this.responseScopedData=new Map}set(e,t,r,o){let s=o,a=this._getResponseScopedData(e),c={content:s,fileTree:r};a.set(t,c)}get(e,t){let{projectName:r,path:o}=this._getFileMetadata(t),a=this._getResponseScopedData(e).get(r);if(!a)return;let c=a.fileTree.value,l=yJ(c,o);return l&&!l?.content&&!l?.children&&(l.content=Promise.resolve(new Uint8Array(new TextEncoder().encode(a.content)))),l}_getFileMetadata(e){let[,t,...r]=e.split("/");return{projectName:t,path:r}}_getResponseScopedData(e){let t=this.responseScopedData.get(e);return t||(t=new Map,this.responseScopedData.set(e,t)),t}};function yJ(n,e){let t;for(let r of e)t?t.children&&(t=t.children.find(o=>o.name===r)??t):t=n.find(o=>o.name===r);return t}var dJ="new",jC=class{constructor(e,t){this.endpointProvider=e;this.instantiationService=t;this.id="new";this.locations=[2];this.description=Ih.t("Scaffold code for a new file or project in a workspace");this.commandInfo={allowsEmptyArgs:!1,defaultEnablement:!0}}static{this.ID="new"}get intentDetectionInput(){let e="create_new_workspace";return{functionName:e,sampleQuestion:"Create a RESTful API server using typescript",modelDescription:"Scaffolds a new file or project from scratch based on requirements from the user.",functionCallingBlurb:`If the user's message is related to generating files, folders, projects, workspaces, or VS Code extensions, you should use the '${e}' function.`}}async invoke(e){let t=e.location,r=await this.endpointProvider.getChatEndpoint(e.request);return this.instantiationService.createInstance(lN,this,r,t)}};jC=E([v(0,_e),v(1,H)],jC);function O_e(n,e){return{command:gJ,arguments:[n,e],title:Ih.t("Create Workspace...")}}function OQe(n){return{command:vJ,arguments:[n],title:Ih.t("Create File...")}}var lN=class{constructor(e,t,r,o,s,a,c){this.intent=e;this.endpoint=t;this.location=r;this.instantiationService=o;this.configurationService=s;this.newWorkspacePreviewContentManager=a;this.workspaceService=c;this.linkification={disable:!0}}async getShouldUseProjectTemplate(){let e=this.configurationService.getConfig(le.UseProjectTemplates);return e!==void 0?e:!1}async buildPrompt(e,t,r){let{query:o,history:s,chatVariables:a}=e,c=!a.hasVariables()&&s[s.length-1]?.request?.message!==o&&await this.getShouldUseProjectTemplate(),u=await Fe.create(this.instantiationService,this.endpoint,MC,{promptContext:e,useTemplates:c,endpoint:this.endpoint}).render(t,r),d=u.metadata.get(Rx);return d&&(this.githubContentMetadata=d),u}processResponse(e,t,r,o){return new fJ(this.newWorkspacePreviewContentManager,this.workspaceService,this.githubContentMetadata).processResponse(e,t,r,o)}};lN=E([v(3,H),v(4,be),v(5,uN),v(6,Be)],lN);function MQe(n,e,t){let r;t?r=n.map(u=>[e.path,u.path].join("/")):r=n.map(u=>u.path);let o=r[0].split("/")[0],s={name:o,children:[]},a={rootName:s};for(let u of r){let d=u.split("/"),p=o,f=s;for(let m=1;m<d.length;m++){let h=d[m];if(p+=`/${h}`,!a[p]){let g={name:h};f.children===void 0&&(f.children=[]),f.children.push(g),a[p]=g}f=a[p]}}let c;t?c=s.children?.[0].children??[]:c=s.children??[];let l=c?.sort((u,d)=>u.children&&!d.children?-1:1)??[];return new Td(l,e)}var t9="vscode-copilot-workspace",n9="vscode-copilot-github-workspace",Px="vscode-copilot-file";function M_e(n,e,t=!1){return zt.from({scheme:t?n9:t9,authority:n??"",path:e?`/${e}`:void 0})}var fJ=class{constructor(e,t,r){this.newWorkspacePreviewContentManager=e;this.workspaceService=t;this.githubContentMetadata=r;this._appliedText="";this._p=Promise.resolve("")}async processResponse(e,t,r,o){let{turn:s,messages:a}=e,c=!1,l="",u=/```filetree\n/,d=a.filter(f=>f.role!=="system"),p=!1;for await(let{delta:f}of t){if(o.isCancellationRequested)break;let m=f.text;this._p=this._p.then(async()=>{let h=s.requestId??"";if(s.response||(s.response={message:this._appliedText,type:"model"}),!m)return this._appliedText;if(s.response.message+=m,this._appliedText+=m,this._appliedText.startsWith("#"))/(?:.*\n){1,}/.test(this._appliedText)&&r.markdown(m);else{let g=s.request.message,y=this._appliedText.match(/```filetree\n([\s\S]+?)\n```/);if(y&&(c||!p)){c=!1;let[b,_]=this._appliedText.split(y[0]);p||r.markdown(b),l=y[1];let{chatResponseTree:x,projectName:I}=K8(l,S=>M_e(h,S));r.progress(Ih.t("Generating workspace preview...")),r.push(x),r.markdown(_),this.newWorkspacePreviewContentManager.set(h,I,x,{userPrompt:g,projectStructure:l,chatMessages:d})}else if(this._appliedText.match(u)&&!c&&!y){c=!0;let[b,_]=this._appliedText.split(u);l+=_,r.progress(Ih.t("Generating workspace preview..."))}else c?l+=m:!c&&!this._appliedText.match(/```/)&&(p=!0,r.markdown(m))}return this._appliedText})}if(await this._p,s.requestId&&this.githubContentMetadata&&this.githubContentMetadata.org&&this.githubContentMetadata.repo&&this.githubContentMetadata.path&&this.githubContentMetadata.githubRepoItems&&!this.newWorkspacePreviewContentManager.getFileTree(s.requestId)){r.reference(zt.parse(this.githubContentMetadata.githubRepoItems[0].html_url)),r.progress(Ih.t("Generating workspace preview..."));let f=this.githubContentMetadata.path===".",m=f?this.githubContentMetadata.repo:this.githubContentMetadata.path.split("/")[0],h=MQe(this.githubContentMetadata.githubRepoItems,M_e(s.requestId,m,!0),f);r.push(h);let g=this.workspaceService.getWorkspaceFolders();r.button(O_e(h,g.length>0?g[0]:void 0)),this.newWorkspacePreviewContentManager.set(s.requestId,m,h,this.githubContentMetadata);let y=encodeURIComponent(`["@workspace /${dJ} ${s.request.message}"]`),b=new Ao(Ih.t("Hint: You can [regenerate this project without using this sample](command:workbench.action.chat.open?{0}) or use this [setting](command:workbench.action.openSettings?%5B%22github.copilot.chat.useProjectTemplates%22%5D) to configure the behavior.",y));b.isTrusted={enabledCommands:["workbench.action.openSettings","workbench.action.chat.open"]},r.markdown(b)}else{if(!s.requestId)throw new Error("Request ID is undefined");let f=Is(this._appliedText);if(f.length===2){let m;try{m=gf(f[1].code)}catch(_){throw _}let h=zt.from({scheme:Px,authority:s.requestId,path:`/${m.fileName}`}),g=new Td([{name:`${m.fileName}`}],h),y=W8(e9,[g]),b=new Ao(`[${m.fileName}](${y})`);b.isTrusted={enabledCommands:[e9]},r.markdown(Ih.t("Sure, here is the file you requested:")),r.markdown(b),this.newWorkspacePreviewContentManager.set(s.requestId,m.fileName,g,f[0].code)}}this.pushCommands(s.requestId,r)}pushCommands(e,t){let r=this.newWorkspacePreviewContentManager.getFileTree(e);if(!r||mJ(r.baseUri))return;if(hJ(r.baseUri)){t.button(OQe(r));return}let o=this.workspaceService.getWorkspaceFolders();t.button(O_e(r,o.length>0?o[0]:void 0))}};function mJ(n){return n.scheme===n9}function hJ(n){return n.scheme===Px}var bJ=q(ht());var vi=re("ITerminalService");var U0=q(Ve());var U_e=q(ht()),r9=q(Ve());var Th=class extends r9.PromptElement{constructor(t,r){super(t);this._terminalService=r}static{this.variableInfo={name:"terminalLastCommand",description:U_e.t("The active terminal's last run command"),defaultEnablement:!0}}async prepare(){return this._terminalService.terminalLastCommand}render(t,r){if(!t)return;let o=[];t.commandLine&&(o.push("The following is the last command run in the terminal:"),o.push(t.commandLine)),t.cwd&&(o.push("It was run in the directory:"),o.push(typeof t.cwd=="object"?t.cwd.toString():t.cwd)),t.output&&(o.push("It has the following output:"),o.push(t.output));let s=o.join(`
`);return vscpp(vscppf,null,vscpp(r9.UserMessage,{priority:this.props.priority},"The active terminal's last run command:",vscpp("br",null),s))}};Th=E([v(1,vi)],Th);var B_e=q(ht()),dN=q(Ve());var HC=class extends dN.PromptElement{constructor(t,r){super(t);this._terminalService=r}static{this.variableInfo={name:"terminalSelection",description:B_e.t("The active terminal's selection"),defaultEnablement:!0}}async prepare(){return this._terminalService.terminalSelection}render(t,r){return t.trim().length===0?vscpp(vscppf,null,vscpp(dN.UserMessage,{priority:this.props.priority},"The active terminal has no selection.")):vscpp(vscppf,null,vscpp(dN.UserMessage,{priority:this.props.priority},"The active terminal's selection:",vscpp("br",null),t))}};HC=E([v(1,vi)],HC);var i9=class extends U0.PromptElement{render(e){let{history:t,chatVariables:r}=this.props.promptContext,o=this.props.promptContext.query||"What did the last command do?";return vscpp(vscppf,null,vscpp(U0.SystemMessage,{priority:1e3},"You are a programmer who specializes in using the command line. Your task is to help the Developer by giving a detailed answer to their query.",vscpp("br",null),vscpp(vn,null),vscpp(Ze,null)),vscpp(Nt,{flexGrow:1,historyPriority:600,passPriority:!0,history:t},vscpp(Tt,{priority:1e3},vscpp(ii,null),vscpp(kt,null),vscpp("br",null),"Additional Rules",vscpp("br",null),`Generate a response that clearly and accurately answers the user's question. In your response, follow the following:
- Provide any command suggestions using the active shell and operating system.
- Say "I'm not quite sure how to do that." when you aren't confident in your explanation`,vscpp("br",null))),vscpp(U0.UserMessage,{flexGrow:1,priority:750},vscpp(sn,{languageId:void 0})),vscpp(U0.UserMessage,{flexGrow:1,priority:800},"The active terminal's shell type is:",vscpp("br",null),this.props.shellType),vscpp(U0.UserMessage,{flexGrow:1,priority:800},"The active operating system is:",vscpp("br",null),this.props.osName),vscpp(HC,{flexGrow:1,priority:800}),vscpp(Th,{flexGrow:1,priority:800}),vscpp(tn,{priority:899,flexGrow:2,endpoint:this.props.endpoint,promptContext:this.props.promptContext}),vscpp($n,{flexGrow:2,priority:900,chatVariables:r,query:o}))}};var qd=class{constructor(e,t){this.instantiationService=e;this.endpointProvider=t;this.id=qd.ID;this.locations=[2,4];this.description=bJ.t("Explain what just happened in the terminal");this.commandInfo={allowsEmptyArgs:!0,defaultEnablement:!0,sampleRequest:bJ.t("What did the last command do?")}}static{this.ID="terminalExplain"}static{this.intentName="explain"}get intentDetectionInput(){let e="explain_terminal_state";return{functionName:e,sampleQuestion:"What did the last command do?",functionCallingBlurb:`If the user's message is about explaining what happened in the terminal, you should use the '${e}' function.`}}async invoke(e){let t=e.location,r=await this.endpointProvider.getChatEndpoint(e.request);return this.instantiationService.createInstance(pN,this,r,t)}};qd=E([v(0,H),v(1,_e)],qd);var pN=class{constructor(e,t,r,o,s,a){this.intent=e;this.endpoint=t;this.location=r;this.instantiationService=o;this.envService=s;this.terminalService=a}async buildPrompt(e,t,r){let o=this.envService.OS,s=this.terminalService.terminalShellType;return await Fe.create(this.instantiationService,this.endpoint,i9,{promptContext:e,osName:o,shellType:s,endpoint:this.endpoint}).render(t,r)}};pN=E([v(3,H),v(4,it),v(5,vi)],pN);var q_e=q(ht()),Ir=q(require("vscode"));function Ax(n){return new Me(n.start,n.start)}function o9(n,e){if(!e.length)return;let t;for(let r of n)if(r.children){let o=r.name===e[0]?{symbol:r,matchCount:1}:void 0;if(o){let c=o9(r.children,e.slice(1));c&&(o={symbol:c.symbol,matchCount:o.matchCount+c.matchCount})}let s=o9(r.children,e),a;o&&s?a=o.matchCount>=s.matchCount?o:s:a=o??s,a&&(!t||a.matchCount>t?.matchCount)&&(t=a)}else r.name===e[0]&&(t??={symbol:r,matchCount:1});return t}function s9(n,e){return(o9(n,[e])??o9(n,FQe(e)))?.symbol}function FQe(n){return Array.from(n.matchAll(/[#\w$][\w\d$]*/g),e=>e[0])}var UQe="_github.copilot.openSymbolFromReferences";function j_e(n){return T1(Ir.commands.registerCommand(P_e,async(...[e,t])=>{n.sendMSFTTelemetryEvent("panel.action.filelink",{requestId:t});let r=Ir.workspace.workspaceFolders?.[0].uri;if(!r)return;let o=typeof e=="string"?Ir.Uri.joinPath(r,e):Ir.Uri.from(e);if(await s(o))await Ir.commands.executeCommand("revealInExplorer",o);else return Ir.commands.executeCommand("vscode.open",o);async function s(a){if(a.path.endsWith("/"))return!0;try{return(await Ir.workspace.fs.stat(a)).type===Ir.FileType.Directory}catch{return!1}}}),Ir.commands.registerCommand(A_e,async(...[e,t,r])=>{let o=Ir.Uri.from(e),s;try{s=await Ir.commands.executeCommand("vscode.executeDocumentSymbolProvider",o)}catch(a){console.error(a)}if(s?.length){let a=s9(s,t);if(n.sendMSFTTelemetryEvent("panel.action.symbollink",{requestId:r},{hadMatch:a?1:0}),a){let c=a instanceof Ir.SymbolInformation?a.location.range:a.selectionRange;return Ir.commands.executeCommand("vscode.open",o,{selection:new Ir.Range(c.start,c.start)})}}return Ir.commands.executeCommand("vscode.open",o)}),Ir.commands.registerCommand(UQe,async(...[e,t,r])=>{let o=await _J(t,Zt.None);if(n.sendMSFTTelemetryEvent("panel.action.openSymbolFromReferencesLink",{requestId:r,resolvedDestinationType:o?.type??"unresolved"}),o){let s=o.loc.targetSelectionRange??o.loc.targetRange;return Ir.commands.executeCommand("vscode.open",o.loc.targetUri,{selection:Ax(s)})}else return Ir.window.showWarningMessage((0,q_e.t)("Could not resolve this symbol in the current workspace."))}))}function BQe(n){return"uri"in n?{targetUri:n.uri,targetRange:n.range}:n}async function _J(n,e){let t;for(let r of n)try{let o=(await Ir.commands.executeCommand("vscode.executeDefinitionProvider",Ir.Uri.from(r.uri),r.pos)).at(0);if(e.isCancellationRequested)return;if(o){t={type:"definition",loc:BQe(o)};break}}catch(o){console.error(o)}if(!t){let r=n.at(0);r&&(t={type:"firstOccurrence",loc:{targetUri:Ir.Uri.from(r.uri),targetRange:new Ir.Range(r.pos,r.pos)}})}return t}var zC=q(require("vscode"));var Cl=q(require("vscode"));async function a9(n,e,t,r,o){let s=n.get(ft),a=[],c=r.maxResultCount??1/0,l=new Ap(10);try{await Promise.all(e.map(u=>l.queue(async()=>{if(a.length>=c||o.isCancellationRequested)return;let d;D2(u.anchor)?d=await xJ(s,t,u.anchor,new Cl.Range(0,0,Number.MAX_SAFE_INTEGER,0),r,o):"range"in u.anchor?d=await xJ(s,t,u.anchor.uri,u.anchor.range,r,o):"value"in u.anchor&&$e.isUri(u.anchor.value)&&(d=await xJ(s,t,u.anchor.value,new Cl.Range(0,0,Number.MAX_SAFE_INTEGER,0),r,o)),d&&a.push(d)})))}finally{l.dispose()}return a.sort((u,d)=>d.type-u.type).map(u=>u.location).slice(0,r.maxResultCount)}async function xJ(n,e,t,r,o,s){let a=await qQe(t);if(!a||s.isCancellationRequested)return;let c=await jQe(n,a,r,s);if(s.isCancellationRequested)return;for(let d of c)if(d.identifier===e){let p=a.positionAt(d.startIndex);return{type:2,location:new Cl.Location(t,p)}}if(o.symbolMatchesOnly)return;let l=a.getText(r),u=a.offsetAt(r.start);for(let d of l.matchAll(new RegExp(j_(e),"g")))if(d.index){let p=a.positionAt(u+d.index);if("getWordRangeAtPosition"in a){let f=a.getText(a.getWordRangeAtPosition(p));if(e===f)return{type:1,location:new Cl.Location(t,p)}}else{let f=a.getText(new Cl.Range(p,a.positionAt(a.offsetAt(p)+e.length)));if(e===f)return{type:1,location:new Cl.Location(t,p)}}}}async function qQe(n){let e=Cl.workspace.textDocuments.find(t=>t.uri.toString()===n.toString());if(e)return e;try{let t=await Cl.workspace.fs.readFile(n),r=fo(n).languageId,o=$T.create(n.toString(),r,0,new TextDecoder().decode(t));return new class{constructor(){this.languageId=r}getText(s){return o.getText(s)}offsetAt(s){return o.offsetAt(s)}positionAt(s){let a=o.positionAt(s);return new Cl.Position(a.line,a.character)}}}catch{return}}async function jQe(n,e,t,r){let o=_l(e.languageId);if(!o)return[];let s=n.getTreeSitterASTForWASMLanguage(o,e.getText());return s?s.getSymbols({startIndex:e.offsetAt(t.start),endIndex:e.offsetAt(t.end)}):[]}var VC=class{constructor(e,t){this.findWordOptions=e;this.instantiationService=t;this.cache=new Map}async resolve(e,t,r){if(!t.length)return;let o=this.cache.get(e);if(o)return o;{let s=this.doResolve(e,t,r);return this.cache.set(e,s),s}}async doResolve(e,t,r){let o=await this.instantiationService.invokeFunction(s=>a9(s,t,e,this.findWordOptions,r));if(!r.isCancellationRequested){if(!o.length){let s=e.split(/([#\w$][\w\d$]*)/g).map(c=>c.trim()).filter(c=>c.length),a;for(let c of s){if(!/[#\w$][\w\d$]*/.test(c))break;a=c}a&&a!==e&&(o=await this.instantiationService.invokeFunction(c=>a9(c,t,a,{symbolMatchesOnly:!0,maxResultCount:this.findWordOptions.maxResultCount},r)))}return o.slice(0,this.findWordOptions.maxResultCount)}}};VC=E([v(1,H)],VC);var HQe=/(?<!\[)`([^`\n]+)`(?!\])/g,VQe=8,GC=class{constructor(e){this.resolver=e.createInstance(VC,{symbolMatchesOnly:!0,maxResultCount:VQe})}async linkify(e,t,r){if(!t.references.length||zC.version.startsWith("1.94"))return;let o=[],s=0;for(let c of e.matchAll(HQe)){let l=e.slice(s,c.index);l&&o.push(l);let u=c[1],d=await this.resolver.resolve(u,t.references,r);if(r.isCancellationRequested)throw new dt;if(d?.length){let p={name:u,containerName:"",kind:zC.SymbolKind.Variable,location:d[0]};o.push(new P0(p,async f=>{let m=await _J(d.map(h=>({uri:h.uri,pos:h.range.start})),f);if(m){let h=m.loc.targetSelectionRange??m.loc.targetRange;p.location=new zC.Location(m.loc.targetUri,Ax(h))}return p}))}else o.push(c[0]);s=c.index+c[0].length}let a=e.slice(s);return a&&o.push(a),{parts:o}}};GC=E([v(0,H)],GC);var yf=q(require("vscode"));var $C=class{constructor(e,t){this.fileSystem=e;this.workspaceService=t}async linkify(e,t,r){let o=this.workspaceService.getWorkspaceFolders();if(!o.length)return;let s=[],a=0;for(let l of e.matchAll(/\[`([^`\[\]]+?)`]\((\S+?\.\w+)\)/g)){let u=e.slice(a,l.index);u&&s.push(u);let[d,p,f]=l,m;for(let h of o){let g=zt.joinPath(h,f);if(await this.exists(g)){m=g;break}}if(m){let h={name:p,containerName:"",kind:yf.SymbolKind.Variable,location:new yf.Location(m,new yf.Position(0,0))};s.push(new P0(h,async g=>{let y;try{y=await yf.commands.executeCommand("vscode.executeDocumentSymbolProvider",m)}catch{}if(y?.length){let b=s9(y,p);if(b)if(h.kind=b.kind,b.children){let _=b;h.location=new yf.Location(m,Ax(_.selectionRange))}else{let _=b;h.location=new yf.Location(_.location.uri,Ax(_.location.range))}}return h}))}else s.push("`"+p+"`");a=l.index+l[0].length}let c=e.slice(a);return c&&s.push(c),{parts:s}}async exists(e){try{return await this.fileSystem.stat(e),!0}catch{return!1}}};$C=E([v(0,gn),v(1,Be)],$C);var Nx=q(require("vscode"));var Hd=q(ht());var jd=re("IRunCommandExecutionService");var Dx=q(Ve());var c9=q(ht()),_a=q(Ve());var WC=class extends _a.PromptElement{constructor(t,r,o,s,a,c,l,u,d){super(t);this.chatMLFetcher=r;this.logService=o;this.embeddingsComputer=s;this.endPointProvider=a;this.combinedEmbeddingIndex=c;this.docSearchClient=l;this.envService=u;this.instantiationService=d}async prepare(t,r,o){r?.report(new Ri(c9.t("Refining question to improve search accuracy.")));let s=this.props.promptContext.query,a=await this.endPointProvider.getChatEndpoint("gpt-4o-mini"),c=Fe.create(this.instantiationService,a,SJ,this.props.promptContext),{messages:l}=await c.render();if(o.isCancellationRequested)return{docSearchResults:[],settings:[],commands:[],query:s};this.logService.internal.debug("[VSCode Prompt] Asking the model to update the user question.");let u=await this.chatMLFetcher.fetchOne("vscodePrompt",l,async b=>{},o,2,a,void 0,{temperature:0});if(o.isCancellationRequested)return{docSearchResults:[],settings:[],commands:[],query:s};u.type==="success"?s=GQe(this.props.promptContext.query,u.value):this.logService.public.error(`[VSCode Prompt] Failed to refine the question: ${u.requestId}`);let d=r?kx(r,new Ri(c9.t("Searching doc index...")),this.searchDocsSearchForContext(s,10,o,this.logService),1e3):this.searchDocsSearchForContext(s,10,o,this.logService);if(o.isCancellationRequested)return{docSearchResults:[],settings:[],commands:[],query:s};let p=await this.endPointProvider.getEmbeddingsEndpoint("text3small"),f=await this.embeddingsComputer.computeEmbeddings(p,[s],{dimensions:512},void 0);if(o.isCancellationRequested)return{docSearchResults:[],settings:[],commands:[],query:s};if(!f)return{docSearchResults:await d,settings:[],commands:[],query:s};let m=r?kx(r,new Ri(c9.t("Searching command and setting index....")),this.combinedEmbeddingIndex.nClosestValues(f.embeddings[0],5),500):this.combinedEmbeddingIndex.nClosestValues(f.embeddings[0],5),h=await Promise.allSettled([m,d]),g=h[0].status==="fulfilled"?h[0].value:{commands:[],settings:[]};return{docSearchResults:(h[1].status==="fulfilled"?h[1].value:[])||[],settings:g.settings,commands:g.commands,query:s}}async searchDocsSearchForContext(t,r,o,s){try{return await this.docSearchClient.search(t,{repo:"microsoft/vscode-docs"},{limit:r,similarity:.75},o)}catch(a){return this.logService.public.error(a,"Failed to search docs search for query"),[]}}render(t){let r=this.envService.OS;return vscpp(vscppf,null,vscpp(_a.SystemMessage,{priority:1e3},"You are a Visual Studio Code assistant. Your job is to assist users in using Visual Studio Code by providing knowledge to accomplish their task. This knowledge should focus on settings and commands, but also includes documentation. Please do not guess a response and instead just respond with a polite apology if you are unsure.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.",vscpp("br",null),"Your expertise is strictly limited to software development topics.",vscpp("br",null),"Follow Microsoft content policies.",vscpp("br",null),"Avoid content that violates copyrights.",vscpp("br",null),"For questions not related to software development, simply give a reminder that you are an AI programming assistant.",vscpp("br",null),"Keep your answers short and impersonal.",vscpp("br",null),"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The user is working on a ",r," machine. Please respond with system specific commands if applicable.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn.",vscpp("br",null)),vscpp(Nt,{flexGrow:1,historyPriority:700,passPriority:!0,history:this.props.promptContext.history},vscpp(Tt,{priority:1e3},"If you are referencing multiple commands and settings, please respond step by step in a numbered list format.",vscpp("br",null),vscpp("br",null),vscpp(Rt,{name:"instructions"},"Additional Rules",vscpp("br",null),"You must respond with either a setting to set or a command to execute when applicable.",vscpp("br",null),"When referring to a command, you must use the command name in markdown bold syntax.",vscpp("br",null),"When referring to any commands, you must include the referenced commands in a properly formatted code block at the end of the sentence that references that command.",vscpp("br",null),"Similarly, all referenced settings must be properly formatted in a code block.",vscpp("br",null),"All responses for settings and commands code blocks must strictly adhere to the template shown below:",vscpp("br",null),"The response template for a command is as follows:",vscpp("br",null),vscpp(Pr,{code:`{
					  "type": "command",
					  "commands": {
						"command": "commandName",
						"args": "commandArgs"
					  }
					}`,languageId:"json"}),"The response template for a setting is as follows:",vscpp("br",null),vscpp(Pr,{code:`{
					  "type": "setting",
					  "settings": {
						"setting": "settingValue"
					  }
					}`,languageId:"json"}),vscpp("br",null),"If you are referencing multiple settings, combine all settings into the same code block at the beginning of your response, and then describe each setting in a numbered list after the code block, as shown in the template below:",vscpp("br",null),"## Multiple settings response template",vscpp("br",null),vscpp(Pr,{code:`{
  "type": "setting",
  "settings": {
    "setting1": "settingValue1",
    "setting2": "settingValue2",
    "setting3": "settingValue3"
	...
	}
}`,languageId:"json"}),vscpp("br",null),"If you are referencing multiple commands, do not combine all the commands into the same JSON markdown code block. Instead, describe each command and include the JSON markdown code block in a numbered list, as shown in the template below:",vscpp("br",null),"## Multiple commands response template",vscpp("br",null),"1. **Command1** - Description of Command1",vscpp("br",null),vscpp(Pr,{code:`{
  "type": "command",
  "commands": {
    "command": "command1",
  }
}`,languageId:"json"}),"2. **Command2** - Description of Command2",vscpp("br",null),vscpp(Pr,{code:`{
  "type": "command",
  "commands": {
    "command": "command2",
  }
}`,languageId:"json"}),"3. ...",vscpp("br",null),'If you are referencing multiple commands and setting, respond with numbered steps for the user to follow. First mention all the commands as per the "Multiple commands response template" and then all the settings as per the "Multiple settings response template" shown above.',vscpp("br",null),"## Multiple command and settings response template",vscpp("br",null),"1. **Command1** - Description of Command1",vscpp("br",null),vscpp(Pr,{code:`{
  "type": "command",
  "commands": {
    "command": "command1",
  }
}`,languageId:"json"}),"2. **Command2** - Description of Command2",vscpp("br",null),vscpp(Pr,{code:`{
  "type": "command",
  "commands": {
    "command": "command2",
  }
}`,languageId:"json"}),"3. A short summary of the combined settings.",vscpp(Pr,{code:`{
  "type": "setting",
  "settings": {
    "setting1": "settingValue1",
    "setting2": "settingValue2",
    "setting3": "settingValue3"
  }
}`,languageId:"json"}),vscpp("br",null),vscpp("br",null),"If a command or setting references another command or setting, you must respond with both the original and the referenced commands or settings.",vscpp("br",null),"The code block containing the command or setting should be included immediately after the sentence referencing it.",vscpp("br",null),vscpp("br",null),"Do not suggest opening the settings editor.",vscpp("br",null),"If answering with a keybinding, please still include the command bound to the keybinding.",vscpp("br",null),"If a keybinding contains a backtick you must escape it. For example the keybinding Ctrl + backtick would be written as ``ctrl + ` ``",vscpp("br",null),"Do not suggest opening the command palette to execute commands.",vscpp("br",null),"Do not suggest commands or settings identifiers that do not exist.",vscpp("br",null),"Do not suggest installing Visual Studio Code because the user has already installed it.",vscpp("br",null),"If you believe the context given to you is incorrect or not relevant you may ignore it.",vscpp("br",null),"Always respond with a numbered list of steps to be taken to achieve the desired outcome if multiple steps are necessary.",vscpp("br",null),'If an extension might help the user, you may suggest a search query for the extension marketplace. You must also include the command **Search marketplace** (`workbench.extensions.search`) with args set to the suggested query in the commands section at the end of your response. The query can also contain the tags "@popular", "@recommended", or "@featured" to filter the results.',vscpp("br",null),vscpp("br",null),vscpp(Rt,{name:"examples"},"Below you will find a set of examples of what you should respond with. Please follow these examples as closely as possible.",vscpp("br",null),vscpp(Rt,{name:"example"},"## Single setting response",vscpp("br",null),"Question: How do I disable telemetry?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),vscpp(Pr,{code:`{
  "type": "setting",
  "settings": {
    "telemetry.telemetryLevel": "off",
  }
}`,languageId:"json"}),"is a setting which can be used to disable telemetry.",vscpp("br",null),vscpp("br",null)),vscpp(Rt,{name:"example"},"## Multiple settings response",vscpp("br",null),"Question: How can I change the font size in all areas of Visual Studio Code, including the editor, terminal?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),vscpp(Pr,{code:`{
  "type": "setting",
  "settings": {
	"editor.fontSize": 18,
	"terminal.integrated.fontSize": 14,
	"window.zoomLevel": 1
  }
}`,languageId:"json"}),'1. `"editor.fontSize": 18` - This setting adjusts the font size within the editor. The default size is overridden by the value `18`, making the text larger and more readable according to user preference.',vscpp("br",null),'2. `"terminal.integrated.fontSize": 14` - Similarly, this setting changes the font size in the integrated terminal. By setting it to `14`, it increases the font size in the terminal independently from the editor.',vscpp("br",null),'3. `"window.zoomLevel": 1` - This setting controls the zoom level of the entire Visual Studio Code interface. A value of `1` means that the interface will be zoomed in to 120% of the original size, making everything appear bigger. A value of `0` would indicate no zoom (100% - default size), positive values zoom in, and negative values zoom out.',vscpp("br",null)),vscpp(Rt,{name:"example"},"## Multiple commands response",vscpp("br",null),"Question: What is the command to report an issue for other extensions in Visual Studio Code?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"Here are some possible commands:",vscpp("br",null),"1. **Report Issue** - This command can be used to report an issue for other extensions.",vscpp("br",null),vscpp(Pr,{code:`{
  "type": "command",
  "commands": {
	"command": "workbench.extensions.reportExtensionIssue"
  }
}`,languageId:"json"}),"2. **Docker: Report Issue** - This command can be used to report an issue for the Docker extension.",vscpp("br",null),vscpp(Pr,{code:`{
  "type": "command",
  "commands": {
	"command": "vscode-docker.help.reportIssue"
  }
}`,languageId:"json"}),"3. **Codespaces: Report Issue** - This command can be used to report an issue for the Codespaces extension.",vscpp("br",null),vscpp(Pr,{code:`{
  "type": "command",
  "commands": {
	"command": "github.codespaces.reportIssue"
  }
}`,languageId:"json"})),vscpp(Rt,{name:"example"},"## Single command response",vscpp("br",null),"Question: How do I close all editors?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"You can use the **Close All Editors** command to close all editors.",vscpp("br",null),vscpp("br",null),vscpp(Pr,{code:`{
  "type": "command",
  "commands": {
	"command": "workbench.action.closeAllEditors"
  }
}`,languageId:"json"})),vscpp(Rt,{name:"example"},"## No such command",vscpp("br",null),"Question: How do I move the terminal to a new window?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"There is no such command.",vscpp("br",null)),vscpp(Rt,{name:"example"},"## Invalid Question",vscpp("br",null),"Question: How do I bake a potato?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"Sorry this question isn't related to Visual Studio Code.",vscpp("br",null)),vscpp(Rt,{name:"example"},"## Marketplace search",vscpp("br",null),"Question: How do I add PHP support?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"You can use the **Search marketplace** command to search for extensions that add PHP support.",vscpp("br",null),vscpp("br",null),vscpp(Pr,{code:`{
  "type": "command",
  "commands": {
	"command": "workbench.extensions.search",
	"args": "php"
	}
}`,languageId:"json"})))),vscpp(kt,null))),vscpp(_a.UserMessage,{flexGrow:1,priority:800},"The current question is related to Visual Studio Code. ",vscpp("br",null),"If a command or setting is not a valid answer, but it still relates to Visual Studio Code, please still respond.",vscpp("br",null),"Please do not guess a response and instead just respond with a polite apology if you are unsure.",vscpp("br",null),"If you believe the given context given to you is incorrect or not relevant you may ignore it.",vscpp("br",null),"The user cannot see the context you are given, so you must not mention it. If you want to refer to it, you must include it in your reply.",vscpp("br",null),'Below is a list of commands and settings we found which might be relevant to the question. For view related commands "Toggle" often means Show or Hide. A setting may reference another setting, that will appear as \\`#setting.id#\\`, you must return the referenced setting as well. You may use this context to help you formulate your response, but are not required to.',vscpp("br",null),t.commands.length>0&&vscpp(vscppf,null,"Here are some possible commands:",vscpp("br",null)),t.commands.length>0&&t.commands.map(o=>vscpp(_a.TextChunk,null,"- ",o.label,' ("',o.key,'") (Keybinding: "',o.keybinding,'")')),t.settings.length>0&&vscpp(vscppf,null,"Here are some possible settings:",vscpp("br",null)),t.settings.length>0&&t.settings.map(o=>vscpp(_a.TextChunk,null,CY(o))),t.docSearchResults.length>0&&vscpp(vscppf,null,"Below is a list of information from the Visual Studio Code documentation which might be relevant to the question. ",vscpp("br",null)),t.docSearchResults.map(o=>vscpp(_a.TextChunk,null,"##",o?.title?.trim()," - ",o.path,vscpp("br",null),o.contents))),vscpp(tn,{priority:899,flexGrow:2,promptContext:{...this.props.promptContext,query:t.query},endpoint:this.props.endpoint}),vscpp($n,{flexGrow:2,priority:900,chatVariables:this.props.promptContext.chatVariables,query:this.props.promptContext.query}))}};WC=E([v(1,Et),v(2,oe),v(3,_s),v(4,_e),v(5,Pd),v(6,GT),v(7,it),v(8,H)],WC);var SJ=class extends _a.PromptElement{render(e,t){return vscpp(vscppf,null,vscpp(_a.SystemMessage,{priority:1e3},"You are a Visual Studio Code assistant who helps the user create well-formed and unambiguous questions about their Visual Studio Code development environment.",vscpp("br",null),"Specifically, you help users rewrite questions about how to use Visual Studio Code's Commands and Settings."),vscpp(Nt,{historyPriority:500,passPriority:!0,history:this.props.history||[]},vscpp(Tt,{priority:1e3},"Evaluate the question to determine the user's intent. ",vscpp("br",null),"Determine if the user's question is about the editor, terminal, activity bar, side bar, status bar or other parts of Visual Studio Code's workbench and include those keyword in the rewrite.",vscpp("br",null),"Determine if the user is asking about Visual Studio Code's Commands and/or Settings and explicitly include those keywords during the rewrite. ",vscpp("br",null),"Respond in Markdown. Under a `# Question` header, output a rephrased version of the user's question that resolves all pronouns and ambiguous words like 'this' to the specific nouns they stand for.",vscpp("br",null),"If it is not clear what the user is asking for or if the question appears to be unrelated to Visual Studio Code, do not try to rephrase the question and simply return the original question. ",vscpp("br",null),"DO NOT ask the user for additional information or clarification.",vscpp("br",null),"DO NOT answer the user's question directly.",vscpp("br",null),vscpp("br",null),"# Additional Rules",vscpp("br",null),vscpp("br",null),"Think step by step:",vscpp("br",null),"1. Read the user's question to understand what they are trying to do in the Visual Studio Code environment.",vscpp("br",null),"2. If the question contains pronouns such as 'it' or 'that', try to understand what the pronoun refers to by looking at the rest of the question and the conversation history.",vscpp("br",null),"3. If the question contains an ambiguous word such as 'this', try to understand what 'this' refers to by looking at the rest of the question and the conversation history.",vscpp("br",null),"4. After a `# Question` header, output a precise version of the question that resolves all pronouns and ambiguous words like 'this' to the specific nouns they stand for. Be sure to preserve the exact meaning of the question.",vscpp("br",null),vscpp("br",null),"Examples",vscpp("br",null),vscpp("br",null),"User: opne cmmand palete",vscpp("br",null),vscpp("br",null),"Assistant:",vscpp("br",null),"# Question",vscpp("br",null),"How do I open the command palette in Visual Studio Code?",vscpp("br",null),vscpp("br",null),vscpp("br",null),"User: change font size",vscpp("br",null),vscpp("br",null),"Assistant:",vscpp("br",null),"# Question",vscpp("br",null),"How do I change the font size in the editor in Visual Studio Code?",vscpp("br",null),vscpp("br",null),"User: Move editor and pin",vscpp("br",null),"Assistant: ",vscpp("br",null),"# Question",vscpp("br",null),"How do I move the editor to another group and then pin the editor in Visual Studio Code",vscpp("br",null),vscpp(kt,null))),vscpp(_a.UserMessage,{priority:700},this.props.query))}};function GQe(n,e){let t=e.match(/#+\s*Question\n(?<question>.+)/si);return t?.groups?t.groups.question.trim():n.trim()}var KC=class extends _a.PromptElement{constructor(t,r,o,s){super(t);this.embeddingComputer=r;this.endPointProvider=o;this.combinedIndex=s}async prepare(t,r,o){if(o.isCancellationRequested)return;let s=await this.endPointProvider.getEmbeddingsEndpoint("text3small"),a=await this.embeddingComputer.computeEmbeddings(s,[this.props.query],{dimensions:512},o);if(!o.isCancellationRequested&&a&&a.embeddings.length>0){this.combinedIndex.commandIdIndex.isIndexLoaded||await this.combinedIndex.commandIdIndex.calculateEmbeddings();let c=this.combinedIndex.commandIdIndex.nClosestValues(a.embeddings[0],5);if(c.length)return{snippets:c}}}render(t,r){let o=this.priority;return vscpp(vscppf,null,t&&t.snippets.length>0&&vscpp(_a.UserMessage,null,"Here are some possible commands:",vscpp("br",null),t.snippets.reverse().map(s=>vscpp(_a.TextChunk,{priority:o++},"- ",s.label,' ("',s.key,'") (Keybinding: "',s.keybinding,'")',vscpp("br",null)))))}};KC=E([v(1,_s),v(2,_e),v(3,Pd)],KC);var YC=class extends Dx.PromptElement{constructor(t,r){super(t);this.envService=r}render(t,r){let o=this.envService.OS;return vscpp(vscppf,null,vscpp(Dx.SystemMessage,{priority:1e3},"You are a Visual Studio Code assistant. Your job is to assist users in using Visual Studio Code by providing knowledge to accomplish their task. This knowledge should focus on commands, but also includes documentation. Please do not guess a response and instead just respond with a polite apology if you are unsure.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.",vscpp("br",null),"Your expertise is strictly limited to software development topics.",vscpp("br",null),"Follow Microsoft content policies.",vscpp("br",null),"Avoid content that violates copyrights.",vscpp("br",null),"For questions not related to software development, simply give a reminder that you are an AI programming assistant.",vscpp("br",null),"Keep your answers short and impersonal.",vscpp("br",null),"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The user is working on a ",o," machine. Please respond with system specific commands if applicable.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn.",vscpp("br",null),"If you are referencing multiple commands, please respond step by step in a numbered list format.",vscpp("br",null)),vscpp(Nt,{historyPriority:600,passPriority:!0,history:this.props.history},vscpp(Tt,{priority:1e3},vscpp(Rt,{name:"instructions"},"Additional Rules",vscpp("br",null),"You must respond with a command to execute when applicable.",vscpp("br",null),"When referring to a command, you must use the command name in markdown bold syntax.",vscpp("br",null),"When referring to any commands, you must include the referenced commands in a properly formatted JSON markdown code block at the end of the sentence that references that command.",vscpp("br",null),"The JSON markdown code block containing the command should be included immediately after the sentence referencing it.",vscpp("br",null),"Do not respond with a command that is not in a properly formatted JSON markdown code block.",vscpp("br",null),"If answering with a keybinding, please still include the command bound to the keybinding.",vscpp("br",null),"If a keybinding contains a backtick you must escape it. For example the keybinding Ctrl + backtick would be written as ``ctrl + ` ``",vscpp("br",null),"Do not suggest opening the command palette to execute commands.",vscpp("br",null),"Do not suggest command identifiers that do not exist.",vscpp("br",null),"Do not suggest installing Visual Studio Code because the user has already installed it.",vscpp("br",null),"If you believe the context given to you is incorrect or not relevant you may ignore it.",vscpp("br",null),"Always respond with a numbered list of steps to be taken to achieve the desired outcome if multiple steps are necessary.",vscpp("br",null),vscpp("br",null),vscpp(Rt,{name:"examples"},"Below you will find a set of examples of what you should respond with. Please follow these examples as closely as possible.",vscpp("br",null),vscpp("br",null),vscpp(Rt,{name:"example"},"## Single command response",vscpp("br",null),"Question: How do I close all editors?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"You can use the **Close All Editors** command to close all editors.",vscpp("br",null),vscpp("br",null),vscpp(Pr,{code:`{
	"command": "workbench.action.closeAllEditors"
}`,languageId:"json"})),vscpp(Rt,{name:"example"},"## No such command",vscpp("br",null),"Question: How do I move the terminal to a new window?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"There is no such command.",vscpp("br",null)),vscpp(Rt,{name:"example"},"## Invalid Question",vscpp("br",null),"Question: How do I bake a potato?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"Sorry this question isn't related to Visual Studio Code.",vscpp("br",null)))))),vscpp(Dx.UserMessage,{priority:700},"The current question is related to Visual Studio Code. ",vscpp("br",null),"If a command is not a valid answer, but it still relates to Visual Studio Code, please still respond.",vscpp("br",null),"Please do not guess a response and instead just respond with a polite apology if you are unsure.",vscpp("br",null),"If you believe the given context given to you is incorrect or not relevant you may ignore it.",vscpp("br",null),"The user cannot see the context you are given, so you must not mention it. If you want to refer to it, you must include it in your reply.",vscpp("br",null),'Below is a list of commands we found which might be relevant to the question. For view related commands "Toggle" often means Show or Hide. You may use this context to help you formulate your response, but are not required to.',vscpp("br",null)),vscpp(KC,{priority:800,query:this.props.query}),vscpp(Dx.UserMessage,{priority:900},this.props.query))}};YC=E([v(1,it)],YC);var zQe="Run create a new terminal command",fN="runCommanndConfirmationInteractedWith",l9=new Ao(Hd.t("[Configure automatic command execution]({0})",W8("workbench.action.openSettings",["github.copilot.chat.runCommand.enabled"])));l9.isTrusted={enabledCommands:["workbench.action.openSettings"]};var B0=class{constructor(e,t,r,o,s,a){this.configurationService=e;this.endpointProvider=t;this.runCommandExecutionService=r;this.combinedEmbeddingIndex=o;this.vscodeExtensionContext=s;this.instantiationService=a;this.id=B0.ID;this.locations=[2];this.description=Hd.t("Run a command");this.intentDetectionInput={sampleQuestion:zQe,disabled:!0};this.commandInfo={allowsEmptyArgs:!1,defaultEnablement:ml}}static{this.ID="runCommand"}async invoke(e){let t=this.configurationService,r=e.location,s=await this.endpointProvider.getChatEndpoint(e.request);return{intent:this,location:r,endpoint:s,processResponse:async(a,c,l,u)=>{let d=this.runCommandExecutionService,p=this.configurationService,f="";l.progress(Hd.t("Searching command index..."));for await(let{delta:g}of c){if(u.isCancellationRequested)return;f+=g.text}let m=WQe(this.combinedEmbeddingIndex,f)[0];if(!m){l.markdown(f),l.warning(Hd.t("Could not find a command for your request."));return}if(p.getConfig(le.RunCommandEnabled)===!1){l.markdown(`Automatic command execution is currently disabled.
`),l.markdown(l9),l.button(m);return}if(!$Qe.has(m.command)){l.warning(Hd.t("Automatically executing the command: {0} is prohibited due to security risks or potential destructive action.",m.title)),l.button(m);return}this.vscodeExtensionContext.globalState.get(fN,!1)?(await d.executeCommand(m.command,m.arguments),l.markdown(Hd.t("Ran: {0}",`\`${m.title}\``))):l.confirmation(Hd.t("Enable automatic command execution and run [{0}](command:{1})",m.title,m.command),"",{command:m})},confirmationHandler:async(a,c,l)=>{if(a){let[u]=a;u&&(this.vscodeExtensionContext.globalState.update(fN,!0),l.markdown(l9),l.progress(Hd.t("Enabled automatic command execution")),this.runCommandExecutionService.executeCommand(u.command.command,u.command.arguments),l.markdown(Hd.t("Ran: `{0}`",`\`${u.command.title}\``)))}if(c){let[u]=c;this.vscodeExtensionContext.globalState.update(fN,!0),l.markdown(l9),await t.setConfig(le.RunCommandEnabled,!1),l.warning(Hd.t("Disabled automatic command execution")),l.button(u.command)}},buildPrompt:async({query:a,history:c},l,u)=>await Fe.create(this.instantiationService,s,YC,{query:a,history:c}).render(l,u)}}};B0=E([v(0,be),v(1,_e),v(2,jd),v(3,Pd),v(4,qt),v(5,H)],B0);var $Qe=new Set(["cursorUndo","cursorRedo","editor.action.forceRetokenize","editor.action.toggleWordWrap","editor.action.moveCarretLeftAction","editor.action.moveCarretRightAction","editor.action.fontZoomIn","editor.action.fontZoomOut","editor.action.fontZoomReset","editor.action.smartSelect.expand","editor.action.smartSelect.shrink","editor.emmet.action.expandAbbreviation","editor.action.setSelectionAnchor","editor.action.inspectTMScopes","editor.action.commentLine","editor.action.addCommentLine","editor.action.removeCommentLine","editor.action.blockComment","editor.action.transposeLetters","editor.action.indentationToSpaces","editor.action.indentationToTabs","editor.action.indentUsingTabs","editor.action.indentUsingSpaces","editor.action.changeTabDisplaySize","editor.action.detectIndentation","editor.action.reindentlines","editor.action.reindentselectedlines","deleteInsideWord","editor.action.copyLinesUpAction","editor.action.copyLinesDownAction","editor.action.duplicateSelection","editor.action.moveLinesUpAction","editor.action.moveLinesDownAction","editor.action.sortLinesAscending","editor.action.sortLinesDescending","editor.action.removeDuplicateLines","editor.action.trimTrailingWhitespace","editor.action.deleteLines","editor.action.indentLines","editor.action.outdentLines","editor.action.insertLineBefore","editor.action.insertLineAfter","deleteAllLeft","deleteAllRight","editor.action.joinLines","editor.action.transpose","editor.action.transformToUppercase","editor.action.transformToLowercase","editor.action.transformToSnakecase","editor.action.transformToCamelcase","editor.action.transformToPascalcase","editor.action.transformToTitlecase","editor.action.transformToKebabcase","expandLineSelection","editor.action.formatDocument","editor.action.formatSelection","editor.action.showContextMenu","editor.action.inlineEdit.trigger","editor.debug.action.conditionalBreakpoint","editor.debug.action.addLogPoint","editor.debug.action.triggerByBreakpoint","editor.debug.action.editBreakpoint","editor.debug.action.goToNextBreakpoint","editor.debug.action.goToPreviousBreakpoint","editor.action.selectToBracket","editor.action.jumpToBracket","editor.action.removeBrackets","editor.action.clipboardCopyWithSyntaxHighlightingAction","editor.action.pasteAs","editor.action.pasteAsText","editor.action.inPlaceReplace.up","editor.action.inPlaceReplace.down","editor.action.openLink","editor.action.unicodeHighlight.disableHighlightingOfAmbiguousCharacters","editor.action.unicodeHighlight.disableHighlightingOfInvisibleCharacters","editor.action.unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters","editor.action.unicodeHighlight.showExcludeOptions","editor.action.quickFix","editor.action.refactor","editor.action.sourceAction","codelens.showLensesInCurrentLine","editor.unfold","editor.unfoldRecursively","editor.fold","editor.foldRecursively","editor.foldAll","editor.unfoldAll","editor.foldAllBlockComments","editor.foldAllMarkerRegions","editor.unfoldAllMarkerRegions","editor.foldAllExcept","editor.unfoldAllExcept","editor.toggleFold","editor.gotoParentFold","editor.gotoPreviousFold","editor.gotoNextFold","editor.createFoldingRangeFromSelection","editor.removeManualFoldingRanges","editor.foldLevel1","editor.foldLevel2","editor.foldLevel3","editor.foldLevel4","editor.foldLevel5","editor.foldLevel6","editor.foldLevel7","editor.action.wordHighlight.trigger","actions.find","editor.action.startFindReplaceAction","editor.actions.findWithArgs","actions.findWithSelection","editor.action.nextMatchFindAction","editor.action.previousMatchFindAction","editor.action.nextSelectionMatchFindAction","editor.action.previousSelectionMatchFindAction","editor.action.insertCursorAbove","editor.action.insertCursorBelow","editor.action.insertCursorAtEndOfEachLineSelected","editor.action.addSelectionToNextFindMatch","editor.action.addSelectionToPreviousFindMatch","editor.action.moveSelectionToNextFindMatch","editor.action.moveSelectionToPreviousFindMatch","editor.action.selectHighlights","editor.action.addCursorsToBottom","editor.action.addCursorsToTop","editor.action.focusNextCursor","editor.action.focusPreviousCursor","editor.action.marker.next","editor.action.marker.prev","editor.action.marker.nextInFiles","editor.action.marker.prevInFiles","editor.action.triggerSuggest","editor.action.resetSuggestSize","editor.action.dirtydiff.previous","editor.action.dirtydiff.next","workbench.action.editor.previousChange","workbench.action.editor.nextChange","editor.action.formatChanges","editor.action.showHover","editor.action.showDefinitionPreviewHover","editor.action.inlineSuggest.trigger","editor.debug.action.selectionToWatch","workbench.action.debug.nextConsole","workbench.debug.action.focusRepl","workbench.action.debug.prevConsole","editor.debug.action.toggleInlineBreakpoint","workbench.action.debug.restart","editor.debug.action.runToCursor","workbench.action.debug.selectDebugConsole","workbench.action.showAboutDialog","workbench.action.editor.changeEOL","workbench.action.editor.changeEncoding","workbench.action.clearEditorHistory","notebook.clearNotebookEdtitorTypeCache","notebook.clearNotebookKernelsMRUCache","workbench.action.clearRecentFiles","workbench.action.closeAllGroups","workbench.action.closeAllEditors","workbench.action.closeEditorsInGroup","workbench.action.closeActiveEditor","workbench.action.closeEditorInAllGroups","workbench.action.closeEditorsInOtherGroups","workbench.action.closeEditorsToTheLeft","workbench.action.closeOtherEditors","workbench.action.closeActivePinnedEditor","workbench.action.closeSidebar","workbench.action.closeUnmodifiedEditors","workbench.files.action.compareWithClipboard","workbench.files.action.compareWithSaved","workbench.files.action.compareNewUntitledTextFiles","workbench.action.tasks.configureDefaultBuildTask","workbench.action.tasks.configureTaskRunner","testing.configureProfile","workbench.action.pauseSocketWriting","workbench.action.triggerReconnect","workbench.action.copyEditorGroupToNewWindow","copyFilePath","copyRelativeFilePath","workbench.action.customizeLayout","workbench.notebook.layout.configure","workbench.action.duplicateActiveEditorGroupDown","workbench.action.duplicateActiveEditorGroupLeft","workbench.action.duplicateActiveEditorGroupRight","workbench.action.duplicateActiveEditorGroupUp","workbench.action.focusActiveEditorGroup","workbench.action.focusAboveGroup","workbench.action.focusBelowGroup","workbench.action.focusFirstEditorGroup","workbench.action.focusPanel","workbench.action.focusSideBar","workbench.action.focusAuxiliaryBar","workbench.action.focusLastEditorGroup","workbench.action.focusLeftGroup","workbench.action.focusNextGroup","workbench.action.focusNextPart","workbench.files.action.focusFilesExplorer","workbench.action.focusPreviousGroup","workbench.action.focusPreviousPart","workbench.action.focusRightGroup","workbench.action.focusStatusBar","workbench.action.navigateBackInEditLocations","workbench.action.navigateBackInNavigationLocations","workbench.action.navigateForwardInEditLocations","workbench.action.navigateForwardInNavigationLocations","workbench.action.navigateLast","workbench.action.navigatePreviousInEditLocations","workbench.action.navigatePreviousInNavigationLocations","workbench.action.quickOpen","workbench.action.navigateToLastEditLocation","workbench.action.navigateToLastNavigationLocation","workbench.action.gotoLine","workbench.action.compareEditor.nextChange","testing.goToNextMessage","workbench.action.compareEditor.previousChange","testing.goToPreviousMessage","workbench.action.gotoSymbol","workbench.action.showAllSymbols","workbench.action.editorLayoutTwoByTwoGrid","workbench.action.closePanel","workbench.action.inspectContextKeys","workbench.action.inspectKeyMappings","workbench.action.inspectKeyMappingsJSON","notebook.inspectLayout","workbench.action.joinAllGroups","workbench.action.joinTwoGroups","workbench.action.keepEditor","merge.dev.loadContentsFromFolder","workbench.action.logStorage","workbench.action.logWorkingCopies","workbench.action.moveActiveEditorGroupDown","workbench.action.moveEditorGroupToNewWindow","workbench.action.moveActiveEditorGroupLeft","workbench.action.moveActiveEditorGroupRight","workbench.action.moveActiveEditorGroupUp","workbench.action.moveEditorToFirstGroup","workbench.action.moveEditorToAboveGroup","workbench.action.moveEditorToBelowGroup","workbench.action.moveEditorToLastGroup","workbench.action.moveEditorToLeftGroup","workbench.action.moveEditorToNextGroup","workbench.action.moveEditorToPreviousGroup","workbench.action.moveEditorToRightGroup","workbench.action.moveEditorLeftInGroup","workbench.action.moveEditorRightInGroup","workbench.action.positionPanelLeft","workbench.action.positionPanelRight","workbench.action.positionPanelBottom","workbench.action.movePanelToSecondarySideBar","workbench.action.moveSecondarySideBarToPanel","workbench.action.moveView","workbench.action.navigateEditorGroups","workbench.action.quickOpenNavigateNext","workbench.action.quickOpenNavigatePrevious","workbench.action.navigateUp","workbench.action.navigateDown","workbench.action.navigateLeft","workbench.action.navigateRight","workbench.action.newGroupAbove","workbench.action.newGroupBelow","workbench.action.newGroupLeft","workbench.action.newGroupRight","workbench.action.newEmptyEditorWindow","welcome.showNewFileEntries","explorer.newFile","explorer.newFolder","workbench.action.files.newUntitledFile","workbench.action.newWindow","workbench.action.nextPanelView","workbench.action.openExtensionLogsFolder","workbench.action.files.openFile","workbench.action.firstEditorInGroup","workbench.action.lastEditorInGroup","workbench.action.openLogsFolder","merge.dev.openContentsJson","workbench.action.nextEditor","workbench.action.nextEditorInGroup","workbench.action.openNextRecentlyUsedEditor","workbench.action.openNextRecentlyUsedEditorInGroup","workbench.action.previousEditor","workbench.action.previousEditorInGroup","workbench.action.openPreviousRecentlyUsedEditor","workbench.action.openPreviousRecentlyUsedEditorInGroup","workbench.action.openProcessExplorer","workbench.action.openRecent","merge.dev.openSelectionInTemporaryMergeEditor","workbench.action.pinEditor","workbench.action.previousPanelView","workbench.action.quickOpenLeastRecentlyUsedEditor","workbench.action.openPreviousEditorFromHistory","workbench.action.quickOpenPreviousRecentlyUsedEditor","workbench.action.webview.reloadWebviewAction","workbench.action.reloadWindow","workbench.action.removeLargeStorageDatabaseEntries","workbench.action.reopenClosedEditor","workbench.action.reopenWithEditor","menu.resetHiddenStates","mergeEditor.resetCloseWithConflictsChoice","files.participants.resetChoice","workbench.action.evenEditorWidths","workbench.action.resetViewLocations","workbench.files.action.showActiveFileInExplorer","revealFileInOS","workbench.action.revertAndCloseActiveEditor","workbench.action.files.revert","workbench.action.files.save","workbench.action.files.saveAll","workbench.action.files.saveFiles","workbench.files.action.saveAllInGroup","workbench.action.files.saveAs","workbench.action.files.saveWithoutFormatting","workbench.action.quickOpenSelectNext","workbench.action.quickOpenSelectPrevious","workbench.action.setLogLevel","workbench.action.alignPanelCenter","workbench.action.alignPanelJustify","workbench.action.alignPanelLeft","workbench.action.alignPanelRight","workbench.action.showAllEditors","workbench.action.showAllEditorsByMostRecentlyUsed","workbench.action.showEditorsInActiveGroup","workbench.action.tasks.showTasks","workbench.action.tasks.showLog","_workbench.output.showViewsLog","workbench.action.editorLayoutSingle","workbench.action.splitEditor","workbench.action.splitEditorDown","workbench.action.splitEditorToFirstGroup","workbench.action.splitEditorToAboveGroup","workbench.action.splitEditorToBelowGroup","workbench.action.splitEditorToLastGroup","workbench.action.splitEditorToLeftGroup","workbench.action.splitEditorToNextGroup","workbench.action.splitEditorToPreviousGroup","workbench.action.splitEditorToRightGroup","workbench.action.splitEditorLeft","workbench.action.splitEditorOrthogonal","workbench.action.splitEditorRight","workbench.action.splitEditorUp","editor.action.startDebugTextMate","workbench.action.stopTracing","workbench.action.tasks.terminate","workbench.action.editorLayoutThreeColumns","workbench.action.editorLayoutThreeRows","workbench.action.toggleAutoSave","editor.action.toggleRenderControlCharacter","workbench.action.toggleEditorGroupLock","workbench.action.toggleEditorWidths","workbench.action.toggleKeybindingsLog","notebook.toggleLayoutTroubleshoot","editor.action.toggleMinimap","workbench.action.toggleMultiCursorModifier","notebook.action.toggleNotebookStickyScroll","workbench.action.toggleSidebarPosition","workbench.action.toggleSidebarVisibility","editor.action.toggleRenderWhitespace","editor.action.toggleScreenReaderAccessibilityMode","workbench.action.toggleScreencastMode","workbench.action.toggleAuxiliaryBar","workbench.action.toggleStatusbarVisibility","editor.action.toggleTabFocusMode","testing.toggleTestingPeekHistory","workbench.action.toggleEditorGroupLayout","redo","editor.action.selectAll","undo","debug.addConfiguration","workbench.debug.viewlet.action.addDataBreakpointOnAddress","workbench.debug.viewlet.action.addFunctionBreakpointAction","workbench.action.browseColorThemesInMarketplace","workbench.action.closeWindow","workbench.action.selectTheme","workbench.action.tasks.configureDefaultTestTask","workbench.action.configureRuntimeArguments","remote.tunnel.copyAddressCommandPalette","workbench.action.selectIconTheme","workbench.action.focusActivityBar","workbench.action.focusBanner","workbench.action.generateColorTheme","workbench.action.activityBarLocation.hide","editor.action.measureExtHostLatency","workbench.action.activityBarLocation.bottom","workbench.action.activityBarLocation.top","workbench.action.nextSideBarView","workbench.action.tasks.openUserTasks","welcome.showAllWalkthroughs","workbench.action.previousSideBarView","workbench.action.selectProductIconTheme","workbench.action.reloadWindowWithExtensionsDisabled","workbench.debug.viewlet.action.removeAllBreakpoints","editor.inlayHints.Reset","resetGettingStartedProgress","workbench.action.zoomReset","workbench.action.restartExtensionHost","remote.tunnel.closeCommandPalette","workbench.action.switchWindow","workbench.debug.viewlet.action.toggleBreakpointsActivatedAction","workbench.action.toggleLightDarkThemes","breadcrumbs.toggle","editor.action.toggleColumnSelection","workbench.action.toggleDevTools","debug.action.toggleDisassemblyViewSourceCode","tree.toggleStickyScroll","workbench.action.uninstallCommandLine","workbench.action.openWalkthrough","workbench.action.zoomIn","editor.action.clipboardCopyAction","editor.action.clipboardCutAction","editor.action.clipboardPasteAction","notification.acceptPrimaryAction","_workbench.extensions.action.cleanUpExtensionsFolder","notifications.clearAll","workbench.action.clearCommandHistory","workbench.action.configureLanguageBasedSettings","workbench.extensions.action.configureWorkspaceFolderRecommendedExtensions","workbench.extensions.action.disableAll","workbench.extensions.action.disableAllWorkspace","notifications.focusToasts","workbench.debug.action.focusBreakpointsView","workbench.debug.action.focusCallStackView","workbench.panel.repl.view.focus","workbench.views.extensions.disabled.focus","workbench.views.extensions.enabled.focus","workbench.extensions.action.focusExtensionsView","workbench.explorer.fileView.focus","workbench.views.extensions.installed.focus","workbench.files.action.focusOpenEditorsView","outline.focus","workbench.panel.output.focus","workbench.panel.markers.view.focus","workbench.view.search.focus","workbench.scm.repositories.focus","workbench.scm.focus","terminal.focus","timeline.focus","workbench.debug.action.focusVariablesView","workbench.debug.action.focusWatchView","workbench.action.focusTitleBar","workbench.action.openAccessibilitySettings","workbench.action.openDefaultKeybindingsFile","workbench.action.openRawDefaultSettings","workbench.extensions.action.openExtensionsFolder","workbench.action.openGlobalKeybindings","workbench.action.openGlobalKeybindingsFile","workbench.action.openQuickChat","search.action.openInEditor","workbench.action.openSettings2","workbench.action.openGlobalSettings","workbench.action.openSettingsJson","workbench.action.openView","workbench.action.openWorkspaceSettings","workbench.action.openWorkspaceSettingsFile","workbench.profiles.actions.help","workbench.action.quickTextSearch","workbench.extensions.action.refreshExtension","editor.emmet.action.removeTag","workbench.action.openIssueReporter","workbench.action.reportPerformanceIssueUsingReporter","workbench.action.showCommands","workbench.extensions.action.listBuiltInExtensions","workbench.extensions.action.showDisabledExtensions","workbench.extensions.action.showEnabledExtensions","workbench.extensions.action.listWorkspaceUnsupportedExtensions","notifications.showList","workbench.profiles.actions.showProfileContents","workbench.action.remote.showMenu","workbench.action.showWindowLog","notifications.toggleDoNotDisturbMode","notifications.toggleDoNotDisturbModeBySource","editor.action.toggleStickyScroll","editor.action.accessibilityHelp","editor.action.accessibleView","extension.js-debug.addXHRBreakpoints","editor.emmet.action.balanceIn","editor.emmet.action.balanceOut","workbench.debug.panel.action.clearReplAction","workbench.action.clearLocalePreference","workbench.output.action.clearOutput","json.clearCache","search.action.clearHistory","workbench.files.action.collapseExplorerFolders","workbench.action.configureLocale","workbench.action.openSnippets","editor.emmet.action.decrementNumberByOneTenth","editor.emmet.action.decrementNumberByOne","editor.emmet.action.decrementNumberByTen","workbench.action.localHistory.deleteAll","extension.js-debug.disableSourceMapStepping","extension.js-debug.editXHRBreakpoints","editor.emmet.action.evaluateMathExpression","workbench.action.populateFileFromSnippet","references-view.findImplementations","workbench.action.localHistory.restoreViaPicker","workbench.action.findInFiles","search.action.focusSearchList","npm.focus","workbench.panel.chat.view.copilot.focus","~remote.forwardedPorts.focus","workbench.action.problems.focus","editor.emmet.action.matchTag","editor.emmet.action.nextEditPoint","editor.emmet.action.prevEditPoint","accessibility.announcement.help","signals.sounds.help","editor.emmet.action.incrementNumberByOneTenth","editor.emmet.action.incrementNumberByOne","editor.emmet.action.incrementNumberByTen","workbench.action.showInteractivePlayground","extension.js-debug.createDebuggerTerminal","vscode-testresolver.killServerAndTriggerHandledError","editor.emmet.action.mergeLines","ipynb.newUntitledIpynb","search.action.openNewEditor","vscode-testresolver.newWindow","git.openAllChanges","git.openChange","extension.js-debug.debugLink","workbench.action.openLogFile","search.action.openNewEditorToSide","search.action.openEditor","workbench.action.webview.openDeveloperTools","perf.event.profiling","perf.insta.printAsyncCycles","perf.insta.printTraces","github.publish","editor.emmet.action.reflectCSSValue","workbench.files.action.refreshFilesExplorer","extension.js-debug.removeAllCustomBreakpoints","extension.js-debug.callers.removeAll","extension.js-debug.callers.remove","extension.js-debug.removeXHRBreakpoint","workbench.action.replaceInFiles","editor.emmet.action.selectNextItem","editor.emmet.action.selectPrevItem","simpleBrowser.show","references-view.showCallHierarchy","workbench.action.showEmmetCommands","git.showOutput","references-view.showIncomingCalls","workbench.action.showLogs","editor.action.showOrFocusStandaloneColorPicker","references-view.showOutgoingCalls","workbench.action.showOutputChannels","workbench.action.showRuntimeExtensions","references-view.showSubtypes","references-view.showSupertypes","vscode-testresolver.showLog","references-view.showTypeHierarchy","vscode-testresolver.toggleConnectionSlowdown","json.sort","editor.emmet.action.splitJoinTag","git.diff.stageHunk","git.diff.stageSelection","extension.node-debug.startWithStopOnEntry","perfview.show","extension.node-debug.toggleAutoAttach","editor.emmet.action.toggleComment","extension.js-debug.addCustomBreakpoints","workbench.action.toggleLockedScrolling","workbench.action.toggleNotebookClipboardLog","workbench.action.togglePanel","extension.js-debug.toggleSkippingFile","workbench.action.editorLayoutTwoColumnsBottom","workbench.action.editorLayoutTwoColumns","workbench.action.editorLayoutTwoRows","workbench.action.editorLayoutTwoRowsRight","workbench.action.unpinEditor","editor.emmet.action.updateImageSize","editor.emmet.action.updateTag","workbench.action.openLicenseUrl","editor.emmet.action.wrapWithAbbreviation","workbench.action.zoomOut","inlineChat.copyRecordings","workbench.action.terminal.accessibleBufferGoToNextCommand","workbench.action.addRootFolder","search.action.cancel","workbench.action.terminal.changeColor","workbench.action.terminal.changeIcon","workbench.action.editor.changeLanguageMode","workbench.profiles.actions.cleanupProfiles","workbench.action.terminal.clear","workbench.action.chat.clearHistory","workbench.action.chat.clearInputHistory","workbench.action.terminal.clearPreviousSessionHistory","workbench.action.terminal.clearSelection","workbench.action.closeFolder","workbench.files.action.compareFileWith","workbench.action.terminal.openSettings","workbench.action.copyEditorToNewWindow","workbench.action.terminal.copyLastCommand","workbench.action.terminal.copyLastCommandAndLastCommandOutput","workbench.action.terminal.copyLastCommandOutput","workbench.profiles.actions.createTemporaryProfile","workbench.action.localHistory.create","workbench.action.terminal.new","workbench.action.terminal.newInActiveWorkspace","workbench.action.createTerminalEditor","workbench.action.createTerminalEditorSide","workbench.action.terminal.newWithCwd","workbench.action.decreaseViewSize","workbench.action.decreaseViewHeight","workbench.action.decreaseViewWidth","workbench.action.terminal.fontZoomOut","workbench.action.terminal.detachSession","workbench.debug.viewlet.action.disableAllBreakpoints","workbench.action.duplicateWorkspaceInNewWindow","workbench.debug.viewlet.action.enableAllBreakpoints","workbench.action.minimizeOtherEditorsHideSidebar","workbench.action.chat.export","workbench.action.terminal.findNext","workbench.action.terminal.findPrevious","breadcrumbs.focusAndSelect","breadcrumbs.focus","workbench.action.terminal.focusFind","workbench.action.terminal.focusHover","workbench.action.terminal.focusNext","workbench.action.terminal.focusNextPane","workbench.action.terminal.focusPrevious","workbench.action.terminal.focusPreviousPane","workbench.action.terminal.focus","workbench.action.terminal.focusTabs","workbench.action.terminal.goToRecentDirectory","hideCustomTitleBar","workbench.action.hideEditorActions","workbench.action.hideEditorTabs","workbench.action.terminal.hideFind","workbench.action.chat.import","workbench.action.increaseViewSize","workbench.action.increaseViewHeight","workbench.action.increaseViewWidth","workbench.action.terminal.fontZoomIn","workbench.action.chat.inlineVoiceChat","workbench.action.chat.insertCodeBlock","workbench.action.chat.insertIntoNewFile","editor.action.insertSnippet","workbench.action.terminal.join","workbench.action.terminal.killAll","workbench.action.terminal.killEditor","workbench.action.terminal.kill","workbench.action.lockEditorGroup","workbench.action.maximizeEditorHideSidebar","workbench.action.editorActionsTitleBar","workbench.action.moveEditorToNewWindow","workbench.action.terminal.moveToEditor","workbench.action.terminal.moveIntoNewWindow","workbench.action.chat.newChat","workbench.action.chat.nextCodeBlock","workbench.action.chat.nextFileTree","workbench.action.debug.configure","workbench.action.files.showOpenedFileInNewWindow","workbench.action.chat.openInEditor","workbench.action.chat.openInNewWindow","workbench.action.chat.openInSidebar","workbench.action.terminal.openDetectedLink","workbench.action.openChat","workbench.action.files.openFolder","workbench.action.terminal.openFileLink","workbench.action.terminal.openUrlLink","workbench.action.openWorkspace","workbench.action.files.openFileFolder","workbench.action.chat.previousCodeBlock","workbench.action.chat.previousFileTree","workbench.action.quickOpenLeastRecentlyUsedEditorInGroup","workbench.action.quickOpenPreviousRecentlyUsedEditorInGroup","workbench.action.chat.quickVoiceChat","workbench.action.terminal.recordSession","workbench.action.terminal.relaunch","workbench.action.removeRootFolder","workbench.action.terminal.renameWithArg","workbench.profiles.actions.renameProfile","workbench.action.terminal.rename","workbench.action.reopenTextEditor","workbench.action.files.resetActiveEditorReadonlyInSession","workbench.action.terminal.fontZoomReset","workbench.profiles.actions.resetWorkspaces","workbench.action.terminal.resizePaneDown","workbench.action.terminal.resizePaneLeft","workbench.action.terminal.resizePaneRight","workbench.action.terminal.resizePaneUp","workbench.action.terminal.restartPtyHost","workbench.action.saveWorkspaceAs","workbench.action.terminal.scrollDown","workbench.action.terminal.scrollDownPage","workbench.action.terminal.scrollToBottom","workbench.action.terminal.scrollToNextCommand","workbench.action.terminal.scrollToPreviousCommand","workbench.action.terminal.scrollToTop","workbench.action.terminal.scrollUp","workbench.action.terminal.scrollUpPage","workbench.action.terminal.selectAll","workbench.action.terminal.selectDefaultShell","workbench.action.terminal.selectToNextCommand","workbench.action.terminal.selectToNextLine","workbench.action.terminal.selectToPreviousCommand","workbench.action.terminal.selectToPreviousLine","workbench.action.toggleSeparatePinnedEditorTabs","workbench.action.files.setActiveEditorReadonlyInSession","workbench.action.files.setActiveEditorWriteableInSession","workbench.action.terminal.setDimensions","workbench.action.chat.history","workbench.action.terminal.showEnvironmentContributions","workbench.action.showEditorTab","workbench.action.terminal.showTextureAtlas","workbench.action.splitEditorInGroup","workbench.action.terminal.split","workbench.action.terminal.splitInActiveWorkspace","workbench.action.editorDictation.start","extension.bisect.start","inlineChat.start","workbench.action.terminal.chat.start","workbench.action.startTrackDisposables","workbench.action.chat.startVoiceChat","workbench.action.quickOpenTerm","workbench.action.terminal.switchTerminal","workbench.action.files.toggleActiveEditorReadonlyInSession","workbench.action.toggleCenteredLayout","workbench.action.toggleEditorVisibility","workbench.action.toggleEditorType","workbench.action.toggleFullScreen","workbench.action.toggleMaximizedPanel","workbench.action.terminal.sizeToContentWidth","workbench.action.toggleSplitEditorInGroup","workbench.action.terminal.toggleStickyScroll","workbench.action.toggleZenMode","workbench.action.troubleshootIssue.start","workbench.action.terminal.unsplit","workbench.action.terminal.searchWorkspace","workbench.action.terminal.toggleFindCaseSensitive","workbench.action.terminal.toggleFindRegex","workbench.action.terminal.toggleFindWholeWord","workbench.action.chat.voiceChatInChatView","workbench.action.terminal.writeDataToTerminal","merge-conflict.accept.all-both","merge-conflict.accept.all-current","merge-conflict.accept.all-incoming","merge-conflict.accept.both","merge-conflict.accept.current","merge-conflict.accept.incoming","merge-conflict.accept.selection","git.addRemote","git.stashApplyLatest","git.stashApply","git.checkoutDetached","git.checkout","git.cherryPick","git.clone","git.cloneRecursive","git.closeAllDiffEditors","git.closeAllUnmodifiedEditors","git.closeOtherRepositories","git.close","git.commit","git.commitAmend","git.commitSigned","git.commitAll","git.commitAllAmend","git.commitAllSigned","git.commitEmpty","git.commitStaged","git.commitStagedAmend","git.commitStagedSigned","merge-conflict.compare","jupyter.continueEditSessionInCodespace","issue.copyGithubHeadLink","issue.copyGithubPermalink","issue.copyMarkdownGithubPermalink","git.branchFrom","git.branch","jupyter.createnewinteractive","workbench.action.terminal.newWithProfile","workbench.profiles.actions.createProfile","git.createTag","git.deleteBranch","workbench.profiles.actions.deleteProfile","git.deleteRemoteTag","git.deleteTag","git.cleanAll","git.cleanAllTracked","git.cleanAllUntracked","git.clean","git.stashDropAll","git.stashDrop","workbench.profiles.actions.exportProfile","git.fetch","git.fetchPrune","git.fetchAll","jupyter.filterKernels","github.copilot.chat.fix","github.copilot.chat.generateDocs","github.copilot.chat.generateTests","github.copilot.chat.generate","git.init","git.merge","merge-conflict.next","git.openRepository","git.stashPopLatest","git.stashPop","merge-conflict.previous","git.publish","git.pull","git.pullRebase","git.pullFrom","git.push","git.pushWithTags","git.pushTags","git.pushTo","git.rebase","git.refresh","git.removeRemote","git.renameBranch","jupyter.resetLoggingLevel","workbench.profiles.actions.createFromCurrentProfile","jupyter.selectJupyterInterpreter","github.copilot.interactiveSession.feedback","workbench.panel.chatSidebar","workbench.view.explorer","workbench.view.extensions","workbench.view.extension.github-pull-requests","workbench.view.debug","workbench.view.search","workbench.view.scm","git.stageAll","git.stageAllMerge","git.stageAllTracked","git.stageAllUntracked","git.stage","git.stash","git.stashIncludeUntracked","git.stashStaged","workbench.profiles.actions.switchProfile","git.sync","git.syncRebase","workbench.panel.comments","workbench.debug.action.toggleRepl","workbench.action.output.toggleOutput","~remote.forwardedPortsContainer","workbench.actions.view.problems","workbench.action.terminal.toggleTerminal","workbench.editSessions.actions.signIn","git.undoCommit","git.unstageAll","git.unstage","git.viewChanges","git.viewStagedChanges","git.stashView"]);function WQe(n,e){let t=Is(e);for(let r of t){if(r.language!=="json"&&r.language!=="")return[];let o;try{o=gf(r.code)}catch{}if(!o||!o.hasOwnProperty("command"))return[];let s=n.getCommand(o.command);if(s)return[{command:s.key,title:s.label,arguments:o.args}]}return[]}function H_e(n,e){let t=new _t,r=n.extensionMode;return typeof r=="number"&&r!==Nx.ExtensionMode.Test&&t.add(new IJ(n,e)),t}var IJ=class extends _t{constructor(e,t){super(),this.add(Nx.workspace.onDidChangeConfiguration(r=>{if(r.affectsConfiguration("github.copilot.chat.runCommand.enabled")){let o=t.getConfig(le.RunCommandEnabled);Nx.commands.executeCommand("setContext","github.copilot.chat.runCommand.enabled",o),o&&e.globalState.update(fN,!1)}})),Nx.commands.executeCommand("setContext","github.copilot.chat.runCommand.enabled",t.getConfig(le.RunCommandEnabled))}};var PJ={};Dr(PJ,{create:()=>XQe});var V_e=q(ht());var mN=class{constructor(e){this.instantiationService=e;this.kind="workspace";this.variableInfo={name:"codebase",fullName:"Codebase",icon:"folder",description:V_e.t("Searches through the codebase and pulls out relevant information for the query."),defaultEnablement:!0}}async resolveContext(e,t,r){if(!e.message)return;let{messages:o,references:s}=await Qi(this.instantiationService,e.endpoint,tC,{promptContext:{chatVariables:new Es([]),query:this.turnQueryIntoWorkspaceQuery(e.message),history:e.history??[]},include:{workspaceChunks:!0}},r,t);if(o.length>0)return{kind:this.kind,userMessages:o.map(a=>a.content),references:s}}turnQueryIntoWorkspaceQuery(e){let t=e;return t.startsWith("@")&&(t=t.replace(/@\w+\s*/,"")),t=t.replaceAll(/\#files/gi,"files"),t}};mN=E([v(0,H)],mN);zr.register(new fe(mN));var TJ=q(ht()),G_e=q(require("path"));var hN=class{constructor(e,t){this._tabsAndEditorsService=e;this._ignoreService=t;this.kind="current-editor";this.variableInfo={name:"editor",description:TJ.t("The visible source code in the active editor"),fullName:TJ.t("Current Editor"),icon:"file-code",defaultEnablement:!0,registerTool:!0}}async resolveContext(e){let t=this._tabsAndEditorsService.activeTextEditor;if(t?.document.uri&&await this._ignoreService.isCopilotIgnored(t?.document.uri))return;let r=t?.visibleRanges[0];if(r){let o="";t.selection.isSingleLine&&(o=`The cursor is on line: ${t.selection.start.line}`);let s=[`Excerpt from active file ${G_e.basename(t.document.uri.path)}, lines ${r.start.line+1} to ${r.end.line+1}:`,mo(t.document.languageId,t.document.getText(r),!1),"",o].join(`
`);return{kind:this.kind,userMessages:[s],references:[new Xo.PromptReference({uri:t.document.uri,range:r})]}}}};hN=E([v(0,$t),v(1,Te)],hN);zr.register(new fe(hN));var gN=class{constructor(e){this._instantiationService=e;this.kind="current-selection-implementations"}async resolveContext(e,t,r){let{references:o,messages:s}=await Qi(this._instantiationService,e.endpoint,au,{});return{kind:this.kind,references:o,userMessages:s.map(a=>a.content)}}};gN=E([v(0,H)],gN);zr.register(new fe(gN));var z_e=q(ht());var QC=re("IDebugOutputService");var vN=class{constructor(e){this._debugOutputService=e;this.kind="debug-console-output";this.variableInfo={name:"debugConsole",description:z_e.t("The output in the debug console"),defaultEnablement:!1}}async resolveContext(){return{kind:this.kind,userMessages:[`Debug console output:
`+this._debugOutputService.consoleOutput]}}};vN=E([v(0,QC)],vN);zr.register(new fe(vN));var Lx=q(Ve());var u9=q(Ve());var q0=class extends u9.PromptElement{constructor(t,r,o,s,a,c,l,u){super(t);this.ignoreService=r;this.extensionContext=o;this.languageFeaturesService=s;this.workspaceService=a;this.logService=c;this.parserService=l;this.telemetryService=u}static{this.DEFAULT_TIMEOUT_MS=200}async render(t,r){if(await this.ignoreService.isCopilotIgnored(this.props.document.uri))return vscpp("ignoredFiles",{value:[this.props.document.uri]});let o=this.extensionContext.extensionMode===vl.Test?0:this.props.timeoutMs===void 0?q0.DEFAULT_TIMEOUT_MS:this.props.timeoutMs,[s,a]=await this.findReferences(o);return this.logService.public.debug(`Found ${s.length} implementation(s)/definition(s), ${a.length} usages`),s.length>0&&this.logService.public.debug("Implementation(s)/definition(s) found:"+JSON.stringify(s,null,"	")),a.length>0&&this.logService.public.debug("Usages found:"+JSON.stringify(a,null,"	")),vscpp(vscppf,null,this.renderCodeExcerpts(`Relevant definition${s.length>1?"s":""}:`,s),this.renderCodeExcerpts("Other usages:",a))}renderCodeExcerpts(t,r){if(r.length>0)return vscpp(vscppf,null,t,vscpp("br",null),vscpp("br",null),r.map(o=>{let c=`${`${Rr(o.languageId).lineComment.start} FILEPATH: ${o.uri.path}`}
${o.code}`;return vscpp(tt,{uri:o.uri,languageId:o.languageId,code:c,references:[new u9.PromptReference(new ar(o.uri,o.excerptRange))]})}),vscpp("br",null),vscpp("br",null))}async findReferences(t){let{document:r,position:o}=this.props,s=async()=>{try{let u=await this.languageFeaturesService.getReferences(r.uri,o);return this.logService.public.debug(`Found ${u.length} references: `+JSON.stringify(u,null,"	")),u}catch{return[]}},a=await Tc(this.logService,this.telemetryService,r,t*3,s,[]),c=[],l=[];for(let u of a){if(await this.ignoreService.isCopilotIgnored(u.uri))continue;let d=await this.workspaceService.openTextDocumentAndSnapshot(u.uri),p=this.parserService.getTreeSitterAST(d);if(!p)continue;let f=No(u.range,d),m=await p.getCallExpressions(f),h=await p.getFunctionDefinitions();if(m.length>0)l.push({languageId:d.languageId,uri:d.uri,code:m[0].text,excerptRange:Gs(d,m[0])});else if(h.some(g=>Fr.doIntersect(g,f))){let y=(await Jv(this.parserService,this.telemetryService,{document:d,language:Rr(r.languageId),wholeRange:u.range,selection:new Hp(u.range.start,u.range.end),fileIndentInfo:void 0})).range;c.push({languageId:d.languageId,uri:d.uri,code:d.getText(y),excerptRange:y})}}return[c,l]}};q0=E([v(1,Te),v(2,qt),v(3,Ts),v(4,Be),v(5,oe),v(6,ft),v(7,ge)],q0);var d9=re("IFixCookbookService");var XC=class{constructor(e){this.telemetryService=e}getCookbook(e,t){let r=typeof t.code=="object"?t.code.value:t.code,o=this._getManualSuggestedFixes(e,t.source,r);return{fixes:o,messageReplacement(){for(let s of o)if(s.replaceMessage!==void 0)return s.replaceMessage},additionalContext(){let s=[];for(let a of o)a.additionalContext!==void 0&&s.push(a.additionalContext);return s}}}_getManualSuggestedFixes(e,t,r){if(!t||r===void 0)return[];let o=KQe[t];if(!o)return[];let s=o[r];return s?(this.telemetryService.sendMSFTTelemetryEvent("cookbookAccessed",{languageId:e,diagnosticCode:r.toString(),provider:t}),(Array.isArray(s)?s:[s]).map(c=>typeof c=="string"?{title:c,message:""}:c)):[]}};XC=E([v(0,ge)],XC);var KQe={pylint:{C0301:["Split into many short lines to make sure each line is less than 20 tokens; split into many more lines than you normally would. Make sure to do the following: You must split all long strings, comments, and dictionary arguments and lists into shorter lines."]},Pylint:{"C0301:line-too-long":["Split into many short lines to make sure each line is less than 20 tokens; split into many more lines than you normally would. Make sure to do the following: You must split all long strings, comments, and dictionary arguments and lists into shorter lines."]},ts:{2345:{title:"Use this declaration and other usages as examples.",message:"",additionalContext:0},2554:{title:"Use this declaration and other usages as examples.",message:"",additionalContext:0}},eslint:{"class-methods-use-this":["Make the method static.","Move the method outside of the class.","Rewrite the method to use properties of the class."],"consistent-this":["Use the alias for this required by eslint consistent-this rule.","Use this directly instead of an alias."],"constructor-super":{title:"Add missing super call and pass through new arguments.",message:"The code is missing a super call in the constructor. Copy base class parameters to this constructor and pass them to super.",replaceMessage:"Missing super call in constructor"},"func-names":["Give the function expression the same name as the variable it is assigned to.","Convert the function to an arrow function."],"func-style":[{title:"Convert the function declaration to an expression.",message:"The function expression should be assigned to a variable with the name of the original function declaration."}],"max-lines-per-function":["Split into multiple functions."],"max-nested-callbacks":["Rewrite to avoid at least one callback."],"max-params":[{title:"Rewrite the signature to use an object parameter.",message:"Preserve all the parameters of the original signature."}],"max-statements":["Split into multiple functions."],"no-case-declarations":["Surround the case block with braces.","Move the declaration outside the case block."],"no-dupe-else-if":["Fix the duplicate condition to be different from the first.","Remove the duplicate condition"],"no-duplicate-case":[{title:"Change the duplicate condition to be different.",message:"Do not delete the duplicate case, just fix it",replaceMessage:"Duplicated condition."},"Remove the duplicate condition"],"no-duplicate-imports":"Merge the duplicated import lines.","no-fallthrough":[{title:"Rewrite to avoid fallthrough.",message:"Use the return value of the following cases and copy it to the preceding fallthrough case.",replaceMessage:"Fallthrough case in switch statement."},"Add a // fallthrough comment.","Add a break statement."],"no-inner-declarations":["Move the inner declaration to the top of its containing function.","Move the inner declaration to the bottom of its containing function.","Change the inner function declaration to an expression."],"no-multi-assign":"Assign each variable in separate statements.","no-negated-condition":"Invert the branches of the conditional.","no-new":["Convert the class to functions.","Assign the resulting object to a variable."],"no-sequences":[{title:"Wrap the whole comma sequence in parentheses.",message:"",replaceMessage:"Unnecessary comma sequence"},{title:"Rewrite, preserving the original behavior.",message:"The last element of the comma sequence is the one returned."},{title:"Delete the non-final elements of the sequence.",message:"They are unused unless it is for side effects."}],"no-sparse-arrays":["Remove duplicated commas.","Add default values for the missing elements."],"require-await":["Removed the unused async keyword.",{title:"Rewrite the function to use await.",message:"The code should change to call asynchronous functions where appropriate."}],"sort-keys":{title:"Sort the properties of the entire object literal.",message:"",replaceMessage:"Unsorted keys in object literal."}}};var YQe=200,$_e=300,bf=class extends Lx.PromptElement{constructor(t,r,o){super(t);this.ignoreService=r;this.fixCookbookService=o}async render(t,r){let{diagnostics:o,documentContext:s}=this.props;return await this.ignoreService.isCopilotIgnored(s.document.uri)?vscpp("ignoredFiles",{value:[s.document.uri]}):o.length>0&&vscpp(vscppf,null,o.map((c,l)=>{let u=this.fixCookbookService.getCookbook(s.language.languageId,c);return vscpp(vscppf,null,vscpp(CJ,{diagnostic:c,cookbook:u,maxLength:YQe,documentContext:s}),vscpp(yN,{diagnostic:c,cookbook:u,document:s.document}),vscpp(EJ,{cookbook:u}))}))}};bf=E([v(1,Te),v(2,d9)],bf);var CJ=class extends Lx.PromptElement{render(e,t){let r=this.props.diagnostic,o=this.props.documentContext.document,s=r.range,a=o.getText(new Me(s.start.line,0,s.end.line+1,0)).trimEnd(),c=a.length>0&&a.length<this.props.maxLength?a:"";return c?vscpp(vscppf,null,"This code",vscpp("br",null),vscpp(tt,{code:c,uri:o.uri,shouldTrim:!1}),vscpp("br",null),vscpp(vscppf,null,"has the problem reported:",vscpp("br",null),vscpp(Rt,{name:"compileError"},r.message))):vscpp(vscppf,null)}},yN=class extends Lx.PromptElement{constructor(t,r,o,s,a,c){super(t);this.workspaceService=r;this.parserService=o;this.ignoreService=s;this.logService=a;this.telemetryService=c}async render(t,r){let{infos:o,ignoredFiles:s,definitionRanges:a}=await this.getRelatedInfos();return!o.length&&!a.length?vscpp("ignoredFiles",{value:s}):vscpp(vscppf,null,"This diagnostic has some related code:",vscpp("br",null),o.map(c=>vscpp(tt,{code:c.content,uri:c.uri,references:[new Lx.PromptReference(new ar(c.uri,c.range))]})),a.map(c=>vscpp(q0,{document:this.props.document,position:c.start})),vscpp("ignoredFiles",{value:s}))}async getRelatedInfos(){let t=[],r=[],o=[],s=this.props.diagnostic;if(s.relatedInformation)for(let c of s.relatedInformation)try{let l=c.location;if(await this.ignoreService.isCopilotIgnored(l.uri)){o.push(l.uri);continue}let u=await this.workspaceService.openTextDocument(l.uri),d=l.range,p=this.parserService.getTreeSitterAST(u),f;if(p){let m=$5(d),h=await p.getCoarseParentScope(m);f=u.getText(W5(h))}(!f||f.length>$_e)&&(f=u.getText(d)),f.length<=$_e&&t.push({content:f,uri:l.uri,range:l.range})}catch{}let a=this.props.cookbook.additionalContext();for(let c of a)switch(c){case 0:{let l=this.parserService.getTreeSitterAST(this.props.document);if(l){let u=No(this.props.diagnostic.range,this.props.document),d=await Tc(this.logService,this.telemetryService,this.props.document,500,()=>l.getCallExpressions(u),[]);for(let p of d){let f=Gs(this.props.document,p);r.push(f)}}break}case 1:{r.push(this.props.diagnostic.range);break}}return{infos:t,definitionRanges:r,ignoredFiles:o}}};yN=E([v(1,Be),v(2,ft),v(3,Te),v(4,oe),v(5,ge)],yN);var EJ=class extends Lx.PromptElement{render(e,t){let r=this.props.cookbook.fixes;if(r.length){let o=r[0];return vscpp(Rt,{name:"suggestedFix"},o.title+o.message)}return null}};function W_e(n,e,t,r){let o=n.modelMaxPromptTokens*4/3,s=new Qp(o),a=e.document,c=e.language,l=new ba(s,a,c,"ed8c6549bwf9"),u=new ba(s,a,c,"abpxx6d04wxr"),d=new ba(s,a,c,"be15d9bcejpp"),p=()=>(u.trim(),l.trim(),d.trim(),{contextInfo:{language:c,above:u,range:l,below:d},tracker:s});if(!QQe(l,t,r))return p();let m={aboveLineIndex:r.start.line-1,belowLineIndex:r.end.line+1,minimumLineIndex:0,maximumLineIndex:a.lineCount-1};return LX(m,u,d),p()}function QQe(n,e,t){let r=Math.floor((e.start.line+e.end.line)/2),o=Math.max(r-t.start.line,t.end.line-r);n.appendLine(r);for(let s=1;s<=o;s++){let a=r-s,c=r+s;if(a>=t.start.line&&!n.prependLine(a)||c<=t.end.line&&!n.appendLine(c))return!1}return!0}function j0(n,e,t,r){let o=n.getDiagnostics(e).filter(s=>!!s.range.intersection(t));if(r){let s=o.filter(a=>r.includes(a.message));if(s.length>0)return s}return o}async function K_e(n,e,t){let r=$5(e),o=Math.max(t,e.end.line-e.start.line+t),s=await n.getFixSelectionOfInterest(r,o);return W5(s)}var bN=class{constructor(e,t){this._instantiationService=e;this._languageDiagnosticsService=t;this.kind="diagnostics"}async resolveContext(e,t){let r=e.documentContext;if(!r)return;let o=j0(this._languageDiagnosticsService,r.document.uri,r.selection,e.message),{messages:s}=await Qi(this._instantiationService,e.endpoint,bf,{documentContext:r,diagnostics:o});return{kind:this.kind,userMessages:s.map(a=>a.content)}}};bN=E([v(0,H),v(1,Zo)],bN);zr.register(new fe(bN));var p9=q(Ve());var JC=class{constructor(e=!0,t,r){let o=ch(t.getEditorInfo().version);this.embeddingsCache=e?r.createInstance(nu,1,"api",o,"api"):r.createInstance(kd,1,"api",o)}async updateIndex(){this.apiChunks=await this.embeddingsCache.getCache()}nClosestValues(e,t,r=0){if(!this.apiChunks)return[];let o=this.apiChunks.map(s=>{if(!s.embedding)return{text:s.text,similarity:0};let a=qv(e,s.embedding);return{text:this.toContextString(s),similarity:a}});return o=o.filter(s=>s.similarity>r),o.sort((s,a)=>a.similarity-s.similarity),o.slice(0,t).map(s=>s.text)}toContextString(e){return e.type==="code"?`API Reference Code Snippet from vscode.d.ts:
${mo(e.lang,e.text)}`:e.type==="command"?`${e.text}`:e.type==="documentationCodeBlock"?`Example code from VS Code documentation:
${mo(e.lang,e.text)}`:""}};JC=E([v(1,it),v(2,H)],JC);var wJ=re("IApiEmbeddingsIndex"),ZC=class extends p9.PromptElement{constructor(t,r,o,s){super(t);this.apiEmbeddingsIndex=r;this.embeddingsComputer=o;this.endpointProvider=s}async renderAsString(){return`Below are some potentially relevant code samples related to VS Code extension development. You may use information from these samples to help you answer the question if you believe it is relevant.
${(await this.getSnippets()).join(`

`)}`}async getSnippets(){await this.apiEmbeddingsIndex.updateIndex();let t=await this.endpointProvider.getEmbeddingsEndpoint("text3small"),r=await this.embeddingsComputer.computeEmbeddings(t,[this.props.query],{dimensions:512},Zt.None);return r&&r.embeddings.length>0?this.apiEmbeddingsIndex.nClosestValues(r.embeddings[0],5):[]}async render(t,r){let o=await this.getSnippets();if(o.length)return vscpp(vscppf,null,"Below are some potentially relevant code samples related to VS Code extension development. You may use information from these samples to help you answer the question if you believe it is relevant.",vscpp("br",null),o.map(s=>vscpp(vscppf,null,vscpp(p9.TextChunk,null,s),vscpp("br",null),vscpp("br",null))))}};ZC=E([v(1,wJ),v(2,_s),v(3,_e)],ZC);var Y_e=q(ht()),Q_e=q(require("path"));var _N=class{constructor(e,t,r){this._workspaceService=e;this._gitService=t;this._tabsAndEditorsService=r;this.kind="git-metadata";this.variableInfo={name:"git",description:Y_e.t("Information about the current git repository"),defaultEnablement:!1}}async resolveContext(e,t){let r=this._workspaceService,s=this._gitService.repositories,a=r.getWorkspaceFolders();if(s.length===0||!a)return;if(a.length>1){let l=e.documentContext?.document.uri??this._tabsAndEditorsService.activeTextEditor?.document.uri;if(l){let u=r.getWorkspaceFolder(l);if(u){let d=a.findIndex(p=>p.toString()===u.toString());d!==-1&&(s=[s[d]],a=[a[d]])}}}let c=[];for(let l=0;l<s.length;l++){if(t.isCancellationRequested)return;let u=s[l],d=a[l];if(!u)continue;let p=[];p.push(`Workspace Folder: ${Q_e.basename(d.path)}`),p.push("```"),u.headBranchName?(p.push(`Current Branch name: ${u.headBranchName}`),p.push(`Upstream: ${u.upstreamBranchName?u.upstreamBranchName:"none"}`)):p.push("Detached HEAD?: yes"),p.push(`Is currently rebasing?: ${u.isRebasing?"yes":"no"}`),p.push(`Remotes: ${(u.remotes??[]).join(", ")}`),p.push("```"),c.push(p.join(`
`))}return{kind:this.kind,userMessages:[`Metadata about the current git repository:
`+c.join(`
`)]}}};_N=E([v(0,Be),v(1,Ks),v(2,$t)],_N);zr.register(new fe(_N));var X_e=q(ht());var xN=class{constructor(e){this.terminalService=e;this.kind="terminal-buffer";this.variableInfo={name:"terminalBuffer",description:X_e.t("The active terminal's buffer"),defaultEnablement:!1}}async resolveContext(){let e=this.terminalService.terminalBuffer;return{kind:this.kind,userMessages:[`The active terminal's buffer:
`+e]}}};xN=E([v(0,vi)],xN);zr.register(new fe(xN));var kJ=q(ht());var SN=class{constructor(e){this.terminalService=e;this.kind="terminal-last-command";this.variableInfo={name:"terminalLastCommand",description:kJ.t("The active terminal's last run command"),fullName:kJ.t("Terminal Last Command"),icon:"terminal",defaultEnablement:!0,registerTool:!0}}async resolveContext(){let e=this.terminalService.terminalLastCommand;if(!e)return;let t=[];e.commandLine&&(t.push("The following is the last command run in the terminal:"),t.push(e.commandLine)),e.cwd&&(t.push("It was run in the directory:"),t.push(typeof e.cwd=="object"?e.cwd.toString():e.cwd)),e.output&&(t.push("It has the following output:"),t.push(e.output));let r=t.join(`
`);return{kind:this.kind,userMessages:[`The active terminal's last run command:
`+r]}}};SN=E([v(0,vi)],SN);zr.register(new fe(SN));var RJ=q(ht());var IN=class{constructor(e){this.terminalService=e;this.kind="terminal-selection";this.variableInfo={name:"terminalSelection",icon:"terminal",fullName:RJ.t("Terminal Selection"),description:RJ.t("The active terminal's selection"),defaultEnablement:!0,registerTool:!0}}async resolveContext(){let e=this.terminalService.terminalSelection;return{kind:this.kind,userMessages:[`The active terminal's selection:
`+e]}}};IN=E([v(0,vi)],IN);zr.register(new fe(IN));var TN=class{constructor(e){this.terminalService=e;this.kind="terminal-shell-type"}async resolveContext(){let e=this.terminalService.terminalShellType;return{kind:this.kind,userMessages:[`The active terminal's shell type:
`+e]}}};TN=E([v(0,vi)],TN);zr.register(new fe(TN));var CN=q(ht());function J_e(n,e){let t=Is(e);for(let r of t){if(r.language!=="json"&&r.language!=="")return[{command:void 0,showCodeBlock:!0,failedValidation:!1}];let o;try{o=gf(r.code)}catch{}if(!o)return[];let s=o.hasOwnProperty("type")&&o.type==="setting",a=o.hasOwnProperty("type")&&o.type==="command";if(s){let c=[],l=o.settings;if(!l)return c;let u="",d=!1;for(let p of Object.keys(l))c.some(f=>f.command?.arguments&&f.command.arguments[0].includes(`@id:${p}`))||(u+=`@id:${p} `,n.hasSetting(p)||(d=!0));return u=u.trimEnd(),u&&c.push({command:{command:"workbench.action.openSettings",arguments:[u],title:CN.t("Show in Settings Editor")},showCodeBlock:!0,failedValidation:d,codeBlock:"```json\n"+JSON.stringify(l,null,2)+"\n```\n"}),c}else if(a){let c=o.commands.command;if(!c)return[{command:void 0,showCodeBlock:!0,failedValidation:!1}];let l=o.commands.args,u=[];if(c==="workbench.extensions.search"||c==="workbench.extensions.installExtension"){let d=(Array.isArray(l)?l:[l]).filter(p=>typeof p=="string");if(d.length===1){let p=["featured","popular","recentlyPublished","recommended","updates","builtin","enabled","disabled","installed","workspaceUnsupported"];d[0].includes(":")&&!d[0].startsWith("@")?d[0]=`@${d[0]}`:p.includes(d[0])&&(d[0]=`@${d[0]}`)}return u.push({command:{command:"workbench.extensions.search",arguments:d,title:CN.t("Search Extension Marketplace")},showCodeBlock:!1,failedValidation:!1}),u}else{let d=n.getCommand(c);if(!d)continue;return u.push({command:{command:"workbench.action.quickOpen",arguments:[`>${d.originalLabel??""}`],title:u.length>1?CN.t('Show "{0}"',d.originalLabel??""):CN.t("Show in Command Palette")},showCodeBlock:!1,failedValidation:!1}),u}}else return[{command:void 0,showCodeBlock:!0,failedValidation:!1}]}return[]}function XQe(){}var AJ={};Dr(AJ,{create:()=>JQe});function JQe(n){let e=n.get(oe);n.get(Be).ensureWorkspaceIsFullyLoaded().catch(t=>e.public.error(t))}var ZQe=[...rge,AJ,PJ],Z_e=ZQe;var oi=require("vscode");var eXe="github.copilotChat.signIn",tXe="github.copilotChat.signInGHE",nXe="github.copilotChat.signInChoose",eE=class extends ye{constructor(t){super();this.instantiationService=t;this.askToUpgradeAuthPermissions(),this.registerSignInCommands(this.instantiationService)}async askToUpgradeAuthPermissions(){await this._register(this.instantiationService.createInstance(EN)).run()}registerSignInCommands(t){let r=t.createInstance(wN);this._register(oi.commands.registerCommand(eXe,o=>r.authSignInCommand(o))),this._register(oi.commands.registerCommand(tXe,o=>r.authSignInGHECommand(o))),this._register(oi.commands.registerCommand(nXe,o=>r.authSignInChooseCommand(o)))}};eE=E([v(0,H)],eE);var EN=class extends ye{constructor(t,r,o,s,a){super();this._authenticationService=t;this._logService=r;this._ghRepoService=o;this._gitService=s;this._extensionContext=a}async run(){await this.waitForChatEnabled(),!(!this._gitService||await txe(this._gitService,this._ghRepoService,this._logService)||(this.registerListeners(),await this._authenticationService.getPermissiveGitHubSession({silent:!0})))&&await this.showPrompt()}async waitForChatEnabled(){try{if((await this._authenticationService.getCopilotToken()).isChatEnabled())return}catch(t){this._logService.public.error(t,"Failed to get copilot token")}await Kl.toPromise(Kl.filter(this._authenticationService.onDidAuthenticationChange,()=>this._authenticationService.copilotToken?.isChatEnabled()??!1))}registerListeners(){this._register(this._authenticationService.onDidAuthenticationChange(async()=>{if(!this._authenticationService.permissiveGitHubSession)if(this._authenticationService.anyGitHubSession)await this.showPrompt();else{this._extensionContext.globalState.update("copilot.shownPermissiveTokenModal",!1);return}}))}async showPrompt(){try{let t=this._extensionContext.globalState.get("copilot.shownPermissiveTokenModal",!1),r={};t||(r.forceNewSession={detail:oi.l10n.t("To show you more relevant Copilot Chat results, we need permission to read the contents of your repository on GitHub."),learnMore:oi.Uri.parse("https://aka.ms/copilotRepoScope")},this._extensionContext.globalState.update("copilot.shownPermissiveTokenModal",!0)),await this._authenticationService.getPermissiveGitHubSession(r)&&this._logService.public.debug("Got permissive GitHub token")}catch(t){this._logService.public.error(t,"Failed to get permissive GitHub token"),await this._authenticationService.getPermissiveGitHubSession({})}}};EN=E([v(0,xt),v(1,oe),v(2,Id),v(3,Ks),v(4,qt)],EN);var wN=class{constructor(e,t,r,o,s){this._gitService=e;this._ghRepoService=t;this._authenticationService=r;this._logService=o;this._configurationService=s}async authSignInChooseCommand(e){let t=await oi.window.showQuickPick([{label:oi.l10n.t("Sign in to GitHub.com"),providerId:"github"},{label:oi.l10n.t("Sign in to GHE.com"),providerId:"github-enterprise"}],{placeHolder:oi.l10n.t("Sign in to...")});t&&(t.providerId==="github"?await this.authSignInCommand(e):await this.authSignInGHECommand(e))}async authSignInCommand(e){if(this._configurationService.getConfig(le.AuthProvider)!=="github")try{await this._configurationService.setConfig(le.AuthProvider,"github")}catch(r){console.error(r)}await this._authSignIn(e)}async authSignInGHECommand(e){if(this._configurationService.getConfig(le.AuthProvider)!=="github-enterprise")try{await this._configurationService.setConfig(le.AuthProvider,"github-enterprise")}catch(s){console.error(s)}let r=oi.workspace.getConfiguration("github-enterprise");if(!r.get("uri")){let s=!1,a=await oi.window.showInputBox({prompt:oi.l10n.t("What is your GHE.com instance?"),placeHolder:oi.l10n.t('i.e. "octocat" or "https://octocat.ghe.com"...'),validateInput(l){if(s=!1,!!l){if(/^[a-zA-Z\-_]+$/.test(l))return s=!0,{message:oi.l10n.t({message:"Will resolve to {0}",args:[`https://${l}.ghe.com`],comment:"The {0} will be replaced with a URL"}),severity:oi.InputBoxValidationSeverity.Info};if(!/^(https:\/\/)?([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.ghe\.com\/?$/.test(l))return{message:oi.l10n.t('Please enter a valid GHE.com instance (i.e. "octocat" or "https://octocat.ghe.com")'),severity:oi.InputBoxValidationSeverity.Error}}}});if(!a)return;let c=a;s?c=`https://${c}.ghe.com`:a.toLowerCase().startsWith("https://")||(c="https://"+a),await r.update("uri",c,oi.ConfigurationTarget.Global)}await this._authSignIn(e)}async _authSignIn(e){if(await txe(this._gitService,this._ghRepoService,this._logService)){await this._authenticationService.getAnyGitHubSession(e?{forceNewSession:!0}:{createIfNone:!0});return}await this._authenticationService.getPermissiveGitHubSession({forceNewSession:{learnMore:$e.parse("https://aka.ms/copilotRepoScope")}})}};wN=E([v(0,Ks),v(1,Id),v(2,xt),v(3,oe),v(4,be)],wN);async function txe(n,e,t){let r=n?.repositories;if(!r)return t.internal.debug("No git repositories found"),!1;let o=r.map(VT).filter(a=>a);return(await Promise.all(o.map(a=>{let[c,l]=a.split("/");return e.isAvailable(c,l)}))).every(a=>a)}var DJ={};Dr(DJ,{create:()=>lXe});var fu=q(require("vscode"));var rXe="vscode-chat-code-block",iXe=[/^\n```(typescript|javascript|tsx|jsx)\S*\nany\n```\n$/i],oXe=[new Set(["typescript","javascript","typescriptreact","javascriptreact"]),...Array.from(lx.keys(),n=>new Set([n]))],kN=class{constructor(e,t){this.instantiationService=e;this.telemetryService=t}async provideDefinition(e,t,r){return this.goTo("vscode.experimental.executeDefinitionProvider_recursive",e,t,r)}async provideImplementation(e,t,r){return this.goTo("vscode.experimental.executeImplementationProvider_recursive",e,t,r)}async provideTypeDefinition(e,t,r){return this.goTo("vscode.experimental.executeTypeDefinitionProvider_recursive",e,t,r)}async provideHover(e,t,r){let o=await this.execHover(e.uri,t),s=this.filterOutGenericHovers(o);if(s?.length)return this.convertHover(s);if(r.isCancellationRequested)return;let a=await this.getReferencesContext(e,t,r);if(!(!a||r.isCancellationRequested)){for(let c of a.wordMatches){let l=await this.execHover(c.uri,c.range.start);if(r.isCancellationRequested)return;if(l?.length)return this.convertHover(l)}return this.convertHover(o)}}async execHover(e,t){return fu.commands.executeCommand("vscode.experimental.executeHoverProvider_recursive",e,t)}convertHover(e){return e.length?new fu.Hover(e.flatMap(t=>t.contents),e[0].range):void 0}filterOutGenericHovers(e){return e.filter(t=>t.contents.some(r=>{if(typeof r=="string")return r.length;if(!r.value.length)return!1;for(let o of iXe)if(o.test(r.value))return!1;return!0}))}async goTo(e,t,r,o){let s=await WT(t.uri.fragment);if(o.isCancellationRequested)return;this.telemetryService.sendMSFTTelemetryEvent("codeBlock.action.goTo",{languageId:t.languageId,command:e,codeBlockId:s});let a=await this.executeGoToInChatBlocks(e,t,r);if(a?.length)return a;if(!o.isCancellationRequested)return this.executeGoToInChatReferences(e,t,r,o)}async executeGoToInChatBlocks(e,t,r){return(await this.executeGoTo(e,t.uri,r))?.map(s=>"uri"in s?{targetRange:s.range,targetUri:s.uri}:s)}async executeGoTo(e,t,r){return fu.commands.executeCommand(e,t,r)}async executeGoToInChatReferences(e,t,r,o){let s=await this.getReferencesContext(t,r,o);if(!(!s||o.isCancellationRequested))for(let a of s.wordMatches){let c=await this.executeGoTo(e,a.uri,a.range.start);if(o.isCancellationRequested)return;if(c)return c.map(l=>"uri"in l?{targetRange:l.range,targetUri:l.uri,originSelectionRange:s.wordRange}:{targetSelectionRange:l.targetSelectionRange,targetRange:l.targetRange,targetUri:l.targetUri,originSelectionRange:s.wordRange})}}async getReferencesContext(e,t,r){let o=this.getReferences(e);if(!o?.length)return;let s=e.getWordRangeAtPosition(t);if(!s)return;let a=e.getText(s),c=await this.instantiationService.invokeFunction(l=>a9(l,o,a,{},r));return{wordRange:s,wordMatches:c}}getReferences(e){let t=this.extractReferences(e),r=Rr(e),o=aXe(r);return o?t.filter(s=>{let a=sXe(s);if(!a)return!1;let c=fo(a);return!!o.has(c.languageId)}):t}extractReferences(e){try{let t=decodeURIComponent(e.uri.fragment);return JSON.parse(t).references.map(o=>"range"in o?new Xo.PromptReference(new ar(zt.from(o.uri),new Me(o.range.startLineNumber-1,o.range.startColumn-1,o.range.endLineNumber-1,o.range.endColumn-1))):new Xo.PromptReference(zt.from(o.uri)))}catch{return[]}}};kN=E([v(0,H),v(1,ge)],kN);function sXe(n){return sh(n.anchor)?n.anchor:"uri"in n.anchor?n.anchor.uri:"value"in n.anchor&&sh(n.anchor.value)?n.anchor.value:void 0}function aXe(n){return oXe.find(e=>e.has(n.languageId))}function nxe(n){let e=n.get(H).createInstance(kN),t={scheme:rXe,exclusive:!0};return fu.Disposable.from(fu.languages.registerDefinitionProvider(t,e),fu.languages.registerTypeDefinitionProvider(t,e),fu.languages.registerImplementationProvider(t,e),fu.languages.registerHoverProvider(t,e))}function lXe(n){return nxe(n)}var Ch=require("vscode");var Mmn=Object.freeze({id:"application",order:100,title:Yme("applicationConfigurationTitle","Application"),type:"object"});var NJ=class{constructor(){this.migrations=[];this._onDidRegisterConfigurationMigrations=new jt;this.onDidRegisterConfigurationMigration=this._onDidRegisterConfigurationMigrations.event}registerConfigurationMigrations(e){this.migrations.push(...e)}},mu=new NJ,f9=class{constructor(){this._disposables=new _t;this._register(Ch.workspace.onDidChangeWorkspaceFolders(async e=>{for(let t of e.added)await this.migrateConfigurationForFolder(t,mu.migrations)})),this.migrateConfigurations(mu.migrations),this._register(mu.onDidRegisterConfigurationMigration(e=>this.migrateConfigurations(e)))}async migrateConfigurations(e){if(Ch.window.state.focused){await this.migrateConfigurationForFolder(void 0,e);for(let t of Ch.workspace.workspaceFolders??[])await this.migrateConfigurationForFolder(t,e)}}async migrateConfigurationForFolder(e,t){await Promise.all([t.map(r=>this.migrateConfigurationsForFolder(r,e?.uri))])}async migrateConfigurationsForFolder(e,t){let r=Ch.workspace.getConfiguration(void 0,t),o=r.inspect(e.key);if(!o)return;let s=[[o.globalValue,Ch.ConfigurationTarget.Global],[o.workspaceValue,Ch.ConfigurationTarget.Workspace]];for(let[a,c]of s){if(!a)continue;let l=[];if(a!==void 0){let u=await this.runMigration(e,a);for(let d of u??[])l.push(d)}l.length&&await Promise.allSettled(l.map(async([u,d])=>{r.update(u,d.value,c)}))}}async runMigration(e,t){let r=await e.migrateFn(t);return Array.isArray(r)?r:[[e.key,r]]}_register(e){this._disposables.add(e)}dispose(){this._disposables.dispose()}};mu.registerConfigurationMigrations([{key:"github.copilot.chat.experimental.startDebugging.enabled",migrateFn:async n=>[["github.copilot.chat.startDebugging.enabled",{value:n}],["github.copilot.chat.experimental.startDebugging.enabled",{value:void 0}]]}]);mu.registerConfigurationMigrations([{key:"github.copilot.chat.experimental.setupTests.enabled",migrateFn:async n=>[["github.copilot.chat.setupTests.enabled",{value:n}],["github.copilot.chat.experimental.setupTests.enabled",{value:void 0}]]}]);mu.registerConfigurationMigrations([{key:"github.copilot.chat.experimental.codeGeneration.instructions",migrateFn:async n=>[["github.copilot.chat.codeGeneration.instructions",{value:n}],["github.copilot.chat.experimental.codeGeneration.instructions",{value:void 0}]]}]);mu.registerConfigurationMigrations([{key:"github.copilot.chat.experimental.codeGeneration.useInstructionFiles",migrateFn:async n=>[["github.copilot.chat.codeGeneration.useInstructionFiles",{value:n}],["github.copilot.chat.experimental.codeGeneration.useInstructionFiles",{value:void 0}]]}]);mu.registerConfigurationMigrations([{key:"github.copilot.chat.experimental.testGeneration.instructions",migrateFn:async n=>[["github.copilot.chat.testGeneration.instructions",{value:n}],["github.copilot.chat.experimental.testGeneration.instructions",{value:void 0}]]}]);mu.registerConfigurationMigrations([{key:"github.copilot.chat.experimental.generateTests.codeLens",migrateFn:async n=>[["github.copilot.chat.generateTests.codeLens",{value:n}],["github.copilot.chat.experimental.generateTests.codeLens",{value:void 0}]]}]);mu.registerConfigurationMigrations([{key:"github.copilot.chat.experimental.inlineChatCompletionTrigger.enabled",migrateFn:async n=>[["github.copilot.chat.inlineChatCompletionTrigger.enabled",{value:n}],["github.copilot.chat.experimental.inlineChatCompletionTrigger.enabled",{value:void 0}]]}]);mu.registerConfigurationMigrations([{key:"github.copilot.chat.experimental.inlineChatHint.enabled",migrateFn:async n=>[["github.copilot.chat.inlineChatHint.enabled",{value:n}],["github.copilot.chat.experimental.inlineChatHint.enabled",{value:void 0}]]}]);mu.registerConfigurationMigrations([{key:"github.copilot.chat.experimental.temporalContext.enabled",migrateFn:async n=>[["github.copilot.chat.temporalContext.enabled",{value:n}],["github.copilot.chat.experimental.temporalContext.enabled",{value:void 0}]]}]);var LJ={};Dr(LJ,{create:()=>uXe});var El=require("vscode");var m9=re("IContextResolverService"),tE=class extends ye{constructor(t){super();this._instantiationService=t;this._initialized=!1;this._contextResolvers=new Map}get contextResolvers(){return this._initialize(),this._contextResolvers.values()}_initialize(){if(!this._initialized){this._initialized=!0;let t=zr.getContextResolverDescriptors();for(let r of t){let o=this._instantiationService.createInstance(r);this._contextResolvers.set(o.kind,o),I1(o)&&this._register(o)}}}};tE=E([v(0,H)],tE);var rE=re("ChatVariableService"),nE=class{constructor(e,t){this._contextResolverService=t;this._variableEnablements=e.getConfigMixedWithDefaults(le.ConversationVariablesEnablements)}isVariableEnabled(e){return typeof this._variableEnablements[e.name]=="boolean"?this._variableEnablements[e.name]:typeof e.defaultEnablement=="boolean"?e.defaultEnablement:!!this._variableEnablements["*"]}getVariables(){let e=[];for(let t of this._contextResolverService.contextResolvers)t.variableInfo&&this.isVariableEnabled(t.variableInfo)&&e.push({name:t.variableInfo.name,fullName:t.variableInfo.fullName,icon:t.variableInfo.icon,kind:t.kind,description:t.variableInfo.description,registerTool:t.variableInfo.registerTool,resolve:t.resolveContext.bind(t)});return e}getVariable(e){return this.getVariables().find(t=>t.name===e)}};nE=E([v(0,be),v(1,m9)],nE);function uXe(n){let e=n.get(_e),t=n.get(rE),r=new _t;for(let o of t.getVariables())o.registerTool!=="canBeInvokedManually"&&r.add(El.chat.registerChatVariableResolver(`copilot.${o.name}`,o.name,o.description??"",void 0,o.name==="codebase",{async resolve(s,a,c){return[]},resolve2:async(s,a,c,l)=>{let u={endpoint:await e.getChatEndpoint("gpt-4o-mini"),message:a.prompt},d={report(f){c.push(f)}},p=await o.resolve(u,l,d);return p?(p.references?.forEach(f=>{"variableName"in f.anchor||c.reference(f.anchor)}),[{level:El.ChatVariableLevel.Full,value:p.userMessages.join(`

`),description:""}]):[]}},o.fullName,o.icon?new El.ThemeIcon(o.icon):void 0));return r.add(dXe(n)),r}function dXe(n){return El.Disposable.from(El.commands.registerCommand("github.copilot.chat.attachSelection",()=>{El.commands.executeCommand("workbench.action.chat.attachSelection")}),El.commands.registerCommand("github.copilot.chat.attachFile",()=>{El.commands.executeCommand("workbench.action.chat.attachFile")}))}var Va=require("vscode");var axe=require("vscode");var H0=class{constructor(){this._inFlightPromises=new Map}getOrCreate(e,t){let r=this._inFlightPromises.get(e);if(r)return r;let o=t().finally(()=>this._inFlightPromises.delete(e));return this._inFlightPromises.set(e,o),o}};var Eh=require("vscode");var rxe="You are not signed in to GitHub. Please sign in to use Copilot.";function h9(n){return n.getConfig(le.AuthProvider)==="github-enterprise"?"github-enterprise":"github"}async function ixe(n,e,t,r={}){if(!(await Eh.authentication.getAccounts(n)).length)return await Eh.authentication.getSession(n,e,r);if(r.forceNewSession)return await Eh.authentication.getSession(n,e,{...r,forceNewSession:r.forceNewSession,clearSessionPreference:!0});let s=await t();if(s)return s;if(r.createIfNone)return await Eh.authentication.getSession(n,e,{forceNewSession:!0,clearSessionPreference:!0})}function g9(n,e){let t=h9(n);return ixe(t,tY,async()=>{let r=await Eh.authentication.getSession(t,v5,{silent:!0});if(r)return r;let o=await Eh.authentication.getSession(t,tY,{silent:!0});if(o)return o;let s=await Eh.authentication.getSession(t,cve,{silent:!0});if(s)return s},e)}function oxe(n,e){let t=h9(n);return ixe(t,v5,async()=>await Eh.authentication.getSession(t,v5,{silent:!0}),e)}var sxe=!1,RN=class extends Error{},PN=class extends Error{},AN=class extends Error{},DN=class extends Error{},NN=class extends Error{},iE=class extends Q1{constructor(t,r,o,s,a,c){super(new Lv(o,s),t,r,o,s,a);this.configurationService=c;this._taskSingler=new H0}async getCopilotToken(t){if(!this.copilotToken||this.copilotToken.expires_at<Mv()||t)try{this._logService.internal.debug(`Getting CopilotToken (force: ${t})...`),this.copilotToken=await this._authShowWarnings(),this._logService.internal.debug(`Got CopilotToken (force: ${t}).`)}catch(r){throw this._logService.internal.debug(`Getting CopilotToken (force: ${t}) threw error: ${r}`),this.copilotToken=void 0,r}return new Q_(this.copilotToken)}async _auth(){let t=await g9(this.configurationService,{silent:!0});if(!t)return this._logService.public.warn("GitHub login failed"),this._telemetryService.sendGHTelemetryErrorEvent("auth.github_login_failed"),{kind:"failure",reason:"GitHubLoginFailed"};this._logService.public.info(`Logged in as ${t.account.label}`);let r=await this.authFromGitHubToken(t.accessToken);return r.kind==="success"&&this._logService.public.info(`Got Copilot token for ${t.account.label}`),r}async _authShowWarnings(){let t=await this._taskSingler.getOrCreate("auth",()=>this._auth());if(t.kind==="failure"&&t.reason==="NotAuthorized"){let r=t.message;switch(t.notification_id){case"no_copilot_access":throw new RN(r??"User not authorized");case"subscription_ended":throw new PN(r);case"enterprise_managed_user_account":throw new DN(r);case"server_error":case"feature_flag_blocked":case"spammy_user":throw new AN(r)}}if(t.kind==="failure"&&t.reason==="HTTP401"){let r="Your GitHub token is invalid. Please sign out from your GitHub account using the VS Code accounts menu and try again.";throw sxe||(sxe=!0,axe.window.showWarningMessage(r)),Error(r)}if(t.kind==="failure"&&t.reason==="GitHubLoginFailed")throw Error("GitHubLoginFailed");if(t.kind==="failure"&&t.reason==="RateLimited")throw Error("Your account has exceeded GitHub's API rate limit. Please try again later.");if(t.kind==="failure")throw Error("Failed to get copilot token");if(t.kind==="success"&&t.chat_enabled===!1)throw new NN("Copilot Chat is disabled");return t}};iE=E([v(0,oe),v(1,ge),v(2,xn),v(3,hn),v(4,it),v(5,be)],iE);var V0={Activated:"github.copilot-chat.activated",Offline:"github.copilot.offline",IndividualDisabled:"github.copilot.interactiveSession.individual.disabled",IndividualExpired:"github.copilot.interactiveSession.individual.expired",ContactSupport:"github.copilot.interactiveSession.contactSupport",EnterpriseDisabled:"github.copilot.interactiveSession.enterprise.disabled",CopilotChatDisabled:"github.copilot.interactiveSession.chatDisabled"},pXe="github.copilot.chat.debug",oE=class extends ye{constructor(t,r,o,s,a,c){super();this._authenticationService=r;this._configurationService=o;this._telemetryService=s;this._fetcherService=a;this._logService=c;this._needsOfflineCheck=!1;this._inspectContext().catch(console.error),this._register(r.onDidAuthenticationChange(async()=>await this._inspectContext())),this._register(Va.commands.registerCommand("github.copilot.offline",async()=>await this._inspectContext())),this._register({dispose:()=>this._cancelPendingOfflineCheck()}),this._register(Va.window.onDidChangeWindowState(()=>this._runOfflineCheck("Window state change")))}_scheduleOfflineCheck(){this._cancelPendingOfflineCheck(),this._needsOfflineCheck=!0,this._logService.public.debug(`[context keys] Scheduling offline check. Active: ${Va.window.state.active}, focused: ${Va.window.state.focused}.`),Va.window.state.active&&Va.window.state.focused&&(this._scheduledOfflineCheck=setTimeout(()=>{this._scheduledOfflineCheck=void 0,this._runOfflineCheck("Scheduled offline check")},60*1e3).unref())}_runOfflineCheck(t){this._logService.public.debug(`[context keys] ${t}. Needs offline check: ${this._needsOfflineCheck}, active: ${Va.window.state.active}, focused: ${Va.window.state.focused}.`),this._needsOfflineCheck&&Va.window.state.active&&Va.window.state.focused&&this._inspectContext().catch(r=>this._logService.public.error(r))}_cancelPendingOfflineCheck(){this._needsOfflineCheck=!1,this._scheduledOfflineCheck&&(clearTimeout(this._scheduledOfflineCheck),this._scheduledOfflineCheck=void 0)}async _inspectContext(){this._logService.public.debug("[context keys] Updating context keys."),this._cancelPendingOfflineCheck();let t=Object.values(V0),r,o,s;try{s=await this._authenticationService.getCopilotToken(),o=V0.Activated}catch(c){r=c;let l=c.message||c,u=mi.createAndMarkAsIssued({reason:l});this._telemetryService.sendGHTelemetryErrorEvent("activationFailed",u.properties,u.measurements);let d=l==="GitHubLoginFailed"?rxe:`GitHub Copilot could not connect to server. Extension activation failed: "${l}"`;this._logService.public.error(d)}r instanceof RN?o=V0.IndividualDisabled:r instanceof PN?o=V0.IndividualExpired:r instanceof DN?o=V0.EnterpriseDisabled:r instanceof AN?o=V0.ContactSupport:r instanceof NN?o=V0.CopilotChatDisabled:this._fetcherService.isFetcherError(r)&&(o=V0.Offline,this._scheduleOfflineCheck()),o&&Va.commands.executeCommand("setContext",o,!0);let a=vK(this._configurationService,s);Va.commands.executeCommand("setContext",pXe,a);for(let c of t)c!==o&&Va.commands.executeCommand("setContext",c,!1)}};oE=E([v(0,H),v(1,xt),v(2,be),v(3,ge),v(4,hn),v(5,oe)],oE);var pE=q(require("vscode"));var G0=class extends ye{constructor(t,r,o,s){super();this._initialText=t;this._document=r;this._workspaceService=o;this._diffService=s;this._additionalEdits=Rn.empty;this._documentText=this._document.getText();this._register(this._workspaceService.onDidChangeTextDocument(a=>{if(a.document.uri.toString()!==this._document.uri.toString())return;let c=Rn.from(a.contentChanges);this._additionalEdits=this._additionalEdits.compose(c)}))}async compute(){let t=await Rn.fromDiff(this._initialText,this._documentText,this._diffService);return{getEditsSinceInitial:()=>{if(this._store.isDisposed)throw new Xt("EditComputer has been disposed");return t.compose(this._additionalEdits)}}}};G0=E([v(2,Be),v(3,SC)],G0);var x9=q(ht());var OJ=q(ht());var $0=re("IOpenAiFetchService"),z0=class extends Error{constructor(t,r,o){super(o);this.type=t;this.requestId=r}};function cxe(n,e){switch(e){case"cancelled":return{message:"Cancelled"};case"exceeded-rate-limit":return{message:OJ.t("Sorry, your request was rate-limited. Please wait and try again."),responseIsFiltered:!0};case"model_overloaded":case"model_error":case"not-registered":case"not-200-status":case"context-window-exceeded":case"invalid-api-key":case"not-configured":default:return{message:OJ.t("Sorry, your request failed. Please try again. Request id: {0}",n)}}}var Br;(o=>{function n(s){return s instanceof v9}o.isOk=n;function e(s){return s instanceof y9}o.isFailure=e;function t(s){return new v9(s)}o.ok=t;function r(s,a){return new y9(s,a)}o.failure=r})(Br||={});var v9=class n{constructor(e){this.value=e}async ifAsyncOk(e){return await e(this.value)}ifOk(e){return e(this.value)}map(e){return new n(e(this.value))}},y9=class{constructor(e,t){this.errVal=e;this.message=t}async ifAsyncOk(e){return this}ifOk(e){return this}map(e){return this}};var Ni=q(Ve());var b9=class extends Ni.PromptMetadata{constructor(t,r,o){super();this.projectedDocument=t;this.documentUri=r;this.selection=o}},sE=class extends Ni.PromptElement{constructor(t,r,o){super(t);this.ignoreService=r;this.parserService=o}async render(t,r){if(Array.isArray(this.props.documentContext))return;let{document:o,fileIndentInfo:s,selection:a}=this.props.documentContext;if(await this.ignoreService.isCopilotIgnored(o.uri))return vscpp("ignoredFiles",{value:[o.uri]});let l=r.endpoint.modelMaxPromptTokens/3*4,u;if(o.getText().length>l){let d=await su(this.parserService,o,s??Sye(o));u=Zp(l,o,a,d,{tryPreserveTypeChecking:!1})}else u=new qa(o.getText(),Rn.empty,o.languageId);return vscpp(vscppf,null,vscpp("references",{value:[new Ni.PromptReference(o.uri)]}),vscpp("meta",{value:new b9(u,o.uri,a)}),vscpp(Ni.SystemMessage,{priority:1e3},"You are an AI programming assistant that is specialized in applying code changes to an existing document.",vscpp("br",null),"I have a code block that represents a suggestion for a code change and I have a ",o.languageId," file opened in a code editor.",vscpp("br",null),"I expect you to come up with code changes that apply the code block to the editor at a given selection. ",vscpp("br",null),"I want the changes to be applied in a way that is safe and does not break the existing code, is correctly indented and matching the code style.",vscpp("br",null),"For the response, always follow these instructions:",vscpp("br",null),"1. Analyse the code block, the content of the editor and the current selection to decide if the code block should replace existing code or is to be inserted.",vscpp("br",null),"2. A comment like `",_9.forLanguage(o.languageId),"` indicates a section of code that has not changed",vscpp("br",null),"3. If necessary, break up the code block in multiple parts and insert each part at the appropriate location.",vscpp("br",null),"4. If necessary, make changes to other parts in the editor so that the final result is valid, properly formatted and indented.",vscpp("br",null),"5. Finally, provide the code modifications",vscpp("br",null),vscpp(Il,null),vscpp("br",null),vscpp(Ze,null),vscpp(kt,null),vscpp(Rt,{name:"example",priority:100},vscpp(Rt,{name:"user"},"I have the following code open in the editor.",vscpp("br",null),vscpp(xh,{fileName:"someFolder/myFile.ts",language:"typescript",code:["import { readFileSync } from 'fs';","","class C { }"]}),vscpp("br",null),"This is the code block that represents a suggestion for a code change:",vscpp("br",null),vscpp(xh,{code:["private _stream: Stream;"]}),vscpp("br",null),"Please find out how the code block can be applied to the editor."),vscpp(Rt,{name:"assistant"},vscpp(uu,{changes:[{fileName:"someFolder/myFile.cs",find:["import { readFileSync } from 'fs';"],replace:["import { readFileSync } from 'fs';","import { Stream } from 'stream';"]},{fileName:"someFolder/myFile.ts",find:["class C { }"],replace:["class C {","	private _stream: Stream;","}"]}]})))),vscpp(Ni.UserMessage,{priority:700},vscpp(Do,null,u.text.length>0?vscpp(vscppf,null,"I have the following code open in the editor, starting from line 1 to line ",u.lineCount,".",vscpp("br",null),Fd(o.fileName),vscpp("br",null),vscpp(tt,{uri:o.uri,languageId:o.languageId,code:u.text,shouldTrim:!1}),vscpp("br",null)):vscpp(vscppf,null,"I am in an empty file:",Fd(o.fileName),vscpp("br",null))),this.renderSelection(u),vscpp(LN,{markdownBeforeBlock:this.props.markdownBeforeBlock}),"This is the code block that represents a suggestion for a code change:",vscpp("br",null),vscpp(tt,{uri:o.uri,languageId:o.languageId,code:this.props.codeBlock,shouldTrim:!1}),vscpp("br",null),vscpp(Rt,{name:"userPrompt"},"Please find out how the code block can be applied to the editor. Provide the code changes in the format as described above.",vscpp("br",null))))}renderSelection(t){if(Array.isArray(this.props.documentContext))return;let{document:r,selection:o}=this.props.documentContext;if(!o)return;let s=t.projectRange(o),a=r.getText(new Me(o.start.line,0,o.end.line+1,0)).trimEnd();return vscpp(vscppf,null,s.isEmpty?vscpp(vscppf,null,"I have the selection at line ",s.start.line+1,", column ",s.start.character+1,vscpp("br",null)):vscpp(vscppf,null,"I have currently selected from line ",s.start.line+1,", column ",s.start.character+1," to line ",s.end.line+1," column ",s.end.character+1,".",vscpp("br",null),a.length>0?vscpp(vscppf,null,"This is the content of the lines that contain the selection:",vscpp(tt,{uri:r.uri,languageId:r.languageId,code:a,shouldTrim:!1}),vscpp("br",null)):vscpp(vscppf,null,"The selection consists of whitespaces only.")))}};sE=E([v(1,Te),v(2,ft)],sE);var _9=new class{forLanguage(n){let e=n?Rr(n):{lineComment:{start:"//",end:void 0}},{start:t,end:r}=e.lineComment;return r?`${t} ...existing code... ${r}`:`${t} ...existing code...`}},dgn=new class{forLanguage(n){let e=n?Rr(n):{lineComment:{start:"//",end:void 0}},{start:t,end:r}=e.lineComment;return r?`${t} filepath: /path/to/file.ts ${r}`:`${t} filepath: /path/to/file.ts`}},LN=class extends Ni.PromptElement{render(){if(this.props.markdownBeforeBlock)return vscpp(vscppf,null,"This is the description of what the code block changes:",vscpp("br",null),vscpp(Rt,{name:"changeDescription"},this.props.markdownBeforeBlock),vscpp("br",null))}};function lxe(n,e,t){if(n){let c=Is(e);if(c.length!==1)throw new Error("Expected exactly one code block in the code mapper response");let l=n.getText().match(/\n*$/)?.[0]??"",u=c[0].code.trimEnd()+l,d=new Me(new Sn(0,0),new Sn(n.lineCount,0));return{edits:[new $r(d,u)],annotations:[]}}let r=t.get(b9);if(!r)throw new Error("CodeMapperPrompt: Metadata not found");let o=T0(),s=r.selection?r.projectedDocument.projectRange(r.selection).start.line:void 0,a=o.process(e,r.projectedDocument.text,r.documentUri,s);return{edits:r.projectedDocument.projectBackTextEdit(a.edits),annotations:a.annotations}}var Ox=class extends Ni.PromptElement{constructor(t,r){super(t);this.ignoreService=r}async render(t,r){let o=this.props.shouldTrimCodeBlocks??!1;if(Array.isArray(this.props.documentContext)){let c=[];for(let l of this.props.documentContext)await this.ignoreService.isCopilotIgnored(l.document.uri)||c.push(l);return vscpp(vscppf,null,vscpp("references",{value:c.map(({document:l})=>new Ni.PromptReference(l.uri))}),vscpp(Ni.SystemMessage,{priority:1e3},"You are an AI programming assistant that is specialized in generating code for a new document.",vscpp("br",null),vscpp(Ze,null),"The user has a code block that represents a suggestion for the contents of a single new file, and several other files opened in a code editor.",vscpp("br",null),"The provided files may contain code relevant to the new file. Consider them when generating the new file.",vscpp("br",null),"For the response, always follow these instructions:",vscpp("br",null),"1. Analyse the code block and the existing documents to decide which parts of the existing document should be incorporated in the generated code.",vscpp("br",null),"2. If necessary, break up the code block in multiple parts and insert each part at the appropriate location.",vscpp("br",null),"3. Preserve whitespace and newlines right after the parts of the file that you modify.",vscpp("br",null),"4. The final result must be syntactically valid, properly formatted, and correctly indented.",vscpp("br",null),"5. Finally, provide the full contents of the new file.",vscpp("br",null)),vscpp(Ni.UserMessage,{priority:700},vscpp(Ni.PrioritizedList,{priority:690,descending:!0},c.map(({document:l})=>l.lineCount===0?void 0:vscpp(Ni.Chunk,null,vscpp(vscppf,null,"I have the following code from the file ",l.uri.toString()," open in the editor, starting from line 1 to line ",l.lineCount,".",vscpp("br",null),vscpp(tt,{uri:l.uri,languageId:l.languageId,code:l.getText(),shouldTrim:o}),vscpp("br",null))))),vscpp(Ni.Chunk,{priority:695},vscpp(LN,{markdownBeforeBlock:this.props.markdownBeforeBlock}),"This is the code block that represents the suggested code change:",vscpp("br",null),vscpp(tt,{uri:this.props.uri,languageId:fo(this.props.uri).languageId,code:this.props.codeBlock,shouldTrim:o}),vscpp("br",null),vscpp(Rt,{name:"userPrompt"},"Provide the contents of the new file."))))}let{document:s}=this.props.documentContext;return await this.ignoreService.isCopilotIgnored(s.uri)?vscpp("ignoredFiles",{value:[s.uri]}):vscpp(vscppf,null,vscpp("references",{value:[new Ni.PromptReference(s.uri)]}),vscpp(Ni.SystemMessage,{priority:1e3},"You are an AI programming assistant that is specialized in applying code changes to an existing document.",vscpp("br",null),vscpp(Ze,null),"The user has a code block that represents a suggestion for a code change and a ",s.languageId," file opened in a code editor.",vscpp("br",null),"Rewrite the existing document to fully incorporate the code changes in the provided code block.",vscpp("br",null),"For the response, always follow these instructions:",vscpp("br",null),"1. Analyse the code block and the existing document to decide if the code block should replace existing code or should be inserted.",vscpp("br",null),"2. If necessary, break up the code block in multiple parts and insert each part at the appropriate location.",vscpp("br",null),"3. Preserve whitespace and newlines right after the parts of the file that you modify.",vscpp("br",null),"4. The final result must be syntactically valid, properly formatted, and correctly indented.",vscpp("br",null),"5. Finally, provide the fully rewritten file.",vscpp("br",null)),vscpp(Ni.UserMessage,{priority:700},s.lineCount>0?vscpp(vscppf,null,"I have the following code open in the editor, starting from line 1 to line ",s.lineCount,".",vscpp("br",null),vscpp(tt,{uri:s.uri,languageId:s.languageId,code:s.getText(),shouldTrim:o}),vscpp("br",null)):vscpp(vscppf,null,"I am in an empty editor."),vscpp(LN,{markdownBeforeBlock:this.props.markdownBeforeBlock}),"This is the code block that represents the suggested code change:",vscpp("br",null),vscpp(tt,{uri:s.uri,languageId:s.languageId,code:this.props.codeBlock,shouldTrim:o}),vscpp("br",null),vscpp(Rt,{name:"userPrompt"},"Rewrite the code in the current editor to incorporate the suggested code change.")))}};Ox=E([v(1,Te)],Ox);async function uxe(n,e,t,r,o){let s=e?e.lineCount:0,a=e?gXe(e):0,c=[],l=p=>{c.push(p),u<s?r.textEdit(n,[$r.replace(new Me(u,0,u,1073741824),p)]):r.textEdit(n,[$r.replace(new Me(u,1073741824,u,1073741824),`
`+p)]),u+=1},u=0;for await(let p of t)l(p.value);let d=vXe(c);for(let p=d;p<a;p++)l("");u<s&&r.textEdit(n,[$r.delete(new Me(u-1,c.length>0?c[c.length-1].length:0,s,0))])}function fXe(n,e){return new nr(async t=>{let r="```",o=nr.map(n,c=>c.delta.text),s=new Xp(o[Symbol.asyncIterator]()),a=!1;for(;!s.endOfStream&&!e.isCancellationRequested;){let c=await s.readLine();if(c.startsWith(r)&&a){a=!1;break}else c.startsWith(r)?a=!0:a&&t.emitOne(new i0(c))}})}async function mXe(n,e,t,r,o){let s=px.fromString(e);function a(d){if(Qm(d.find,d.replace))return;let p=FX(s,KD(d.find),KD(d.replace),0);p instanceof e0&&(r.textEdit(n,p.toTextEdit()),s=p.apply(s))}let c,l,u=[];for await(let d of a_e(t))switch(d.marker){case void 0:break;case Pn.FILEPATH:l=d.content.join(`
`).trim();break;case Pn.FIND:c=d.content;break;case Pn.REPLACE:{d.content&&c&&l&&a({fileName:l,find:c,replace:d.content});break}case Pn.COMPLETE:break;default:u.push(d);break}}var Mx=class{constructor(e,t,r,o,s){this.codeBlock=e;this.uri=t;this.markdownBeforeBlock=r;this.documentContext=o;this.endpoint=s}isEqualTo(e){let t=Array.isArray(this.documentContext)?this.documentContext:[this.documentContext],r=Array.isArray(e.documentContext)?e.documentContext:[e.documentContext];return th(this.uri,e.uri)&&dxe(this.codeBlock,e.codeBlock)&&dxe(this.markdownBeforeBlock,e.markdownBeforeBlock)&&t.every(o=>{let s=r.find(a=>th(o?.document.uri,a?.document.uri));if(!s)return!1;if(o.selection&&s.selection)return this.isEqualSelection(s.selection,o.selection)})}isEqualSelection(e,t){return e===t?!0:e===void 0||t===void 0?!1:e.isEqual(t)}},W0=class{constructor(e,t,r,o,s,a,c,l,u){this.endpointProvider=e;this.chatMLFetcher=t;this.configurationService=r;this.instantiationService=o;this.tokenizerProvider=s;this.logService=a;this.nesFetchService=c;this.experimentService=l;this.telemetryService=u}async mapCode(e,t,r,o){let{codeBlock:s,documentContext:a,markdownBeforeBlock:c}=e;(!r||r.family==="o1-preview"||r.family==="o1-mini")&&(r=await this.endpointProvider.getChatEndpoint("gpt-4"));let l=Array.isArray(a)?a.sort((S,w)=>w.document.getText().length-S.document.getText().length)[0]:a,u=l?this.tokenizerProvider.acquireTokenizer(r).tokenLength(l.document.getText())<4096/4*3:!0;if(this.configurationService.getExperimentBasedConfig(le.EditIntentFastRewrite,this.experimentService)){let S=await this.mapCodeUsingFastEdit(r,e,t,o);if(!(S instanceof ON))return S}let p=new a0,f=u?Ox:sE,m=t?async(S,w,R)=>{p.update(S,R)}:void 0,h;if(t){let S=Array.isArray(e.documentContext)?void 0:e.documentContext?.document;u?h=uxe(e.uri,S,fXe(p.stream,o),t,o):h=mXe(e.uri,S?.getText()??"",p.stream,t,o)}let g=Fe.create(this.instantiationService,r,f,{documentContext:a,codeBlock:s,uri:e.uri,markdownBeforeBlock:yXe(c)}),y=Date.now(),b=await g.render(void 0,o);if(o.isCancellationRequested)return;let _=await this.chatMLFetcher.fetchOne("codeMapper",b.messages,m,o,5,r,void 0,{temperature:0});p.resolve(),await h;let x,I=(S,w,R)=>({edits:S,errorDetails:R,annotations:w,telemetry:{endpoint:r,timeToComplete:Date.now()-y,fetchResult:_}});if(_.type==="success")if(t)x=I([],[],void 0);else{let S=lxe(u&&!Array.isArray(a)?a.document:void 0,_.value,b.metadata);S.edits.length===0?x=I([],S.annotations,{message:x9.t("The code mapper request did not return any edits.")}):x=I(S.edits,S.annotations,void 0)}else{if(_.type==="canceled")return;let S=Cd(_);x=I([],[{label:S.message,message:`request ${_.type}`,severity:"error"}],S)}return(x.annotations.length||x.errorDetails)&&this.logService.public.info(`[code mapper] Problems generating edits: ${x.annotations.map(S=>`${S.message} [${S.label}]`).join(", ")}, ${x.errorDetails?.message}`),x}async mapCodeUsingFastEdit(e,{codeBlock:t,uri:r,documentContext:o,markdownBeforeBlock:s},a,c){if((Array.isArray(o)?o.reduce((K,$)=>K+$.document.getText().length,0):o.document.getText().length)>256e3)return this.logService.internal.error("srequest | refuse | SD | refusing huge document | [codeMapper]"),new ON;let u={tokenizer:"o200k_base",family:e.family,modelMaxPromptTokens:Number.MAX_VALUE},d=this.tokenizerProvider.acquireTokenizer(u),f=await Fe.create(this.instantiationService,u,Ox,{documentContext:o,codeBlock:t,uri:r,markdownBeforeBlock:s,shouldTrimCodeBlocks:!0}).render(void 0,c),m=Array.isArray(o)?"```":AQ(o.document.getText()),h=Array.isArray(o)?fo(r).languageId:o.document.languageId,g=Array.isArray(o)?"":o.document.getText(),y=f.messages.reduce((K,$)=>{if($.role==="system"){let j=$.content.endsWith(`
`)?$.content:`${$.content}
`;return`${K}<SYSTEM>
${j}</SYSTEM>


`}return K+$.content},"")+`


The resulting document:
${m}${h}
`,b=d.tokenLength(y),_=d.tokenLength(g);if(b>64e3)return this.logService.internal.error("srequest | refuse | SD | exceeds token limit | [codeMapper]"),new ON;let x=Gt(),I=Date.now(),S=(K,$)=>{let j=$===-1?-1:$-I,D=Date.now()-I;this.logService.public.info(`srequest done: requestId: [${x}]`),this.logService.internal.info(`srequest | success | SD | ${D}ms | [codeMapper]`),this.telemetryService.sendMSFTTelemetryEvent("speculation.response.success",{requestId:x},{promptTokenCount:b,speculationTokenCount:_,responseTokenCount:d.tokenLength(K),timeToFirstToken:j,timeToComplete:D})},w=K=>{this.logService.public.error(`srequest failed: requestId: [${x}] error: [${K}]`),this.logService.internal.error(`srequest | error | SD | ${Date.now()-I}ms | [codeMapper]`),this.telemetryService.sendMSFTTelemetryEvent("speculation.response.error",{errorMessage:K,requestId:x},{promptTokenCount:b,speculationTokenCount:_})},R=await this.nesFetchService.fetchSpeculation(y,g,[m],x,c);if(Br.isFailure(R)){let K=cxe(x,R.errVal);return w(R.errVal),{edits:[],errorDetails:K,annotations:[]}}let k=[],V=-1,F=R.value.stream.map(K=>(V===-1&&(V=Date.now()),k.push(K.text),K.text));try{let K=Array.isArray(o)?void 0:o?.document;if(a)return await uxe(r,K,hXe(F,c),a,c),S(k.join(""),V),{edits:[],annotations:[]};{let $="";for await(let B of F)$+=B;let j=K?.getText().match(/\n*$/)?.[0]??"",D=$.trimEnd()+j,A=new Me(0,0,1073741824,1073741824);return S(k.join(""),V),{edits:[new $r(A,D)],annotations:[]}}}catch(K){let $=[{label:K.message,message:"request failed",severity:"error"}],j;return K instanceof z0?(K.type==="stop_content_filter"?j={message:vY("prompt"),responseIsFiltered:!0}:K.type==="stop_length"&&(j={message:x9.t("Sorry, the response hit the length limit. Please rephrase your prompt.")}),w(K.type)):w(K.message),j=j??{message:x9.t("Sorry, your request failed. Please try again. Request id: {0}",x)},{edits:[],errorDetails:j,annotations:$}}}};W0=E([v(0,_e),v(1,Et),v(2,be),v(3,H),v(4,Qn),v(5,oe),v(6,$0),v(7,fn),v(8,ge)],W0);function hXe(n,e){return new nr(async t=>{let r=new Xp(n[Symbol.asyncIterator]()),o=!1;for(;!r.endOfStream&&!e.isCancellationRequested;){let s=(await r.readLine()).replace(/\r$/g,"");o&&t.emitOne(new i0("")),s===""?o=!0:(o=!1,t.emitOne(new i0(s)))}})}var ON=class{};function gXe(n){let e=0;for(let t=n.lineCount-1;t>=0&&n.lineAt(t).text.trim()==="";t--)e++;return e}function vXe(n){let e=0;for(let t=n.length-1;t>=0&&n[t].trim()==="";t--)e++;return e}function dxe(n,e){if(n===void 0||e===void 0||n.length===e.length)return n===e;if(n.length>e.length)return n.startsWith(e)&&n.substring(e.length).match(/^\n*$/);if(n.length<e.length)return e.startsWith(n)&&e.substring(n.length).match(/^\n*$/)}function yXe(n){if(n){let e=[32,9,10,13],t=[10,13],r=n.length;for(;r>0&&e.includes(n.charCodeAt(r-1));)r--;let o=r;for(;o>0&&!t.includes(n.charCodeAt(o-1));)o--;if(o<r)return n.substring(o,r)}}var MJ=class{constructor(e,t){this.codeMapper=e;this.input=t;this.collectedEdits=[];this.cancellationTokenSource=new kve;let r={textEdit:(o,s)=>{this.responseStream?this.responseStream.textEdit(o,s):this.collectedEdits.push({target:o,edits:s})}};this.promise=this.codeMapper.mapCode(t,r,t.endpoint,this.cancellationTokenSource.token)}async getResult(e,t){if(t.isCancellationRequested){this.cancellationTokenSource.cancel();return}this.responseStream=e,this.collectedEdits.forEach(o=>e.textEdit(o.target,o.edits));let r=t.onCancellationRequested(()=>this.cancellationTokenSource.cancel());try{return await this.promise}finally{r.dispose()}}cancel(){this.cancellationTokenSource.cancel()}},cE=re("ICodeMapperService"),aE=class extends ye{constructor(t,r,o,s,a){super();this.instantiationService=t;this._tabsAndEditorsService=r;this._workspaceService=o;this._fileSystemService=s;this._logService=a;this.cachedCodeMapperRequests=new kn;this.codeMapper=this.instantiationService.createInstance(W0),this._workspaceService.onDidChangeTextDocument(c=>{let l=c.document.uri,u=this.cachedCodeMapperRequests.get(l);if(u){for(let d of u)d.cancel();this.cachedCodeMapperRequests.delete(l),this._logDebug(`clear cache: ${l}`)}})}async triggerComputation(t,r){let o=await this._getDocumentContextForCodeBlock(t);if(!o)return;let s=this.cachedCodeMapperRequests.get(t.resource);s||(s=[],this.cachedCodeMapperRequests.set(t.resource,s)),this._logDebug(`trigger request: ${t.resource.path}`);let a=new Mx(t.code,t.resource,t.markdownBeforeBlock,o,r);s.push(new MJ(this.codeMapper,a))}async _mapCodeBlock(t,r,o){let s=this.cachedCodeMapperRequests.get(t.uri);if(s){let a=s.find(c=>c.input.isEqualTo(t));if(a)return this._logDebug(`using cached request: ${t.uri.path}`),s.splice(s.indexOf(a),1),a.getResult(r,o)}return this._logDebug(`new request: ${t.uri.path}`),this.codeMapper.mapCode(t,r,t.endpoint,o)}async mapCode(t,r,o,s){let a=new kn,c=[];for(let l of t.codeBlocks){let u;if(a.has(l.resource)){this._logDebug("skipping code block because it is in the same document as a previous code block");continue}else u=this._getDocumentContextForCodeBlock(l),a.set(l.resource,u);let d=await u??t.workingSet?.map(f=>({document:f.document,range:f.range}));if(!d){r.textEdit(l.resource,new $r(new Me(0,0,0,0),l.code));continue}let p=new Mx(l.code,l.resource,l.markdownBeforeBlock,d,o);if(c.push(this._mapCodeBlock(p,r,s)),s.isCancellationRequested)return}return po(Promise.allSettled(c).then(l=>{let u=[],d=[];for(let f of l)if(f.status==="fulfilled"){let m=f.value;if(!m)return;u.push(...m.annotations),m.errorDetails&&d.push(m.errorDetails)}else d.push({message:f.reason.message});let p=d.length?d.reduce((f,m)=>({message:`${f.message}
${m.message}`,responseIsFiltered:f.responseIsFiltered||m.responseIsFiltered})):void 0;return{annotations:u,errorDetails:p}}),s)}_logDebug(t){this._logService.public.debug("[CodeMapperService] "+t)}async _getDocumentContextForCodeBlock(t){let r=this._tabsAndEditorsService.visibleTextEditors.find(a=>a.document.uri.toString()===t.resource.toString());if(r)return Ex.fromEditor(r);let o=this._workspaceService.textDocuments.find(a=>a.uri.toString()===t.resource.toString());if(o)return{document:Bt.create(o)};if(await this._fileSystemService.stat(t.resource).then(()=>!0,()=>!1))try{return{document:await this._workspaceService.openTextDocumentAndSnapshot(t.resource)}}catch{return}}};aE=E([v(0,H),v(1,$t),v(2,Be),v(3,gn),v(4,oe)],aE);var lE=class{constructor(e,t,r){this.instantiationService=e;this._tabsAndEditorsService=t;this._telemetryService=r;this.codeMapper=this.instantiationService.createInstance(W0)}async provideMappedEdits(e,t,r,o){let s=this._tabsAndEditorsService.visibleTextEditors.find(a=>th(a.document.uri,e.uri));if(s){let a=Ex.fromEditor(s),c=new Mx(t[0],e.uri,void 0,a,void 0),l=await this.codeMapper.mapCode(c,void 0,void 0,o);if(!l)return;if(this.reportTelemetry(l,a),!l.errorDetails){let u=new Z_;return u.set(e.uri,l.edits),u}throw new Error(l.errorDetails.message)}}reportTelemetry(e,t){if(!e.telemetry)return;let{endpoint:r,fetchResult:o,timeToComplete:s}=e.telemetry;if(this._telemetryService.sendMSFTTelemetryEvent("codemapper.request",{model:r.model,requestId:o.requestId,responseType:o.type,outcomeAnnotations:e.annotations?.map(a=>a.label).join(",")},{timeToComplete:s,editCount:e.edits.length}),e.edits.length){let a=this.instantiationService.createInstance(R0,t.document.getText());a.addEdits(e.edits);let c=this.instantiationService.createInstance(G0,a.getText(),t.document.document);(async()=>{try{let[l,u]=await Promise.all([a.getEdits(),c.compute()]),d=u.getEditsSinceInitial(),p={requestId:o.requestId,command:"codemapper"};this.instantiationService.createInstance(hf,t.document.document,a.initialText,l,d,H8(p,void 0))}finally{c.dispose()}})()}}};lE=E([v(0,H),v(1,$t),v(2,ge)],lE);var uE=class{constructor(e){this._codeMapperService=e}async provideMappedEdits(e,t,r){let o=await this._codeMapperService.mapCode(e,t,void 0,r);return o?.errorDetails?{errorMessage:o.errorDetails.message}:null}};uE=E([v(0,cE)],uE);var bXe="chatEditingEnabled",dE=class extends ye{constructor(e,t,r,o){super(),"registerMappedEditsProvider"in pE.chat&&this._register(pE.chat.registerMappedEditsProvider("*",e.createInstance(lE))),this._register(pE.chat.registerMappedEditsProvider2(e.createInstance(uE)));let s=Ki(this,r.onDidChangeConfiguration,()=>r.getExperimentBasedConfig(le.PanelEditingEnabled,o));this._register(Yl(a=>{let c=s.read(a);pE.commands.executeCommand("setContext",bXe,c)}))}};dE=E([v(0,H),v(1,it),v(2,be),v(3,fn)],dE);var qr=q(require("vscode"));var T9=re("IBlockedExtensionService"),I9=class{constructor(){this.blockedExtensions=new Map}reportBlockedExtension(e,t){this.blockedExtensions.has(e)&&clearTimeout(this.blockedExtensions.get(e));let r=setTimeout(()=>{this.blockedExtensions.delete(e)},t*1e3);this.blockedExtensions.set(e,r)}isExtensionBlocked(e){return this.blockedExtensions.has(e)}};var hu=q(Ve()),Nc=q(require("vscode"));var pxe=require("vscode"),MN=class extends hu.PromptElement{render(){let e=[],t=[];for(let r of this.props.messages)if(r.role===Nc.LanguageModelChatMessageRole.System)e.push(r.content.filter(o=>o instanceof Nc.LanguageModelTextPart).map(o=>o.value).join(""));else if(r.role===Nc.LanguageModelChatMessageRole.Assistant){let o=r.content.find(a=>a instanceof pxe.LanguageModelTextPart),s=r.content.filter(a=>a instanceof Nc.LanguageModelToolCallPart);t.push(vscpp(hu.AssistantMessage,{name:r.name,toolCalls:s.map(a=>({id:a.callId,type:"function",function:{name:a.name,arguments:JSON.stringify(a.parameters)}}))},o?.value))}else r.role===Nc.LanguageModelChatMessageRole.User&&r.content.forEach(o=>{o instanceof Nc.LanguageModelToolResultPart?t.push(vscpp(hu.ToolMessage,{toolCallId:o.callId},o.content.map(s=>{let a=s instanceof Nc.LanguageModelPromptTsxPart?vscpp("elementJSON",{data:s.value}):s instanceof Nc.LanguageModelTextPart?s.value:void 0;if(a)return vscpp(hu.TextChunk,null,a)}))):o instanceof Nc.LanguageModelTextPart&&t.push(vscpp(hu.UserMessage,{name:r.name},o.value))});return vscpp(vscppf,null,vscpp(hu.SystemMessage,null,this.props.noSafety?e:vscpp(vscppf,null,vscpp(Ze,null),vscpp(ii,null),vscpp("br",null),e.join(`
`))),t)}};var fE=class{constructor(e,t,r,o,s,a){this._logService=e;this._instantiationService=t;this._authenticationService=r;this._endpointProvider=o;this._embeddingsComputer=s;this._vsCodeExtensionContext=a;this.id="languageModelAccess";this._store=new _t;if(this._vsCodeExtensionContext.extensionMode===vl.Test){this._logService.public.warn("[LanguageModelAccess] LanguageModels and Embeddings are NOT AVAILABLE in test mode.");return}this.activationBlocker=Promise.all([this._registerLanguageModels(),this._registerEmbeddings()])}dispose(){this._store.dispose()}async _registerLanguageModels(){let e=new Map,t=async()=>{let o=await this._getAuthSession(),s=new Map,a=new Set;if(this._logService.public.debug("[LanguageModelAccess] UPDATING language models"),o){let c=await this._endpointProvider.getAllChatEndpoints(),l=await this._endpointProvider.getChatEndpoint("gpt-4");for(let u of c){if(this._store.isDisposed)break;if(a.has(u.family))continue;a.add(u.family);let d=e.get(u.model);if(d){s.set(u.model,d);continue}let p=await Fe.create(this._instantiationService,u,MN,{noSafety:!1,messages:[]}).countTokens(),f={vendor:"copilot",name:u.name,family:u.family,version:u.version,maxInputTokens:u.modelMaxPromptTokens-p-Eve,maxOutputTokens:4096/2,auth:o&&{label:o.account.label},isDefault:u.model===l.model,isUserSelectable:u.showInModelPicker||u.model==="copilot-preview-gpt4o-centralus"},m=this._instantiationService.createInstance(FN,u,f),h=qr.chat.registerChatResponseProvider(u.model,m,f);s.set(u.model,{endpoint:u,dispo:h}),this._logService.public.debug(`[LanguageModelAccess] ADDED language model ${u.model}`)}}for(let[c,l]of e)s.has(c)||(l.dispo.dispose(),this._logService.public.debug("[LanguageModelAccess] REMOVED language model "+c));e=s,this._store.isDisposed||(r=setTimeout(t,1e3*60*15))},r;await t(),this._store.add(this._authenticationService.onDidAuthenticationChange(()=>t())),this._store.add(zi(()=>{clearInterval(r);for(let o of e.values())o.dispo.dispose()}))}async _registerEmbeddings(){let e=this._store.add(new dv),t=async()=>{if(!await this._getAuthSession()){e.clear();return}let r=this._embeddingsComputer,o=await this._endpointProvider.getEmbeddingsEndpoint("text3small");e.clear(),e.value=qr.lm.registerEmbeddingsProvider(`copilot.${o.model}`,new class{async provideEmbeddings(s,a){let c=await r.computeEmbeddings(o,s,{parallelism:2},a);if(!c)throw new Error("Failed to compute embeddings");return c.embeddings.map(l=>({values:l.slice(0)}))}})};this._store.add(this._authenticationService.onDidAuthenticationChange(()=>t())),await t()}async _getAuthSession(){try{await this._authenticationService.getCopilotToken()}catch(t){this._logService.public.warn("[LanguageModelAccess] LanguageModel/Embeddings are not available without auth token"),this._logService.public.error(t);return}let e=this._authenticationService.anyGitHubSession;if(!e){this._logService.public.error("[LanguageModelAccess] Auth token not present when we expected it to be");return}return e}};fE=E([v(0,oe),v(1,H),v(2,xt),v(3,_e),v(4,_s),v(5,qt)],fE);var FN=class extends ye{constructor(t,r,o,s,a,c,l,u,d){super();this._endpoint=t;this._metadata=r;this._expService=o;this._telemetryService=s;this._chatMLFetcher=a;this._tokenizerProvider=c;this._blockedExtensionService=l;this._instantiationService=u;this._logService=d;this._onDidReceiveLanguageModelResponse2=this._register(new jt);this.onDidReceiveLanguageModelResponse2=this._onDidReceiveLanguageModelResponse2.event;this._register(this._chatMLFetcher.onDidMakeChatMLRequest(({model:p,source:f,tokenCount:m})=>{p===this._endpoint.model&&this._onDidReceiveLanguageModelResponse2.fire({extensionId:f?.extensionId??lh,tokenCount:m})}))}async _provideLanguageModelResponse(t,r,o,s,a){let c=qr.extensions.getExtension(o,!0);if(!c||typeof c.packageJSON.version!="string")throw new Error("Invalid extension information");let l=c.packageJSON.version,u=qr.l10n.t("The extension has been temporarily blocked due to making too many requests. Please try again later.");if(this._blockedExtensionService.isExtensionBlocked(o))throw qr.LanguageModelError.Blocked(u);let d=this._expService.getTreatmentVariable("vscode","copilotchat.languageModelControlList"),p=r.tools?this.countToolTokens(r.tools):0,f=(fxe.extractCustomTokenLimit(d??"",o)??this._metadata.maxInputTokens)-p;this.validateRequest(t),r.tools&&this.validateTools(r.tools);let{messages:m,tokenCount:h}=await Fe.create(this._instantiationService,{...this._endpoint,modelMaxPromptTokens:f},MN,{noSafety:!1,messages:t}).render();if(this._telemetryService.sendMSFTTelemetryEvent("languagemodelrequest",{extensionId:o,extensionVersion:l,model:this._endpoint.model},{tokenCount:h,tokenLimit:f}),m.length===0||h>f)throw new Error("Message exceeds token limit.");if(r.tools&&r.tools.length>128)throw new Error("Cannot have more than 128 tools per request.");let g=new Proxy(this._endpoint,{get:function(x,I,S){return I==="getExtraHeaders"?function(){return{...x.getExtraHeaders?.()??{},"x-onbehalf-extension-id":`${o}/${l}`}}:Reflect.get(x,I,S)}}),y=FJ.Default.convert(r.modelOptions??{}),b={messageSource:`api.${o}`};if(y.tools=r.tools?.map(x=>({type:"function",function:{name:x.name,description:x.description,parameters:x.parametersSchema}})),r.toolMode===qr.LanguageModelChatToolMode.Required&&r.tools?.length&&r.tools.length>1)throw new Error("LanguageModelChatToolMode.Required is not supported with more than one tool");y.tool_choice=r.toolMode===qr.LanguageModelChatToolMode.Required&&r.tools?.length?{type:"function",function:{name:r.tools[0].name}}:void 0;let _=await this._chatMLFetcher.fetchMany("copilotLanguageModelWrapper",m,s,a,5,g,{extensionId:o},y,b,{intent:!0});if(_.type!=="success")throw _.type==="extensionBlocked"?(this._blockedExtensionService.reportBlockedExtension(o,_.retryAfter),qr.LanguageModelError.Blocked(u)):new Error(_.reason);this._telemetryService.sendInternalMSFTTelemetryEvent("languagemodelrequest",{extensionId:o,extensionVersion:l,requestid:_.requestId,query:m[m.length-1].content,model:this._endpoint.model},{tokenCount:h,tokenLimit:f})}async provideLanguageModelResponse2(t,r,o,s,a){let c=async(l,u,d)=>{if(d.text&&s.report({index:u,part:new qr.LanguageModelTextPart(d.text)}),d.copilotFunctionCalls)for(let p of d.copilotFunctionCalls)try{let f=JSON.parse(p.arguments);s.report({index:u,part:new qr.LanguageModelToolCallPart(p.id,p.name,f)})}catch(f){throw this._logService.public.error(f,`Got invalid JSON for tool call: ${p.arguments}`),new Error("Invalid JSON for tool call")}};return this._provideLanguageModelResponse(t,r,o,c,a)}async provideLanguageModelResponse(t,r,o,s,a){let c=async(l,u,d)=>{s.report({index:u,part:d.text})};return this._provideLanguageModelResponse(t,{modelOptions:r},o,c,a)}async provideTokenCount(t){return typeof t=="string"?this._tokenizerProvider.acquireTokenizer(this._endpoint).tokenLength(t):this._tokenizerProvider.acquireTokenizer(this._endpoint).countMessageTokens(t)}validateTools(t){for(let r of t)if(!r.name.match(/^[\w-]+$/))throw new Error(`Invalid tool name "${r.name}": only alphanumeric characters, hyphens, and underscores are allowed.`)}countToolTokens(t){return this._tokenizerProvider.acquireTokenizer(this._endpoint).countToolTokens(t)}validateRequest(t){let r=t.at(-1);if(!r)throw new Error("Invalid request: no messages.");if(r.role===qr.LanguageModelChatMessageRole.User&&r.content.at(-1)instanceof qr.LanguageModelToolResultPart)throw new Error("Invalid request: the last message must be a User message without a tool result.");if(r.role!==qr.LanguageModelChatMessageRole.User)throw new Error("Invalid request: the last message must be a User message.");t.forEach((o,s)=>{if(o.role===qr.LanguageModelChatMessageRole.Assistant){let a=new Set(o.content.filter(u=>u instanceof qr.LanguageModelToolCallPart).map(u=>u.callId)),c=s+1,l="Invalid request: Tool call part must be followed by a User message with a LanguageModelToolResultPart with a matching callId.";for(;a.size>0;){let u=t.at(c++);if(!u||u.role!==qr.LanguageModelChatMessageRole.User)throw new Error(l);u.content.forEach(d=>{if(!(d instanceof qr.LanguageModelToolResultPart))throw new Error(l);a.delete(d.callId)})}}})}};FN=E([v(2,fn),v(3,ge),v(4,Et),v(5,Qn),v(6,T9),v(7,H),v(8,oe)],FN);var fxe;(e=>{function n(t,r){let o=t.indexOf(r);if(o<0)return;let s=o+r.length,a=t.indexOf(",",s);a<0&&(a=t.length);let c=Number(t.substring(s,a));if(!isNaN(c))return c*1e3}e.extractCustomTokenLimit=n})(fxe||={});function _Xe(...n){return e=>n.some(t=>t(e))}var FJ=class n{constructor(e){this._description=e}static{this._defaultDesc={stop:_Xe(TF,R2),temperature:D1,max_tokens:D1,frequency_penalty:D1,presence_penalty:D1}}static{this.Default=new n({...this._defaultDesc})}convert(e){let t={};for(let r in this._description){let o=this._description[r],s=e[r];s!=null&&o(s)&&(t[r]=s)}return t}};var _f=q(require("vscode"));var mE=class extends ye{constructor(e){super(),this._register(_f.commands.registerCommand("github.copilot.debug.workbenchState",async()=>{let t=await _f.window.showInputBox({prompt:"Enter a comma-separated list of symbol queries. Can be left blank if not using WorkspaceSymbols"}),r=await _f.window.showInputBox({prompt:"Enter a file name - .state.json will be appended as the extension",value:"workspaceState"});if(!r)return;let o=await e.createInstance(Fx).captureWorkspaceStateSnapshot(t?.split(",")??[]),s=_f.workspace.workspaceFolders?.[0].uri;if(!s)return;let a=_f.Uri.joinPath(s,`${r}.state.json`),c=JSON.stringify(o,null,2);c=c.replace(new RegExp(`${s.fsPath}/`,"g"),"./"),_f.workspace.fs.writeFile(a,Buffer.from(c))}))}};mE=E([v(0,H)],mE);var Fx=class{constructor(e,t,r,o,s,a,c){this.tabAndEditorsService=e;this.languageDiagnosticService=t;this.languageService=r;this.workspaceService=o;this.terminalService=s;this.debugOutputService=a;this.gitService=c}async captureWorkspaceStateSnapshot(e){let t=this.workspaceService.getWorkspaceFolders().map(d=>d.fsPath+"/"),r=this.workspaceService.notebookDocuments.map(d=>d.uri.fsPath),s=(await Promise.all(e.map(d=>this.languageService.getWorkspaceSymbols(d)))).flat().map(d=>({name:d.name,kind:d.kind,containerName:d.containerName,filePath:d.location.uri.fsPath,start:d.location.range.start,end:d.location.range.end})),a=this.tabAndEditorsService.activeTextEditor?this.languageDiagnosticService.getDiagnostics(this.tabAndEditorsService.activeTextEditor.document.uri).map(d=>({start:d.range.start,end:d.range.end,message:d.message,severity:d.severity,relatedInformation:d.relatedInformation?.map(xXe)})):[],c=this.tabAndEditorsService.activeTextEditor?{selections:this.tabAndEditorsService.activeTextEditor?.selections.map(d=>({anchor:d.anchor,active:d.active,isReversed:d.isReversed}))??[],documentFilePath:this.tabAndEditorsService.activeTextEditor?.document.uri.fsPath??"",visibleRanges:this.tabAndEditorsService.activeTextEditor?.visibleRanges.map(d=>({start:d.start,end:d.end}))??[],languageId:this.tabAndEditorsService.activeTextEditor?.document.languageId??"javascript"}:void 0,l=this.terminalService.terminalLastCommand?{commandLine:this.terminalService.terminalLastCommand.commandLine,cwd:typeof this.terminalService.terminalLastCommand.cwd=="object"?this.terminalService.terminalLastCommand.cwd.toString():this.terminalService.terminalLastCommand.cwd,exitCode:this.terminalService.terminalLastCommand.exitCode,output:this.terminalService.terminalLastCommand.output}:void 0;return{workspaceFoldersFilePaths:t,symbols:s,activeFileDiagnostics:a,activeTextEditor:c,debugConsoleOutput:this.debugOutputService.consoleOutput,terminalBuffer:this.terminalService.terminalBuffer,terminalLastCommand:l,terminalSelection:this.terminalService.terminalSelection,terminalShellType:this.terminalService.terminalShellType,repoContexts:this.gitService.repositories,notebookDocumentFilePaths:r,activeNotebookEditor:void 0}}};Fx=E([v(0,$t),v(1,Zo),v(2,Ts),v(3,Be),v(4,vi),v(5,QC),v(6,Ks)],Fx);function xXe(n){return{filePath:n.location.uri.fsPath,start:n.location.range.start,end:n.location.range.end,message:n.message}}var D9=q(require("path")),$N=q(require("util")),Qe=require("vscode");function hE(n,e){return{headerRequestId:n.headers.get("x-request-id")||"",completionId:e&&e.id?e.id:"",created:e&&e.created?e.created:0,serverExperiments:n.headers.get("X-Copilot-Experiment")||"",deploymentId:n.headers.get("azureml-model-deployment")||""}}function mxe(n){let e=n.headers.get("openai-processing-ms");return e?parseInt(e,10):0}function hxe(n){if(typeof n!="object"||n===null||!("details"in n))return!1;let{details:e}=n;return typeof e=="object"&&e!==null&&"type"in e&&"description"in e&&typeof e.type=="string"&&typeof e.description=="string"}function gxe(n){if(typeof n!="object"||n===null||!("citations"in n))return!1;let{citations:e}=n;return typeof e=="object"&&e!==null&&"url"in e&&"license"in e&&typeof e.url=="string"&&typeof e.license=="string"}function vxe(n){return typeof n=="object"&&!!n&&"title"in n&&"excerpt"in n&&"url"in n}var C9=class{constructor(){this.text=[];this.newText=[]}append(e){e.text&&(this.text.push(e.text),this.newText.push(e.text)),e.delta?.content&&(this.text.push(e.delta.content),this.newText.push(e.delta.content)),e.delta?.function_call&&(this.text.push(e.delta.function_call.arguments),this.newText.push(e.delta.function_call.arguments))}flush(){let e=this.newText.join("");return this.newText=[],e}},UJ=class{constructor(e){this.index=e;this.arguments=""}update(e){e.id&&(this.id=e.id),e.function?.name&&(this.name=e.function.name),e.function?.arguments&&(this.arguments+=e.function.arguments)}},BJ=class{constructor(){this.toolCalls=new Map}getToolCalls(){return Array.from(this.toolCalls.values()).map(e=>({name:e.name,arguments:e.arguments,id:e.id}))}hasToolCalls(){return this.toolCalls.size>0}update(e){e.delta?.tool_calls?.forEach(t=>{let r=this.toolCalls.get(t.index);r||(r=new UJ(t.index),this.toolCalls.set(t.index,r)),r.update(t)})}};function SXe(n){let e=n.split(`
`),t=e.pop();return[e.filter(r=>r!==""),t]}var E9=class n{constructor(e,t,r,o,s,a){this.logService=e;this.telemetryService=t;this.expectedNumChoices=r;this.response=o;this.body=s;this.cancellationToken=a;this.requestId=hE(this.response);this.stats=new qJ(this.expectedNumChoices);this.solutions={};this.completedFunctionCallIdxs=new Map;this.functionCalls={};this.toolCalls=new BJ;this.functionCallName=void 0}static async create(e,t,r,o,s){let a=await o.body();return a.setEncoding("utf8"),new n(e,t,r,o,a,s)}async*processSSE(e=async()=>{}){try{yield*this.processSSEInner(e)}finally{this.cancel(),this.logService.public.info(`request done: requestId: [${this.requestId.headerRequestId}] model deployment ID: [${this.requestId.deploymentId}]`),this.logService.internal.debug(`request stats: ${this.stats}`)}}async*processSSEInner(e){let t="",r=!1;e:for await(let o of this.body){if(this.maybeCancel("after awaiting body chunk"))return;let[s,a]=SXe(t+o.toString());t=a;let c=!1;for(let l of s){let u=l.slice(5).trim();if(u==="[DONE]"){yield*this.finishSolutions();return}let d;try{d=JSON.parse(u)}catch{this.logService.public.error(`Error parsing JSON stream data for request id ${this.requestId.headerRequestId}:${l}`),wh(this.telemetryService,`Error parsing JSON stream data for request id ${this.requestId.headerRequestId}:`,l);continue}if(d.copilot_confirmation&&IXe(d.copilot_confirmation)&&await e("",0,{text:"",copilotConfirmation:d.copilot_confirmation}),!d.choices){!d.copilot_references&&!d.copilot_confirmation&&(d.error!==void 0?(this.logService.public.error(`Error in response for request id ${this.requestId.headerRequestId}:${d.error.message}`),wh(this.telemetryService,`Error in response for request id ${this.requestId.headerRequestId}:`,d.error.message)):(this.logService.public.error(`Unexpected response with no choices or error for request id ${this.requestId.headerRequestId}`),wh(this.telemetryService,`Unexpected response with no choices or error for request id ${this.requestId.headerRequestId}`))),d.copilot_errors&&await e("",0,{text:"",copilotErrors:d.copilot_errors}),d.copilot_references&&await e("",0,{text:"",copilotReferences:d.copilot_references});continue}if(this.requestId.created===0&&(this.requestId=hE(this.response,d),this.requestId.created===0&&d.choices?.length&&(this.logService.public.error(`Request id invalid, should have "completionId" and "created": ${JSON.stringify(this.requestId)} ${this.requestId}`),wh(this.telemetryService,`Request id invalid, should have "completionId" and "created": ${JSON.stringify(this.requestId)}`,this.requestId))),this.allSolutionsDone())break e;for(let p=0;p<d.choices.length;p++){let f=d.choices[p],m={...f};delete m.index,delete m.content_filter_results,delete m.content_filter_offsets,this.logService.internal.trace("choice "+JSON.stringify(m)),this.stats.add(f.index),f.index in this.solutions||(this.solutions[f.index]=new C9);let h=this.solutions[f.index];if(h===null)continue;let g,y=async(_,x,I,S,w)=>(_&&(!Array.isArray(_)||!_.every(R=>hxe(R)))&&(_=void 0),x&&(!Array.isArray(x)||!x.every(gxe))&&(x=void 0),g=await e(h.text.join(""),f.index,{text:h.flush(),codeVulnAnnotations:_,ipCitations:x,copilotReferences:I,copilotFunctionCalls:S,copilotErrors:w}),g!==void 0&&(r=!0),this.maybeCancel("after awaiting finishedCb"));if(f.delta?.copilot_annotations?.CodeVulnerability||f.delta?.copilot_annotations?.IPCodeCitations){if(await y()||!r&&(h.append(f),await y(f.delta.copilot_annotations.CodeVulnerability,f.delta?.copilot_annotations?.IPCodeCitations)))continue}else if(f.delta?.role==="function"){if(f.delta.content)try{let _=JSON.parse(f.delta.content);if(Array.isArray(_)&&await y(void 0,void 0,_))continue}catch(_){this.logService.public.error(`Error parsing function references: ${JSON.stringify(_)}`)}}else if(f.delta?.function_call)c=!0,this.functionCallName??=f.delta.function_call.name,this.functionCalls[this.functionCallName]??=new C9,this.functionCalls[this.functionCallName].append(f);else if(f.delta?.tool_calls)c=!0,this.toolCalls.update(f);else if((f.finish_reason==="function_call"||f.finish_reason==="stop")&&this.functionCallName){let _=this.functionCalls[this.functionCallName],x={name:this.functionCallName,arguments:_.flush()};this.completedFunctionCallIdxs.set(f.index,"function");try{if(await y(void 0,void 0,void 0,[x]))continue}catch(I){this.logService.public.error(I)}this.functionCalls[this.functionCallName]=null,this.functionCallName=void 0;continue}else if((f.finish_reason==="tool_calls"||f.finish_reason==="stop")&&this.toolCalls.hasToolCalls()){let _=this.toolCalls.getToolCalls();this.completedFunctionCallIdxs.set(f.index,"tool");try{if(await y(void 0,void 0,void 0,_))continue}catch(x){this.logService.public.error(x)}continue}else if(h.append(f),await y())continue;if(f.finish_reason||g!==void 0){if(this.stats.markYielded(f.index),yield{solution:h,finishOffset:g,reason:f.finish_reason??"client-trimmed",filterReason:TXe(f),usage:d.usage,requestId:this.requestId,index:f.index},this.maybeCancel("after yielding finished choice"))return;c||(this.solutions[f.index]=null)}}}}for(let[o,s]of Object.entries(this.solutions)){let a=Number(o);if(s!==null&&(this.stats.markYielded(a),yield{solution:s,finishOffset:void 0,reason:"Iteration Done",requestId:this.requestId,index:a},this.maybeCancel("after yielding after iteration done")))return}if(t.length>0&&!r)try{let o=JSON.parse(t);o.error!==void 0&&(this.logService.public.error(o.error,`Error in response: ${o.error.message}`),wh(this.telemetryService,`Error in response: ${o.error.message}`,o.error))}catch{this.logService.public.error(`Error parsing extraData for request id ${this.requestId.headerRequestId}: ${t}`),wh(this.telemetryService,`Error parsing extraData for request id ${this.requestId.headerRequestId}: ${t}`)}}async*finishSolutions(){for(let[e,t]of Object.entries(this.solutions)){let r=Number(e);if(t!==null){if(this.completedFunctionCallIdxs.has(r)){yield{solution:t,finishOffset:void 0,reason:this.completedFunctionCallIdxs.get(r)==="function"?"function_call":"tool_calls",requestId:this.requestId,index:r};continue}if(this.stats.markYielded(r),yield{solution:t,finishOffset:void 0,reason:"DONE",requestId:this.requestId,index:r},this.maybeCancel("after yielding on DONE"))return}}}maybeCancel(e){return this.cancellationToken?.isCancellationRequested?(this.logService.public.debug("Cancelled: "+e),this.cancel(),!0):!1}cancel(){this.body.destroy()}allSolutionsDone(){let e=Object.values(this.solutions);return e.length===this.expectedNumChoices&&e.every(t=>t===null)}};function IXe(n){return typeof n.title=="string"&&typeof n.message=="string"&&!!n.confirmation}function yxe(n){return{text:n.text.join(""),tokens:n.text}}function TXe(n){if(n.finish_reason==="content_filter"){if(n.delta?.copilot_annotations?.TextCopyright)return"snippy";if(n.delta?.copilot_annotations?.Sexual||n.delta?.copilot_annotations?.SexualPattern)return"sexual";if(n.delta?.copilot_annotations?.Violence)return"violence";if(n.delta?.copilot_annotations?.HateSpeech||n.delta?.copilot_annotations?.HateSpeechPattern)return"hate";if(n.delta?.copilot_annotations?.SelfHarm)return"self_harm";if(n.delta?.copilot_annotations?.PromptPromBlockList)return"prompt";if(n.content_filter_results){for(let e of Object.keys(n.content_filter_results))if(n.content_filter_results[e]?.filtered)return e}}}var qJ=class{constructor(e){this.choices=new Map;for(let t=0;t<e;t++)this.choices.set(t,new UN)}add(e){let t=this.choices.get(e)??new UN;t.increment(),this.choices.set(e,t)}markYielded(e){let t=this.choices.get(e)??new UN;t.markYielded(),this.choices.set(e,t)}toString(){return Array.from(this.choices.entries()).map(([e,t])=>`${e}: ${t.yieldedTokens} -> ${t.seenTokens}`).join(", ")}},UN=class{constructor(){this.yieldedTokens=-1;this.seenTokens=0}increment(){this.seenTokens++}markYielded(){this.yieldedTokens=this.seenTokens}};function wh(n,e,t){let r=[e,t],o=r.length>0?JSON.stringify(r):"no msg",s=mi.createAndMarkAsIssued({context:"fetch",level:WF[5],message:o});n.sendRestrictedGHTelemetryErrorEvent("log",s.properties,s.measurements);let a=mi.createAndMarkAsIssued({context:"fetch",level:WF[5],message:"[redacted]"});n.sendGHTelemetryErrorEvent("log",a.properties,a.measurements)}function HJ(n,e,t){let r=t.extendedBy({messagesJson:JSON.stringify(e)});n.sendRestrictedGHTelemetryEvent("engine.messages",r.properties,r.measurements)}function CXe(n,e,t,r,o,s,a,c,l,u){return HJ(n,[e],u),{message:e,choiceIndex:r,requestId:o,blockFinished:s,finishReason:c,filterReason:l,tokens:t.tokens,usage:{prompt_tokens:a?.prompt_tokens??0,completion_tokens:a?.completion_tokens??0,total_tokens:a?.total_tokens??t.tokens.length},telemetryData:u}}function bxe(n,e,t,r){let o=t.solution.text.join(""),s=!1;t.finishOffset!==void 0&&(e.internal.debug(`message ${t.index}: early finish at offset ${t.finishOffset}`),o=o.substring(0,t.finishOffset),s=!0),e.public.info(`message ${t.index} returned. finish reason: [${t.reason}]`),e.internal.debug(`message ${t.index} details: finishOffset: [${t.finishOffset}] completionId: [{${t.requestId.completionId}}] created: [{${t.requestId.created}}]`);let a=yxe(t.solution),c={role:"assistant",content:o};return CXe(n,c,a,t.index,t.requestId,s,t.usage,t.reason,t.filterReason,r)}function _xe(n,e,t,r){let s=n.copilotToken?.isInternal??!1?e.getConfig(le.DebugOverrideChatMaxTokenNum):0,a=-3;if(s>0)return a+=s,a;let c={};try{let l=t.getTreatmentVariable("vscode","copilotchat.contextWindows");c=JSON.parse(l??"{}")}catch{}if(c[r.id])return a+=c[r.id],a;if(r.capabilities?.limits?.max_prompt_tokens)return a+=r.capabilities.limits.max_prompt_tokens,a;switch(r.id){case"gpt-4o-2024-05-13":a+=3072;break;default:a+=3072}return a}async function EXe(n,e,t,r,o,s,a){let l=(await E9.create(e,n,r,t,a)).processSSE(o);return nr.map(l,d=>{let p=d.reason??"client-trimmed",f=s.extendedBy({completionChoiceFinishReason:p,headerRequestId:d.requestId.headerRequestId});return n.sendGHTelemetryEvent("completion.finishReason",f.properties,f.measurements),bxe(n,e,d,s)})}var K0=class{constructor(e,t=!1,r=void 0,o,s,a,c,l){this._disableSnippy=t;this._urlOverride=r;this._domainService=o;this._fetcherService=s;this._envService=a;this._telemetryService=c;this._authService=l;this._maxTokens=e.capabilities.limits?.max_prompt_tokens??8192,this._maxOutputTokens=e.capabilities.limits?.max_output_tokens??4096,this.model=e.id,this.name=e.name,this.version=e.version,this.family=e.capabilities.family,this.tokenizer=e.capabilities.tokenizer,this.showInModelPicker=e.model_picker_enabled,this._policyDetails=e.policy}get modelMaxPromptTokens(){return this._maxTokens}get maxOutputTokens(){return this._maxOutputTokens}get url(){return this._urlOverride??this._domainService.capiChatURL}get policy(){return!this._policyDetails||this._policyDetails.state==="enabled"?"enabled":{terms:this._policyDetails.terms??"Unknown policy terms"}}interceptBody(e){if(e&&this._disableSnippy&&(e.snippy={enabled:!1},Object.keys(e).forEach(t=>{t.startsWith("intent")&&delete e[t]})),e&&(this.family.startsWith("o1")||this.model==="o1-preview"||this.model==="o1-mini")){let t=e.messages.map(r=>r.role==="system"?{role:"user",content:r.content}:r);Object.keys(e).forEach(r=>{delete e[r]}),e.messages=t,e.model=this.model,e.stream=!1}}getExtraHeaders(){let e={};return this._disableSnippy&&(e["Editor-Plugin-Version"]="simulation-tests-plugin/2",e["Editor-Version"]="simulation-tests-editor/1.85"),e}async processResponseFromChatEndpoint(e,t,r,o,s,a,c){if(this.family.startsWith("o1")||this.model==="o1-preview"||this.model==="o1-mini"){let l=await r.json(),u=l.choices[0].message,d=r.headers.get("X-Request-ID")??Gt(),p={blockFinished:!1,choiceIndex:0,filterReason:void 0,finishReason:"stop",message:u,usage:l.usage,tokens:u.content.split(" "),requestId:{headerRequestId:d,completionId:l.id,created:l.created,deploymentId:"",serverExperiments:""},telemetryData:a};return await s(u.content,0,{text:u.content}),nr.fromArray([p])}else return EXe(e,t,r,o,s,a,c)}async acceptChatPolicy(){if(this.policy==="enabled")return!0;try{let e=await cf(this._fetcherService,this._envService,this._telemetryService,this._domainService,`${this._domainService.capiModelsURL}/${this.model}/policy`,(await this._authService.getCopilotToken()).token,await ja(process.env.HMAC_SECRET),void 0,Gt(),{state:"enabled"});return e.ok&&this._policyDetails&&(this._policyDetails.state="enabled"),e.ok}catch{return!1}}};K0=E([v(3,xn),v(4,hn),v(5,it),v(6,ge),v(7,xt)],K0);var w9=re("IPromptVariablesService");var Vd=q(require("vscode"));var $J=q(ht()),k9=q(Ve());var xxe=q(ht()),Li=q(Ve());var VJ=class{constructor(){this.codeblockUris=new _1;this.codeblockCount=0;this.codeblockWithUriCount=0;this.codeblockWithElidedCodeCount=0;this.shellCodeblockCount=0;this.shellCodeblockWithUriCount=0;this.shellCodeblockWithElidedCodeCount=0}},qN=class{constructor(e,t,r){this.previousStep=e;this._workspaceService=r;this.editStepId=Gt();this._userMessage="";this._assistantReply="";this.telemetryInfo=new VJ;this._workingSet=t}static async create(e,t,r,o){return e.createInstance(BN,t).createNextStep(r,o)}get languageId(){if(this.workingSet.length>0)return this.workingSet[this.workingSet.length-1].document.languageId}get userMessage(){return this._userMessage}get assistantReply(){return this._assistantReply}get workingSet(){return this._workingSet}setUserMessage(e){this._userMessage=e.content}setAssistantReply(e){this._assistantReply=e}setWorkingSetEntryState(e,t){for(let r of this._workingSet)if(r.document.uri.toString()===e.toString()){let o=typeof t=="object"?this._getUpdatedState(r,t.accepted,t.hasRemainingEdits):t;r.state=o}}createUriFromResponsePath(e){try{let o=zt.parse(e);if(o.scheme==="untitled")return o}catch{}for(let o of this._workingSet)if(o.document.uri.path===e)return o.document.uri;let t=this._getPredominantScheme(),r=t==="file"?zt.file(e):zt.from({scheme:t,path:e});if(this._workspaceService.getWorkspaceFolder(r))return r}_getPredominantScheme(){let e=new Map;for(let o of this._workingSet){let s=o.document.uri.scheme;e.set(s,(e.get(s)??0)+1)}let t=0,r="";for(let[o,s]of e)s>t&&(t=s,r=o);return r}_getUpdatedState(e,t,r){let{state:o}=e;return o===2||o===3?o:t&&!r?2:!t&&!r?3:1}},BN=class{constructor(e,t){this._prevStep=e;this._workspaceService=t}async createNextStep(e,t){let r=(u,d)=>u?.find(p=>p.document.uri.toString()===d.toString()),o=[],s=u=>r(o,u),a=u=>{let d=s(u);if(d)return d.state;let p=r(this._prevStep?.workingSet,u);if(p)return p.state},c=u=>{!u||s(u.document.uri)||o.push(u)};t=t.reverse();for(let u of t){if(u.value instanceof zt){let d=a(u.value);c(await this._resolveWorkingSetEntry({uri:u.value,state:d}))}if(u.value instanceof ar){let d=a(u.value.uri);c(await this._resolveWorkingSetEntry({uri:u.value.uri,range:u.value.range,renderSelection:!0,state:d}))}}let l=t.filter(u=>!(u.value instanceof zt||u.value instanceof ar));return{editCodeStep:new qN(this._prevStep,o,this._workspaceService),chatVariables:l}}async _resolveWorkingSetEntry(e){try{let t=await this._workspaceService.openTextDocumentAndSnapshot(e.uri);return{state:e.state??0,document:t,range:e.range,renderSelection:e.renderSelection}}catch{return null}}};BN=E([v(1,Be)],BN);var gE=class extends Li.PromptElement{constructor(t,r,o){super(t);this.configurationService=r;this.expService=o}async render(t,r){let o=this.configurationService.getExperimentBasedConfig(le.EditUseOldPrompt,this.expService),s=M6(this.props.endpoint.family),a=this.props.editCodeStep.workingSet.length>0,c=vscpp(Tt,{priority:900},a&&vscpp(vscppf,null,"The user has a request for modifying one or more files.",vscpp("br",null),"1. Please come up with a solution that you first describe step-by-step.",vscpp("br",null),"2. Group your changes by file. Use the file name as the header.",vscpp("br",null),"3. For each file, give a short summary of what needs to be changed followed by a code block that contains the code changes.",vscpp("br",null),"4. Each code block starts with a comment containing the filepath.",vscpp("br",null),o&&vscpp(vscppf,null,"5. Use one code block per file that needs to be modified. Avoid repeating the entire file contents in the code blocks. Use `",_9.forLanguage(this.props.editCodeStep.languageId),"` comments to represent regions of unchanged code.",vscpp("br",null)),!o&&vscpp(vscppf,null,"5. Use a single code block per file that needs to be modified, even if there are multiple changes for a file.",vscpp("br",null),"6. The user is very smart and can understand how to merge your code blocks into their files, you just need to provide minimal hints.",vscpp("br",null),"7. Avoid repeating existing code, instead use comments to represent regions of unchanged code. The user prefers that you are as concise as possible. For example: ",vscpp("br",null),["```languageId","// filepath: /path/to/file","// ...existing code...","{ changed code }","// ...existing code...","{ changed code }","// ...existing code...","```"].join(`
`),vscpp("br",null),vscpp("br",null))),!a&&vscpp(vscppf,null,"1. If the user asks a question, then answer it.",vscpp("br",null),'2. If you need to change existing files, then refuse and answer with "Please add the files to be modified to the working set".',vscpp("br",null),"3. The only exception is if you need to create new files. In that case create a code block for each file and make sure each code block starts with a comment containing the filepath.",vscpp("br",null)),vscpp(kt,null),"Here is an example of how you should format a code block belonging to the file example.ts in your response:",vscpp("br",null),vscpp(Rt,{name:"example"},["### [example.ts](file:///Users/someone/proj01/example.ts)","","Add a new property 'age' and a new method 'getAge' to the class Person.","","```typescript","// filepath: /Users/someone/proj01/example.ts","class Person {","	// ...existing code...","	age: number;","	// ...existing code...","	getAge() {","		return this.age;","	}","}","```"].join(`
`)));return vscpp(vscppf,null,vscpp(Li.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),vscpp(vn,null),vscpp(Ze,null)),s?void 0:c,vscpp(GJ,{flexGrow:1,priority:700,editCodeStep:this.props.editCodeStep}),s?c:void 0,vscpp(jN,{flexGrow:2,priority:900,...this.props}))}};gE=E([v(1,be),v(2,fn)],gE);var GJ=class extends Li.PromptElement{async render(e,t){let r=new kn;for(let a of this.props.editCodeStep.workingSet)r.set(a.document.uri,[a.document.version]);let o=[],s=this.props.editCodeStep.previousStep;for(;s;)o.push(vscpp(Li.AssistantMessage,null,s.assistantReply)),o.push(this._renderUserMessageWithoutFiles(s,r)),s=s.previousStep;return o.reverse(),vscpp(Li.PrioritizedList,{priority:this.props.priority,descending:!1},o)}_renderUserMessageWithoutFiles(e,t){let r=[];for(let s of e.workingSet){let a=t.get(s.document.uri)??[];a.some(l=>l===s.document.version)?r.push(s):(a.push(s.document.version),t.set(s.document.uri,a))}let o=this._removeFilesFromPastUserMessage(e.userMessage,r);return vscpp(Li.UserMessage,null,o)}_removeFilesFromPastUserMessage(e,t){let r=t.map(o=>`${$v} ${o.document.uri.path}`);return e.replace(/<file(-selection)?>[\s\S]*?<\/file(-selection)?>/g,o=>r.some(s=>o.includes(s))?"":o)}},jN=class extends Li.PromptElement{constructor(t,r,o){super(t);this.experimentationService=r;this._configurationService=o}async render(t,r){let{query:o,chatVariables:s}=this.props.promptContext,a=this.props.editCodeStep.workingSet,c=this._configurationService.getExperimentBasedConfig(le.ProjectLabelsChat,this.experimentationService),l=this._configurationService.getExperimentBasedConfig(le.EditRemindNoCodeDuplication,this.experimentationService),u=s.filter(d=>d.value instanceof zt||d.value instanceof ar).hasVariables()||a.length>0;return vscpp(vscppf,null,vscpp(Li.UserMessage,null,c&&vscpp(Xi,{flexGrow:1,priority:600,embeddedInsideUserMessage:!0}),vscpp(sn,{flexGrow:6,priority:750,languageId:void 0}),vscpp(kc,{flexGrow:5,priority:650,includeFilePaths:!0,context:a.map(d=>d.document)}),vscpp(tn,{flexGrow:4,priority:898,embeddedInsideUserMessage:!0,endpoint:this.props.endpoint,promptContext:this.props.promptContext,documentContext:this.props.documentContext}),vscpp(Ai,{flexGrow:3,priority:898,embeddedInsideUserMessage:!0,chatVariables:s}),!u&&vscpp(vscppf,null,vscpp(HN,{flexGrow:2,priority:899}),vscpp("br",null)),vscpp(zJ,{flexGrow:3,flexReserve:r.tokenBudget*.8,priority:810,workingSet:a}),vscpp("br",null),l&&vscpp(vscppf,null,"<reminder>",vscpp("br",null),"Avoid repeating existing code, instead use `",_9.forLanguage(this.props.editCodeStep.languageId),"` comments to represent regions of unchanged code.",vscpp("br",null),"</reminder>",vscpp("br",null)),"<prompt>",vscpp("br",null),vscpp(Oo,{flexGrow:7,priority:900,chatVariables:s,query:o}),vscpp("br",null),"</prompt>"))}};jN=E([v(1,fn),v(2,be)],jN);var zJ=class extends Li.PromptElement{render(e,t){let r=this.props.workingSet;return vscpp(vscppf,null,r.map((o,s)=>vscpp(VN,{entry:o,flexGrow:s})))}},HN=class extends Li.PromptElement{constructor(t,r){super(t);this._workspaceService=r}render(t,r){let o=this._workspaceService.getWorkspaceFolders();return o.length===1?vscpp(vscppf,null,"I currently have the following folder open: ",o[0].toString(),"."):vscpp(vscppf,null,"I currently have the following folders open: ",o.map(s=>s.toString()).join(", "),".")}};HN=E([v(1,Be)],HN);var VN=class extends Li.PromptElement{constructor(t,r,o){super(t);this._ignoreService=r;this.instantiationService=o}async render(t,r){let{document:o,range:s,renderSelection:a,state:c}=this.props.entry;if(await this._ignoreService.isCopilotIgnored(o.uri))return vscpp("ignoredFiles",{value:[o.uri]});let d=await this.instantiationService.createInstance(Jp).summarizeDocument(o,void 0,s,r.tokenBudget,{costFnOverride:QQ}),p=d.isOriginal?void 0:{status:{description:xxe.t("Part of this file was not sent to the model due to context window limitations. Try attaching specific selections from your file instead."),kind:2}},f="";return c===2?f="I applied your suggestions for this file and accepted them. Here is the updated file:":c===3?f="I considered your suggestions for this file but rejected them. Here is the file:":c===1&&(f="I applied your suggestions for this file but haven't decided yet if I accept or reject them. Here is the updated file:"),vscpp(Do,{priority:this.props.priority},vscpp(Li.Chunk,{priority:2},"<file>",f&&vscpp(vscppf,null,vscpp("br",null),"<status>",f,"</status>",vscpp("br",null)),vscpp(tt,{includeFilepath:!0,languageId:o.languageId,uri:o.uri,references:[new Li.PromptReference(o.uri,void 0,p)],code:d.text}),vscpp("br",null),"</file>"),a&&vscpp(GN,{document:o,selection:s,priority:1}))}};VN=E([v(1,Te),v(2,H)],VN);var GN=class extends Li.PromptElement{constructor(t,r){super(t);this._ignoreService=r}async render(t,r){let{document:o,selection:s}=this.props;if(!o||!s)return;if(await this._ignoreService.isCopilotIgnored(o.uri))return vscpp("ignoredFiles",{value:[o.uri]});if(o.lineCount>=4){let c=[],l=()=>c.reduce((m,h)=>m+h.length,0),u=Math.max(0,s.start.line),d=Math.min(o.lineCount-1,s.end.line);d>u&&s.end.character===0&&d--,u<d&&s.start.character===o.lineAt(u).text.length&&u++;for(let m=u;m<=d;m++){let h=o.lineAt(m);c.push(h.text)}let p=u-1,f=d+1;for(;c.length<4&&l()<10;)p>=0&&(c.unshift(o.lineAt(p).text),p--),f<o.lineCount&&(c.push(o.lineAt(f).text),f++);return vscpp(Li.Chunk,null,"<file-selection>",vscpp(tt,{includeFilepath:!0,languageId:o.languageId,uri:o.uri,references:[new Li.PromptReference(o.uri,void 0)],code:c.join(`
`),shouldTrim:!1}),vscpp("br",null),"</file-selection>")}else return}};GN=E([v(1,Te)],GN);var kh=class{constructor(e,t,r,o){this.instantiationService=e;this.endpointProvider=t;this.experimentationService=r;this.configurationService=o;this.id=kh.ID;this.description=$J.t("Make changes to existing code");this.locations=[1,2,3];this.requestHandler=zN;this._panelInvocations=[]}static{this.ID="edit"}get intentDetectionInput(){let e="edit_text";return{functionName:e,sampleQuestion:"Change this method to use async/await",modelDescription:"Make changes to existing code",functionCallingBlurb:`If the user's message appears related to refactoring or changing existing code, such as the code in the active selection, you should use the '${e}' function.`}}get commandInfo(){return{hiddenFromUser:!this.configurationService.getExperimentBasedConfig(le.PanelEditingEnabled,this.experimentationService)}}async invoke(e){let{location:t,documentContext:r,request:o}=e,s=await this.endpointProvider.getChatEndpoint(o);if(t===2||t===3)return this.instantiationService.createInstance(xf,this,t,s,r);if(!r)throw new Error("Open a file to add code.");return this.instantiationService.createInstance(df,this,t,s,r,2)}requestInvocation(e){if(e!==2&&e!==3)return{canInvoke:!0};let{count:t,periodMs:r}=this._getRateLimit(),o=Date.now(),s=o-r;for(;this._panelInvocations.length>0&&this._panelInvocations[0]<s;)this._panelInvocations.shift();return this._panelInvocations.length<t?(this._panelInvocations.push(o),{canInvoke:!0}):{canInvoke:!1,waitMs:this._panelInvocations[0]-s}}_getRateLimit(){let e=this.configurationService.getExperimentBasedConfig(le.EditIntentRateLimit,this.experimentationService);(!e||!/^(\d+)\/(\d+)$/.test(e))&&(e=gK);let[,t,r]=e.match(/^(\d+)\/(\d+)$/);return{count:parseInt(t,10),periodMs:parseInt(r,10)*1e3}}};kh=E([v(0,H),v(1,_e),v(2,fn),v(3,be)],kh);var zN=class{constructor(e,t,r,o,s,a,c,l,u,d,p,f){this.intent=e;this.sessionId=t;this.conversation=r;this.request=o;this.stream=s;this.token=a;this.documentContext=c;this.agentName=l;this.location=u;this.chatTelemetry=d;this.instantiationService=p;this.telemetryService=f}async getResult(){if(this.intent instanceof kh){let a=this.intent.requestInvocation(this.location);if(!a.canInvoke){this.telemetryService.sendMSFTTelemetryEvent("panel.edit.ratelimited",{conversationId:this.sessionId},{waitMs:a.waitMs,turns:this.conversation.turns.length});let c=a.waitMs;return{errorDetails:{message:$J.t("Sorry, your request was rate-limited. Please wait {0} before trying again.",O5(Math.ceil(c/1e3))),responseIsFiltered:!0}}}}let t=await this.instantiationService.createInstance(ff,this.intent,this.sessionId,this.conversation,this.request,this.stream,this.token,this.documentContext,this.agentName,this.location,this.chatTelemetry).getResult(),r=this.conversation.getLatestTurn(),o=r?.intentInvocation,s=o instanceof xf?o._editCodeStep:void 0;return r&&s?.telemetryInfo&&this.telemetryService.sendMSFTTelemetryEvent("panel.edit.codeblocks",{conversationId:r.sessionId,outcome:t.errorDetails?"error":"success"},{workingSetCount:s.workingSet.length,uniqueCodeblockUriCount:s.telemetryInfo.codeblockUris.size,codeblockCount:s.telemetryInfo.codeblockCount,codeblockWithUriCount:s.telemetryInfo.codeblockWithUriCount,codeblockWithElidedCodeCount:s.telemetryInfo.codeblockWithElidedCodeCount,shellCodeblockCount:s.telemetryInfo.shellCodeblockCount,shellCodeblockWithUriCount:s.telemetryInfo.shellCodeblockWithUriCount,shellCodeblockWithElidedCodeCount:s.telemetryInfo.shellCodeblockWithElidedCodeCount,editStepCount:this.conversation.turns.length,sessionDuration:Date.now()-this.conversation.turns[0].startTime}),t}};zN=E([v(10,H),v(11,ge)],zN);var xf=class{constructor(e,t,r,o,s,a,c){this.intent=e;this.location=t;this.endpoint=r;this.documentContext=o;this.instantiationService=s;this.codeMapperService=a;this.envService=c;this._editCodeStep=void 0;this.linkification={disable:!0}}async buildPrompt(e,t,r){let o=this._getPreviousEditCodeStep(e.history)??null,{editCodeStep:s,chatVariables:a}=await qN.create(this.instantiationService,o,this.documentContext,e.chatVariables);this._editCodeStep=s;let l=await Fe.create(this.instantiationService,this.endpoint,gE,{editCodeStep:s,endpoint:this.endpoint,promptContext:{...e,chatVariables:a}}).render(t,r),u=l.messages[l.messages.length-1];return u.role===k9.ChatRole.User&&this._editCodeStep.setUserMessage(u),{...l,references:l.references.filter(d=>this.shouldKeepReference(s,d))}}shouldKeepReference(e,t){if(t.options?.status&&t.options?.status?.kind!==k9.ChatResponseReferencePartStatusKind.Complete)return!0;let r=kXe(t);return!r||!e.workingSet.find(s=>s.document.uri.toString()===r.toString())}setWorkingSetEntryState(e,t){this._editCodeStep?.setWorkingSetEntryState(e,t)}_getPreviousEditCodeStep(e){let r=(e.length>0?e[e.length-1]:void 0)?.intentInvocation;return r instanceof xf?r._editCodeStep:void 0}async processResponse(e,t,r,o){Vs(this._editCodeStep);let s=[],a=[],c="```",l=!!this.envService.remoteName,u="### [",d=/^(`+)([^ \n]*)/,p=nr.map(t,g=>g.delta.text).map(g=>(a.push(g),g)),f=new Xp(p[Symbol.asyncIterator]()),m=[];for(;!f.endOfStream;){for(;!f.endOfStream;){let F=await f.peek(Math.max(c.length,u.length));if(F.startsWith(c))break;if(l&&F.startsWith(u)){let K=await f.readLine();m.push(K+`
`);let $=K.replace(/\[([^\]]*)\]\([^)]*\)/g,"$1");r.markdown($+`
`)}else await Ixe(f,r,m)}if(f.endOfStream)break;let g=await f.readLineIncludingLF();r.markdown(g);let y=g.match(d),b=y?y[1]:c,_=y?y[2]:void 0,x=Rr(_),I=[`${x.lineComment.start} ${$v}`,`// ${$v}`,`# ${$v}`],S=Math.max(...I.map(F=>F.length)),w=x.lineComment.end??"",R,k=[];for(;!f.endOfStream;){let F=await f.peek(Math.max(b.length,S));if(F.startsWith(b))break;if(!R&&I.some(K=>F.startsWith(K))){let K=await f.readLineIncludingLF(),$=I.reduce((j,D)=>F.startsWith(D)?K.substring(D.length):j,K);$=$.trim(),$.endsWith(w)&&($=$.substring(0,$.length-w.length)),$=$.trim(),R=this._editCodeStep.createUriFromResponsePath($),R&&(r.codeblockUri(R),this._editCodeStep.telemetryInfo.codeblockUris.add(R),this._editCodeStep.telemetryInfo.codeblockWithUriCount+=1,_==="sh"&&(this._editCodeStep.telemetryInfo.shellCodeblockWithUriCount+=1),this._editCodeStep.setWorkingSetEntryState(R,1));continue}await Ixe(f,r,k)}if(R){let F=k.join("");F.includes("...existing code...")&&(this._editCodeStep.telemetryInfo.codeblockWithElidedCodeCount+=1,_==="sh"&&(this._editCodeStep.telemetryInfo.shellCodeblockWithElidedCodeCount+=1));let K={workingSet:[...this._editCodeStep.workingSet],codeBlocks:[{resource:R,code:F,markdownBeforeBlock:m.join("")}],conversation:void 0},$=this.codeMapperService.mapCode(K,r,this.endpoint,o);s.push($)}if(f.endOfStream)break;let V=await f.readLineIncludingLF();r.markdown(V),this._editCodeStep.telemetryInfo.codeblockCount+=1,_==="sh"&&(this._editCodeStep.telemetryInfo.shellCodeblockCount+=1),m.length=0}let h=await Promise.all(s);for(let g of h)g?e.addAnnotations(g.annotations):e.addAnnotations([{severity:"error",label:"cancelled",message:"CodeMapper cancelled"}]);for(let g of h)if(g&&g.errorDetails)return{errorDetails:g.errorDetails};return this._editCodeStep.setAssistantReply(a.join("")),{metadata:{applyEditsId:this._editCodeStep.editStepId}}}};xf=E([v(4,H),v(5,cE),v(6,it)],xf);function kXe(n){return"variableName"in n.anchor?Sxe(n.anchor.value):Sxe(n.anchor)}function Sxe(n){return jp(n)?n.uri:n}async function Ixe(n,e,t){for(;!n.endOfStream;){let r=n.readImmediateExcept(`
`);if(r.length>0&&(e.markdown(r),t?.push(r)),await n.peek(1)===`
`){n.readImmediate(1),e.markdown(`
`),t?.push(`
`);break}}}var R9=re("IFeedbackReporter"),WJ=class{async reportInline(e,t,r){}async reportChat(e){}},Nbn=new WJ;var yE=re("IUserFeedbackService"),vE=class{constructor(e,t,r,o,s,a){this.telemetryService=e;this.conversationStore=t;this.feedbackReporter=r;this.surveyService=o;this.languageDiagnosticsService=s;this.instantiationService=a}handleUserAction(e,t){let r=Vd.window.activeTextEditor?.document,o=Vd.window.activeTextEditor?.selection,s=e.result,a=s.metadata?.responseId&&this.conversationStore.getConversation(s.metadata.responseId);if(typeof a=="object"&&a.getLatestTurn()?.intentInvocation?.location===1){this._handleInlineChatUserAction(s.metadata?.sessionId,t,a,e,void 0);return}switch(e.action.kind){case"copy":this.telemetryService.sendMSFTTelemetryEvent("panel.action.copy",{languageId:r?.languageId,requestId:s.metadata?.responseId,participant:t,command:s.metadata?.command},{codeBlockIndex:e.action.codeBlockIndex,copyType:e.action.copyKind,characterCount:e.action.copiedCharacters,lineCount:e.action.copiedText.split(`
`).length});break;case"insert":this.telemetryService.sendMSFTTelemetryEvent("panel.action.insert",{languageId:r?.languageId,requestId:s.metadata?.responseId,participant:t,command:s.metadata?.command},{codeBlockIndex:e.action.codeBlockIndex,characterCount:e.action.totalCharacters,newFile:e.action.newFile?1:0});break;case"runInTerminal":this.telemetryService.sendMSFTTelemetryEvent("panel.action.runinterminal",{languageId:r?.languageId,requestId:s.metadata?.responseId,blockLanguage:e.action.languageId,participant:t,command:s.metadata?.command},{codeBlockIndex:e.action.codeBlockIndex});break;case"followUp":this.telemetryService.sendMSFTTelemetryEvent("panel.action.followup",{languageId:r?.languageId,requestId:s.metadata?.responseId,participant:t,command:s.metadata?.command});break;case"bug":a?this.feedbackReporter.reportChat(a.getLatestTurn()):Vd.window.showInformationMessage("Conversation not found, is it restored? Please try again.");break;case"chatEditingSessionAction":if(a instanceof Vp){let c=a.getLatestTurn()?.intentInvocation;c instanceof xf&&c.setWorkingSetEntryState(e.action.uri,{accepted:e.action.outcome===1,hasRemainingEdits:e.action.hasRemainingEdits}),this.telemetryService.sendMSFTTelemetryEvent("panel.edit.feedback",{languageId:r?.languageId,requestId:s.metadata?.responseId,participant:t,command:s.metadata?.command,outcome:e.action.outcome===1?"accepted":"rejected",hasRemainingEdits:String(e.action.hasRemainingEdits)})}break}if(e.action.kind==="copy"||e.action.kind==="insert"){let c={};c={totalCharacters:e.action.totalCharacters},e.action.kind==="copy"&&(c={...c,copiedCharacters:e.action.copiedCharacters}),r&&o&&(c={...c,cursorLocation:r.offsetAt(o.active)}),k0(this.telemetryService,Vd.window.activeTextEditor?.document,{codeBlockIndex:e.action.codeBlockIndex.toString(),messageId:s.metadata?.modelMessageId??"",headerRequestId:s.metadata?.responseId??"",participant:t},c,e.action.kind==="copy"?"conversation.acceptedCopy":"conversation.acceptedInsert")}}handleFeedback(e,t){let r=Vd.window.activeTextEditor?.document,o=e.result,s=o.metadata?.responseId&&this.conversationStore.getConversation(o.metadata.responseId);if(typeof s=="object"&&s.getLatestTurn()?.inlineResponseInfo){this._handleInlineChatUserAction(o.metadata?.sessionId,t,s,void 0,e);return}this.telemetryService.sendMSFTTelemetryEvent("panel.action.vote",{languageId:r?.languageId,requestId:o.metadata?.responseId,participant:t,command:o.metadata?.command,reason:e.unhelpfulReason},{direction:e.kind===Vd.ChatResultFeedbackKind.Helpful?1:2}),k0(this.telemetryService,r,{rating:e.kind===Vd.ChatResultFeedbackKind.Helpful?"positive":"negative",messageId:o.metadata?.modelMessageId??"",headerRequestId:o.metadata?.responseId??"",reason:e.unhelpfulReason??""},{},"conversation.messageRating")}_handleInlineChatUserAction(e,t,r,o,s){let a;if((A=>(A[A.Unhelpful=0]="Unhelpful",A[A.Helpful=1]="Helpful",A[A.Undone=2]="Undone",A[A.Accepted=3]="Accepted",A[A.Bug=4]="Bug"))(a||={}),!e)return;let c=r.getLatestTurn()?.inlineResponseInfo;if(!c)return;let l=r.getLatestTurn()?.interactionOutcome;if(!l)return;let u;if(o?.action.kind==="editor"?u=o.action.accepted?3:2:o?.action.kind==="bug"?u=4:s?.kind===Vd.ChatResultFeedbackKind.Helpful?u=1:s?.kind===Vd.ChatResultFeedbackKind.Unhelpful&&(u=0),u===void 0)return;if(u===4&&r){this.feedbackReporter.reportInline(r,c.promptQuery,l);return}let d={messageId:c.messageId},p,{selection:f,wholeRange:m,intent:h,query:g}=c.promptQuery,y=r?.getLatestTurn()?.requestId??"",b=h?.id,_=c.promptQuery.document.languageId,x=b==="fix"?L8(f,this.languageDiagnosticsService.getDiagnostics(c.promptQuery.document.uri)):void 0,I=an(c.promptQuery.document.uri)?1:0;this.surveyService.signalUsage(`inline.${b??"default"}`,_);let S={languageId:_,replyType:l.kind,conversationId:e,requestId:y,command:b},w=c.telemetry?.editCount??0,R=c.telemetry?.editLineCount??0,k={selectionLineCount:f?Math.abs(f.end.line-f.start.line):-1,wholeRangeLineCount:m?Math.abs(m.end.line-m.start.line):-1,editCount:w>0?w:-1,editLineCount:R>0?R:-1,isNotebook:I,problemsCount:x?.fileDiagnosticsTelemetry.problemsCount??0,selectionProblemsCount:x?.selectionDiagnosticsTelemetry.problemsCount??0,diagnosticsCount:x?.fileDiagnosticsTelemetry.diagnosticsCount??0,selectionDiagnosticsCount:x?.selectionDiagnosticsTelemetry.diagnosticsCount??0},V=(F,K)=>{this.telemetryService.sendInternalMSFTTelemetryEvent(F,{language:_,intent:b,query:g,conversationId:e,requestId:y,replyType:l.kind,problems:x?.fileDiagnosticsTelemetry.problems??"",selectionProblems:x?.selectionDiagnosticsTelemetry.problems??"",diagnosticCodes:x?.fileDiagnosticsTelemetry.diagnosticCodes??"",selectionDiagnosticCodes:x?.selectionDiagnosticsTelemetry.diagnosticCodes??""},{isNotebook:I,...K})};if(u===3&&c.aiEditCollector){let F=c.aiEditCollector,K=this.instantiationService.createInstance(G0,c.aiEditCollector.getText(),c.promptQuery.document.document);(async()=>{try{let[$,j]=await Promise.all([F.getEdits(),K.compute()]),D=j.getEditsSinceInitial();this.instantiationService.createInstance(hf,c.promptQuery.document.document,F.initialText,$,D,H8(S,k))}finally{K.dispose()}})()}if(c.aiEditCollector=void 0,u===1||u===0){let F=u===1?1:0;this.telemetryService.sendMSFTTelemetryEvent("inline.action.vote",{...S,reason:s?.unhelpfulReason},{...k,vote:F}),V("interactiveSessionVote",{vote:F})}else if(u===2||u===3){let F=u===3?1:0;this.telemetryService.sendMSFTTelemetryEvent("inline.done",S,{...k,accepted:F}),V("interactiveSessionDone",{accepted:F})}switch(u){case 1:d.rating="positive",p="inlineConversation.messageRating";break;case 0:d.rating="negative",p="inlineConversation.messageRating";break;case 2:d.action="undo",p="inlineConversation.undo";break;case 3:d.action="accept",p="inlineConversation.accept";break;case 4:p="";break}p&&k0(this.telemetryService,c.promptQuery.document,d,{},p)}};vE=E([v(0,ge),v(1,Md),v(2,R9),v(3,pf),v(4,Zo),v(5,H)],vE);var bE=new Map,WN=class{constructor(e){this.label=e;this.iconPath=new Qe.ThemeIcon("lock")}},RXe=Qe.l10n.t("Sign in again to {0}","GitHub"),P9="github",A9="platform",Txe={web:"bing-search",kb:"kb-search"},KJ="kb:",Cxe="github.copilot.chat.selectKnowledgeBase",_E=class{constructor(e,t,r,o,s,a,c,l,u,d,p,f,m,h,g){this.logService=e;this.fetcherService=t;this.envService=r;this.promptVariablesService=o;this.workspaceService=s;this.tabsAndEditorsService=a;this.ignoreService=c;this.gitService=l;this.githubRepositoryService=u;this.chatMLFetcher=d;this.vscodeExtensionContext=p;this.authenticationService=f;this.domainService=m;this.userFeedbackService=h;this.instantiationService=g;this.disposables=new _t;this.knowledgeBases=null;this.organizationsMissingSSO=void 0;this.disposables.add(new Qe.Disposable(()=>bE.forEach(y=>y.dispose()))),this.disposables.add(Qe.commands.registerCommand(Cxe,async()=>{let y=Qe.window.createQuickPick();y.placeholder=Qe.l10n.t("Select a knowledge base"),y.busy=!0,y.show(),y.items=await this.getKnowledgeBaseAutocompleteQuickPickItems(),y.busy=!1;let b=await new Promise((_,x)=>{y.canSelectMany=!1;let I=!1;y.onDidAccept(async()=>{if(y.selectedItems[0]instanceof WN){y.busy=!0;let S=await this.authenticationService.getPermissiveGitHubSession({forceNewSession:!0});if(!S){this.logService.public.error("Failed to get a new auth session for knowledge base selection"),_(void 0),y.hide();return}if(I=!0,this.organizationsMissingSSO=void 0,this.knowledgeBases?.clear(),y.items=await this.getKnowledgeBaseAutocompleteQuickPickItems(S.accessToken),y.items.length===1&&y.items[0]instanceof WN){this.logService.public.error("Failed to fetch new knowledge bases after fetching new auth session"),_(void 0),y.hide();return}y.busy=!1,y.show()}else _(y.selectedItems[0]),y.hide()}),y.onDidHide(()=>{I||_(void 0)})});return y.dispose(),b?.insertText})),this.refreshRemoteAgents(),this.disposables.add(this.authenticationService.onDidAccessTokenChange(()=>{this.refreshRemoteAgents()}))}dispose(){this.disposables.dispose()}async refreshRemoteAgents(){return this.refreshRemoteAgentsP||(this.refreshRemoteAgentsP=this._doRefreshRemoteAgents()),this.refreshRemoteAgentsP.finally(()=>this.refreshRemoteAgentsP=void 0)}async _doRefreshRemoteAgents(){let e=new Set(bE.keys());try{let t=this.authenticationService.anyGitHubSession?.accessToken;if(!t){this.logService.public.warn("Unable to fetch remote agents because user is not signed in.");return}try{e.delete(A9)||(this.logService.public.info("Registering default platform agent..."),bE.set(A9,this.registerAgent(null)))}catch(a){this.logService.public.info(`Encountered error while registering platform agent: ${JSON.stringify(a)}`)}let o=await(await this.fetcherService.fetch(this.domainService.remoteAgentsURL,{method:"GET",headers:{Authorization:$N.format("Bearer %s",t),...this.envService.getEditorVersionHeaders()}})).text(),s;try{if(s=JSON.parse(o).agents,!Array.isArray(s))throw new Error("Expected 'agents' to be an array")}catch(a){o.includes("access denied")||this.logService.public.warn(`Invalid remote agent response: ${o} (${a})`);return}for(let a of s)e.delete(a.slug)||bE.set(a.slug,this.registerAgent(a))}catch(t){this.logService.public.error(t,"Failed to load remote slash commands")}for(let t of e)bE.get(t).dispose(),bE.delete(t)}checkAuthorized(e){if(e===P9)return!0;let t=`copilot.agent.${e}.authorized`;return this.vscodeExtensionContext.globalState.get(t,!1)||this.vscodeExtensionContext.workspaceState.get(t,!1)}async setAuthorized(e,t=!1){await(t?this.vscodeExtensionContext.globalState:this.vscodeExtensionContext.workspaceState).update(`copilot.agent.${e}.authorized`,!0)}registerAgent(e){let t=new _t,r=`github.copilot-dynamic.${e?.slug??A9}`,o=e?.slug??P9,s=e?.description??Qe.l10n.t("Get answers grounded in web search, code search, and your enterprise's knowledge bases"),a={name:o,description:s,publisherName:e?.owner_login??"GitHub",fullName:e?.name??"GitHub"},c=!1,l=t.add(Qe.chat.createDynamicChatParticipant(r,a,async(u,d,p,f)=>{let m=DXe(d),h=Gt(),g=Gt(),y={sessionId:m,modelMessageId:g,responseId:h,agentId:r,command:u.command};if(u.acceptedConfirmationData)for(let _ of u.acceptedConfirmationData){if(_?.ssoSignIn)return await this.authenticationService.getPermissiveGitHubSession({forceNewSession:!0}),p.markdown(Qe.l10n.t("Please complete the sign-in process in your browser.")),{metadata:y};if(_?.url)return await this.setAuthorized(o,u.prompt.startsWith(Qe.l10n.t("Authorize for all workspaces"))),await Qe.commands.executeCommand("vscode.open",zt.parse(_.url)),p.markdown(Qe.l10n.t("Please complete authorization in your browser and resend your question.")),{metadata:y};if(_?.hasAcknowledgedImplicitReferences)return await this.setAuthorized(o,u.prompt.startsWith(Qe.l10n.t("Allow for All Workspaces"))),p.markdown(Qe.l10n.t("Your preference has been saved.")),{metadata:y}}let b=this.authenticationService.anyGitHubSession?.accessToken;e?.slug||(b=this.authenticationService.permissiveGitHubSession?.accessToken??(await this.authenticationService.getPermissiveGitHubSession({createIfNone:!0}))?.accessToken);try{let _=this.instantiationService.createInstance(K0,{model_picker_enabled:!1,capabilities:{type:"chat",tokenizer:"o200k_base",family:"remote"},id:"gpt-4o-2024-05-13",name:"Remote Agents",version:"1.0"},void 0,e?`${this.domainService.remoteAgentsURL}/${e.slug}?chat`:`${this.domainService.remoteAgentsURL}/chat`),x=await this.promptVariablesService.resolveVariablesInPrompt(u.prompt,u.references),I=[],{copilot_skills:S,copilot_references:w}=await this.resolveCopilotSkills(o,u);w&&I.push(...w);let R=!1;try{let B=await this.prepareClientPlatformReferences([...u.references],o);R=B.hasIgnoredFiles,B.clientReferences&&I.push(...B.clientReferences);for(let U of B.vscodeReferences)p.reference(U)}catch(B){return B instanceof Error&&B.message.includes("File seems to be binary and cannot be opened as text")?(p.markdown(Qe.l10n.t("Sorry, binary files are not currently supported.")),{metadata:y}):{errorDetails:{message:B.message},metadata:y}}let k=new Map,V=[],F=PXe(u),K,$,j=!1,D,A=await this.chatMLFetcher.fetchMany("remoteAgent",[...AXe(r,d),{role:"user",content:u.acceptedConfirmationData?.length||u.rejectedConfirmationData?.length?"":x.message,...I.length?{copilot_references:I}:void 0,copilot_confirmations:F?.length?F:void 0}],async(B,U,W)=>{if(W.copilotReferences){let Y=(X,Se)=>{let te="url"in X?X.url:"url"in X.data?X.data.url:"html_url"in X.data?X.data.html_url:void 0;if(te&&typeof te=="string"){if(!k.has(te)){let Ie;vxe(X)?Ie=zt.joinPath(this.vscodeExtensionContext.extensionUri,"assets","bing.svg"):new URL(te).hostname==="github.com"?Ie=new Qe.ThemeIcon("github"):Ie=new Qe.ThemeIcon("globe"),K?K?.report(new Qe.ChatResponseReferencePart(zt.parse(te),Ie)):p.reference(zt.parse(te),Ie),k.set(te,Se??X)}}else if(X.metadata){let Ie=X.metadata.display_icon?zt.parse(X.metadata.display_icon):new Qe.ThemeIcon("globe"),Xe=X.metadata.display_url?zt.parse(X.metadata.display_url):X.metadata.display_name;K?K.report(new R5(Xe,Ie)):p.reference2(Xe,Ie),k.set(X.metadata.display_url??X.metadata.display_name,Se??X)}};for(let X of W.copilotReferences)if(Array.isArray(X.data.results))X.data.results.forEach(Se=>{Y(Se,X)});else if(X.data.type==="github.agent")V.push(X);else{if(X.type==="github.text")continue;("html_url"in X.data||"url"in X.data&&typeof X.data.url=="string"||X.metadata)&&Y(X)}}let ae=(Y,X)=>{$?.deferred.complete($.resolvedMessage),K=Y;let Se=new ys;return $={deferred:Se,resolvedMessage:X},Se.p};if(W.copilotFunctionCalls)for(let Y of W.copilotFunctionCalls)switch(Y.name){case"bing-search":{try{let X=JSON.parse(Y.arguments);p.progress(Qe.l10n.t('Searching Bing for "{0}"...',X.query),async Se=>ae(Se,Qe.l10n.t('Bing search results for "{0}"',X.query)))}catch{}break}case"kb-search":{try{let X=JSON.parse(Y.arguments);p.progress(Qe.l10n.t('Searching knowledge base for "{0}"...',X.query),async Se=>ae(Se,Qe.l10n.t('Knowledge base results for "{0}"',X.query)))}catch{}break}case"codesearch":{try{let X=JSON.parse(Y.arguments);p.progress(Qe.l10n.t('Searching {0} for "{1}"...',X.scopingQuery,X.query),async Se=>ae(Se,Qe.l10n.t('Code search results for "{0}" in {1}',X.query,X.scopingQuery)))}catch{}break}}if(W.copilotErrors&&typeof p.warning=="function"){j=!0;for(let Y of W.copilotErrors)Y.code==="sso"?D=Y.identifier:K?K?.report(new Qe.ChatResponseWarningPart(Y.message)):p.warning(Y.message)}if(W.copilotConfirmation){j=!0;let Y=W.copilotConfirmation;p.confirmation(Y.title,Y.message,Y.confirmation)}if(W.text){$?.deferred.complete($.resolvedMessage);let Y=new Qe.MarkdownString(W.text);Y.supportHtml=!0,p.markdown(Y)}},f,2,_,void 0,{secretKey:b,copilot_thread_id:m,...S?{copilot_skills:S}:void 0},{messageSource:`serverAgent.${e?.slug??A9}`});if(y.copilot_references=[...new Set(k.values()).values(),...V],A.type==="success"&&R&&p.markdown(Qe.l10n.t(NF)),D&&b){let B=this.updateMissingSSOOrganizationInfo(D,b),U=B?Qe.l10n.t("Please grant permission to read resources protected by SSO in the {0} organization.",B):Qe.l10n.t("Please grant permission to read resources protected by SSO.");p.confirmation(RXe,U,{ssoSignIn:!0},[Qe.l10n.t("Sign In")])}if(A.type!=="success"){if(this.logService.internal.warn(`Bad response from /agents/${o}: ${A.type} ${A.reason}`),A.reason.includes("400 no docs found"))return{errorDetails:{message:"No docs found"},metadata:y};if(A.type==="agent_unauthorized"){let B=new URL(A.authorizationUrl),U=e?.editor_context?Qe.l10n.t("**@{0}** will read your active file and selection.",o):"";return p.confirmation(Qe.l10n.t("Authorize agent"),U+`
`+Qe.l10n.t({message:"Please authorize usage of **@{0}** on {1} and resend your question. [Learn more]({2}).",args:[o,B.hostname,"https://aka.ms/vscode-github-chat-extension-editor-context"],comment:["{Locked=']({'}"]}),{url:A.authorizationUrl},[Qe.l10n.t("Authorize"),Qe.l10n.t("Authorize for All Workspaces")]),{metadata:y,nextQuestion:{prompt:u.prompt,participant:r,command:u.command}}}else{if(A.type==="agent_failed_dependency")return{errorDetails:{message:Qe.l10n.t("Sorry, an error occurred: {0}",A.reason)},metadata:y};if(A.type!=="unknown"||!j)return{errorDetails:{message:A.reason},metadata:y}}}return!this.checkAuthorized(o)&&e?.editor_context&&!c&&(p.confirmation(Qe.l10n.t("Grant access to editor context"),Qe.l10n.t({message:"**@{0}** would like to read your active file and selection. [Learn More]({1})",args:[o,"https://aka.ms/vscode-github-chat-extension-editor-context"],comment:["{Locked=']({'}"]}),{hasAcknowledgedImplicitReferences:!0},[Qe.l10n.t("Allow"),Qe.l10n.t("Allow for All Workspaces")]),c=!0),{metadata:y}}catch(_){return this.logService.public.error(`/agents/${o} failed: ${_}`),{metadata:y}}}));return l.iconPath=e?zt.parse(e.avatar_url):new Qe.ThemeIcon("github"),o===P9&&(l.participantVariableProvider={triggerCharacters:["#"],provider:{provideCompletionItems:async(u,d)=>(await this.getPlatformAgentSkills()).map(f=>{let m=new Qe.ChatCompletionItem(`copilot.${f.name}`,"#"+f.name,[{value:f.insertText,level:Qe.ChatVariableLevel.Full,description:f.description}]);return m.command=f.command,m.detail=f.description,m.fullName=f.fullName,m.icon=f.icon,m})}}),t.add(l.onDidReceiveFeedback(u=>this.userFeedbackService.handleFeedback(u,r))),t}async prepareClientPlatformReferences(e,t){let r=[],o=[],s=!1,a=!1,c=async(p,f)=>{let m=D9.basename(p.uri.toString()),h=p.getText(f);return await this.ignoreService.isCopilotIgnored(p.uri)?(s=!0,h="content-exclusion"):m.startsWith(".")?h="hidden-file":Buffer.byteLength(h,"utf8")>1024**3&&(h="file-too-large"),h},l=async(p,f,m)=>{r.push({type:"client.file",data:{language:p.languageId,content:await c(p)},is_implicit:!!m,id:D9.basename(p.uri.path)}),o.push(f?{variableName:f,value:p.uri}:p.uri)},u=async(p,f,m=!1,h)=>{let g=p.selection.start.line,y=p.selection.isEmpty?new Qe.Range(new Qe.Position(g,0),new Qe.Position(g+1,0)):p.selection;r.push({type:"client.selection",data:{start:{line:y.start.line,col:y.start.character},end:{line:y.end.line,col:y.end.character},content:await c(p.document,y)},is_implicit:!!h,id:D9.basename(p.document.uri.path)}),m&&o.push(f?{variableName:f,value:new Qe.Location(p.document.uri,y)}:new Qe.Location(p.document.uri,y))};if(this.checkAuthorized(t)){let{activeTextEditor:p}=this.tabsAndEditorsService;p&&(await l(p.document,void 0,!0),await u(p,void 0,void 0,!0),a=!0)}for(let p of e)if(p.value instanceof zt){let f=await this.workspaceService.openTextDocument(p.value);await l(f,p.name)}else if(p.name==="selection"){let{activeTextEditor:f}=this.tabsAndEditorsService;if(!f)throw new Error(Qe.l10n.t({message:"Please open a text editor to use the `#selection` variable.",comment:"{Locked='`#selection`'}"}));a||await u(f,p.name,!0)}else p.name==="editor"&&this.tabsAndEditorsService.activeTextEditor&&await l(this.tabsAndEditorsService.activeTextEditor.document,p.name);this.gitService.isInitialized||await this.gitService.initialize();let d=this.gitService.repositories;for(let p of d){let f=VT(p);if(f)try{let[m,h]=f?.split("/"),g=await this.githubRepositoryService.getRepositoryInfo(m,h);r.push({type:"github.repository",id:f,data:{type:"repository",name:h,ownerLogin:m,id:g.id}})}catch(m){m instanceof Error&&m.message.includes("Failed to fetch repository info")&&this.authenticationService.getPermissiveGitHubSession({silent:!0}),this.logService.public.error(m,"Failed to fetch info about current GitHub repository")}}return{clientReferences:r,vscodeReferences:o,hasIgnoredFiles:s}}async listEnabledSkills(e){if(!this.enabledSkillsPromise){let t=await this.fetcherService.fetch(this.domainService.listSkillsURL,{method:"GET",headers:{Authorization:$N.format("Bearer %s",e),...this.envService.getEditorVersionHeaders()}});this.enabledSkillsPromise=t.json().then(r=>r?.skills.reduce((o,s)=>o.add(s.slug),new Set))}return this.enabledSkillsPromise}async resolveCopilotSkills(e,t){if(e===P9){let r=new Set,o=new Set;for(let s of t.references)if(Txe[s.name])r.add(Txe[s.name]);else if(s.name.startsWith(KJ)){r.add("kb-search"),await this.getKnowledgeBases();let a=this.knowledgeBases?.get(s.name.slice(KJ.length));a&&o.add(a)}return{copilot_skills:[...r],copilot_references:[...o]}}return{copilot_skills:[]}}async updateMissingSSOOrganizationInfo(e,t){let r=e?.split("partial-results; organizations=")[1];if(r){let o=r.split(",");this.logService.public.debug(`Missing knowledge bases SSO for ${o.length} organizations: ${r}`);let s=await this.getOrganizationName(t,parseInt(o[0]));return s?this.organizationsMissingSSO={name:s,numberOfOrganizations:o.length}:this.organizationsMissingSSO={name:void 0,numberOfOrganizations:o.length},s}}async getKnowledgeBases(e){if(this.knowledgeBases?.size)return{knowledgeBases:[...this.knowledgeBases.values()],organizationsMissingSSO:this.organizationsMissingSSO};let t=e??(await this.authenticationService.getPermissiveGitHubSession({createIfNone:!0}))?.accessToken;if(!t)return this.logService.public.debug("No auth token available to fetch knowledge bases"),{knowledgeBases:[],organizationsMissingSSO:void 0};let r=await this.listKnowledgeBases(t),o=await r.text(),s=r.headers.get("X-GitHub-SSO");s&&this.updateMissingSSOOrganizationInfo(s,t);try{let a=JSON.parse(o);this.knowledgeBases=new Map;let c=a.map(l=>({label:l.name,organization:l.owner.login,iconPath:new Qe.ThemeIcon("github"),insertText:l.name,name:l.name,description:l.description,type:"github.knowledge-base",id:Gt(),data:{type:"knowledge-base",id:l.id}}));for(let l of c)this.knowledgeBases.set(l.name,l);return{knowledgeBases:[...this.knowledgeBases.values()],organizationsMissingSSO:this.organizationsMissingSSO}}catch(a){return this.logService.public.error(a),{knowledgeBases:[],organizationsMissingSSO:this.organizationsMissingSSO}}}async getOrganizationName(e,t){let r=await this.fetcherService.fetch(`https://api.github.com/user/${t}`,{method:"GET",headers:{Authorization:$N.format("Bearer %s",e),...this.envService.getEditorVersionHeaders()}});if(r.ok)return(await r.json()).name}async listKnowledgeBases(e){return this.fetcherService.fetch("https://api.github.com/user/knowledge-bases",{method:"GET",headers:{Authorization:$N.format("Bearer %s",e),...this.envService.getEditorVersionHeaders()}})}async getKnowledgeBaseAutocompleteQuickPickItems(e){let{knowledgeBases:t,organizationsMissingSSO:r}=await this.getKnowledgeBases(e),o=[];if(r){let a;r.name&&r.numberOfOrganizations>1?a=Qe.l10n.t("Single-sign on to see knowledge bases from {0} and {1} other organizations",r.name,r.numberOfOrganizations-1):r.name?a=Qe.l10n.t("Single-sign on to see knowledge bases from the {0} organization",r.name):r.numberOfOrganizations===1?a=Qe.l10n.t("Single-sign on to see knowledge bases from 1 additional organization"):a=Qe.l10n.t("Single-sign on to see knowledge bases from {0} additional organizations",r.numberOfOrganizations),o.push(new WN(a)),o.push({kind:Qe.QuickPickItemKind.Separator,label:""})}let s=new Map;for(let a of t){let c=a.organization;s.has(c)||s.set(c,[]),s.get(c)?.push(a)}for(let a of[...s.keys()].sort()){let c=s.get(a);c?.length&&(o.push({kind:Qe.QuickPickItemKind.Separator,label:a}),o.push(...c.sort((l,u)=>l.label.localeCompare(u.label))))}return o}async getPlatformAgentSkills(){let e=this.authenticationService.anyGitHubSession?.accessToken;if(!e)return[];let t=await this.listEnabledSkills(e);return[{name:"web",insertText:"#web",description:"Search Bing for real-time context",kind:"bing-search",command:void 0},{name:"kb",insertText:`#${KJ}`,icon:new Qe.ThemeIcon("book"),fullName:"Knowledge Bases...",description:"Search your enterprises' knowledge bases",kind:"kb-search",command:{title:"",command:Cxe}}].filter(r=>t.has(r.kind))}};_E=E([v(0,oe),v(1,hn),v(2,it),v(3,w9),v(4,Be),v(5,$t),v(6,Te),v(7,Ks),v(8,Id),v(9,Et),v(10,qt),v(11,xt),v(12,xn),v(13,yE),v(14,H)],_E);function PXe(n){return[...n.acceptedConfirmationData?.map(t=>({state:"accepted",confirmation:t}))??[],...n.rejectedConfirmationData?.map(t=>({state:"dismissed",confirmation:t}))??[]]}function AXe(n,e){let t=[];for(let r of e.history)if(r.participant===n&&(r instanceof Qe.ChatRequestTurn&&t.push({role:"user",content:r.prompt}),r instanceof Qe.ChatResponseTurn)){let o=r.result.metadata?.copilot_references,s=r.response.map(a=>a instanceof Qe.ChatResponseMarkdownPart?a.value.value:"content"in a?a.content:null).filter(a=>!!a).join("");t.push({role:"assistant",content:s,...o?{copilot_references:o}:void 0})}return t}function DXe(n){let e;for(let t of n.history)if(t instanceof Qe.ChatResponseTurn){let r=t.result.metadata?.sessionId;if(typeof r=="string"){e=r;break}}return e??Gt()}var N9=q(require("vscode"));var xE=class extends ye{constructor(t,r){super();this._domainService=t;this._fetcherService=r;this._nonSkuIsolatedCAPIEndpoint="https://api.githubcopilot.com";this.testSkuIsolationEndpoint(),this._register(this._domainService.onDidChangeDomains(async o=>{o.capiUrlChanged&&await this.testSkuIsolationEndpoint()}))}async testSkuIsolationEndpoint(){if(this._domainService.capiBaseURL===this._nonSkuIsolatedCAPIEndpoint)return;let t=!1,r=!1;try{t=(await this._fetcherService.fetch(`${this._domainService.capiBaseURL}/_ping`,{method:"GET"})).ok}catch{t=!1}try{r=(await this._fetcherService.fetch(`${this._nonSkuIsolatedCAPIEndpoint}/_ping`,{method:"GET"})).ok}catch{r=!1}r&&!t&&N9.window.showErrorMessage("Your firewall appears to be improperly blocking access GitHub Copilot services.","Run Diagnostics").then(o=>{o&&N9.commands.executeCommand("github.copilot.debug.collectDiagnostics")})}};xE=E([v(0,xn),v(1,hn)],xE);var YJ=q(require("vscode"));var L9=class extends ye{constructor(){super(),this._register(YJ.commands.registerCommand("github.copilot.open.walkthrough",()=>{YJ.commands.executeCommand("workbench.action.openWalkthrough",{category:"GitHub.copilot-chat#copilotWelcome"},!1)}))}};var Exe=q(require("vscode"));var KN=class{constructor(e){this._ignoreService=e}provideFileIgnored(e,t){return this._ignoreService.isCopilotIgnored(e)}};KN=E([v(0,Te)],KN);var SE=class extends ye{constructor(t){super();this.instantiationService=t;this._register(Exe.lm.registerIgnoredFileProvider(this.instantiationService.createInstance(KN)))}};SE=E([v(0,H)],SE);var Fo=q(require("vscode"));var O9;(o=>{let n=new Map;n.set("typescript",new Set(["abstract","any","as","asserts","async","await","bigint","boolean","break","case","catch","class","const","continue","constructor","debugger","declare","default","delete","do","else","enum","export","extends","false","finally","for","from","function","get","if","implements","import","in","infer","instanceof","interface","is","keyof","let","module","namespace","never","new","null","number","object","of","package","private","protected","public","readonly","require","return","set","static","string","super","switch","symbol","this","throw","true","try","type","typeof","undefined","unique","unknown","var","void","while","with","yield"])),n.set("typescriptreact",new Set(["abstract","any","as","asserts","async","await","bigint","boolean","break","case","catch","class","const","continue","constructor","debugger","declare","default","delete","do","else","enum","export","extends","false","finally","for","from","function","get","if","implements","import","in","infer","instanceof","interface","is","keyof","let","module","namespace","never","new","null","number","object","of","package","private","protected","public","readonly","require","return","set","static","string","super","switch","symbol","this","throw","true","try","type","typeof","undefined","unique","unknown","var","void","while","with","yield"])),n.set("javascript",new Set(["async","await","break","case","catch","class","const","continue","constructor","debugger","default","delete","do","else","enum","export","extends","false","finally","for","from","function","get","if","import","in","instanceof","interface","is","let","new","null","require","return","set","static","string","super","switch","symbol","this","throw","true","try","type","typeof","undefined","var","void","while","with","yield"])),n.set("javascriptreact",new Set(["async","await","break","case","catch","class","const","continue","constructor","debugger","default","delete","do","else","enum","export","extends","false","finally","for","from","function","get","if","import","in","instanceof","interface","is","let","new","null","require","return","set","static","string","super","switch","symbol","this","throw","true","try","type","typeof","undefined","var","void","while","with","yield"])),n.set("python",new Set(["False","None","True","and","as","assert","async","await","break","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","in","is","lambda","nonlocal","not","or","pass","raise","return","try","while","with","yield"])),n.set("java",new Set(["abstract","assert","boolean","break","byte","case","catch","char","class","const","continue","default","do","double","else","enum","extends","final","finally","float","for","goto","if","implements","import","instanceof","int","interface","long","native","new","null","package","private","protected","public","return","short","static","strictfp","super","switch","synchronized","this","throw","throws","transient","try","void","volatile","while"])),n.set("go",new Set(["break","case","chan","const","continue","default","defer","else","fallthrough","for","func","go","goto","if","import","interface","map","package","range","return","select","struct","switch","type","var"])),n.set("csharp",new Set(["abstract","as","base","bool","break","byte","case","catch","char","checked","class","const","continue","decimal","default","delegate","do","double","else","enum","event","explicit","extern","false","finally","fixed","float","for","foreach","goto","if","implicit","in","int","interface","internal","is","lock","long","namespace","new","null","object","operator","out","override","params","private","protected","public","readonly","ref","return","sbyte","sealed","short","sizeof","stackalloc","static","string","struct","switch","this","throw","true","try","typeof","uint","ulong","unchecked","unsafe","ushort","using","virtual","void","volatile","while"])),o.languages=n.keys();function t(s,a){let c=n.get(s.languageId),l=[],u=s.lineAt(a),d=u.firstNonWhitespaceCharacterIndex,p=d;for(;d<u.range.end.character;){let f=new Fo.Position(a.line,d),m=s.getWordRangeAtPosition(f);if(!m){d+=1;continue}let h=m.start.character,g=m.end.character;if(h!==p){let b=u.text.substring(p,h);l.push({type:b.match(/^\s+$/)?"space":"other",value:b})}let y=u.text.substring(h,g);l.push({type:c?.has(y)?"keyword":"word",value:y}),d=g+1,p=g}if(p<u.range.end.character){let f=u.text.substring(p);l.push({type:f.match(/^\s+$/)?"space":"other",value:f})}return l}function r(s,a,c){let l=t(s,a),u=0,d=0,p=0,f=0;for(let m=0;m<l.length;m++)switch(l[m].type){case"keyword":d+=1;break;case"word":u+=1;break;case"space":p+=1;break;case"other":f+=1;break}return c?.public.trace("[ChatTrigger] "+JSON.stringify({wordCount:u,keywordCount:d,spaceCount:p,otherCount:f,tokenCount:l.length})),!(l.length<4||p<2||d>=u||f>=p)}o.isMostlyNaturalLanguage=r})(O9||={});var YN=class{constructor(e){this._logService=e}async provideCompletionItems(e,t){let r=e.lineAt(t);if(r.isEmptyOrWhitespace||t.character<r.range.end.character||!O9.isMostlyNaturalLanguage(e,t,this._logService))return;let o=new Fo.CompletionItem({label:r.text.trim(),description:"Trigger Inline Chat"});return o.kind=Fo.CompletionItemKind.Event,o.command={command:"inlineChat.startWithCurrentLine",title:"Trigger Inline Chat"},o.range=r.range.with(r.range.start.with(void 0,r.firstNonWhitespaceCharacterIndex)),o.filterText=r.text.substring(r.firstNonWhitespaceCharacterIndex),new Fo.CompletionList([o],!0)}};YN=E([v(0,oe)],YN);var QN=class{constructor(e,t){this._logService=e;this._store=new _t;this._sessionStore=new _t;this._deco=Fo.window.createTextEditorDecorationType({after:{contentText:"\xA0".repeat(10)+"Press Cmd+I to continue with Github Copilot...",fontStyle:"italic",color:"var(--vscode-editorGhostText-foreground)"}}),this._store.add(Fo.window.onDidChangeActiveTextEditor(()=>this._update())),this._update()}dispose(){this._deco.dispose(),this._store.dispose()}_update(){this._sessionStore.clear();let e=Fo.window.activeTextEditor;!e||!e.viewColumn||Fo.languages.match(wxe,e.document)&&(this._sessionStore.add(Fo.window.onDidChangeTextEditorSelection(t=>{if(t.textEditor!==e)return;let r=[],o=e.document.lineAt(e.selection.active.line).range;t.kind===Fo.TextEditorSelectionChangeKind.Keyboard&&e.selection.isSingleLine&&o.end.character-e.selection.active.character<4&&O9.isMostlyNaturalLanguage(e.document,e.selection.active,this._logService)&&r.push(o),e.setDecorations(this._deco,r),Fo.commands.executeCommand("setContext","github.copilot.chat.editor.enableLineTrigger",r.length>0)})),this._sessionStore.add(zi(()=>{e.setDecorations(this._deco,[])})))}};QN=E([v(0,oe),v(1,qt)],QN);var wxe=Array.from(O9.languages),IE=class{constructor(e,t){this._store=new _t;let r=this._store.add(new dv),o=this._store.add(new dv),s=()=>{if(t.getConfig(le.InlineChatCompletionsTrigger)){let a=e.createInstance(YN);r.value=Fo.languages.registerCompletionItemProvider(wxe,a)}else r.clear();t.getConfig(le.InlineChatHint)?o.value=e.createInstance(QN):o.clear()};this._store.add(t.onDidChangeConfiguration(a=>{(a.affectsConfiguration(le.InlineChatCompletionsTrigger.fullyQualifiedId)||a.affectsConfiguration(le.InlineChatHint.fullyQualifiedId))&&s()})),s()}dispose(){this._store.dispose()}};IE=E([v(0,H),v(1,be)],IE);var ns=require("vscode");var yn=class n{static fromRange(e){return new n(e.startLineNumber,e.endLineNumber)}static fromRangeInclusive(e){return new n(e.startLineNumber,e.endLineNumber+1)}static subtract(e,t){return t?e.startLineNumber<t.startLineNumber&&t.endLineNumberExclusive<e.endLineNumberExclusive?[new n(e.startLineNumber,t.startLineNumber),new n(t.endLineNumberExclusive,e.endLineNumberExclusive)]:t.startLineNumber<=e.startLineNumber&&e.endLineNumberExclusive<=t.endLineNumberExclusive?[]:t.endLineNumberExclusive<e.endLineNumberExclusive?[new n(Math.max(t.endLineNumberExclusive,e.startLineNumber),e.endLineNumberExclusive)]:[new n(e.startLineNumber,Math.min(t.startLineNumber,e.endLineNumberExclusive))]:[e]}static joinMany(e){if(e.length===0)return[];let t=new M9(e[0].slice());for(let r=1;r<e.length;r++)t=t.getUnion(new M9(e[r].slice()));return t.ranges}static join(e){if(e.length===0)throw new Xt("lineRanges cannot be empty");let t=e[0].startLineNumber,r=e[0].endLineNumberExclusive;for(let o=1;o<e.length;o++)t=Math.min(t,e[o].startLineNumber),r=Math.max(r,e[o].endLineNumberExclusive);return new n(t,r)}static ofLength(e,t){return new n(e,e+t)}static deserialize(e){return new n(e[0],e[1])}constructor(e,t){if(e>t)throw new Xt(`startLineNumber ${e} cannot be after endLineNumberExclusive ${t}`);this.startLineNumber=e,this.endLineNumberExclusive=t}contains(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(e){return new n(this.startLineNumber+e,this.endLineNumberExclusive+e)}deltaLength(e){return new n(this.startLineNumber,this.endLineNumberExclusive+e)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(e){return new n(Math.min(this.startLineNumber,e.startLineNumber),Math.max(this.endLineNumberExclusive,e.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(e){let t=Math.max(this.startLineNumber,e.startLineNumber),r=Math.min(this.endLineNumberExclusive,e.endLineNumberExclusive);if(t<=r)return new n(t,r)}intersectsStrict(e){return this.startLineNumber<e.endLineNumberExclusive&&e.startLineNumber<this.endLineNumberExclusive}overlapOrTouch(e){return this.startLineNumber<=e.endLineNumberExclusive&&e.startLineNumber<=this.endLineNumberExclusive}equals(e){return this.startLineNumber===e.startLineNumber&&this.endLineNumberExclusive===e.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new De(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new De(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(e){let t=[];for(let r=this.startLineNumber;r<this.endLineNumberExclusive;r++)t.push(e(r));return t}forEach(e){for(let t=this.startLineNumber;t<this.endLineNumberExclusive;t++)e(t)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}includes(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}toOffsetRange(){return new gt(this.startLineNumber-1,this.endLineNumberExclusive-1)}},M9=class n{constructor(e=[]){this._normalizedRanges=e}get ranges(){return this._normalizedRanges}addRange(e){if(e.length===0)return;let t=uv(this._normalizedRanges,o=>o.endLineNumberExclusive>=e.startLineNumber),r=vd(this._normalizedRanges,o=>o.startLineNumber<=e.endLineNumberExclusive)+1;if(t===r)this._normalizedRanges.splice(t,0,e);else if(t===r-1){let o=this._normalizedRanges[t];this._normalizedRanges[t]=o.join(e)}else{let o=this._normalizedRanges[t].join(this._normalizedRanges[r-1]).join(e);this._normalizedRanges.splice(t,r-t,o)}}contains(e){let t=LW(this._normalizedRanges,r=>r.startLineNumber<=e);return!!t&&t.endLineNumberExclusive>e}intersects(e){let t=LW(this._normalizedRanges,r=>r.startLineNumber<e.endLineNumberExclusive);return!!t&&t.endLineNumberExclusive>e.startLineNumber}getUnion(e){if(this._normalizedRanges.length===0)return e;if(e._normalizedRanges.length===0)return this;let t=[],r=0,o=0,s=null;for(;r<this._normalizedRanges.length||o<e._normalizedRanges.length;){let a=null;if(r<this._normalizedRanges.length&&o<e._normalizedRanges.length){let c=this._normalizedRanges[r],l=e._normalizedRanges[o];c.startLineNumber<l.startLineNumber?(a=c,r++):(a=l,o++)}else r<this._normalizedRanges.length?(a=this._normalizedRanges[r],r++):(a=e._normalizedRanges[o],o++);s===null?s=a:s.endLineNumberExclusive>=a.startLineNumber?s=new yn(s.startLineNumber,Math.max(s.endLineNumberExclusive,a.endLineNumberExclusive)):(t.push(s),s=a)}return s!==null&&t.push(s),new n(t)}subtractFrom(e){let t=uv(this._normalizedRanges,a=>a.endLineNumberExclusive>=e.startLineNumber),r=vd(this._normalizedRanges,a=>a.startLineNumber<=e.endLineNumberExclusive)+1;if(t===r)return new n([e]);let o=[],s=e.startLineNumber;for(let a=t;a<r;a++){let c=this._normalizedRanges[a];c.startLineNumber>s&&o.push(new yn(s,c.startLineNumber)),s=c.endLineNumberExclusive}return s<e.endLineNumberExclusive&&o.push(new yn(s,e.endLineNumberExclusive)),new n(o)}toString(){return this._normalizedRanges.map(e=>e.toString()).join(", ")}getIntersection(e){let t=[],r=0,o=0;for(;r<this._normalizedRanges.length&&o<e._normalizedRanges.length;){let s=this._normalizedRanges[r],a=e._normalizedRanges[o],c=s.intersect(a);c&&!c.isEmpty&&t.push(c),s.endLineNumberExclusive<a.endLineNumberExclusive?r++:o++}return new n(t)}getWithDelta(e){return new n(this._normalizedRanges.map(t=>t.delta(e)))}};var kxe=-1;function TE(){return kxe!==-1?kxe:Date.now()}function Rxe(n,e){return n.endLineNumberExclusive<=e.startLineNumber?e.startLineNumber-n.endLineNumberExclusive:e.endLineNumberExclusive<=n.startLineNumber?n.startLineNumber-e.endLineNumberExclusive:0}var CE=class n{constructor(e){this.edits=e}static fromEdit(e,t){let r=e.edits.map(o=>new Rh(t.getTransformer().getRange(o.range),o.newText));return new n(r)}},Rh=class n{constructor(e,t){this.range=e;this.newText=t}static joinEdits(e,t){if(e.length===0)throw new Xt;if(e.length===1)return e[0];let r=e[0].range.getStartPosition(),o=e[e.length-1].range.getEndPosition(),s="";for(let a=0;a<e.length;a++){let c=e[a];if(s+=c.newText,a<e.length-1){let l=e[a+1],u=De.fromPositions(c.range.getEndPosition(),l.range.getStartPosition()),d=t.getValueOfRange(u);s+=d}}return new n(De.fromPositions(r,o),s)}static fromSingleEdit(e,t){return new n(t.getTransformer().getRange(e.range),e.newText)}extendToCoverRange(e,t){if(this.range.containsRange(e))return this;let r=this.range.plusRange(e),o=t.getValueOfRange(De.fromPositions(r.getStartPosition(),this.range.getStartPosition())),s=t.getValueOfRange(De.fromPositions(this.range.getEndPosition(),r.getEndPosition())),a=o+this.newText+s;return new n(r,a)}extendToFullLine(e){let t=new De(this.range.startLineNumber,1,this.range.endLineNumber,e.getTransformer().getLineLength(this.range.endLineNumber)+1);return this.extendToCoverRange(t,e)}};var Y0=class n{constructor(e){this.edits=e;Sv(uK(e,(t,r)=>t.lineRange.endLineNumberExclusive<=r.lineRange.startLineNumber))}static{this.empty=new n([])}static deserialize(e){return new n(e.map(t=>Gd.deserialize(t)))}static fromEdit(e){let t=CE.fromEdit(e.edit,e.base);return n.fromTextEdit(t,e.base)}static fromTextEdit(e,t){let r=e.edits,o=[],s=[];for(let a=0;a<r.length;a++){let c=r[a],l=a+1<r.length?r[a+1]:void 0;if(s.push(c),l&&l.range.startLineNumber===c.range.endLineNumber)continue;let u=Rh.joinEdits(s,t);s.length=0;let d=Gd.fromSingleTextEdit(u,t);o.push(d)}return new n(o)}static createFromUnsorted(e){let t=e.slice();return t.sort(y1(r=>r.lineRange.startLineNumber,b1)),new n(t)}isEmpty(){return this.edits.length===0}toEdit(e){let t=[];for(let r of this.edits){let o=r.toSingleEdit(e);t.push(o)}return Lc.create(t)}toString(){return this.edits.map(e=>e.toString()).join(",")}serialize(){return this.edits.map(e=>e.serialize())}getNewLineRanges(){let e=[],t=0;for(let r of this.edits)e.push(yn.ofLength(r.lineRange.startLineNumber+t,r.newLines.length)),t+=r.newLines.length-r.lineRange.length;return e}mapLineNumber(e){let t=0;for(let r of this.edits){if(r.lineRange.endLineNumberExclusive>e)break;t+=r.newLines.length-r.lineRange.length}return e+t}mapLineRange(e){return new yn(this.mapLineNumber(e.startLineNumber),this.mapLineNumber(e.endLineNumberExclusive))}rebase(e){return new n(this.edits.map(t=>new Gd(e.mapLineRange(t.lineRange),t.newLines)))}humanReadablePatch(e){let t=[];function r(c,l,u,d){let p=u==="unmodified"?" ":u==="deleted"?"-":"+";d===void 0&&(d="[[[[[ WARNING: LINE DOES NOT EXIST ]]]]]");let f=c===-1?"   ":c.toString().padStart(3," "),m=l===-1?"   ":l.toString().padStart(3," ");t.push(`${p} ${f} ${m} ${d}`)}function o(){t.push("---")}let s=0,a=!0;for(let c of Mme(this.edits,(l,u)=>Rxe(l.lineRange,u.lineRange)<=5)){a?a=!1:o();let l=c[0].lineRange.startLineNumber-2;for(let u of c){for(let f=Math.max(1,l);f<u.lineRange.startLineNumber;f++)r(f,f+s,"unmodified",e[f-1]);let d=u.lineRange,p=u.newLines;for(let f of d.mapToLineArray(m=>m)){let m=e[f-1];r(f,-1,"deleted",m)}for(let f=0;f<p.length;f++){let m=p[f];r(-1,d.startLineNumber+s+f,"added",m)}l=d.endLineNumberExclusive,s+=u.newLines.length-u.lineRange.length}for(let u=l;u<=Math.min(l+2,e.length);u++)r(u,u+s,"unmodified",e[u-1])}return t.join(`
`)}apply(e){let t=[],r=0;for(let o of this.edits){for(;r<o.lineRange.startLineNumber-1;)t.push(e[r]),r++;for(let s of o.newLines)t.push(s);r=o.lineRange.endLineNumberExclusive-1}for(;r<e.length;)t.push(e[r]),r++;return t}},Gd=class n{constructor(e,t){this.lineRange=e;this.newLines=t}static deserialize(e){return new n(yn.ofLength(e[0],e[1]-e[0]),e[2])}static fromSingleTextEdit(e,t){let r=pl(e.newText),o=e.range.startLineNumber,s=t.getValueOfRange(De.fromPositions(new Dt(e.range.startLineNumber,1),e.range.getStartPosition()));r[0]=s+r[0];let a=e.range.endLineNumber+1,c=t.getTransformer().getLineLength(e.range.endLineNumber)+1,l=t.getValueOfRange(De.fromPositions(e.range.getEndPosition(),new Dt(e.range.endLineNumber,c)));r[r.length-1]=r[r.length-1]+l;let u=e.range.startColumn===t.getTransformer().getLineLength(e.range.startLineNumber)+1,d=e.range.endColumn===1;return u&&r[0].length===s.length&&(o++,r.shift()),r.length>0&&o<a&&d&&r[r.length-1].length===l.length&&(a--,r.pop()),new n(new yn(o,a),r)}toSingleTextEdit(e){if(this.newLines.length===0){let t=e.getTransformer().textLength;if(this.lineRange.endLineNumberExclusive===t.lineCount+2){let r;if(this.lineRange.startLineNumber>1){let s=this.lineRange.startLineNumber-1,a=e.getTransformer().getLineLength(s)+1;r=new Dt(s,a)}else r=new Dt(1,1);let o=t.addToPosition(new Dt(1,1));return new Rh(De.fromPositions(r,o),"")}else return new Rh(new De(this.lineRange.startLineNumber,1,this.lineRange.endLineNumberExclusive,1),"")}else if(this.lineRange.isEmpty){let t,r,o,s=this.lineRange.startLineNumber;return s===e.getTransformer().textLength.lineCount+2?(t=s-1,r=e.getTransformer().getLineLength(t)+1,o=this.newLines.map(a=>`
`+a).join("")):(t=s,r=1,o=this.newLines.map(a=>a+`
`).join("")),new Rh(De.fromPositions(new Dt(t,r)),o)}else{let t=this.lineRange.endLineNumberExclusive-1,r=e.getTransformer().getLineLength(t)+1,o=new De(this.lineRange.startLineNumber,1,t,r),s=this.newLines.join(`
`);return new Rh(o,s)}}toSingleEdit(e){let t=this.toSingleTextEdit(e),r=e.getTransformer().getOffsetRange(t.range);return gu.replace(r,t.newText)}toString(){return`${this.lineRange}->${JSON.stringify(this.newLines)}`}serialize(){return[this.lineRange.startLineNumber,this.lineRange.endLineNumberExclusive,this.newLines]}removeCommonSuffixPrefixLines(e){let t=this.lineRange.startLineNumber,r=this.lineRange.endLineNumberExclusive,o=0;for(;t<r&&o<this.newLines.length&&this.newLines[o]===e.getLineAt(t);)t++,o++;let s=0;for(;t<r&&s+o<this.newLines.length&&this.newLines[this.newLines.length-1-s]===e.getLineAt(r-1);)r--,s++;return o===0&&s===0?this:new n(new yn(t,r),this.newLines.slice(o,this.newLines.length-s))}},Ph=class n{constructor(e,t){this.base=e;this.edit=t}static fromEdit(e){let t=Y0.fromEdit(e);return new n(e.base,t)}toString(){return this.edit.humanReadablePatch(this.base.getLines())}toEdit(){return this.edit.toEdit(this.base)}toRootedEdit(){return new Q0(this.base,this.toEdit())}getEditedState(){let e=this.base.getLines();return this.edit.apply(e)}removeCommonSuffixPrefixLines(){let e=r=>!r.lineRange.isEmpty||r.newLines.length>0,t=this.edit.edits.map(r=>r.removeCommonSuffixPrefixLines(this.base)).filter(r=>e(r));return new n(this.base,new Y0(t))}};var Lc=class n{constructor(e){this.edits=e}static deserialize(e){return new n(e.map(t=>gu.deserialize(t)))}static{this.empty=new n([])}static create(e){return new n(e)}static single(e){return new n([e])}static replace(e,t){return new n([gu.replace(e,t)])}static fromOffsetEdit(e){return new n(e.edits.map(t=>gu.replace(t.replaceRange,t.newText)))}static compose(e){let t=n.empty;for(let r of e)t=t.compose(r);return t}toOffsetEdit(){return new Rn(this.edits.map(e=>new Pi(e.range,e.newText)))}compose(e){let t=this.toOffsetEdit().compose(e.toOffsetEdit());return n.fromOffsetEdit(t)}getNewRanges(){return this.toOffsetEdit().getNewTextRanges()}apply(e){let t="",r=0;for(let o of this.edits)t+=e.substring(r,o.range.start),t+=o.newText,r=o.range.endExclusive;return t+=e.substring(r),t}normalize(){let e=[],t;for(let r of this.edits)r.newText.length===0&&r.range.length===0||(t&&t.range.endExclusive===r.range.start?t=gu.replace(t.range.join(r.range),t.newText+r.newText):(t&&e.push(t),t=r));return t&&e.push(t),new n(e)}toString(){return this.edits.map(e=>e.toString()).join("")}decompose(e){if(e===void 0){let o=[],s=0;for(let a of this.edits)o.push(n.replace(gt.ofStartAndLength(a.range.start+s,a.range.length),a.newText)),s+=a.newText.length-a.range.length;return o}let t=[],r=this.edits.slice();for(let o=0;o<this.edits.length;++o){let s=e.mapIndex(o),a=r[s],c=n.single(a);t.push(c);for(let l=s;l<r.length;++l){let u=a.newText.length-a.range.length,d=r[l];r[l]=gu.replace(gt.ofStartAndLength(d.range.start+u,d.range.length),d.newText)}}return t}getRange(){if(this.edits.length!==0)return this.edits[0].range.join(this.edits[this.edits.length-1].range)}isEmpty(){return this.edits.length===0}applyInverseToOffsetRange(e){let t=this.toOffsetEdit(),r=t.applyInverseToOffset(e.start),o=t.applyInverseToOffset(e.endExclusive);return new gt(r,o)}serialize(){return this.edits.map(e=>e.serialize())}},gu=class n{constructor(e,t){this.range=e;this.newText=t}static deserialize(e){return new n(new gt(e[0],e[1]),e[2])}static replace(e,t){return new n(e,t)}static insert(e,t){return new n(new gt(e,e),t)}static delete(e){return new n(e,"")}static fromSingleOffsetEdit(e){return new n(e.replaceRange,e.newText)}toString(){return`${this.range}->${JSON.stringify(this.newText)}`}serialize(){return[this.range.start,this.range.endExclusive,this.newText]}toEdit(){return Lc.single(this)}},Q0=class{constructor(e,t){this.base=e;this.edit=t}getEditedState(){return this.base.apply(this.edit)}rebase(e){return Iv(()=>null.base.equals(this.base.apply(e))),Iv(()=>null.base.apply(null.edit).equals(this.base.apply(e).apply(this.edit))),null}toString(){return Ph.fromEdit(this).toString()}};var vu=class n{constructor(e){this.value=e}apply(e){return new n(e.apply(this.value))}equals(e){return this.value===e.value}getTransformer(){return this._transformer||(this._transformer=new QJ(this.value)),this._transformer}getValueOfRange(e){return this.getTransformer().getOffsetRange(e).substring(this.value)}getLines(){return pl(this.value)}getLineAt(e){return this.getLines()[e-1]}toString(){return this.value}},QJ=class{constructor(e){this.text=e;this.lineStartOffsetByLineIdx=[],this.lineEndOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let t=0;t<e.length;t++)e.charAt(t)===`
`&&(this.lineStartOffsetByLineIdx.push(t+1),t>0&&e.charAt(t-1)==="\r"?this.lineEndOffsetByLineIdx.push(t-1):this.lineEndOffsetByLineIdx.push(t));this.lineEndOffsetByLineIdx.push(e.length)}getOffset(e){return this.lineStartOffsetByLineIdx[e.lineNumber-1]+e.column-1}getOffsetRange(e){return new gt(this.getOffset(e.getStartPosition()),this.getOffset(e.getEndPosition()))}getPosition(e){let t=vd(this.lineStartOffsetByLineIdx,s=>s<=e),r=t+1,o=e-this.lineStartOffsetByLineIdx[t]+1;return new Dt(r,o)}getRange(e){return De.fromPositions(this.getPosition(e.start),this.getPosition(e.endExclusive))}getTextLength(e){return Cc.ofRange(this.getRange(e))}get textLength(){let e=this.lineStartOffsetByLineIdx.length-1;return new Cc(e,this.text.length-this.lineStartOffsetByLineIdx[e])}getLineLength(e){return this.lineEndOffsetByLineIdx[e-1]-this.lineStartOffsetByLineIdx[e-1]}};var y1e=q(Aee());var m1e=Object.create(null);function T(n,e){if(R2(e)){let t=m1e[e];if(t===void 0)throw new Error(`${n} references an unknown codicon: ${e}`);e=t}return m1e[n]=e,{id:n}}var h1e={add:T("add",6e4),plus:T("plus",6e4),gistNew:T("gist-new",6e4),repoCreate:T("repo-create",6e4),lightbulb:T("lightbulb",60001),lightBulb:T("light-bulb",60001),repo:T("repo",60002),repoDelete:T("repo-delete",60002),gistFork:T("gist-fork",60003),repoForked:T("repo-forked",60003),gitPullRequest:T("git-pull-request",60004),gitPullRequestAbandoned:T("git-pull-request-abandoned",60004),recordKeys:T("record-keys",60005),keyboard:T("keyboard",60005),tag:T("tag",60006),gitPullRequestLabel:T("git-pull-request-label",60006),tagAdd:T("tag-add",60006),tagRemove:T("tag-remove",60006),person:T("person",60007),personFollow:T("person-follow",60007),personOutline:T("person-outline",60007),personFilled:T("person-filled",60007),gitBranch:T("git-branch",60008),gitBranchCreate:T("git-branch-create",60008),gitBranchDelete:T("git-branch-delete",60008),sourceControl:T("source-control",60008),mirror:T("mirror",60009),mirrorPublic:T("mirror-public",60009),star:T("star",60010),starAdd:T("star-add",60010),starDelete:T("star-delete",60010),starEmpty:T("star-empty",60010),comment:T("comment",60011),commentAdd:T("comment-add",60011),alert:T("alert",60012),warning:T("warning",60012),search:T("search",60013),searchSave:T("search-save",60013),logOut:T("log-out",60014),signOut:T("sign-out",60014),logIn:T("log-in",60015),signIn:T("sign-in",60015),eye:T("eye",60016),eyeUnwatch:T("eye-unwatch",60016),eyeWatch:T("eye-watch",60016),circleFilled:T("circle-filled",60017),primitiveDot:T("primitive-dot",60017),closeDirty:T("close-dirty",60017),debugBreakpoint:T("debug-breakpoint",60017),debugBreakpointDisabled:T("debug-breakpoint-disabled",60017),debugHint:T("debug-hint",60017),terminalDecorationSuccess:T("terminal-decoration-success",60017),primitiveSquare:T("primitive-square",60018),edit:T("edit",60019),pencil:T("pencil",60019),info:T("info",60020),issueOpened:T("issue-opened",60020),gistPrivate:T("gist-private",60021),gitForkPrivate:T("git-fork-private",60021),lock:T("lock",60021),mirrorPrivate:T("mirror-private",60021),close:T("close",60022),removeClose:T("remove-close",60022),x:T("x",60022),repoSync:T("repo-sync",60023),sync:T("sync",60023),clone:T("clone",60024),desktopDownload:T("desktop-download",60024),beaker:T("beaker",60025),microscope:T("microscope",60025),vm:T("vm",60026),deviceDesktop:T("device-desktop",60026),file:T("file",60027),fileText:T("file-text",60027),more:T("more",60028),ellipsis:T("ellipsis",60028),kebabHorizontal:T("kebab-horizontal",60028),mailReply:T("mail-reply",60029),reply:T("reply",60029),organization:T("organization",60030),organizationFilled:T("organization-filled",60030),organizationOutline:T("organization-outline",60030),newFile:T("new-file",60031),fileAdd:T("file-add",60031),newFolder:T("new-folder",60032),fileDirectoryCreate:T("file-directory-create",60032),trash:T("trash",60033),trashcan:T("trashcan",60033),history:T("history",60034),clock:T("clock",60034),folder:T("folder",60035),fileDirectory:T("file-directory",60035),symbolFolder:T("symbol-folder",60035),logoGithub:T("logo-github",60036),markGithub:T("mark-github",60036),github:T("github",60036),terminal:T("terminal",60037),console:T("console",60037),repl:T("repl",60037),zap:T("zap",60038),symbolEvent:T("symbol-event",60038),error:T("error",60039),stop:T("stop",60039),variable:T("variable",60040),symbolVariable:T("symbol-variable",60040),array:T("array",60042),symbolArray:T("symbol-array",60042),symbolModule:T("symbol-module",60043),symbolPackage:T("symbol-package",60043),symbolNamespace:T("symbol-namespace",60043),symbolObject:T("symbol-object",60043),symbolMethod:T("symbol-method",60044),symbolFunction:T("symbol-function",60044),symbolConstructor:T("symbol-constructor",60044),symbolBoolean:T("symbol-boolean",60047),symbolNull:T("symbol-null",60047),symbolNumeric:T("symbol-numeric",60048),symbolNumber:T("symbol-number",60048),symbolStructure:T("symbol-structure",60049),symbolStruct:T("symbol-struct",60049),symbolParameter:T("symbol-parameter",60050),symbolTypeParameter:T("symbol-type-parameter",60050),symbolKey:T("symbol-key",60051),symbolText:T("symbol-text",60051),symbolReference:T("symbol-reference",60052),goToFile:T("go-to-file",60052),symbolEnum:T("symbol-enum",60053),symbolValue:T("symbol-value",60053),symbolRuler:T("symbol-ruler",60054),symbolUnit:T("symbol-unit",60054),activateBreakpoints:T("activate-breakpoints",60055),archive:T("archive",60056),arrowBoth:T("arrow-both",60057),arrowDown:T("arrow-down",60058),arrowLeft:T("arrow-left",60059),arrowRight:T("arrow-right",60060),arrowSmallDown:T("arrow-small-down",60061),arrowSmallLeft:T("arrow-small-left",60062),arrowSmallRight:T("arrow-small-right",60063),arrowSmallUp:T("arrow-small-up",60064),arrowUp:T("arrow-up",60065),bell:T("bell",60066),bold:T("bold",60067),book:T("book",60068),bookmark:T("bookmark",60069),debugBreakpointConditionalUnverified:T("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:T("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:T("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:T("debug-breakpoint-data-unverified",60072),debugBreakpointData:T("debug-breakpoint-data",60073),debugBreakpointDataDisabled:T("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:T("debug-breakpoint-log-unverified",60074),debugBreakpointLog:T("debug-breakpoint-log",60075),debugBreakpointLogDisabled:T("debug-breakpoint-log-disabled",60075),briefcase:T("briefcase",60076),broadcast:T("broadcast",60077),browser:T("browser",60078),bug:T("bug",60079),calendar:T("calendar",60080),caseSensitive:T("case-sensitive",60081),check:T("check",60082),checklist:T("checklist",60083),chevronDown:T("chevron-down",60084),chevronLeft:T("chevron-left",60085),chevronRight:T("chevron-right",60086),chevronUp:T("chevron-up",60087),chromeClose:T("chrome-close",60088),chromeMaximize:T("chrome-maximize",60089),chromeMinimize:T("chrome-minimize",60090),chromeRestore:T("chrome-restore",60091),circleOutline:T("circle-outline",60092),circle:T("circle",60092),debugBreakpointUnverified:T("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:T("terminal-decoration-incomplete",60092),circleSlash:T("circle-slash",60093),circuitBoard:T("circuit-board",60094),clearAll:T("clear-all",60095),clippy:T("clippy",60096),closeAll:T("close-all",60097),cloudDownload:T("cloud-download",60098),cloudUpload:T("cloud-upload",60099),code:T("code",60100),collapseAll:T("collapse-all",60101),colorMode:T("color-mode",60102),commentDiscussion:T("comment-discussion",60103),creditCard:T("credit-card",60105),dash:T("dash",60108),dashboard:T("dashboard",60109),database:T("database",60110),debugContinue:T("debug-continue",60111),debugDisconnect:T("debug-disconnect",60112),debugPause:T("debug-pause",60113),debugRestart:T("debug-restart",60114),debugStart:T("debug-start",60115),debugStepInto:T("debug-step-into",60116),debugStepOut:T("debug-step-out",60117),debugStepOver:T("debug-step-over",60118),debugStop:T("debug-stop",60119),debug:T("debug",60120),deviceCameraVideo:T("device-camera-video",60121),deviceCamera:T("device-camera",60122),deviceMobile:T("device-mobile",60123),diffAdded:T("diff-added",60124),diffIgnored:T("diff-ignored",60125),diffModified:T("diff-modified",60126),diffRemoved:T("diff-removed",60127),diffRenamed:T("diff-renamed",60128),diff:T("diff",60129),diffSidebyside:T("diff-sidebyside",60129),discard:T("discard",60130),editorLayout:T("editor-layout",60131),emptyWindow:T("empty-window",60132),exclude:T("exclude",60133),extensions:T("extensions",60134),eyeClosed:T("eye-closed",60135),fileBinary:T("file-binary",60136),fileCode:T("file-code",60137),fileMedia:T("file-media",60138),filePdf:T("file-pdf",60139),fileSubmodule:T("file-submodule",60140),fileSymlinkDirectory:T("file-symlink-directory",60141),fileSymlinkFile:T("file-symlink-file",60142),fileZip:T("file-zip",60143),files:T("files",60144),filter:T("filter",60145),flame:T("flame",60146),foldDown:T("fold-down",60147),foldUp:T("fold-up",60148),fold:T("fold",60149),folderActive:T("folder-active",60150),folderOpened:T("folder-opened",60151),gear:T("gear",60152),gift:T("gift",60153),gistSecret:T("gist-secret",60154),gist:T("gist",60155),gitCommit:T("git-commit",60156),gitCompare:T("git-compare",60157),compareChanges:T("compare-changes",60157),gitMerge:T("git-merge",60158),githubAction:T("github-action",60159),githubAlt:T("github-alt",60160),globe:T("globe",60161),grabber:T("grabber",60162),graph:T("graph",60163),gripper:T("gripper",60164),heart:T("heart",60165),home:T("home",60166),horizontalRule:T("horizontal-rule",60167),hubot:T("hubot",60168),inbox:T("inbox",60169),issueReopened:T("issue-reopened",60171),issues:T("issues",60172),italic:T("italic",60173),jersey:T("jersey",60174),json:T("json",60175),kebabVertical:T("kebab-vertical",60176),key:T("key",60177),law:T("law",60178),lightbulbAutofix:T("lightbulb-autofix",60179),linkExternal:T("link-external",60180),link:T("link",60181),listOrdered:T("list-ordered",60182),listUnordered:T("list-unordered",60183),liveShare:T("live-share",60184),loading:T("loading",60185),location:T("location",60186),mailRead:T("mail-read",60187),mail:T("mail",60188),markdown:T("markdown",60189),megaphone:T("megaphone",60190),mention:T("mention",60191),milestone:T("milestone",60192),gitPullRequestMilestone:T("git-pull-request-milestone",60192),mortarBoard:T("mortar-board",60193),move:T("move",60194),multipleWindows:T("multiple-windows",60195),mute:T("mute",60196),noNewline:T("no-newline",60197),note:T("note",60198),octoface:T("octoface",60199),openPreview:T("open-preview",60200),package:T("package",60201),paintcan:T("paintcan",60202),pin:T("pin",60203),play:T("play",60204),run:T("run",60204),plug:T("plug",60205),preserveCase:T("preserve-case",60206),preview:T("preview",60207),project:T("project",60208),pulse:T("pulse",60209),question:T("question",60210),quote:T("quote",60211),radioTower:T("radio-tower",60212),reactions:T("reactions",60213),references:T("references",60214),refresh:T("refresh",60215),regex:T("regex",60216),remoteExplorer:T("remote-explorer",60217),remote:T("remote",60218),remove:T("remove",60219),replaceAll:T("replace-all",60220),replace:T("replace",60221),repoClone:T("repo-clone",60222),repoForcePush:T("repo-force-push",60223),repoPull:T("repo-pull",60224),repoPush:T("repo-push",60225),report:T("report",60226),requestChanges:T("request-changes",60227),rocket:T("rocket",60228),rootFolderOpened:T("root-folder-opened",60229),rootFolder:T("root-folder",60230),rss:T("rss",60231),ruby:T("ruby",60232),saveAll:T("save-all",60233),saveAs:T("save-as",60234),save:T("save",60235),screenFull:T("screen-full",60236),screenNormal:T("screen-normal",60237),searchStop:T("search-stop",60238),server:T("server",60240),settingsGear:T("settings-gear",60241),settings:T("settings",60242),shield:T("shield",60243),smiley:T("smiley",60244),sortPrecedence:T("sort-precedence",60245),splitHorizontal:T("split-horizontal",60246),splitVertical:T("split-vertical",60247),squirrel:T("squirrel",60248),starFull:T("star-full",60249),starHalf:T("star-half",60250),symbolClass:T("symbol-class",60251),symbolColor:T("symbol-color",60252),symbolConstant:T("symbol-constant",60253),symbolEnumMember:T("symbol-enum-member",60254),symbolField:T("symbol-field",60255),symbolFile:T("symbol-file",60256),symbolInterface:T("symbol-interface",60257),symbolKeyword:T("symbol-keyword",60258),symbolMisc:T("symbol-misc",60259),symbolOperator:T("symbol-operator",60260),symbolProperty:T("symbol-property",60261),wrench:T("wrench",60261),wrenchSubaction:T("wrench-subaction",60261),symbolSnippet:T("symbol-snippet",60262),tasklist:T("tasklist",60263),telescope:T("telescope",60264),textSize:T("text-size",60265),threeBars:T("three-bars",60266),thumbsdown:T("thumbsdown",60267),thumbsup:T("thumbsup",60268),tools:T("tools",60269),triangleDown:T("triangle-down",60270),triangleLeft:T("triangle-left",60271),triangleRight:T("triangle-right",60272),triangleUp:T("triangle-up",60273),twitter:T("twitter",60274),unfold:T("unfold",60275),unlock:T("unlock",60276),unmute:T("unmute",60277),unverified:T("unverified",60278),verified:T("verified",60279),versions:T("versions",60280),vmActive:T("vm-active",60281),vmOutline:T("vm-outline",60282),vmRunning:T("vm-running",60283),watch:T("watch",60284),whitespace:T("whitespace",60285),wholeWord:T("whole-word",60286),window:T("window",60287),wordWrap:T("word-wrap",60288),zoomIn:T("zoom-in",60289),zoomOut:T("zoom-out",60290),listFilter:T("list-filter",60291),listFlat:T("list-flat",60292),listSelection:T("list-selection",60293),selection:T("selection",60293),listTree:T("list-tree",60294),debugBreakpointFunctionUnverified:T("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:T("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:T("debug-breakpoint-function-disabled",60296),debugStackframeActive:T("debug-stackframe-active",60297),circleSmallFilled:T("circle-small-filled",60298),debugStackframeDot:T("debug-stackframe-dot",60298),terminalDecorationMark:T("terminal-decoration-mark",60298),debugStackframe:T("debug-stackframe",60299),debugStackframeFocused:T("debug-stackframe-focused",60299),debugBreakpointUnsupported:T("debug-breakpoint-unsupported",60300),symbolString:T("symbol-string",60301),debugReverseContinue:T("debug-reverse-continue",60302),debugStepBack:T("debug-step-back",60303),debugRestartFrame:T("debug-restart-frame",60304),debugAlt:T("debug-alt",60305),callIncoming:T("call-incoming",60306),callOutgoing:T("call-outgoing",60307),menu:T("menu",60308),expandAll:T("expand-all",60309),feedback:T("feedback",60310),gitPullRequestReviewer:T("git-pull-request-reviewer",60310),groupByRefType:T("group-by-ref-type",60311),ungroupByRefType:T("ungroup-by-ref-type",60312),account:T("account",60313),gitPullRequestAssignee:T("git-pull-request-assignee",60313),bellDot:T("bell-dot",60314),debugConsole:T("debug-console",60315),library:T("library",60316),output:T("output",60317),runAll:T("run-all",60318),syncIgnored:T("sync-ignored",60319),pinned:T("pinned",60320),githubInverted:T("github-inverted",60321),serverProcess:T("server-process",60322),serverEnvironment:T("server-environment",60323),pass:T("pass",60324),issueClosed:T("issue-closed",60324),stopCircle:T("stop-circle",60325),playCircle:T("play-circle",60326),record:T("record",60327),debugAltSmall:T("debug-alt-small",60328),vmConnect:T("vm-connect",60329),cloud:T("cloud",60330),merge:T("merge",60331),export:T("export",60332),graphLeft:T("graph-left",60333),magnet:T("magnet",60334),notebook:T("notebook",60335),redo:T("redo",60336),checkAll:T("check-all",60337),pinnedDirty:T("pinned-dirty",60338),passFilled:T("pass-filled",60339),circleLargeFilled:T("circle-large-filled",60340),circleLarge:T("circle-large",60341),circleLargeOutline:T("circle-large-outline",60341),combine:T("combine",60342),gather:T("gather",60342),table:T("table",60343),variableGroup:T("variable-group",60344),typeHierarchy:T("type-hierarchy",60345),typeHierarchySub:T("type-hierarchy-sub",60346),typeHierarchySuper:T("type-hierarchy-super",60347),gitPullRequestCreate:T("git-pull-request-create",60348),runAbove:T("run-above",60349),runBelow:T("run-below",60350),notebookTemplate:T("notebook-template",60351),debugRerun:T("debug-rerun",60352),workspaceTrusted:T("workspace-trusted",60353),workspaceUntrusted:T("workspace-untrusted",60354),workspaceUnknown:T("workspace-unknown",60355),terminalCmd:T("terminal-cmd",60356),terminalDebian:T("terminal-debian",60357),terminalLinux:T("terminal-linux",60358),terminalPowershell:T("terminal-powershell",60359),terminalTmux:T("terminal-tmux",60360),terminalUbuntu:T("terminal-ubuntu",60361),terminalBash:T("terminal-bash",60362),arrowSwap:T("arrow-swap",60363),copy:T("copy",60364),personAdd:T("person-add",60365),filterFilled:T("filter-filled",60366),wand:T("wand",60367),debugLineByLine:T("debug-line-by-line",60368),inspect:T("inspect",60369),layers:T("layers",60370),layersDot:T("layers-dot",60371),layersActive:T("layers-active",60372),compass:T("compass",60373),compassDot:T("compass-dot",60374),compassActive:T("compass-active",60375),azure:T("azure",60376),issueDraft:T("issue-draft",60377),gitPullRequestClosed:T("git-pull-request-closed",60378),gitPullRequestDraft:T("git-pull-request-draft",60379),debugAll:T("debug-all",60380),debugCoverage:T("debug-coverage",60381),runErrors:T("run-errors",60382),folderLibrary:T("folder-library",60383),debugContinueSmall:T("debug-continue-small",60384),beakerStop:T("beaker-stop",60385),graphLine:T("graph-line",60386),graphScatter:T("graph-scatter",60387),pieChart:T("pie-chart",60388),bracket:T("bracket",60175),bracketDot:T("bracket-dot",60389),bracketError:T("bracket-error",60390),lockSmall:T("lock-small",60391),azureDevops:T("azure-devops",60392),verifiedFilled:T("verified-filled",60393),newline:T("newline",60394),layout:T("layout",60395),layoutActivitybarLeft:T("layout-activitybar-left",60396),layoutActivitybarRight:T("layout-activitybar-right",60397),layoutPanelLeft:T("layout-panel-left",60398),layoutPanelCenter:T("layout-panel-center",60399),layoutPanelJustify:T("layout-panel-justify",60400),layoutPanelRight:T("layout-panel-right",60401),layoutPanel:T("layout-panel",60402),layoutSidebarLeft:T("layout-sidebar-left",60403),layoutSidebarRight:T("layout-sidebar-right",60404),layoutStatusbar:T("layout-statusbar",60405),layoutMenubar:T("layout-menubar",60406),layoutCentered:T("layout-centered",60407),target:T("target",60408),indent:T("indent",60409),recordSmall:T("record-small",60410),errorSmall:T("error-small",60411),terminalDecorationError:T("terminal-decoration-error",60411),arrowCircleDown:T("arrow-circle-down",60412),arrowCircleLeft:T("arrow-circle-left",60413),arrowCircleRight:T("arrow-circle-right",60414),arrowCircleUp:T("arrow-circle-up",60415),layoutSidebarRightOff:T("layout-sidebar-right-off",60416),layoutPanelOff:T("layout-panel-off",60417),layoutSidebarLeftOff:T("layout-sidebar-left-off",60418),blank:T("blank",60419),heartFilled:T("heart-filled",60420),map:T("map",60421),mapHorizontal:T("map-horizontal",60421),foldHorizontal:T("fold-horizontal",60421),mapFilled:T("map-filled",60422),mapHorizontalFilled:T("map-horizontal-filled",60422),foldHorizontalFilled:T("fold-horizontal-filled",60422),circleSmall:T("circle-small",60423),bellSlash:T("bell-slash",60424),bellSlashDot:T("bell-slash-dot",60425),commentUnresolved:T("comment-unresolved",60426),gitPullRequestGoToChanges:T("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:T("git-pull-request-new-changes",60428),searchFuzzy:T("search-fuzzy",60429),commentDraft:T("comment-draft",60430),send:T("send",60431),sparkle:T("sparkle",60432),insert:T("insert",60433),mic:T("mic",60434),thumbsdownFilled:T("thumbsdown-filled",60435),thumbsupFilled:T("thumbsup-filled",60436),coffee:T("coffee",60437),snake:T("snake",60438),game:T("game",60439),vr:T("vr",60440),chip:T("chip",60441),piano:T("piano",60442),music:T("music",60443),micFilled:T("mic-filled",60444),repoFetch:T("repo-fetch",60445),copilot:T("copilot",60446),lightbulbSparkle:T("lightbulb-sparkle",60447),robot:T("robot",60448),sparkleFilled:T("sparkle-filled",60449),diffSingle:T("diff-single",60450),diffMultiple:T("diff-multiple",60451),surroundWith:T("surround-with",60452),share:T("share",60453),gitStash:T("git-stash",60454),gitStashApply:T("git-stash-apply",60455),gitStashPop:T("git-stash-pop",60456),vscode:T("vscode",60457),vscodeInsiders:T("vscode-insiders",60458),codeOss:T("code-oss",60459),runCoverage:T("run-coverage",60460),runAllCoverage:T("run-all-coverage",60461),coverage:T("coverage",60462),githubProject:T("github-project",60463),mapVertical:T("map-vertical",60464),foldVertical:T("fold-vertical",60464),mapVerticalFilled:T("map-vertical-filled",60465),foldVerticalFilled:T("fold-vertical-filled",60465),goToSearch:T("go-to-search",60466),percentage:T("percentage",60467),sortPercentage:T("sort-percentage",60467),attach:T("attach",60468)};var rnt={dialogError:T("dialog-error","error"),dialogWarning:T("dialog-warning","warning"),dialogInfo:T("dialog-info","info"),dialogClose:T("dialog-close","close"),treeItemExpanded:T("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:T("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:T("tree-filter-on-type-off","list-selection"),treeFilterClear:T("tree-filter-clear","close"),treeItemLoading:T("tree-item-loading","loading"),menuSelection:T("menu-selection","check"),menuSubmenu:T("menu-submenu","chevron-right"),menuBarMore:T("menubar-more","more"),scrollbarButtonLeft:T("scrollbar-button-left","triangle-left"),scrollbarButtonRight:T("scrollbar-button-right","triangle-right"),scrollbarButtonUp:T("scrollbar-button-up","triangle-up"),scrollbarButtonDown:T("scrollbar-button-down","triangle-down"),toolBarMore:T("toolbar-more","more"),quickInputBack:T("quick-input-back","arrow-left"),dropDownButton:T("drop-down-button",60084),symbolCustomColor:T("symbol-customcolor",60252),exportIcon:T("export",60332),workspaceUnspecified:T("workspace-unspecified",60355),newLine:T("newline",60394),thumbsDownFilled:T("thumbsdown-filled",60435),thumbsUpFilled:T("thumbsup-filled",60436),gitFetch:T("git-fetch",60445),lightbulbSparkleAutofix:T("lightbulb-sparkle-autofix",60447),debugBreakpointPending:T("debug-breakpoint-pending",60377)},_r={...h1e,...rnt};var g1e;(e=>{function n(t){return t&&typeof t=="object"&&typeof t.id=="string"}e.isThemeColor=n})(g1e||={});var CL;(g=>{g.iconNameSegment="[A-Za-z0-9]+",g.iconNameExpression="[A-Za-z0-9-]+",g.iconModifierExpression="~[A-Za-z]+",g.iconNameCharacter="[A-Za-z0-9~-]";let o=new RegExp(`^(${g.iconNameExpression})(${g.iconModifierExpression})?$`);function s(y){let b=o.exec(y.id);if(!b)return s(_r.error);let[,_,x]=b,I=["codicon","codicon-"+_];return x&&I.push("codicon-modifier-"+x.substring(1)),I}g.asClassNameArray=s;function a(y){return s(y).join(" ")}g.asClassName=a;function c(y){return"."+s(y).join(".")}g.asCSSSelector=c;function l(y){return y&&typeof y=="object"&&typeof y.id=="string"&&(typeof y.color>"u"||g1e.isThemeColor(y.color))}g.isThemeIcon=l;let u=new RegExp(`^\\$\\((${g.iconNameExpression}(?:${g.iconModifierExpression})?)\\)$`);function d(y){let b=u.exec(y);if(!b)return;let[,_]=b;return{id:_}}g.fromString=d;function p(y){return{id:y}}g.fromId=p;function f(y,b){let _=y.id,x=_.lastIndexOf("~");return x!==-1&&(_=_.substring(0,x)),b&&(_=`${_}~${b}`),{id:_}}g.modify=f;function m(y){let b=y.id.lastIndexOf("~");if(b!==-1)return y.id.substring(b+1)}g.getModifier=m;function h(y,b){return y.id===b.id&&y.color?.id===b.color?.id}g.isEqual=h})(CL||={});var Nh=class extends dt{constructor(t){super();this.extraInformation=t}};var Gx=class n{constructor(e){this.parts=e}static str(e,...t){if(typeof e=="string")return new n([e]);{let r=[];for(let o=0;o<e.length;o++)r.push(e[o]),o<t.length&&r.push({value:t[o]});return new n(r)}}toString(){return PU(this,0)}};function PU(n,e){if(n&&typeof n=="object"){if(n instanceof Gx){let r=0,o=n.parts.map(s=>typeof s=="string"?(r=int(s),s):PU(s.value,r)).join("");return Dee(o,e)}if(Array.isArray(n)){let r=[];for(let o of n)r.push(PU(o,e+1));return`[
`+r.map(o=>EL(o,e+1)+`,
`).join("")+EL("]",e)}let t=[];for(let[r,o]of Object.entries(n))t.push(`${ont(r)}: ${PU(o,e+1)},
`);return`{
`+t.map(r=>EL(r,e+1)).join("")+EL("}",e)}return Dee(n===void 0?"undefined":JSON.stringify(n,void 0,"	"),e)}function int(n){let e=n.split(`
`),t=e[e.length-1];return t.length-t.trimStart().length}function Dee(n,e){return n.split(`
`).map((r,o)=>o===0?r:EL(r,e)).join(`
`)}function EL(n,e){return"	".repeat(e)+n}function ont(n){return/^[a-zA-Z_]\w*$/.test(n)?n:JSON.stringify(n)}var UE=class n{constructor(e,t){this.filePath=e;this.version=t;this.requestId=n._id++;this.time=TE();this._isVisible=!1;this._nextEditRequest=void 0;this._resultEdit=void 0;this.prompt=void 0;this.isCachedResult=void 0;this._icon=void 0;this.error=void 0;this.responseResults=void 0;this._recentEdit=void 0;this._logs=[]}static{this._id=0}get includeInLogTree(){return this._isVisible}toLogDocument(){let e=[];if(e.push("# "+this.getDebugName()+` (RequestId: ${this.requestId})`),this._nextEditRequest&&(e.push("## User Edit"),e.push(`<details open><summary>Edit</summary>
`),e.push(this._nextEditRequest.toMarkdown()),e.push(`
</details>
`)),this._resultEdit&&(e.push(`## Computed Next Edit ${this.isCachedResult===void 0?"":this.isCachedResult?"(cached)":"(not cached)"}`),e.push(`<details open><summary>Edit</summary>
`),e.push("``` patch"),e.push(this._resultEdit.toString()),e.push("```"),e.push(`
</details>
`)),this.prompt){e.push("## Prompt"),e.push(`<details><summary>Value</summary>
`);let t=this.prompt;e.push("```"),e.push(...t.split(`
`)),e.push("```"),e.push(`
</details>
`)}return this.error&&(e.push("## Error"),e.push("```"),e.push(String(this.error)),this.error instanceof Error&&(e.push(""),e.push(String(this.error.stack))),e.push("```")),this.responseResults&&(e.push("## Response Results"),e.push(`<details open><summary>Value</summary>
`),e.push("```"),e.push(y1e.stringify(this.responseResults,null,"	")),e.push("```"),e.push(`
</details>
`)),this._logs.length>0&&(e.push("## Logs"),e.push(`<details open><summary>Logs</summary>
`),e.push(...this._logs),e.push(`
</details>
`)),e.join(`
`)}get inputEdit(){if(this._nextEditRequest)return new Ph(new vu(this._nextEditRequest.documents[0].documentLinesBeforeEdit.join(`
`)),this._nextEditRequest.documents[0].recentEdit)}setRequestInput(e){this._isVisible=!0,this._nextEditRequest=e}setResult(e){this._isVisible=!0,this._resultEdit=e}setIsCachedResult(e){this._isVisible=!0,this.isCachedResult=e}setPrompt(e){this._isVisible=!0,this.prompt=e}getIcon(){return this._icon}markAsNoSuggestions(){this._isVisible=!0,this._icon=CL.fromId("testing-unset-icon")}setError(e){this._isVisible=!0,this.error=e,this.error instanceof Nh?this._icon=CL.fromId("testing-skipped-icon"):wo(this.error)?this._isVisible=!1:this._icon=CL.fromId("error")}setResponseResults(e){this._isVisible=!0,this.responseResults=e}getDebugName(){return`Inline Edit ${this.version} | ${v1e(this.filePath)}`}setRecentEdit(e){this._recentEdit=e}addLog(e){this._logs.push(e.replace(`
`,"\\n").replace("	","\\t").replace("`","`")+`
`)}addListToLog(e){e.forEach(t=>this.addLog(`- ${t}`))}addCodeblockToLog(e,t=""){this._logs.push(`\`\`\`${t}
${e}
\`\`\`
`)}createTestCase(){if(!this._recentEdit)throw new Xt;return{recentWorkspaceEdits:this._recentEdit.editedDocuments.map(e=>({path:e.docUri,initialText:e.lastEdit.base.value,edit:e.lastEdit.edit.serialize()}))}}createTestCaseTs(){let e=this.createTestCase(),{recentWorkspaceEdits:t,...r}=e;return Gx.str`
stest("MyTest", async collection => {
	const result = await tester.runTest(collection, ${{recentEdit:t.map(o=>Gx.str`{
	base: loadInlineEditBaseFile({
		fileName: ${`MyTest/${v1e(o.path)}`},
		fileContent: ${o.initialText},
		virtualFileName: ${o.path},
	}),
	edit: ${Gx.str(JSON.stringify(o.edit))}
}`),...r}});
});
`.toString()}};function v1e(n){let e=Math.max(n.lastIndexOf("/"),n.lastIndexOf("\\"));return e===-1?n:n.slice(e+1)}var zx=0;function AU(n){return n===0}var wl=2**26;function BE(n,e){return n*wl+e}function Lh(n){let e=n,t=Math.floor(e/wl),r=e-t*wl;return new Cc(t,r)}function wL(n,e){let t=n+e;return e>=wl&&(t=t-n%wl),t}function b1e(n,e){return n.reduce((t,r)=>wL(t,e(r)),zx)}function Nee(n,e){return n===e}function kL(n,e){let t=n,r=e;if(r-t<=0)return zx;let s=Math.floor(t/wl),a=Math.floor(r/wl),c=r-a*wl;if(s===a){let l=t-s*wl;return BE(0,c-l)}else return BE(a-s,c)}function _1e(n,e){let t=n,r=Math.floor(t/wl),o=t-r*wl,s=e,a=Math.floor(s/wl),c=s-a*wl;return new De(r+1,o+1,a+1,c+1)}var qE=class{constructor(e,t,r){this.startOffset=e;this.endOffset=t;this.newLength=r}toString(){return`[${Lh(this.startOffset)}...${Lh(this.endOffset)}) -> ${Lh(this.newLength)}`}};function S1e(n,e){if(n.length===0)return e;if(e.length===0)return n;let t=new lF(x1e(n)),r=x1e(e);r.push({modified:!1,lengthBefore:void 0,lengthAfter:void 0});let o=t.dequeue();function s(u){if(u===void 0){let p=t.takeWhile(f=>!0)||[];return o&&p.unshift(o),p}let d=[];for(;o&&!AU(u);){let[p,f]=o.splitAt(u);d.push(p),u=kL(p.lengthAfter,u),o=f??t.dequeue()}return AU(u)||d.push(new RL(!1,u,u)),d}let a=[];function c(u,d,p){if(a.length>0&&Nee(a[a.length-1].endOffset,u)){let f=a[a.length-1];a[a.length-1]=new qE(f.startOffset,d,wL(f.newLength,p))}else a.push({startOffset:u,endOffset:d,newLength:p})}let l=zx;for(let u of r){let d=s(u.lengthBefore);if(u.modified){let p=b1e(d,m=>m.lengthBefore),f=wL(l,p);c(l,f,u.lengthAfter),l=f}else for(let p of d){let f=l;l=wL(l,p.lengthBefore),p.modified&&c(f,l,p.lengthAfter)}}return a}var RL=class n{constructor(e,t,r){this.modified=e;this.lengthBefore=t;this.lengthAfter=r}splitAt(e){let t=kL(e,this.lengthAfter);return Nee(t,zx)?[this,void 0]:this.modified?[new n(this.modified,this.lengthBefore,e),new n(this.modified,zx,t)]:[new n(this.modified,e,e),new n(this.modified,t,t)]}toString(){return`${this.modified?"M":"U"}:${Lh(this.lengthBefore)} -> ${Lh(this.lengthAfter)}`}};function x1e(n){let e=[],t=zx;for(let r of n){let o=kL(t,r.startOffset);AU(o)||e.push(new RL(!1,o,o));let s=kL(r.startOffset,r.endOffset);e.push(new RL(!0,s,r.newLength)),t=r.endOffset}return e}var PL=class n{constructor(e){this.edits=e}static{this.empty=new n([])}static fromTextEdit(e){let t=e.edits.map(r=>new DU(r.range,Cc.ofText(r.newText)));return new n(t)}static _fromTextEditInfo(e){let t=e.map(r=>{let o=Lh(r.newLength);return new DU(_1e(r.startOffset,r.endOffset),new Cc(o.lineCount,o.columnCount))});return new n(t)}_toTextEditInfo(){return this.edits.map(e=>new qE(BE(e.range.startLineNumber-1,e.range.startColumn-1),BE(e.range.endLineNumber-1,e.range.endColumn-1),BE(e.newLength.lineCount,e.newLength.columnCount)))}compose(e){let t=this._toTextEditInfo(),r=e._toTextEditInfo(),o=S1e(t,r);return n._fromTextEditInfo(o)}getRange(){if(this.edits.length!==0)return De.fromPositions(this.edits[0].range.getStartPosition(),this.edits.at(-1).range.getEndPosition())}toString(){return`[${this.edits.join(", ")}]`}},DU=class{constructor(e,t){this.range=e;this.newLength=t}toString(){return`{ range: ${this.range}, newLength: ${this.newLength} }`}};var NU=class{constructor(e){this.editedDocuments=e;Sv(e.length>0)}getMostRecentEditedDocument(){return this.editedDocuments.at(-1)}getDocument(e){return this.editedDocuments.find(t=>t.docUri===e)}getDocumentAndIdx(e){let t=this.editedDocuments.findIndex(r=>r.docUri===e);if(t!==-1)return{doc:this.editedDocuments[t],idx:t}}},LU=class{constructor(e,t,r){this.docUri=e;this.lastEdit=t;this.lastEditedRangeBeforeEdit=r}};var OU=class{constructor(){this._documentState=new Map;this._lastDocuments=new Oee(50)}handleDocumentOpened(e,t){this._documentState.set(e,new Lee(e,t.value))}handleEdit(e,t){let r=this._documentState.get(e);this._lastDocuments.push(r),r.handleEdit(t)}handleSelectionChanged(e){let t=this._documentState.get(e);t&&t.markAsUserDocument()}handleDocumentClosed(e){this._documentState.delete(e)}getHistoryContext(e){let t=this._documentState.get(e);if(!t||!this._lastDocuments.has(t))return;let r=[],o=5;for(let s of this._lastDocuments.getItemsReversed()){let a=s.getRecentEdit(o);if(a&&(r.push(a.edits),o-=a.editCount,o<=0))break}if(r.reverse(),!!r.some(s=>s.docUri===e))return new NU(r)}},Lee=class{constructor(e,t){this.docUri=e;this._edits=[];this._isUserDocument=!1;this._baseValue=new vu(t),this._currentValue=this._baseValue}markAsUserDocument(){this._isUserDocument=!0}handleEdit(e){if(e.isEmpty())return;this._currentValue=this._currentValue.apply(e);let t=CE.fromEdit(e,this._currentValue),r=PL.fromTextEdit(t);function o(a){return I1e(a.edits,c=>c.newText.length)}let s=this._edits.at(-1);s&&o(s.edit)<200&&snt(e,s.edit)?(s.edit=s.edit.compose(e),s.textLengthEdit=s.textLengthEdit.compose(r),s.instant=TE(),s.edit.isEmpty()&&this._edits.pop()):this._edits.push({edit:e,textLengthEdit:r,instant:TE()})}getRecentEdit(e){if(this._applyStaleEdits(e),!this._isUserDocument||this._edits.length===0)return;let t=Lc.compose(this._edits.map(a=>a.edit)),r=this._edits.at(-1).edit,o=t.applyInverseToOffsetRange(r.getNewRanges()[0]),s=new Q0(this._baseValue,t);return{edits:new LU(this.docUri,s,o),editCount:this._edits.length}}_applyStaleEdits(e){let t=Lc.empty,r=PL.empty,o,s=0;for(o=this._edits.length-1;o>=0;o--){let a=this._edits[o];if(s+=a.edit.edits.length,s>=e||TE()-a.instant>10*60*1e3)break;let c=a.textLengthEdit.compose(r),l=c.getRange();if(Vs(l,"we only compose non-empty Edits"),l.endLineNumber-l.startLineNumber>100||I1e(a.textLengthEdit.edits,d=>d.range.endLineNumber-d.range.startLineNumber+d.newLength.lineCount)>10)break;t=a.edit.compose(t),r=c}for(let a=0;a<=o;a++){let c=this._edits[a];this._baseValue=this._baseValue.apply(c.edit)}this._edits=this._edits.slice(o+1)}};function I1e(n,e){let t=0;for(let r of n)t+=e(r);return t}function snt(n,e){let t=e.getNewRanges();return n.edits.every(r=>ant(r.range,t))}function ant(n,e){let t=cF(e,r=>r.endExclusive>=n.start);return t?t.intersectsOrTouches(n):!1}var Oee=class{constructor(e){this.maxSize=e;this._arr=[]}push(e){let t=this._arr.indexOf(e);t!==-1?this._arr.splice(t,1):this._arr.length>=this.maxSize&&this._arr.shift(),this._arr.push(e)}getItemsReversed(){let e=[...this._arr];return e.reverse(),e}has(e){return this._arr.indexOf(e)!==-1}};function MU(n,e,t,r){return e||(e=o=>o!=null),new Promise((o,s)=>{let a=!0,c=!1,l=n.map(d=>({isFinished:e(d),error:t?t(d):!1,state:d})),u=Yl(d=>{let{isFinished:p,error:f,state:m}=l.read(d);(p||f)&&(a?c=!0:u.dispose(),f?s(f===!0?m:f):o(m))});if(r){let d=r.onCancellationRequested(()=>{u.dispose(),d.dispose(),s(new dt)});if(r.isCancellationRequested){u.dispose(),d.dispose(),s(new dt);return}}a=!1,c&&u.dispose()})}var cnt=!1;cnt&&Hhe(new UF);var FU=require("path"),HE=q(require("vscode"));var Mee="---------------------------------",jE=class{constructor(e){this._instantiationService=e}async reportInline(e,t,r){if(!await this._instantiationService.createInstance(sy).canReport())return;let s=e.getLatestTurn();if(!s)return;let a=t.intent?this._embedCodeblock("INTENT",t.intent.id):"",c=this._embedCodeblock("CONTEXT",JSON.stringify({document:t.document.uri.toString(),fileIndentInfo:t.fileIndentInfo,language:t.language,wholeRange:t.wholeRange,selection:t.selection},null,"	")),l="",u=s.chatMessages;if(u&&u.length>0){let m=u.map(h=>this._embedCodeblock(h.role.toUpperCase(),h.content)).join(`
`);l=`	${Mee}
${this._headerSeparator()}PROMPT MESSAGES:
${m}`}else l=this._embedCodeblock(s.request.type.toUpperCase(),s.request.message);let d=this._embedCodeblock("ASSISTANT",s.response?.message||""),p=this._embedCodeblock("Interaction outcome",JSON.stringify(r,null,"	")),f=[];T1e(f,a,c,l,d,p),C1e(f,s),await this._reportIssue("Feedback for inline chat",f.join(`
`))}async reportChat(e){if(!await this._instantiationService.createInstance(sy).canReport())return;let r="",o=e.chatMessages;if(o&&o.length>0){let d=o.map(p=>this._embedCodeblock(p.role.toUpperCase(),p.content)).join(`
`);r=`	${Mee}
${this._headerSeparator()}PROMPT MESSAGES:
${d}`}else r=this._embedCodeblock(e.request.type.toUpperCase(),e.request.message);let s=e.intentInvocation?.intent?this._embedCodeblock("INTENT",`[${e.intentInvocation.intent.id}] ${e.intentInvocation.intent.description}`):"",a=this._embedCodeblock("ASSISTANT",e.response?.message||""),c=await this._instantiationService.createInstance(Fx).captureWorkspaceStateSnapshot([]),l=this._embedCodeblock("WORKSPACE STATE",JSON.stringify(c,null,2)),u=[];T1e(u,s,r,a,l),await C1e(u,e),await this._reportIssue("Feedback for sidebar chat",u.join(`
`))}_embedCodeblock(e,t){let r=this._bodySeparator()+t.split(`
`).join(`
${this._bodySeparator()}`);return`	${Mee}
${this._headerSeparator()}${e}:
${r}`}_headerSeparator(){return"	"}_bodySeparator(){return"		"}async _reportIssue(e,t){Fee({title:e,data:t})}};jE=E([v(0,H)],jE);async function Fee(n){await HE.commands.executeCommand("workbench.action.openIssueReporter",{extensionId:lh,issueTitle:n.title,data:n.data,issueBody:n.issueBody??"",uri:HE.Uri.parse("https://github.com/microsoft/vscode-copilot")})}function T1e(n,...e){n.push("<details><summary>Prompt Details</summary>","<p>",...e,"</p>","</details>")}async function C1e(n,e){let t=await Uee(e);t&&n.push("<details><summary>STest</summary>","<p>","STest code:","","```ts",...t,"```","</p>","</details>")}async function Uee(n){let e=n.intentInvocation;if(e){if(e.location===1)return lnt(n);if(e.location===3)return unt(n)}}function lnt(n){let e=n.requestDebugInformation;if(!e)return;let t=(0,FU.basename)(e.uri.path),r=o=>JSON.stringify(o);return[`stest({ description: 'Issue #XXXXX', language: ${r(e.languageId)}, model }, (testingServiceCollection) => {`,"	return simulateInlineChat(testingServiceCollection, {","		files: [toFile({",`			fileName: ${r(`${e.intentId}/issue-XXXXX/${t}`)},`,`			fileContent: ${r(e.initialDocumentText)}`,"		})],","		queries: [","			{",`				file: ${r(t)},`,`				selection: ${r(E1e(e.userSelection))},`,`				query: ${r(e.userPrompt)},`,"				diagnostics: 'tsc',",`				expectedIntent: ${r(e.intentId)},`,"				validate: async (outcome, workspace, accessor) => {","					assertInlineEdit(outcome);","					await assertNoDiagnosticsAsync(accessor, outcome, workspace, KnownDiagnosticProviders.tscIgnoreImportErrors);","				}","			}","		]","	});","});"]}function E1e(n){return[n.start.line,n.start.character,n.end.line,n.end.character]}async function unt(n){let e=n.requestDebugInformation,t=s=>JSON.stringify(s),r=[],o=async s=>{try{if(s.scheme!=="file")return;let a=await HE.workspace.openTextDocument(s),c=(0,FU.basename)(s.path),l=0;for(;r.find(u=>u.name===c);)c=`${c}_${++l}`;r.push({name:c,fileContent:a.getText()})}catch{}};for(let s of n.references)if(s instanceof Xo.PromptReference){let a=s.anchor;if(sh(a))await o(a);else if(jp(a))await o(a.uri);else if(a.variableName==="file"){let c=a.value;sh(c)?await o(c):jp(c)&&await o(c.uri)}}return["stest({ description: 'Issue #XXXXX' }, (testingServiceCollection) => {","	return simulatePanelCodeMapper(testingServiceCollection, {","		files: [",...r.map(s=>`			toFile({ fileName: ${t(`multiFile/issue-XXXXX/${s.name}`)}, fileContent: ${t(s.fileContent)} }),`),"		],","		queries: [","			{",`				file: ${e?t((0,FU.basename)(e.uri.path)):void 0},`,`				selection: ${e?t(E1e(e.userSelection)):void 0},`,`				query: ${t(n.request.message)},`,"				validate: async (outcome, workspace, accessor) => {","					assertWorkspaceEdit(outcome);","					assert.strictEqual((await getWorkspaceDiagnostics(accessor, workspace, 'tsc')).filter(d => d.kind === 'syntactic').length, 0);","				}","			}","		]","	}); ","}); "]}var sy=class{constructor(e,t){this._configurationService=e;this._authenticationService=t;this.debugReportFeedback=Ki(this,this._configurationService.onDidChangeConfiguration,()=>this._configurationService.getConfig(le.DebugReportFeedback))}async canReport(){return!(!this._configurationService.getConfig(le.DebugReportFeedback)||!(await this._authenticationService.getCopilotToken())?.isInternal)}};sy=E([v(0,be),v(1,xt)],sy);var OL=q(require("assert"));var AL=class n{constructor(e){this._indexMap=e}static createSortPermutation(e,t){let r=Array.from(e.keys()).sort((o,s)=>t(e[o],e[s]));return new n(r)}apply(e){return e.map((t,r)=>e[this._indexMap[r]])}mapIndex(e){return this._indexMap[e]}inverse(){let e=this._indexMap.slice();for(let t=0;t<this._indexMap.length;t++)e[this._indexMap[t]]=t;return new n(e)}};var UU=class{constructor(e,t){this.firstEditStrategy=e;this.maxLinesPerEdit=t}doesFitMaxLinesPerEdit(e){return this.maxLinesPerEdit===void 0||e.lineRange.length<=this.maxLinesPerEdit&&e.newLines.length<=this.maxLinesPerEdit}},BU=class{constructor(e,t,r){this.documents=e;this.activeDocumentIdx=t;this.options=r;Sv(e.length>0),Sv(t>=0&&t<e.length)}getActiveDocument(){return this.documents[this.activeDocumentIdx]}toString(){return this.toMarkdown()}toMarkdown(){return`### StatelessNextEditRequest

${this.documents.map((t,r)=>` * [${r+1}/${this.documents.length}] ${r===this.activeDocumentIdx?"(active document) ":""}`+t.toMarkdown()).join(`

`)}`}},qU=class{constructor(e,t,r,o){this.uri=e;this.documentLinesBeforeEdit=t;this.recentEdit=r;this.recentlyEditedInLinesAfterEdit=o}toString(){return this.toMarkdown()}toMarkdown(){let e=[];return e.push(`StatelessNextEditDocument: **${k1(this.uri)}**
`),e.push("```patch"),e.push(this.recentEdit.humanReadablePatch(this.documentLinesBeforeEdit)),e.push("```"),e.push(""),e.join(`
`)}},ks=class n{constructor(e){this.state=e}static noEdit(){return new n({kind:"noEdit"})}static edit(e,t){return new n({kind:"edit",edit:e,permutation:t})}};var Bee=class{toKey(e){let t={documents:e.documents.map(r=>({uri:r.uri,documentLinesBeforeEdit:r.documentLinesBeforeEdit,recentEdit:r.recentEdit.serialize()})),options:e.options};return JSON.stringify(t)}},jU=class{constructor(e=new Bee,t=20){this.cachingStrategy=e;this.cache=new Xl(t)}get(e){let t=this.cachingStrategy.toKey(e);return this.cache.get(t)}set(e,t){let r=this.cachingStrategy.toKey(e);this.cache.put(r,t)}};var DL=class extends Error{},ay=class extends Error{},$x=class{constructor(e){this.requestId=e}static createFromRecord(e,t){let r=new Set(Object.keys(e));if(HU(r,new Set(["type","from_line","to_line","code"]))){if(e.type==="replace")return new Oh(Number(e.from_line),Number(e.to_line),e.code,t);throw new ay(`fields only fit replace type but type is ${e.type}`)}else if(HU(r,new Set(["type","before_line","code"]))){if(e.type==="insert")return new Cf({lineNum:Number(e.before_line),insert:0},e.code,t);throw new ay(`fields only fit insert type but type is ${e.type}`)}else if(HU(r,new Set(["type","after_line","code"]))){if(e.type==="insert")return new Cf({lineNum:Number(e.after_line),insert:1},e.code,t);throw new ay(`fields only fit insert type but type is ${e.type}`)}else if(HU(r,new Set(["type","from_line","to_line"]))){if(e.type==="delete")return new Mh(Number(e.from_line),Number(e.to_line),t);throw new ay(`fields only fit delete type but type is ${e.type}`)}else throw new DL(`fields ${Array.from(r)} do not fit any known type of EditCommand`)}},NL=(t=>(t[t.BeforeLine=0]="BeforeLine",t[t.AfterLine=1]="AfterLine",t))(NL||{}),Cf=class extends $x{constructor(t,r,o){super(o);this.line=t;this.text=r;this.kind="insert"}toString(){let t=["kind: "+this.kind];return t.push("lineNum: "+this.line.lineNum),t.push("insert: "+NL[this.line.insert]),t.push("text: "+this.text),t.join(`
`)}},Oh=class extends $x{constructor(t,r,o,s){super(s);this.fromLine=t;this.toLine=r;this.text=o;this.kind="replace"}toString(){let t=["kind: "+this.kind];return t.push("fromLine: "+this.fromLine),t.push("toLine: "+this.toLine),t.push("text: "+this.text),t.join(`
`)}},Mh=class extends $x{constructor(t,r,o){super(o);this.fromLine=t;this.toLine=r;this.kind="delete"}toString(){let t=["kind: "+this.kind];return t.push("fromLine: "+this.fromLine),t.push("toLine: "+this.toLine),t.join(`
`)}};function HU(n,e){if(n.size!==e.size)return!1;for(let t of n)if(!e.has(t))return!1;return!0}var VU={created:0,completionId:"",headerRequestId:""};var GU=class{constructor(e,t){this.doc=e;this.edits=t}};function w1e(n){let e=n;return e.startsWith("file://")?e.substring(7):e}function k1e(n,e,t,r,o){let s="";return n.forEach(a=>{s+=`${w1e(a.doc.uri)}: |+2
`,s+=`${t(a.doc.documentLinesBeforeEdit)}
`}),n.slice().reverse().forEach(a=>{s+=`edit ${w1e(a.doc.uri)}:
`,a.edits.forEach(c=>{if(c instanceof Mh)s+=`  - type: delete
`,s+=`    from_line: ${c.fromLine}
`,s+=`    to_line: ${c.toLine}
`;else if(c instanceof Cf)s+=`  - type: insert
`,s+=`    code: |+2
`,s+=`${e(c.text)}
`,c.line.insert===1?s+=`    after_line: ${c.line.lineNum}
`:c.line.insert===0&&(s+=`    before_line: ${c.line.lineNum}
`);else if(c instanceof Oh)s+=`  - type: replace
`,s+=`    from_line: ${c.fromLine}
`,s+=`    code: |+2
`,s+=`${e(c.text)}
`,s+=`    to_line: ${c.toLine}
`;else throw new Error("Unknown edit command type")})}),r&&o===void 0?s+=`  - type:
`:o!==void 0&&(s+=`  - type: replace
`,s+=`    from_line: ${o}
`,s+=`    code:
`),s}var LL=class extends Error{constructor(e,t){super(`ParseError: ${e}
${JSON.stringify(t,null,2)}`)}},zU=class n{constructor(e=n.LOGPROB_THRESHOLD,t=!1){this.logProbThreshold=e;this.promptWithTrailingEdit=t}static{this.strategyName="edit-command"}static{this.LOGPROB_THRESHOLD=-.18}stops(){return[`
name:`]}static lineSourceText(e){return typeof e=="string"?(e.endsWith(`
`)?e:e+`
`).split(`
`).map((r,o)=>`  ${o+1}:${r}`).join(`
`):e.map((t,r)=>`  ${r+1}:${t}`).join(`
`)}static indentCode(e){return(e.endsWith(`
`)?e.slice(0,-1):e).split(`
`).map(r=>`      ${r}`).join(`
`)}createPrompt(e){let t=e.getActiveDocument(),r=e.documents.slice();r.splice(e.activeDocumentIdx,1);let s=[t,...r].map(a=>{let c=[];for(let{lineRange:l,newLines:u}of a.recentEdit.edits)if(l.isEmpty)c.push(new Cf({lineNum:l.startLineNumber,insert:1},u.join(`
`),VU));else if(u.length===0){if(l.startLineNumber===l.endLineNumberExclusive)continue;c.push(new Mh(l.startLineNumber,l.endLineNumberExclusive,VU))}else c.push(new Oh(l.startLineNumber,l.endLineNumberExclusive,u.join(`
`),VU));return new GU(a,c)});return k1e(s,n.indentCode,n.lineSourceText,this.promptWithTrailingEdit,this.renumberedFocusLine)}extractChanges(e,t){let r=jee(e);return new nr(async o=>{let s={},a=0,c="",l="readingEdit";for await(let u of r){let d=u.line;if(a=u.created,c=u.completionId,l==="readingCodeBlock"&&(d.startsWith("      ")?s.code+=d.slice(6)+`
`:l="readingEdit"),l!=="readingCodeBlock"){if(d.startsWith("name:")||d.startsWith("body:"))continue;let[p,f]=d.trim().split(":");if(p==="code")s.code="",l="readingCodeBlock";else if(f!==void 0)if(p==="- type"){if(s.type)throw new Error("parse error: more than one type set in an edit command");s.type=f.trim()}else if(p==="line_from"||p==="from_line")s.from_line=f.trim();else if(p==="line_to"||p==="to_line")s.to_line=f.trim();else if(p==="before_line"||p==="line_before")p="before_line",s.before_line=f.trim();else if(p==="after_line"||p==="line_after")f=f.trim(),f==="0"?s.before_line="1":s.after_line=f;else throw new LL("Unknown key received",{current:s,state:l});try{let m=$x.createFromRecord(s,{created:a,completionId:c,headerRequestId:t});o.emitOne(m),s={}}catch(m){if(!(m instanceof DL)){if(m instanceof ay)throw new LL("ConflictingFieldsError: record is invalid",{current:s,state:l})}}}}})}parseResponse(e,t){let r="",o=[];return e=e.map(s=>(r+=s.text,s.logProb&&o.push(s.logProb),s)),new nr(async s=>{let a=!1,c,l;try{for await(let u of this.extractChanges(e,t)){if(c=l,l=o.reduce((d,p)=>d+p,0)/o.length,l<this.logProbThreshold){s.emitOne({maybeEditCommand:Br.failure("low-logprob-suggestion"),modelResponse:r,requestId:u.requestId,lastLogProbsAvg:c,currentLogProbsAvg:l});break}a=!0,s.emitOne({maybeEditCommand:Br.ok(u),modelResponse:r,requestId:u.requestId,lastLogProbsAvg:c,currentLogProbsAvg:l})}}catch(u){throw u instanceof LL&&s.emitOne({maybeEditCommand:Br.failure("parse-error"),modelResponse:r,requestId:{created:0,completionId:"",headerRequestId:""},lastLogProbsAvg:c,currentLogProbsAvg:l}),u}a||s.emitOne({maybeEditCommand:Br.failure("no-suggestions"),modelResponse:r,requestId:{headerRequestId:t,completionId:"",created:0}})})}},qee;(e=>{function n(t){return t}e.make=n})(qee||={});function jee(n){return new nr(async e=>{let t="",r=0,o="";for await(let s of n){s.created!==void 0&&(r=s.created),s.completionId!==void 0&&(o=s.completionId),t+=s.text;do{let a=t.indexOf(`
`);if(a===-1)break;let c=t.substring(0,a);t=t.substring(a+1),e.emitOne({line:qee.make(c),completionId:o,created:r})}while(!0)}t.length>0&&e.emitOne({line:qee.make(t),completionId:o,created:r})})}var dnt=!0,VE=class{constructor(e,t,r){this.nesFetchService=e;this.logService=t;this.configurationService=r;this.resultCache=new jU}async provideNextEdit(e,t,r){if(e.getActiveDocument().recentEdit.edits.length===0)return ks.noEdit();if(dnt){let l=this.resultCache.get(e);if(l)return this.trace("[cache HIT]",l),t.setIsCachedResult(!0),ks.edit(l[0],l[1]??void 0)}if(await new Promise(l=>setTimeout(l,50)),r.isCancellationRequested)throw new dt;this.trace("[cache MISS] will fetch response"),t.setIsCachedResult(!1);let s=await this.doGetNextEdit(e,t,r);if(s===null)return t.markAsNoSuggestions(),ks.noEdit();let[a,c]=s;return(0,OL.default)(a.edits.length>0,"edit.edits.length > 0"),this.resultCache.set(e,[a,c]),ks.edit(a,c??void 0)}async doGetNextEdit(e,t,r){let o=Gt(),s=this.configurationService.getConfig(le.InlineEditsFineTunedModelLogProbThreshold),a=new zU(s),c=a.createPrompt(e);t.setPrompt(c);let l;try{l=await this.nesFetchService.fetchNesFineTunedModel(c,a.stops(),o,r)}catch(S){throw this.trace("Assertion failure: NesFetchService#fetch should return error as Result.Error not throw",S),S}if(r.isCancellationRequested)throw new Nh("After fetch call returned");if(Br.isFailure(l))throw this.trace("Failed to fetch nes response",l.errVal),new Error(`Failed to get response from nes:
${JSON.stringify(l,null,"	")}`);let u=l.value.stream,d=a.parseResponse(u,o),p=[],f=[];try{for await(let S of d){if(p.push(S),r.isCancellationRequested)throw new Nh("When processing respone results");if(Br.isFailure(S.maybeEditCommand)){if(this.trace("A response result error",S),S.maybeEditCommand.errVal==="no-suggestions"||S.maybeEditCommand.errVal==="low-logprob-suggestion")break;throw new Error(S.maybeEditCommand.errVal)}else{this.trace("A response result success",S);let w=S.maybeEditCommand.value;f.push(w)}}}catch(S){throw S instanceof dt?this.trace("Request got cancelled"):this.trace("Unexpected error when awaiting responseResult",S),S}finally{t.setResponseResults(p)}let m=e.getActiveDocument(),h=[];for(let S of f)if(S instanceof Cf){let w=S.line.lineNum+(S.line.insert===1?1:0),R=new yn(w,w);h.push(new Gd(R,this.toNewLines(S.text)))}else if(S instanceof Oh){let w=new yn(S.fromLine,S.toLine+1);h.push(new Gd(w,this.toNewLines(S.text)))}else if(S instanceof Mh){let w=new yn(S.fromLine,S.toLine+1);h.push(new Gd(w,[]))}else OL.default.fail(`Unknown edit command kind: ${S.constructor.name}`);let g=this.disjoint(h.filter(S=>e.options.doesFitMaxLinesPerEdit(S)&&pnt(m.documentLinesBeforeEdit,S.lineRange)));if(this.trace(`Parsed ${h.length} edits from nes response, filtered down to ${g.length}.`),g.length===0)return null;let y=AL.createSortPermutation(g,(S,w)=>S.lineRange.startLineNumber-w.lineRange.startLineNumber),b=y.apply(g),x=new Y0(b).rebase(m.recentEdit);if(x.edits.length===0)return this.trace("Rebasing resulted in 0 edits"),null;let I=null;switch(e.options.firstEditStrategy){case"firstByLineNumber":break;case"llmOrder":{I=x.edits.length!==b.length?null:y.inverse();break}case"closestToEdit":{let S=m.recentlyEditedInLinesAfterEdit,w=x.edits,R=(F,K)=>F.intersect(K)?0:Math.max(F.startLineNumber,K.startLineNumber)-Math.min(F.endLineNumberExclusive,K.endLineNumberExclusive),k=w.map(F=>-R(S,F.lineRange));(0,OL.default)(k.filter(F=>F>0).length===0);let V=Nme(k,(F,K)=>F-K);I=new AL([...S2(V,w.length),...S2(V)]);break}default:OL.default.fail(`Unknown FirstEditPickStrategy: ${e.options.firstEditStrategy}`)}return[x,I]}disjoint(e){let t=new Set,r=[];for(let o of e){let s=!1;for(let a=o.lineRange.startLineNumber;a<=o.lineRange.endLineNumberExclusive;++a)t.has(a)?s=!0:t.add(a);s||r.push(o)}return r}toNewLines(e){return(e.endsWith(`
`)?e.slice(0,-1):e).split(`
`)}trace(e,...t){let r=t.map(o=>JSON.stringify(o,null,"	")).join(`
-----
`);this.logService.internal.trace(`[NextEditPredictor] ${e} ${r}`)}};VE=E([v(0,$0),v(1,oe),v(2,be)],VE);function pnt(n,e){let t=yn.ofLength(1,n.length);return fnt(t,e)}function fnt(n,e){return n.startLineNumber<=e.startLineNumber&&e.endLineNumberExclusive<=n.endLineNumberExclusive}var ts=q(require("vscode")),R1e=q(Aee());var $U=class{createPrompt(e,t,r){let o=r.startLineNumber-1,s=r.endLineNumberExclusive-1,[a,c]=[t.slice(0,s),t.slice(s)],l=t.slice(o,s).map(u=>`// ${u}`);return a.splice(o,l.length,...l),a.splice(s,0,"// </OldCode>","// <NewCode>",""),a.splice(o,0,"// <OldCode>"),a.splice(0,0,`// Path: ${e}`),{prefix:a.join(`
`),suffix:c.join(`
`)}}async processResponse(e,t){let r=jee(e),o=[];for await(let s of r){if(s.line.includes("</NewCode>"))break;if(t.isCancellationRequested)throw new Nh("Prompt processing cancelled");o.push(s.line)}return o.some(s=>s.trim()!==""&&!s.startsWith("//"))?o.join(`
`):o.map(s=>s.replace(/^\/\/ ?/,"")).join(`
`)}};var Hee=class extends UE{getDebugName(){return super.getDebugName()+" | on-selection"}logPrompt({prefix:e,suffix:t,language:r}){this.addLog("# Prompt"),this.addLog("<details> <summary> CLICK TO VIEW </summary>"),this.addLog("## Prefix"),this.addCodeblockToLog(e,r),this.addLog("# Suffix"),this.addCodeblockToLog(t,r),this.addLog("</details>")}logResponse({unprocessedResponse:e,processedResponse:t,language:r}){this._isVisible=!0,this.addLog("# Unprocessed response"),this.addLog("<details> <summary> CLICK TO VIEW </summary>"),this.addCodeblockToLog(e,r),this.addLog("</details>"),this.addLog("# Processed response"),this.addCodeblockToLog(t??"Processing response failed -- see error",r)}logResult(e){this.addLog("# Result"),typeof e=="string"?(this.markAsNoSuggestions(),this.addCodeblockToLog(e)):this.addCodeblockToLog(R1e.stringify(e),"yaml")}},bu=class{constructor(e,t,r){this.options=e;this.fetcher=t;this.logService=r;this.trace("created")}static isActionableSelection(e){let t=e.isSingleLine&&e.end.character-e.start.character<10,r=e.end.line-e.start.line>20;return!t&&!r}async provideInlineEdit(e,t,r){if(await new Promise(a=>setTimeout(a,50)),r.isCancellationRequested)return this.trace("provideInlineEdit cancelled after debounce timeout"),null;let o=new Hee(e.fileName,e.version),s=await this.doProvideInlineEdit(e,t,o,r);return this.options.inlineEditLogger.add(o),s}async doProvideInlineEdit(e,t,r,o){this.trace("provideInlineEdit called");let s=ts.window.activeTextEditor,a=s?.document,c=s?.selection;if(a===void 0||c===void 0||e.uri.toString()!==a.uri.toString()||e.lineCount>1e3)return this.trace("Early exit due to editorDoc, selection, or document conditions"),null;let l,d=ts.languages.getDiagnostics(e.uri).filter(k=>k.range.start.line<=c.start.line&&k.range.end.line>=c.start.line&&k.severity!==ts.DiagnosticSeverity.Information&&!k.tags?.includes(ts.DiagnosticTag.Unnecessary)),p=await this.provideAddImportInlineEdit(e,d,o);if(p!==null)return p;if(c.isEmpty&&this.options.triggerOnDiagnostics){if(d.length===0)return this.trace("Early exit due to no diagnostic on selection line"),null;this.trace("Taking current line as selection"),l=new ts.Range(c.start.line,0,c.start.line,e.lineAt(c.start.line).text.length)}else{if(!bu.isActionableSelection(c))return this.trace("Early exit due to selection size",c.toString()),r.addLog("Early exit due to selection size"),null;if(this.options.triggerOnSelection&&c.isSingleLine&&d.length===0&&e.getText(c).match(/^[a-zA-Z_][a-zA-Z0-9_]*$/)!==null)return this.trace("Early exit due to selection being an identifier"),r.addLog("Early exit due to selection being an identifier"),null;this.trace("Taking selection as selection because it is actionable."),l=c}let f=bu.rangeToLineRange(l),m=new $U,h=e.uri.toString(),g=e.getText().split(/\r?\n/),{prefix:y,suffix:b}=m.createPrompt(h,g,f),_=Gt().slice(0,8),x=await this.fetcher.fetchGhostText(y,b,null,_,o);if(r.logPrompt({prefix:y,suffix:b,language:e.languageId}),o.isCancellationRequested)return this.trace("Cancellation requested after fetch"),null;if(Br.isFailure(x))return this.trace(`Fetch result failed with ${x.errVal}${x.message?`, extra info ${x.message}`:""}`),null;let I=x.value,S=null;try{S=await m.processResponse(I.stream,o)}catch(k){return wo(k)?this.trace("Prompt processing cancelled"):this.trace(`Failed to process response with ${k}`),r.setError(k),null}finally{let k=await I.response;r.logResponse({unprocessedResponse:k,processedResponse:S,language:e.languageId})}if(S.trim()==="")return this.trace("Edit is empty after trimming"),r.logResult("Edit is empty after trimming"),null;let w=bu.rangeExpandedToFullLines(e,l);{let k=e.getText(l).split(/\r?\n/),V=S.split(/\r?\n/);if(k.length===V.length&&k.every((F,K)=>F.trim()===V[K].trim()))return this.trace("Edit is the same as the selection"),r.logResult("Edit is the same as the selection"),null}let R=new ts.InlineEdit(S,w);return this.trace("Returning new InlineEdit",R),r.logResult(R),R}static{this.AddImportInlineEditLanguages=new Set(["typescript","javascript","typescriptreact","javascriptreact"])}async provideAddImportInlineEdit(e,t,r){if(!bu.AddImportInlineEditLanguages.has(e.languageId))return null;let o=t.find(f=>f.message.includes("Cannot find name"));if(o===void 0)return null;let s;try{s=await Dp(Nhe(()=>ts.commands.executeCommand("vscode.executeCodeActionProvider",e.uri,o.range)),100)}catch(f){throw console.log("Error fetching code actions",f),f}if(r.isCancellationRequested)return this.trace("Cancellation requested during code action fetch"),null;if(s===void 0)return this.trace("Fetching code actions likely timed out"),null;let a=s.filter(f=>f.title.includes("Add import"));if(a.length===0)return null;let u=(a.length===1?a[0]:a.filter(f=>f.title.includes("./")).at(0)??a[0]).edit?.get(e.uri);if(u===void 0||u.length!==1)return null;let{range:d,newText:p}=u[0];return new ts.InlineEdit(p,d)}trace(e,...t){let r=`GhostTextBasedInlineEditProvider: ${e}`;t.length>0&&(r+=`
Payload: `+JSON.stringify(t,null,2)),this.logService.internal.trace(r)}static rangeToLineRange(e){return new yn(e.start.line+1,e.end.line+2)}static rangeExpandedToFullLines(e,t){let r=e.lineAt(t.start.line),o=e.lineAt(t.end.line);return new ts.Range(new ts.Position(r.lineNumber,0),new ts.Position(o.lineNumber,o.text.length))}};bu=E([v(1,$0),v(2,oe)],bu);var ly=class{constructor(e,t,r,o){this._tracker=e;this._statelessNextEditProvider=t;this._parseService=r;this._configService=o;this._subsequentEditLookupMap=new Map}getEditLookUpMapKey(e,t){return JSON.stringify({docUri:e,docValue:t})}async getNextEdit(e,t,r){let o=this._tracker.getHistoryContext(e);if(!o)return new cy(void 0);let s=o.getDocumentAndIdx(e);Vs(s,"Must be defined");let a=s.doc,c=this.getEditLookUpMapKey(e,a.lastEdit.getEditedState().value),l=this._subsequentEditLookupMap.get(c);if(l)return this._subsequentEditLookupMap.delete(c),new cy(l);t.setRecentEdit(o);let u=[],d=!0;for(let I=0;I<o.editedDocuments.length;++I){let S=o.editedDocuments[I],w=ly.getProjectedDocumentClipping(S.lastEdit),R=mnt(S.lastEdit,w),V=Ph.fromEdit(R).removeCommonSuffixPrefixLines();if(I===s.idx&&V.edit.isEmpty()){d=!1;break}let F=w.projectOffsetRange(S.lastEditedRangeBeforeEdit),K=R.edit.toOffsetEdit().applyToOffsetRange(F),$=R.base.getTransformer().getRange(K),j=yn.fromRangeInclusive($),D=new qU(S.docUri,V.base.getLines(),V.edit,j);u.push({recentEdit:S.lastEdit,nextEditDoc:D,projectedDocument:w,projectedDocStateAfterEdit:R.getEditedState()})}if(!d)return new cy(void 0);let p=u[s.idx],f=new BU(u.map(I=>I.nextEditDoc),s.idx,this.nextEditOptions);t.setRequestInput(f);let m=await this._statelessNextEditProvider.provideNextEdit(f,t,r);if(m.state.kind==="noEdit")return new cy(void 0);let h=m.state.edit,g=new Ph(p.projectedDocStateAfterEdit,h);if(t.setResult(g),h.edits.length===0)return new cy(void 0);let y=g.toEdit(),_=hnt(y,p.projectedDocument).decompose(m.state.permutation),x=p.recentEdit.getEditedState();for(let I=0;I<_.length-1;I++){let S=_[I];x=x.apply(S);let w=this.getEditLookUpMapKey(a.docUri,x.value);this._subsequentEditLookupMap.set(w,_[I+1].edits[0])}return new cy(_[0].edits[0])}static getProjectedDocumentClipping(e){let t=e.base.getTransformer(),r=t.getRange(e.edit.getRange()),o=yn.fromRange(r);function s(u,d){return new yn(u.startLineNumber-d,u.endLineNumberExclusive+d)}let a=new yn(1,t.textLength.lineCount+1),c=a.intersect(s(o,100)),l=yn.subtract(a,c);return new OD(new LD(e.base.value),new Rn(l.map(u=>Pi.delete(t.getOffsetRange(new De(u.startLineNumber,1,u.endLineNumberExclusive,1))))))}get nextEditOptions(){return new UU(this._configService.getConfig(le.InlineEditFirstEditStrategy),8)}async getProjectedDocumentSummarizedDocument(e){let t=await vnt(this._parseService,{getText:()=>e.base.value,languageId:"typescript"});if(!t)throw new Error("could not parse");let r=new LD(e.base.value),o=P1e(r.offsetRangeToRange(e.edit.edits[0].range));return V6(200*50,{costFnOverride:(a,c,l)=>{let u=P1e(l.offsetRangeToRange(a.range)),d=gnt(o,u);return d>100?!1:d}},[{overlayNodeRoot:t,document:r,selection:void 0}])[0]}};ly=E([v(2,ft),v(3,be)],ly);function mnt(n,e){let t=e.projectOffsetEdit(n.edit.toOffsetEdit());return new Q0(new vu(e.text),Lc.fromOffsetEdit(t))}function hnt(n,e){let t=e.projectBackOffsetEdit(n.toOffsetEdit());return Lc.fromOffsetEdit(t)}function P1e(n){return new yn(n.start.line+1,n.end.line+1)}function gnt(n,e){return n.endLineNumberExclusive<=e.startLineNumber?e.startLineNumber-n.endLineNumberExclusive:e.endLineNumberExclusive<=n.startLineNumber?n.startLineNumber-e.endLineNumberExclusive:0}var cy=class{constructor(e){this.edit=e}};async function vnt(n,e){return await n.getTreeSitterAST(e)?.getStructure()}var GE=class extends ye{constructor(t){super();this._requestLogger=t;this._requests=[]}add(t){t.includeInLogTree&&(this._requestLogger.addEntry({type:"MarkdownContentRequest",debugName:t.getDebugName(),icon:t.getIcon(),startTimeMs:t.time,markdownContent:t.toLogDocument()}),this._requests.push(t),this._requests.length>100&&this._requests.shift())}getRequestById(t){return this._requests.find(r=>r.requestId===t)}};GE=E([v(0,eu)],GE);var ML=class{constructor(e,t,r,o=[]){this.token=e;this.value=t;this.alternativeTokens=o;this.range=new gt(r,r+e.length)}},WU=class{constructor(e,t){this.locationProvider=e;this.editProvider=t;this._averageLocationProviderTime=0;this._averageEditProviderTime=0;this._totalCompletedRequests=0}async provideNextEdit(e,t,r){if(await mc(50),r.isCancellationRequested)return ks.noEdit();let o=Date.now(),s=await this.locationProvider.provideNextLocation(e,t,r),a=Date.now()-o;if(s.length===0)return ks.noEdit();if(r.isCancellationRequested)return ks.noEdit();let c=this._processNextEditLocations(s),l=Date.now(),u=await this.editProvider.provideNextEdit(c,e,t,r),d=Date.now()-l;return this._averageLocationProviderTime=(this._averageLocationProviderTime*this._totalCompletedRequests+a)/(this._totalCompletedRequests+1),this._averageEditProviderTime=(this._averageEditProviderTime*this._totalCompletedRequests+d)/(this._totalCompletedRequests+1),this._totalCompletedRequests++,t.addLog("**Timing information:**"),t.addListToLog([`Location provider ${a}ms [average: ${this._averageLocationProviderTime.toFixed(0)}ms]`,`Edit provider ${d}ms [average: ${this._averageEditProviderTime.toFixed(0)}ms]`]),u}_processNextEditLocations(e){return e}};var KU=class{constructor(e,t={maxCompletionTokens:64}){this._customEndpointProvider=e;this._config=t}async provideNextEdit(e,t,r,o){if(!this._customEndpointProvider.isReady())return ks.noEdit();if(e.length===0)return ks.noEdit();let s=t.getActiveDocument(),a=e[0];return r.addLog(`AlternativeTokenEditProvider: Processing next edit location at line ${a.position.line} with token "${a.token.token}"`),this._provideInlineEdit(s,e[0],r,o)}async _provideInlineEdit(e,t,r,o){let s=e.documentLinesBeforeEdit,a=e.recentEdit.apply(s),c=a.join(`
`),l=t.token.alternativeTokens.filter(f=>t.token.token!==f.token)[0].token??"",u=c.substring(0,t.token.range.start)+l;r.addLog(l?`Using alternative token: "${l}"`:"Not using an alternative token");let d=await this._suggestNewLines(e,s,a,u);if(d.length===0)return r.addLog("No completion suggestions"),ks.noEdit();if(r.addLog("Completion suggestion:"),r.addCodeblockToLog(d.join(`
`)),o.isCancellationRequested)return r.addLog("Cancellation requested"),ks.noEdit();let p=this._createEditFromCompletion(d,a,u,t,l,r);return p?ks.edit(p):ks.noEdit()}async _suggestNewLines(e,t,r,o){let a=`${`A developer is doing edits in a TypeScript file.
The edits are complete and make logical sense together.
CODE:
\`\`\`
${r.join(`
`)}
\`\`\`
RECENT EDIT:
\`\`\`
${e.recentEdit.humanReadablePatch(t)}
\`\`\`
COMPLETE THE CODE:
\`\`\`
`}${o}`,c=await this._customEndpointProvider.requestCompletion(a,this._config.maxCompletionTokens);if(!c)return[];let u=c.text.split("```")[0].split(`
`);return u.slice(0,u.length-1)}_createEditFromCompletion(e,t,r,o,s,a){let c=r.substring(r.lastIndexOf(`
`)+1),l=o.position.line+1+(c===""?1:0),u=this._classifySuggestedLines(e,t,s,c,o);if(u.length===0){a.addLog("Unable to classify completion suggestions");return}let d=-1;for(let g=0;g<u.length-1;g++){let y=u[g].type,b=u[g+1].type;y==="new"&&b==="match"&&(d=g)}if(d===-1){a.addLog("Unable to process completion. No matching line found after completion");return}let p=d+1,f=u[p];if(f.type!=="match")throw a.addLog("Error: Line after completion should be a match"),new Error("AlternativeTokenEditProvider: Line after completion should be a match");let m=f.lineNumber,h=e.slice(0,p).join(`
`);return new Y0([new Gd(new yn(l,m),[c+h])])}_classifySuggestedLines(e,t,r,o,s){let a=[],c=t.slice(s.position.line).slice(0,e.length*3);for(let l=0;l<e.length;l++){let u=e[l];l===0&&r.trim()===o.trim()&&(u=r+u);let d=c.reduce((m,h,g)=>(h===u&&m.push(g),m),[]),p=a.reduce((m,h,g)=>h.type==="match"?h.lineNumber:m,-1),f=d.find(m=>s.position.line+1+m>p)??-1;if(f!==-1?a.push({type:"match",lineNumber:s.position.line+1+f}):a.push({type:"new"}),u.trim()==="")break}return a}};var $E=q(require("vscode"));var zE=class{constructor(e,t,r){this._fileSystemService=e;this._vscodeExtensionContext=t;this._configResource=$E.Uri.file(k2(this._vscodeExtensionContext.globalStorageUri.fsPath,"nextEditProvider.json")),r.copilotToken?.isInternal&&this._init()}async _init(){let e;try{await this._fileSystemService.stat(this._configResource);let t=await this._fileSystemService.readFile(this._configResource),r=JSON.parse(t.toString()),o=r.URL,s=r.API_KEY;if(!o||typeof o!="string"||!s||typeof s!="string")throw new Error("Custom Endpoint: Invalid configuration");e={URL:o,API_KEY:s}}catch{e=await this._setupConfig()}e&&(this._apiKey=e.API_KEY,this._apiEndpoint=e.URL)}async _setupConfig(){let e=await $E.window.showInputBox({prompt:"Enter API Key",placeHolder:"API Key",ignoreFocusOut:!0,password:!0}),t=await $E.window.showInputBox({prompt:"Enter API Endpoint",placeHolder:"API Endpoint",ignoreFocusOut:!0});if(!e||!t){$E.window.showErrorMessage("API Key and Endpoint are required.");return}let r={URL:t,API_KEY:e};return await this._fileSystemService.writeFile(this._configResource,Buffer.from(JSON.stringify(r,null,2))),r}isReady(){return!!this._apiKey&&!!this._apiEndpoint}async requestLogProbs(e,t){return this._makeRequest(e,0,1+t,!0)}async requestCompletion(e,t){return this._makeRequest(e,t)}async _makeRequest(e,t,r,o){if(!this._apiKey||!this._apiEndpoint)return;let s={"Content-Type":"application/json","api-key":this._apiKey,"ocp-apim-subscription-key":this._apiKey},a=JSON.stringify({prompt:e,max_tokens:t,logprobs:r,echo:o});try{let c=await fetch(this._apiEndpoint,{method:"POST",headers:s,body:a});if(!c.ok){console.error("Error from API:",c.statusText);return}let l=await c.json(),u=l.choices&&l.choices[0];return u||void 0}catch(c){console.error(c);return}}};zE=E([v(0,gn),v(1,qt),v(2,xt)],zE);var YU=class{constructor(e,t={decreaseThreshold:.2},r){this._customEndpointProvider=e;this._config=t;this._visualizer=r}async provideNextLocation(e,t,r){return this._customEndpointProvider.isReady()?this._getNextEditLocations(e.getActiveDocument(),t):(t.addLog("Custom endpoint provider is not ready"),[])}async _getNextEditLocations(e,t){let r=e.documentLinesBeforeEdit,o=e.recentEdit.apply(r),s=r.join(`
`),a=o.join(`
`),[c,l]=await Promise.all([this._getLogProbs(s,0),this._getLogProbs(a,1)]);if(!c||!l)return t.addLog("Failed to get logprobs"),[];let u=e.recentEdit.toEdit(new vu(s)),d=this._calculateTokenLogProbDecreases(c,l,s,u),p=d.filter(h=>h.value>this._config.decreaseThreshold),f=new Sc(a),m=p.map(h=>({token:h,position:f.getPosition(h.range.start)}));return t.addLog("Next edit locations:"),t.addListToLog(m.map(h=>`"${h.token.token}" (Decreased ${h.token.value}) at ${h.position.line}:${h.position.character} Alternatives: ${h.token.alternativeTokens.map(g=>`"${g.token}" [${g.prob}]`).join(", ")}`)),this._visualizer?.visuallizeDecreases(d,a,m),m}async _getLogProbs(e,t=0){let r=`\`\`\`
${e}
\`\`\`

\`\`\`
`,s=`${r}${e}
\`\`\``,a=await this._customEndpointProvider.requestLogProbs(s,t);if(!a)return;let c=a.logprobs.text_offset.map(p=>p-r.length),l=OW(c,p=>p>=0),u=OW(c,p=>p>=e.length),d={text_offset:c.slice(l,u),token_logprobs:a.logprobs.token_logprobs.slice(l,u),tokens:a.logprobs.tokens.slice(l,u),top_logprobs:a.logprobs.top_logprobs.slice(l,u)};return ynt(d)}_calculateTokenLogProbDecreases(e,t,r,o){let s=o.toOffsetEdit().inverse(r);return t.map(c=>{let l=s.applyToOffsetRangeOrUndefined(c.range);if(l===void 0)return;let u=cF(e,p=>p.range.start>=l.start);if(!u||!u.range.equals(l)||u.value===null||c.value===null)return;let d=Math.max(0,u.value-c.value);return new ML(c.token,d,c.range.start,c.alternativeTokens)}).filter(c=>c!==void 0)}};function D1e(n){return n!==null?Math.exp(n):null}function ynt(n){return n.tokens.map((e,t)=>{let r=n.token_logprobs[t],o=n.text_offset[t],s=n.top_logprobs[t],a=Object.keys(s).filter(c=>s[c]!==null).sort((c,l)=>s[l]-s[c]).map(c=>({token:c,prob:D1e(s[c])}));return new ML(e,D1e(r),o,a)})}var Wx=class extends WU{static{this.ID="ProbabilisticInlineEditProvider"}constructor(e,t){let r={decreaseThreshold:.05},o={maxCompletionTokens:100},s;t.isProduction()||(s=new Vee(r.decreaseThreshold));let a=e.createInstance(zE),c=new YU(a,r,s),l=new KU(a,o);super(c,l)}_processNextEditLocations(e){return[e.reduce((r,o)=>r.token.value>o.token.value?r:o)]}};Wx=E([v(0,H),v(1,it)],Wx);var Vee=class{constructor(e){this._decreaseThreshold=e;oh.startRun()}visuallizeDecreases(e,t,r){oh.instance?.addData("nextEditLocations",()=>({$fileExtension:"text.w",value:t,decorations:r.map(o=>({range:[o.token.range.start,o.token.range.endExclusive],color:N1e(1)}))})),oh.instance?.addData("probDecreases",()=>({$fileExtension:"text.w",value:t,decorations:e.map(o=>{let s=Math.max(0,Math.min(1,o.value/this._decreaseThreshold));return{range:[o.range.start,o.range.endExclusive],color:N1e(s)}}).filter(o=>o)}))}};function N1e(n){n=Math.max(0,Math.min(1,n));let e=Math.floor(255*n),t=Math.floor(255*(1-n));return`rgb(${e}, ${t}, 0)`}var uy=require("vscode");var WE=class n extends ye{constructor(t){super();this.scheme=t;this._documents=new Map;this._didChangeEmitter=new uy.EventEmitter;this._register(uy.workspace.registerTextDocumentContentProvider(t,{provideTextDocumentContent:(r,o)=>{let s=this._documents.get(r.toString());return s?s.content:"(document not found)"},onDidChange:this._didChangeEmitter.event}))}static{this.id=0}clear(){this._documents.clear()}createDocument(t="",r="txt"){let o=uy.Uri.parse(`${this.scheme}:///virtual-text-document/${n.id++}.${r}`),s=new Gee(o,()=>this._didChangeEmitter.fire(o));return s.setContent(t),this._documents.set(o.toString(),s),s}createUriForData(t,r="txt"){return this.createDocument(t,r).uri}openUri(t){uy.commands.executeCommand("vscode.open",t)}},Gee=class{constructor(e,t){this.uri=e;this._handleChanged=t;this.content=""}setContent(e){this.content=e,this._handleChanged()}};var KE=class extends ye{constructor(t,r,o){super();this._configurationService=r;this._authenticationService=o;this._inlineEditsConfigEnabled=Ki(this,this._configurationService.onDidChangeConfiguration,()=>this._configurationService.getConfig(le.InlineEditsEnabled));this._inlineEditsTriggerOnSelection=Ki(this,this._configurationService.onDidChangeConfiguration,()=>this._configurationService.getConfig(le.InlineEditsTriggerOnSelection));this._inlineEditsTriggerOnDiagnostics=Ki(this,this._configurationService.onDidChangeConfiguration,()=>this._configurationService.getConfig(le.InlineEditsTriggerOnDiagnostics));this._inlineEditsProviderId=Ki(this,this._configurationService.onDidChangeConfiguration,()=>this._configurationService.getConfig(le.InlineEditsProviderId));this._copilotToken=Ki(this,this._authenticationService.onDidAuthenticationChange,()=>this._authenticationService.copilotToken);this._isInternal=this._copilotToken.map(t=>!!t?.isInternal);this.inlineEditsEnabled=Ql(this,t=>this._inlineEditsConfigEnabled.read(t)&&this._isInternal.read(t));this._register(G_((s,a)=>{if(!this.inlineEditsEnabled.read(s))return;let c=this._register(t.createInstance(GE)),l=this._inlineEditsTriggerOnDiagnostics.read(s),u=this._inlineEditsTriggerOnSelection.read(s),d=t.createInstance(bu,{triggerOnDiagnostics:l,triggerOnSelection:u,inlineEditLogger:c});a.add(ns.languages.registerInlineEditProvider("*",d)),u&&a.add(ns.window.onDidChangeTextEditorSelection(y=>{if(y.selections.length!==1)return;let b=y.selections[0];bu.isActionableSelection(b)&&ns.commands.executeCommand("editor.action.inlineSuggest.trigger")}));let p=this._inlineEditsProviderId.read(s),f;switch(p){case Wx.ID:f=t.createInstance(Wx);break;default:f=t.createInstance(VE);break}let m=this._register(t.createInstance(Kx,f)),h=new zee(m,c);a.add(ns.languages.registerInlineEditProvider("*",h));let g=a.add(new WE("github-copilot-inline-edit-tests"));a.add(ns.commands.registerCommand("github.copilot.debug.generateInlineEditTests",y=>{if(!y)return;let b=ns.workspace.textDocuments.find(R=>R.uri.toString()===y.toString());if(!b)return;let _=b.getText(),x=Number.parseInt(_.match(/\(RequestId: (\d+)\)/)?.[1]??"-1",10),I=c.getRequestById(x);if(!I)return;let S=[];S.push("# Tests for "+I.getDebugName()),S.push("```ts"),S.push(I.createTestCaseTs()),S.push("```");let w=g.createUriForData(S.join(`
`),"copilotmd");g.openUri(w)})),a.add(ns.commands.registerCommand(O1e,async y=>{if(!this._isInternal.get())return;let b=new $ee;b.appendSection("STest",[y.logContext.createTestCaseTs()]),b.appendLine("");let _=await bnt();b.appendSection("UI Repro",[_]),await Fee({title:"Inline Edit Feedback",data:b.toString(),issueBody:`# Description
Please describe the expected outcome and attach a screenshot!`})}))}))}};KE=E([v(0,H),v(1,be),v(2,xt)],KE);async function bnt(){return(await ns.commands.executeCommand("editor.action.inlineSuggest.dev.extractRepro")).reproCase}var O1e="github.copilot.debug.inlineEdit.reportFeedback",Kx=class extends ye{constructor(t,r){super();this._predictor=t;this._instantiationService=r;this.tracker=new OU;this.nextEditProvider=this._instantiationService.createInstance(ly,this.tracker,this._predictor);this._register(ns.workspace.onDidOpenTextDocument(o=>{this.isDisabledForDocument(o)||this.tracker.handleDocumentOpened(_u(o),L1e(o))})),this._register(ns.workspace.onDidChangeTextDocument(o=>{if(this.isDisabledForDocument(o.document))return;let s=Wee(o.contentChanges);this.tracker.handleEdit(_u(o.document),s)})),this._register(ns.window.onDidChangeTextEditorSelection(o=>{this.isDisabledForDocument(o.textEditor.document)||this.tracker.handleSelectionChanged?.(_u(o.textEditor.document))})),this._register(ns.workspace.onDidCloseTextDocument(o=>{this.isDisabledForDocument(o)||this.tracker.handleDocumentClosed(_u(o))}));for(let o of ns.workspace.textDocuments){if(this.isDisabledForDocument(o))return;this.tracker.handleDocumentOpened(_u(o),L1e(o))}}static{this.disallowedDocumentUriSchemes=new Set(["output"])}isDisabledForDocument(t){return Kx.disallowedDocumentUriSchemes.has(t.uri.scheme)}};Kx=E([v(1,H)],Kx);var zee=class n{constructor(e,t){this.model=e;this.logger=t}async provideInlineEdit(e,t,r){if(this.isDisabledForDocument(e))return;let o=new UE(e.fileName,e.version);try{let s=await Dhe(Dp(this.model.nextEditProvider.getNextEdit(_u(e),o,r),4e3),r);return s?.edit?{range:_nt(e,s.edit.range),text:s.edit.newText,commands:[{command:O1e,title:"Feedback",arguments:[{logContext:o}]}]}:void 0}catch(s){throw o.setError(s),s}finally{this.logger.add(o)}}static{this.disabledLanguageIds=new Set(["log","markdown","plaintext"])}isDisabledForDocument(e){return e.uri.scheme==="output"||n.disabledLanguageIds.has(e.languageId)}};function _nt(n,e){return new ns.Range(n.positionAt(e.start),n.positionAt(e.endExclusive))}function Wee(n){let e=n.map(t=>gu.replace(gt.ofStartAndLength(t.rangeOffset,t.rangeLength),t.text));return e.reverse(),Lc.create(e)}function L1e(n){return new vu(n.getText())}function _u(n){return n.uri.toString()}var $ee=class{constructor(){this._lines=[]}appendLine(e){this._lines.push(e)}toString(){return this._lines.join(`
`)}appendSection(e,t){this._lines.push(`<details><summary>${e}</summary>`,"<p>",...t,"</p>","</details>")}};var Yx=q(ht()),fr=q(require("vscode"));var YE=class extends ye{constructor(e,t,r){super();let o=this._register(new _t);Snt(o,t,e),Int(e,r,o),xnt(o)}};YE=E([v(0,Tl),v(1,ge),v(2,be)],YE);function xnt(n){async function e(t){let r=ti.first(t.entries());if(!r)return;await fr.workspace.applyEdit(t,{isRefactoring:!0});let o=await fr.workspace.openTextDocument(r[0]);await fr.window.showTextDocument(o,{preview:!0,selection:r[1][0].range})}n.add(fr.commands.registerCommand("github.copilot.tests.fixTestFailure.applyAndRerun",async(t,r,o)=>{await e(r),await mc(1e3),fr.commands.executeCommand("testing.reRunFailTests");let s=await new Promise(d=>{let p=fr.tests.onDidChangeTestResults(()=>{fr.tests.testResults.length&&(d(fr.tests.testResults[0]),p.dispose())})}),a=Tnt(t,s.results);if(a===void 0||!a.taskStates.some(d=>d.state===fr.TestResultState.Failed||d.state===fr.TestResultState.Errored))return;let c=Yx.t("Undo"),l=Yx.t("Try Fixing Again"),u=await fr.window.showInformationMessage(Yx.t("Looks like the test still failed. What would you like to do?"),Yx.t("Keep Changes"),c,l);if(u===l){let d=wp(a.taskStates,p=>p.messages.find(f=>!!f.location));d?fr.commands.executeCommand("github.copilot.tests.fixTestFailure",{message:d,test:a,source:"retry"}):fr.commands.executeCommand("vscode.editorChat.start",{message:"/fixTestFailure",autoSend:!0})}else u===c&&await e(o)}))}function Snt(n,e,t){function r(s){return t.getLastFailureFor(s)||wp(s.children,([,c])=>r(c))}n.add(fr.commands.registerCommand("github.copilot.tests.fixTestFailure.fromInline",s=>{let a=r(s);a&&o({message:a.task.messages[0],test:a.snapshot,source:"testResultsPanel"})})),n.add(fr.commands.registerCommand("github.copilot.tests.fixTestFailure",o));async function o(s){if(!s.test.uri)return;e.sendMSFTTelemetryEvent("intent.fixTestFailure.actioned",{source:s.source??"testResultsPanel"});let a=await fr.workspace.openTextDocument(s.test.uri);await fr.window.showTextDocument(a,{preserveFocus:!1,preview:!0,selection:s.test.range?new fr.Range(s.test.range.start,s.test.range.start):void 0}),await fr.commands.executeCommand("vscode.editorChat.start",{message:"/fixTestFailure",autoSend:!0})}}function Int(n,e,t){t.add(fr.languages.registerCodeActionsProvider("*",{provideCodeActions(r,o,s,a){if(!e.getConfig(le.EnableCodeActions)||!n.isEnabled.get())return;let l=n.getFailureAtPosition(r.uri,o.start);if(!l)return;let u=new fr.CodeAction(Yx.t("Fix test failure"),fr.CodeActionKind.QuickFix);return u.isAI=!0,u.command={title:Yx.t("Fix test failure"),command:"github.copilot.tests.fixTestFailure",arguments:[{message:l.task.messages[0],test:l.snapshot,source:"sparkles"}]},[u]}}))}function Tnt(n,e){let t=[];for(let r=n;r;r=r.parent)t.push(r.id);for(let r=t.length-1;r>=0;r--){let o=t[r],s=e.find(a=>a.id===o);if(!s)return;if(r===0)return s;e=s.children}}var Xn=q(require("vscode"));var ZU=q(ht());var Xs=q(Ve());var QU=class extends Xs.PromptElement{async prepare(){return{}}render(e,t){return vscpp(vscppf,null,vscpp(vscppf,null,vscpp(Xs.SystemMessage,{priority:1e3},"You are an AI that creates a detailed content outline for a Jupyter notebook on a given topic.",vscpp("br",null),vscpp(vn,null),vscpp(Ze,null),vscpp(ii,null),vscpp(kt,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"DO NOT include Introduction or Conclusion section in the outline!",vscpp("br",null),"Focus only on sections that will need code!",vscpp("br",null),["","Generate the outline as two parts:","- First part is markdown bullet list of section titles","- Second part is the JSON data that will validate against this JSON schema, wrap the response in code block. We assume that a code block begins with ```[optionally the language] and ends with ```","","The JSON schema is:","{",'  "$schema": "http://json-schema.org/draft-07/schema#",','  "type": "object",','  "properties": {','	"description": {','	  "type": "string"',"	},",'	"sections": {','	  "type": "array",','	  "items": {','		"type": "object",','		"properties": {','		  "title": {','			"type": "string"',"		  },",'		  "content": {','			"type": "string"',"		  }","		},",'		"required": ["title", "content"]',"	  }","	}","  },",'  "required": ["sections"]',"}"].join(`
`),["","Examples:","","Below you will find a set of examples of what you should respond with. Please follow these examples as closely as possible.","","## Valid notebook creation question","","user: Creating Random Arrays with Numpy","","assistant: Here's an outline for a Jupyter notebook that creates Random Arrays with Numpy:","","* **Import Required Libraries**","* **Create Random Arrays**","* **Seed the Random Number Generator**","* **Generate Random Integers**","","```json","{",'  "description": "A Jupyter notebook that creates Random Arrays with Numpy.",','  "sections": [',"    {",'      "title": "Import Required Libraries",','      "content": "Import the necessary libraries, including NumPy."',"    },","    {",'      "title": "Create Random Arrays",','      "content": "Use NumPy to create random arrays of various shapes and sizes, including 1D, 2D, and 3D arrays."',"    },","    {",'      "title": "Seed the Random Number Generator",','      "content": "Use the seed() function to seed the random number generator for reproducibility."',"    },","	{",'	  "title": "Generate Random Integers",','	  "content": "Use the randint() function to generate random integers within a specified range."',"	}","  ]","}","```"].join(`
`))),vscpp(tn,{priority:899,flexGrow:2,endpoint:this.props.endpoint,promptContext:this.props.promptContext}),this.props.promptContext.chatVariables&&Object.keys(this.props.promptContext.chatVariables).length>0?vscpp($n,{flexGrow:2,priority:900,chatVariables:this.props.promptContext.chatVariables,query:`Create notebook: ${this.props.promptContext.query}`}):vscpp(Xs.UserMessage,{priority:900},"Create notebook: ",this.props.promptContext.query))}},XU=class extends Xs.PromptElement{async prepare(){return{}}render(e,t){return vscpp(vscppf,null,vscpp(vscppf,null,this.props.history&&vscpp(Kee,{messages:this.props.history.chatMessages??[]}),vscpp(Xs.SystemMessage,{priority:1e3},"You are an AI that writes Python code for a single section of a Jupyter notebook.",vscpp("br",null),vscpp(vn,null),vscpp(Ze,null),vscpp(kt,null),"When dealing with Jupyter Notebook, if a module is already imported in a cell, it can be used in other cells directly without importing it again. For the same reason, if a variable is defined in a cell, it can be used in other cells as well",vscpp("br",null),"When dealing with Jupyter Notebook, cells below the current cell can be executed before the current cell, you must use the variables defined in the cells below, unless you want to overwrite them.",vscpp("br",null),"When dealing with Jupyter Notebook, do not generate CELL INDEX in the code blocks in your answer, it is only used to help you understand the context.",vscpp("br",null),"If the Jupyter Notebook already contains variables, you should respect the name and value of the variables, and use them in your code when necessary.",vscpp("br",null),"Your output should be valid Python code with inline comments.",vscpp("br",null),"You should return the code directly without any explantion.",vscpp("br",null),"You should not print message to explain the code or purpose of the code.",vscpp("br",null),"You should return the code directly, without wrapping it inside \\`\\`\\`.",vscpp("br",null),"Please make sure that the new code is syntactically valid Python code. It can be validated by running it in a Python interpreter.",vscpp("br",null),"For example, it should pass the validation through builtin module codeop \\`codeop.compile_command(statement)\\`.",vscpp("br",null)),vscpp(Xs.UserMessage,{priority:900},"Overall topic of the notebook: ",this.props.description,vscpp("br",null),"Title of the notebook section: ",this.props.section.title,vscpp("br",null),"Description of the notebok section: ",this.props.section.content,vscpp("br",null),"Given this information, write all the code for this section and this section only.",vscpp("br",null),"The request to generate the outline of the notebook is already completed.",vscpp("br",null),"Here is the request details for the outline generation:",vscpp("br",null),vscpp("br",null),"Code in the notebook so far:",vscpp("br",null),vscpp("br",null),this.props.existingCode,vscpp("br",null),vscpp("br",null),"Please make sure the new code you generate works fine with the code above.",vscpp("br",null))))}},Kee=class extends Xs.PromptElement{render(e,t){let r=[];for(let o of this.props.messages)switch(o.role){case"user":r.push(vscpp(Xs.UserMessage,{priority:800},o.content));break;case"assistant":r.push(vscpp(Xs.AssistantMessage,{priority:800},o.content));break;case"system":r.push(vscpp(Xs.SystemMessage,{priority:100},o.content));break;default:break}return vscpp(vscppf,null,r)}},JU=class extends Xs.PromptElement{async prepare(){return{}}render(e,t){return vscpp(vscppf,null,vscpp(vscppf,null,vscpp(Xs.SystemMessage,{priority:1e3},"You are an AI that improves Python code with respect to readability and performance for a single section of a Jupyter notebook.",vscpp("br",null),vscpp(vn,null),vscpp(Ze,null),vscpp(kt,null),"You MUST return Python code as your answer.",vscpp("br",null),"DO NOT explain in inline comments for your the improvements.",vscpp("br",null),"You should not print messages to explain the code or purpose of the code.",vscpp("br",null),"Make sure the new code you generate works fine with the code above.",vscpp("br",null),"Make sure if a module is already imported in the code above, it can be used in the new code directly without importing it again. For the same reason, if a variable is defined above, it can be used in new code as well. ",vscpp("br",null),"Make sure to return the code only - don't give an explanation of the improvements.",vscpp("br",null)),vscpp(Xs.UserMessage,{priority:900},"Overall topic of the notebook: ",this.props.description,vscpp("br",null),"Title of the notebook section: ",this.props.section.title,vscpp("br",null),"Description of the notebook section: ",this.props.section.content,vscpp("br",null),"Code in the notebook so far:",vscpp("br",null),vscpp("br",null),this.props.existingCode,vscpp("br",null),vscpp("br",null),"Given this information, suggest improvements for the following code:",vscpp("br",null),vscpp("br",null),this.props.code,vscpp("br",null),vscpp("br",null))))}};var e7=class{constructor(){this.stagedTextToApply="";this.reporting=!0;this._resolvedContentDeferredPromise=new ys;this._incodeblock=!1;this._presentCodeblockProgress=!1}async processResponse(e,t,r,o){let{turn:s}=e;for await(let{delta:a}of t){if(o.isCancellationRequested)return;this.applyDelta(a.text,s,r)}this.pushCommands(s,r)}applyDeltaToTurn(e,t){t.response||(t.response={message:e,type:"model"}),t.response.message+=e}applyDeltaToProgress(e,t){t.markdown(e)}applyDelta(e,t,r){if(!this.reporting){this.applyDeltaToTurn(e,t);return}if(e=this.stagedTextToApply+e,this._incodeblock){let s=e.indexOf("```");if(s===-1){this.stagedTextToApply=e,this.applyDeltaToTurn("",t),this._presentCodeblockProgress||(this._presentCodeblockProgress=!0,r.progress(ZU.t("Thinking ...")));return}else{this._incodeblock=!1,e=e.substring(0,s)+"```";try{this.applyDeltaToTurn(e,t)}catch{}finally{this.reporting=!1,this.stagedTextToApply="",this._resolvedContentDeferredPromise.complete(new ki(""))}return}}let o=e.indexOf("```");if(o!==-1){this._incodeblock=!0;let s=e.indexOf("```",o+3);if(s!==-1){this._incodeblock=!1,this.applyDeltaToProgress(e.substring(0,o),r),this.applyDeltaToProgress(e.substring(s+3),r),this.applyDeltaToTurn(e,t),this.reporting=!1,this.stagedTextToApply="";return}else{let a=e.substring(0,o);this.applyDeltaToProgress(a,r),this.applyDeltaToTurn(e,t),this.stagedTextToApply="",this._presentCodeblockProgress||(this._presentCodeblockProgress=!0,r.progress(ZU.t("Thinking ..."))),this._resolvedContentDeferredPromise.p.then(c=>r.push(c));return}}this.applyDeltaToProgress(e,r),this.applyDeltaToTurn(e,t),this.stagedTextToApply=""}pushCommands(e,t){let r=(e.response?.message??"").replace(/\n/g,""),s=/```(?:json)?(.+)/g.exec(r);if(s)try{let a=s[1],c=a.indexOf("```"),l=c===-1?a:a.substring(0,c),u=JSON.parse(l);t.button({command:"github.copilot.newNotebook",arguments:[{turn:e,outline:u}],title:ZU.t("Create Notebook")})}catch{}return[]}};async function M1e(n,e,t,r,o,s,a,c,l){let{messages:u}=await Qi(n,t,XU,{history:o,description:s,section:a,existingCode:c}),d=await e.fetchOne("newNotebookCodeCell",u,void 0,l,2,t);if(d.type!=="success")return;let p=Is(d.value);return p.length>0?p[0].code:d.value}async function F1e(n,e,t,r,o,s,a,c,l){let{messages:u}=await Qi(n,t,JU,{description:o,section:s,existingCode:a,code:c}),d=await e.fetchOne("improveNotebookCodeCell",u,void 0,l,2,t);if(d.type==="success")return d.value}var QE=class extends ye{constructor(e,t,r,o,s){super(),this._register(Xn.commands.registerCommand("github.copilot.newNotebook",async a=>{let c=e.getConfig(le.NotebookIterativeImproving);await Xn.window.withProgress({location:Xn.ProgressLocation.Notification},async l=>{let u=new Xn.NotebookData([]);u.metadata={custom:{cells:[],metadata:{orig_nbformat:4},nbformat:4,nbformat_minor:2}};let d=await Xn.workspace.openNotebookDocument("jupyter-notebook",u),p=await Xn.window.showNotebookDocument(d);l.report({message:Xn.l10n.t("Generating notebook...")});let f=a.outline.description,m=a.outline.sections,h=await t.getChatEndpoint("gpt-4");for(let g of m){let y=p.notebook.getCells().filter(k=>k.kind===Xn.NotebookCellKind.Code).map(k=>k.document.getText()).join(`
`),b=new Xn.CancellationTokenSource;l.report({message:Xn.l10n.t('Generating section "{0}"...',g.title)});let _=await M1e(r,o,h,s,a.turn,f,g,y,b.token);if(!_)return;_=_.trim();let x=/```([a-zA-Z]+)?\s*([\s\S]+?)\s*```$/.exec(_);if(x&&x.length>2&&(_=x[2]),c){l.report({message:Xn.l10n.t('Improving code for section "{0}"...',g.title)});let k=await F1e(r,o,h,s,f,g,y,_,b.token);if(!k)return;_=k}let I=new Xn.NotebookCellData(Xn.NotebookCellKind.Markup,`# ${g.title}
${g.content}`,"markdown"),S=new Xn.NotebookCellData(Xn.NotebookCellKind.Code,_,"python"),w=Xn.NotebookEdit.insertCells(d.cellCount,[I,S]),R=new Xn.WorkspaceEdit;R.set(d.uri,[w]),await Xn.workspace.applyEdit(R),p.revealRange(new Xn.NotebookRange(d.cellCount-1,d.cellCount),Xn.NotebookEditorRevealType.Default),p.selection=new Xn.NotebookRange(d.cellCount-1,d.cellCount)}l.report({increment:100})})}))}};QE=E([v(0,be),v(1,_e),v(2,H),v(3,Et),v(4,va)],QE);var rs=q(require("vscode"));var dy=class{constructor(e,t){this.logService=e;this.parserService=t;this.store=new _t,this.onDidChangeCodeLenses=rs.tests.onDidChangeTestResults}static{this.codeLensTitle=rs.l10n.t("Generate tests using Copilot")}static isEnabled(e){return e.getConfig(le.GenerateTestsCodeLens)}dispose(){this.store.dispose()}provideCodeLenses(e,t){return this.computeCodeLens(e,t)}async computeCodeLens(e,t){if(e.uri.scheme==="output")return[];let r=rs.tests.testResults;if(r.length===0)return this.logService.public.trace("No test results"),[];let o=r[0],s;try{s=await o.getDetailedCoverage?.(e.uri,t)}catch(c){return this.logService.public.error(c),[]}if(!s||s.length===0)return this.logService.public.trace("No detailed coverage"),[];let a=[];for(let c of s)if(c instanceof rs.DeclarationCoverage){if(this.logService.public.trace(`Received statement coverage for ${c.name}. (detail.executed: ${c.executed})`),!!c.executed)continue;let u=c.location instanceof rs.Range?c.location:new rs.Range(c.location,c.location);a.push(this.createCodeLens(e,u))}else c instanceof rs.StatementCoverage?this.logService.public.trace("Received statement coverage; did nothing"):this.logService.public.error("Unexpected coverage type");if(a.length===0){let c=this.parserService.getTreeSitterAST(e);if(c===void 0)return a;let l=await c.getTestableNodes();if(l===null)return a;let u=s.flatMap(p=>p.executed?[]:p.location instanceof rs.Position?[p.location.line]:this.toLineNumbers(p.location)),d=new Set(u);for(let p of l){let f=e.positionAt(p.node.startIndex),m=e.positionAt(p.node.endIndex),h=new rs.Range(f,m);S2(f.line,m.line).every(g=>d.has(g))&&a.push(this.createCodeLens(e,h))}}return a}createCodeLens(e,t){return new rs.CodeLens(t,{title:dy.codeLensTitle,command:"github.copilot.chat.generateTests",arguments:[{document:e,selection:t}]})}toLineNumbers(e){let t=[];for(let r=e.start.line;r<=e.end.line;r++)t.push(r);return t}};dy=E([v(0,oe),v(1,ft)],dy);var XE=class extends ye{constructor(e,t){if(super(),dy.isEnabled(e)){let r=this._register(t.createInstance(dy));this._register(rs.languages.registerCodeLensProvider("*",r))}}};XE=E([v(0,be),v(1,H)],XE);var Dwe=q(require("dns")),Nwe=q(require("util")),zh=q(require("vscode"));var Cnt=q(require("http")),Ent=q(require("https"));var JE=class{constructor(e){this._envService=e}fetch(e,t){let r=t.headers||{};r["User-Agent"]=`GitHubCopilotChat/${this._envService.getVersion()}`;let o=t.body;if(t.json){if(t.body)throw new Error("Illegal arguments! Cannot pass in both 'body' and 'json'!");r["Content-Type"]="application/json",o=JSON.stringify(t.json)}let s=t.method||"GET";if(s!=="GET"&&s!=="POST")throw new Error("Illegal arguments! 'method' must be either 'GET' or 'POST'!");let a=t.signal??new AbortController().signal;if(a&&!(a instanceof AbortSignal))throw new Error("Illegal arguments! 'signal' must be an instance of AbortSignal!");return this._fetch(e,s,r,o,a)}_fetch(e,t,r,o,s){return new Promise((a,c)=>{let u=(e.startsWith("https:")?Ent:Cnt).request(e,{method:t,headers:r},d=>{if(s.aborted){d.destroy(),u.destroy(),c(Yee(s));return}let p=new Qee(u,d,s);a(new Ov(d.statusCode||0,d.statusMessage||"",p.headers,async()=>p.text(),async()=>p.json(),async()=>p.body()))});u.setTimeout(60*1e3),u.on("error",c),o&&u.write(o),u.end()})}async disconnectAll(){}makeAbortController(){return new AbortController}isAbortError(e){return wnt(e)}isDNSLookupFailedError(e){return e&&e.code==="ENOTFOUND"}isFetcherError(e){return e&&["EADDRINUSE","ECONNREFUSED","ECONNRESET","ENOTFOUND","EPIPE","ETIMEDOUT"].includes(e.code)}getUserMessageForFetcherError(e){return`Please check your firewall rules and network connection then try again. Error Code: ${e.code}.`}};function Yee(n){return n.reason}function wnt(n){return n&&n.name==="AbortError"}var Qee=class{constructor(e,t,r){this.req=e;this.res=t;this.signal=r;this.headers=new class{get(o){let s=t.headers[o];return Array.isArray(s)?s[0]:s??null}[Symbol.iterator](){let o=Object.keys(t.headers),s=0;return{next:()=>{if(s>=o.length)return{done:!0,value:void 0};let a=o[s++];return{done:!1,value:[a,this.get(a)]}}}}}}text(){return new Promise((e,t)=>{let r=[];this.res.on("data",o=>r.push(o)),this.res.on("end",()=>e(Buffer.concat(r).toString())),this.res.on("error",t),this.signal.addEventListener("abort",()=>{this.res.destroy(),this.req.destroy(),t(Yee(this.signal))})})}async json(){let e=await this.text();return JSON.parse(e)}async body(){return this.signal.addEventListener("abort",()=>{this.res.emit("error",Yee(this.signal)),this.res.destroy(),this.req.destroy()}),this.res}};var Xee=require("stream");var ZE=class n{constructor(e,t){this._net=e;this._envService=t}static create(e){let t=knt();return t?new n(t,e):null}async fetch(e,t){let r=t.headers||{};r["User-Agent"]=`GitHubCopilotChat/${this._envService.getVersion()}`;let o=t.body;if(t.json){if(t.body)throw new Error("Illegal arguments! Cannot pass in both 'body' and 'json'!");r["Content-Type"]="application/json",o=JSON.stringify(t.json)}let s=t.method||"GET";if(s!=="GET"&&s!=="POST")throw new Error("Illegal arguments! 'method' must be either 'GET' or 'POST'!");let a=t.signal??new AbortController().signal;if(a&&!(a instanceof AbortSignal))throw new Error("Illegal arguments! 'signal' must be an instance of AbortSignal!");return this._fetch(e,s,r,o,a)}async _fetch(e,t,r,o,s){let a=await this._net.fetch(e,{method:t,headers:r,body:o,signal:s});return new Ov(a.status,a.statusText,a.headers,()=>a.text(),()=>a.json(),async()=>{if(!a.body)return Xee.Readable.from([]);let c=a.body[Symbol.asyncIterator]();return Xee.Readable.from(c)})}async disconnectAll(){}makeAbortController(){return new AbortController}isAbortError(e){return e&&e.name==="AbortError"}isDNSLookupFailedError(e){return["net::ERR_INTERNET_DISCONNECTED","net::ERR_NAME_NOT_RESOLVED","net::ERR_NETWORK_CHANGED"].includes(e?.message)}isFetcherError(e){return e&&e.message&&e.message.startsWith("net::")}getUserMessageForFetcherError(e){return`Please check your firewall rules and network connection then try again. Error Code: ${e.message}.`}};function knt(){try{return require("electron").net}catch{}}var aw=q(JTe(),1),Tkn={ALPN_HTTP2:aw.default.ALPN_HTTP2,ALPN_HTTP2C:aw.default.ALPN_HTTP2C,ALPN_HTTP1_1:aw.default.ALPN_HTTP1_1,ALPN_HTTP1_0:aw.default.ALPN_HTTP1_0},{fetch:Ckn,context:ZTe,reset:Ekn,noCache:wkn,h1:kkn,keepAlive:Rkn,h1NoCache:Pkn,keepAliveNoCache:Akn,cacheStats:Dkn,clearCache:Nkn,offPush:Lkn,onPush:Okn,createUrl:Mkn,timeoutSignal:Fkn,Body:Ukn,Headers:Bkn,Request:qkn,Response:jkn,AbortController:eCe,AbortError:Pte,AbortSignal:Hkn,FetchBaseError:Vkn,FetchError:Ate,ALPN_HTTP2:Gkn,ALPN_HTTP2C:zkn,ALPN_HTTP1_1:$kn,ALPN_HTTP1_0:Wkn}=aw.default;var Ewe=q(require("tls"));var Swe=q(require("crypto")),Iwe=q(require("fs")),Twe=require("tls");var x7=re("IWindowsCaCertsLoader");var nB=re("IRootCertificateReader"),oO=class{constructor(e,t){this.delegate=e;this.logService=t}async getAllRootCAs(){try{return await this.delegate.getAllRootCAs()}catch(e){return this.logService.public.warn(`Failed to read root certificates: ${e}`),[]}}};oO=E([v(1,oe)],oO);var sO=class{constructor(e,t){this._logService=t;this.delegates=e.map(r=>new oO(r,t))}async getAllRootCAs(){return this.certificates||(this.certificates=this.removeExpiredCertificates((await Promise.all(this.delegates.map(e=>e.getAllRootCAs()))).flat())),this.certificates}removeExpiredCertificates(e){let t=Date.now(),r=e.filter(o=>{try{let s=new Swe.X509Certificate(o),a=Date.parse(s.validTo);return isNaN(a)||a>t}catch(s){return this._logService.public.error(s,"Failed to parse certificate "+o),!1}});return e.length!==r.length&&this._logService.public.info(`Removed ${e.length-r.length} expired certificates`),r}};sO=E([v(1,oe)],sO);var Une=class{async getAllRootCAs(){return Twe.rootCertificates}},Bne=class{async getAllRootCAs(){let e=process.env.NODE_EXTRA_CA_CERTS;return e?await Cwe(e):[]}},qne=class{async getAllRootCAs(){let e=[];for(let t of["/etc/ssl/certs/ca-certificates.crt","/etc/ssl/certs/ca-bundle.crt"]){let r=await Cwe(t);e=e.concat(r)}return e}},jne=class{async getAllRootCAs(){let e=xwe();return e.all(e.der2.pem).filter(t=>t!==void 0)}},aO=class{constructor(e){this.windowsCaCertsLoader=e}async getAllRootCAs(){return await this.windowsCaCertsLoader.loadCaCerts()||[]}};aO=E([v(0,x7)],aO);var Tw=class extends sO{constructor(e,t,r){super([new Une,new Bne,olt(r,e)],t)}};Tw=E([v(1,oe),v(2,H)],Tw);function olt(n,e){switch(e){case"linux":return new qne;case"darwin":return new jne;case"win32":return n.createInstance(aO);default:return new Hne}}var Hne=class{async getAllRootCAs(){throw new Error("No certificate reader available for unsupported platform")}};async function Cwe(n){try{let r=(await Iwe.promises.readFile(n,{encoding:"utf8"})).split(/(?=-----BEGIN CERTIFICATE-----)/g).filter(s=>s.length>0),o=new Set(r);return Array.from(o)}catch(e){if(e?.code!=="ENOENT")throw e}return[]}var Cw=class{constructor(e){this._certificateReader=e}#t;async enhanceProxySettings(e){let t=await this.getCertificates();return{...e,ca:t}}async getCertificates(){let e=await this._certificateReader.getAllRootCAs();if(e.length!==0)return e}async createSecureContext(){let e=await this._certificateReader.getAllRootCAs(),r=Ewe.createSecureContext({_vscodeAdditionalCaCerts:e});for(let o of e)r.context.addCACert(o);return{secureContext:r,certs:e}}async applyToRequestOptions(e){this.#t??=this.createSecureContext();let t=await this.#t;e.secureContext=t.secureContext,e.ca=t.certs,e.cert=t.certs}};Cw=E([v(0,nB)],Cw);var wwe=q(require("http"));var cO=re("IKerberosLoader");var slt=407,ww=re("IProxySocketFactory"),uS=class extends Error{constructor(e,t,r){super(e),this.code=t?.code,this.syscall=t?.syscall,this.errno=t?.errno,/^Failed to establish a socket connection to proxies:/.test(t?.message??"")?this.code="ProxyFailedToEstablishSocketConnection":/^InitializeSecurityContext:/.test(t?.message??"")?this.code="ProxyInitializeSecurityContext":t?.message==="Miscellaneous failure (see text): Server not found in Kerberos database"?this.code="ProxyKerberosServerNotFound":/^Unspecified GSS failure. {2}Minor code may provide more information: No Kerberos credentials available/.test(t?.message??"")&&(this.code="ProxyGSSFailureNoKerberosCredentialsAvailable"),r!==void 0&&(this.code=r)}},lO=class{constructor(e,t=process.platform,r,o,s){this.delegate=e;this.platform=t;this.kerberosLoader=r;this.configurationService=o;this.logService=s;this.successfullyAuthorized=new kp(20)}async createSocket(e,t){this.successfullyAuthorized.get(this.getProxyCacheKey(t))&&(this.logService.public.debug("Proxy authorization already successful once, skipping 407 rountrip"),await this.reauthorize(e,t));try{return await this.delegate.createSocket(e,t)}catch(r){if(r instanceof uS&&r.code===`ProxyStatusCode${slt}`){this.logService.public.debug("Proxy authorization required, trying to authorize first time");let o=await this.authorizeAndCreateSocket(e,t);if(o)return this.logService.public.debug("Proxy authorization successful, caching result"),this.successfullyAuthorized.set(this.getProxyCacheKey(t),!0),o}throw r}}async reauthorize(e,t){let r=await this.authorize(t);r&&(this.logService.public.debug("Proxy re-authorization successful, received token"),e.headers["Proxy-Authorization"]="Negotiate "+r)}async authorizeAndCreateSocket(e,t){let r=await this.authorize(t);if(this.logService.public.debug("Proxy authorization successful, received token"),r)return this.logService.public.debug("Trying to create socket with proxy authorization"),e.headers["Proxy-Authorization"]="Negotiate "+r,await this.delegate.createSocket(e,t)}async authorize(e){this.logService.public.debug("Loading kerberos module");let t=await alt(this.kerberosLoader);if(!t){this.logService.public.debug("Could not load kerberos module");return}let r=this.computeSpn(e);this.logService.public.debug("Initializing kerberos client using spn "+r);let o=await t.initializeClient(r);this.logService.public.debug("Perform client side kerberos step");let s=await o.step("");return this.logService.public.debug("Received kerberos server response"),s}computeSpn(e){let r=this.configurationService.getConfig(le.KerberosServicePrincipal)??e.kerberosServicePrincipal;if(r)return this.logService.public.debug("Using configured kerberos spn "+r),r;let o=this.platform==="win32"?`HTTP/${e.host}`:`HTTP@${e.host}`;return this.logService.public.debug("Using default kerberos spn "+o),o}getProxyCacheKey(e){return e.host+":"+e.port}};lO=E([v(2,cO),v(3,be),v(4,oe)],lO);var Ew=class extends lO{constructor(e,t,r,o){super(e.createInstance(uO),process.platform,t,r,o)}};Ew=E([v(0,H),v(1,cO),v(2,be),v(3,oe)],Ew);var uO=class{constructor(e){this.logService=e}async createSocket(e,t){let r=this.createConnectRequestOptions(e,t);return new Promise((o,s)=>{this.logService.public.debug("Attempting to establish connection to proxy");let a=wwe.request(r);a.useChunkedEncodingByDefault=!1,a.once("connect",(c,l,u)=>{this.logService.public.debug("Socket Connect returned status code "+c.statusCode),a.removeAllListeners(),l.removeAllListeners(),c.statusCode!==200?(l.destroy(),s(new uS(`tunneling socket could not be established, statusCode=${c.statusCode}`,void 0,`ProxyStatusCode${c.statusCode}`))):u.length>0?(l.destroy(),s(new uS(`got non-empty response body from proxy, length=${u.length}`,void 0,"ProxyNonEmptyResponseBody"))):(this.logService.public.debug("Successfully established tunneling connection to proxy"),o(l))}),a.once("error",c=>{if(!c.message&&c instanceof AggregateError){let l=c.stack;c=new AggregateError(c.errors,`Aggregate error:${c.errors.map(u=>`
- ${u.message}`).join("")}`),c.stack=l}this.logService.public.debug("Proxy socket connection error "+c.message),a.removeAllListeners(),s(new uS(`tunneling socket could not be established, cause=${c.message}`,c))}),a.on("timeout",()=>{this.logService.public.debug("Proxy socket connection timeout"),s(new uS(`tunneling socket could not be established, proxy socket connection timeout while connecting to ${r.host}:${r.port}`,void 0,"ProxyTimeout"))}),a.end()})}createConnectRequestOptions(e,t){let r=`${e.hostname}:${e.port}`,o={...t,method:"CONNECT",path:r,agent:!1,headers:{host:r,"Proxy-Connection":"keep-alive"},timeout:e.timeout};return e.localAddress&&(o.localAddress=e.localAddress),this.configureProxyAuthorization(o,e),o}configureProxyAuthorization(e,t){e.headers["Proxy-Authorization"]=[],e.proxyAuth&&e.headers["Proxy-Authorization"].push("Basic "+Buffer.from(e.proxyAuth).toString("base64")),t.headers&&t.headers["Proxy-Authorization"]&&e.headers["Proxy-Authorization"].push(t.headers["Proxy-Authorization"])}};uO=E([v(0,oe)],uO);async function alt(n){try{return n.loadKerberos()}catch{return}}var kw=class{constructor(e,t,r){this.envService=e;this.proxySocketFactory=t;this.createSocketFactory=(e,t)=>async r=>{r.rejectUnauthorized=t,r.timeout=e.connectionTimeoutInMs,await this.certificateConfigurator.applyToRequestOptions(r);let o=await this.certificateConfigurator.enhanceProxySettings(e);return await this.proxySocketFactory.createSocket(r,o)};this.fetchApi=this.createFetchApi(),this.certificateConfigurator=r.createInstance(Cw)}set proxySettings(e){this._proxySettings=e,this.fetchApi=this.createFetchApi()}get proxySettings(){return this._proxySettings}set rejectUnauthorized(e){this._rejectUnauthorized=e,this.fetchApi=this.createFetchApi()}get rejectUnauthorized(){return this._rejectUnauthorized}createFetchApi(){return ZTe({userAgent:`GitHubCopilotChat/${this.envService.getVersion()}`,socketFactory:this._proxySettings?this.createSocketFactory(this._proxySettings,this.rejectUnauthorized):void 0,rejectUnauthorized:this.rejectUnauthorized})}async fetch(e,t){let r=t.signal,o=!1,s={...t,body:t.body?t.body:t.json,signal:r};await this.certificateConfigurator.applyToRequestOptions(s);let a=await this.certificateConfigurator.getCertificates();this.fetchApi.setCA(a);let c=await this.fetchApi.fetch(e,s).catch(l=>{throw o?new Pte(`Request to <${e}> timed out after ${t.timeout}ms`):l});return new Ov(c.status,c.statusText,c.headers,()=>c.text(),()=>c.json(),async()=>c.body)}disconnectAll(){return this.fetchApi.reset()}makeAbortController(){return new eCe}isAbortError(e){return e instanceof Pte}isDNSLookupFailedError(e){return e instanceof Ate&&e.code==="ENOTFOUND"}isFetcherError(e){return e instanceof Ate}getUserMessageForFetcherError(e){return`Please check your firewall rules and network connection then try again. Error Code: ${e.code}.`}};kw=E([v(0,it),v(1,ww),v(2,H)],kw);var Rwe=require("net"),Pwe=require("url"),Rw=require("vscode");function clt(n){return n.HTTPS_PROXY||n.https_proxy||n.HTTP_PROXY||n.http_proxy||null}function Awe(n,e){let t=Rw.workspace.onDidChangeConfiguration(r=>{let o=r.affectsConfiguration("http.proxy");(r.affectsConfiguration("http.proxyStrictSSL")||r.affectsConfiguration("http.proxyAuthorization")||r.affectsConfiguration("http.proxyKerberosServicePrincipal")||o)&&kwe(n,e,o)});return kwe(n,e),t}var kwe=(n,e,t)=>{let o=Rw.workspace.getConfiguration("http").get("proxy")||clt(e);if(o){let s={},a=Rw.workspace.getConfiguration("http").get("proxyAuthorization"),c=Rw.workspace.getConfiguration("http").get("proxyStrictSSL",!0);a&&(s["Proxy-Authorization"]=a);let l=o,u=o.split(":");if(u.length>2){if(o.includes("[")){let b=o.indexOf("["),_=o.indexOf("]");l=o.substring(b+1,_)}}else l=u[0];let d=(0,Rwe.isIP)(l);d===4?o=`https://${o}`:d===6&&(o.includes("[")?o.startsWith("https://")||(o=`https://${o}`):o=`https://[${o}]`);let{hostname:p,port:f,username:m,password:h}=llt(o),g=m&&h&&`${decodeURIComponent(m)}:${decodeURIComponent(h)}`;n.proxySettings={host:p,port:parseInt(f),proxyAuth:g,headers:s};let y=Rw.workspace.getConfiguration("http").get("proxyKerberosServicePrincipal");y&&(n.proxySettings.kerberosServicePrincipal=y),n.rejectUnauthorized=c}else t&&!o&&(n.proxySettings=void 0)};function llt(n){try{return new Pwe.URL(n)}catch{throw new Error(`Invalid proxy URL: '${n}'`)}}var Ey=class extends kw{constructor(t,r,o){super(t,r,o);this._store=new _t;this._store.add(Awe(this,process.env))}dispose(){this._store.dispose()}};Ey=E([v(0,it),v(1,ww),v(2,H)],Ey);var Pw=class{constructor(e,t,r,o,s){this._context=e;this.envService=t;this.configurationService=r;this.domainService=o;this.instantiationService=s;this._context.subscriptions.push(zh.commands.registerCommand("github.copilot.debug.collectDiagnostics",async()=>{let a=await zh.workspace.openTextDocument({language:"markdown"}),c=await zh.window.showTextDocument(a);await Ru(c,`## GitHub Copilot Chat

- Extension Version: ${this.envService.getVersion()} (${this.envService.getBuildType()})
- VS Code: ${this.envService.getEditorInfo().format()}
- OS: ${this.envService.OS}${zh.env.remoteName?`
- Remote Name: ${zh.env.remoteName}`:""}

## Network

User Settings:
\`\`\`json
  "github.copilot.advanced": {
    "debug.useElectronFetcher": ${this.configurationService.getConfig(le.DebugUseElectronFetcher)},
    "debug.useNodeFetcher": ${this.configurationService.getConfig(le.DebugUseNodeFetcher)}
  }
\`\`\`
`);let l=this.domainService.capiBaseURL,u=[this.domainService.dotComAPIURL,`${l.endsWith("/")?l:`${l}/`}_ping`],d=10,p=ZE.create(this.envService),f=!!p&&this.configurationService.getConfig(le.DebugUseElectronFetcher),m=!f&&this.configurationService.getConfig(le.DebugUseNodeFetcher),h={Electron:{fetcher:p,current:f},Node:{fetcher:new JE(this.envService),current:m},Helix:{fetcher:this.instantiationService.createInstance(Ey),current:!f&&!m}};for(let g of u){let y=new URL(g).host;await Ru(c,`
Connecting to ${g}:
`);for(let b of[4,6]){await Ru(c,`- DNS ipv${b} Lookup: `);try{let _=Nwe.promisify(Dwe.lookup),x=Date.now(),I=await Promise.race([_(y,{family:b}),mc(d*1e3)]);I?await Ru(c,`${I.address} (${Date.now()-x} ms)
`):await Ru(c,`timed out after ${d} seconds
`)}catch(_){await Ru(c,`Error: ${_?.message}
`)}}for(let[b,_]of Object.entries(h))if(await Ru(c,`- ${b} Fetcher${_.current?" (configured)":""}: `),_.fetcher)try{let x=Date.now(),I=await Promise.race([_.fetcher.fetch(g,{}),mc(d*1e3)]);I?await Ru(c,`HTTP ${I.status} (${Date.now()-x} ms)
`):await Ru(c,`timed out after ${d} seconds
`)}catch(x){await Ru(c,`Error: ${x?.message}
`)}else await Ru(c,`Unavailable
`)}await Ru(c,`
## Documentation

In corporate networks: [Troubleshooting firewall settings for GitHub Copilot](https://docs.github.com/en/copilot/troubleshooting-github-copilot/troubleshooting-firewall-settings-for-github-copilot).`)}))}};Pw=E([v(0,qt),v(1,it),v(2,be),v(3,xn),v(4,H)],Pw);async function Ru(n,e){await n.edit(t=>{t.insert(n.document.lineAt(n.document.lineCount-1).range.end,e)})}var Lwe=require("http"),na=q(require("vscode"));var Owe="vscode.copilot.chat.showRequestHtmlItem",Aw=class extends ye{constructor(t,r){super();this.id="requestLogTree";this._register(na.window.registerTreeDataProvider("copilot-chat",t.createInstance(dO)));let o;this._register(na.commands.registerCommand(Owe,async s=>{o||(o=this._register(new Vne));let a=r.getRequests().find(l=>l.kind===0&&l.id===s);if(!a)return;let c=await o.addRouter(a);await na.commands.executeCommand("simpleBrowser.show",c)}))}};Aw=E([v(0,H),v(1,eu)],Aw);var Vne=class extends ye{constructor(){super();this.routers=new kp(10);let t=(0,Lwe.createServer)((r,o)=>{for(let[s,a]of this.routers)if(a.route(r,o)){this.routers.get(s);return}o.statusCode=404,o.end("Not Found")});this.port=new Promise((r,o)=>{t.listen(0,"127.0.0.1",()=>r(t.address().port)).on("error",o)}),this._register(zi(()=>t.close()))}async addRouter(t){let r=this.routers.get(t.id);if(r)return r.address;let o=await this.port,s=t.trace.serveRouter(`http://127.0.0.1:${o}`);return this.routers.set(t.id,s),s.address}},dO=class{constructor(e){this.requestLogger=e;this.onDidChangeTreeData=this.requestLogger.onDidChangeRequests.bind(this.requestLogger)}getTreeItem(e){return e}getChildren(e){return e?[]:this.requestLogger.getRequests().map(t=>{switch(t.kind){case 1:return new zne(t);case 0:return new Gne(t);default:MF(t)}})}};dO=E([v(0,eu)],dO);var Gne=class extends na.TreeItem{constructor(e){super(`<${e.name}/>`,na.TreeItemCollapsibleState.None),this.description=`${e.tokens} tokens`,this.command={command:Owe,title:"",arguments:[e.id]},this.iconPath=new na.ThemeIcon("code")}},zne=class extends na.TreeItem{constructor(e){if(super(e.entry.debugName,na.TreeItemCollapsibleState.None),e.entry.type==="MarkdownContentRequest"){this.iconPath=e.entry.icon===void 0?void 0:new na.ThemeIcon(e.entry.icon.id);let t=new Date(e.entry.startTimeMs).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});this.description=t}else{let t=`${e.entry.endTime.getTime()-e.entry.startTime.getTime()}ms`,r=e.entry.startTime.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});this.description=`[${t}] [${r}]`,this.iconPath=e.entry.type==="ChatMLSuccess"?void 0:new na.ThemeIcon("error"),this.tooltip=`${e.entry.type==="ChatMLCancelation"?"cancelled":e.entry.result.type}
	${e.entry.chatEndpoint.model}
	${t}
	${r}`}this.command={command:"vscode.open",title:"",arguments:[na.Uri.parse(Ed.buildUri({kind:"request",id:e.id}))]}}};var pS=require("fs"),zwe=require("net"),Mf=q(require("path")),Al=q(require("vscode"));var Bc=re("IExtensionsService");var Dw=re("ILaunchConfigService");var Ow=require("path");var Uwe=q(ht()),cr=q(Ve()),dS=require("path");var rB=(n,e)=>{let t=[n,...Is(n).map(r=>r.code)];for(let r of t)try{let o=gf(r);if(o&&"configurations"in o&&Array.isArray(o.configurations))return o.configurations=o.configurations.map(s=>Mwe(s,e)),o;if(o&&"type"in o&&"request"in o)return{configurations:[Mwe(o,e)]}}catch{}},dlt=["name","type","request","debugServer","preLaunchTask","postDebugTask","presentation","internalConsoleOptions","suppressMultipleSessionWarning"];function Mwe(n,e){"type"in n&&n.type==="python"&&(n.type="debugpy");let t=plt(n.type,e);if(!t)return n;for(let r of Object.keys(n))dlt.includes(r)||r in t||delete n[r];return n}function Fwe(n,e){for(let t of e.allAcrossExtensionHosts){let r=t.packageJSON?.contributes?.debuggers;if(!r)continue;let o=r.filter(a=>a.type===n&&!a.deprecated);if(!Array.isArray(o)||o.length===0)continue;let s=o.filter(a=>!!a.configurationAttributes.launch||!!a.configurationAttributes.attach).map(a=>{let c=[a.configurationAttributes.launch?.properties,a.configurationAttributes.attach?.properties].filter(l=>l!==void 0).flat();return Object.entries(c).map(l=>Object.entries(l[1]).map(u=>`${u[0]}: ${u[1].description||u[1].markdownDescription}`).flat()).flat()}).flat();if(s.length)return s}}function plt(n,e){for(let t of e.allAcrossExtensionHosts){let r=t.packageJSON?.contributes?.debuggers;if(!r)continue;let o=r.filter(s=>s.type===n&&!s.deprecated);if(!(!Array.isArray(o)||o.length===0))return o.flatMap(s=>[s.configurationAttributes.launch?.properties,s.configurationAttributes.attach?.properties]).filter(s=>s!==void 0).reduce((s,a)=>({...s,...a}),{})}}function flt(n,e){let t={configurations:[{type:"node",request:"launch",name:"Launch Program",program:"${workspaceFolder}/app/index.js",args:["--serve"]}]},r={configurations:[{type:"cppvsdbg",request:"launch",name:"Launch Program",program:"${workspaceFolder}/${input:executableName}.exe",stopAtEntry:!0}],inputs:[{type:"promptString",id:"executableName",description:"Name of your executable"}]},o=s=>e===1?JSON.stringify(s):`\`\`\`json
${JSON.stringify(s,null,2)}
\`\`\``;return n===0?`# Example
User:
My operating system is macOS.
Create a debug configuration to do the following: launch my node app

Assistant:
${o(t)}

# Example
User:
My operating system is Windows.
Create a debug configuration to do the following: debug my c++ program

Assistant:
${o(r)}
`:`# Example
User:
My operating system is macOS.
In the working directory \${workspaceFolder}/app, I ran this on the command line: node ./index --serve

Assistant:
${o(t)}

# Example
User:
My operating system is Windows.
In the working directory \${workspaceFolder}, I ran this on the command line: make test

Assistant:
${o(r)}
`}var wy=class extends cr.PromptElement{constructor(t,r,o,s,a,c,l,u,d,p,f,m){super(t);this.workspace=r;this.chatMLFetcher=o;this.endpointProvider=s;this.instantiationService=a;this.extensionsService=c;this.logService=l;this.docSearchClient=u;this.gitService=d;this.fileSystemService=p;this.ignoreService=f;this.envService=m}async prepare(t,r,o){if(o.isCancellationRequested)return{};let s=r?kx(r,new Ri(Uwe.t("Searching doc index...")),this.searchDocsSearchForContext(10,o),1e3):this.searchDocsSearchForContext(10,o);if(o.isCancellationRequested)return{};let a=await this.getDebuggerType(r,o),[c,l,u]=await Promise.all([s,this.getResources(a,r,o),this.getSchema(a,r,o)]);return{docSearchResults:c,resources:l,schema:u}}async getFiles(t,r,o){let s=this.props.input.type===1?this.props.input.absoluteCwd:void 0;if(s||(this.workspace.getWorkspaceFolders().length===1?s=this.workspace.getWorkspaceFolders()?.[0]?.fsPath:s=(await this.workspace.showWorkspaceFolderPicker())?.uri.fsPath),!s)return;let a=[],c=new Set(t.map(f=>s+dS.sep+f)),l=new Set,u=this.gitService.getExtensionApi()?.getRepository($e.from({scheme:"file",path:s}));if(u)try{l=await u.checkIgnore([...c])}catch{}let d,p=s;for(let f of t){s=p,(f==="tasks.json"||f==="launch.json")&&(s+=dS.sep+".vscode");let m=await mlt(s,async h=>{if(h===dS.sep)return;let g=$e.from({scheme:"file",path:h+dS.sep+f});try{d=await this.fileSystemService.readFile(g)}catch{return}if(d)return l.has(g.fsPath)||await this.ignoreService.isCopilotIgnored(g)?void 0:g});m&&a.push(m)}return a}async getResources(t,r,o){let s=await this.queryModelForRequestedFiles(t,r,o);if(s?.length)return this.getFiles(s,r,o)}async queryModelForRequestedFiles(t,r,o){let s=await this.endpointProvider.getChatEndpoint("gpt-4o-mini"),c=await(this.props.input.type===1?Fe.create(this.instantiationService,s,Wne,{debuggerType:t,input:this.props.input,os:this.envService.OS}):Fe.create(this.instantiationService,s,$ne,{debuggerType:t,input:this.props.input,os:this.envService.OS})).render(void 0,o),l=await this.chatMLFetcher.fetchOne("referenceFiles",c.messages,void 0,o,2,s);if(l.type!=="success")return;let u;try{u=JSON.parse(l.value)}catch{return}if(Array.isArray(u))return this.props.input.type===0&&(u.push("launch.json"),this.props.input.userQuery||u.push("README.md")),r?.report(new Ri("Requesting resources")),u}async getSchema(t,r,o){if(!t)return;let s=Fwe(t,this.extensionsService);if(s)return r?.report(new Ri("Identified launch config properties")),s}async getDebuggerType(t,r){let o=await this.endpointProvider.getChatEndpoint("gpt-4o-mini"),a=await Fe.create(this.instantiationService,o,Kne,{debuggerTypes:this.getAllDebuggerTypes(),input:this.props.input,os:this.envService.OS}).render(void 0,r),c=await this.chatMLFetcher.fetchOne("debugType",a.messages,void 0,r,2,o);if(c.type==="success")return/`(.*?)`/.exec(c.value)?.[1]||c.value}getAllDebuggerTypes(){return this.extensionsService.allAcrossExtensionHosts.filter(t=>!!t.packageJSON?.contributes?.debuggers).map(t=>{let r=[];for(let o of t.packageJSON?.contributes?.debuggers)o.type==="*"||o.deprecated||r.push(`- ${o.type}: ${o.label} (${t.id})`);return r}).flat()}async searchDocsSearchForContext(t,r){if(this.props.input.type!==0||!this.props.input.userQuery)return[];try{return await this.docSearchClient.search(this.props.input.userQuery,{repo:"microsoft/vscode-docs"},{limit:t,similarity:.75},r)}catch(o){return this.logService.public.error(o,"Failed to search docs search for query"),[]}}render(t,r){let o=this.props.input.type===1?1:0;return vscpp(vscppf,null,vscpp(cr.SystemMessage,{priority:1e3},o===1?vscpp(vscppf,null,"You are a Visual Studio Code assistant who specializes in debugging and creating launch configurations. Your task is to create a launch configuration for the user's query.",vscpp("br",null)):vscpp(vscppf,null,"You are a Visual Studio Code assistant who specializes in debugging, searching for existing launch configurations, and creating launch configurations. Your task is to find an existing launch configuration that matches the query or to create a launch configuration for the user's query if no match is found. If there's no query, still provide a response, checking for existing configurations in the launch.json file, if any.",vscpp("br",null)),vscpp(vn,null),vscpp(Ze,null)),vscpp(Nt,{historyPriority:600,passPriority:!0,history:this.props.history},vscpp(Tt,{priority:1e3},o===0&&vscpp(vscppf,null,"The user cannot see the context you are given, so you must not mention it. If you want to refer to it, you must include it in your reply.",vscpp("br",null)),"Print out only the VS Code `launch.json` file needed to debug the command, formatted as JSON.",vscpp("br",null),"Pay attention to my operating system and suggest the best tool for the platform I'm working on. For example, for debugging native code on Windows, you would not suggest the `lldb` type.",vscpp("br",null),"If there are unknowns, such as the path to the program, use the `inputs` field in the launch.json schema to prompt the user with an informative message. Input types may either be `promptString` for free text input or `pickString` with an `options` array for enumerations.",vscpp("br",null),"Do not give any other explanation. Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"If there are unknowns, such as the path to the program, use the `inputs` field in the launch.json schema to prompt the user with an informative message. Input types may either be `promptString` for free text input or `pickString` with an `options` array for enumerations. Do not include a default value for the input field.",vscpp("br",null),"Always include the following properties in the launch.json file:",vscpp("br",null),"- type: the type of debugger to use for this launch configuration. Every installed debug extension introduces a type: node for the built-in Node debugger, for example, or php and go for the PHP and Go extensions.",vscpp("br",null),"- request:  the request type of this launch configuration. Currently, launch and attach are supported.",vscpp("br",null),"- name:  the reader-friendly name to appear in the Debug launch configuration dropdown.",vscpp("br",null),"If a result is not a valid answer, but it still relates to Visual Studio Code, please still respond.",vscpp("br",null),"Please do not guess a response and instead just respond with a polite apology if you are unsure.",vscpp("br",null),"If you believe the given context given to you is incorrect or not relevant you may ignore it.",vscpp("br",null),flt(this.props.input.type,o),vscpp("br",null))),vscpp(cr.UserMessage,{priority:700},t.docSearchResults&&t.docSearchResults.length>0&&vscpp(vscppf,null,"Below is a list of information from the Visual Studio Code documentation which might be relevant to the question. ",vscpp("br",null)),t.docSearchResults&&t.docSearchResults.map(s=>{s?.title&&s.contents&&(cr.TextChunk,s?.title?.trim(),s.path,s.contents)})),vscpp(cr.UserMessage,{priority:850},t.schema&&vscpp(vscppf,null,"Below is a list of properties that the launch config might include. ",vscpp("br",null),t.schema.map(s=>vscpp(cr.TextChunk,null,s,vscpp("br",null))),")",vscpp("br",null))),vscpp(cr.UserMessage,{priority:800},t.resources&&t.resources.length>0&&vscpp(vscppf,null,"Below is a list of resources from the workspace that might be useful in building the launch config. ",vscpp("br",null)),t.resources&&t.resources.map(s=>vscpp(tf,{variableName:(0,dS.basename)(s.path),variableValue:s}))),vscpp(cr.UserMessage,{priority:700},this.props.input.type===0&&vscpp(vscppf,null,"If a program property is included in the launch config, and its path does not exist in the workspace or there are multiple files that could work, use the `inputs` field in the launch.json schema to prompt the user with an informative message.",vscpp("br",null)),vscpp(ws,{maxSize:1e3})),vscpp(cr.UserMessage,{priority:850},this.props.input.type===0&&vscpp(vscppf,null,"If the resources contain a launch.json, and ",this.props.input.userQuery," is non-empty, search in that file for an existing configuration based on the query. Pay particular attention to the name of the launch configuration and compare it to the query. If a match is found, include that configuration. Do not include the whole launch.json context. End the response with HAS_MATCH.",vscpp("br",null),"If the resources contain a launch.json and ",this.props.input.userQuery," is empty, scan the README.md, if any, to determine which configuration is recommended. Show some, not all, of the launch configurations that are available. End the response with HAS_CONFIG_NO_QUERY.",vscpp(vscppf,null),vscpp("br",null),"If no match is found, include the new configuration that was generated. End the response with GENERATED_CONFIG.",vscpp("br",null))),vscpp(Nw,{priority:900,input:this.props.input,os:this.envService.OS}))}};wy=E([v(1,Be),v(2,Et),v(3,_e),v(4,H),v(5,Bc),v(6,oe),v(7,GT),v(8,Ji),v(9,gn),v(10,Te),v(11,it)],wy);var $ne=class extends cr.PromptElement{render(e,t){return vscpp(vscppf,null,vscpp(cr.SystemMessage,{priority:10},"You are a Visual Studio Code assistant who specializes in debugging and creating launch configurations. Your job is to return an array of file names that may contain useful information to translate a user query into a VS Code debug configuration.",vscpp("br",null),`If a user's query includes "task", include "tasks.json" in the response.`,vscpp("br",null),"Do not give any other explanation and return only a JSON array of strings. Avoid wrapping the whole response in triple backticks. Do not include any other information in your response.",vscpp("br",null),vscpp(cr.TextChunk,{priority:8},"# Example 1",vscpp("br",null),"## User: ",vscpp("br",null),"Create node app launch configuration",vscpp("br",null),"## Response:",vscpp("br",null),JSON.stringify(["package.json","index.js","app.js"]),vscpp("br",null),vscpp("br",null),"# Example 2",vscpp("br",null),"## User: ",vscpp("br",null),"Launch a rust app with lldb",vscpp("br",null),"## Response:",vscpp("br",null),JSON.stringify(["Cargo.toml","src/main.rs"]),vscpp("br",null),vscpp("br",null),"# Example 3",vscpp("br",null),"## User: ",vscpp("br",null),"Launch a go app",vscpp("br",null),"## Response:",vscpp("br",null),JSON.stringify(["main.go","go.mod"]),vscpp("br",null),vscpp("br",null))),vscpp(cr.UserMessage,{priority:7},vscpp(ws,{maxSize:1e3})),vscpp(Nw,{priority:4,...this.props}))}},Wne=class extends cr.PromptElement{render(e,t){return vscpp(vscppf,null,vscpp(cr.SystemMessage,{priority:10},"You are a Visual Studio Code assistant who specializes in debugging and creating launch configurations. Your job is to return an array of file names that may contain useful information to translate a command line invocation into a VS Code debug configuration.",vscpp("br",null),"For example, when running a task `make tests`, you should ask for the `Makefile` because it contains information about how the tests are run.",vscpp("br",null),`If a user's query includes "task", include "tasks.json" in the response.`,vscpp("br",null),"Do not give any other explanation and return only a JSON array of strings. Avoid wrapping the whole response in triple backticks. Do not include any other information in your response.",vscpp("br",null),vscpp(cr.TextChunk,{priority:8},"# Example",vscpp("br",null),"## User: ",vscpp("br",null),"`npm run start`",vscpp("br",null),"## Response:",vscpp("br",null),JSON.stringify(["package.json"]),vscpp("br",null),vscpp("br",null),"# Example",vscpp("br",null),"## User: ",vscpp("br",null),"cargo run",vscpp("br",null),"## Response:",vscpp("br",null),JSON.stringify(["Cargo.toml"]),vscpp("br",null),vscpp("br",null))),vscpp(cr.UserMessage,{priority:7},vscpp(ws,{maxSize:1e3})),vscpp(Nw,{priority:4,...this.props}))}},Nw=class extends cr.PromptElement{render(){return this.props.input.type===0&&this.props.input.userQuery?vscpp(cr.UserMessage,null,"Here's a description of the app I want to debug: ",this.props.input.userQuery,this.props.debuggerType?` and the debugging type: ${this.props.debuggerType}`:""):this.props.input.type===0?this.props.debuggerType?vscpp(cr.UserMessage,null,"I want to use the $",this.props.debuggerType," debug type for my configuration."):vscpp(cr.UserMessage,null,"Find an existing launch config for my app or create one based on my project stucture and workspace"):vscpp(cr.UserMessage,null,"My operating system is ",this.props.os,".",vscpp("br",null),"In the working directory `",(this.props.input.relativeCwd||this.props.input.absoluteCwd).replaceAll("\\","/"),"`, I ran this on the command line:",vscpp("br",null),"```\n"+this.props.input.args.map(e=>e.replaceAll(`
`,"\\n")).join(` \\
  `)+"\n```")}},Kne=class extends cr.PromptElement{render(e,t){let r=this.props.input.type===1;return vscpp(vscppf,null,vscpp(cr.SystemMessage,{priority:10},"You are a Visual Studio Code assistant. Your job is to assist users in using Visual Studio Code by providing knowledge to accomplish their task. Please do not guess a response and instead just respond with a polite apology if you are unsure.",vscpp("br",null),"You are a debugging expert. Your job is to return the debug type to use for launch config for the given use case.",vscpp("br",null),"Pay attention to my operating system and suggest the best tool for the platform I'm working on. For example, for debugging native code on Windows, you would not suggest the `lldb` type.",vscpp("br",null),this.props.input.type===1&&vscpp(vscppf,null,"The command I give you is used to run code that I'm working on. Although the command itself might not directly be my program, you should suggest a tool to debug the likely language I'm working in.",vscpp("br",null)),"The user will list the debug types they have installed, but this is not a complete list of debug types available. You may suggest a type outside of that list if it's a better fit.",vscpp("br",null),vscpp("br",null),vscpp(cr.TextChunk,{priority:8},"# Example 1",vscpp("br",null),"## User: ",vscpp("br",null),r?"npx mocha":"Node.js",vscpp("br",null),"## Response:",vscpp("br",null),"`node`",vscpp("br",null),vscpp("br",null),"# Example 2",vscpp("br",null),"## User: ",vscpp("br",null),r?"python3 example.py":"Python",vscpp("br",null),"## Response:",vscpp("br",null),"`debugpy`",vscpp("br",null),vscpp("br",null),"# Example 3",vscpp("br",null),"## User: ",vscpp("br",null),r?"mvn test -Dtest=TestCircle":"Java",vscpp("br",null),"## Response:",vscpp("br",null),"`java`",vscpp("br",null),vscpp("br",null)),"Suggest the right debug type for my use case. Print ONLY the debug type. NEVER print any other explanation.",vscpp("br",null)),vscpp(Xi,{flexGrow:1,priority:7}),vscpp(Nw,{...this.props,priority:6}),vscpp(cr.UserMessage,{priority:5,flexGrow:1},vscpp(cr.TextChunk,null,"Here are the debug types I have installed:"),vscpp(cr.TextChunk,{flexGrow:1,breakOnWhitespace:!0},this.props.debuggerTypes.join(`
`))))}};async function mlt(n,e){for(;;){let t=await e(n);if(t!==void 0)return t;let r=bF(n);if(r===n)return;n=r}}var iB=re("IDebugCommandToConfigConverter"),Lw=class{constructor(e,t,r,o,s,a){this.endpointProvider=e;this.instantiationService=t;this.chatMLFetcher=r;this.workspace=o;this.telemetry=s;this.extensionsService=a}async convert(e,t,r){let o=glt(e,this.workspace),s=await this.endpointProvider.getChatEndpoint("gpt-4"),c=await Fe.create(this.instantiationService,s,wy,{input:{type:1,relativeCwd:o?.path,absoluteCwd:e,args:t},history:[]}).render(void 0,r),l=await this.chatMLFetcher.fetchOne("debugCommandToConfig",c.messages,void 0,r,5,s);if(l.type!=="success")return{ok:!1,config:void 0,text:l.reason,workspaceFolder:o?.folder};let u=rB(l.value,this.extensionsService);return this.telemetry.sendMSFTTelemetryEvent("onboardDebug.configGenerated",{configType:u?.configurations[0].type},{ok:u?1:0}),{ok:!0,config:u,text:l.value,workspaceFolder:o?.folder}}};Lw=E([v(0,_e),v(1,H),v(2,Et),v(3,Be),v(4,ge),v(5,Bc)],Lw);function glt(n,e){let t;for(let r of e.getWorkspaceFolders()){let o=(0,Ow.relative)(r.fsPath,n),s=(0,Ow.isAbsolute)(o)?1/0:A1(o,"..");(!t||s<t.distance||s===t.distance&&o.length<t.rel.length)&&(t={rel:(0,Ow.join)("${workspaceFolder}",o).replaceAll("\\","/"),distance:s,folder:r})}return t&&{folder:t.folder,path:t.rel}}var Bwe="copilot-chat.terminalToDebugging.configs",ylt=30,Mw=class{constructor(e,t,r,o,s,a,c){this.interactor=e;this.telemetry=t;this.context=r;this.commandToConfig=o;this.extensionsService=s;this.workspaceService=a;this.launchConfigService=c}async start({args:e,cwd:t,forceNew:r,printOnly:o,save:s},a){this.telemetry.sendMSFTTelemetryEvent("onboardDebug.commandExecuted",{binary:e[0]});let c=this.tryMatchExistingConfig(t,e);if(!c||r){this.interactor.isGenerating();let p=await this.commandToConfig.convert(t,e,a);if(!p.ok)return{kind:0,text:p.text};this.interactor.didGenerate(),c={args:e,cwd:t,folder:p.workspaceFolder,inputs:[],config:p.config},this.telemetry.sendMSFTTelemetryEvent("onboardDebug.configGenerated",{binary:e[0],debugType:c.config.configurations[0].type})}let l=c.config.configurations[0],u=c.folder&&this.workspaceService.getWorkspaceFolder($e.revive(c.folder));if(o||s)return this.saveConfigInLRU(c),s&&await this.save(c.config,u),{kind:1,folder:u,config:l};if(!this.hasMatchingExtension(l))return{kind:2,debugType:l.type};let d=await this.launchConfigService.resolveConfigurationInputs(c.config,new Map(c.inputs),this.interactor);return d?(c.inputs=[...d.inputs],this.saveConfigInLRU(c),{kind:1,folder:u,config:d.config}):{kind:3}}async save(e,t){await this.launchConfigService.add(t,e),t&&await this.launchConfigService.show(t,e.configurations[0].name)}hasMatchingExtension(e){for(let t of this.extensionsService.allAcrossExtensionHosts){let r=t.packageJSON?.contributes?.debuggers;if(Array.isArray(r)&&r.some(o=>o&&o.type===e.type))return!0}return!1}tryMatchExistingConfig(e,t){let r=this.readStoredConfigs(),o=r.findIndex(s=>s.cwd===e&&Qm(s.args,t));if(o!==-1)return r[o]}readStoredConfigs(){return this.context.workspaceState.get(Bwe,[])}saveConfigInLRU(e){let t=this.readStoredConfigs().slice(),r=t.indexOf(e);for(r>=1&&t.splice(r,1),t.unshift(e);t.length>ylt;)t.pop();this.context.workspaceState.update(Bwe,t)}};Mw=E([v(1,ge),v(2,qt),v(3,iB),v(4,Bc),v(5,Be),v(6,Dw)],Mw);var qwe=require("stream"),oB=class extends qwe.Transform{constructor(t){super();this.prefix=[];this.splitSuffix=Buffer.alloc(0);if(typeof t=="string"&&t.length===1)this.splitter=t.charCodeAt(0);else if(typeof t=="number")this.splitter=t;else throw new Error("not implemented here")}_transform(t,r,o){let s=0;for(;s<t.length;){let a=t.indexOf(this.splitter,s);if(a===-1)break;let c=t.subarray(s,a),l=this.prefix.length||this.splitSuffix.length?Buffer.concat([...this.prefix,c,this.splitSuffix]):c;this.push(l),this.prefix.length=0,s=a+1}s<t.length&&this.prefix.push(t.subarray(s)),o()}_flush(t){this.prefix.length&&this.push(Buffer.concat([...this.prefix,this.splitSuffix])),t()}};var sB=class{constructor(e){this.stream=e;this.methods=new Map;this.pendingRequests=new Map;this.idCounter=0,this.stream.pipe(new oB(0)).on("data",t=>this.handleData(t))}registerMethod(e,t){this.methods.set(e,t)}async callMethod(e,t){let r=this.idCounter++,o={id:r,method:e,params:t},s=new Promise((a,c)=>{this.pendingRequests.set(r,{resolve:a,reject:c})});return this.stream.write(JSON.stringify(o)+"\0"),s}async handleData(e){let t=JSON.parse(e.toString());if("method"in t){let{id:r,method:o,params:s}=t,a={id:r};try{if(this.methods.has(o)){let c=await this.methods.get(o)(s);a.result=c}else throw new Error(`Method not found: ${o}`)}catch(c){a.error={code:-1,message:String(c)}}this.stream.write(JSON.stringify(a)+"\0")}else{let{id:r,result:o,error:s}=t,a=this.pendingRequests.get(r);this.pendingRequests.delete(r),o!==void 0?a?.resolve(o):s!==void 0&&a?.reject(new Error(s.message))}}};var aB=q(require("vscode"));var jwe="__copilotTrackedSession",Hwe=(n,e,t)=>{let r=Gt(),o=new _t,s=!1,a=new Set;function c(l,u){t.callMethod("exit",{code:l,error:u}),o.dispose()}t.registerMethod("stop",()=>(a.forEach(l=>aB.debug.stopDebugging(l)),Promise.resolve())),o.add(aB.debug.registerDebugAdapterTrackerFactory("*",{createDebugAdapterTracker(l){if(l.configuration[jwe]!==r&&(!l.parentSession||!a.has(l.parentSession)))return;let u=!s;return s=!0,a.add(l),{onWillStartSession(){u&&t.callMethod("started",{})},onDidSendMessage(d){d.type==="event"&&d.event==="output"&&d.body.output&&t.callMethod("output",d.body)},onError(d){u&&c(1,String(d))},onExit(d,p){u&&c(d??0,p)},onWillStopSession(){u&&c(0)}}}})),aB.debug.startDebugging(n,{...e,[jwe]:r}).then(l=>{l||c(1)})};var Vwe="copilot-chat.terminalToDebugging.registered",Gwe="PATH",cB="copilot-debug",lB="copilotDebugCommand.js",Fw=class extends ye{constructor(t,r,o,s,a){super();this.context=t;this.logService=r;this.instantiationService=o;this.configurationService=s;this.authService=a;this._register(Al.window.registerUriHandler(this)),this._register(this.configurationService.onDidChangeConfiguration(c=>{c.affectsConfiguration(le.TerminalToDebuggerEnabled.fullyQualifiedId)&&(this.registerSerializer=this.registerSerializer.then(()=>this.registerEnvironment()))})),this._register(a.onDidAuthenticationChange(()=>{this.registerSerializer=this.registerSerializer.then(()=>this.registerEnvironment())})),this.registerSerializer=this.registerEnvironment()}handleUri(t){let r=process.platform==="win32"?"\\\\.\\pipe\\"+t.path.slice(1):t.path.substring(1),o=new ko,s=(0,zwe.connect)(r,()=>{this.logService.public.info(`Got a debug connection on ${r}`);let a=new sB(s),c=this.instantiationService.createInstance(Mw,{didGenerate:()=>a.callMethod("didGenerate"),isGenerating:()=>a.callMethod("isGenerating"),prompt:async(l,u)=>await Al.window.showInputBox({prompt:l,value:u,ignoreFocusOut:!0})});a.registerMethod("start",async l=>{let u=await c.start(l,o.token);return u.kind===1&&!(l.printOnly||l.save)&&Hwe(u.folder&&Al.workspace.getWorkspaceFolder(u.folder),{...u.config,internalConsoleOptions:"neverOpen"},a),u})});s.on("error",a=>{this.logService.public.error(`Error connecting to debug client on ${r}: ${a}`),o.dispose(!0)}),s.on("end",()=>{o.dispose(!0)})}getVersionNonce(){return this.context.extensionMode!==Al.ExtensionMode.Production?String(Date.now()):Al.extensions.getExtension(lh)?.packageJSON.version??String(Date.now())}async registerEnvironment(){if(!this.authService.copilotToken?.isInternal)return;let t=this.configurationService.getConfig(le.TerminalToDebuggerEnabled);if(!this.context.globalStorageUri)return;let o=Mf.join(this.context.globalStorageUri.fsPath,"debugCommand"),s=this.context.globalState.get(Vwe),a=this.getVersionNonce();if(!t)s&&(this.context.environmentVariableCollection.delete(Gwe),await pS.promises.rm(s.location,{recursive:!0,force:!0}));else if(!s)await this.fillStoragePath(o),this.context.environmentVariableCollection.append(Gwe,Mf.delimiter+o);else if(s.version!==a)await this.fillStoragePath(o);else return;this.context.globalState.update(Vwe,t?{location:o,version:a}:void 0)}async fillStoragePath(t){let r=Al.Uri.from({scheme:Al.env.uriScheme,authority:lh});if(await pS.promises.mkdir(t,{recursive:!0}),process.platform==="win32")await pS.promises.writeFile(Mf.join(t,`${cB}.bat`),_lt(t,r));else{let o=Mf.join(t,cB);await pS.promises.writeFile(o,blt(t,r)),await pS.promises.chmod(o,488)}await pS.promises.copyFile(Mf.join(__dirname,lB),Mf.join(t,lB))}};Fw=E([v(0,qt),v(1,oe),v(2,H),v(3,be),v(4,xt)],Fw);var blt=(n,e)=>`#!/bin/sh
ELECTRON_RUN_AS_NODE=1 NODE_OPTIONS="" "${process.execPath}" "${Mf.join(n,lB)}" "${e}" "$@"`,_lt=(n,e)=>`@echo off
SET ELECTRON_RUN_AS_NODE=1
SET NODE_OPTIONS=""
"${process.execPath}" "${Mf.join(n,lB)}" "${e}" %*
`;var pO=q(require("vscode"));var Wwe=q(require("path"));var $h=q(Ve());var xlt=/\s*(?:. )?([a-z0-9_-]+)\s*/,uB=re("ILanguageToolsProvider"),Uw=class{constructor(e,t,r){this.endpointProvider=e;this.instantiationService=t;this.chatMLFetcher=r}async getToolsForLanguages(e,t){let r=await this.endpointProvider.getChatEndpoint("gpt-4"),s=await Fe.create(this.instantiationService,r,Yne,{languages:e}).render(void 0,t),a=await this.chatMLFetcher.fetchOne("debugCommandIdentifier",s.messages,void 0,t,5,r);return a.type!=="success"?{ok:!1,commands:[]}:{ok:!0,commands:a.value.split(`
`).map(c=>xlt.exec(c)?.[1]).filter(c=>!!c)}}};Uw=E([v(0,_e),v(1,H),v(2,Et)],Uw);var Yne=class extends $h.PromptElement{render(e,t){return vscpp(vscppf,null,vscpp($h.SystemMessage,{priority:10},"You are an AI programming assistant that is specialized for usage of command-line tools developers use to build software.",vscpp("br",null),"I'm working on software in the given following languages. Please list the names of common command-line tools I might use to build and test my software.",vscpp("br",null),"Do NOT list tools that don't run my code, such as those used only for linting. For example, if I ask for JavaScript, the list should include tools like node, npx, and mocha, but not eslint.",vscpp("br",null),"Be thorough! Try to give a list of *at least* 10 such tools.",vscpp("br",null),"Print these tools out as a list, separated by commas. Do NOT print any additional explanation or context.",vscpp("br",null),vscpp($h.TextChunk,{priority:8},"# Example",vscpp("br",null),"## User: ",vscpp("br",null),"- python",vscpp("br",null),"- rust",vscpp("br",null),"## Response:",vscpp("br",null),"- python",vscpp("br",null),"- pip",vscpp("br",null),"- cargo",vscpp("br",null),"- rustc",vscpp("br",null))),vscpp($h.UserMessage,{priority:9},vscpp($h.TextChunk,{breakOnWhitespace:!0,flexGrow:1},"The languages I'm working in are:",vscpp("br",null),this.props.languages.join(`
 -`))))}};var dB=re("IDebuggableCommandIdentifier"),Bw=class extends ye{constructor(t,r,o,s,a){super();this.configurationService=t;this.context=r;this.languageToolsProvider=s;this.fileSystemService=a;this.recentlySeenLanguages=new Set;this._register(o.onDidOpenTextDocument(c=>{Tlt.includes(c.languageId)||this.recentlySeenLanguages.add(c.languageId)}))}async isDebuggable(t,r,o){if(!this.isGloballyEnabled())return!1;let s=Slt(r).toLowerCase();return this.getSpecificTreatment(s)??this.isWellKnownCommand(s)??await this.isWorkspaceLocal(t,s)??await this.isModelSuggestedCommand(s,o)??!1}isGloballyEnabled(){return this.configurationService.getConfig(le.TerminalToDebuggerEnabled)}async isWorkspaceLocal(t,r){let o=Wwe.default.isAbsolute(r)?$e.file(r):t&&$e.joinPath(t,r);if(o)try{return await this.fileSystemService.stat(o),!0}catch{}}async isModelSuggestedCommand(t,r){let o=this.loadModelKnownCommands();for(let l of o.languages)this.recentlySeenLanguages.delete(l);if(o.commands.some(l=>t.includes(l)))return!0;if(!this.recentlySeenLanguages.size)return!1;let s=[...this.recentlySeenLanguages];this.recentlySeenLanguages.clear();let{commands:a,ok:c}=await this.languageToolsProvider.getToolsForLanguages(s,r);return c&&this.storeModelKnownCommands({languages:o.languages.concat(s),commands:Fme(o.commands.concat(a))}),a.some(l=>t.includes(l))}isWellKnownCommand(t){return Ilt.some(r=>t.includes(r))||void 0}getSpecificTreatment(t){let r=this.configurationService.getConfig(le.TerminalToDebuggerPatterns);for(let o of r){if(o.startsWith("!")&&t.includes(o))return!1;if(t.includes(o))return!0}}loadModelKnownCommands(){return this.context.globalState.get($we,{languages:[],commands:[]})}storeModelKnownCommands(t){return this.context.globalState.update($we,t)}};Bw=E([v(0,be),v(1,qt),v(2,Be),v(3,uB),v(4,gn)],Bw);var $we="chat.debuggableCommands";function Slt(n){let t=/\s*([^\s]+)/.exec(n);return t?t[1]:n}var Ilt=["abap","ant","automake","autotools","ava","babel","bcp","behat","behave","biber","bibtex","bmake","boot","broccoli-sass","browserify","build_runner","bundler","busted","cabal","cargo","cargo-bench","cargo-fuzz","cargo-make","cargo-run","cargo-test","cargo-watch","carthage","carton","clang","clippy-driver","clj","clojure","cmake","cocoapods","codeception","common_test","composer","conan","coverage","cpan","cpanm","csc","ct_run","ctest","cucumber","cuda-gdb","cuda-memcheck","cypress","dart","dart-sass","dart2js","dartanalyzer","dartdevc","db2cli","ddemangle","devenv","devtools","dfix","dialyzer","dmd","doctest","dotnet","dotnet-script","dotnet-test-nunit","dotnet-test-xunit","dpp","dscanner","dsymutil","dub","dune","dustmite","dvilualatex","dvipdf","dvipdfmx","dvips","erl","erlang","erlc","esbuild","escript","eunit","eyeglass","fastlane","fennel","flutter","forever","fpc","fsharpc","fsi","g","gaiden","gcc","gcov","gdb","gdc","ghc","ghcid","gmake","gmaven","go","gpars","gradle","grape","griffon","grinder","grip","groovy","groovyc","grunt","grunt-sass","gulp","gulp-sass","hdevtools","hlint","hspec","irb","isql","jasmine","java","javac","jazzy","jdeps","jest","jlink","julia","junit","kaocha","karma","kobalt","kotest","kotlin-dsl","kotlinc","kscript","latexmk","lazbuild","lcov","ld","ldc2","ldoc","leiningen","lldb","lua","luacheck","luajit","lualatex","luarocks","luaunit","make","markdown","markdown-it","markdown-pdf","marked","matlab","maven","mbuild","mcc","md2pdf","mdbook","merlin","mex","midje","minitest","mlint","mmake","mocha","mockk","mono","moonscript","msbuild","mssql-cli","mstest","multimarkdown","mysql","ncu","ninja","nmake","node","node-sass","nose","npm","npx","nrepl","nsight","nsys","nunit-console","nvcc","ocamlbuild","ocamlc","ocamldebug","ocamlfind","ocamlopt","ocamlrun","opam","otest","otool","paket","panda","pandoc","parcel","pdflatex","perl","perl6","perlbrew","pgbench","phing","php","php-cs-fixer","phpcs","phpdbg","phpstan","phpunit","pip","pipenv","plackup","playwright","pm2","pmake","powershell","ppc386","ppcrossarm","ppcrossavr","ppcrossmips","ppcrossppc","ppcrosssparc","ppcrosswin32","ppcrossx64","protractor","prove","pry","psql","psysh","pub","pwsh","pytest","python","qmake","quickcheck","rails","rake","rakudo","rdmd","react-scripts","rebar3","relx","remake","rollup","rspec","rubocop","ruby","runghc","rustc","rustup","sass","sassc","scons","showdown","sinatra","speclj","spek","spock","spring-boot","sqlcmd","sqlite3","sqsh","stack","svelte-kit","swift","swiftc","test","test-runner","testng","testthat","tools","torch","tox","ts-node","tsc","unittest","utop","valgrind","vbc","virtualenv","vite","vstest","vue-cli-service","vue-test-utils","webdev","webpack","x","xcodebuild","xctest","xelatex","xunit","yarn","zef","zig"],Tlt=["abap","bat","bibtex","c","clojure","code-refactoring","coffeescript","cpp","csharp","css","cuda-cpp","d","dart","diff","dockercompose","dockerfile","erlang","fsharp","git-commit","git-rebase","github-issues","go","graphql","groovy","haml","handlebars","haskell","html","ini","jade","java","javascript","javascriptreact","json","jsonc","julia","kotlin","latex","less","log","lua","makefile","markdown","matlab","objective-c","objective-cpp","ocaml","pascal","perl","perl6","php","pip-requirements","plaintext","powershell","pug","python","r","razor","ruby","rust","sass","scss","shaderlab","shellscript","slim","snippets","sql","stylus","svelte","swift","tex","text","toml","typescript","typescriptreact","vb","vue","vue-html","xml","xsl","yaml","zig"];var Clt="copilot-chat.terminalToDebugging",qw=class extends ye{constructor(t){super();this.debuggableCommandIdentifier=t;this.lastExecutionFor=new Map;this._register(pO.window.registerTerminalQuickFixProvider(Clt,this)),this._register(pO.window.onDidCloseTerminal(r=>{this.lastExecutionFor.delete(r)})),this._register(pO.window.onDidEndTerminalShellExecution(r=>{this.lastExecutionFor.set(r.terminal,r)}))}async provideTerminalQuickFixes(t,r){let s=pO.window.activeTerminal?.shellIntegration?.cwd;if(await this.debuggableCommandIdentifier.isDebuggable(s,t.commandLine,r))return{terminalCommand:`${cB} ${t.commandLine}`,shouldExecute:!1}}};qw=E([v(0,dB)],qw);var is=q(require("vscode"));var jw=class extends ye{constructor(t,r,o){super();this._conversationStore=t;this._instantiationService=r;this.launchConfigService=o;let s=this._instantiationService.createInstance(sy);this._register(Yl(a=>{let c=s.debugReportFeedback.read(a);is.commands.executeCommand("setContext","github.copilot.debugReportFeedback",c)})),this._register(is.commands.registerCommand("github.copilot.debug.generateSTest",async()=>{if(!await s.canReport())return;let a=this._conversationStore.lastConversation?.getLatestTurn();if(a){let c=await Uee(a);c&&(is.env.clipboard.writeText(c.join(`
`)),is.window.showInformationMessage("STest copied to clipboard"))}})),this._register(is.commands.registerCommand("github.copilot.createLaunchJsonFileWithContents",async a=>{let c=is.workspace.workspaceFolders;if(!c){is.window.showErrorMessage("No workspace folder is open.");return}await o.add(c[0].uri,a),await o.show(c[0].uri,a.configurations[0].name)})),this._register(is.commands.registerCommand("github.copilot.debug.generateConfiguration",async()=>{await is.commands.executeCommand("workbench.action.chat.open","@vscode /startDebugging",{location:is.ChatLocation.Panel})})),this._register(is.commands.registerCommand("github.copilot.startDebugging",async(a,c)=>{let l=await this.launchConfigService.resolveConfigurationInputs(a);if(l?.config){await this.launchConfigService.launch(l?.config),c.progress(is.l10n.t("Started debugging {0}",l.config.name));return}else{c.markdown(is.l10n.t("Could not start debugging. Please try again."));return}}))}};jw=E([v(0,Md),v(1,H),v(2,Dw)],jw);var Jne=q(require("vscode"));function Xne(n){return/^[a-z][a-z0-9]*$/.test(n)?"lowercase":/^[a-z][a-zA-Z0-9]*$/.test(n)?"camelCase":/^[a-z]+(_[a-z0-9]+)*$/.test(n)?"snake_case":/^[a-z]+(-[a-z0-9]+)*$/.test(n)?"kebab-case":/^[A-Z][a-z0-9]*$/.test(n)?"Capitalized":/^[A-Z0-9]+(_[A-Z0-9]+)+$/.test(n)?"SCREAMING_SNAKE_CASE":/^[A-Z]+$/.test(n)?"Uppercase":/^[A-Z][a-zA-Z0-9]*$/.test(n)?"PascalCase":/^[A-Z][a-z0-9]*(_[a-z0-9]+)*$/.test(n)?"Capital_snake_case":"Unknown"}function Qne(n){return n.map((e,t)=>t===0?e.toLowerCase():e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()).join("")}function Elt(n){return n.map(e=>e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()).join("")}function pB(n){return n.map(e=>e.toLowerCase()).join("_")}function wlt(n){return n.map(e=>e.toLowerCase()).join("-")}function Kwe(n,e){let t=Xne(n);if(t===e)return n;{let r=klt(n,t);switch(e){case"camelCase":return Qne(r);case"PascalCase":return Elt(r);case"snake_case":return pB(r);case"SCREAMING_SNAKE_CASE":return pB(r).toUpperCase();case"Capital_snake_case":return pB(r).charAt(0).toUpperCase()+pB(r).substring(1);case"kebab-case":return wlt(r);case"Capitalized":return Qne(r).charAt(0).toUpperCase()+Qne(r).substring(1);case"Uppercase":return n.toUpperCase();case"lowercase":return n.toLowerCase();case"Unknown":return n}}}function klt(n,e){switch(e){case"camelCase":case"PascalCase":return n.split(/(?=[A-Z])/);case"snake_case":case"SCREAMING_SNAKE_CASE":case"Capital_snake_case":case"kebab-case":return n.split(/[-_]/).map(t=>t.toLowerCase());case"Capitalized":case"Uppercase":case"lowercase":case"Unknown":return[n]}}var Vw=q(Ve());var Ywe=q(Ve());var ky=class extends Ywe.PromptElement{constructor(t,r,o,s,a,c,l,u){super(t);this._languageFeaturesService=r;this._workspaceService=o;this._vscodeExtensionCtxService=s;this._ignoreService=a;this._logService=c;this._parserService=l;this._telemetryService=u}static{this.DEFAULT_TIMEOUT_MS=200}async prepare(){if(await this._ignoreService.isCopilotIgnored(this.props.document.uri))return{k:"ignored"};let t=this._vscodeExtensionCtxService.extensionMode===vl.Test?0:this.props.timeoutMs===void 0?ky.DEFAULT_TIMEOUT_MS:this.props.timeoutMs,r=await this.findDefinition(t);return this._logService.internal.debug(`Found ${r.length} implementation(s)/definition(s)`),r.length>0&&this._logService.internal.debug("Implementation(s)/definition(s) found:"+JSON.stringify(r,null,"	")),{k:"found",definitions:r}}render(t,r){if(t.k==="ignored")return vscpp("ignoredFiles",{value:[this.props.document.uri]});let{document:o,position:s}=this.props,{definitions:a}=t;if(a.length===0){let c=o.lineAt(s.line);a.push({languageId:o.languageId,uri:o.uri,code:c.text,excerptRange:c.range})}return vscpp(vscppf,null,"Relevant definition",a.length>1?"s":"",": ",vscpp("br",null),vscpp("br",null),a.map(c=>{let d=`${`${Rr(c.languageId).lineComment.start} FILEPATH: ${c.uri.path}`}
${c.code}`;return vscpp(tt,{uri:c.uri,languageId:c.languageId,code:d})}))}async findDefinition(t){let{document:r,position:o}=this.props,s=async l=>{try{let u=await this._languageFeaturesService.getImplementations(r.uri,l);if(this._logService.internal.debug(`Found ${u.length} implementations`+JSON.stringify(u,null,"	")),u.length>0)return u}catch{}try{let u=await this._languageFeaturesService.getDefinitions(r.uri,l);if(this._logService.internal.debug(`Found ${u.length} definitions`+JSON.stringify(u,null,"	")),u.length>0)return u}catch{}return this._logService.internal.debug("No definitions or implementations found"),[]},a=await Tc(this._logService,this._telemetryService,r,t*3,()=>s(o),[]),c=zn(await Promise.all(a.map(async l=>{let u=ph(l)?l.targetUri:r.uri;return await this._ignoreService.isCopilotIgnored(u)?void 0:l})));return Promise.all(c.map(async l=>{let{uri:u,range:d}=ph(l)?{uri:l.targetUri,range:l.targetRange}:l,p=await this._workspaceService.openTextDocumentAndSnapshot(u),f=_l(p.languageId),m,h;if(f===void 0){let g=p.lineAt(d.start.line);m=g.text,h=g.range}else h=(await Jv(this._parserService,this._telemetryService,{document:p,language:Rr(r.languageId),wholeRange:d,selection:new Hp(d.start,d.end),fileIndentInfo:void 0})).range,m=p.getText(h);return{languageId:p.languageId,uri:p.uri,code:m,excerptRange:h}}))}};ky=E([v(1,Ts),v(2,Be),v(3,qt),v(4,Te),v(5,oe),v(6,ft),v(7,ge)],ky);var Hw=class extends Vw.PromptElement{constructor(t,r,o){super(t);this.instaService=r;this.endpointProvider=o;let{document:s,range:a}=this.props;this._defAtPos=r.createInstance(new fe(ky,[{document:s,position:a.start}]))}async prepare(t,r,o){let{document:s,range:a}=this.props,c=await this._defAtPos.prepare();if(!(c.k==="found"&&c.definitions.some(d=>d.excerptRange.contains(this.props.range)))){let d=await this.endpointProvider.getChatEndpoint("gpt-4o-mini"),p={document:s,fileIndentInfo:void 0,language:Rr(s.languageId),wholeRange:a,selection:new Hp(a.start,a.end)};this._defAroundCursor=this.instaService.createInstance(Xv,{documentContext:p,endpointInfo:d})}return{defAtPositionState:c,defAroundCursorState:this._defAroundCursor?await this._defAroundCursor.prepare(t):void 0}}render(t,r){let{document:o,range:s}=this.props,a=o.getText(s),c=Rlt(a),l=c?` keeping prefix '${c}'`:"",u=this._defAtPos.render(t.defAtPositionState,r),d=t.defAroundCursorState!==void 0&&this._defAroundCursor?.render(t.defAroundCursorState,r);return vscpp(vscppf,null,vscpp(Vw.SystemMessage,null,"You are a distinguished software engineer.",vscpp("br",null),vscpp(Ze,null),'You must reply with a JSON array of strings of at least four new names, e.g., `["first", "second", "third", "fourth"]`.',vscpp("br",null),"You must respect existing naming conventions",l,"."),d,vscpp(Vw.UserMessage,null,u!==void 0&&vscpp(vscppf,null,u,vscpp("br",null)),"Think of the purpose of `",a,"` in the given code. Think of several names that reflect what `",a,"` is and what it does",l,". Follow existing naming conventions. Reply with a JSON array of strings of at least four new names for `",a,"`."))}};Hw=E([v(1,H),v(2,_e)],Hw);function Rlt(n){return n.match(/^([\\.\\$\\_]+)/)?.[0]}var Jd=class{constructor(e,t,r,o,s,a,c){this._instaService=e;this._chatMLFetcher=t;this._ignoreService=r;this._telemetryService=o;this._configurationService=s;this._endpointProvider=a;this._simulationTestContext=c;this.supportsAutomaticTriggerKind=Promise.resolve(this.isEnabled(sD.Automatic))}isEnabled(e){return e===sD.Invoke?!0:this._configurationService.getConfig(le.AutomaticRenameSuggestions)}async provideNewSymbolNames(e,t,r,o){let s=Bt.create(e),a="",c=new Qo,l=s.getText(t);if(!this.isEnabled(r))throw new Error("CopilotFeatureUnavailableOrDisabled");if(await this._ignoreService.isCopilotIgnored(s.uri))throw new Error("CopilotIgnoredDocument");let u=s.languageId,d,p;if(o.isCancellationRequested)a="afterEnablementCheck";else{let f=await this._endpointProvider.getChatEndpoint("gpt-4o-mini");if(d=this.delayBeforeFetchMs,o.isCancellationRequested)a="afterRunParametersFetch";else{let m=new Qo(!1);m.reset();let h=await this._computePrompt(s,t,f,o),g=m.elapsed();if(o.isCancellationRequested)a="afterPromptCompute";else{p=c.elapsed();let y;if(r===sD.Automatic&&(y=d?Math.max(0,d-p):void 0,y!==void 0&&y>0&&await new Promise(b=>setTimeout(b,y))),o.isCancellationRequested)a="afterDelay";else{m.reset();let b=await this._chatMLFetcher.fetchOne("renameSuggestionsProvider",h.messages,void 0,o,5,f,void 0,{top_p:void 0,temperature:void 0}),_=m.elapsed();switch(o.isCancellationRequested&&(a="afterFetchStarted"),b.type){case"success":{let x=b.value,{replyFormat:I,symbolNames:S,redundantCharCount:w}=Jd.parseResponse(x);return I==="unknown"&&this._sendInternalTelemetry({languageId:u,reply:x}),this._sendPublicTelemetry({triggerKind:r,languageId:u,cancellationReason:a,fetchResultType:b.type,promptConstructionTime:g,promptTokenCount:h.tokenCount,expectedDelayBeforeFetch:d,actualDelayBeforeFetch:y,timeElapsedBeforeDelay:p,successResponseCharCount:x.length,responseUnusedCharCount:w,fetchTime:_,replyFormat:I,symbolNamesCount:S.length}),Jd.preprocessSymbolNames({currentSymbolName:l,newSymbolNames:S,languageId:u}).map(k=>new Mve(k,[Fve.AIGenerated]))}default:return this._sendPublicTelemetry({triggerKind:r,languageId:u,cancellationReason:a,fetchResultType:b.type,promptConstructionTime:g,promptTokenCount:h.tokenCount,expectedDelayBeforeFetch:d,actualDelayBeforeFetch:y,timeElapsedBeforeDelay:p,fetchTime:_}),null}}}}}return this._sendPublicTelemetry({triggerKind:r,languageId:u,cancellationReason:a,expectedDelayBeforeFetch:d,timeElapsedBeforeDelay:p}),null}get delayBeforeFetchMs(){return this._simulationTestContext.isInSimulationTests?0:250}_computePrompt(e,t,r,o){return Fe.create(this._instaService,r,Hw,{document:e,range:t}).render(void 0,o)}static preprocessSymbolNames({currentSymbolName:e,newSymbolNames:t,languageId:r}){let o=Xne(e),s;switch(o){case"lowercase":r==="python"?s="snake_case":s="camelCase";break;case"Uppercase":case"camelCase":case"PascalCase":case"snake_case":case"SCREAMING_SNAKE_CASE":case"Capital_snake_case":case"kebab-case":case"Capitalized":case"Unknown":s=o;break;default:return o}return s==="Unknown"?t:t.map(a=>Kwe(a,s))}static parseResponse(e){let t=Jd._parseReplyAsJSONStringArray(e);if(t!==void 0)return t;let r=Jd._parseReplyAsList(e);return r!==void 0?r:{replyFormat:"unknown",symbolNames:[],redundantCharCount:e.length}}static _parseReplyAsJSONStringArray(e){let t=/\[.*?\]/gs,r=[...e.matchAll(t)];for(let o=0;o<r.length;o++){let s=r[o];try{let a=JSON.parse(s[0]);if(Array.isArray(a)){let c=a.filter(l=>typeof l=="string");if(c.length>0){let l=o===0?"jsonStringArray":"multiJsonStringArray",u=e.length-s[0].length;return{replyFormat:l,redundantCharCount:u,symbolNames:c.map(d=>d.trim())}}}}catch{}}}static _parseReplyAsList(e){let t=/(?:\d+[\.|\)]|[\*\-])\s*(.*)/g,r=e.matchAll(t),o=[];for(let a of r){let c=a[1].trim(),l=["'",'"',"`"];l.includes(c[0])&&(c=c.slice(1)),l.includes(c[c.length-1])&&(c=c.slice(0,-1)),c&&o.push(c)}return o.length===0?void 0:{replyFormat:"list",redundantCharCount:e.length-o.reduce((a,c)=>a+c.length,0),symbolNames:o}}_sendPublicTelemetry({triggerKind:e,languageId:t,cancellationReason:r,fetchResultType:o,timeElapsedBeforeDelay:s,promptConstructionTime:a,promptTokenCount:c,expectedDelayBeforeFetch:l,actualDelayBeforeFetch:u,successResponseCharCount:d,responseUnusedCharCount:p,fetchTime:f,replyFormat:m,symbolNamesCount:h}){this._telemetryService.sendMSFTTelemetryEvent("provideRenameSuggestions",{languageId:t,cancellationReason:r,fetchResultType:o,replyFormat:m,triggerKind:e===sD.Automatic?"automatic":"manual"},{promptConstructionTime:a,promptTokenCount:c,expectedDelayBeforeFetch:l,actualDelayBeforeFetch:u,timeElapsedBeforeFetch:s,fetchTime:f,successResponseCharCount:d,responseUnusedCharCount:p,symbolNamesCount:h})}_sendInternalTelemetry({languageId:e,reply:t}){this._telemetryService.sendMSFTTelemetryEvent("provideRenameSuggestionsIncorrectFormatResponse",{languageId:e,reply:t})}static _determinePrefix(e){return e.match(/^([\\.\\$\\_]+)/)?.[0]}};Jd=E([v(0,H),v(1,Et),v(2,Te),v(3,ge),v(4,be),v(5,_e),v(6,u0)],Jd);var Gw=class extends ye{constructor(t){super();this.instantiationService=t;"registerNewSymbolNamesProvider"in Jne.languages&&this._register(Jne.languages.registerNewSymbolNamesProvider({language:"*"},this.instantiationService.createInstance(Jd)))}};Gw=E([v(0,H)],Gw);var Qwe=q(require("vscode"));var Plt="github.copilot.survey.signalUsage",zw=class extends ye{constructor(t){super();this._surveyService=t;this._register(Qwe.commands.registerCommand(Plt,(r,o)=>{this._surveyService.signalUsage(r,o)}))}};zw=E([v(0,pf)],zw);var Wh=q(require("vscode"));var $w=re("IWorkspaceMutationManager");var fB="copilot-setup-tests";var Ww=class extends ye{constructor(e){super(),this._register(Wh.workspace.registerTextDocumentContentProvider(fB,{provideTextDocumentContent(t,r){return e.get(t.authority).get(t.path,r)}})),this._register(Wh.commands.registerCommand("github.copilot.tests.applyMutations",t=>{Wh.window.withProgress({location:Wh.ProgressLocation.Notification,cancellable:!0},async(r,o)=>{try{return await e.get(t).apply(r,o)}catch(s){Wh.window.showErrorMessage(`Failed to apply edits: ${s.message}`)}})}))}};Ww=E([v(0,$w)],Ww);var ere=q(require("vscode"));var Zne=q(ht());var mB=class{constructor(e,t){this.variable=e;this.endpointProvider=t}async invoke(e,t){let r=e.parameters,o=await this.endpointProvider.getChatEndpoint("gpt-4"),s=await this.variable.resolve({endpoint:o,message:r.query},t,{report:()=>{}}),a;return s?a=s.userMessages.join(`

`):a="",new D5([new cD(a)])}};mB=E([v(1,_e)],mB);var Kw=class{constructor(e){this.instantiationService=e}async invoke(e,t){let r=e.parameters;if(!r.query)throw new Error("Invalid parameters");return new D5([new N5(await qve(this.instantiationService,ZC,{query:r.query},e.tokenizationOptions,t))])}prepareInvocation(e,t){return{invocationMessage:Zne.t("Searching VS Code API for {0}",`"${e.parameters.query}"`)}}};Kw=E([v(0,H)],Kw);var Yw=class{constructor(e,t){this.endpointProvider=e;this.instantiationService=t}async invoke(e,t){let r=e.parameters,o=await this.endpointProvider.getChatEndpoint("gpt-4"),{messages:s}=await Qi(this.instantiationService,o,tC,{promptContext:{chatVariables:new Es([]),query:r.query,history:[]},include:{workspaceChunks:!0}},void 0,t);return new D5([new cD(s.map(a=>a.content).join(`

`))])}prepareInvocation(e,t){return{invocationMessage:Zne.t("Searching Codebase for {0}",`"${e.parameters.query}"`)}}};Yw=E([v(0,_e),v(1,H)],Yw);var Qw=class extends ye{constructor(e){super(),this._register(ere.lm.registerTool("copilot_codebase",e.createInstance(Yw))),this._register(ere.lm.registerTool("copilot_vscodeAPI",e.createInstance(Kw)))}};Qw=E([v(0,H)],Qw);var tre={};Dr(tre,{WorkspaceIndexingStatus:()=>Xw,create:()=>Alt});var Xwe=q(ht()),Kh=q(require("vscode"));var Xw=class extends ye{constructor(e){super(),this._register(e.onDidChangeLocalIndexingState(t=>{if(t==="started")this._currentProgress?.promise.cancel(),Kh.window.withProgress({location:Kh.ProgressLocation.Window,title:Kh.l10n.t("$(copilot) Indexing workspace"),cancellable:!1},r=>{let o=new ys;return this._currentProgress={progress:r,lastReportedProgress:0,promise:o},o.p});else if(t==="completed")this._currentProgress?.promise.complete(),this._currentProgress=void 0;else if(this._currentProgress){let r;t.progress&&(r=Math.max(0,t.progress-this._currentProgress.lastReportedProgress),this._currentProgress.lastReportedProgress=t.progress),this._currentProgress?.progress.report({message:t.progressMessage,increment:r})}}))}};Xw=E([v(0,yh)],Xw);function Alt(n){let e=n.get(H),t=n.get(yh),r=new _t;return r.add(e.createInstance(Xw)),r.add(Kh.commands.registerCommand("github.copilot.buildLocalWorkspaceIndex",async()=>{let o=await t.triggerLocalIndexing();o&&Kh.window.showWarningMessage((0,Xwe.t)(`Could not build local workspace index. 

`+o.errorDetails))})),r}var IB=require("fs/promises"),ek=require("path"),to=q(require("vscode")),ike=require("vscode");var fS=class{constructor(){this._runningTask=void 0;this._pendingTasks=[]}schedule(e){let t=new ys;return this._pendingTasks.push({task:e,deferred:t}),this._runningTask===void 0&&this._processQueue(),t.p}async _processQueue(){if(this._pendingTasks.length===0)return;let e=this._pendingTasks.shift();if(e){if(this._runningTask)throw new Xt;this._runningTask=e.task;try{let t=await e.task();e.deferred.complete(t)}catch(t){e.deferred.error(t)}finally{this._runningTask=void 0,this._processQueue()}}}clearPending(){let e=this._pendingTasks;this._pendingTasks=[];for(let t of e)t.deferred.error(new dt)}},hB=class{constructor(e,t){this._fn=e;this._waitingTimeMs=t;this._queue=[];this._timeout=null}request(e){this._timeout===null&&(this._timeout=setTimeout(()=>this._flush(),this._waitingTimeMs));let t=new ys;return this._queue.push({arg:e,promise:t}),t.p}async _flush(){let e=this._queue;this._queue=[],this._timeout=null;let t=e.map(o=>o.arg),r;try{r=await this._fn(t)}catch(o){for(let s of e)s.promise.error(o);return}for(let[o,s]of r.entries())e[o].promise.complete(s)}};var Jwe=q(require("crypto")),vB=require("fs/promises");async function nre(n){try{return await(0,vB.readFile)(n,"utf8")}catch(e){if(e.code==="ENOENT")return;throw e}}function rre(n){try{return JSON.parse(n)}catch(e){if(e instanceof SyntaxError){console.error(e);return}throw e}}var gB=class n{constructor(e,t){this.filePath=e;this._writeQueue=new fS;this._value=t}static async readOrCreate(e,t){let r=t,o=await nre(e);if(o!==void 0){let s=rre(o);s!==void 0&&(r=s)}return new n(e,r)}get value(){return this._value}async setValue(e){this._value=e,this._writeQueue.clearPending(),this._writeQueue.schedule(()=>this._write())}_write(){return(0,vB.writeFile)(this.filePath,JSON.stringify(this._value,null,4),{encoding:"utf8"})}};function Zwe(n){let e=Jwe.createHash("sha256");return e.update(n,"utf8"),e.digest("base64").substring(0,24)}var Jw=q(require("vscode"));var yB=class{constructor(){this._visibleTextEditors=Ki(this,e=>Jw.window.onDidChangeVisibleTextEditors(e),()=>Jw.window.visibleTextEditors);this.visibleTextEditors=Zhe(this,this._visibleTextEditors,e=>new ire(e));this._visibleTextEditorsMap=Ql(this,e=>new Map(this.visibleTextEditors.read(e).map(t=>[t.editor,t])));this._activeTextEditor=Ki(this,e=>Jw.window.onDidChangeActiveTextEditor(e),()=>Jw.window.activeTextEditor);this.activeTextEditor=Ql(this,e=>{let t=this._activeTextEditor.read(e);if(t)return this._visibleTextEditorsMap.read(e).get(t)})}},ire=class{constructor(e){this.editor=e;this.selection=Ki(this,e=>Jw.window.onDidChangeTextEditorSelection(e),()=>this.editor.selections)}};function eke(n,e){let t=e.offsetAt(n.start),r=e.offsetAt(n.end);return new gt(t,r)}var SB=require("fs/promises"),fO=q(require("path"));function tke(n){return[n.start,n.endExclusive]}function nke(n){return n.edits.map(e=>[e.range.start,e.range.endExclusive,e.newText])}var Ry=require("fs"),Ff=require("fs/promises");var bB=class n{constructor(e,t,r=!1){this.filePath=e;this._exists=r;this._dirty=!1;this._value=t}static async loadOrCreate(e,t){let r=t,o=await nre(e);if(o!==void 0){let s=rre(o);s!==void 0&&(r=s)}return new n(e,r,o!==void 0)}get value(){return this._value}setValue(e){this._value=e,this._dirty=!0}async flushAsync(){if(!this._dirty)return;let e=JSON.stringify(this._value,null,4),t=this.filePath+".new";await(0,Ff.writeFile)(t,e,{encoding:"utf8"}),this._exists&&await(0,Ff.unlink)(this.filePath),await(0,Ff.rename)(t,this.filePath),this._exists=!0,this._dirty=!1}flushSync(){if(!this._dirty)return;let e=JSON.stringify(this._value,null,4),t=this.filePath+".new";(0,Ry.writeFileSync)(t,e,{encoding:"utf8"}),this._exists&&(0,Ry.unlinkSync)(this.filePath),(0,Ry.renameSync)(t,this.filePath),this._exists=!0,this._dirty=!1}},_B=class{constructor(e){this.filePath=e;this._lock=!1;this._newEntries=[]}appendEntry(e){this._newEntries.push(JSON.stringify(e))}_getTextAndClear(){let e=this._newEntries.map(t=>`
`+t).join("");return this._newEntries.length=0,e}async flushAsync(){if(this._newEntries.length!==0){if(this._lock)throw new Xt("Locked!");this._lock=!0;try{let e=this._getTextAndClear();if(e==="")return;await(0,Ff.appendFile)(this.filePath,e,{encoding:"utf8"})}finally{this._lock=!1}}}flushSync(){if(this._newEntries.length===0)return;if(this._lock)throw new Xt("Locked!");let e=this._getTextAndClear();e!==""&&(0,Ry.appendFileSync)(this.filePath,e,{encoding:"utf8"})}};async function rke(n){try{return(await(0,Ff.stat)(n)).size}catch{return}}var xB=class extends ye{constructor(t,r,o){super();this.repoRootUri=t;this.recordingDirPath=r;this._context=o;this._queue=new fS;this.logFilePath=fO.default.join(this.recordingDirPath,"current.workspaceRecording.jsonl");this._impl=ore.create(this.repoRootUri,this.recordingDirPath,this.logFilePath,this._context)}handleOnDidOpenTextDocument(t,r){this._schedule(()=>this._impl.then(o=>o.handleOnDidOpenTextDocument(this._getTime(),t,r)))}handleOnDidCloseTextDocument(t){this._schedule(()=>this._impl.then(r=>r.handleOnDidCloseTextDocument(this._getTime(),t)))}handleOnDidShowTextDocument(t){this._schedule(()=>this._impl.then(r=>r.handleOnDidShowTextDocument(this._getTime(),t)))}handleOnDidHideTextDocument(t){this._schedule(()=>this._impl.then(r=>r.handleOnDidHideTextDocument(this._getTime(),t)))}handleOnDidChangeTextDocument(t,r){r.isEmpty()||this._schedule(()=>this._impl.then(o=>o.handleOnDidChangeTextDocument(this._getTime(),t,r)))}handleOnDidFocusedDocumentChange(t){this._schedule(()=>this._impl.then(r=>r.handleOnDidFocusedDocumentChange(this._getTime(),t)))}handleOnDidSelectionChange(t,r){this._schedule(()=>this._impl.then(o=>o.handleOnDidSelectionChange(this._getTime(),t,r)))}addBookmark(){this._schedule(()=>this._impl.then(t=>t.addBookmark(this._getTime())))}_schedule(t){this._queue.schedule(t)}_getTime(){return Date.now()}},ore=class n extends ye{constructor(t,r,o,s,a){super();this.repoRootUri=t;this._state=r;this._log=o;this._context=s;this._logFileExists=a;this._documentInitialTexts=new Map;this._writeQueue=new fS;this._register(zi(()=>{this._forceFlush()})),this._logFileExists||this._appendEntry({documentType:"workspaceRecording@1.0",kind:"header",repoRootUri:this.repoRootUri,time:Date.now(),uuid:Gt()}),this._appendEntry({kind:"applicationStart",time:Date.now()})}static async create(t,r,o,s){await(0,SB.mkdir)(r,{recursive:!0});let a=await bB.loadOrCreate(fO.default.join(r,"state.json"),{version:2,logCount:0,documents:{}}),c=!1;if((!("version"in a.value)||a.value.version!==2)&&(c=!0,a.setValue({version:2,logCount:0,documents:{}}),await a.flushAsync()),!("version"in a.value))throw new Xt;let l=await rke(o),u=l!==void 0,p=20*(1024*1024);if(l!==void 0&&l>p&&(c=!0),u&&c){let g=function(y){return y.toISOString().replace(/:/g,"-")};var m=g;let h=new Date;await(0,SB.rename)(o,fO.default.join(r,`${a.value.logCount}.${g(h)}.workspaceRecording.jsonl`)),a.setValue({version:2,logCount:a.value.logCount+1,documents:{}}),await a.flushAsync(),u=!1}let f=new _B(o);return new n(t,a,f,s,u)}async handleOnDidOpenTextDocument(t,r,o){this._documentOpened(r,o,t)}async handleOnDidCloseTextDocument(t,r){this._documentClosed(r)}async handleOnDidShowTextDocument(t,r){let o=await this._getId(r);o!==void 0&&this._appendEntry({kind:"opened",id:o,time:t})}async handleOnDidHideTextDocument(t,r){let o=await this._getId(r);o!==void 0&&this._appendEntry({kind:"closed",id:o,time:t})}async handleOnDidChangeTextDocument(t,r,o){let s=await this._getId(r);s!==void 0&&this._appendEntry({kind:"changed",id:s,time:t,edit:nke(o)})}async handleOnDidFocusedDocumentChange(t,r){let o=await this._getId(r);o!==void 0&&this._appendEntry({kind:"focused",id:o,time:t})}async handleOnDidSelectionChange(t,r,o){let s=await this._getId(r);s!==void 0&&this._appendEntry({kind:"selectionChanged",id:s,time:t,selection:o.map(a=>tke(a))})}async addBookmark(t){this._appendEntry({kind:"bookmark",time:t})}_getRelativePath(t){return fO.default.relative(this.repoRootUri,t)}_documentOpened(t,r,o){let s=this._getRelativePath(t);if(this._documentInitialTexts.has(s))throw new Xt("should not happen");this._documentInitialTexts.set(s,{value:r,time:o})}_documentClosed(t){this._documentInitialTexts.delete(this._getRelativePath(t))}async _getId(t){if(await this._context.isIgnoredDocument(t))return;let r=this._getRelativePath(t),o=this._state,s=o.value,a=!1,c=s.documents[r];c||(c={id:Object.entries(s.documents).length,lastHash:""},this._appendEntry({kind:"documentEncountered",time:Date.now(),id:c.id,relativePath:r}),a=!0);let l=this._documentInitialTexts.get(r);if(l!==void 0){let u=Zwe(l.value);c.lastHash!==u?(c.lastHash=u,a=!0,this._appendEntry({kind:"setContent",time:l.time,id:c.id,content:l.value}),this._appendEntry({kind:"storeContent",time:l.time,id:c.id,contentId:u})):this._appendEntry({kind:"restoreContent",time:l.time,id:c.id,contentId:u}),this._documentInitialTexts.delete(r)}if(a&&(o.setValue({...o.value,documents:{...s.documents,[r]:c}}),this._scheduleFlush()),c.lastHash==="")throw new Xt("should not happen");return c.id}_scheduleFlush(){this._writeQueue.clearPending(),this._writeQueue.schedule(async()=>{await mc(10*1e3),await this._state.flushAsync(),await this._log.flushAsync()})}_forceFlush(){this._writeQueue.clearPending(),this._state.flushSync(),this._log.flushSync()}_appendEntry(t){this._log.appendEntry(t),this._scheduleFlush()}};var Zw=class extends ye{constructor(t,r,o,s){super();this._vscodeExtensionContext=t;this._authenticationService=r;this._configurationService=o;this._gitExtensionService=s;this._copilotToken=Ki(this,this._authenticationService.onDidAuthenticationChange,()=>this._authenticationService.copilotToken);this._isInternal=Ql(this,t=>!!this._copilotToken.read(t)?.isInternal);this._isOrWasInternal=ege(this,t=>this._isInternal.read(t)?!0:void 0);this._gitApi=Ki(this,t=>this._gitExtensionService.onDidChange(t),()=>this._gitExtensionService.getExtensionApi());this._recordingEnabled=Ki(this,this._configurationService.onDidChangeConfiguration,()=>this._configurationService.getConfig(le.WorkspaceRecordingEnabled));this._enabled=Ql(this,t=>!!this._isOrWasInternal.read(t)&&this._recordingEnabled.read(t));this._register(G_((a,c)=>{this._enabled.read(a)&&this.init(c)}))}async init(t){let r=await MU(this._gitApi),o=Ki(this,l=>r.onDidOpenRepository(l),()=>r.repositories);await MU(o,l=>l.length>0,void 0,Wme(t));let s=(0,ek.join)(this._vscodeExtensionContext.globalStorageUri.fsPath,"workspaceRecordings");await(0,IB.mkdir)(s,{recursive:!0});let a=await gB.readOrCreate((0,ek.join)(s,"workspaces.json"),{workspaceIdxByRoot:{}});if(t.isDisposed)return;let c=new sre(r,s,a);t.add(c)}};Zw=E([v(0,qt),v(1,xt),v(2,be),v(3,Ji)],Zw);var sre=class extends ye{constructor(t,r,o){super();this.gitApi=t;this.recordingDirPath=r;this.workspacesIndexFile=o;this._logProvider=new WE("copilotLogProvider");this.recorders=new Map;this.recordersChangedSignal=hK(this);this.hasWorkspace=Ql(this,t=>(this.recordersChangedSignal.read(t),[...this.recorders].length>0));let s="vscodeCopilot.openRecordingFolder";this._register(to.commands.registerCommand(s,()=>{to.env.openExternal(to.Uri.file(r))}));let a="vscodeCopilot.addRecordingBookmark";this._register(to.commands.registerCommand(a,()=>{for(let d of this.recorders.values())d.addBookmark();to.window.showInformationMessage("Bookmark added to recording.")}));let c=this._logProvider.createDocument("","current.recording.w.json"),l="vscodeCopilot.viewRecording";this._register(to.commands.registerCommand(l,async()=>{let d=this.recorders.values().next().value;if(!d){to.window.showInformationMessage("No recording found.");return}let p=await(0,IB.readFile)(d.logFilePath,"utf8"),m={log:are.parse(p)};c.setContent(JSON.stringify(m)),await to.commands.executeCommand("vscode.open",c.uri)})),this._register(G_((d,p)=>{if(!this.hasWorkspace.read(d))return;let f=p.add(to.window.createStatusBarItem(to.StatusBarAlignment.Right,1e4));f.text="$(record) Rec";let m=[];m.push("## $(record) Recording Workspace Changes"),m.push("All recordings are stored locally and not uploaded."),m.push("$(chevron-right) Click status bar entry to add a bookmark"),m.push(`[$(chevron-right) Open local recording folder](command:${s})`),m.push(`[$(chevron-right) View recording](command:${l})`);let h=new to.MarkdownString(m.join(`

`));h.isTrusted=!0,h.supportThemeIcons=!0,f.tooltip=h,f.color="yellow",f.show(),f.command={command:a,title:"Add bookmark"}})),this._register(to.workspace.onDidOpenTextDocument(d=>{let p=_u(d),f=this.getWorkspaceRecorder(p);f&&f.handleOnDidOpenTextDocument(p,d.getText())})),this._register(to.workspace.onDidChangeTextDocument(d=>{let p=_u(d.document),f=this.getWorkspaceRecorder(p);if(f){let m=Wee(d.contentChanges);f.handleOnDidChangeTextDocument(p,m)}})),this._register(to.workspace.onDidCloseTextDocument(d=>{let p=_u(d);this.getWorkspaceRecorder(p)?.handleOnDidCloseTextDocument(p)}));for(let d of to.workspace.textDocuments){let p=_u(d),f=this.getWorkspaceRecorder(p);f&&f.handleOnDidOpenTextDocument(p,d.getText())}let u=new yB;this._register(G_((d,p)=>{let f=u.activeTextEditor.read(d);if(!f)return;let m=_u(f.editor.document),h=this.getWorkspaceRecorder(m);h&&(h.handleOnDidFocusedDocumentChange(m),p.add(Yl(g=>{let b=f.selection.read(g).map(_=>eke(_,f.editor.document));h.handleOnDidSelectionChange(m,b)})))}))}getWorkspaceRecorder(t){let r=this.gitApi.repositories.find(a=>t.startsWith(a.rootUri.toString())),o=r?.rootUri.toString().toLowerCase();if(!o)return;let s=this.recorders.get(o);if(!s){let a=this.workspacesIndexFile.value.workspaceIdxByRoot,c=a[o];c===void 0&&(c=Object.entries(a).length,a={...a,[o]:c},this.workspacesIndexFile.setValue({workspaceIdxByRoot:a}));let l=new hB(async p=>{let f=await r.checkIgnore(p);return p.map(m=>f.has(m))},1e3),u=new Zm(async p=>{let f=ike.Uri.parse(p).fsPath;return await l.request(f)}),d=Dlt((0,ek.basename)(o))+"-"+c;s=new xB(o,(0,ek.join)(this.recordingDirPath,d),{isIgnoredDocument:p=>u.get(p)}),this._register(s),this.recorders.set(o,s),this.recordersChangedSignal.trigger(void 0)}return s}};function Dlt(n){return n.replaceAll(/[^a-zA-Z0-9_.-]/g,"")}var are=class{static parse(e){let t=[],r=e.split(`
`),o=0;for(let s of r)o++,s.trim().length!==0&&t.push(JSON.parse(s));return t}};var oke=[...Z_e,Lr(eE),DJ,LJ,Lr(Pw),Lr(oE),Lr(jw),Lr(fE),Lr(L9),Lr(KE),Lr(Zw),Lr(zw),tre],ske=[Lr(f9),Lr(XE),Lr(Aw),Lr(IE),Lr(qw),Lr(Fw),Lr(Qw),Lr(_E),Lr(dE),Lr(Gw),Lr(mE),Lr(Ww),Lr(YE),Lr(QE),Lr(SE),Lr(xE)];var uke=q(ht());var ake=q(ht());var cke=q(require("fs"));var cre;function Nlt(n,e,t){let r=n.replace(/\r\n/g,`
`);return cre=cre?.then(()=>t.getSemanticChunkNames(e,r))??t.getSemanticChunkNames(e,r),cre}async function Llt(n,e,t,r){let o=await t.get(n)?.getText(e),s=_l(fo(n).languageId);if(!o||!s)return;let a=new lre(s,o,r);return await a.initTree(e),a}var lre=class{constructor(e,t,r){this.lang=e;this.text=t;this.parserService=r}async initTree(e){this.tree=await po(Nlt(this.text,this.lang,this.parserService),e)}async getKeywords(e){if(!this.tree||this.tree.roots.length===0)return;let t=this.findSmallestNodeThatFullyContainsRange(e,this.tree.roots),r;return t?r=this.findContainedChildren(e,t.children):r=this.findContainedChildren(e,this.tree.roots),zn([t,...r].map(o=>o?.info.detailBlocks.name))}findContainedChildren(e,t){if(!this.tree)return[];let r=[];for(let o of t)e.intersectRanges(this.getNodeRange(o))&&r.push(o);return r}findSmallestNodeThatFullyContainsRange(e,t){if(!this.tree||t.length===0)return;let r;for(let o of t){let s=De.lift(this.getNodeRange(o));if(s.containsRange(e)&&!s.equalsRange(e)){let a=this.findSmallestNodeThatFullyContainsRange(e,o.children);a?r=a:r=o;break}}return r}getNodeRange(e){return{startLineNumber:e.info.mainBlock.range.startPosition.row,startColumn:e.info.mainBlock.range.startPosition.column,endLineNumber:e.info.mainBlock.range.endPosition.row,endColumn:e.info.mainBlock.range.endPosition.column}}},tk=class{constructor(e,t){this._workspaceFileIndex=e;this._parserService=t;this.cache=new kn}async getKeywords(e,t,r){return await(this.cache.get(e)??await Llt(e,t,this._workspaceFileIndex,this._parserService))?.getKeywords(r)??[]}};tk=E([v(0,wc),v(1,ft)],tk);var mS=q(Ve());var nk=class extends mS.PromptElement{render(e,t){return vscpp(vscppf,null,vscpp(mS.SystemMessage,{priority:1e3},"You are a coding assistant who helps the user find relevant code in their workspace by providing a list of relevant keywords they can search for in the codebase's text.",vscpp("br",null),"The user will provide you with potentially relevant information from the workspace. This information may be incomplete.",vscpp("br",null),"Respond in Markdown. Output a short markdown list of up to 16 relevant keywords that the user can search for to answer the question. You may include variations after each keyword.",vscpp("br",null),"Re-state key nouns from the user's query in the response. For example, if the user asks about 'base64 encoding', you should include 'base64' in the response.",vscpp("br",null),"DO NOT ask the user for additional information or clarification.",vscpp("br",null),"DO NOT answer the user's question directly.",vscpp("br",null),vscpp("br",null),"# Additional Rules",vscpp("br",null),vscpp("br",null),"Think step by step:",vscpp("br",null),"1. Read the user's question to understand what they are asking about their workspace.",vscpp("br",null),"2. Read the user's file structure. DO NOT use keywords that reference the file names. Rather, use these file names to understand what type of code the user is working on.",vscpp("br",null),"3. Use the context from Step 3 to guess what you could 'grep' for in the project in relation to the user's question. These terms should be related to the user's query.",vscpp("br",null),"3. Output a short markdown list of up to 16 relevant keywords that users could try searching for to answer their question. These keywords could used as symbol names, abbreviations, or comments in the relevant code. Put the keywords most relevant to the question first. Do not include overly generic keywords. Do not repeat keywords.",vscpp("br",null),"4. For each keyword in the markdown list of related keywords, if applicable add a comma separated list of variations after it. For example: for 'encode' possible variations include 'encoding', 'encoded', 'encoder', 'encoders'. Consider synonyms and plural forms. Do not repeat variations.",vscpp("br",null),vscpp("br",null),"Examples",vscpp("br",null),vscpp("br",null),"User: base64 encoding",vscpp("br",null),vscpp("br",null),"Assistant:",vscpp("br",null),"- base64 encoding, base64 encoder, base64 encode",vscpp("br",null),"- base64, base 64",vscpp("br",null),"- encode, encoded, encoder, encoders"),vscpp(mS.UserMessage,{priority:700},vscpp(ws,{maxSize:1e3})),vscpp(mS.UserMessage,{priority:1e3},this.props.query))}};var TB=re("IWorkspaceSemanticChunkService"),mO=class{constructor(e,t,r,o,s,a,c,l){this.sizing=e;this.query=t;this.token=r;this.includes=o;this._chatFetcher=s;this._endpointProvider=a;this._instantiationService=c;this._logService=l;this.treeSitterKeywordFetcher=this._instantiationService.createInstance(tk)}async initSemanticSearchMetaprompt(){let e=new Qo,t=await this._endpointProvider.getChatEndpoint("gpt-4o-mini"),{messages:r}=await this.buildMetaPrompt(t,this.query);if(this.token.isCancellationRequested)throw new dt;this._logService.internal.debug(`[Semantic search metaprompt] built prompt in ${e.elapsed()}ms`);let o=await this._chatFetcher.fetchOne("searchFileChunks",r,async s=>{},this.token,2,t);if(o.type!=="success")throw new Error(ake.t("Encountered an error while deciding what workspace information to collect: ({0}) {1}",o.type,o.reason));if(this.token.isCancellationRequested)throw new dt;return this._logService.internal.debug(`[Semantic search metaprompt] took a total of ${e.elapsed()}ms`),ure(o.value)}async search(){return this.metaPromptResponse=this.initSemanticSearchMetaprompt(),{fileResults:await this._instantiationService.invokeFunction(e=>dre(e,this.sizing,this.query,this.metaPromptResponse,this.token,this.treeSitterKeywordFetcher,this.includes)),metapromptResult:await this.metaPromptResponse}}async buildMetaPrompt(e,t){return Fe.create(this._instantiationService,e,nk,{query:t}).render()}};mO=E([v(4,Et),v(5,_e),v(6,H),v(7,oe)],mO);var Olt=/^[\*\-]\s*(.+)/m;function ure(n){let e=[],t=new Set;for(let r of n.trim().split(`
`)){let o=r.match(Olt);if(o){let s=o[1].split(/,/g).map(a=>a.trim());if(s.length){let a=s.flatMap(l=>l.split(/[\s\-_.]/g)).filter(l=>!t.has(l));if(new Set(a).forEach(l=>t.add(l)),!a.length)continue;e.unshift({keyword:a[0],variations:a.length>1?a.slice(1):[]})}}}return{keywords:e}}var rk=class{constructor(e){this._instantiationService=e}async searchFileChunks(e,t,r,o){return this._instantiationService.createInstance(mO,e,t,r,o).search()}};rk=E([v(0,H)],rk);async function dre(n,e,t,r,o,s,a){let c=n.get(yh),l={rawQuery:t,resolveQueryAndKeywords:async()=>{let d=await r;return{rephrasedQuery:t,keywords:d.keywords}},resolveQuery:async()=>t},u=(await c.searchFileChunks(e,l,{include:a,minimumRerankEmbeddingThreshold:.25},void 0,o)).chunks;return o.isCancellationRequested||!u.length?[]:Mlt(u,o,s)}async function Mlt(n,e,t){let r=[],o=new kn;for(let[s,a]of n.entries()){let c=o.get(a.file),l={range:a.range,rank:s},u=c?[...c,l]:[l];o.set(a.file,u)}for(let[s,a]of o.entries()){let c=a.map((f,m)=>{for(let[h,g]of a.entries()){let y=f.range,b=g.range;if(m!==h&&y.containsRange(b))if(y.equalsRange(b)){if(m<h)return}else return}return f}).filter(f=>f!==void 0),l=[],u;c.sort((f,m)=>f.range.startLineNumber-m.range.startLineNumber);for(let f of c)u&&u.range.endLineNumber>=f.range.startLineNumber-1?u={range:new De(u.range.startLineNumber,u.range.startColumn,f.range.endLineNumber,f.range.endColumn),rank:u.rank}:(u&&l.push(u),u=f);u&&l.push(u);let p=(await cke.promises.readFile(s.fsPath,"utf8")).split(`
`);for(let f of l){let m=f.range.startLineNumber,h=f.range.endLineNumber,g=p.slice(m,h),y=t?t.getKeywords(s,e,f.range):Promise.resolve([]);r.push({result:{file:s,location:{range:f.range,code:g,treeSitterBlockNames:y}},rank:f.rank})}}return r.sort((s,a)=>s.rank-a.rank).map(s=>s.result)}var ik=class{constructor(e,t,r,o){this._endpointProvider=e;this._workspaceSemanticChunkService=t;this._logService=r;this._telemetryService=o;this._endpoint=void 0;this.name="GitHub Copilot"}async getEndpoint(){return this._endpoint=this._endpoint??await this._endpointProvider.getChatEndpoint("gpt-4o-mini"),this._endpoint}provideAITextSearchResults(e,t,r,o){let s=new Qo;return(async()=>{let c=0,l=await this._workspaceSemanticChunkService.searchFileChunks({endpoint:await this.getEndpoint(),maxResults:75},e,o,{include:t.includes.length>0?t.includes:void 0,exclude:t.excludes.length>0?t.excludes:void 0}),u=await Hlt(l,o,this._logService,this._telemetryService);for(let d of u){if("ranges"in d&&(Array.isArray(d.ranges)?c+=d.ranges.length:c+=1),c>=t.maxResults)break;r.report(d)}return this._logService.public.debug(`Semantic search took ${s.elapsed()}ms`),{limitHit:!1,message:{text:uke.t("Results are from Copilot"),trusted:!0,type:1}}})()}};ik=E([v(0,_e),v(1,TB),v(2,oe),v(3,ge)],ik);var Flt=5;function Ult(n){return new RegExp(`\\b(\\w*(${n.map(e=>e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")).join("|")})\\w*)\\b`,"gi")}function lke(n,e,t){if(n.length===0)return{ranges:[],previewMatchRanges:[]};let r=[],o=[],s=Ult(n);return e.forEach((a,c)=>{let l=Array.from(a.matchAll(s)),u=t.startLineNumber+c,d=c===0?t.startColumn:0,p,f;for(let m of l){if(m.index===void 0)continue;let h=d+m.index,g=h+m[0].length,y=m.index,b=y+m[0].length;if(p&&f)if(p?.end.line===u&&p.end.character>h-Flt){p=p.with(void 0,new Sn(u,g)),f=f?.with(void 0,new Sn(c,b));continue}else r.push(p),o.push(f);p=new Me(new Sn(u,h),new Sn(u,g)),f=new Me(new Sn(c,y),new Sn(c,b))}p&&f&&(r.push(p),o.push(f))}),{ranges:r,previewMatchRanges:o}}async function Blt(n,e,t=Zt.None,r,o){let s=[];return await po((async()=>{let c=0,l=0;await Promise.all(n.map(async d=>{let p=d.location,f=p.code,{ranges:m,previewMatchRanges:h}=lke(e,f,p.range);if(m.length)s.push({uri:d.file,ranges:m,preview:{text:p.code.join(`
`),matches:h}}),c++;else{let g=await p.treeSitterBlockNames,{ranges:y,previewMatchRanges:b}=lke(g,f,p.range);if(y.length)s.push({uri:d.file,ranges:y,preview:{text:p.code.join(`
`),matches:b}}),c++;else{r?.internal.debug(`No keyword highlights found for ${d.file} at ${p.range.startLineNumber}:${p.range.startColumn}. Treesitter keywords: ${g.join(", ")}.`);let _=qlt(f,jT(p.range));_!==void 0&&s.push({uri:d.file,ranges:_.range,preview:{text:_.code,matches:_.previewRange}}),l++}}}));let u=l/(c+l)*100;return r?.public.debug(`Percentage of semantic search chunks with no keyword found: ${u}%`),o?.sendMSFTTelemetryEvent("workspaceSemanticSearch.chunksWithoutKeywords",void 0,{percentOfChunksWithFailedKeywordFind:u}),s})(),t)??[]}function qlt(n,e){for(let t=0;t<n.length;t++){let o=n[t].match(/^\s+/);if(o){let s=e.start.line+t===e.end.line;return{code:n.slice(t).join(`
`).substring(o[0].length),range:new Me(new Sn(e.start.line+t,e.start.character+o[0].length),e.end),previewRange:new Me(new Sn(0,0),new Sn(e.end.line-e.start.line+t,s?e.end.character-e.start.character:e.end.character))}}}}function jlt(n){let e=n.keyword;return e.length===0&&(e=n.variations.find(t=>t.length>0)),e}async function Hlt(n,e,t,r){let o=[],s=n.metapromptResult.keywords;return s?await Blt(n.fileResults,zn(s.map(a=>jlt(a))),e,t,r):o}var dke=q(require("path")),Pu=q(require("vscode"));var Vlt=10,Glt=5*60*1e3,zlt=10*1e3,CB=[];function pke(n){let e=n.get(be),t=n.get(ya),r=n.get(H),o=n.get(oe),s=new _t;if(!e.getConfig(le.FeedbackOnChange))return s;let c=t.getDiagnosticCollection(),l=r.createInstance(N0);return s.add(Pu.workspace.onDidChangeTextDocument(async u=>{if(u.document.uri.scheme==="file"&&u.contentChanges.length&&u.document===Pu.window.activeTextEditor?.document)try{o.public.warn("Document changed, delaying diagnostics request");let d=u.document.version;if(await new Promise(y=>setTimeout(y,zlt)),d!==u.document.version){o.public.warn("Skipping diagnostics request because the document has changed");return}let p=Date.now(),f=p-Glt;if(CB=CB.filter(y=>y>f),CB.length>=Vlt){o.public.warn("Max requests reached, skipping diagnostics request");return}CB.push(p),o.public.trace("Requesting diagnostics");let m=Pu.window.activeTextEditor?.selection,h=await r.invokeFunction(dr.getCurrentChange,u.document,m.start);if(!h)return o.public.trace("No change found in the current document at the current position."),[];let g=await l.generateComments([{document:Bt.create(u.document),relativeDocumentPath:dke.basename(u.document.uri.fsPath),change:h,selection:m}],new Pu.CancellationTokenSource().token);if(g.type==="success"){let y=g.comments.map(b=>new Pu.Diagnostic(b.range,typeof b.body=="string"?b.body:b.body.value,Pu.DiagnosticSeverity.Information));c.set(u.document.uri,y)}}catch(d){o.public.error(d,"Error generating diagnostics")}})),s.add(Pu.workspace.onDidCloseTextDocument(u=>{c.set(u.uri,void 0)})),s}var ak=q(require("vscode"));var Uf=q(Ve());var pre=class extends Uf.PromptElement{render(){let e=this.props.issues?.map(t=>vscpp(vscppf,null,"------- Issue ",t.reference,":",vscpp("br",null),t.content,vscpp("br",null)));return e&&e.length>0?vscpp(vscppf,null,"You are an AI assistant for a software developer who is about to make a pull request to a GitHub repository to fix the following issues: ",vscpp("br",null),e):vscpp(vscppf,null,"You are an AI assistant for a software developer who is about to make a pull request to a GitHub repository.")}},fre=class extends Uf.PromptElement{render(){return vscpp(vscppf,null,"Here are two good examples:",vscpp("br",null)," ",this.props.issues&&this.props.issues.length>0?vscpp(vscppf,null,"Example One:",vscpp("br",null),"+++Batch mark/unmark files as viewed",vscpp("br",null),"+++Previously, when marking/unmarking a folder as viewed, a request was sent for every single file. This PR ensures that only one request is sent when marking/unmarking a folder as viewed.",vscpp("br",null),"Fixes #4520+++",vscpp("br",null),"Example two:",vscpp("br",null),"+++Fallback to hybrid after 20 process ports",vscpp("br",null),"+++Additionally the \\`remote.autoForwardPortsSource\\` setting has been updated to remove the \\`markdownDescription\\` reference to a reload being required for changes to take effect.",vscpp("br",null),"Fixes microsoft/vscode-internalbacklog#4533+++",vscpp("br",null)):vscpp(vscppf,null,"Example One:",vscpp("br",null),"+++Batch mark/unmark files as viewed",vscpp("br",null),"+++Previously, when marking/unmarking a folder as viewed, a request was sent for every single file. This PR ensures that only one request is sent when marking/unmarking a folder as viewed.+++",vscpp("br",null),"Example two:",vscpp("br",null),"+++Fallback to hybrid after 20 process ports",vscpp("br",null),"+++Additionally the \\`remote.autoForwardPortsSource\\` setting has been updated to remove the \\`markdownDescription\\` reference to a reload being required for changes to take effect.+++",vscpp("br",null),"Example three:",vscpp("br",null),"+++Add a favicon",vscpp("br",null),"+++Add a favicon to the webview+++",vscpp("br",null)),";")}},mre=class extends Uf.PromptElement{render(){return vscpp(vscppf,null,vscpp(pre,{issues:this.props.issues}),"Pull requests have a short and concise title that describes the changes in the code and a description that is much shorter than the changes.",vscpp("br",null),"To compose the description, read through each commit and patch and tersly describe the intent of the changes, not the changes themselves. Do not list commits, files or patches. Do not make up an issue reference if the pull request isn't fixing an issue.",vscpp("br",null),"If the pull request is fixing an issue, consider how the commits relate to the issue and include that in the description.",vscpp("br",null),'Avoid saying "this PR" or similar. Avoid passive voice.',vscpp("br",null),"The title and description of a pull request should be markdown and start with +++ and end with +++.",vscpp("br",null),vscpp(fre,{issues:this.props.issues}))}},hre=class extends Uf.PromptElement{render(){let e=this.props.commitMessages.map(r=>`"${r.replace(/\n/g,". ")}"`).join(", "),t=this.props.patches.map(r=>vscpp(vscppf,null,"```diff",vscpp("br",null),r,vscpp("br",null),"```",vscpp("br",null)));return vscpp(vscppf,null,"These are the commits that will be included in the pull request you are about to make:",vscpp("br",null),e,vscpp("br",null),"Below is a list of git patches that contain the file changes for all the files that will be included in the pull request:",vscpp("br",null),t,vscpp("br",null),"Based on the git patches and on the git commit messages above, the title and description of the pull request should be:",vscpp("br",null))}},EB=class extends Uf.PromptElement{render(){return vscpp(vscppf,null,vscpp(Uf.SystemMessage,null,vscpp(mre,{issues:this.props.issues}),vscpp(Ze,null)),vscpp(Uf.UserMessage,null,vscpp(hre,{commitMessages:this.props.commitMessages,patches:this.props.patches})))}};var Py=class{constructor(e,t,r,o,s,a){this.logService=e;this.options=t;this.ignoreService=r;this.endpointProvider=o;this.chatMLFetcher=s;this.instantiationService=a;this.disposables=new _t;this.lastContext={commitMessages:[],patches:[]};this.logService.public.info("[githubTitleAndDescriptionProvider] Initializing GitHub PR title and description provider provider.")}dispose(){this.disposables.dispose()}isRegenerate(e,t){if(e.length!==this.lastContext.commitMessages.length||t.length!==this.lastContext.patches.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==this.lastContext.commitMessages[r])return!1;for(let r=0;r<t.length;r++)if(t[r]!==this.lastContext.patches[r])return!1;return!0}async excludePatches(e){let t=[];for(let r of e)r.fileUri&&await this.ignoreService.isCopilotIgnored($e.parse(r.fileUri))||r.previousFileUri&&r.previousFileUri!==r.fileUri&&await this.ignoreService.isCopilotIgnored($e.parse(r.previousFileUri))||t.push(r.patch);return t}async provideTitleAndDescription(e,t){let r=e.commitMessages,o=TF(e.patches)?e.patches.map(p=>({patch:p})):e.patches,s=await this.excludePatches(o),a=e.issues,c=await this.endpointProvider.getChatEndpoint("gpt-4o-mini"),l=Math.floor(c.modelMaxPromptTokens*4/3),u=await this.createPRTitleAndDescriptionPrompt(r,s,a,l),d=await this.chatMLFetcher.fetchOne("githubPullRequestTitleAndDescriptionGenerator",u.messages,void 0,t,5,c,void 0,{temperature:this.isRegenerate(r,s)?this.options.temperature+.1:this.options.temperature});if(this.lastContext={commitMessages:r,patches:s},d.type==="success")return Py.parseFetchResult(d.value)}static parseFetchResult(e,t=!0){e=e.trim();let r=e,o="+++",s=r.indexOf(o);if(s===-1)return;for(;r.charAt(s+o.length)==="+";)o+="+";let a=r.lastIndexOf(o);r=r.substring(s+o.length,a>s+o.length?a:void 0).trim().replace(/\++?(\n)\++/,o);let c=r.split(o).filter(p=>p.trim().length>0),l;if(c.length===1)l=c[0].split(`
`);else if(c.length>1){let p=c.slice(1).map(f=>f.split(`
`)).flat().filter(f=>f.trim().length>0);l=[c[0],...p]}else return;let u,d;if(l.length===1){if(u=l[0].trim(),t&&e.includes(`
`)&&e.split(o).length===3)return this.parseFetchResult(e+o,!1)}else if(l.length>1){u=l[0].trim(),d="";let p=l.slice(1);for(let f of p)f.includes("commit message")||(d+=`${f.trim()}

`)}if(u)return u=u.replace(/Title\:\s/,"").trim(),u=u.replace(/^\"(?<title>.+)\"$/,(p,f)=>f),d&&(d=d.replace(/Description\:\s/,"").trim()),{title:u,description:d}}async createPRTitleAndDescriptionPrompt(e,t,r,o){let s=o-Math.floor(o*.2),a=t.join(`

`).length;if(a>s)for(t.sort((u,d)=>u.length-d.length);a>s&&t.length>0;){let u=t.pop();a-=u.length}let c=await this.endpointProvider.getChatEndpoint("gpt-4o-mini");return Fe.create(this.instantiationService,c,EB,{commitMessages:e,issues:r,patches:t}).render(void 0,void 0)}};Py=E([v(0,oe),v(1,va),v(2,Te),v(3,_e),v(4,Et),v(5,H)],Py);var ok=class{constructor(e,t,r,o,s,a,c,l,u,d){this.scopeSelector=e;this.instantiationService=t;this.reviewService=r;this.authService=o;this.logService=s;this.gitExtensionService=a;this.domainService=c;this.fetcherService=l;this.envService=u;this.ignoreService=d}async provideReviewerComments(e,t){let r=await wx(this.scopeSelector,this.instantiationService,this.reviewService,this.authService,this.logService,this.gitExtensionService,this.domainService,this.fetcherService,this.envService,this.ignoreService,e,t),o=[];if(r?.type==="success")for(let a of r.comments)o.push(a.uri);let s=r?.type==="success";return{files:o,succeeded:s}}};ok=E([v(0,bd),v(1,H),v(2,ya),v(3,xt),v(4,oe),v(5,Ji),v(6,xn),v(7,hn),v(8,it),v(9,Te)],ok);var sk=class{constructor(e,t,r){this.logService=e;this.instantiationService=t;this.reviewService=r;this.disposables=new _t;this.initializeGitHubPRExtensionApi()}dispose(){this.disposables.dispose()}getExtension(){return ak.extensions.getExtension("github.vscode-pull-request-github")}initializeGitHubPRExtensionApi(){let e=this.getExtension(),t=async()=>{if(e){let r=await e.activate();this.logService.public.info("Successfully activated the GitHub.vscode-pull-request-github extension."),this.gitHubExtensionApi=r,this.registerTitleAndDescriptionProvider(),this.registerReviewerCommentsProvider()}};if(e)t();else{this.logService.public.info("GitHub.vscode-pull-request-github extension is not yet activated.");let r=ak.extensions.onDidChange(()=>{e=this.getExtension(),e&&(t(),r.dispose())});this.disposables.add(r)}}async registerTitleAndDescriptionProvider(){if(this.gitHubExtensionApi)try{this.titleAndDescriptionProvider||(this.titleAndDescriptionProvider=this.disposables.add(this.instantiationService.createInstance(Py))),this.disposables.add(this.gitHubExtensionApi.registerTitleAndDescriptionProvider(ak.l10n.t("Generate with Copilot"),this.titleAndDescriptionProvider)),this.logService.public.info("Successfully registered GitHub PR title and description provider.")}catch{}}async registerReviewerCommentsProvider(){if(this.gitHubExtensionApi&&this.reviewService.isReviewDiffEnabled())try{this.reviewerCommentsProvider||(this.reviewerCommentsProvider=this.instantiationService.createInstance(ok)),this.disposables.add(this.gitHubExtensionApi.registerReviewerCommentsProvider(ak.l10n.t("Copilot"),this.reviewerCommentsProvider)),this.logService.public.info("Successfully registered GitHub PR reviewer comments provider.")}catch{}}};sk=E([v(0,oe),v(1,H),v(2,ya)],sk);var ck=q(require("path")),mke=require("util"),nt=require("vscode");var $lt=["dockerfile","license","makefile","readme","procfile","gemfile","rakefile","jenkinsfile","vagrantfile"];function fke(n){return/\.[^/.]+$/.test(n)&&$lt.indexOf(n.toLowerCase())===-1}var xa=require("vscode"),hO=class{constructor(e){this.contentManager=e;this._onDidChangeFile=new xa.EventEmitter;this.onDidChangeFile=this._onDidChangeFile.event}async stat(e){let t=this.contentManager.get(e);if(!t)throw xa.FileSystemError.FileNotFound(e);let r=await t.content?.then(o=>o?.length)??0;return{ctime:t.ctime??0,mtime:t.ctime??0,size:r,type:t.children?xa.FileType.Directory:xa.FileType.File}}readDirectory(e){let t=this.contentManager.get(e);if(!t)throw xa.FileSystemError.FileNotFound(e);return t.children?.map(r=>[r.name,r.children?xa.FileType.Directory:xa.FileType.File])??[]}async readFile(e){let t=this.contentManager.get(e);if(!t)throw xa.FileSystemError.FileNotFound(e);let r;try{r=await t.content}catch{}return r??new Uint8Array}watch(e,t){return{dispose(){}}}createDirectory(e){throw xa.FileSystemError.NoPermissions(e)}writeFile(e,t,r){throw xa.FileSystemError.NoPermissions(e)}delete(e,t){throw xa.FileSystemError.NoPermissions(e)}rename(e,t,r){throw xa.FileSystemError.NoPermissions(t)}copy(e,t,r){throw xa.FileSystemError.NoPermissions(t)}};var kB=require("vscode");var wB=class extends ye{constructor(t){super();this.contentManager=t;this.onDidChangeEmitter=new kB.EventEmitter;this.onDidChange=this.onDidChangeEmitter.event;this._register(kB.workspace.onDidChangeTextDocument(r=>{r.document.uri.scheme===Px&&this.onDidChangeEmitter.fire(r.document.uri)}))}async provideTextDocumentContent(t,r){let o=this.contentManager.get(t);if(!o)return"";let s;try{s=await o.content}catch{}return new TextDecoder().decode(s)??""}};function hke(n,e,t){return nt.Disposable.from(nt.workspace.registerFileSystemProvider(t9,new hO(n),{isReadonly:new nt.MarkdownString(nt.l10n.t(`This file preview was generated by Copilot and may contain surprises or mistakes.

Ask followup questions to refine it, then press Create Workspace.`))}),nt.workspace.registerFileSystemProvider(n9,new hO(n),{isReadonly:!0}),nt.workspace.registerTextDocumentContentProvider(Px,new wB(n)),nt.commands.registerCommand(gJ,async(r,o)=>{let s=(await nt.window.showOpenDialog({defaultUri:o,title:ck.basename(r.baseUri.path),canSelectFolders:!0,canSelectFiles:!1,canSelectMany:!1,openLabel:"Select as Parent Folder"}))?.[0];s&&await Wlt(e,o,s,r)}),nt.commands.registerCommand(e9,async r=>{let o=nt.Uri.joinPath(r.baseUri,r.value[0].name).toString(),s=await nt.workspace.openTextDocument(nt.Uri.parse(o));await nt.window.showTextDocument(s,{preview:!1})}),nt.commands.registerCommand(vJ,async r=>{let o={defaultUri:nt.Uri.file(ck.posix.join(nt.workspace.workspaceFolders?.[0].uri.path??"",r.value[0].name)),saveLabel:nt.l10n.t("Save File")},s=await nt.window.showSaveDialog(o);if(s){let a=nt.Uri.joinPath(r.baseUri,r.value[0].name).toString(),c=await nt.workspace.openTextDocument(nt.Uri.parse(a));await nt.workspace.fs.writeFile(s,Buffer.from(c.getText()));let l=[];nt.window.tabGroups.all.forEach(d=>{d.tabs.forEach(p=>{p.input instanceof nt.TabInputText&&p.input.uri.scheme===Px&&l.push(p)})}),nt.window.tabGroups.close(l,!0);let u=await nt.workspace.openTextDocument(nt.Uri.file(s.fsPath));await nt.window.showTextDocument(u)}}))}async function Wlt(n,e,t,r){let o=r.baseUri.path,s=await Klt(t,o),a=[];nt.window.tabGroups.all.forEach(l=>{l.tabs.forEach(u=>{u.input instanceof nt.TabInputText&&u.input.uri.scheme===t9&&a.push(u)})}),nt.window.tabGroups.close(a,!0);let c=nt.Uri.joinPath(t,s);try{if(await nt.window.withProgress({location:nt.ProgressLocation.Notification,cancellable:!0},async(m,h)=>{await nt.workspace.fs.createDirectory(c);let g=ck.basename(o);async function y(b,_,x){let I=b?b.slice(g.length+1):"..",S=nt.Uri.joinPath(c,I,_.name);if(_.children?.length||!fke(_.name)){b!==""&&(m.report({message:nt.l10n.t("Creating folder {0}...",S.fsPath)}),await nt.workspace.fs.createDirectory(S));for(let w of _.children??[])await y(ck.posix.join(b,_.name),w,x)}else{m.report({message:nt.l10n.t("Creating file {0}...",S.fsPath)});let w=await nt.workspace.fs.readFile(nt.Uri.joinPath(x,b,_.name));await nt.workspace.fs.writeFile(S,Buffer.from(w))}}for(let b of r.value)await y("",b,r.baseUri);await Qlt(c)}),e&&c.fsPath.startsWith(e.fsPath))return;let l=nt.l10n.t("Would you like to open the created workspace?"),u=nt.l10n.t("Open"),d=nt.l10n.t("Open in New Window"),p=[u,d],f=await nt.window.showInformationMessage(l,{modal:!0},...p);f===u?(nt.interactive.transferActiveChat(c),n.public.info("[newIntent] Opening folder: "+c.fsPath),nt.commands.executeCommand("vscode.openFolder",c)):f===d&&nt.commands.executeCommand("vscode.openFolder",c,!0)}catch(l){let u=nt.l10n.t("Failed to create workspace: {0}",s);n.public.error(l,u),nt.window.showErrorMessage(u),await nt.workspace.fs.delete(c,{recursive:!0})}}async function Klt(n,e){let t=0,r=!0,o=e;for(;r;)try{await nt.workspace.fs.stat(nt.Uri.joinPath(n,o)),o=e+"-"+ ++t}catch{r=!1}return o}async function Ylt(n){try{return await nt.workspace.fs.stat(n),!0}catch{return!1}}async function Qlt(n){let e=Xlt();if(e)if(await Ylt(e)){let t=await nt.workspace.fs.readFile(e).then(o=>new mke.TextDecoder().decode(o)),r=JSON.parse(t);r.push(n.toString()),await nt.workspace.fs.writeFile(e,Buffer.from(JSON.stringify(r,null,2)))}else await nt.workspace.fs.writeFile(e,Buffer.from(JSON.stringify([n.toString()],null,2)))}function Xlt(){let n=nt.env.appName.indexOf("Insider")>0||nt.env.appName.indexOf("Code - OSS Dev")>=0?"Code - Insiders":"Code",e=nt.Uri.file(process.env.HOME||(process.env.USERPROFILE?process.env.USERPROFILE:""));switch(process.platform){case"darwin":return nt.Uri.joinPath(e,"Library","Application Support",n,"User","workspaceStorage","aiGeneratedWorkspaces.json");case"linux":return nt.Uri.joinPath(e,".config",n,"User","workspaceStorage","aiGeneratedWorkspaces.json");case"win32":return process.env.APPDATA?nt.Uri.joinPath(nt.Uri.file(process.env.APPDATA),n,"User","workspaceStorage","aiGeneratedWorkspaces.json"):void 0;default:return}}var RB=q(ht()),gke=require("path"),Ka=q(require("vscode")),vke=require("vscode");var os=q(Ve()),gO=require("path");var lk=class extends os.PromptElement{constructor(t,r){super(t);this._terminalService=r}render(){let t=this._terminalService.terminalLastCommand?.cwd?typeof this._terminalService.terminalLastCommand.cwd=="string"?this._terminalService.terminalLastCommand.cwd:this._terminalService.terminalLastCommand.cwd.path:void 0;return vscpp(vscppf,null,vscpp(os.SystemMessage,{priority:1e3},"You are a programmer who specializes in using the command line. Your task is to respond with a list of files that you need access to in order to fix the command. Carefully consider the command line, output and current working directory in your response.",vscpp("br",null),vscpp(Ze,null),vscpp(kt,null),`
You MUST respond ONLY with a JSON array in the format:

\`\`\`json
[
	{
		fileName: string
	},
	...
]
\`\`\`

Follow these rules in your response:

- Use an absolute path if you know the exact location of the file.
- Do NOT include any introduction, description or prose. Only include the paths.
`),vscpp(os.SystemMessage,{priority:1e3},`Examples:

User: npm startt
Assistant:
- \`${t?(0,gO.join)(t,".bin/startt"):".bin/startt"}\`
- \`${t?(0,gO.join)(t,"package.json"):"package.json"}\`
`),vscpp(dk,{priority:800}),vscpp(pk,{priority:600}),vscpp(os.UserMessage,{priority:1100},this._terminalService.terminalLastCommand?"":`The following command just failed when run in the terminal \`${this.props.commandLine}\`.

Here is the output of the command:
${(this.props.output??[]).join()}`),vscpp(Th,{priority:800}))}};lk=E([v(1,vi)],lk);var uk=class extends os.PromptElement{constructor(t,r){super(t);this._terminalService=r}render(t){let r=this.props.verifiedContextUris.map(o=>vscpp(tf,{variableName:(0,gO.basename)(o.path),variableValue:o}));return vscpp(vscppf,null,vscpp(os.SystemMessage,{priority:1e3},"You are a programmer who specializes in using the command line. Your task is to help the user fix a command that was run in the terminal by providing a list of fixed command suggestions. Carefully consider the command line, output and current working directory in your response.",vscpp("br",null),vscpp(Ze,null),vscpp(kt,null),`
You MUST respond ONLY with a JSON array containing HIGHLY RELEVANT command suggestions in the format:

\`\`\`json
[
	{
		command: string,
		description: string,
		relevance: 'low' | 'medium' | 'high'
	},
	...
]
\`\`\`

Follow these rules in your response:

- You MUST NOT suggest commands that use non-existent files.
- Under no circumstance will you include an summary, description or any prose whatsoever.
- Do NOT repeat the command and/or output.
- Provide a maximum of 10 suggestions, starting with the most relevant.
- When there is text that needs to be replaced in the suggestion, prefix the text with '{', suffix the text with '}' and use underscores instead of whitespace. Only do this when the replacement text is NOT provided.
- Avoid providing suggestions that do exactly the same thing like aliases.
- Only provide suggestions for the active shell and avoid shelling out where possible.
- The suggestions must be relevant. For example, if the command is a build command, the suggestions must look like build commands, not test commands.
- If the command is related to a particular programming language, do not include suggestions for different languages.
- NEVER suggest to change directory to the current working directory.
`),vscpp(os.SystemMessage,{priority:700},`Examples:

User: lss
Assistant:
- \`ls\`

User: clone git
Assistant:
- \`git clone {repository}\`

User: .venv/bin/activate
Context: .venv/bin/activate DOES NOT exist
Assistant:
- \`python -m venv .venv\`

User: .venv/bin/activate
Context: .venv/bin/activate exists
Assistant:
- \`source .venv/bin/activate\`
`),vscpp(dk,{priority:800}),vscpp(pk,{priority:800}),vscpp(gre,{priority:600}),vscpp(os.UserMessage,{priority:1100},this._terminalService.terminalLastCommand?"":`The following command just failed when run in the terminal \`${this.props.commandLine}\`.

Here is the output of the command:
${(this.props.output??[]).join()}`),vscpp(Th,{priority:800}),vscpp(os.UserMessage,{priority:700},`${this.props.verifiedContextDirectoryUris.length>0?`The following directories exist:

${this.props.verifiedContextDirectoryUris.map(o=>`- ${o.path}`).join(`
`)}`:""}`),vscpp(os.UserMessage,{priority:700},`${this.props.nonExistentContextUris.length>0?`The following files DO NOT exist and cannot be used in the suggestion:

${this.props.nonExistentContextUris.map(o=>`- ${o.path}`).join(`
`)}`:""}`),...r)}};uk=E([v(1,vi)],uk);var gre=class extends os.PromptElement{render(){return vscpp(vscppf,null,vscpp(os.SystemMessage,{priority:this.props.priority},`
Follow these guidelines for python:
- NEVER recommend using "pip install" directly, always recommend "python -m pip install"
- The following are pypi modules: ruff, pylint, black, autopep8, etc
- If the error is module not found, recommend installing the module using "python -m pip install" command.
- If activate is not available create an environment using "python -m venv .venv".
`))}},dk=class extends os.PromptElement{constructor(t,r){super(t);this._terminalService=r}render(){return vscpp(vscppf,null,vscpp(os.UserMessage,{priority:this.props.priority},"The active terminal's shell type is: ",this._terminalService.terminalShellType))}};dk=E([v(1,vi)],dk);var pk=class extends os.PromptElement{constructor(t,r){super(t);this._envService=r}render(){return vscpp(vscppf,null,vscpp(os.UserMessage,{priority:this.props.priority},"The active operating system is: ",this._envService.OS))}};pk=E([v(1,it)],pk);function Jlt(n){switch(n){case 3:return RB.t("high relevance");case 2:return RB.t("medium relevance");case 1:return RB.t("low relevance")}}function Zlt(n){return n==="high"?3:n==="medium"?2:1}function yke(n){bke=n}var bke;async function _ke(n){let e=bke;if(!e)return;let t=new Promise(o=>{n.createInstance(vO).generateTerminalQuickFix(e,Zt.None).then(s=>{let a=(s??[]).sort((l,u)=>u.relevance-l.relevance).map(l=>({label:l.command,description:l.description,suggestion:l})),c;for(let l=0;l<a.length;l++){let u=a[l],d=a.at(l-1);"suggestion"in u&&(!c||l>0&&"suggestion"in d&&u.suggestion.relevance!==d.suggestion.relevance)&&(c=u.suggestion.relevance,a.splice(l++,0,{label:Jlt(c),kind:Ka.QuickPickItemKind.Separator}))}o(a)})});t.then(o=>{o.length===0&&Ka.window.showInformationMessage("No fixes found")});let r=await Ka.window.showQuickPick(t,{canPickMany:!1});if(r&&"suggestion"in r){let o=!r.suggestion.command.match(/{.+}/);Ka.window.activeTerminal?.sendText(r.suggestion.command,o)}}var vO=class{constructor(e,t,r,o,s){this._chatMLFetcher=e;this._endpointProvider=t;this._instantiationService=r;this._logService=o;this._workspaceService=s}async generateTerminalQuickFix(e,t){let r=await this._generateTerminalQuickFixFileContext(e,t);if(!r||t.isCancellationRequested)return;let o=[],s=[],a=[];for(let f of r)try{let m=await Ka.workspace.fs.stat(f);m.type===Ka.FileType.File||m.type===Ka.FileType.SymbolicLink?o.push(f):m.type===Ka.FileType.Directory?s.push(f):a.push(f)}catch{a.push(f)}let c=await this._endpointProvider.getChatEndpoint("gpt-4o-mini"),u=await Fe.create(this._instantiationService,c,uk,{commandLine:e.commandLine,output:[],verifiedContextUris:o,verifiedContextDirectoryUris:s,nonExistentContextUris:a}).render(void 0,void 0),d=await this._chatMLFetcher.fetchOne("terminalQuickFixGenerator",u.messages,void 0,t,5,c);if(this._logService.public.info("Terminal QuickFix FetchResult "+d),t.isCancellationRequested)return;if(d.type!=="success")throw new Error(Ka.l10n.t("Encountered an error while determining terminal quick fixes: {0}",d.type));this._logService.internal.debug("generalTerminalQuickFix fetchResult.value "+d.value);let p=[];try{let f=Is(d.value),m=JSON.parse(f.length>0?f[0].code:d.value);if(m&&Array.isArray(m)){for(let h of m)if(typeof h=="object"&&h){let g="command"in h&&typeof h.command=="string"?h.command:void 0,y="description"in h&&typeof h.description=="string"?h.description:void 0,b="relevance"in h&&typeof h.relevance=="string"&&(h.relevance==="low"||h.relevance==="medium"||h.relevance==="high")?h.relevance:void 0;g&&y&&b&&p.push({command:g,description:y,relevance:Zlt(b)})}}}catch(f){this._logService.public.error("Error parsing terminal quick fix results: "+f)}return p}async _generateTerminalQuickFixFileContext(e,t){let r=await this._endpointProvider.getChatEndpoint("gpt-4o-mini"),s=await Fe.create(this._instantiationService,r,lk,{commandLine:e.commandLine,output:[]}).render(void 0,void 0);this._logService.internal.debug("_generalTerminalQuickFixFileContext prompt.messages: "+s.messages);let a=await this._chatMLFetcher.fetchOne("terminalQuickFixGenerator",s.messages,async f=>{},t,5,r);if(this._logService.internal.info("Terminal Quick Fix Fetch Result: "+a),t.isCancellationRequested)return;if(a.type!=="success")throw new Error(Ka.l10n.t("Encountered an error while fetching quick fix file context: {0}",a.type));this._logService.internal.debug("_generalTerminalQuickFixFileContext fetchResult.value"+a.value);let c=[];try{let f=JSON.parse(a.value);if(f&&Array.isArray(f)){for(let m of f)if(typeof m=="object"&&m){let h="fileName"in m&&typeof m.fileName=="string"?m.fileName:void 0;h&&c.push({fileName:h})}}}catch{}let l=[],u=new Set,d=this._workspaceService.getWorkspaceFolders(),p=async f=>{for(let m of d){let h=$e.joinPath(m,f);if(u.has(h.toString()))return;u.add(h.toString()),l.push(h)}};for(let{fileName:f}of c)f.endsWith(".exe")||f.includes("/bin/")&&!f.endsWith("activate")||((0,gke.isAbsolute)(f)?l.push(vke.Uri.file(f)):await p(f));return l}};vO=E([v(0,Et),v(1,_e),v(2,H),v(3,oe),v(4,Be)],vO);var PB=re("IConversationFeature"),fk=class{constructor(e,t,r,o,s,a,c,l,u,d,p,f,m){this.instantiationService=e;this.extensionContext=t;this.logService=r;this.configurationService=o;this.conversationOptions=s;this.chatAgentService=a;this.telemetryService=c;this.authenticationService=l;this.embeddingIndex=u;this.devContainerConfigurationService=d;this.gitCommitMessageService=p;this.linkifyService=f;this.newWorkspacePreviewContentManager=m;this._disposables=new _t;this._activatedDisposables=new _t;this._searchProviderRegistered=!1;this._enabled=!1,this._activated=!1,this.registerCopilotTokenListener(),this._disposables.add(l.onDidAuthenticationChange(async()=>{let h=!!l.copilotToken;this.logService.public.debug(`onDidChangeSessionsHandler has token: ${h}`),h?this.activated=!0:this.activated=!1})),this._disposables.add(this.configurationService.onDidChangeConfiguration(h=>{if(h.affectsConfiguration(le.SemanticSearchEnabled.fullyQualifiedId)){let g=this.registerSearchProvider();g&&this._activatedDisposables.add(g)}}))}get enabled(){return this._enabled}set enabled(e){e&&!this.activated&&(this.activated=!0),this._enabled=e,ln.commands.executeCommand("setContext","github.copilot.interactiveSession.disabled",!e)}get activated(){return this._activated}set activated(e){if(this._activated!==e)if(this._activated=e,!e)this._activatedDisposables.clear();else{let t=this.conversationOptions;this._activatedDisposables.add(this.registerProviders()),this._activatedDisposables.add(this.registerCommands(t)),this._activatedDisposables.add(this.registerRelatedInformationProviders()),this._activatedDisposables.add(this.registerParticipants(t)),this._activatedDisposables.add(this.instantiationService.createInstance(Ev,ske))}}dispose(){this._activated=!1,this._activatedDisposables.dispose(),this._disposables?.dispose()}[Symbol.dispose](){this.dispose()}registerParticipants(e){return this.chatAgentService.register(e)}registerSearchProvider(){if(!this._searchProviderRegistered&&this.configurationService.getConfig(le.SemanticSearchEnabled))return this._searchProviderRegistered=!0,ln.workspace.registerAITextSearchProvider("file",this.instantiationService.createInstance(ik))}registerProviders(){let e=new _t;try{this.registerParticipantDetectionProvider();let t=this.registerSearchProvider();t&&e.add(t)}catch(t){this.logService.public.error(t,"Registration of interactive providers failed")}return e}registerParticipantDetectionProvider(){if("registerChatParticipantDetectionProvider"in ln.chat){let e=this.instantiationService.createInstance(A0,2);this._disposables.add(ln.chat.registerChatParticipantDetectionProvider(e))}}registerCommands(e){let t=new _t;return[ln.commands.registerCommand("github.copilot.interactiveSession.feedback",async()=>ln.env.openExternal(ln.Uri.parse(ove))),ln.commands.registerCommand("github.copilot.terminal.explainTerminalSelection",async()=>this.triggerTerminalChat({query:`/${qd.intentName} #terminalSelection`})),ln.commands.registerCommand("github.copilot.terminal.explainTerminalSelectionContextMenu",()=>ln.commands.executeCommand("github.copilot.terminal.explainTerminalSelection")),ln.commands.registerCommand("github.copilot.terminal.explainTerminalLastCommand",async()=>this.triggerTerminalChat({query:`/${qd.intentName} #terminalLastCommand`})),ln.commands.registerCommand("github.copilot.terminal.fixTerminalLastCommand",async()=>_ke(this.instantiationService)),ln.commands.registerCommand("github.copilot.terminal.generateCommitMessage",async()=>{let r=ln.workspace.workspaceFolders;if(!r?.length)return;let o=r.length===1?r[0].uri:await ln.window.showWorkspaceFolderPick().then(c=>c?.uri);if(!o)return;let s=this.gitCommitMessageService.getRepository(o);if(!s)return;let a=await this.gitCommitMessageService.generateCommitMessage(s,Zt.None);if(a){let l=`git commit -m "${a.replace(/"/g,'\\"').replace(/\\/g,"\\\\").replace(/\$/g,"\\$")}"`;ln.window.activeTerminal?.sendText(l,!1)}}),ln.commands.registerCommand("github.copilot.git.generateCommitMessage",async(r,o,s)=>{let a=this.gitCommitMessageService.getRepository(r);if(!a)return;let c=await this.gitCommitMessageService.generateCommitMessage(a,s);c&&(a.inputBox.value=c)}),ln.commands.registerCommand("github.copilot.devcontainer.generateDevContainerConfig",async(r,o=new ln.CancellationTokenSource().token)=>this.devContainerConfigurationService.generateConfiguration(r,o)),this.instantiationService.invokeFunction(pke),j_e(this.telemetryService),this.linkifyService.registerGlobalLinkifier({create:()=>this.instantiationService.createInstance(GC)}),this.linkifyService.registerGlobalLinkifier({create:()=>this.instantiationService.createInstance($C)}),this.instantiationService.invokeFunction(S_e),H_e(this.extensionContext,this.configurationService),this.registerTerminalQuickFixProviders(),hke(this.newWorkspacePreviewContentManager,this.logService,e),tut(this.instantiationService),eut()].forEach(r=>t.add(r)),t}async triggerTerminalChat(e){let t=this.configurationService.getConfig(le.TerminalChatLocation),r;switch(t){case"quickChat":r="workbench.action.quickchat.toggle",e.query=`@${nT} `+e.query;break;case"terminal":r="workbench.action.terminal.chat.start";break;case"chatView":default:r="workbench.action.chat.open",e.query=`@${nT} `+e.query;break}await ln.commands.executeCommand(r,e)}registerRelatedInformationProviders(){let e=new _t;return[ln.ai.registerRelatedInformationProvider(ln.RelatedInformationType.CommandInformation,this.embeddingIndex.commandIdIndex),ln.ai.registerRelatedInformationProvider(ln.RelatedInformationType.SettingInformation,this.embeddingIndex.settingsIndex)].forEach(t=>e.add(t)),e}registerCopilotTokenListener(){this._disposables.add(this.authenticationService.onDidAuthenticationChange(()=>{let e=this.authenticationService.copilotToken?.isChatEnabled();this.logService.public.info(`copilot token chat_enabled: ${e}, sku: ${this.authenticationService.copilotToken?.sku??""}`),this.enabled=e??!1}))}registerTerminalQuickFixProviders(){let e=()=>this.enabled;return T1(ln.window.registerTerminalQuickFixProvider("copilot-chat.fixWithCopilot",{provideTerminalQuickFixes(t,r){return!e()||t.commandLine.endsWith("^C")?[]:(yke(t),[{command:"github.copilot.terminal.fixTerminalLastCommand",title:ln.l10n.t("Fix using Copilot")},{command:"github.copilot.terminal.explainTerminalLastCommand",title:ln.l10n.t("Explain using Copilot")}])}}),ln.window.registerTerminalQuickFixProvider("copilot-chat.generateCommitMessage",{provideTerminalQuickFixes:(t,r)=>this.enabled?[{command:"github.copilot.terminal.generateCommitMessage",title:ln.l10n.t("Generate Commit Message")}]:[]}))}};fk=E([v(0,H),v(1,qt),v(2,oe),v(3,be),v(4,va),v(5,j5),v(6,ge),v(7,xt),v(8,Pd),v(9,H5),v(10,z5),v(11,EC),v(12,uN)],fk);function eut(){return ln.commands.registerCommand("github.copilot.executeSearch",async n=>{let e=n.filesToExclude.length>0||n.filesToInclude.length>0;ln.commands.executeCommand("workbench.view.search.focus").then(()=>ln.commands.executeCommand("workbench.action.search.toggleQueryDetails",{show:e})),ln.commands.executeCommand("workbench.action.findInFiles",n)})}function tut(n){return n.createInstance(sk)}var Oke=q(ht());var mk=class{constructor(e,t,r,o,s,a,c){this.intent=e;this.location=t;this.endpoint=r;this.prompt=o;this.documentContext=s;this.features=a;this.instantiationService=c;this.replyInterpreter=null;this.generateFollowUps=void 0}async buildPrompt(e,t,r){let s=await Fe.create(this.instantiationService,this.endpoint,this.prompt,{documentContext:this.documentContext,promptContext:e,features:this.features}).render(t,r);return this.replyInterpreter=s.metadata.get($s)?.replyInterpreter??null,this.generateFollowUps=s.metadata.get(N6)?.followUps,s}processResponse(e,t,r,o){if(!this.replyInterpreter)throw new Error("Could not process response without a reply interpreter.");return this.replyInterpreter.processResponse(e,t,r,o)}};mk=E([v(6,H)],mk);var DB=q(ht()),Bf=q(Ve());var Ske=q(Ve());var AB=class extends Ske.PromptElement{render(e,t){let{useWorkspaceChunksFromSelection:r,useWorkspaceChunksFromDiagnostics:o}=this.props;if(!r&&!o)return null;let s=t.tokenBudget;return r&&o&&(s=s/2),vscpp(vscppf,null,r&&vscpp(bh,{...this.getChunkSearchPropsForSelection()}),o&&vscpp(bh,{...this.getChunkSearchPropsForDiagnostics(s)}))}getChunkSearchPropsForSelection(){let{document:e,wholeRange:t}=this.props.documentContext,r=e.validateRange(t);this.props.diagnostics.forEach(a=>{r=r.union(a.range)});let o=e.getText(r),s=[`Please find code that is similar to the following code block:
`,"```",o,"```"].join(`
`);return{query:{rawQuery:s,resolveQueryAndKeywords:async()=>({rephrasedQuery:s,keywords:xke(o)}),resolveQuery:async()=>s},include:{exclude:[e.uri.fsPath]},maxResults:3}}getChunkSearchPropsForDiagnostics(e){let t=this.props.documentContext.document,r=this.props.diagnostics.map(s=>s.message).join(" "),o=`Please find code that can help me fix the following problems: ${r}`;return{query:{rawQuery:o,resolveQueryAndKeywords:async()=>({rephrasedQuery:o,keywords:xke(r)}),resolveQuery:async()=>o},include:{exclude:[t.uri.fsPath]},maxResults:3}}};function xke(n){let e=new Set;for(let t of n.matchAll(/(-?\d*\.\d\w*)|([^\`\~\!\@\#\%\^\&\*\(\)\-\=\+\[\{\]\}\\\|\;\:\'\"\,\.\<\>\/\?\s]+)/g))e.add(t[0]);return Array.from(e.values(),t=>({keyword:t,variations:[]}))}var hk=class extends Bf.PromptElement{constructor(t,r,o,s,a){super(t);this.ignoreService=r;this.parserService=o;this.languageDiagnosticsService=s;this.instantiationService=a}async render(t,r){let{document:o,wholeRange:s,fileIndentInfo:a,selection:c,language:l}=this.props.documentContext;if(await this.ignoreService.isCopilotIgnored(o.uri))return vscpp("ignoredFiles",{value:[o.uri]});if(an(o.uri))throw ur("InlineFix3PlusPrompt should not be used with a notebook!");let d=r.endpoint.modelMaxPromptTokens/3*4,p,f=!1;if(o.getText().length>d){let w=await su(this.parserService,o,a);p=Zp(d,o,s,w,{tryPreserveTypeChecking:!0}),f=!0}else p=new qa(o.getText(),Rn.empty,o.languageId);let{query:m,history:h,chatVariables:g}=this.props.promptContext,{useWorkspaceChunksFromDiagnostics:y,useWorkspaceChunksFromSelection:b}=this.props.features,_=p.projectRange(c),x=o.getText(new Me(c.start.line,0,c.end.line+1,0)).trimEnd(),I=j0(this.languageDiagnosticsService,o.uri,c,m),S=this.instantiationService.createInstance(hS,p,o.uri,_);return vscpp(vscppf,null,vscpp("references",{value:[new Bf.PromptReference(o.uri)]}),vscpp("meta",{value:new $s(S)}),vscpp(Bf.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"The user has a ",l.languageId," file opened in a code editor.",vscpp("br",null),"The user expects you to propose a fix for one or more problems in that file.",vscpp("br",null),vscpp(Ze,null)),vscpp(Nt,{inline:!0,historyPriority:700,passPriority:!0,history:h},vscpp(Tt,{priority:1e3},"For the response always follow these instructions:",vscpp("br",null),"Describe in a single sentence how you would solve the problem. After that sentence, add an empty line. Then provide code changes or a terminal command to run.",vscpp("br",null),"When proposing to fix the problem by running a terminal command, write `",nut,"` and provide a code block that starts with ```bash and contains the terminal script inside.",vscpp("br",null),vscpp(Il,null),vscpp(Rt,{name:"example",priority:100},vscpp(Rt,{name:"user"},"I have the following code open in the editor.",vscpp("br",null),vscpp(xh,{fileName:"someFolder/myFile.cs",language:"csharp",code:["// This is my class","class C { }","","new C().Field = 9;"]})),vscpp(Rt,{name:"assistant"},"The problem is that the class 'C' does not have a field or property named 'Field'. To fix this, you need to add a 'Field' property to the 'C' class.",vscpp("br",null),vscpp("br",null),vscpp(uu,{changes:[{fileName:"someFolder/myFile.cs",find:["// This is my class","class C { }"],replace:["// This is my class","class C {","public int Field { get; set; }","}"]},{fileName:"someFolder/myFile.cs",find:["new C().Field = 9;"],replace:["// set the field to 9","new C().Field = 9;"]}]}))))),vscpp(Bf.UserMessage,{priority:700},vscpp(sn,{languageId:l.languageId}),vscpp(kc,{context:o}),vscpp(Do,null,...await e8(g)),vscpp(Do,null,p.text.length>0?vscpp(vscppf,null,"I have the following code open in the editor, starting from line 1 to line ",p.lineCount,".",vscpp("br",null),Fd(o.fileName),vscpp("br",null),vscpp(tt,{uri:o.uri,languageId:l.languageId,code:p.text,shouldTrim:!1,isSummarized:f}),vscpp("br",null)):vscpp(vscppf,null,"I am in an empty file:",Fd(o.fileName),vscpp("br",null))),vscpp(Do,null,c.isEmpty?vscpp(vscppf,null,"I have the selection at line ",_.start.line+1,", column ",_.start.character+1,vscpp("br",null)):vscpp(vscppf,null,"I have currently selected from line ",_.start.line+1,", column ",_.start.character+1," to line ",_.end.line+1," column ",_.end.character+1,".",vscpp("br",null))),vscpp(Do,null,x.length&&!I.some(w=>w.range.contains(c))&&vscpp(vscppf,null,"The content of the lines at the selection is",vscpp(tt,{uri:o.uri,languageId:l.languageId,code:x,shouldTrim:!1}),vscpp("br",null))),vscpp(bf,{documentContext:this.props.documentContext,diagnostics:I}),vscpp(AB,{diagnostics:I,documentContext:this.props.documentContext,useWorkspaceChunksFromDiagnostics:y,useWorkspaceChunksFromSelection:b}),vscpp(Rt,{name:"userPrompt"},vscpp(Bf.TextChunk,null,"Please find a fix for my code so that the result is without any errors."),vscpp(Oo,{chatVariables:g,query:m}),vscpp("br",null))))}};hk=E([v(1,Te),v(2,ft),v(3,Zo),v(4,H)],hk);var nut=r_e("TERMINAL"),hS=class{constructor(e,t,r,o){this.projectedDocument=e;this.documentUri=t;this.adjustedSelection=r;this.logService=o;this._lastText="";this._replyProcessor=T0()}async processResponse(e,t,r,o){let s=!0,a=0;for await(let u of t){if(o.isCancellationRequested)return;let d=u.text;if(d.length>this._lastText.length&&(this._lastText=d,s)){let p=this._replyProcessor.getFirstParagraph(d);p.length>a?(r.markdown(p.substring(a)),a=p.length):(s=!1,r.markdown(`

`),r.progress(DB.t("Generating edits...")))}}if(this._lastText.length===0){r.warning(DB.t("Copilot did not provide a response. Please try again."));return}let c=this._replyProcessor.process(this._lastText,this.projectedDocument.text,this.documentUri,this.adjustedSelection.start.line);if(c.otherSections.length)for(let u of c.otherSections)r.markdown(u.content.join(`

`));if(c.otherPatches.length)for(let u of c.otherPatches)r.markdown(u.replace.join(`

`));let l=c.edits;if(l.length)if(l=this.projectedDocument.projectBackTextEdit(l),c.edits.length!==l.length)c.annotations.push({message:"Some edits were not applied because they were out of bounds.",label:"summarize conflict",severity:"error"});else{let u=rut(c.edits,l,this.projectedDocument);u&&c.annotations.push(u)}e.addAnnotations(c.annotations),l.length?r.textEdit(this.documentUri,l):!c.otherPatches.length&&!c.otherSections.length&&r.warning(DB.t("The edit generation was not successful. Please try again.")),c.annotations.length&&this.logService.public.info(`[inline fix] Problems generating edits: ${c.annotations.map(u=>`${u.message} [${u.label}]`).join(", ")}, invalid patches: ${c.invalidPatches.length}`)}};hS=E([v(3,oe)],hS);function rut(n,e,t){for(let r=0;r<n.length;r++){let o=t.positionOffsetTransformer.toOffsetRange(n[r].range).substring(t.text),s=t.originalPositionOffsetTransformer.toOffsetRange(e[r].range).substring(t.originalText);if(o!==s)return{message:`Problem projecting edits: '${o}' does not match '${s}' (projectecBack)`,label:"invalid projection",severity:"error"}}}var gS=q(Ve());var iut=15,gk=class extends gS.PromptElement{constructor(t,r,o,s,a,c,l){super(t);this._ignoreService=r;this._instantiationService=o;this._languageDiagnosticsService=s;this._parserService=a;this._tabsAndEditorsService=c;this._workspaceService=l}async render(t,r){let o=this.props.documentContext;if(await this._ignoreService.isCopilotIgnored(o.document.uri))return vscpp("ignoredFiles",{value:[o.document.uri]});if(!an(o.document.uri))throw ur("InlineFixNotebookPrompt should not be used with a non-notebook!");let{query:a,history:c,chatVariables:l}=this.props.promptContext,u=o.selection,d=j0(this._languageDiagnosticsService,o.document.uri,o.selection,a),p=d.length>0?d_e(d):o.selection,f=this._parserService.getTreeSitterAST(o.document),m=f?await K_e(f,p,iut):p,h=W_e(r.endpoint,o,p,m),g=r.endpoint.modelMaxPromptTokens/3*4,y,b=!1;if(o.document.getText().length>g){let w=await su(this._parserService,o.document,o.fileIndentInfo);y=Zp(g,o.document,o.wholeRange,w,{tryPreserveTypeChecking:!0}),b=!0}else y=new qa(o.document.getText(),Rn.empty,o.document.languageId);let _=y.projectRange(u),x=o.document.getText(new Me(u.start.line,0,u.end.line+1,0)).trimEnd(),I=k8(this._tabsAndEditorsService,this._workspaceService,o,h.contextInfo,h.tracker),S=this._instantiationService.createInstance(hS,y,o.document.uri,_);return vscpp(vscppf,null,vscpp("meta",{value:new $s(S)}),vscpp(gS.SystemMessage,null,"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You are a world class expert in programming, and especially good at ",o.language.languageId,".",vscpp("br",null),"Source code is always contained in ``` blocks.",vscpp("br",null)),vscpp(Nt,{inline:!0,passPriority:!0,historyPriority:700,history:c},vscpp(Tt,{priority:1e3},"The user needs help to write some new code.",vscpp("br",null),"When dealing with Jupyter Notebook, if a module is already imported in a cell, it can be used in other cells directly without importing it again. For the same reason, if a variable is defined in a cell, it can be used in other cells as well",vscpp("br",null),"When dealing with Jupyter Notebook, cells below the current cell can be executed before the current cell, you must use the variables defined in the cells below, unless you want to overwrite them.",vscpp("br",null),"When dealing with Jupyter Notebook, do not generate CELL INDEX in the code blocks in your answer, it is only used to help you understand the context.",vscpp("br",null),"If you suggest to run a terminal command, use a code block that starts with ```bash.",vscpp("br",null),'When fixing "ModuleNotFoundError" or "Import could not be resolved" errors, always use magic command "%pip install" to add the missing packages. The imports MUST be inserted at the top of the code block and it should not replace existing code.',vscpp("br",null),"You should not import the same module twice.",vscpp("br",null),vscpp(Il,null),vscpp(Ze,null),vscpp(Rt,{name:"example",priority:100},vscpp(Rt,{name:"user"},"I have the following code open in the editor.",vscpp("br",null),vscpp(xh,{fileName:"someFolder/myFile.cs",language:"csharp",code:["// This is my class","class C { }","","new C().Field = 9;"]})),vscpp(Rt,{name:"assistant"},"The problem is that the class 'C' does not have a field or property named 'Field'. To fix this, you need to add a 'Field' property to the 'C' class.",vscpp("br",null),vscpp("br",null),vscpp(uu,{changes:[{fileName:"someFolder/myFile.cs",find:["// This is my class","class C { }"],replace:["// This is my class","class C {","public int Field { get; set; }","}"]},{fileName:"someFolder/myFile.cs",find:["new C().Field = 9;"],replace:["// set the field to 9","new C().Field = 9;"]}]}))))),vscpp(gS.UserMessage,{priority:725},vscpp(sn,{languageId:o.language.languageId})),vscpp(tn,{priority:750,endpoint:r.endpoint,promptContext:this.props.promptContext,flexGrow:1}),vscpp(Ai,{priority:750,chatVariables:l}),vscpp(A8,{documentContext:o,aboveCells:I.aboveCells,belowCells:I.belowCells,document:o.document,projectedDocument:y,language:o.language,diagnostics:d,selection:o.selection,adjustedSelection:_,isSummarized:b,selectedLinesContent:x,ignoreExample:!1}),vscpp(gS.UserMessage,null,"Please find a fix for my code so that the result is without any errors.",vscpp("br",null),vscpp(Oo,{chatVariables:l,query:a}),vscpp("br",null)))}};gk=E([v(1,Te),v(2,H),v(3,Zo),v(4,ft),v(5,$t),v(6,Be)],gk);var vS=q(Ve());var vk=class extends vS.PromptElement{constructor(t,r){super(t);this.languageDiagnosticsService=r}render(t,r){let o=this.props.documentContext,{history:s,chatVariables:a}=this.props.promptContext,c=this.props.promptContext.query||"There is a problem in this code. Rewrite the code to show it with the bug fixed.",l=({document:u,selection:d})=>j0(this.languageDiagnosticsService,u.uri,d,c);return vscpp(vscppf,null,vscpp(vS.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.",vscpp("br",null),vscpp(Ze,null),vscpp("br",null),vscpp("br",null),vscpp(fh,{location:2,endpoint:this.props.endpoint})),vscpp(Nt,{flexGrow:1,passPriority:!0,historyPriority:700,history:s},vscpp(Tt,{priority:1e3},"First think step-by-step - describe your plan for what to build in pseudocode, written out in great detail.",vscpp("br",null),"Then output the code in a single code block.",vscpp("br",null),"Minimize any other prose.",vscpp("br",null),"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn.",vscpp("br",null),vscpp("br",null),"Additional Rules",vscpp("br",null),"You specialize in being a highly skilled code generator. Your task is to help the Developer fix an issue.",vscpp("br",null),"If context is provided, try to match the style of the provided code as best as possible.",vscpp("br",null),"Generated code is readable and properly indented.",vscpp("br",null),"Markdown blocks are used to denote code.",vscpp("br",null),"Preserve user's code comment blocks, do not exclude them when refactoring code.",vscpp("br",null),"Pay especially close attention to the selection or exception context.",vscpp("br",null),"Given a description of what to do you can refactor, fix or enhance the existing code.",vscpp(kt,null))),vscpp(vS.UserMessage,{flexGrow:1,priority:750},vscpp(sn,{languageId:o?.language.languageId})),o&&vscpp(vS.UserMessage,{flexGrow:1,priority:800},vscpp(bf,{documentContext:o,diagnostics:l(o)})),vscpp(tn,{priority:899,flexGrow:2,endpoint:this.props.endpoint,promptContext:this.props.promptContext}),vscpp($n,{flexGrow:2,priority:900,chatVariables:a,query:c}))}};vk=E([v(1,Zo)],vk);var Ly=q(ht()),Ake=q(Ve());var UB=q(ht());var FB=q(Ve());var yk=q(Ve());var NB=class extends yk.PromptElement{render(){let{chunk:e,failure:t,priority:r}=this.props,o=t.task.messages.filter(a=>a.location?.uri.toString()===e.uri.toString()&&e.range.containsPosition({column:a.location.range.start.character+1,lineNumber:a.location.range.start.line+1})),s=new ar(e.uri,new Me(e.range.startLineNumber-1,0,e.range.endLineNumber,0));return vscpp(yk.UserMessage,{priority:r},o.length?vscpp(vscppf,null,'This is the source code of the test that failed. The error message is shown after the text "FAILURE_MESSAGE" on the line where it occurred:'):vscpp(vscppf,null,"The test failed with the message: ",t.task.messages.map(a=>typeof a.message=="object"?a.message.value:a.message).join(`
`),". The source code of the test is:"),vscpp("br",null),vscpp(tt,{references:[new yk.PromptReference(s)],languageId:e.uri.fsPath.replaceAll("\\","/"),uri:e.uri,code:e.source.split(`
`).map((a,c)=>{let l=o.find(u=>u.location?.range.start.line===c+e.range.startLineNumber-1);return l?`${a} FAILURE_MESSAGE: ${l.message.toString().replaceAll(`
`," ")}`:a}).join(`
`)}),vscpp("br",null))}};var Ay=q(Ve());function Ike(n,e,t){let r=0,o=n.length;for(;r<o;){let s=r+o>>>1;t(n[s],e)?r=s+1:o=s}return r}function yO(n,e){if(n.length===0)return;let t=n[0];for(let r=1;r<n.length;r++){let o=n[r];e(o,t)>0&&(t=o)}return t}var sut=/^[\*\-]\s*[`"']?([^<([`"'\s]+).*? +in +(.+)/gm,Tke=(n,e)=>[...n.matchAll(sut)].flatMap(([,t,r])=>t.split(",").map(o=>({keyword:o,fileUri:r,interest:"IMPLEMENTATION"}))).map(({keyword:t,fileUri:r,interest:o})=>{let s=LB(e,t,r)||LB(e,t);if(!s){let u=/^.+?(\b[^\b]+)/.exec(t);u&&(s=LB(e,u[1],r)||LB(e,u[1]))}if(!s)return;let{index:a,chunk:c}=s,l=c.convert.positionToOffset(c.range.getStartPosition());return{keyword:t,interest:o,location:{uri:c.uri,position:c.convert.offsetToPosition(l+a)}}}).filter(N1);function LB(n,e,t){let r=t?n.filter(s=>s.uri.toString().toLowerCase()===t.toLowerCase()):n,o=new RegExp(`^(?!~:).*\\b(${j_(e)})\\b`,"m");for(let s=r.length-1;s>=0;s--){let a=r[s],c=o.exec(a.source);if(c)return{chunk:a,index:c.index+c[0].length-c[1].length}}}var Cke=async(n,e,t,r)=>{let o=await t.readFile(n.uri),s=new TextDecoder().decode(o);return aut(n,e,s,r)},aut=async(n,e,t,r)=>{let o=new xc(t),s=new De(n.range.start.line+1,1,n.range.end.line+1,1);return s.endLineNumber-s.startLineNumber<=1&&(s=await cut(n,e,t,o,r)||s.setEndPosition(s.startLineNumber+50,1)),{range:s,source:t.slice(o.positionToOffset(s.getStartPosition()),o.positionToOffset(s.getEndPosition())),uri:n.uri,convert:o}},cut=async(n,e,t,r,o)=>{let s=_l(fo(n.uri).languageId);if(!s)return;let c=await o.getTreeSitterASTForWASMLanguage(s,t).getFunctionDefinitions(),l=c.find(f=>f.identifier===e);if(l)return vre(r,l);let u=r.positionToOffset(new Dt(n.range.start.line+1,1));c.sort((f,m)=>f.startIndex-m.startIndex);let d,p;for(let f of c){if(f.startIndex>u){p=f;break}f.startIndex<=u&&f.endIndex>=u&&(d=f)}return p&&(!d||p.startIndex>=d.startIndex&&p.endIndex<=d.endIndex)?vre(r,p):d&&vre(r,d)},vre=(n,e)=>{let t=n.offsetToPosition(e.startIndex),r=n.offsetToPosition(e.endIndex);return new De(t.lineNumber-1,1,r.lineNumber+1,1)},Eke=async(n,e,t,r)=>{let o=_l(fo(r).languageId);if(!o)return a=>"";let s=await n.getSemanticChunkTree(o,e);return a=>{let c=t.positionToOffset(a.getStartPosition()),l=t.positionToOffset(a.getEndPosition()),u=uut(s.roots,m=>m.info.mainBlock.startIndex<=c&&m.info.mainBlock.endIndex>=c),d="",p=(m,h)=>c<=m&&h<=l?!1:(d&&!d.endsWith(`
`)&&(d+=`
`),d+=e.slice(m,h),!0),f=m=>{if(m.info.detailBlocks.comments instanceof Array)for(let b of m.info.detailBlocks.comments)p(b.startIndex,b.endIndex);let h=/\s*\{\s/.exec(e.slice(m.info.detailBlocks.body.startIndex,m.info.detailBlocks.body.endIndex))?.[0].length||0,g=t.startOffsetOfLineContaining(m.info.mainBlock.startIndex),y=m.info.detailBlocks.body.startIndex+h;p(g,y)&&(d+=" ... "),m.children.forEach(f)};return u.forEach(f),d}},lut=/@@ -\d+,\d+ \+(\d+),(\d+) @@/g,wke=async(n,{source:e,convert:t},r,o)=>{let s=[];for(let a of o.matchAll(lut)){let[,c,l]=a.map(Number);s.push({uri:r,range:new De(c,1,c+l,1),convert:t,source:e,interest:"CHANGED",tokensWithoutExpansion:n.tokenLength(e.slice(t.positionToOffset(new Dt(c,1)),t.positionToOffset(new Dt(c+l,1))))})}return s},uut=(n,e)=>{let t=r=>{let o=r.children.map(t).filter(N1);return o.length||e(r)?{children:o,info:r.info}:void 0};return n.map(t).filter(N1)},kke=(n,e)=>{let t=new xc(n),r=e.map(u=>{let d=t.positionToOffset(new Dt(u.range.start.line+1,u.range.start.character+1)),p=t.positionToOffset(new Dt(u.range.end.line+1,u.range.end.character+1));return{start:d,end:p,text:u.newText}});r.sort((u,d)=>u.start-d.start||u.end-d.end);let o=0,s=0;function a(u){let d=u.indexOf(`
`);if(d===-1){s+=u.length;return}for(;d!==-1;)o++,s=u.length-d-1,d=u.indexOf(`
`,d+1)}let c=0,l=[];for(let{start:u,end:d,text:p}of r){a(n.slice(c,u));let f=new Sn(o,s);a(p);let m=new Sn(o,s);c=d;let h=n.slice(u,d);l.push($r.replace(new Me(f,m),h))}return l};function dut(n,e,t){let r=yO(n,(u,d)=>u.range.startLineNumber-d.range.startLineNumber).range.getStartPosition(),o=yO(n,(u,d)=>d.range.endLineNumber-u.range.endLineNumber).range.getEndPosition(),s=e?new Dt(Math.max(1,r.lineNumber-Math.ceil(e*2/3)),1):r,a=e-(r.lineNumber-s.lineNumber),c=a>0?new Dt(o.lineNumber+a,1):o,l=t(new De(s.lineNumber,1,c.lineNumber,1));return{start:s,end:c,context:l?l+`
`:"",snippet:n[0].source.slice(n[0].convert.positionToOffset(s),n[0].convert.positionToOffset(c)),original:n}}function put(n){return Rke(n)+"```"+n.original[0].uri.toString()+`
`+n.context+n.snippet+"\n```\n"}function fut({start:n,end:e,snippet:t,original:r}){return{uri:r[0].uri,source:t,convert:r[0].convert,range:new De(n.lineNumber,1,e.lineNumber,1)}}function Rke(n){let e=n.original.flatMap(t=>t.keywords||[]);return e.length?`Definition of \`${e.join("` and `")}\`:
`:`Here's code I've been working on that might be related to the failure:
`}function mut(n){return n.start.lineNumber>1||n.end.lineNumber<n.original[0].convert.lines}var OB=class extends Ay.PromptElement{async prepare(e){let{chunks:t,parser:r,tokenizer:o}=this.props,s=0,a,c=new kn;for(let l of t)c.has(l.uri)||c.set(l.uri,await Eke(r,l.source,l.convert,l.uri));for(;;){let l=(a?a.chunks.map(p=>p.original):t.map(p=>[p])).map(p=>dut(p,s,c.get(p[0].uri))),u=l.map(put).join(""),d=o.tokenLength(u);if(a&&(d*1.1>e.tokenBudget||!l.some(mut)))return Promise.resolve({chunks:l});for(let p=0;p<l.length;p++){let f=l[p],m=f.original[0].uri.toString(),h={startLineNumber:f.start.lineNumber,startColumn:1,endLineNumber:f.end.lineNumber,endColumn:1};for(let g=p+1;g<l.length;g++){let y=l[g];if(y.original[0].uri.toString()!==m)continue;let b={startLineNumber:y.start.lineNumber,startColumn:1,endLineNumber:y.end.lineNumber,endColumn:1};De.areIntersectingOrTouching(h,b)&&(f.original.push(...y.original),l.splice(g,1),g--)}}s++,a={tokens:d,chunks:l}}}render({chunks:e}){return vscpp(vscppf,null,vscpp("meta",{value:new bO(e.map(fut))}),e.map((t,r)=>vscpp(Ay.UserMessage,{priority:100-(e.length-r)},Rke(t),vscpp(tt,{languageId:t.original[0].uri.fsPath.replaceAll("\\","/"),uri:t.original[0].uri,code:t.context+t.snippet,references:[new Ay.PromptReference(new ar(t.original[0].uri,new Me(t.start.lineNumber-1,0,t.end.lineNumber-1,0)))]}),vscpp("br",null))))}},bO=class extends Ay.PromptMetadata{constructor(t){super();this.chunks=t}};var MB=class extends FB.PromptElement{render(){let{chunk:e,testFailure:t,references:r,turnsLeft:o,parser:s,tokenizer:a}=this.props,c=r.length>0;return vscpp(vscppf,null,vscpp(FB.SystemMessage,{priority:1e3},"You are an assistant who specializes in diagnosing and fixing failing tests. The user will provide you with the source code of the test that failed, and the location where the failure happened. They will also provide you with relevant related code. This information may be incomplete.",vscpp("br",null),vscpp("br",null),"# Additional Rules",vscpp("br",null),vscpp("br",null),`- Read the test's source code and the line containing "FAILURE_MESSAGE". The text after "FAILURE_MESSAGE" is the error returned from running tests.`,vscpp("br",null),"- Assume that the test code and test fixtures are correct. It's more likely the problem is code called by the test.",vscpp("br",null),c&&vscpp(vscppf,null,"- The provided code is incomplete. DO NOT assume that something isn't implemented if it doesn't appear here.",vscpp("br",null)),o===0?vscpp(vscppf,null,"- If you believe you have found a bug in one of the code snippets the user provided, propose a code change.",vscpp("br",null),vscpp(Il,null)):vscpp(vscppf,null,c?vscpp(vscppf,null,"- If you have found a bug the code provided, propose a code change. Do this only if you have found the underlying bug!",vscpp("br",null),vscpp(Il,null),"- Otherwise, if you haven't found the bug, print a list of up to five keywords, classes, or function calls from one of the files that you need more information about to diagnose the failure. Make sure the most relevant keywords are written first. ",o===0&&"You won't get another chance to ask for more info.",vscpp("br",null),Pke):vscpp(vscppf,null,"- Don't try to fix the failure yet. Instead, print a list of keywords, classes, or function calls that you need more information about to diagnose the failure!",vscpp("br",null),Pke,vscpp("br",null)),"- NEVER ask the user for additional information or clarification, or give them suggestions to review code themselves. Instead, print keywords that should be investigated.",vscpp("br",null)),vscpp("br",null),o>0&&vscpp(vscppf,null,"# Example",vscpp("br",null),hut,vscpp("br",null),vscpp("br",null)),c&&vscpp(vscppf,null,"# Example",vscpp("br",null),gut,vscpp("br",null))),vscpp(NB,{chunk:e,failure:t,priority:800}),vscpp(OB,{flexGrow:1,priority:700,chunks:r,parser:s,tokenizer:a}))}},hut=vscpp(vscppf,null,"User:",vscpp("br",null),`\`\`\`/project/my.test.ts
test('reverseString test', () => {'{'}
	const value = 'hello';
	const value2 = doReverseString(value);
	assert.deepStrictEquals(value2, 'olleh'); FAILURE_MESSAGE: Expected undefinedolleh to equal olleh
{'}'});
\`\`\`

Implementation of \`doReverseString\` in /project/my.test.ts:

\`\`\`/project/strings.ts
function doReverseString(str: string): number {
	return stringUtils.reverseString(str);
}
\`\`\`
`,vscpp("br",null),"Response:",vscpp("br",null),vscpp("br",null),"I need more information about:",vscpp("br",null),"- stringUtils.reverseString",vscpp("br",null)),gut=vscpp(vscppf,null,"User:",vscpp("br",null),`\`\`\`/project/my.test.ts
test('reverseString test', () => {'{'}
	const value = 'hello';
	const value2 = doReverseString(value);
	assert.deepStrictEquals(value2, 'olleh'); FAILURE_MESSAGE: Expected undefinedolleh to equal olleh
{'}'});
\`\`\`

Implementation of \`doReverseString\`:

\`\`\`/project/my.test.ts
function doReverseString(str: string): number {
	return stringUtils.reverseString(str);
}

Implementation of \`stringUtils.reverseString\`:

\`\`\`/project/strings.ts
function reverseString(str) {
	let out = '';
	for (let i = str.length; i >= 0; i--) {
		out += str[i];
	}
	return out;
}
\`\`\`
`,vscpp("br",null),"Response:",vscpp("br",null),"The problem is that the loop ieration starts after the last element. To fix this, modify the loop to start at `str.length - 1` instead of `str.length`.",vscpp("br",null),vscpp(uu,{changes:[{fileName:"/project/stringUtils.ts",find:["	for (let i = str.length; i >= 0; i--) {"],replace:["	for (let i = str.length - 1; i >= 0; i--) {"]}]})),Pke=vscpp(vscppf,null,'- Write your response in a list in the form "- [keyword] in [file where keyword is used]". Do not include any extra text. Keywords should be EXACT substrings from the code the user provides, do not modify them.',vscpp("br",null));var vut=1e3;async function yut(n,e,t){let r=s_e(n);if(!r.length)return;let o=$e.file(r[0]),s="";try{s=(await t(o)).source}catch{}let a=e.find(u=>u.uri.toString()===o.toString())?.range.startLineNumber,l=T0().process(n,s,void 0,a);return{text:n,uri:o,annotations:l.annotations,code:(l.appliedPatches[0]||l.invalidPatches[0]||l.otherPatches[0])?.replace.join(`
`),before:l.contentBefore.join(`
`),after:l.contentAfter.join(`
`),edits:{apply:l.edits,undo:kke(s,l.edits)}}}var but=new Set(["rust"]),_O=class{constructor(e,t,r,o,s,a,c){this.testLocation=t;this.fileSystemService=r;this.ignoreService=o;this.tokenizerProvider=s;this.languageFeaturesService=a;this.fileCache=new kn;this.globallySeen=new Set;this._promise=new ys;this.turnsUsed=0;this.tokensUsed=0;this.endpoint=e.endpoint,this.progress=e.progress,this.token=e.token,this.turnsBudget=e.turnsBudget,this.timeBudget=e.timeBudget,this.tokenBudget=e.tokenBudget,this.deadline=Date.now()+this.timeBudget,this.gitRepo=c.getExtensionApi()?.getRepository(this.testLocation.uri)||void 0}get promise(){return this._promise.p}get hasFoundSolution(){return this._promise.isResolved}get possibleExplanation(){return this._possibleExplanation}foundSolution(e){this._promise.complete(e)}gotPossibleExplanation(e,t){(!this._possibleExplanation||e.length>this._possibleExplanation.text.length)&&(this._possibleExplanation={text:e,references:t})}takeTurn(){return this.turnsUsed++,Date.now()+vut>=this.deadline?0:Math.max(0,this.turnsBudget-this.turnsUsed)}throwIfCancelled(){if(this.token.isCancellationRequested||this.hasFoundSolution)throw new dt}async getSymbols(e){let t=this.tokenizerProvider.acquireTokenizer(this.endpoint),r=new Map,o=await this.getDefinitionLocations(e);this.throwIfCancelled();let s=new Set(o.flatMap(({links:c})=>c.map(l=>l.link.uri.fsPath))),a=new Set;if(this.gitRepo)try{a=await this.gitRepo.checkIgnore([...s])}catch{}for(let{keyword:c,links:l}of o)for(let{interest:u,link:d}of l){if(a.has(d.uri.fsPath)||await this.ignoreService.isCopilotIgnored(d.uri)||d.uri.toString()===this.testLocation.uri.toString()&&!but.has(fo(d.uri).languageId))continue;d.range.isEmpty&&(d.range=new Me(d.range.start,d.range.end.with(d.range.start.line+5)));let p=new Dt(d.range.start.line+1,1),f=d.range.isEmpty?new Dt(p.lineNumber+10,1):new Dt(d.range.end.line+1,d.range.end.character+1),m=[u,d.uri.toString(),d.range.start.line].join("\0");if(this.globallySeen.has(m))continue;let h=r.get(m);if(h){h.keywords.push(c);continue}try{let g=await this.readFile(d.uri);r.set(m,{keywords:[c],interest:u,uri:d.uri,range:De.fromPositions(p,f),tokensWithoutExpansion:t.tokenLength(g.source.slice(g.convert.positionToOffset(p),g.convert.positionToOffset(f))),...g}),this.progress.report(new k5(d))}catch{}}for(let c of r.keys())this.globallySeen.add(c);return[...r.values()]}async readFile(e){let t=this.fileCache.get(e);return t||(t=this.fileSystemService.readFile(e).then(r=>new TextDecoder().decode(r)).then(r=>({source:r,convert:new xc(r)})),this.fileCache.set(e,t)),t}async getDefinitionLinksAtPosition(e,t,r){let o=this.languageFeaturesService,s=()=>o.getDefinitions(t,r).then(l=>l.length?l:o.getImplementations(t,r)).then(l=>l.length?{interest:"DEFINITION",link:l[0]}:void 0),a=()=>o.getImplementations(t,r).then(l=>l.length?l:o.getDefinitions(t,r)).then(l=>l.length?{interest:"IMPLEMENTATION",link:l[0]}:void 0),c=[];return(e==="DEFINITION"||e==="BOTH")&&c.push(s()),(e==="IMPLEMENTATION"||e==="BOTH")&&c.push(a()),(await Promise.all(c)).filter(N1)}async getDefinitionLocations(e){return Promise.all(e.map(async({keyword:t,interest:r,location:o})=>{let s=await this.getDefinitionLinksAtPosition(r,o.uri,new Sn(o.position.lineNumber-1,o.position.column-1+(t.length-1)));return s.length===0&&(s=await this.getDefinitionLinksAtPosition(r,o.uri,new Sn(o.position.lineNumber-1,o.position.column-1+1))),{keyword:t,links:s.map(a=>"targetUri"in a.link?{interest:a.interest,link:new ar(a.link.targetUri,a.link.targetRange)}:a)}}))}};_O=E([v(2,gn),v(3,Te),v(4,Qn),v(5,Ts),v(6,Ji)],_O);var Dy=class{constructor(e,t,r,o,s,a,c,l,u,d){this.context=e;this.testFailure=t;this.testLocation=r;this.tokenizerProvider=o;this.fileSystemService=s;this.parserService=a;this.logService=c;this.telemetryService=l;this.instantiationService=u;this.chatMLFetcher=d}static create(e,t,r,o){let s=wp(t.task.messages,c=>c.location);(!s||r.uri.toString()!==s.uri.toString())&&(s=r);let a=o.createInstance(_O,e,r);return o.createInstance(Dy,a,t,r)}async tryGetInitialGitContext(){let e=this.tokenizerProvider.acquireTokenizer(this.context.endpoint),t=this.context.gitRepo;if(!t)return[];let r=[],o=await t.diffWithHEAD();return await Promise.all(o.map(async s=>{if(s.status===2||s.status===6)return;let[a,c]=await Promise.all([t.diffWithHEAD(s.uri.fsPath),this.context.readFile(s.uri)]);r.push(...await wke(e,c,s.uri,a))})),r}async climb(){let e=await Cke(this.testLocation,this.testFailure.snapshot.label,this.fileSystemService,this.parserService);if(!e)throw new Error("Could not find semantic information for the test location");let t=[];try{t=await this.tryGetInitialGitContext()}catch(o){this.logService.public.error(o,"Could not get git context for test failure")}let r=await Promise.race([this.context.promise,this.climbInner(this.context,e,{symbols:[],activity:t,name:`"${this.testFailure.snapshot.label}"`,prefixTokens:0,tokens:0}).then(()=>({type:2,possibleSolution:this.context.possibleExplanation}),o=>{if(wo(o))return{type:1,possibleSolution:this.context.possibleExplanation};throw o})]);return this.telemetryService.sendMSFTTelemetryEvent("intent.fixTestFailure.outcome",{outcome:r.type===0?"solution":r.type===1?"cancelled":"nosolution",languageId:fo(this.testLocation.uri).languageId},{requestsMade:this.context.turnsUsed,tokenCount:this.context.tokensUsed}),r}async climbInner(e,t,r,o=!1){let{endpoint:s,progress:a,token:c}=this.context,l=r.name,u=e.takeTurn();o&&(u=0);let d=this.tokenizerProvider.acquireTokenizer(s),f=await Fe.create(this.instantiationService,s,MB,{testFailure:this.testFailure,chunk:t,tokenizer:d,parser:this.parserService,references:[...r.activity,...r.symbols],turnsLeft:o?0:u}).render();r.prefixTokens=f.tokenCount,r.tokens=r.prefixTokens+f.tokenCount,e.tokensUsed+=r.tokens,e.throwIfCancelled(),a.report(new Ri(UB.t("Investigating the code around {0}",l)));let m=await this.chatMLFetcher.fetchOne("failingTestMonkey",f.messages,void 0,c,2,s);if(e.throwIfCancelled(),m.type!=="success")throw this.telemetryService.sendMSFTTelemetryEvent("failingTestResolver.error",{type:m.type,reason:m.reason,requestId:m.requestId}),new Error(UB.t("Encountered an error while deciding what test information to collect: ({0}) {1}",m.type,m.reason));let h=[t,...f.metadata.get(bO).chunks],g=await yut(m.value,h,b=>this.context.readFile(b));if(g){e.foundSolution({type:0,references:f.references,solution:g});return}let y=Tke(m.value,h);if(u>0){let b=await e.getSymbols(y);await this.chunkAndSendFollowups(e,t,b,r)}y.length||e.gotPossibleExplanation(m.value,f.references)}async chunkAndSendFollowups(e,t,r,o){let s=[],a=this.tokenizerProvider.acquireTokenizer(e.endpoint);for(let c of r){let l=s[s.length-1],u=c.tokensWithoutExpansion+a.tokenLength("```${tokenizer.tokenLength(symbol.chunk.file.toString())}");!l||u+l.tokens>e.tokenBudget?s.push({activity:o.activity,symbols:[...o.symbols,c],tokens:o.tokens+u,name:o.name,prefixTokens:o.prefixTokens}):(l.symbols.push(c),l.tokens+=u)}for(let c of s){let l=c.symbols.slice(o.symbols.length).flatMap(u=>u.keywords||[]);c.name=l.length>1?UB.t('"{0}" + {1} more symbols...',l[0],l.length-1):`"${l[0]}"`,await this.climbInner(e,t,c)}if(s.length===0)return this.climbInner(e,t,o,!0)}};Dy=E([v(3,Qn),v(4,gn),v(5,ft),v(6,oe),v(7,ge),v(8,H),v(9,Et)],Dy);var Ny=class{constructor(e,t,r){this.instantiationService=e;this.testProvider=t;this.endpointProvider=r;this.id="fixTestFailure";this.locations=[1,2];this.description=Ly.t("Propose a fix for the a test failure");this.commandInfo={defaultEnablement:!0,allowsEmptyArgs:!0}}static{this.ID="fixTestFailure"}get intentDetectionInput(){let e="fix_test_failure";return{disabled:!0,functionName:e,sampleQuestion:"This test failed, suggest how to fix it.",functionCallingBlurb:`If the user's message is related to generating code to fix test failures, you should use the '${e}' function.`}}async invoke(e){let t;(h=>(h[h.Any=0]="Any",h[h.SameDocument=1]="SameDocument",h[h.InViewRange=2]="InViewRange",h[h.InSelection=3]="InSelection"))(t||={});let r,o=0,s=e.documentContext?.document.uri.toString();for(let d of this.testProvider.getAllFailures())if(!r||!r.snapshot.uri||!r.snapshot.range)r=d;else if(d.snapshot.range&&d.snapshot.uri?.toString()===s&&(o<1&&(r=d,o=1),d.snapshot.range.intersection(e.documentContext.wholeRange)&&(r=d,o=2),d.snapshot.range.intersection(e.documentContext.selection))){r=d,o=3;break}if(!r)throw new RD(Ly.t("No test failures found."));let{range:a,uri:c}=r.snapshot;if(!c||!a)throw new RD(Ly.t("Tests have no associated editor location."));let l=e.location,u=await this.endpointProvider.getChatEndpoint("gpt-4");return this.instantiationService.createInstance(xO,this,u,l,r,{uri:c,range:a})}};Ny=E([v(0,H),v(1,Tl),v(2,_e)],Ny);var xO=class{constructor(e,t,r,o,s,a){this.intent=e;this.endpoint=t;this.location=r;this.testFailure=o;this.testLocation=s;this.instantiationService=a}async buildPrompt({history:e,query:t,chatVariables:r},o,s){t=t||"This test failed, suggest how to fix it.";let c=await Fe.create(this.instantiationService,this.endpoint,SO,{testFailure:this.testFailure,chatVariables:r,query:t,endpoint:this.endpoint,progress:o,chatLocation:this.location,location:this.testLocation,history:e}).render(o,s),l=c.metadata.get(BB)?.value;l&&(this.lastSolutionForInterpreter={outcome:l,test:this.testFailure.snapshot});let u=c.metadata.get(qB)?.value;return{...c,references:u||c.references}}processResponse(e,t,r,o){let{outcome:s,test:a}=this.lastSolutionForInterpreter;return new yre(a,s).processResponse(e,t,r,o)}};xO=E([v(5,H)],xO);var SO=class extends Ake.PromptElement{constructor(t,r){super(t);this.instantiationService=r}async prepare(t,r,o=Zt.None){let{progress:s}=this.props,c=await Dy.create({endpoint:this.props.endpoint,progress:s,token:o,tokenBudget:t.tokenBudget,timeBudget:1/0,turnsBudget:6},this.props.testFailure,this.props.location,this.instantiationService).climb();if(this.props.chatLocation===1)return{outcome:c};if(c.type===0)if(c.solution.edits){s.report(new ki(new Ao(c.solution.before))),s.report(new _c(c.solution.uri,c.solution.edits.apply)),s.report(new ki(new Ao(c.solution.after)));let l=new Z_;l.set(c.solution.uri,c.solution.edits.apply);let u=new Z_;u.set(c.solution.uri,c.solution.edits.undo),s.report(new ex(Lke(this.props.testFailure.snapshot,l,u)))}else s.report(new ki(new Ao(c.solution.text)));else c.possibleSolution?s.report(new ki(new Ao(c.possibleSolution.text))):c.type===1?(s.report(new ki(Dke())),s.report(new ex({command:"workbench.action.openSettings",title:Ly.t("Go to Settings"),arguments:[{query:"github.copilot.config.testFixLimits"}]}))):s.report(new ki(Nke()));return{outcome:c}}render(t,r){return vscpp(vscppf,null,vscpp("meta",{value:new BB(t.outcome)}),vscpp("meta",{value:new qB(t.outcome.type===0?t.outcome.references:t.outcome.possibleSolution?.references||[])}))}};SO=E([v(1,H)],SO);var Dke=()=>Ly.t("Unfortunately I was unable to find a solution to this test failure in the time alloted. My time limit can be configured in your settings."),Nke=()=>Ly.t("Unfortunately I was unable to find a solution to this test failure. Please try providing more context."),BB=class extends Jl{constructor(t){super();this.value=t}},qB=class extends Jl{constructor(t){super();this.value=t}},yre=class{constructor(e,t){this.test=e;this.solution=t}async processResponse(e,t,r,o){let s=this.solution||{type:1};if(s.type!==0){if(s.possibleSolution){r.markdown(s.possibleSolution.text);return}else if(s.type===1){r.markdown(Dke());return}else if(s.type===2){r.markdown(Nke());return}}let a=s.solution;if(a.annotations&&e.addAnnotations(a.annotations),!a.uri||!a.edits){r.markdown(a.text);return}let c=new Z_;c.set(a.uri,a.edits.apply);let l=new Z_;l.set(a.uri,a.edits.undo),r.markdown(a.before),r.textEdit(a.uri,a.edits.apply),r.markdown(a.after),r.button(Lke(this.test,c,l))}};function Lke(n,e,t){return{title:Ly.t("Apply and Rerun"),command:"github.copilot.tests.fixTestFailure.applyAndRerun",arguments:[n,e,t]}}var bk=class{constructor(e,t,r,o){this._intentService=e;this.instantiationService=t;this.endpointProvider=r;this.testProvider=o;this.id="fix";this.locations=[1,2];this.description=Oke.t("Propose a fix for the problems in the selected code");this.commandInfo=void 0}static{this.ID="fix"}get intentDetectionInput(){let e="fix_code_or_markdown";return{functionName:e,sampleQuestion:"There is a problem in this code. Rewrite the code to show it with the bug fixed.",functionCallingBlurb:`If the user's message appears related to fixing problems in the selected code, you should use the '${e}' function.`}}async invoke(e){if(this.shouldDelegateToTestFixer(e))return this._intentService.getIntent(Ny.ID,e.location).invoke(e);let{location:t,documentContext:r,request:o}=e;if(!r)throw new Error("Open a file to fix an issue");if(t===2){let d=await this.endpointProvider.getChatEndpoint(o);return this.instantiationService.createInstance(w0,this,t,d,vk,e.documentContext)}let s=o.attempt,a=await this.endpointProvider.getChatEndpoint(o),c;an(r.document.uri)?c=gk:c=hk;let u={useWorkspaceChunksFromSelection:s>1,useWorkspaceChunksFromDiagnostics:!1};return this.instantiationService.createInstance(mk,this,t,a,c,r,u)}shouldDelegateToTestFixer(e){let t=this.testProvider;return!t?.isEnabled.get()||e.documentContext?.selection.isEmpty===!1?!1:!!(e.location===1&&e.documentContext&&t.getFailureAtPosition(e.documentContext.document.uri,e.documentContext.selection.end)||t.lastResultsFrom&&Date.now()-t.lastResultsFrom<1e4&&!ti.isEmpty(t.getAllFailures()))}};bk=E([v(0,Ld),v(1,H),v(2,_e),v(3,Tl)],bk);var Mke=q(ht());var Oy=class{constructor(e,t){this.instantiationService=e;this.endpointProvider=t;this.id=Oy.ID;this.description=Mke.t("Generate new code");this.locations=[1];this.commandInfo={hiddenFromUser:!0}}static{this.ID="generate"}get intentDetectionInput(){let e="generate_code_or_markdown";return{functionName:e,sampleQuestion:"Add a function that returns the sum of two numbers",modelDescription:"Generate new code",functionCallingBlurb:`If the user's message appears related to generating new code, you should use the '${e}' function.`}}async invoke(e){let{location:t,documentContext:r,request:o}=e;if(!r)throw new Error("Open a file to add code.");let s=await this.endpointProvider.getChatEndpoint(o);return this.instantiationService.createInstance(df,this,t,s,r,4)}};Oy=E([v(0,H),v(1,_e)],Oy);var bre=q(ht());var _k=class{constructor(e,t){this.endpointProvider=e;this.instantiationService=t;this.id="newNotebook";this.description=bre.t("Create a new Jupyter Notebook");this.locations=[2];this.commandInfo={allowsEmptyArgs:!1,yieldsTo:[{command:"fix"},{command:"explain"},{command:"workspace"},{command:"tests"}],defaultEnablement:!0,sampleRequest:bre.t("How do I create a notebook to load data from a csv file?")}}static{this.ID="newNotebook"}get intentDetectionInput(){let e="create_new_jupyter_notebook";return{functionName:e,modelDescription:"Creates a new Jupyter Notebook for tasks such as data analysis, scientific computing, and machine learning.",sampleQuestion:"How do I create a notebook to load data from a csv file?",functionCallingBlurb:`If the user's message is related to creating a new Jupyter notebook for data analysis, scientific computing, and machine learning, you should use the '${e}' function.`}}async invoke(e){let t=e.location,r=await this.endpointProvider.getChatEndpoint(e.request);return this.instantiationService.createInstance(IO,this,r,t)}};_k=E([v(0,_e),v(1,H)],_k);var IO=class{constructor(e,t,r,o){this.intent=e;this.endpoint=t;this.location=r;this.instantiationService=o;this.linkification={disable:!0}}async buildPrompt(e,t,r){return await Fe.create(this.instantiationService,this.endpoint,QU,{promptContext:e,endpoint:this.endpoint}).render(t,r)}processResponse(e,t,r,o){return new e7().processResponse(e,t,r,o)}};IO=E([v(3,H)],IO);var CO=q(ht()),EO=q(require("path"));var Fke="Review the currently selected code.",_ut=CO.t("local changes"),xk=class extends ga{constructor(t,r,o,s,a,c,l,u,d){super(t,r,o);this.documentContext=s;this.instantiationService=a;this.workspaceService=c;this.tabsAndEditorsService=l;this.logService=u;this.gitExtensionService=d;this.linkification={additionaLinkifiers:[{create:()=>new xre(this.documentContext.document.uri)}]}}async createRenderer({history:t,query:r,chatVariables:o},s,a,c){let l=[];if(r===_ut){let u=await dr.getCurrentChanges(this.gitExtensionService,"workingTree");(await Promise.all(u.map(async p=>({document:await this.workspaceService.openTextDocumentAndSnapshot(p.uri),relativeDocumentPath:EO.default.relative(p.repository.rootUri.fsPath,p.uri.fsPath),change:p})))).map(p=>l.push(p))}else{let u=this.tabsAndEditorsService.activeTextEditor;u&&l.push({document:Bt.create(u.document),relativeDocumentPath:EO.default.basename(u.document.uri.fsPath),selection:u.selection})}return Fe.create(this.instantiationService,s,AC,{query:r,history:t,chatVariables:o,input:l,logService:this.logService})}async buildPrompt(t,r,o){return t.query===""&&(t={...t,query:Fke}),super.buildPrompt(t,r,o)}};xk=E([v(4,H),v(5,Be),v(6,$t),v(7,oe),v(8,Ji)],xk);var _re=class extends xk{processResponse(e,t,r,o){return this.instantiationService.createInstance(TO,this.documentContext).processResponse(e,t,r,o)}},Sk=class{constructor(e,t){this.instantiationService=e;this.endpointProvider=t;this.id="review";this.locations=[2,1];this.description=CO.t("Review the selected code in your active editor");this.intentDetectionInput={sampleQuestion:Fke,disabled:!0}}static{this.ID="review"}async invoke(e){let t=e.documentContext,r=e.location,o=await this.endpointProvider.getChatEndpoint("gpt-4");return r===1?this.instantiationService.createInstance(_re,this,r,o,t):this.instantiationService.createInstance(xk,this,r,o,t)}};Sk=E([v(0,H),v(1,_e)],Sk);var xre=class{constructor(e){this.file=e}async linkify(e,t,r){let o=iJ(e);if(!o.length)return;let s=0,a=[];for(let c of o)a.push(e.substring(s,c.linkOffset)),a.push(new IC(this.file.with({fragment:String(c.from+1)}),e.substring(c.linkOffset,c.linkOffset+c.linkLength))),s=c.linkOffset+c.linkLength;return a.push(e.substring(s)),{parts:a}}},TO=class{constructor(e,t){this.documentContext=e;this.reviewService=t;this.updating=!1;this.text="";this.comments=[]}async processResponse(e,t,r,o){let s={source:"vscodeCopilotChat",promptCount:1,messageId:Gt(),inputType:"selection",inputRanges:[{uri:this.documentContext.document.uri,ranges:[this.documentContext.selection]}]};for await(let c of t){if(this.text=c.text,!this.updating){this.updating=!0;let u=new Ao(CO.t({message:`Reviewing your code...
`,comment:"{Locked='](command:workbench.panel.markers.view.focus)'}"}));u.isTrusted={enabledCommands:["workbench.panel.markers.view.focus"]},r.markdown(u)}let l=nN(s,[{document:this.documentContext.document,relativeDocumentPath:EO.default.basename(this.documentContext.document.uri.fsPath),selection:this.documentContext.selection}],this.text,!0);l.length>this.comments.length&&(this.reviewService.addReviewComments(l.slice(this.comments.length)),this.comments=l)}let a=nN(s,[{document:this.documentContext.document,relativeDocumentPath:EO.default.basename(this.documentContext.document.uri.fsPath),selection:this.documentContext.selection}],this.text,!1);a.length>this.comments.length&&(this.reviewService.addReviewComments(a.slice(this.comments.length)),this.comments=a),r.markdown(CO.t("Reviewed your code and generated {0} suggestions.",a.length))}};TO=E([v(1,ya)],TO);var Ire=q(ht());var Ik=q(Ve());var jB=class extends Ik.PromptElement{render(e,t){let{query:r,history:o}=this.props.promptContext;return vscpp(vscppf,null,vscpp(Ik.SystemMessage,{priority:1e3},"You are a VS Code search expert who helps to write search queries for text in a workspace. Users want to search across a whole workspace. Your response will contain parameters to use in the search that targets what the user wants.",vscpp("br",null),vscpp(vn,null),vscpp(Ze,null)),vscpp(Nt,{historyPriority:600,passPriority:!0,history:o},vscpp(Tt,{priority:1e3},vscpp(ii,null),vscpp(kt,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"The user's question is ALWAYS related to search or replace. When the user's question does not seem to be related to searching or replacing, you MUST assume that they're searching for or replacing what they are describing.",vscpp("br",null),`For example, if the user says "emojis", try appending "I'm looking for _____" to the beginning (e.g. I'm looking for emojis) to make more sense of it.`,vscpp("br",null),vscpp("br",null),"For all valid questions, you MUST respond with a JSON object with search parameters to use.",vscpp("br",null),'- Your answer MUST wrap the JSON object in "[ARGS START]" and "[ARGS END]". "[ARGS START]" must be on a new line.',vscpp("br",null),'- Your answer MUST have an explanation in full, human-readable sentences. This goes before the "[ARGS START]" line.',vscpp("br",null),vscpp("br",null),'If you put a regex in the "query" parameter, make sure to set "isRegex" to true.',vscpp("br",null),'If you put a regex in the "query" parameter, do not start and/or end with forward slashes to denote a regex literal.',vscpp("br",null),"You MUST NOT give an answer with an empty-string query parameter.",vscpp("br",null),vscpp("br",null),'The "replace" string will be used to replace the query-matched search results.',vscpp("br",null),vscpp("br",null),'If you want to target certain files, set "filesToInclude" to a glob pattern. DO NOT assume the "filesToInclude" and "filesToExclude" without being very sure that the user wants to target these files!',vscpp("br",null),vscpp("br",null),'If the query is case sensitive, set "isCaseSensitive" to true.',vscpp("br",null),vscpp("br",null),"By default, all string fields are the empty string, and all boolean fields are false. Only list the fields you want to change.",vscpp("br",null),vscpp("br",null),"You should write the JSON object of the search parameters in the following format:",vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": ...,',vscpp("br",null),'	"replace": ...,',vscpp("br",null),'	"filesToInclude": ...,',vscpp("br",null),'	"filesToExclude": ...,',vscpp("br",null),'	"isRegex": ...,',vscpp("br",null),'	"isCaseSensitive": ...,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"Examples:",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"Search for 'foo' in all files under my 'src' directory.",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"Populate the query field with 'foo' and specify the files to include as 'src/'.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "foo",',vscpp("br",null),'	"filesToInclude": "src" ,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"Find all CamelCase words in all files under the 'src/extensions' directory.",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"Perform a regex search for camelCase variables by checking for any word that has a lowercase letter followed by an uppercase letter, followed by any number of lowercase letters. You can use `\\b[a-z]+[A-Z][a-z]+\\b` to acheive this.",vscpp("br",null),"This must be case-sensitive since the capitalization of the letters in our regex matters.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "\\\\b[a-z]+[A-Z][a-z]+\\\\b",',vscpp("br",null),'	"filesToInclude": "src/extensions" ,',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),'	"isCaseSensitive": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"Find all hex color codes in css files",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"Perform a search for 6-digit or 3-digit hex color codes using the regex `#([a-fA-F0-9]{6}|[a-fA-F0-9]{3})\\b`.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "#([a-fA-F0-9]{6}|[a-fA-F0-9]{3})\\\\b",',vscpp("br",null),'	"filesToInclude": "*.css" ,',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"Find all HTTPS links in markdown.",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"Search all URLs that have the HTTPS protocol in a markdown file. Make sure to include all valid URL characters in their respective places. This regex should achieve this: `https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_\\+.~#()?&//=]*)`.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "https?:\\\\/\\\\/(www\\\\.)?[-a-zA-Z0-9@:%._\\\\+~#=]{2,256}\\\\.[a-z]{2,6}\\\\b([-a-zA-Z0-9@:%_\\\\+.~#()?&//=]*)",',vscpp("br",null),'	"filesToInclude": "*.md" ,',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"Replace all YYYY-MM-DD dates with MM/DD/YYYY dates. Don't do this in typescript files.",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"You will need to use the regex `(\\d{4})-(\\d{2})-(\\d{2})` to match the YYYY-MM-DD date format. Then, you will need to use the replace string `$2/$3/$1` to replace the date with the MM/DD/YYYY format.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "(\\\\d{4})-(\\\\d{2})-(\\\\d{2})",',vscpp("br",null),'	"replace: "$2/$3/$1",',vscpp("br",null),'	"filesToExclude": "*.ts",',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"Replace all camel case variable names with snake case variable names.",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"To replace all camel case variables with snake case, we will need to:",vscpp("br",null),"1. Find all sequences of lowercase letters succeeded by uppercase letters. Use `([a-z]+)([A-Z])` to capture these sequences.",vscpp("br",null),"2. Separate them with an underscore character. `$1_$2` does this.",vscpp("br",null),"3. Convert both characters to lowercase. Adjust the previous replace text to be `\\l$1_\\l$2`.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "([a-z]+)([A-Z])",',vscpp("br",null),'	"replace: "\\\\l$1_\\\\l$2",',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),'	"isCaseSensitive": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"alphanumeric",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"To find all alphanumeric characters, you can use the regex `[a-zA-Z0-9]`.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "[a-zA-Z0-9]",',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),'	"isCaseSensitive": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"link",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"To find all web links, use the regex `https?:\\/\\/\\S+`.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "https?:\\\\/\\\\/\\\\S+",',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),'Search for actionbar files outside of my "extensions" directoy',vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"To do this, use the query `actionbar` in all files except the ones in `extensions`.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "actionbar",',vscpp("br",null),'	"filesToExclude": "extensions",',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"typescript for loop",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),'To look for "for" loops in most languages, use the query `for\\s*\\(`.',vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "for\\s*\\(",',vscpp("br",null),'	"isRegex: true,',vscpp("br",null),'	"filesToInclude: "*.ts"',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null))),vscpp(Xi,{priority:700}),vscpp(Ik.UserMessage,{priority:900},r))}};function xut(n){if(!n)return[];let e=[],t={query:n.query??"",replace:n.replace??"",filesToInclude:n.filesToInclude??"",filesToExclude:n.filesToExclude??"",isRegex:n.isRegex??!1,isCaseSensitive:n.isRegex??!1};return e.push({command:"github.copilot.executeSearch",arguments:[t],title:Ire.t("Search")}),e}function Uke(n){let e=Is(n).at(0),t;if(e){let r;try{r=gf(e.code)}catch{}r&&(t=r)}return t}function Sut(n){if(!n)return[];let e=[`| Parameter  | Value |
`,`| ------ | ----- |
`];for(let[t,r]of Object.entries(n)){if(r==="")continue;let o=r;(typeof r=="string"||r instanceof String)&&(o=r.replace(/\|/g,"\\|")),e.push(`| ${t} | \`${o}\` |
`)}return e.push(`
`),e}var Iut="Search for 'foo' in all files under my 'src' directory",wO=class extends ga{constructor(t,r,o,s){super(t,r,o);this.instantiationService=s}createRenderer(t,r,o,s){return Fe.create(this.instantiationService,r,jB,{promptContext:t})}processResponse(t,r,o,s){return this.instantiationService.createInstance(Sre).processResponse(t,r,o,s)}};wO=E([v(3,H)],wO);var Sre=class extends kC{constructor(){super([{start:"[ARGS END]",stop:"[ARGS START]"}],t=>Sut(Uke(t.join(""))));this._response=""}async doProcessResponse(t,r,o){await super.doProcessResponse(t,r,o);let s=Uke(this._response??"");for(let a of xut(s))r.button(a)}applyDelta(t,r){this._response+=t.text,super.applyDelta(t,r)}},Tk=class{constructor(e,t){this.instantiationService=e;this.endpointProvider=t;this.id="search";this.locations=[2];this.description=Ire.t("Generate query parameters for workspace search");this.commandInfo={allowsEmptyArgs:!1,defaultEnablement:ml}}static{this.ID="search"}get intentDetectionInput(){let e="vscode_search";return{disabled:!0,functionName:e,sampleQuestion:Iut,functionCallingBlurb:`If the user's message is related to generating search query parameters for running a file search, you should use the '${e}' function.`}}async invoke(e){let t=e.location,r=await this.endpointProvider.getChatEndpoint(e.request);return this.instantiationService.createInstance(wO,this,t,r)}};Tk=E([v(0,H),v(1,_e)],Tk);var PO=q(ht());function Tut(n,e){let t=0;for(let r of n)if(t+=r.trim().length,t>=e)return!0;return!1}function Cut(n,e,t){let r=[],o=0;for(;o<n.length&&r.join(`
`).length<e&&r.length<t;)r.push(n[o]),o++;return r}function Eut(n){return zn(n.map(e=>{let t=e.location;if(!Tut(t.code,5))return;let r=Cut(t.code,1e3,15),{trimmedLines:o}=bD(r);o.length<t.code.length&&o.push("...");let s=mo(fl(e.file).replace(/\./g,""),o.join(`
`).replace(/^\n*|\n*$/g,""),!1);return{file:e.file,locations:[{range:t.range,codePreview:s}]}}))}var kO=class extends ga{constructor(t,r,o,s){super(t,r,o);this.instantiationService=s}async createRenderer({query:t,history:r},o,s,a){return Fe.create(this.instantiationService,o,nk,{query:t})}processResponse(t,r,o,s){return this.instantiationService.createInstance(RO,this.endpoint).processResponse(t,r,o,s)}};kO=E([v(3,H)],kO);var My=class{constructor(e,t){this.instantiationService=e;this.endpointProvider=t;this.id=My.ID;this.locations=[2];this.description=PO.t("Find relevant code to your query");this.commandInfo={allowsEmptyArgs:!1,defaultEnablement:!1};this.intentDetectionInput={sampleQuestion:"Where is the toolbar code?",disabled:!0}}static{this.ID="semanticSearch"}async invoke(e){let t=e.location,r=await this.endpointProvider.getChatEndpoint(e.request);return this.instantiationService.createInstance(kO,this,t,r)}};My=E([v(0,H),v(1,_e)],My);var RO=class{constructor(e,t){this.endpoint=e;this.instantiationService=t}async processResponse(e,t,r,o){let{messages:s}=e,a=s[s.length-1].content,c=0,l="";for await(let{delta:d}of t){if(o.isCancellationRequested)return;c+=d.text.length,l+=d.text}r.progress(PO.t("Looking for relevant code"));let u=ure(l);return this.instantiationService.invokeFunction(d=>wut(d,this.endpoint,a,u,o).then(p=>kut(d,p,r)))}};RO=E([v(1,H)],RO);async function wut(n,e,t,r,o){let s=await dre(n,{endpoint:e,tokenBudget:e.modelMaxPromptTokens,maxResults:75},t,r,o,void 0);return Eut(s)}function kut(n,e,t){if(e.length===0){let o=PO.t(`No relevant code found. Please be more specific.
`);t.markdown(o);return}let r=n.get(Be);t.markdown(PO.t(`Here is some relevant code:

`));for(let o of e)Rut(o,t,r)}function Rut(n,e,t){let o=`## ${wd(t,n.file)}

`;e.markdown(o),n.locations.forEach(s=>{let a={uri:n.file,range:jT(s.range)},c=s.range.startLineNumber,l=s.range.endLineNumber,u=c+1===l?`Line ${c+1}`:`Lines ${c+1}-${l}`;e.markdown("- "),e.anchor(a,u),e.markdown(`

`),e.markdown(s.codePreview+`
`)})}var Rre=q(ht());var VB=q(ht()),Yh=q(Ve());var HB={perFramework:new Map([["mocha",{name:"Mocha Test Explorer",id:"hbenl.vscode-mocha-test-adapter"}],["jest",{name:"Jest",id:"Orta.vscode-jest"}],["vitest",{name:"Vitest",id:"vitest.explorer"}],["playwright",{name:"Playwright Test for VSCode",id:"ms-playwright.playwright"}],["jasmine",{name:"Jasmine Test Explorer",id:"hbenl.vscode-jasmine-test-adapter"}]])},Ck=new Map([["python",{forLanguage:{extension:{id:"ms-python.python",name:"Python"},associatedFrameworks:["pytest","unittest"]}}],["rust",{forLanguage:{extension:{id:"rust-lang.rust-analyzer",name:"rust-analyzer"}}}],["java",{forLanguage:{extension:{id:"vscjava.vscode-java-test",name:"Test Runner for Java"},associatedFrameworks:["junit","testng"]}}],["csharp",{forLanguage:{extension:{id:"ms-dotnettools.csharp",name:"C#"}}}],["go",{forLanguage:{extension:{id:"golang.Go",name:"Go"}}}],["typescript",HB],["javascript",HB],["javascriptreact",HB],["typescriptreact",HB]]);var Ek=class{constructor(e,t){this.grammar=t;this.accumulator="";this.currentEntries=[];this.tokens=[];this.state=e,this.currentEntries=Object.entries(t[e]||{})}visited(e){return this.tokens.some(t=>t.state===e)}accumulate(e=0,t=this.tokens.length,r){let o="";for(let s=e;s<t&&s<this.tokens.length;s++){let a=this.tokens[s];r!==void 0?a.state===r&&!a.transitionTo&&(o+=a.token):o+=a.token}return o}append(e){let t=0,r,o=this.tokens.length;this.accumulator+=e;for(let[s,a]of this.currentEntries){let c=this.accumulator.indexOf(s);c!==-1&&(!r||c<r.index)&&(r={index:c,toState:a,length:s.length}),t=Math.max(t,s.length)}if(r){r.index>0&&this.tokens.push({state:this.state,token:this.accumulator.slice(0,r.index)}),this.tokens.push({state:this.state,token:this.accumulator.slice(r.index,r.index+r.length),transitionTo:r.toState});let s=this.accumulator.slice(r.index+r.length);this.state=r.toState,this.currentEntries=Object.entries(this.grammar[r.toState]||{}),this.accumulator="",this.append(s)}else this.accumulator.length>t&&(this.tokens.push({state:this.state,token:this.accumulator.slice(0,this.accumulator.length-t)}),this.accumulator=this.accumulator.slice(this.accumulator.length-t));return ti.slice(this.tokens,o)}flush(){return this.accumulator?(this.tokens.push({state:this.state,token:this.accumulator}),ti.slice(this.tokens,-1)):ti.empty()}};var yS=class{constructor(e,t,r,o){this.endpoint=e;this.documentContext=t;this.instantiationService=r;this.commandService=o}async buildPrompt(e,t,r){return Fe.create(this.instantiationService,this.endpoint,Tre,{endpoint:this.endpoint,promptContext:e,document:this.documentContext?.document,selection:this.documentContext?.selection}).render(t,r)}async processResponse(e,t,r,o){let s;(p=>(p[p.Reasoning=0]="Reasoning",p[p.Frameworks=1]="Frameworks"))(s||={});let a=u=>{for(let d of u)d.state===0&&d.transitionTo===void 0&&r.markdown(d.token)},c=new Ek(0,{0:{[kk]:1}});for await(let{delta:u}of t){if(o.isCancellationRequested)return;a(c.append(u.text))}a(c.flush());let l=c.accumulate(void 0,void 0,1).split(`
`).map(u=>u.replace(kk,"").trim()).filter(u=>!!u);l.length?r.confirmation(VB.t("Pick a testing framework"),VB.t("Pick from these options, or use chat to tell me what you'd prefer:"),void 0,l):r.markdown(VB.t("Use chat to tell me which framework you'd prefer.")),await this.commandService.executeCommand("workbench.action.chat.open",{query:"@workspace /setupTests ",isPartialQuery:!0})}};yS=E([v(2,H),v(3,jd)],yS);var wk=class extends yS{constructor(t,r,o,s,a,c){super(r,s,a,c);this.intent=t;this.location=o}};wk=E([v(4,H),v(5,jd)],wk);var kk="FRAMEWORK: ",Tre=class extends Yh.PromptElement{render(e,t){let{query:r,chatVariables:o}=this.props.promptContext;return vscpp(vscppf,null,vscpp(Yh.SystemMessage,{priority:1e3},"You are a software engineer with expert knowledge around software testing frameworks.",vscpp("br",null),vscpp("br",null),vscpp(vn,null),vscpp(Ze,null),vscpp(ii,null),vscpp(kt,null),"# Additional Rules",vscpp("br",null),"1. Examine the workspace structure the user is giving you.",vscpp("br",null),"2. Determine the best testing frameworks that should be used for the project.",vscpp("br",null),"3. Give a brief explanation why a user would choose one framework over the other, but be concise and never give the user steps to set up the framework.",vscpp("br",null),"4. If you're unsure which specific framework is best, you can suggest multiple frameworks.",vscpp("br",null),"5. Suggest only frameworks that are used to run tests. Do not suggest things like assertion libraries or build tools.",vscpp("br",null),'6. After determining the best framework to use, write out the name of 1 to 3 suggested frameworks prefixed by the phrase "',kk,'", for example: "',kk,'vitest".',vscpp("br",null),vscpp("br",null),"DO NOT mention that you cannot read files in the workspace.",vscpp("br",null),"DO NOT ask the user to provide additional information about files in the workspace.",vscpp("br",null),vscpp("br",null),"# Example",vscpp("br",null),"## Question:",vscpp("br",null),"I am working in a workspace that has the following structure:",vscpp("br",null),"```\nsrc/\n  index.ts\npackage.json\ntsconfig.json\nvite.config.ts\n```",vscpp("br",null),"## Response:",vscpp("br",null),"Because you have a `vite.config.ts` file, it looks like you're working on a browser or Node.js application. If you're working on a browser application, I recommend using Playwright. Otherwise, Vitest is a good choice for Node.js.",vscpp("br",null),kk,"playwright",vscpp("br",null),kk,"vitest",vscpp("br",null)),this.props.document&&vscpp(Ere,{document:this.props.document}),vscpp(Yh.UserMessage,{flexGrow:2},vscpp(Cre,null)),vscpp($n,{flexGrow:2,priority:900,chatVariables:o,query:r}))}},Cre=class extends Yh.PromptElement{render(e,t){return vscpp(ws,{maxSize:t.tokenBudget*4/3})}},Ere=class extends Yh.PromptElement{render(){let e=Ck.get(this.props.document.languageId);if(e?.perFramework)return vscpp(Yh.SystemMessage,{priority:600},"These are the preferred test frameworks for ",this.props.document.languageId,":",vscpp("br",null),vscpp("br",null),[...e.perFramework.keys()].map(t=>`- ${t}`).join(`
`),vscpp("br",null))}};var Rk=q(ht()),bS=q(Ve());var Pk=class{constructor(e,t,r,o,s,a,c,l,u,d){this.intent=e;this.endpoint=t;this.location=r;this.prompt=o;this.instantiationService=s;this.workspaceService=a;this.workspaceMutationManager=c;this.extensionsService=l;this.commandService=u;this.chatMLFetcher=d;this.recommendedExtension=new kr(()=>{let e=this.prompt.toLowerCase();return wp(Ck.values(),t=>t.forLanguage?.associatedFrameworks?.some(r=>e.includes(r))?t.forLanguage.extension:t.perFramework&&wp(t.perFramework,([r,o])=>e.includes(r)?o:void 0))})}async buildPrompt(e,t,r){return this.buildPromptContext=e,this.delegatedSetup=await this.delegateHandling(),this.delegatedSetup?Eye():(this.setupConfirmation=await this.getSetupConfirmation(),Fe.create(this.instantiationService,this.endpoint,wre,{endpoint:this.endpoint,promptContext:e,query:this.prompt,setupConfirmation:this.setupConfirmation}).render(t,r))}async processResponse(e,t,r,o){let s;(m=>(m[m.LookingForTree=0]="LookingForTree",m[m.FileTree=1]="FileTree",m[m.FoundTree=2]="FoundTree"))(s||={});let a=e.turn.requestId||Gt(),c=d=>{for(let p of d)if(p.transitionTo===1)r.markdown(l.accumulate(0,l.tokens.length-1));else if(p.transitionTo===2){let f=l.accumulate(void 0,void 0,1);this.handleFileTree(a,f,r)}else p.transitionTo===void 0&&p.state!==1&&l.visited(1)&&r.markdown(p.token)},l=new Ek(0,{0:{"```filetree":1},1:{"```":2}});for await(let{delta:d}of t)c(l.append(d.text));c(l.flush()),this.delegatedSetup&&r.markdown(this.delegatedSetup.message);let u=this.setupConfirmation?.command||this.delegatedSetup?.command;u?r.button(u):l.visited(1)?this.recommendExtension(r):await this.doFrameworkQuery(e,r,o)}async doFrameworkQuery(e,t,r){let o=this.instantiationService.createInstance(yS,this.endpoint,void 0),s=await o.buildPrompt(this.buildPromptContext,void 0,r),a=new a0,c=o.processResponse(e,a.stream,t,r);await this.chatMLFetcher.fetchOne("testSetupAutomaticFrameworkID",s.messages,(l,u,d)=>(a.update(l,d),Promise.resolve(void 0)),r,this.location,this.endpoint),a.resolve(),await c}async getSetupConfirmation(){let e=this.recommendedExtension.value,r=(e?this.extensionsService.getExtension(e.id):void 0)?.packageJSON?.copilot?.tests?.getSetupConfirmation;if(!r)return;let o;try{o=await this.commandService.executeCommand(r)}catch{}return o}async delegateHandling(){let e=this.recommendedExtension.value,r=(e?this.extensionsService.getExtension(e.id):void 0)?.packageJSON?.copilot?.tests?.setupTests;return r?await this.commandService.executeCommand(r):void 0}recommendExtension(e){let t=this.recommendedExtension.value;t&&this.extensionsService.getExtension(t.id)||(e.markdown(`

`),t?(e.markdown(Rk.t("I also recommend installing the {0} extension to make tests easy to run in VS Code:",t.name)),e.button({command:"workbench.extensions.action.showExtensionsWithIds",title:Rk.t("Get Extension"),arguments:[[t.id]]})):(e.markdown(Rk.t("You can also search for an extension to make tests easy to run in VS Code:")),e.button({command:"workbench.extensions.search",title:Rk.t("Search Extensions"),arguments:[`@category:testing ${this.prompt}`]})))}handleFileTree(e,t,r){let o=this.workspaceService.getWorkspaceFolders().at(0);if(!o)return;let{chatResponseTree:s}=K8(t,()=>Aut(e)),a=s.value[0];s.value.length===1&&/^\[.+\]$/.test(a.name)&&a.children&&(s.value=a.children),this.workspaceMutationManager.create(e,{baseURI:o,files:D_e(s.value),fileTree:t,query:this.prompt}),r.push(s),r.button({command:"github.copilot.tests.applyMutations",title:Rk.t("Apply Changes"),arguments:[e]})}};Pk=E([v(4,H),v(5,Be),v(6,$w),v(7,Bc),v(8,jd),v(9,Et)],Pk);var Put="[project-name]";function Aut(n,e){return $e.from({scheme:fB,authority:n,path:e?`/${e}`:"/"})}var wre=class extends bS.PromptElement{render(e,t){let{query:r,setupConfirmation:o}=this.props;return vscpp(vscppf,null,vscpp(bS.SystemMessage,{priority:1e3},"You are a software engineer with expert knowledge around software testing frameworks.",vscpp("br",null),vscpp("br",null),vscpp(vn,null),vscpp(Ze,null),vscpp(ii,null),vscpp(kt,null),"# Additional Rules",vscpp("br",null),"1. The user will tell you what testing framework they want to set up, and provide you their workspace structure.",vscpp("br",null),"2. Determine how to test up the desired testing framework.",vscpp("br",null),"3. Generate a markdown file tree structure listing files you want to create or edit in order to set up the testing framework. The tree MUST NOT include files that don't need to be modified.",vscpp("br",null),'4. Make sure to include a basic "hello world" test to help the user get started. If you see existing test files in the workspace, make sure to try to match their naming convention.',vscpp("br",null),"5. Do not attempt to modify the file content yourself and simply respond with the file tree structure.",vscpp("br",null),'6. After listing the file tree structure, respond with any terminal commands the user should execute to finish installing the testing framework. Terminal commands should be wrapped in a code fence tagged with the "sh" language.',vscpp("br",null),"7. Finally, provide a command line a user can execute to run their tests.",vscpp("br",null),o&&vscpp(vscppf,null,"8. At the end, include a phrase that conveys '",o.message,"', but rephrase this to indicate that this is the last step the user needs to take to enable rich UI integration in VS Code.",o.command&&` This message will be followed by a button that says "${o.command.title}".`,vscpp("br",null)),vscpp("br",null),"# Example",vscpp("br",null),"## Question:",vscpp("br",null),"I want to: set up mocha tests in the workspace",vscpp("br",null),"I am working in a workspace that has the following structure:",vscpp("br",null),"```\nsrc/\n  index.ts\npackage.json\ntsconfig.json\n```",vscpp("br",null),"## Response:",vscpp("br",null),'Let\'s create a `.mocharc.js` file to configure your test settings, as well as a "hello world" test:',vscpp("br",null),vscpp("br",null),`\`\`\`filetree
${Put}
\u251C\u2500\u2500 src
\u2502   \u2514\u2500\u2500 index.test.ts
\u2514\u2500\u2500 mocha.opts
\`\`\``,vscpp("br",null),"Then, we'll need to install Mocha in your workspace:",vscpp("br",null),"```sh",vscpp("br",null),"npm install --save-dev mocha ```",vscpp("br",null),vscpp("br",null),"Finally, you can run your tests with the following command:",vscpp("br",null),"```sh",vscpp("br",null),"npx mocha",vscpp("br",null),"```",vscpp("br",null)),vscpp(bS.UserMessage,{flexGrow:2},vscpp(kre,null)),vscpp($n,{flexGrow:2,priority:900,chatVariables:this.props.promptContext.chatVariables,query:`I want to: ${r}`}))}},kre=class extends bS.PromptElement{render(e,t){return vscpp(ws,{maxSize:t.tokenBudget*4/3})}};var Fy=class{constructor(e,t){this.endpointProvider=e;this.instantiationService=t;this.id=Fy.ID;this.locations=[2];this.description=Rre.t("Set up Tests");this.isListedCapability=!1;this.intentDetectionInput={sampleQuestion:Rre.t("set up vitest in my project")};this.commandInfo={allowsEmptyArgs:!0,defaultEnablement:ml}}static{this.ID="setupTests"}async invoke(e){let t=await this.endpointProvider.getChatEndpoint("gpt-4"),r=e.request.prompt;return e.request.acceptedConfirmationData&&(r=`set up tests in my workspace using \`${r.split(":")[0]}\``),r?Promise.resolve(this.instantiationService.createInstance(Pk,this,t,e.location,r)):this.instantiationService.createInstance(wk,this,t,e.location,e.documentContext)}};Fy=E([v(0,_e),v(1,H)],Fy);var qf=q(ht());var Dut="Attach to node app at port 5870 with outFiles",Uy=class{constructor(e,t,r){this.endpointProvider=e;this.instantiationService=t;this.extensionsService=r;this.id=Uy.ID;this.locations=[2];this.description=qf.t("Start Debugging");this.isListedCapability=!1;this.intentDetectionInput={sampleQuestion:Dut};this.commandInfo={allowsEmptyArgs:!0,defaultEnablement:ml}}static{this.ID="startDebugging"}async invoke(e){let t=e.location,r=await this.endpointProvider.getChatEndpoint("gpt-4");return{intent:this,location:t,endpoint:r,processResponse:async(o,s,a,c)=>{let l="";a.progress(qf.t("Solving for launch configuration..."));for await(let{delta:m}of s){if(c.isCancellationRequested)return;l+=m.text}let u=rB(l,this.extensionsService);if(!u){a.markdown(l);return}let d=l.match("HAS_CONFIG_NO_QUERY"),p=l.match("HAS_MATCH"),f=l.match("GENERATED_CONFIG");l=l.replaceAll(/"type": "python",/g,'"type": "debugpy",'),l=l.replace(/HAS_CONFIG_NO_QUERY/g,""),l=l.replace(/HAS_MATCH/g,""),l=l.replace(/GENERATED_CONFIG/g,""),a.markdown(l),d?(a.markdown(`
`+qf.t("Generate a new launch configuration by providing more specifics in your query.")+`
`),a.button({title:qf.t("Select and Start Debugging"),command:"workbench.action.debug.selectandstart"})):p?(a.markdown(`
`+qf.t("Generate a new launch configuration by providing more specifics in your query.")+`
`),a.button({title:qf.t("Start Debugging Existing"),command:"github.copilot.startDebugging",arguments:[u,a]})):f&&(a.button({title:qf.t("Start Debugging"),command:"github.copilot.startDebugging",arguments:[u,a]}),a.button({title:qf.t("Save Configuration"),command:"github.copilot.createLaunchJsonFileWithContents",arguments:[u]})),a.markdown(`
`+qf.t("Debugging can be started in the [Debug View]({0}) or by using the [Start Debugging Command]({1}).","command:workbench.view.debug","command:workbench.action.debug.run"))},buildPrompt:async(o,s,a)=>await Fe.create(this.instantiationService,r,wy,{input:{type:0,userQuery:o.query},history:o.history}).render(s,a)}}};Uy=E([v(0,_e),v(1,H),v(2,Bc)],Uy);var _S=q(ht());var By=q(Ve());var GB=class extends By.PromptElement{render(e){let{query:t,history:r,chatVariables:o}=this.props.promptContext;return vscpp(vscppf,null,vscpp(By.SystemMessage,{priority:1e3},"You are a programmer who specializes in using the command line. Your task is to help the Developer craft a command to run on the command line.",vscpp("br",null),vscpp(vn,null),vscpp(Ze,null)),vscpp(Nt,{flexGrow:1,historyPriority:600,passPriority:!0,history:r},vscpp(Tt,{priority:1e3},vscpp(ii,null),vscpp(kt,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"Think step by step:",`
1. Read the provided relevant workspace information (file names, project files in the project root) to understand the user's workspace.`,`
2. Generate a response that clearly and accurately answers the user's question. In your response, follow the following:
    - Prefer single line commands.
    - Omit an explanation unless the suggestion is complex, if an explanation is included then be concise.
    - Provide the command suggestions using the active shell and operating system.
    - When there is text that needs to be replaced in the suggestion, prefix the text with '{', suffix the text with '}' and use underscores instead of whitespace. Only do this when the replacement text is NOT provided.
    - Say "I'm not quite sure how to do that." when you aren't confident in your explanation`,Pre(this.props.shellType)?"\n    - Prefer idiomatic PowerShell over aliases for other shells or system utilities. For example use `Stop-Process` or `Get-NetTCPConnection` instead of `kill` or `lsof` respectively.\n	- Only use unix utilities when there is no PowerShell equivalent.\n    - Prefer cross-platform PowerShell scripting that works on any operating system.":`
    - Only use a tool like python or perl when it is not possible with the shell.`,`
3. At the end of the response, list all text that needs to be replaced with associated descriptions in the form of a markdown list
`.trim(),vscpp("br",null)),vscpp(Tt,{priority:700},"Examples:",vscpp("br",null),Nut(this.props.shellType))),vscpp(By.UserMessage,{flexGrow:1,priority:750},vscpp(sn,{languageId:Pre(this.props.shellType)?"ps1":"bash"})),vscpp(By.UserMessage,{flexGrow:1,priority:800},"The active terminal's shell type is:",vscpp("br",null),this.props.shellType),vscpp(By.UserMessage,{flexGrow:1,priority:800},"The active operating system is:",vscpp("br",null),this.props.osName),vscpp(tn,{priority:899,flexGrow:2,endpoint:this.props.endpoint,promptContext:this.props.promptContext}),vscpp($n,{flexGrow:2,priority:900,chatVariables:o,query:t}))}};function Nut(n){let e=['User: How do I revert a specific commit?\nAssistant:\n```sh\ngit revert {commit_id}\n```\n\nUser: How do I commit in git?\nAssistant:\n```sh\ngit commit -m "{message}"\n```'];switch(Pre(n)||e.push("User: go to the foo dir\nAssistant:\n```sh\ncd foo\n```"),n){case"ps1":case"pwsh":case"powershell":{e.push("User: go to the foo dir\nAssistant:\n```pwsh\ncd .\\foo\\\n```\n\nUser: How do I delete a directory?\nAssistant:\n```pwsh\nRemove-Item {dir_name}\n```\n\nUser: create a file called foo\nAssistant:\n```pwsh\nNew-Item -ItemType File -Name foo\n```");break}case"bash":{e.push("User: Print all files starting with \"pre\"\n```bash\nfind . -type f -name 'pre*'\n```");break}default:{e.push("\nUser: How do I print all files recursively within a directory?\nAssistant:\n```sh\nls -lR\n```");break}}return e.join(`

`)}function Pre(n){return n==="ps1"||n==="pwsh"||n==="powershell"}var qy=class{constructor(e,t){this.instantiationService=e;this.endpointProvider=t;this.locations=[2,4];this.id=qy.ID;this.description=_S.t("Ask how to do something in the terminal");this.commandInfo={allowsEmptyArgs:!1}}static{this.ID="terminal"}get intentDetectionInput(){let e="terminal_questions";return{functionName:e,sampleQuestion:"How do I list files in the terminal",functionCallingBlurb:`If the user's message is about how to do something in the terminal, you should use the '${e}' function.`}}async invoke(e){let t=e.location,r=await this.endpointProvider.getChatEndpoint(e.request);return this.instantiationService.createInstance(AO,this,r,t)}};qy=E([v(0,H),v(1,_e)],qy);var AO=class{constructor(e,t,r,o,s,a){this.intent=e;this.endpoint=t;this.location=r;this.instantiationService=o;this.envService=s;this.terminalService=a}async buildPrompt(e,t,r){let o=this.envService.OS,s=this.terminalService.terminalShellType;return await Fe.create(this.instantiationService,this.endpoint,GB,{promptContext:e,osName:o,shellType:s,endpoint:this.endpoint}).render(t,r)}async generateFollowUps(e){let t=_S.t("Explain the suggested command"),r=!1,o=e.response?.message;if(o){let a=Is(o);if(a.length===0)return[];a.length===1?t=_S.t("Explain this command:")+`

${s(a[0])}`:(r=!0,t=_S.t("Explain these commands:")+`${a.map(c=>`

${s(c)}`).join("")}`)}return[{prompt:t,label:r?_S.t("Explain the suggested commands"):_S.t("Explain the suggested command")}];function s(a){return`${a.startMarkup}${a.language}
${a.code.trim()}
${a.startMarkup}`}}};AO=E([v(3,H),v(4,it),v(5,vi)],AO);var zke=q(ht());var jf=q(ht());var Bke=require("util");var Dk=re("ITestDepsResolver"),Ak=class{constructor(e,t){this._searchService=e;this._fileSystemService=t;this._perLanguageTestDepsFinder=new Map;this._cachedResults=new Map,this._textDecoder=new Bke.TextDecoder}async getTestDeps(e){let t=this._cachedResults.get(e);if(t!==void 0)return t;let r=this.getTestDepsFinder(e);if(r===void 0)return[];let o=await r.findTestDeps();return this._cachedResults.set(e,o),o}getTestDepsFinder(e){let t=this._perLanguageTestDepsFinder.get(e);if(t===void 0)switch(e){case"javascript":case"javascriptreact":case"typescript":case"typescriptreact":{t=new Are(this._searchService,this._fileSystemService,this._textDecoder);break}case"python":{t=new Dre(this._searchService,this._fileSystemService,this._textDecoder);break}case"java":{t=new Nre(this._searchService,this._fileSystemService,this._textDecoder);break}}return t!==void 0&&this._perLanguageTestDepsFinder.set(e,t),t}};Ak=E([v(0,af),v(1,gn)],Ak);var Are=class{constructor(e,t,r){this._searchService=e;this._fileSystemService=t;this._textDecoder=r;this._jsTsTestDeps=new Set(["mocha","jest","vitest","chai","ava","jasmine","qunit","tape","cypress","puppeteer","enzyme","testing-library","sinon","supertest","happy-dom","playwright"])}async findTestDeps(){let e=await this._searchService.findFiles("**/package.json",{exclude:"**/node_modules/**",useDefaultExcludes:!0});return(await Promise.allSettled(e.map(async r=>{let o=await this._fileSystemService.readFile(r),s=JSON.parse(this._textDecoder.decode(o)),a=s.dependencies||{},c=s.devDependencies||{};return[a,c].flatMap(u=>Object.keys(u).filter(d=>this._jsTsTestDeps.has(d)))}))).flatMap(r=>r.status==="fulfilled"?r.value:[])}},Dre=class{constructor(e,t,r){this._searchService=e;this._fileSystemService=t;this._textDecoder=r;this._pyTestDeps=["pytest","nose","unittest","tox","doctest","hypothesis","mock","coverage","behave","robotframework"]}async findTestDeps(){let e=new Set,t=["pyproject.toml","setup.py","requirements.txt","tox.ini"],r=await this._searchService.findFiles(`**/{${t.join(",")}}`);return await Promise.all(r.map(async o=>{let s=await this._fileSystemService.readFile(o),a=this._textDecoder.decode(s);o.path.endsWith("pyproject.toml")?this._getPyProjectTomlDeps(a).forEach(l=>e.add(l)):o.path.endsWith("setup.py")?this._getSetupPyDeps(a).forEach(l=>e.add(l)):o.path.endsWith("requirements.txt")?this._getRequirementsTxtDeps(a).forEach(l=>e.add(l)):o.path.endsWith("tox.ini")&&e.add("tox")})),Array.from(e)}_getPyProjectTomlDeps(e){return this._pyTestDeps.filter(t=>e.includes(t))}_getSetupPyDeps(e){return this._pyTestDeps.filter(t=>e.includes(t))}_getRequirementsTxtDeps(e){return this._pyTestDeps.filter(t=>e.includes(t))}},Nre=class{constructor(e,t,r){this._searchService=e;this._fileSystemService=t;this._textDecoder=r;this._javaTestDeps=["junit","testng","mockito","assertj","hamcrest","powermock","spock","cucumber","arquillian","selenium","rest-assured","wiremock","pitest"]}async findTestDeps(){let e=new Set,t=["pom.xml","build.gradle","build.gradle.kts"],r=await this._searchService.findFiles(`**/{${t.join(",")}}`);return await Promise.all(r.map(async o=>{let s=await this._fileSystemService.readFile(o),a=this._textDecoder.decode(s);this._javaTestDeps.filter(c=>a.includes(c)).forEach(c=>e.add(c))})),Array.from(e)}};var zB=re("ISetupTestsDetector");var qke="testing.setup.skipForWorkspace";var Hke=n=>n&&n.$isSetupSuggestion&&n.command==="workbench.action.chat.open",Nk=class{constructor(e,t,r,o,s,a){this._configurationService=e;this._testDepsResolver=t;this._testService=r;this._extensionContext=o;this._extensionsService=s;this._commandService=a}showSuggestion(e){this.setDidAlreadyPrompt();let t=[],r=o=>`@category:testing ${o}`;switch(e.type){case 1:case 0:t.push(new tx(jf.t("We recommend installing an extension to run {0} tests.",e.type===1?e.framework:e.language),jf.t("Install {0} (`{1}`)?",e.extension.name,e.extension.id),{$isSetupSuggestion:!0,command:"workbench.extensions.installExtension",arguments:[e.extension.id,{enable:!0}]}));break;case 2:t.push(new tx(jf.t("We recommend installing an extension to run {0} tests.",e.framework),jf.t("Would you like to search for one now?"),{$isSetupSuggestion:!0,command:"workbench.extensions.search",arguments:[r(e.framework)]}));break;case 3:t.push(new tx(jf.t("It looks like you may not have tests set up in this repository yet."),jf.t("Would you like to set them up?"),{$isSetupSuggestion:!0,command:"workbench.action.chat.open",arguments:[{query:"@workspace /setupTests"}]}));break;case 6:e.command?t.push(new tx(e.command.title,e.message,{$isSetupSuggestion:!0,command:e.command.command,arguments:e.command.arguments})):t.push(new ki(e.message));break;case 4:{let o=e.action;switch(o.type){case 1:case 0:{let s=new Ao(jf.t("We recommend [installing the {0} extension]({1}) to run {2} tests.",o.extension.name,jke("workbench.extensions.action.showExtensionsWithIds",[[o.extension.id]]),o.type===1?o.framework:o.language));s.isTrusted={enabledCommands:["workbench.extensions.action.showExtensionsWithIds"]},t.push(new ki(s));break}case 2:{let s=new Ao(jf.t("We recommend [installing an extension]({0}) to run {1} tests.",jke("workbench.extensions.search",[r(o.framework)]),o.framework));s.isTrusted={enabledCommands:["workbench.extensions.search"]},t.push(new ki(s));break}}break}case 5:break;default:MF(e)}return t}async shouldSuggestSetup({document:e},t,r){if(t.rejectedConfirmationData?.some(a=>a.$isSetupSuggestion))return;let o=t.acceptedConfirmationData?.find(a=>a.$isSetupSuggestion);if(o){let a=this._commandService.executeCommand(o.command,...o.arguments);if(o.command==="workbench.extensions.installExtension"){r.progress(jf.t("Installing extension {0}...",o.arguments[0])),await this.waitForExtensionInstall(a,e,o.arguments[0]);return}return{type:5}}if(!this._configurationService.getConfig(le.SetupTests)||await this._testService.hasAnyTests())return;let s=await this.getSuggestActionInner(e);return s&&this.getDidAlreadyPrompt()?{type:4,action:s}:s}async waitForExtensionInstall(e,t,r){await e;let o;do o=this._extensionsService.getExtension(r),await mc(100);while(!o);let s=o.packageJSON?.copilot?.tests,a=s?.setupTests||s?.getSetupConfirmation;return a?await this.getDelegatedAction(a,t):void 0}getDidAlreadyPrompt(){return this._extensionContext.extensionMode===vl.Development?!!this._didAlreadyPrompt:this._extensionContext.workspaceState.get(qke,!1)}setDidAlreadyPrompt(){this._extensionContext.extensionMode===vl.Development?this._didAlreadyPrompt=!0:this._extensionContext.workspaceState.update(qke,!0)}async getDelegatedAction(e,t){try{let r=await this._commandService.executeCommand(e,t.uri);if(r)return{type:6,command:r.command,message:r.message}}catch{}}async getExtensionRecommendationAndDelegate(e,t,r){let o=this._extensionsService.getExtension(e.id);if(!o)return r;let s=o.packageJSON?.copilot?.tests?.getSetupConfirmation;return s?await this.getDelegatedAction(s,t):void 0}async getSuggestActionInner(e){let t=Ck.get(e.languageId),r=t?.forLanguage?.extension;if(r)return this.getExtensionRecommendationAndDelegate(r,e,{type:0,language:e.languageId,extension:r});if(!t?.perFramework)return{type:3,context:e};let o=await this._testDepsResolver.getTestDeps(e.languageId),s=wp(o,a=>{let c=t.perFramework.get(a);return c&&{extension:c,framework:a}});return s?this.getExtensionRecommendationAndDelegate(s.extension,e,{type:1,...s}):o.length?{type:2,framework:o[0]}:{type:3,context:e}}};Nk=E([v(0,be),v(1,Dk),v(2,Tl),v(3,qt),v(4,Bc),v(5,jd)],Nk);function jke(n,e){return`command:${n}?${encodeURIComponent(JSON.stringify(e))}`}var SS=q(Ve()),Vke=q(require("assert")),Qh=q(require("path"));var xS=q(Ve()),$B=q(require("path"));var Lk=class extends xS.PromptElement{constructor(t,r,o){super(t);this.parserService=r;this.workspaceService=o}async render(t,r,o,s){let{kind:a,testExampleFile:c}=this.props,l;try{l=await this.workspaceService.openTextDocumentAndSnapshot(c)}catch{return}let u=await fx(this.parserService,l,void 0,new Me(0,0,0,0),r.tokenBudget),d=[new xS.PromptReference(c)],p=this.workspaceService.getWorkspaceFolders().find(m=>c.path.startsWith(m.path)),f=c.path;switch(p!==void 0&&(f=$B.relative(p.path,c.path),f=f.split($B.sep).join("/")),a){case"candidateTestFile":return vscpp(xS.UserMessage,null,vscpp("references",{value:d}),"Excerpt of the existing test file at `",f,"`:",vscpp("br",null),vscpp(tt,{uri:c,code:u.text,languageId:u.languageId}),vscpp("br",null),"Because a test file exists: ",vscpp("br",null),"- Do not generate preambles, like imports, copyright headers etc.",vscpp("br",null),"- Do generate code that can be appended to the existing test file.");case"anyTestFile":return vscpp(xS.UserMessage,null,"This is a sample test file:",vscpp("br",null),vscpp(tt,{uri:c,code:u.text,languageId:u.languageId}))}}};Lk=E([v(1,ft),v(2,Be)],Lk);var WB=q(Ve());var jy=class extends WB.PromptElement{constructor(t,r){super(t);this.testDepsResolver=r}async render(t,r){let{languageId:o}=this.props,s=await this.testDepsResolver.getTestDeps(o);return s.length>0&&vscpp(WB.UserMessage,null,"The project has the following testing dependencies: ",s.join(", "),".")}};jy=E([v(1,Dk)],jy);var YB=q(require("path"));function QB({workspaceService:n,chatVariables:e,userQuery:t,testFileToWriteTo:r,testedSymbolIdentifier:o,context:s}){let a=o?`\`${o}\``:"my code",c=e.substituteVariablesWithReferences(t),l=KB(n,r.path),u=[];if(u.push(`Please, generate tests for ${a}.`),l!==null){let p=`The tests will be placed in \`${l}\``;p+=l.includes("/")?".":` located in the same directory as \`${KB(n,s.document.uri.path)}\`.`,u.push(p),u.push("Generate tests accordingly.")}return u.push(c),u.filter(p=>p!=="").join(" ").trim()}function KB(n,e){let t=n.getWorkspaceFolders().find(s=>e.startsWith(s.path));return t===void 0?null:YB.relative(t.path,e).split(YB.sep).join("/")}var Ok=class{constructor(e,t,r,o,s,a,c,l,u){this.intent=e;this.endpoint=t;this.location=r;this.documentContext=o;this.alreadyConsumedChatVariable=s;this.instantiationService=a;this.workspaceService=c;this.ignoreService=l;this._parserService=u;this._testFileFinder=this.instantiationService.createInstance(uf)}async buildPrompt(e,t,r){(0,Vke.default)(!x0(this.documentContext.document),"TestFromSourceInvocation should not be invoked from a test file");let o=await this.findTestFileForSourceFile(r);if(o!==null&&o.kind==="candidateTestFile")this._testFileToWriteTo={kind:"existing",uri:o.testExampleFile};else{let l=T8(this.documentContext.document);this._testFileToWriteTo={kind:"new",uri:l}}let s;if(this._testFileToWriteTo.kind==="new")s=new Me(0,0,0,0);else{let l=this._testFileToWriteTo.uri,u=await this.workspaceService.openTextDocument(l),d=this._parserService.getTreeSitterAST(u),p=d?await d.findLastTest():null;if(p===null)s=new Me(u.lineCount,0,u.lineCount,0);else{let f=u.positionAt(p.endIndex),m=f.line+1;s=new Me(f.line,f.character,m,0)}}return t.report(new A5(this._testFileToWriteTo.uri,s)),this.location===2&&!e.query&&(e={...e,query:"Write a set of detailed unit test functions for the code above."}),await Fe.create(this.instantiationService,this.endpoint,DO,{context:this.documentContext,endpoint:this.endpoint,location:this.location,testExampleFile:o,testFileToWriteTo:this._testFileToWriteTo,promptContext:e,alreadyConsumedChatVariable:this.alreadyConsumedChatVariable}).render(t,r)}async processResponse(e,t,r,o){let s=this.documentContext.document,a=this._additionalResponseParts;this._additionalResponseParts=void 0;let c=this._testFileToWriteTo?.kind,l=this._testFileToWriteTo?.uri;if(this._testFileToWriteTo=void 0,c===void 0||l===void 0)Vs(a,"Expected to have a textual response without a test file");else if(c==="new"){let u=new Me(0,0,0,0),d=new qa("",Rn.empty,s.languageId);await new s0(l,d,this.documentContext.fileIndentInfo,Cs.Emit,1,(f,m)=>new r0(m,u.start,f),Zi.createCodeBlockClassifier(),f=>!0).processResponse(e,t,r,o)}else{let u=await this.workspaceService.openTextDocumentAndSnapshot(l),d=this._parserService.getTreeSitterAST(u),p=d?await d.findLastTest():null,f;if(p===null)f=new Me(u.lineCount,0,u.lineCount,0);else{let b=u.positionAt(p.endIndex),_=b.line+1;f=new Me(b.line,b.character,_,0)}let h=(await FD(this._parserService,u,this.documentContext.fileIndentInfo,f,u.getText().length)).splitAroundOriginalSelectionEnd(),g="$PLACEHOLDER$";await h.createReplyInterpreter(yT.chain(b=>qQ(b,"`"+g+"`","selection"),b=>qQ(b,g,"selection")),1,h.insertStreaming,Zi.createCodeBlockClassifier(),b=>b.value.trim()!==g).processResponse(e,t,r,o)}a?.forEach(u=>r.push(u))}async findTestFileForSourceFile(e){let t,r=await this._testFileFinder.findTestFileForSourceFile(this.documentContext.document,e);if(e.isCancellationRequested)return null;if(r!==void 0)t="candidateTestFile";else{let o=await this._testFileFinder.findAnyTestFileForSourceFile(this.documentContext.document,e);if(e.isCancellationRequested)return null;t="anyTestFile",r=o}return r===void 0||await this.ignoreService.isCopilotIgnored(r)?null:{kind:t,testExampleFile:r}}};Ok=E([v(5,H),v(6,Be),v(7,Te),v(8,ft)],Ok);var DO=class extends SS.PromptElement{constructor(t,r,o){super(t);this.parserService=r;this.workspaceService=o}async render(t,r){let{history:o,query:s,chatVariables:a}=this.props.promptContext,{context:c,testExampleFile:l,testFileToWriteTo:u,location:d,alreadyConsumedChatVariable:p}=this.props,f=this.parserService.getTreeSitterAST(c.document),m=c.selection,h,g;if(f!==void 0){let R=await f.getNodeToDocument(No(c.selection,c.document));m=Gs(c.document,R.nodeToDocument),h=R.nodeIdentifier,g=R.nodeToDocument.type}let y=["typescript","typescriptreact"].includes(c.document.languageId)&&g!==void 0&&["class_declaration","method_definition"].includes(g)?{costFnOverride:(R,k)=>R&&(R.kind==="constructor"||R.kind==="method_definition")?0:k}:void 0,b=await fx(this.parserService,c.document,c.fileIndentInfo,m,r.tokenBudget/2,y),_=c.language.languageId,x=await this.computeLangSpecificExtraGuidelines(c,l),I=QB({workspaceService:this.workspaceService,chatVariables:a,userQuery:s,testFileToWriteTo:u.uri,testedSymbolIdentifier:h,context:c}),S=KB(this.workspaceService,c.document.uri.path)??Qh.basename(c.document.uri.path),w=p===void 0?a:a.filter(R=>R.reference!==p);return vscpp(vscppf,null,vscpp(SS.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),vscpp(vn,null),vscpp("br",null),vscpp(Ze,null)),vscpp(Nt,{history:o,passPriority:!0,historyPriority:700},vscpp(Tt,{priority:1e3},d===1?vscpp(vscppf,null,"The user has a ",_," file opened in a code editor.",vscpp("br",null),"The user includes some code snippets from the file.",vscpp("br",null),"Answer with a single ",_," code block."):d===2?vscpp(vscppf,null,"First think step-by-step - describe your plan for what to build in pseudocode, written out in great detail.",vscpp("br",null),"Then output the code in a single code block.",vscpp("br",null),"Minimize any other prose.",vscpp("br",null),"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn."):void 0,x.length>0&&vscpp(vscppf,null,vscpp("br",null)," ",x))),vscpp(jy,{languageId:_,priority:750}),vscpp(SS.UserMessage,{priority:725},vscpp(sn,{languageId:c.language.languageId,includeTestGenerationInstructions:!0})),vscpp(tn,{priority:750,endpoint:r.endpoint,promptContext:this.props.promptContext,flexGrow:1}),vscpp(Ai,{priority:750,chatVariables:w}),l!==null&&vscpp(Lk,{priority:750,...l}),vscpp(SS.UserMessage,{priority:900},"Here is the current file at `",S,"`:",vscpp("br",null),vscpp("br",null),vscpp(tt,{uri:c.document.uri,languageId:c.document.languageId,code:b.text}),vscpp("br",null),vscpp("br",null),I))}async computeLangSpecificExtraGuidelines(t,r){let o=[];if(t.document.languageId==="python"&&!(r!==null&&r.kind==="candidateTestFile")){o.push("Make sure your answer imports the function to test as this is a total new file.");let a=Qh.dirname(t.document.uri.fsPath),c=Qh.join(a,"__init__.py"),l=this.workspaceService.getWorkspaceFolder(t.document.uri);try{await this.workspaceService.openTextDocument(zt.file(c)),l!==void 0&&Qh.resolve(a)===Qh.resolve(l?.fsPath??"")?o.push("The file is in the root of the workspace, which has an __init__.py but use an absolute import to import the function to test."):o.push("The parent directory of the given file has an __init__.py file making it a regular package. Use a relative import to import the function to test.")}catch{o.push("The parent directory of the given file has no __init__.py file making it a namespace package. Use an absolute import to import the function to test.")}}return o.join(`
`)}};DO=E([v(1,ft),v(2,Be)],DO);var Xh=q(Ve());var XB=q(Ve()),Gke=q(require("assert"));var Mk=class extends XB.PromptElement{constructor(t,r,o,s){super(t);this.instaService=r;this.ignoreService=o;this.workspaceService=s}async render(t,r){let{documentContext:o,srcFile:s}=this.props;(0,Gke.default)(x0(o.document),"Test2Impl must be invoked on a test file.");let a=this.instaService.createInstance(uf),c,l;if(s?(c=s.uri,l=s.target):c=await a.findFileForTestFile(o.document,Zt.None),c===void 0||await this.ignoreService.isCopilotIgnored(c))return;let u=await this.workspaceService.openTextDocumentAndSnapshot(c),p=await this.instaService.createInstance(Jp).summarizeDocument(u,o.fileIndentInfo,l,r.tokenBudget),f=[new Xo.PromptReference(c)];return vscpp(XB.UserMessage,null,vscpp("references",{value:f}),"Below is the file located at ",c.path,":",vscpp("br",null),vscpp(tt,{code:p.text,uri:c,languageId:o.document.languageId}))}};Mk=E([v(1,H),v(2,Te),v(3,Be)],Mk);var Fk=class{constructor(e,t,r,o,s,a,c){this.intent=e;this.endpoint=t;this.location=r;this.context=o;this.alreadyConsumedChatVariable=s;this.instantiationService=a;this.testGenInfoStorage=c;this.replyInterpreter=null}async buildPrompt(e,t,r){let o=this.testGenInfoStorage.sourceFileToTest;o!==void 0&&(this.testGenInfoStorage.sourceFileToTest=void 0);let a=await Fe.create(this.instantiationService,this.endpoint,NO,{context:this.context,promptContext:e,alreadyConsumedChatVariable:this.alreadyConsumedChatVariable,testGenInfo:o}).render(t,r);return this.replyInterpreter=a.metadata.get($s)?.replyInterpreter??null,a}async processResponse(e,t,r,o){return Vs(this.replyInterpreter!==null,"TestFromTestInvocation should have received replyInterpreter from its prompt element"),this.replyInterpreter.processResponse(e,t,r,o)}};Fk=E([v(5,H),v(6,iC)],Fk);var NO=class extends Xh.PromptElement{constructor(t,r,o){super(t);this.workspaceService=r;this.parserService=o}async render(t,r){let{history:o,query:s,chatVariables:a}=this.props.promptContext,{context:c,testGenInfo:l,alreadyConsumedChatVariable:u}=this.props;if(an(c.document.uri))throw ur("TestFromTestPrompt should not be used for notebooks");let d=l?.identifier,p=l===void 0?`Please, generate more tests, taking into account existing tests. ${s}`.trim():QB({workspaceService:this.workspaceService,chatVariables:a,userQuery:s,testFileToWriteTo:c.document.uri,testedSymbolIdentifier:d,context:c}),f;if(l!==void 0){let g=await this.workspaceService.openTextDocument(l.uri),y=l.target.start,b=l.target.with(y.with(y.line,0));f=g.getText(b)}let m=await lu.create(this.parserService,c.document,c.fileIndentInfo,c.wholeRange,0),h=u===void 0?a:a.filter(g=>g.reference!==u);return vscpp(vscppf,null,vscpp(Xh.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),vscpp(vn,null),vscpp("br",null),vscpp(Ze,null)),vscpp(Nt,{passPriority:!0,history:o,historyPriority:700},vscpp(Tt,{priority:1e3},"The user has a ",c.language.languageId," file opened in a code editor.",vscpp("br",null),"The user includes some code snippets from the file.",vscpp("br",null),"Answer with a single ",c.language.languageId," code block.",vscpp("br",null),"Your expertise is strictly limited to software development topics.",vscpp("br",null))),vscpp(jy,{priority:750,languageId:c.language.languageId}),vscpp(Xh.UserMessage,{priority:725},vscpp(sn,{languageId:c.language.languageId,includeTestGenerationInstructions:!0})),vscpp(tn,{priority:750,endpoint:r.endpoint,promptContext:this.props.promptContext,flexGrow:1}),vscpp(Ai,{priority:750,chatVariables:h}),vscpp(Mk,{priority:800,documentContext:c,srcFile:l}),vscpp(Xh.UserMessage,{priority:900},vscpp(Pc,{documentData:m,tokenBudget:r.tokenBudget/3,_allowEmptySelection:!0})),l!==void 0&&f!==void 0&&vscpp(Xh.UserMessage,{priority:900},`Repeating excerpt from \`${l?.uri.path}\` here that needs to be tested:`,vscpp("br",null),vscpp(tt,{uri:l.uri,languageId:c.language.languageId,code:f})),vscpp(Xh.UserMessage,{priority:900},p))}};NO=E([v(1,Be),v(2,ft)],NO);var Bk=q(Ve());var Uk=class{constructor(e,t,r,o){this.chatMlFetcher=e;this.endpointProvider=t;this.instantiationService=r;this.logService=o}async parse(e){let t=await this.endpointProvider.getChatEndpoint("gpt-4o-mini"),o=await Fe.create(this.instantiationService,t,Lre,{query:e}).render(),s=await this.chatMlFetcher.fetchOne("testGenParseUserQuery",o.messages,void 0,Zt.None,5,t);return s.type==="success"?this.processResponse(s.value):null}processResponse(e){let t=e.split(/\r\n|\r|\n/).filter(o=>o!=="");t.at(0)!=="```"&&(t.splice(0,1),t.at(-1)==="```"&&t.splice(t.length-1,1),e=t.join(`
`));let r;try{r=JSON.parse(e)}catch(o){return this.logService.internal.error(`Failed to parse user query response
Response:
${e}
Error:
${o}`),null}return this.isParsedUserQuery(r)?r:null}isParsedUserQuery(e){if(typeof e!="object"||e===null)return!1;let t=e;if(t.fileToTest!==void 0&&typeof t.fileToTest!="string")return!1;if(t.symbolsToTest!==void 0){if(!Array.isArray(t.symbolsToTest))return!1;for(let r of t.symbolsToTest)if(typeof r!="string")return!1}return!0}};Uk=E([v(0,Et),v(1,_e),v(2,H),v(3,oe)],Uk);var Lre=class extends Bk.PromptElement{constructor(e){super(e)}render(e,t){let{query:r}=this.props;return vscpp(vscppf,null,vscpp(Bk.SystemMessage,null,`
You are a helpful assistant that parses user queries.
The user is a software developer that is asking an AI programming assistant to generate tests.
Your job is to parse the user query into a JSON object of the following shape:

\`\`\`typescript
{
	/**
	 * File reference to test.
	 */
	fileToTest?: string;
	/**
	 * Symbols in {fileToTest} to generate tests for.
	 * Can be undefined if cannot be identified from user query.
	 */
	symbolsToTest?: string[];
}
\`\`\`

You must return a JSON object of the given shape.
`),vscpp(Bk.UserMessage,null,"User query: ",r,vscpp("br",null),"Parsed query:",vscpp("br",null)))}};var qk=class{constructor(e,t,r,o,s){this.instantiationService=e;this.endpointProvider=t;this.ignoreService=r;this.workspaceService=o;this.logService=s;this.id="tests";this.locations=[2,1];this.description=zke.t("Generate unit tests for the selected code");this.commandInfo=void 0;this.requestHandler=LO}static{this.ID="tests"}get intentDetectionInput(){let e="generate_test_for_code";return{functionName:e,sampleQuestion:"Write a set of detailed unit test functions for the code above.",functionCallingBlurb:`If the user's message is related to generating tests, you should use the '${e}' function.`}}async invoke(e){let t=e.documentContext,r;if(!t){let a=await this.resolveDocContextProgrammatically(e);a&&(t=a.documentContext,r=a.alreadyConsumedChatVariable)}if(!t){let a=await this.resolveDocContextUsingLlm(e);a&&(t=a.documentContext,r=a.alreadyConsumedChatVariable)}if(!t)throw new Error("To generate tests, open a file and select code to test.");if(await this.ignoreService.isCopilotIgnored(t.document.uri))throw new Error("Copilot is disabled for this file.");let o=e.location,s=await this.endpointProvider.getChatEndpoint(e.request);return x0(t.document)?this.instantiationService.createInstance(Fk,this,s,o,t,r):this.instantiationService.createInstance(Ok,this,s,o,t,r)}async resolveDocContextProgrammatically(e){let t=e.request.references,r=0,o=[];for(let c of t)if(c.id==="copilot.file"||c.id==="vscode.file")sh(c.value)&&(r+=1,o.push([c,c.value]));else{if(!sh(c.id))continue;let l=$e.parse(c.id);l!==void 0&&o.push([c,l])}if(r>1||o.length===0)return;let[s,a]=o[0];return{documentContext:await this.createDocumentContext(a),alreadyConsumedChatVariable:s}}async resolveDocContextUsingLlm(e){let r=await this.instantiationService.createInstance(Uk).parse(e.request.prompt);if(r===null)return;let{fileToTest:o}=r;if(o!==void 0){this.log("parsedQuery",r),this.log("refs",e.request.references);for(let s=0;s<e.request.references.length;s++){let a=e.request.references[s];if(a.id!=="vscode.file"&&a.id!=="copilot.file")continue;let[c,l]=a.name.trim().split(":");if(!(c!=="file"||l===void 0||!$e.isUri(a.value)||l!==o))return{documentContext:await this.createDocumentContext(a.value),alreadyConsumedChatVariable:a}}}}async createDocumentContext(e,t){let r;try{r=await this.workspaceService.openTextDocumentAndSnapshot(e)}catch(s){this.log(`Tried opening file ${e.toString()} but got error: ${s}`);return}let o=t??new Me(new Sn(0,0),new Sn(r.lineCount-1,r.lineAt(r.lineCount-1).text.length));return{document:r,fileIndentInfo:void 0,language:Rr(r.languageId),wholeRange:o,selection:new Hp(o.start,o.end)}}log(...e){let t=e.map(r=>typeof r=="object"?JSON.stringify(r,null,"	"):r).join(`
`);this.logService.internal.debug(`[TestsIntent] ${t}`)}};qk=E([v(0,H),v(1,_e),v(2,Te),v(3,Be),v(4,oe)],qk);var LO=class extends ff{constructor(t,r,o,s,a,c,l,u,d,p,f,m,h,g,y,b,_){super(t,r,o,s,a,c,l,u,d,p,f,m,h,g,y,b);this.setupTestsDetector=_}async getResult(){return this.request.acceptedConfirmationData?.some(Hke)?(setTimeout(()=>this.getResultInner()),{}):this.getResultInner()}async getResultInner(){let t=this.documentContext&&await this.setupTestsDetector.shouldSuggestSetup(this.documentContext,this.request,this.stream);if(!t)return super.getResult();let r={};return t.type===4&&(r=await super.getResult()),this.setupTestsDetector.showSuggestion(t).forEach(o=>this.stream.push(o)),r}};LO=E([v(10,H),v(11,va),v(12,ge),v(13,oe),v(14,Et),v(15,pf),v(16,zB)],LO);var JB=q(ht());var OO=class extends ga{constructor(t,r,o,s,a,c){super(t,r,o);this.instantiationService=s;this.combinedEmbeddingIndex=a;this.workbenchService=c;this.linkification={disable:!0}}async createRenderer(t,r,o,s){return Fe.create(this.instantiationService,r,WC,{endpoint:r,promptContext:t})}processResponse(t,r,o,s){return new Ore(this.combinedEmbeddingIndex,this.workbenchService).processResponse(t,r,o,s)}};OO=E([v(3,H),v(4,Pd),v(5,ah)],OO);var Ore=class{constructor(e,t){this.combinedIndex=e;this.workbechService=t;this.stagedTextToApply="";this._incodeblock=!1}async processResponse(e,t,r,o){for await(let{delta:s}of t){if(o.isCancellationRequested)return;await this.applyDelta(s.text,r)}}async processNonReporting(e,t){let r=J_e(this.combinedIndex,e);for(let o of r)if(o.showCodeBlock&&t.markdown(o.codeBlock?o.codeBlock:e),o.command&&t.button(o.command),o.failedValidation){if((await this.workbechService.getAllCommands()).map(c=>c.command).includes(o.command.command))return;let a=o.showCodeBlock?JB.t("To apply this setting, an additional extension installation is needed."):JB.t("To execute this command, an additional extension installation is needed.");t.warning(a)}}async applyDelta(e,t){e=this.stagedTextToApply+e;let r=e.indexOf("```");if(this._incodeblock){let o=e.indexOf("```");o===-1?this.stagedTextToApply=e:(this._incodeblock=!1,e="\n```"+e.substring(0,o)+"```\n",await this.processNonReporting(e,t),this.stagedTextToApply="")}else if(r!==-1){this._incodeblock=!0;let o=e.indexOf("```",r+3);if(o!==-1)this._incodeblock=!1,t.markdown(e.substring(0,r)),await this.processNonReporting(e,t),t.markdown(e.substring(o+3));else{let s=e.substring(0,r);s&&t.markdown(s)}}else t.markdown(e)}},Hy=class{constructor(e,t){this.instantiationService=e;this.endpointProvider=t;this.id=Hy.ID;this.locations=[2];this.description=JB.t("Ask questions about VS Code");this.commandInfo={allowsEmptyArgs:!1}}static{this.ID="vscode"}get intentDetectionInput(){let e="vscode_questions";return{functionName:e,sampleQuestion:"What is the command to open the integrated terminal?",modelDescription:"Looks up information about VS Code via commands, settings, and documentation to accomplish the given editor-specific task.",functionCallingBlurb:`If the user's message is related to commands or settings in Visual Studio Code, you should use the '${e}' function.`}}async invoke(e){let t=e.location,r=await this.endpointProvider.getChatEndpoint(e.request);return this.instantiationService.createInstance(OO,this,t,r)}};Hy=E([v(0,H),v(1,_e)],Hy);X6.setIntents([new fe(nf),new fe(kh),new fe(Tk),new fe(_0),new fe(qk),new fe(bk),new fe(FT),new fe(Sk),new fe(qy),new fe(qd),new fe(Ac),new fe(Oy),new fe(My),new fe(_k),new fe(jC),new fe(B0),new fe(Hy),new fe(Ny),new fe(Uy),new fe(Fy)]);var y2=require("vscode");var ZB=q(require("fs"));var Mre=`${process.env.HOME||process.env.USERPROFILE}/.copilot-testing-gh-token`,Lut=`Tests: either GITHUB_PAT must be set, or there must be a GitHub token from an app with access to Copilot in ${Mre}. Run "npm run get_token" to get one.`;function $ke(){let n;if(process.env.GITHUB_PAT&&(n=new fe(Y1,[process.env.GITHUB_PAT])),process.env.GITHUB_OAUTH_TOKEN&&(n=new fe(X_,[process.env.GITHUB_OAUTH_TOKEN])),ZB.existsSync(Mre)){let e=ZB.readFileSync(Mre).toString();n=new fe(X_,[e.trim()])}if(!n)throw new Error(Lut);return n}var Wke=require("vscode");var jk=class extends X1{constructor(t,r,o,s,a){super(o,s,a);this._configurationService=t;this._domainService=r;this._taskSingler=new H0;this._register(Wke.authentication.onDidChangeSessions(c=>{c.provider.id===h9(this._configurationService)&&(this._logService.internal.debug("Handling onDidChangeSession."),this._handleAuthChangeEvent())})),this._register(this._domainService.onDidChangeDomains(c=>{c.dotcomUrlChanged&&(this._logService.internal.debug("Handling onDidChangeDomains."),this._handleAuthChangeEvent())})),this._handleAuthChangeEvent()}async getAnyGitHubSession(t){let r=()=>g9(this._configurationService,t),o=t?.createIfNone||t?.forceNewSession?await r():await this._taskSingler.getOrCreate("any",r);return this._anyGitHubSession=o,o}async getPermissiveGitHubSession(t){let r=()=>oxe(this._configurationService,t),o=t?.createIfNone||t?.forceNewSession?await r():await this._taskSingler.getOrCreate("permissive",r);return this._permissiveGitHubSession=o,o}};jk=E([v(0,be),v(1,xn),v(2,oe),v(3,gc),v(4,J_)],jk);var Kke=q(require("vscode"));var Hk=class extends ye{constructor(t){super();this.telemetryService=t}async executeCommand(t,...r){try{let o=Kke.commands.executeCommand(t,...r);return this.telemetryService.sendMSFTTelemetryEvent("automaticCommandExecutedSucceeded",{command:t,args:r?.join(",")}),o}catch(o){this.telemetryService.sendMSFTTelemetryEvent("automaticCommandExecutedFailed",{command:t,args:r?.join(","),e:o})}}};Hk=E([v(0,ge)],Hk);var Hf=q(require("vscode"));function Yke(n){return typeof n=="string"?n:JSON.stringify(n)}var eq=class extends zF{constructor(){super();this._onDidChangeConfiguration=new jt;this.onDidChangeConfiguration=this._onDidChangeConfiguration.event;this.config=Hf.workspace.getConfiguration(Cv),Hf.workspace.onDidChangeConfiguration(t=>{t.affectsConfiguration(Cv)&&(this.config=Hf.workspace.getConfiguration(Cv)),this._onDidChangeConfiguration.fire(t)})}getConfig(t){let r=this._getConfiguredValue(t);return r!==void 0?r:t.defaultValue}inspectConfig(t){return this.config.inspect(t.id)}getNonExtensionConfig(t){return Hf.workspace.getConfiguration().get(t)}_getTargetFromInspect(t){let r;return t?t.workspaceFolderValue!==void 0?r=Hf.ConfigurationTarget.WorkspaceFolder:t.workspaceValue!==void 0?r=Hf.ConfigurationTarget.Workspace:r=Hf.ConfigurationTarget.Global:r=Hf.ConfigurationTarget.Global,r}_setAdvancedConfig(t,r){let o=this.config.get(t.firstPart);return o?o[t.secondPart]=r:o={[t.secondPart]:r},this.config.update(t.firstPart,o,this._getTargetFromInspect(this.config.inspect(t.firstPart)))}_setRegularConfig(t,r){return this.config.update(t.id,r,this._getTargetFromInspect(this.config.inspect(t.id)))}setConfig(t,r){return t.firstPart==="advanced"?this._setAdvancedConfig(t,r):this._setRegularConfig(t,r)}getExperimentBasedConfig(t,r){let o=this._getConfiguredValue(t);if(o!==void 0)return o;let s=r.getTreatmentVariable("vscode",`copilotchat.config.${t.id}`);return s!==void 0?s:t.defaultValue}_getConfiguredValue(t){if(this.config[t.firstPart]&&this.config[t.firstPart][t.secondPart]!==void 0)return this.config[t.firstPart][t.secondPart];let r=this.config.get(t.id);if(r!==void 0)return r}dumpConfig(){let t={};try{let o=hc.contributes.configuration.map(a=>a.properties),s=Object.assign({},...o);for(let a in s){let l=a.replace(`${Cv}.`,"").split(".").reduce((u,d)=>u[d],this.config);typeof l=="object"&&l!==null?Object.keys(l).filter(u=>u!=="secret_key").forEach(u=>t[`${a}.${u}`]=Yke(l[u])):t[a]=Yke(l)}}catch(r){console.error(`Failed to retrieve configuration properties ${r}`)}return t}};var Bre=require("vscode"),Qke=[];function Xke(){return Qke.join(`
`)}function Out(n,e){n.push(Mut(e)),n.length>40&&n.shift()}var Fre=class{constructor(e){this.session=e}onWillStartSession(){}onWillReceiveMessage(e){}onDidSendMessage(e){if(Bre.debug.activeDebugSession!==this.session)return;let t=this.extractOutput(e);t&&Out(Qke,t)}extractOutput(e){if(e.event==="output"&&(e.body.category==="stdout"||e.body.category==="stderr"))return e.body.output}onWillStopSession(){}onError(e){}onExit(e,t){}};function Mut(n){let e=/(:?\x1b\[|\x9B)[=?>!]?[\d;:]*["$#'* ]?[a-zA-Z@^`{}|~]/g;return n&&(n=n.replace(e,"")),n}function Jke(){return[Bre.debug.registerDebugAdapterTrackerFactory("*",new Ure)]}var Ure=class{createDebugAdapterTracker(e){return new Fre(e)}};var tq=class extends ye{constructor(){super();for(let e of Jke())this._register(e)}get consoleOutput(){return Xke()}};var nq=re("IDialogService");var Zke=q(require("vscode")),rq=class{showQuickPick(e,t,r){return Zke.window.showQuickPick(e,t,r)}};var tRe=q(require("path"));var iq=class n{constructor(e,t){this.lineRangeMapping=e,this.changes=t}flip(){return new n(this.lineRangeMapping.flip(),this.changes.map(e=>e.flip()))}};var oq=class{constructor(e,t){this.range=e;this.text=t}get isEmpty(){return this.range.isEmpty()&&this.text.length===0}static equals(e,t){return e.range.equalsRange(t.range)&&e.text===t.text}toSingleEditOperation(){return{range:this.range,text:this.text}}};var MO=class n{static inverse(e,t,r){let o=[],s=1,a=1;for(let l of e){let u=new n(new yn(s,l.original.startLineNumber),new yn(a,l.modified.startLineNumber));u.modified.isEmpty||o.push(u),s=l.original.endLineNumberExclusive,a=l.modified.endLineNumberExclusive}let c=new n(new yn(s,t+1),new yn(a,r+1));return c.modified.isEmpty||o.push(c),o}static clip(e,t,r){let o=[];for(let s of e){let a=s.original.intersect(t),c=s.modified.intersect(r);a&&!a.isEmpty&&c&&!c.isEmpty&&o.push(new n(a,c))}return o}constructor(e,t){this.original=e,this.modified=t}toString(){return`{${this.original.toString()}->${this.modified.toString()}}`}flip(){return new n(this.modified,this.original)}join(e){return new n(this.original.join(e.original),this.modified.join(e.modified))}get changedLineCount(){return Math.max(this.original.length,this.modified.length)}toRangeMapping(){let e=this.original.toInclusiveRange(),t=this.modified.toInclusiveRange();if(e&&t)return new Vf(e,t);if(this.original.startLineNumber===1||this.modified.startLineNumber===1){if(!(this.modified.startLineNumber===1&&this.original.startLineNumber===1))throw new Xt("not a valid diff");return new Vf(new De(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new De(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1))}else return new Vf(new De(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),new De(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER))}toRangeMapping2(e,t){if(eRe(this.original.endLineNumberExclusive,e)&&eRe(this.modified.endLineNumberExclusive,t))return new Vf(new De(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new De(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1));if(!this.original.isEmpty&&!this.modified.isEmpty)return new Vf(De.fromPositions(new Dt(this.original.startLineNumber,1),Vk(new Dt(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),De.fromPositions(new Dt(this.modified.startLineNumber,1),Vk(new Dt(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)));if(this.original.startLineNumber>1&&this.modified.startLineNumber>1)return new Vf(De.fromPositions(Vk(new Dt(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER),e),Vk(new Dt(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),De.fromPositions(Vk(new Dt(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER),t),Vk(new Dt(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)));throw new Xt}};function Vk(n,e){if(n.lineNumber<1)return new Dt(1,1);if(n.lineNumber>e.length)return new Dt(e.length,e[e.length-1].length+1);let t=e[n.lineNumber-1];return n.column>t.length+1?new Dt(n.lineNumber,t.length+1):n}function eRe(n,e){return n>=1&&n<=e.length}var sq=class n extends MO{static fromRangeMappings(e){let t=yn.join(e.map(o=>yn.fromRangeInclusive(o.originalRange))),r=yn.join(e.map(o=>yn.fromRangeInclusive(o.modifiedRange)));return new n(t,r,e)}constructor(e,t,r){super(e,t),this.innerChanges=r}flip(){return new n(this.modified,this.original,this.innerChanges?.map(e=>e.flip()))}withInnerChangesFromLineRanges(){return new n(this.original,this.modified,[this.toRangeMapping()])}},Vf=class n{static assertSorted(e){for(let t=1;t<e.length;t++){let r=e[t-1],o=e[t];if(!(r.originalRange.getEndPosition().isBeforeOrEqual(o.originalRange.getStartPosition())&&r.modifiedRange.getEndPosition().isBeforeOrEqual(o.modifiedRange.getStartPosition())))throw new Xt("Range mappings must be sorted")}}constructor(e,t){this.originalRange=e,this.modifiedRange=t}toString(){return`{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`}flip(){return new n(this.modifiedRange,this.originalRange)}toTextEdit(e){let t=e.getValueOfRange(this.modifiedRange);return new oq(this.originalRange,t)}};var Fut=tRe.join(__dirname,"diffWorker.js"),aq=class{constructor(e=Fut){this._worker=new kr(()=>new h0(e,{name:"Diff worker"}))}dispose(){this._worker.rawValue?.terminate()}async computeDiff(e,t,r){let o=await this._worker.value.proxy.computeDiff(e,t,r);return{identical:o.identical,quitEarly:o.quitEarly,changes:a(o.changes),moves:o.moves.map(c=>new iq(new MO(new yn(c[0],c[1]),new yn(c[2],c[3])),a(c[4])))};function a(c){return c.map(l=>new sq(new yn(l[0],l[1]),new yn(l[2],l[3]),l[4]?.map(u=>new Vf(new De(u[0],u[1],u[2],u[3]),new De(u[4],u[5],u[6],u[7])))))}}};var Gk=class{constructor(e,t,r,o,s,a){this._authService=e;this._tokenizerProvider=t;this._telemetryService=r;this._domainService=o;this._envService=s;this._fetcherService=a}async computeEmbeddings(e,t,r,o){let s=e.maxBatchSize,a=e.modelMaxPromptTokens-1;return this.fetchResponseWithBatches(e,t,o,a,s,r?.dimensions,r?.parallelism)}async fetchResponseWithBatches(e,t,r,o,s,a,c=1){for(let p of t)if(this._tokenizerProvider.acquireTokenizer(e).tokenLength(p)>o)return;let l=[],u=[],d=new Ap(c);try{for(let p=0;p<t.length;p+=s){let f=t.slice(p,p+s);u.push(d.queue(async()=>{if(r?.isCancellationRequested)return;let m=await this.rawEmbeddingsFetchWithTelemetry(e,Gt(),f,a,r);if(m.type==="failed")throw new Error("Embeddings request failed "+m.reason);return m}))}l=(await Promise.all(u)).flatMap(p=>p?.embeddings??[])}catch{return}finally{d.dispose()}if(!r?.isCancellationRequested)return l.length===0?void 0:{model:e.model,embeddings:l}}async rawEmbeddingsFetchWithTelemetry(e,t,r,o,s){let a=Date.now(),c=await this.rawEmbeddingsFetch(e,t,r,o,s);return c.type==="failed"?(this._telemetryService.sendMSFTTelemetryErrorEvent("embedding.error",{type:c.type,reason:c.reason}),c):(this._telemetryService.sendMSFTTelemetryEvent("embedding.success",{},{batchSize:r.length,inputTokenCount:r.reduce((l,u)=>l+this._tokenizerProvider.acquireTokenizer(e).tokenLength(u),0),timeToComplete:Date.now()-a}),c)}async rawEmbeddingsFetch(e,t,r,o,s){try{let a=await this._authService.getCopilotToken();if(o&&e.model!=="text-embedding-3-small")throw new Error("Dimensions are only supported for text-embeddings-3-small and later models.");let c={input:r,model:e.model,dimensions:o};e.interceptBody?.(c);let l=await cf(this._fetcherService,this._envService,this._telemetryService,this._domainService,e,a.token,await ja(process.env.HMAC_SECRET),"copilot-panel",t,c,s),u=l.status===200?await l.json():await l.text();return l.status===200&&u.data?{type:"success",embeddings:u.data.map(d=>d.embedding)}:{type:"failed",reason:u.error}}catch(a){let c=a?.message??"Unknown error";return c.match(/Unexpected.*JSON/i)&&(c="timeout"),{type:"failed",reason:c}}}};Gk=E([v(0,xt),v(1,Qn),v(2,ge),v(3,xn),v(4,it),v(5,hn)],Gk);var nRe="github-enterprise.uri",zk=class extends ye{constructor(t,r){super();this._configurationService=t;this._tokenStore=r;this._onDidChangeDomains=this._register(new jt);this.onDidChangeDomains=this._onDidChangeDomains.event;this._proxyBaseUrl="https://copilot-proxy.githubusercontent.com";this._telemetryBaseUrl="https://copilot-telemetry.githubusercontent.com";this._register(this._configurationService.onDidChangeConfiguration(s=>this._onDidConfigChangeHandler(s))),this._dotcomAPIUrl=this._getDotComAPIUrl();let o=this._configurationService.getConfig(le.DebugOverrideCAPIUrl);o.endsWith("/")&&(o=o.slice(0,-1)),this._capiBaseUrl=o,this._capiBaseUrl==="https://api.githubcopilot.com"&&(this._processCopilotToken(this._tokenStore.copilotToken),this._register(this._tokenStore.onDidStoreUpdate(()=>this._processCopilotToken(this._tokenStore.copilotToken))))}_onDidConfigChangeHandler(t){if(t.affectsConfiguration(`${Cv}.advanced`)||t.affectsConfiguration(nRe)){let r=this._getDotComAPIUrl();this._dotcomAPIUrl!==r&&(this._dotcomAPIUrl=r,this._onDidChangeDomains.fire({capiUrlChanged:!1,proxyUrlChanged:!1,telemeryUrlChanged:!1,dotcomUrlChanged:!0}))}}_getDotComAPIUrl(){let t=this._configurationService.getNonExtensionConfig(nRe),r=this._configurationService.getConfig(le.AuthProvider)==="github-enterprise";if(t&&r){let o=$e.parse(t);return`${o.scheme}://api.${o.authority}`}return"https://api.github.com"}_processCopilotToken(t){let r=this._capiBaseUrl,o=this._telemetryBaseUrl,s=this._proxyBaseUrl;t?(this._proxyBaseUrl=t.endpoints.proxy,this._capiBaseUrl=t.endpoints.api,this._telemetryBaseUrl=t.endpoints.telemetry):(this._capiBaseUrl="https://api.githubcopilot.com",this._telemetryBaseUrl="https://copilot-telemetry.githubusercontent.com"),(r!==this._capiBaseUrl||o!==this._telemetryBaseUrl||s!==this._proxyBaseUrl)&&this._onDidChangeDomains.fire({capiUrlChanged:r!==this._capiBaseUrl,telemeryUrlChanged:o!==this._telemetryBaseUrl,proxyUrlChanged:s!==this._proxyBaseUrl,dotcomUrlChanged:!1})}get proxyBaseURL(){return`${this._proxyBaseUrl}/v1/engines`}get capiBaseURL(){return this._capiBaseUrl}get capiChatURL(){return`${this._capiBaseUrl}/chat/completions`}get capiEmbeddingsURL(){return`${this._capiBaseUrl}/embeddings`}get capiModelsURL(){return`${this._capiBaseUrl}/models`}get chunksURL(){return`${this.dotComAPIURL}/chunks`}get telemetryURL(){return`${this._telemetryBaseUrl}/telemetry`}get remoteAgentsURL(){return`${this._capiBaseUrl}/agents`}get listSkillsURL(){return`${this._capiBaseUrl}/skills`}get searchSkillURL(){return`${this._capiBaseUrl}/search`}get contentExclusionURL(){return`${this._dotcomAPIUrl}/copilot_internal/content_exclusion`}get tokenURL(){return this._dotcomAPIUrl+"/copilot_internal/v2/token"}get dotComAPIURL(){return this._dotcomAPIUrl}};zk=E([v(0,be),v(1,gc)],zk);var Vy=q(require("vscode"));var cq=class{get sessionId(){return Vy.env.sessionId}get machineId(){return Vy.env.machineId}get remoteName(){return Vy.env.remoteName}get OS(){switch(ihe){case 3:return"Windows";case 1:return"Mac";case 2:return"Linux";default:return"Linux"}}get language(){return Vy.env.language}get uriScheme(){return Vy.env.uriScheme}isProduction(){return DF}isPreRelease(){return ml}getBuildType(){return hc.buildType}getVersion(){return hc.version}getBuild(){return hc.build}getName(){return hc.name}getEditorInfo(){return new M2("vscode",Vy.version)}getEditorPluginInfo(){return new M2("copilot-chat",hc.version)}getEditorVersionHeaders(){return{"Editor-Version":this.getEditorInfo().format(),"Editor-Plugin-Version":this.getEditorPluginInfo().format()}}};var FO=q(require("vscode")),lq=class{get all(){return FO.extensions.all}get allAcrossExtensionHosts(){return FO.extensions.allAcrossExtensionHosts}get onDidChange(){return FO.extensions.onDidChange}get getExtension(){return FO.extensions.getExtension}};var Zd=q(require("vscode")),$k=class{async stat(e){return Zd.workspace.fs.stat(e)}async readDirectory(e){return Zd.workspace.fs.readDirectory(e)}async createDirectory(e){return Zd.workspace.fs.createDirectory(e)}async readFile(e){return Zd.workspace.fs.readFile(e)}async writeFile(e,t){return Zd.workspace.fs.writeFile(e,t)}async delete(e,t){return Zd.workspace.fs.delete(e,t)}async rename(e,t,r){return Zd.workspace.fs.rename(e,t,r)}async copy(e,t,r){return Zd.workspace.fs.copy(e,t,r)}isWritableFileSystem(e){return!!Zd.workspace.fs.isWritableFileSystem(e)}createFileSystemWatcher(e){return Zd.workspace.createFileSystemWatcher(e)}};var uq=class extends $k{constructor(){super()}async readFile(e){return super.readFile(e)}};var Gy=q(require("vscode"));var Wk=class{constructor(e){this._logService=e;this._onDidChange=new Gy.EventEmitter;this.onDidChange=this._onDidChange.event;this._extensionEnablement=void 0;this._disposables=[];this._logService.public.info("Initializing Git extension service."),this._disposables.push(...this._initializeExtensionApi())}getExtensionApi(){return this._api}get extensionAvaiable(){return this._extensionEnablement===void 0?!!Gy.extensions.getExtension("vscode.git"):this._extensionEnablement}_initializeExtensionApi(){let e=[],t=Gy.extensions.getExtension("vscode.git"),r=async()=>{let o;try{o=await t.activate(),this._logService.public.info("Successfully activated the vscode.git extension.")}catch(a){this._logService.public.error(a,"Failed to activate the vscode.git extension.");return}let s=a=>{this._logService.public.info(`Enablement state of the vscode.git extension: ${a}.`),this._extensionEnablement=a,a?(this._api=o.getAPI(1),this._onDidChange.fire({enabled:!0}),this._logService.public.info("Successfully registered Git commit message provider.")):(this._api=void 0,this._onDidChange.fire({enabled:!1}))};e.push(o.onDidChangeEnablement(s)),s(o.enabled)};if(t)r();else{this._logService.public.info("vscode.git extension is not yet activated.");let o=Gy.extensions.onDidChange(()=>{!t&&Gy.extensions.getExtension("vscode.git")&&(t=Gy.extensions.getExtension("vscode.git"),r(),o.dispose())})}return e}};Wk=E([v(0,oe)],Wk);var qre=q(require("vscode"));var Au=class extends ye{constructor(t){super();this.gitExtensionService=t;this._onDidOpenRepository=new jt;this.onDidOpenRepository=this._onDidOpenRepository.event;this._onDidCloseRepository=new jt;this.onDidCloseRepository=this._onDidCloseRepository.event;this._onDidFinishInitialRepositoryDiscovery=new jt;this.onDidFinishInitialization=this._onDidFinishInitialRepositoryDiscovery.event;this._isInitialized=!1;this._register(this._onDidOpenRepository),this._register(this._onDidCloseRepository),this._register(this._onDidFinishInitialRepositoryDiscovery);let r=this.gitExtensionService.getExtensionApi();r?this.registerGitAPIListeners(r):this._register(this.gitExtensionService.onDidChange(o=>{if(o.enabled){let s=this.gitExtensionService.getExtensionApi();s&&this.registerGitAPIListeners(s)}else this._onDidFinishInitialRepositoryDiscovery.fire()}))}registerGitAPIListeners(t){this._register(t.onDidOpenRepository(r=>{let o=Au.repoToRepoContext(r);o&&this._onDidOpenRepository.fire(o)})),this._register(t.onDidCloseRepository(r=>{let o=Au.repoToRepoContext(r);o&&this._onDidCloseRepository.fire(o)})),t.state==="initialized"&&(this._onDidFinishInitialRepositoryDiscovery.fire(),this._isInitialized=!0),this._register(t.onDidChangeState(r=>{r==="initialized"&&(this._onDidFinishInitialRepositoryDiscovery.fire(),this._isInitialized=!0)}))}get isInitialized(){return this._isInitialized}async openRepository(t){let r=this.gitExtensionService.getExtensionApi();if(!r)return;let o=await r.openRepository(t);return Au.repoToRepoContext(o)}getRepository(t){let r=this.gitExtensionService.getExtensionApi();if(r)return Au.repoToRepoContext(r.getRepository(t))}async initialize(){if(this._isInitialized)return;let t=qre.workspace.workspaceFolders;if(!t)return;let r=this.gitExtensionService.getExtensionApi();if(r)for(let o of t)await r.openRepository(o.uri).catch(()=>{})}static repoToRepoContext(t){if(t)return{rootUri:t.rootUri,headBranchName:t.state.HEAD?.name,headCommitHash:t.state.HEAD?.commit,upstreamBranchName:t.state.HEAD?.upstream?.name,upstreamRemote:t.state.HEAD?.upstream?.remote,isRebasing:t.state.rebaseCommit!==null,remotes:t.state.remotes.map(r=>r.name),remoteFetchUrls:t.state.remotes.map(r=>r.fetchUrl)}}get repositories(){if(!qre.workspace.workspaceFolders)return[];let r=this.gitExtensionService.getExtensionApi();return r?zn(r.repositories.map(o=>Au.repoToRepoContext(o))):[]}};Au=E([v(0,Ji)],Au);var Kk=class extends Lv{constructor(t,r,o){super(r,o);this._authService=t}async getCurrentAuthedUser(){let t=(await this._authService.getAnyGitHubSession())?.accessToken;if(t)return await this.getCurrentAuthedUserWithToken(t)}async getTeamMembership(t){let r=await this._authService.getAnyGitHubSession(),o=r?.accessToken,s=r?.account.label;if(!(!o||!s))return await this.getTeamMembershipWithToken(t,o,s)}};Kk=E([v(0,xt),v(1,xn),v(2,hn)],Kk);var Yk=class{constructor(e,t){this._fetcherService=e;this._authenticationService=t;this.githubRepositoryInfoCache=new Map}async _doGetRepositoryInfo(e,t){let r=this._authenticationService.permissiveGitHubSession?.accessToken??this._authenticationService.anyGitHubSession?.accessToken,o={Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28"};return r&&(o.Authorization=`Bearer ${r}`),this._fetcherService.fetch(`https://api.github.com/repos/${e}/${t}`,{method:"GET",headers:o})}async getRepositoryInfo(e,t){let r=this.githubRepositoryInfoCache.get(`${e}/${t}`);if(r)return r;let o=await this._doGetRepositoryInfo(e,t);if(o.ok){let s=await o.json();return this.githubRepositoryInfoCache.set(`${e}/${t}`,s),s}throw new Error(`Failed to fetch repository info for ${e}/${t}`)}async isAvailable(e,t){try{return(await this._doGetRepositoryInfo(e,t)).ok}catch{return!1}}async getRepositoryItems(e,t,r){let o=[];try{let s=this._authenticationService.permissiveGitHubSession?.accessToken,a=r.split("/").map(l=>encodeURIComponent(l)).join("/"),c=await this._fetcherService.fetch(`https://api.github.com/repos/${e}/${t}/contents/${a}`,{method:"GET",headers:{Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28",Authorization:`Bearer ${s}`}});if(c.ok){let l=await c.json();if(Array.isArray(l))for(let u of l)"name"in u&&"path"in u&&"type"in u&&"html_url"in u&&(o.push({name:u.name,path:u.path,type:u.type,html_url:u.html_url}),u.type==="dir"&&o.push(...await this.getRepositoryItems(e,t,u.path)))}else return console.error(`Failed to fetch contents from ${e}:${t}:${r}`),[]}catch{return console.error(`Failed to fetch contents from ${e}:${t}:${r}`),[]}return o}async getRepositoryItemContent(e,t,r){try{let o=this._authenticationService.permissiveGitHubSession?.accessToken,s=r.split("/").map(c=>encodeURIComponent(c)).join("/"),a=await this._fetcherService.fetch(`https://api.github.com/repos/${e}/${t}/contents/${s}`,{method:"GET",headers:{Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28",Authorization:`Bearer ${o}`}});if(a.ok){let c=await a.json();if("content"in c){let l=Buffer.from(c.content,"base64");return new Uint8Array(l)}throw new Error("Unexpected data from GitHub")}}catch{console.error(`Failed to contents from ${e}:${t}:${r}`)}}};Yk=E([v(0,hn),v(1,xt)],Yk);var IS=q(require("vscode"));var Qk=class{constructor(e,t){this._ignoreService=e;this._store=new _t;this._entries=new kp(30);this._store.add(IS.workspace.onDidOpenTextDocument(o=>{for(let[s,a]of Array.from(this._entries))s.isClosed&&s.uri.toString()===o.uri.toString()&&(this._entries.delete(s),this._entries.set(o,a))})),this._store.add(IS.workspace.onDidChangeTextDocument(o=>{if(o.contentChanges.length===0)return;let s=this._entries.get(o.document);if(s)for(let a of o.contentChanges){let c=a.text.length-a.rangeLength;for(let l=0;l<s.length;l++){let u=s[l];u.offset>a.rangeOffset&&(s[l]=u.adjust(c))}}}));let r=async(o,s)=>{if(o.document.uri.scheme==="output")return;let a=o.document,c=this._entries.get(a);c||(c=[],this._entries.set(a,c));for(let l of s)c.push(new F2(a.offsetAt(l.start),Date.now())),l.isEmpty||c.push(new F2(a.offsetAt(l.end),Date.now()));c.length>100&&c.splice(0,33),t.internal.trace(`[HEATMAP] for ${a.uri} has ${c.length} entries`)};this._store.add(IS.window.onDidChangeTextEditorVisibleRanges(o=>{r(o.textEditor,o.visibleRanges)})),this._store.add(IS.window.onDidChangeTextEditorSelection(o=>{r(o.textEditor,o.selections)})),this._store.add(IS.window.onDidChangeActiveTextEditor(o=>{o&&r(o,o.selections)}))}dispose(){this._store.dispose(),this._entries.clear()}async getEntries(){let e=new Map;for(let[t,r]of this._entries.entries())await this._ignoreService.isCopilotIgnored(t.uri)||e.set(t,r);return e}};Qk=E([v(0,Te),v(1,oe)],Qk);var Zh=require("vscode");var jre=q(require("vscode"));var Xk=class extends g8{findTextInFiles(e,t,r,o){return Promise.resolve(jre.workspace.findTextInFiles(e,t,s=>r.report(s),o))}findFiles(e,t,r){return jre.workspace.findFiles2(e,t,r)}};function rRe(n){if(typeof n!="string")throw new TypeError("Argument must be a string.");if(!n)return n;let e=n.startsWith("!"),t=e?n.slice(1):n,r=t,o=!1;switch(t[0]==="/"&&(o=!0,r=t.slice(1)),r[0]){case"*":t[1]!=="*"&&(r="**/"+r);break;default:if((!o&&!r.includes("/")||r.endsWith("/"))&&(r="**/"+r),r.endsWith("*")||r.endsWith("?"))break;/\.[a-z\d_-]+$/.test(r)||(r.endsWith("/")||(r+="/"),r+="**")}return e?"!"+r:r}var hRe=q(fRe()),Ya=require("path");var pq=class{constructor(){this._ignoreMap=new Map;this._ignoreCache=new Map;this._searchRankCache=null}setIgnoreFile(e,t,r){let o="";e&&(o=(0,Ya.relative)(e.fsPath,(0,Ya.dirname)(t.fsPath)),o.startsWith("..")&&(o="")),this._ignoreMap.set(t.fsPath,{ignore:(0,hRe.default)().add(r),patterns:pl(r).filter(s=>s.trim()&&!s.startsWith("#")).map(rRe).map(s=>o?Ya.posix.join(o,s):s)}),this._searchRankCache=null,this._ignoreCache.clear()}removeIgnoreFile(e){this._ignoreMap.delete(e.fsPath),this._searchRankCache=null,this._ignoreCache.clear()}removeWorkspace(e){let t=0;for(let r of this._ignoreMap.keys())mRe(e.fsPath,r)&&(this._ignoreMap.delete(r),t+=1);t>0&&(this._searchRankCache=null,this._ignoreCache.clear())}asMinimatchPatterns(){return[...this._ignoreMap.values()].flatMap(e=>e.patterns)}isIgnored(e){if(this._ignoreMap.size===0)return!1;let t=e.fsPath;if(this._ignoreCache.has(t))return this._ignoreCache.get(t);let r=0,o={ignored:!1,unignored:!1};try{let s=this._searchRank;for(let a of s){r+=1;let c=(0,Ya.dirname)(a),l=(0,Ya.relative)(c,t);if(!l.startsWith("..")&&c!==t&&mRe(c,t)){let u=this._ignoreMap.get(a);if(!u)throw new Error(`No ignore patterns found for ${a}`);if(o=u.ignore.test(l),o.ignored||o.unignored)break}}return this._ignoreCache.set(t,o.ignored),o.ignored}catch{return!1}}get _searchRank(){if(this._searchRankCache!==null)return this._searchRankCache;let e={},t=r=>r.split(Ya.sep).length;return this._searchRankCache=[...this._ignoreMap.keys()].sort((r,o)=>(e[o]||=t(o))-(e[r]||=t(r)))}};function mRe(n,e){return n===e?!0:(n.charAt(n.length-1)!==Ya.sep&&(n+=Ya.sep),(0,Ya.normalize)(e).startsWith((0,Ya.normalize)(n)))}var MRe=q(kRe(),1);var BO=n=>{if(typeof n!="string")throw new TypeError("invalid pattern");if(n.length>65536)throw new TypeError("pattern is too long")};var cdt={"[:alnum:]":["\\p{L}\\p{Nl}\\p{Nd}",!0],"[:alpha:]":["\\p{L}\\p{Nl}",!0],"[:ascii:]":["\\x00-\\x7f",!1],"[:blank:]":["\\p{Zs}\\t",!0],"[:cntrl:]":["\\p{Cc}",!0],"[:digit:]":["\\p{Nd}",!0],"[:graph:]":["\\p{Z}\\p{C}",!0,!0],"[:lower:]":["\\p{Ll}",!0],"[:print:]":["\\p{C}",!0],"[:punct:]":["\\p{P}",!0],"[:space:]":["\\p{Z}\\t\\r\\n\\v\\f",!0],"[:upper:]":["\\p{Lu}",!0],"[:word:]":["\\p{L}\\p{Nl}\\p{Nd}\\p{Pc}",!0],"[:xdigit:]":["A-Fa-f0-9",!1]},qO=n=>n.replace(/[[\]\\-]/g,"\\$&"),ldt=n=>n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),RRe=n=>n.join(""),PRe=(n,e)=>{let t=e;if(n.charAt(t)!=="[")throw new Error("not in a brace expression");let r=[],o=[],s=t+1,a=!1,c=!1,l=!1,u=!1,d=t,p="";e:for(;s<n.length;){let g=n.charAt(s);if((g==="!"||g==="^")&&s===t+1){u=!0,s++;continue}if(g==="]"&&a&&!l){d=s+1;break}if(a=!0,g==="\\"&&!l){l=!0,s++;continue}if(g==="["&&!l){for(let[y,[b,_,x]]of Object.entries(cdt))if(n.startsWith(y,s)){if(p)return["$.",!1,n.length-t,!0];s+=y.length,x?o.push(b):r.push(b),c=c||_;continue e}}if(l=!1,p){g>p?r.push(qO(p)+"-"+qO(g)):g===p&&r.push(qO(g)),p="",s++;continue}if(n.startsWith("-]",s+1)){r.push(qO(g+"-")),s+=2;continue}if(n.startsWith("-",s+1)){p=g,s+=2;continue}r.push(qO(g)),s++}if(d<s)return["",!1,0,!1];if(!r.length&&!o.length)return["$.",!1,n.length-t,!0];if(o.length===0&&r.length===1&&/^\\?.$/.test(r[0])&&!u){let g=r[0].length===2?r[0].slice(-1):r[0];return[ldt(g),!1,d-t,!1]}let f="["+(u?"^":"")+RRe(r)+"]",m="["+(u?"":"^")+RRe(o)+"]";return[r.length&&o.length?"("+f+"|"+m+")":r.length?f:m,c,d-t,!0]};var zy=(n,{windowsPathsNoEscape:e=!1}={})=>e?n.replace(/\[([^\/\\])\]/g,"$1"):n.replace(/((?!\\).|^)\[([^\/\\])\]/g,"$1$2").replace(/\\([^\/])/g,"$1");var udt=new Set(["!","?","+","*","@"]),ARe=n=>udt.has(n),ddt="(?!(?:^|/)\\.\\.?(?:$|/))",fq="(?!\\.)",pdt=new Set(["[","."]),fdt=new Set(["..","."]),mdt=new Set("().*{}+?[]^$\\!"),hdt=n=>n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),Yre="[^/]",DRe=Yre+"*?",NRe=Yre+"+?",Jk=class n{type;#t;#i;#d=!1;#n=[];#c;#a;#m;#s=!1;#r;#e;#p=!1;constructor(e,t,r={}){this.type=e,e&&(this.#i=!0),this.#c=t,this.#t=this.#c?this.#c.#t:this,this.#r=this.#t===this?r:this.#t.#r,this.#m=this.#t===this?[]:this.#t.#m,e==="!"&&!this.#t.#s&&this.#m.push(this),this.#a=this.#c?this.#c.#n.length:0}get hasMagic(){if(this.#i!==void 0)return this.#i;for(let e of this.#n)if(typeof e!="string"&&(e.type||e.hasMagic))return this.#i=!0;return this.#i}toString(){return this.#e!==void 0?this.#e:this.type?this.#e=this.type+"("+this.#n.map(e=>String(e)).join("|")+")":this.#e=this.#n.map(e=>String(e)).join("")}#h(){if(this!==this.#t)throw new Error("should only call on root");if(this.#s)return this;this.toString(),this.#s=!0;let e;for(;e=this.#m.pop();){if(e.type!=="!")continue;let t=e,r=t.#c;for(;r;){for(let o=t.#a+1;!r.type&&o<r.#n.length;o++)for(let s of e.#n){if(typeof s=="string")throw new Error("string part in extglob AST??");s.copyIn(r.#n[o])}t=r,r=t.#c}}return this}push(...e){for(let t of e)if(t!==""){if(typeof t!="string"&&!(t instanceof n&&t.#c===this))throw new Error("invalid part: "+t);this.#n.push(t)}}toJSON(){let e=this.type===null?this.#n.slice().map(t=>typeof t=="string"?t:t.toJSON()):[this.type,...this.#n.map(t=>t.toJSON())];return this.isStart()&&!this.type&&e.unshift([]),this.isEnd()&&(this===this.#t||this.#t.#s&&this.#c?.type==="!")&&e.push({}),e}isStart(){if(this.#t===this)return!0;if(!this.#c?.isStart())return!1;if(this.#a===0)return!0;let e=this.#c;for(let t=0;t<this.#a;t++){let r=e.#n[t];if(!(r instanceof n&&r.type==="!"))return!1}return!0}isEnd(){if(this.#t===this||this.#c?.type==="!")return!0;if(!this.#c?.isEnd())return!1;if(!this.type)return this.#c?.isEnd();let e=this.#c?this.#c.#n.length:0;return this.#a===e-1}copyIn(e){typeof e=="string"?this.push(e):this.push(e.clone(this))}clone(e){let t=new n(this.type,e);for(let r of this.#n)t.copyIn(r);return t}static#u(e,t,r,o){let s=!1,a=!1,c=-1,l=!1;if(t.type===null){let m=r,h="";for(;m<e.length;){let g=e.charAt(m++);if(s||g==="\\"){s=!s,h+=g;continue}if(a){m===c+1?(g==="^"||g==="!")&&(l=!0):g==="]"&&!(m===c+2&&l)&&(a=!1),h+=g;continue}else if(g==="["){a=!0,c=m,l=!1,h+=g;continue}if(!o.noext&&ARe(g)&&e.charAt(m)==="("){t.push(h),h="";let y=new n(g,t);m=n.#u(e,y,m,o),t.push(y);continue}h+=g}return t.push(h),m}let u=r+1,d=new n(null,t),p=[],f="";for(;u<e.length;){let m=e.charAt(u++);if(s||m==="\\"){s=!s,f+=m;continue}if(a){u===c+1?(m==="^"||m==="!")&&(l=!0):m==="]"&&!(u===c+2&&l)&&(a=!1),f+=m;continue}else if(m==="["){a=!0,c=u,l=!1,f+=m;continue}if(ARe(m)&&e.charAt(u)==="("){d.push(f),f="";let h=new n(m,d);d.push(h),u=n.#u(e,h,u,o);continue}if(m==="|"){d.push(f),f="",p.push(d),d=new n(null,t);continue}if(m===")")return f===""&&t.#n.length===0&&(t.#p=!0),d.push(f),f="",t.push(...p,d),u;f+=m}return t.type=null,t.#i=void 0,t.#n=[e.substring(r-1)],u}static fromGlob(e,t={}){let r=new n(null,void 0,t);return n.#u(e,r,0,t),r}toMMPattern(){if(this!==this.#t)return this.#t.toMMPattern();let e=this.toString(),[t,r,o,s]=this.toRegExpSource();if(!(o||this.#i||this.#r.nocase&&!this.#r.nocaseMagicOnly&&e.toUpperCase()!==e.toLowerCase()))return r;let c=(this.#r.nocase?"i":"")+(s?"u":"");return Object.assign(new RegExp(`^${t}$`,c),{_src:t,_glob:e})}get options(){return this.#r}toRegExpSource(e){let t=e??!!this.#r.dot;if(this.#t===this&&this.#h(),!this.type){let l=this.isStart()&&this.isEnd(),u=this.#n.map(m=>{let[h,g,y,b]=typeof m=="string"?n.#v(m,this.#i,l):m.toRegExpSource(e);return this.#i=this.#i||y,this.#d=this.#d||b,h}).join(""),d="";if(this.isStart()&&typeof this.#n[0]=="string"&&!(this.#n.length===1&&fdt.has(this.#n[0]))){let h=pdt,g=t&&h.has(u.charAt(0))||u.startsWith("\\.")&&h.has(u.charAt(2))||u.startsWith("\\.\\.")&&h.has(u.charAt(4)),y=!t&&!e&&h.has(u.charAt(0));d=g?ddt:y?fq:""}let p="";return this.isEnd()&&this.#t.#s&&this.#c?.type==="!"&&(p="(?:$|\\/)"),[d+u+p,zy(u),this.#i=!!this.#i,this.#d]}let r=this.type==="*"||this.type==="+",o=this.type==="!"?"(?:(?!(?:":"(?:",s=this.#l(t);if(this.isStart()&&this.isEnd()&&!s&&this.type!=="!"){let l=this.toString();return this.#n=[l],this.type=null,this.#i=void 0,[l,zy(this.toString()),!1,!1]}let a=!r||e||t||!fq?"":this.#l(!0);a===s&&(a=""),a&&(s=`(?:${s})(?:${a})*?`);let c="";if(this.type==="!"&&this.#p)c=(this.isStart()&&!t?fq:"")+NRe;else{let l=this.type==="!"?"))"+(this.isStart()&&!t&&!e?fq:"")+DRe+")":this.type==="@"?")":this.type==="?"?")?":this.type==="+"&&a?")":this.type==="*"&&a?")?":`)${this.type}`;c=o+s+l}return[c,zy(s),this.#i=!!this.#i,this.#d]}#l(e){return this.#n.map(t=>{if(typeof t=="string")throw new Error("string type in extglob ast??");let[r,o,s,a]=t.toRegExpSource(e);return this.#d=this.#d||a,r}).filter(t=>!(this.isStart()&&this.isEnd())||!!t).join("|")}static#v(e,t,r=!1){let o=!1,s="",a=!1;for(let c=0;c<e.length;c++){let l=e.charAt(c);if(o){o=!1,s+=(mdt.has(l)?"\\":"")+l;continue}if(l==="\\"){c===e.length-1?s+="\\\\":o=!0;continue}if(l==="["){let[u,d,p,f]=PRe(e,c);if(p){s+=u,a=a||d,c+=p-1,t=t||f;continue}}if(l==="*"){r&&e==="*"?s+=NRe:s+=DRe,t=!0;continue}if(l==="?"){s+=Yre,t=!0;continue}s+=hdt(l)}return[s,zy(e),!!t,a]}};var Qre=(n,{windowsPathsNoEscape:e=!1}={})=>e?n.replace(/[?*()[\]]/g,"[$&]"):n.replace(/[?*()[\]\\]/g,"\\$&");var Ls=(n,e,t={})=>(BO(e),!t.nocomment&&e.charAt(0)==="#"?!1:new Zk(e,t).match(n)),gdt=/^\*+([^+@!?\*\[\(]*)$/,vdt=n=>e=>!e.startsWith(".")&&e.endsWith(n),ydt=n=>e=>e.endsWith(n),bdt=n=>(n=n.toLowerCase(),e=>!e.startsWith(".")&&e.toLowerCase().endsWith(n)),_dt=n=>(n=n.toLowerCase(),e=>e.toLowerCase().endsWith(n)),xdt=/^\*+\.\*+$/,Sdt=n=>!n.startsWith(".")&&n.includes("."),Idt=n=>n!=="."&&n!==".."&&n.includes("."),Tdt=/^\.\*+$/,Cdt=n=>n!=="."&&n!==".."&&n.startsWith("."),Edt=/^\*+$/,wdt=n=>n.length!==0&&!n.startsWith("."),kdt=n=>n.length!==0&&n!=="."&&n!=="..",Rdt=/^\?+([^+@!?\*\[\(]*)?$/,Pdt=([n,e=""])=>{let t=FRe([n]);return e?(e=e.toLowerCase(),r=>t(r)&&r.toLowerCase().endsWith(e)):t},Adt=([n,e=""])=>{let t=URe([n]);return e?(e=e.toLowerCase(),r=>t(r)&&r.toLowerCase().endsWith(e)):t},Ddt=([n,e=""])=>{let t=URe([n]);return e?r=>t(r)&&r.endsWith(e):t},Ndt=([n,e=""])=>{let t=FRe([n]);return e?r=>t(r)&&r.endsWith(e):t},FRe=([n])=>{let e=n.length;return t=>t.length===e&&!t.startsWith(".")},URe=([n])=>{let e=n.length;return t=>t.length===e&&t!=="."&&t!==".."},BRe=typeof process=="object"&&process?typeof process.env=="object"&&process.env&&process.env.__MINIMATCH_TESTING_PLATFORM__||process.platform:"posix",LRe={win32:{sep:"\\"},posix:{sep:"/"}},Ldt=BRe==="win32"?LRe.win32.sep:LRe.posix.sep;Ls.sep=Ldt;var Nu=Symbol("globstar **");Ls.GLOBSTAR=Nu;var Odt="[^/]",Mdt=Odt+"*?",Fdt="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",Udt="(?:(?!(?:\\/|^)\\.).)*?",Bdt=(n,e={})=>t=>Ls(t,n,e);Ls.filter=Bdt;var Du=(n,e={})=>Object.assign({},n,e),qdt=n=>{if(!n||typeof n!="object"||!Object.keys(n).length)return Ls;let e=Ls;return Object.assign((r,o,s={})=>e(r,o,Du(n,s)),{Minimatch:class extends e.Minimatch{constructor(o,s={}){super(o,Du(n,s))}static defaults(o){return e.defaults(Du(n,o)).Minimatch}},AST:class extends e.AST{constructor(o,s,a={}){super(o,s,Du(n,a))}static fromGlob(o,s={}){return e.AST.fromGlob(o,Du(n,s))}},unescape:(r,o={})=>e.unescape(r,Du(n,o)),escape:(r,o={})=>e.escape(r,Du(n,o)),filter:(r,o={})=>e.filter(r,Du(n,o)),defaults:r=>e.defaults(Du(n,r)),makeRe:(r,o={})=>e.makeRe(r,Du(n,o)),braceExpand:(r,o={})=>e.braceExpand(r,Du(n,o)),match:(r,o,s={})=>e.match(r,o,Du(n,s)),sep:e.sep,GLOBSTAR:Nu})};Ls.defaults=qdt;var qRe=(n,e={})=>(BO(n),e.nobrace||!/\{(?:(?!\{).)*\}/.test(n)?[n]:(0,MRe.default)(n));Ls.braceExpand=qRe;var jdt=(n,e={})=>new Zk(n,e).makeRe();Ls.makeRe=jdt;var Hdt=(n,e,t={})=>{let r=new Zk(e,t);return n=n.filter(o=>r.match(o)),r.options.nonull&&!n.length&&n.push(e),n};Ls.match=Hdt;var ORe=/[?*]|[+@!]\(.*?\)|\[|\]/,Vdt=n=>n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),Zk=class{options;set;pattern;windowsPathsNoEscape;nonegate;negate;comment;empty;preserveMultipleSlashes;partial;globSet;globParts;nocase;isWindows;platform;windowsNoMagicRoot;regexp;constructor(e,t={}){BO(e),t=t||{},this.options=t,this.pattern=e,this.platform=t.platform||BRe,this.isWindows=this.platform==="win32",this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.preserveMultipleSlashes=!!t.preserveMultipleSlashes,this.regexp=null,this.negate=!1,this.nonegate=!!t.nonegate,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.nocase=!!this.options.nocase,this.windowsNoMagicRoot=t.windowsNoMagicRoot!==void 0?t.windowsNoMagicRoot:!!(this.isWindows&&this.nocase),this.globSet=[],this.globParts=[],this.set=[],this.make()}hasMagic(){if(this.options.magicalBraces&&this.set.length>1)return!0;for(let e of this.set)for(let t of e)if(typeof t!="string")return!0;return!1}debug(...e){}make(){let e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate(),this.globSet=[...new Set(this.braceExpand())],t.debug&&(this.debug=(...s)=>console.error(...s)),this.debug(this.pattern,this.globSet);let r=this.globSet.map(s=>this.slashSplit(s));this.globParts=this.preprocess(r),this.debug(this.pattern,this.globParts);let o=this.globParts.map((s,a,c)=>{if(this.isWindows&&this.windowsNoMagicRoot){let l=s[0]===""&&s[1]===""&&(s[2]==="?"||!ORe.test(s[2]))&&!ORe.test(s[3]),u=/^[a-z]:/i.test(s[0]);if(l)return[...s.slice(0,4),...s.slice(4).map(d=>this.parse(d))];if(u)return[s[0],...s.slice(1).map(d=>this.parse(d))]}return s.map(l=>this.parse(l))});if(this.debug(this.pattern,o),this.set=o.filter(s=>s.indexOf(!1)===-1),this.isWindows)for(let s=0;s<this.set.length;s++){let a=this.set[s];a[0]===""&&a[1]===""&&this.globParts[s][2]==="?"&&typeof a[3]=="string"&&/^[a-z]:$/i.test(a[3])&&(a[2]="?")}this.debug(this.pattern,this.set)}preprocess(e){if(this.options.noglobstar)for(let r=0;r<e.length;r++)for(let o=0;o<e[r].length;o++)e[r][o]==="**"&&(e[r][o]="*");let{optimizationLevel:t=1}=this.options;return t>=2?(e=this.firstPhasePreProcess(e),e=this.secondPhasePreProcess(e)):t>=1?e=this.levelOneOptimize(e):e=this.adjascentGlobstarOptimize(e),e}adjascentGlobstarOptimize(e){return e.map(t=>{let r=-1;for(;(r=t.indexOf("**",r+1))!==-1;){let o=r;for(;t[o+1]==="**";)o++;o!==r&&t.splice(r,o-r)}return t})}levelOneOptimize(e){return e.map(t=>(t=t.reduce((r,o)=>{let s=r[r.length-1];return o==="**"&&s==="**"?r:o===".."&&s&&s!==".."&&s!=="."&&s!=="**"?(r.pop(),r):(r.push(o),r)},[]),t.length===0?[""]:t))}levelTwoFileOptimize(e){Array.isArray(e)||(e=this.slashSplit(e));let t=!1;do{if(t=!1,!this.preserveMultipleSlashes){for(let o=1;o<e.length-1;o++){let s=e[o];o===1&&s===""&&e[0]===""||(s==="."||s==="")&&(t=!0,e.splice(o,1),o--)}e[0]==="."&&e.length===2&&(e[1]==="."||e[1]==="")&&(t=!0,e.pop())}let r=0;for(;(r=e.indexOf("..",r+1))!==-1;){let o=e[r-1];o&&o!=="."&&o!==".."&&o!=="**"&&(t=!0,e.splice(r-1,2),r-=2)}}while(t);return e.length===0?[""]:e}firstPhasePreProcess(e){let t=!1;do{t=!1;for(let r of e){let o=-1;for(;(o=r.indexOf("**",o+1))!==-1;){let a=o;for(;r[a+1]==="**";)a++;a>o&&r.splice(o+1,a-o);let c=r[o+1],l=r[o+2],u=r[o+3];if(c!==".."||!l||l==="."||l===".."||!u||u==="."||u==="..")continue;t=!0,r.splice(o,1);let d=r.slice(0);d[o]="**",e.push(d),o--}if(!this.preserveMultipleSlashes){for(let a=1;a<r.length-1;a++){let c=r[a];a===1&&c===""&&r[0]===""||(c==="."||c==="")&&(t=!0,r.splice(a,1),a--)}r[0]==="."&&r.length===2&&(r[1]==="."||r[1]==="")&&(t=!0,r.pop())}let s=0;for(;(s=r.indexOf("..",s+1))!==-1;){let a=r[s-1];if(a&&a!=="."&&a!==".."&&a!=="**"){t=!0;let l=s===1&&r[s+1]==="**"?["."]:[];r.splice(s-1,2,...l),r.length===0&&r.push(""),s-=2}}}}while(t);return e}secondPhasePreProcess(e){for(let t=0;t<e.length-1;t++)for(let r=t+1;r<e.length;r++){let o=this.partsMatch(e[t],e[r],!this.preserveMultipleSlashes);if(o){e[t]=[],e[r]=o;break}}return e.filter(t=>t.length)}partsMatch(e,t,r=!1){let o=0,s=0,a=[],c="";for(;o<e.length&&s<t.length;)if(e[o]===t[s])a.push(c==="b"?t[s]:e[o]),o++,s++;else if(r&&e[o]==="**"&&t[s]===e[o+1])a.push(e[o]),o++;else if(r&&t[s]==="**"&&e[o]===t[s+1])a.push(t[s]),s++;else if(e[o]==="*"&&t[s]&&(this.options.dot||!t[s].startsWith("."))&&t[s]!=="**"){if(c==="b")return!1;c="a",a.push(e[o]),o++,s++}else if(t[s]==="*"&&e[o]&&(this.options.dot||!e[o].startsWith("."))&&e[o]!=="**"){if(c==="a")return!1;c="b",a.push(t[s]),o++,s++}else return!1;return e.length===t.length&&a}parseNegate(){if(this.nonegate)return;let e=this.pattern,t=!1,r=0;for(let o=0;o<e.length&&e.charAt(o)==="!";o++)t=!t,r++;r&&(this.pattern=e.slice(r)),this.negate=t}matchOne(e,t,r=!1){let o=this.options;if(this.isWindows){let g=typeof e[0]=="string"&&/^[a-z]:$/i.test(e[0]),y=!g&&e[0]===""&&e[1]===""&&e[2]==="?"&&/^[a-z]:$/i.test(e[3]),b=typeof t[0]=="string"&&/^[a-z]:$/i.test(t[0]),_=!b&&t[0]===""&&t[1]===""&&t[2]==="?"&&typeof t[3]=="string"&&/^[a-z]:$/i.test(t[3]),x=y?3:g?0:void 0,I=_?3:b?0:void 0;if(typeof x=="number"&&typeof I=="number"){let[S,w]=[e[x],t[I]];S.toLowerCase()===w.toLowerCase()&&(t[I]=S,I>x?t=t.slice(I):x>I&&(e=e.slice(x)))}}let{optimizationLevel:s=1}=this.options;s>=2&&(e=this.levelTwoFileOptimize(e)),this.debug("matchOne",this,{file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var a=0,c=0,l=e.length,u=t.length;a<l&&c<u;a++,c++){this.debug("matchOne loop");var d=t[c],p=e[a];if(this.debug(t,d,p),d===!1)return!1;if(d===Nu){this.debug("GLOBSTAR",[t,d,p]);var f=a,m=c+1;if(m===u){for(this.debug("** at the end");a<l;a++)if(e[a]==="."||e[a]===".."||!o.dot&&e[a].charAt(0)===".")return!1;return!0}for(;f<l;){var h=e[f];if(this.debug(`
globstar while`,e,f,t,m,h),this.matchOne(e.slice(f),t.slice(m),r))return this.debug("globstar found match!",f,l,h),!0;if(h==="."||h===".."||!o.dot&&h.charAt(0)==="."){this.debug("dot detected!",e,f,t,m);break}this.debug("globstar swallow a segment, and continue"),f++}return!!(r&&(this.debug(`
>>> no match, partial?`,e,f,t,m),f===l))}let g;if(typeof d=="string"?(g=p===d,this.debug("string match",d,p,g)):(g=d.test(p),this.debug("pattern match",d,p,g)),!g)return!1}if(a===l&&c===u)return!0;if(a===l)return r;if(c===u)return a===l-1&&e[a]==="";throw new Error("wtf?")}braceExpand(){return qRe(this.pattern,this.options)}parse(e){BO(e);let t=this.options;if(e==="**")return Nu;if(e==="")return"";let r,o=null;(r=e.match(Edt))?o=t.dot?kdt:wdt:(r=e.match(gdt))?o=(t.nocase?t.dot?_dt:bdt:t.dot?ydt:vdt)(r[1]):(r=e.match(Rdt))?o=(t.nocase?t.dot?Adt:Pdt:t.dot?Ddt:Ndt)(r):(r=e.match(xdt))?o=t.dot?Idt:Sdt:(r=e.match(Tdt))&&(o=Cdt);let s=Jk.fromGlob(e,this.options).toMMPattern();return o&&typeof s=="object"&&Reflect.defineProperty(s,"test",{value:o}),s}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let e=this.set;if(!e.length)return this.regexp=!1,this.regexp;let t=this.options,r=t.noglobstar?Mdt:t.dot?Fdt:Udt,o=new Set(t.nocase?["i"]:[]),s=e.map(l=>{let u=l.map(d=>{if(d instanceof RegExp)for(let p of d.flags.split(""))o.add(p);return typeof d=="string"?Vdt(d):d===Nu?Nu:d._src});return u.forEach((d,p)=>{let f=u[p+1],m=u[p-1];d!==Nu||m===Nu||(m===void 0?f!==void 0&&f!==Nu?u[p+1]="(?:\\/|"+r+"\\/)?"+f:u[p]=r:f===void 0?u[p-1]=m+"(?:\\/|"+r+")?":f!==Nu&&(u[p-1]=m+"(?:\\/|\\/"+r+"\\/)"+f,u[p+1]=Nu))}),u.filter(d=>d!==Nu).join("/")}).join("|"),[a,c]=e.length>1?["(?:",")"]:["",""];s="^"+a+s+c+"$",this.negate&&(s="^(?!"+s+").+$");try{this.regexp=new RegExp(s,[...o].join(""))}catch{this.regexp=!1}return this.regexp}slashSplit(e){return this.preserveMultipleSlashes?e.split("/"):this.isWindows&&/^\/\/[^\/]+/.test(e)?["",...e.split(/\/+/)]:e.split(/\/+/)}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;let r=this.options;this.isWindows&&(e=e.split("\\").join("/"));let o=this.slashSplit(e);this.debug(this.pattern,"split",o);let s=this.set;this.debug(this.pattern,"set",s);let a=o[o.length-1];if(!a)for(let c=o.length-2;!a&&c>=0;c--)a=o[c];for(let c=0;c<s.length;c++){let l=s[c],u=o;if(r.matchBase&&l.length===1&&(u=[a]),this.matchOne(u,l,t))return r.flipNegate?!0:!this.negate}return r.flipNegate?!1:this.negate}static defaults(e){return Ls.defaults(e).Minimatch}};Ls.AST=Jk;Ls.Minimatch=Zk;Ls.escape=Qre;Ls.unescape=zy;var jRe="non-git-file",mq=class{constructor(e,t,r,o,s,a,c){this._gitService=e;this._logService=t;this._fetcherService=r;this._authService=o;this._domainService=s;this._fileSystemService=a;this._workspaceService=c;this._contentExclusionCache=new Map;this._contentExclusionFetchPromise=null;this._ignoreGlobResultCache=new kn;this._ignoreRegexResultCache=new Map;this._lastRuleFetch=0;this._disposables=[];this._contentExclusionCache.set(jRe,{patterns:[],ifAnyMatch:[],ifNoneMatch:[],repoRootPath:""}),this._disposables.push(this._gitService.onDidCloseRepository(l=>{let u=this.getRepositoryInfo(l);if(u)for(let d of u.fetchUrls)this._contentExclusionCache.delete(d)}))}async isIgnored(e){if(this._ignoreGlobResultCache.has(e)&&!this.isRegexContextExclusionsEnabled||this._ignoreGlobResultCache.get(e))return this._ignoreGlobResultCache.get(e)??!1;this._contentExclusionFetchPromise&&await this._contentExclusionFetchPromise;let t=this._gitService.getRepository(e)??await this._gitService.openRepository(e),r=this.getRepositoryInfo(t);Date.now()-this._lastRuleFetch>30*60*1e3&&await this.makeContentExclusionRequest(),r||(r={repoRootPath:"",fetchUrls:[jRe]});let o=e.path.replace(r.repoRootPath,"");this.shouldFetchContentExclusionRules(r)&&await this.makeContentExclusionRequest();let s={nocase:!0,matchBase:!0,nonegate:!0,dot:!0};for(let{patterns:l}of this._contentExclusionCache.values())for(let u of l)if(Ls(o,u,s)||Ls(e.path,u,s))return this._logService.public.debug(`File ${e.path} is ignored by content exclusion rule ${u}`),this._ignoreGlobResultCache.set(e,!0),!0;let a="",c="";for(let l of r.fetchUrls){let{ifAnyMatch:u,ifNoneMatch:d}=this._contentExclusionCache.get(l)??{ifAnyMatch:[],ifNoneMatch:[]};if((u.length>0||d.length>0)&&!a)try{if(a=await jve(this._fileSystemService,this._workspaceService,e),c=await WT(a),this._ignoreRegexResultCache.has(c))return this._ignoreRegexResultCache.get(c)??!1}catch{return!0}if(u.length>0&&a&&u.some(p=>p.test(a)))return this._logService.public.debug(`File ${e.path} is ignored by content exclusion rule ifAnyMatch`),this._ignoreRegexResultCache.set(c,!0),!0;if(d.length>0&&a&&!d.some(p=>p.test(a)))return this._logService.public.debug(`File ${e.path} is ignored by content exclusion rule ifNoneMatch`),this._ignoreRegexResultCache.set(c,!0),!0}return this._ignoreGlobResultCache.set(e,!1),this._ignoreRegexResultCache.set(c,!1),!1}get isRegexContextExclusionsEnabled(){return[...this._contentExclusionCache.values()].some(({ifAnyMatch:e,ifNoneMatch:t})=>e.length>0||t.length>0)}async loadRepos(e){(await Promise.all(e.map(o=>this._gitService.openRepository(o)))).map(o=>this.shouldFetchContentExclusionRules(this.getRepositoryInfo(o))).some(o=>o)&&await this.makeContentExclusionRequest()}async asMinimatchPatterns(){return await this._contentExclusionFetchPromise,Array.from(this._contentExclusionCache.values()).flatMap(({patterns:t})=>t)}dispose(){this._disposables.forEach(e=>e.dispose()),this._disposables=[],this._contentExclusionCache.clear()}shouldFetchContentExclusionRules(e){if(!e)return!1;let t=!1;for(let r of e?.fetchUrls??[])this._contentExclusionCache.has(r)||(t=!0,this._contentExclusionCache.set(r,{patterns:[],ifAnyMatch:[],ifNoneMatch:[],repoRootPath:e.repoRootPath}));return t}async makeContentExclusionRequest(){this._contentExclusionFetchPromise&&await this._contentExclusionFetchPromise;try{this._contentExclusionFetchPromise=this._contentExclusionRequest(),await this._contentExclusionFetchPromise}catch{this._contentExclusionFetchPromise=null}}async _contentExclusionRequest(){this._ignoreGlobResultCache.clear();let e=Date.now(),t=this._fetcherService,r=(await this._authService.getAnyGitHubSession({silent:!0}))?.accessToken,o=Array.from(this._contentExclusionCache.keys()),s=async a=>{let c=a.join(","),l=new URL(this._domainService.contentExclusionURL);a.length!==0&&l.searchParams.set("repos",c),l.searchParams.set("scope","repo");let u=await t.fetch(l.toString(),{headers:{Authorization:`token ${r}`}});if(!u.ok){this._logService.public.error(`Failed to fetch content exclusion rules: ${u?.statusText}`);return}let d=await u.json();for(let p=0;p<d.length;p++){let f=d[p].rules.map(_=>_.paths).flat(),m=zn(d[p].rules.map(_=>_.ifAnyMatch).flat()).map(_=>HRe(_)),h=zn(d[p].rules.map(_=>_.ifNoneMatch).flat()).map(_=>HRe(_)),g=a[p],y=this._contentExclusionCache.get(g)?.repoRootPath;if(y===void 0){this._logService.public.error(`Failed to find repo root for ${g}, skipping exclusion rules`);continue}let b={patterns:Gdt(f,y),ifAnyMatch:m,ifNoneMatch:h,repoRootPath:y};this._contentExclusionCache.set(g,b),this._logService.public.trace(`Fetched content exclusion rules for ${g}: ${JSON.stringify(b)}`)}};o.length===0&&await s([]);for(let a=0;a<o.length;a+=10){let c=o.slice(a,a+10);await s(c)}this._lastRuleFetch=Date.now(),this._logService.public.info(`Fetched content exclusion rules in ${Date.now()-e}ms`),this._contentExclusionFetchPromise=null}getRepositoryInfo(e){if(!e||!e.remoteFetchUrls)return;let t=zn(e.remoteFetchUrls.map(r=>{if(r)try{return p8(r)}catch{return}}));return{repoRootPath:e.rootUri.path,fetchUrls:t}}};function Gdt(n,e){return n.map(t=>t.startsWith("/")?`${e}${t}`:t)}function HRe(n){if(!n.startsWith("/")&&!n.endsWith("/"))return new RegExp(n);let e=n.slice(1,n.lastIndexOf("/")),t=n.slice(n.lastIndexOf("/")+1);return new RegExp(e,t)}var hq=".copilotignore",gq=class{constructor(e,t,r,o,s,a,c,l){this._gitService=e;this._logService=t;this._fetcherService=r;this._authService=o;this._workspaceService=s;this._domainService=a;this.searchService=c;this.fs=l;this._copilotIgnoreFiles=new pq;this._copilotIgnoreEnabled=!1;this._onDidChangeCopilotIgnoreEnablement=new jt;this._disposables=[];this.onDidChangeCopilotIgnoreEnablement=this._onDidChangeCopilotIgnoreEnablement.event;this._disposables.push(this._onDidChangeCopilotIgnoreEnablement),this._disposables.push(this._authService.onDidAuthenticationChange(()=>{let u=this._authService.copilotToken?.isCopilotIgnoreEnabled()??!1;this._copilotIgnoreEnabled!==u&&this._onDidChangeCopilotIgnoreEnablement.fire(u),this._copilotIgnoreEnabled=u,this._copilotIgnoreEnabled===!1&&this._remoteContentExclusions&&(this._remoteContentExclusions.dispose(),this._remoteContentExclusions=void 0),this._copilotIgnoreEnabled===!0&&!this._remoteContentExclusions&&(this._remoteContentExclusions=new mq(this._gitService,this._logService,this._fetcherService,this._authService,this._domainService,this.fs,this._workspaceService))}))}dispose(){this._disposables.forEach(e=>e.dispose()),this._remoteContentExclusions&&(this._remoteContentExclusions.dispose(),this._remoteContentExclusions=void 0),this._disposables=[]}get isEnabled(){return this._copilotIgnoreEnabled}get isRegexExclusionsEnabled(){return this._remoteContentExclusions?.isRegexContextExclusionsEnabled??!1}async isCopilotIgnored(e){let t=!1;return this._copilotIgnoreEnabled&&(t=this._copilotIgnoreFiles.isIgnored(e)||await(this._remoteContentExclusions?.isIgnored(e)??!1)),t}async asMinimatchPattern(){if(!this._copilotIgnoreEnabled)return;let e=[],t=(await this.searchService.findFiles("**/.git/HEAD",{useDefaultExcludes:!1,useDefaultSearchExcludes:!1})).map(o=>$e.joinPath(o,"..",".."));await this._remoteContentExclusions?.loadRepos(t),e.push(await this._remoteContentExclusions?.asMinimatchPatterns()??[]),e.push(this._copilotIgnoreFiles.asMinimatchPatterns());let r=e.flat();if(r.length!==0)return r.length===1?r[0]:`{${r.join(",")}}`}init(){return this._init??=(async()=>{for(let e of this._workspaceService.getWorkspaceFolders())await this.addWorkspace(e)})(),this._init}trackIgnoreFile(e,t,r){t.path.endsWith(hq)&&this._copilotIgnoreFiles.setIgnoreFile(e,t,r)}removeIgnoreFile(e){e.path.endsWith(hq)&&this._copilotIgnoreFiles.removeIgnoreFile(e)}removeWorkspace(e){this._copilotIgnoreFiles.removeWorkspace(e)}isIgnoreFile(e){return!!e.path.endsWith(hq)}async addWorkspace(e){if(e.scheme!=="file")return;let t=await this.searchService.findFilesWithDefaultExcludes(new KT(e,`${hq}`),void 0,Zt.None);for(let r of t){let o=(await this.fs.readFile(r)).toString();this.trackIgnoreFile(e,r,o)}}};var eR=class extends gq{constructor(e,t,r,o,s,a,c){super(e,r,o,s,a,c,new Xk,new $k),this.installListeners()}installListeners(){this._disposables.push(Zh.workspace.onDidChangeWorkspaceFolders(e=>{for(let t of e.removed)this.removeWorkspace(t.uri);for(let t of e.added)this.addWorkspace(t.uri)})),this._disposables.push(Zh.workspace.onDidSaveTextDocument(async e=>{if(this.isIgnoreFile(e.uri)){let t=(await Zh.workspace.fs.readFile(e.uri)).toString(),r=Zh.workspace.getWorkspaceFolder(e.uri);this.trackIgnoreFile(r?.uri,e.uri,t)}}),Zh.workspace.onDidDeleteFiles(e=>{for(let t of e.files)this.removeIgnoreFile(t)}),Zh.workspace.onDidRenameFiles(async e=>{for(let t of e.files)if(this.isIgnoreFile(t.newUri)){let r=(await Zh.workspace.fs.readFile(t.newUri)).toString();this.removeIgnoreFile(t.oldUri);let o=Zh.workspace.getWorkspaceFolder(t.newUri);this.trackIgnoreFile(o?.uri,t.newUri,r)}}))}};eR=E([v(0,Ks),v(1,Ji),v(2,oe),v(3,hn),v(4,xt),v(5,Be),v(6,xn)],eR);var Xre=q(require("vscode"));var vq=class extends yC{constructor(){super(...arguments);this.onDidChangeDiagnostics=Xre.languages.onDidChangeDiagnostics}getDiagnostics(t){return Xre.languages.getDiagnostics(t)}};var $y=q(require("vscode")),yq=class{constructor(){}async getDefinitions(e,t){return await $y.commands.executeCommand("vscode.executeDefinitionProvider",e,t)}async getImplementations(e,t){return await $y.commands.executeCommand("vscode.executeImplementationProvider",e,t)}async getReferences(e,t){return await $y.commands.executeCommand("vscode.executeReferenceProvider",e,t)}async getWorkspaceSymbols(e){return await $y.commands.executeCommand("vscode.executeWorkspaceSymbolProvider",e)}async getDocumentSymbols(e){return await $y.commands.executeCommand("vscode.executeDocumentSymbolProvider",e)}getDiagnostics(e){return $y.languages.getDiagnostics(e)}};var Zre=require("stream"),GRe=q(require("stream/consumers"));var bq=class{constructor(e){let t=new ys;this.tokens=t.p,this.response=this.tokens.then(r=>r.map(o=>o.text).join("")),this.stream=new nr(async r=>{let o=[];try{for await(let s of e)o.push(s),r.emitOne(s)}catch(s){r.reject(s)}finally{t.complete(o)}})}};var zdt="https://copilot-proxy.githubusercontent.com/v1/engines/copilot-chat-fine-raw/completions",VRe={name:"fine_tuned",apiKey:"",apiKeyHeaderName:void 0,encoding:"cl100k_base",is_default:!0,params:{max_tokens:1e3,temperature:0,top_p:.5,frequency_penalty:0,presence_penalty:0,stop:[`
name:`],model:void 0,logprobs:1},url:zdt};var Jre=require("stream");var _q=class extends Jre.Transform{constructor(t){super({readableObjectMode:!0,writableObjectMode:!0});this.completionIndex=t}_transform(t,r,o){t.completionIndex===this.completionIndex&&this.push(t),o()}},xq=class n extends Jre.Transform{constructor(t,r){super({readableObjectMode:!0,writableObjectMode:!1});this.requestId=t;this.logService=r;this.buf="";this.totalTokens=0;this.aborted=!1}_transform(t,r,o){if(this.aborted){o();return}this.buf+=t.toString("utf8");let s=this.buf.split(`
`),a=null;for(let c=0;c<s.length-1;c++){let l=s[c];if(l.trim()!=="data: [DONE]"&&l.startsWith("data: ")){let u=JSON.parse(l.substring(6));if(u.error){this.logService.public.error(`Error in response for request id ${this.requestId}:${u.error.message}`),this.push(null),this.aborted=!0,o();return}for(let d of u.choices){let p=d.index,f=[];if(d.logprobs)for(let m=0;m<d.logprobs.top_logprobs.length;m++){let[h,g]=Object.entries(d.logprobs.top_logprobs[m]).reduce((_,x)=>x[1]>_[1]?x:_,["",-1/0]),y=$dt(d.logprobs.top_logprobs,h,m),b={token:h,logProb:g,topToken:y};f.push(b)}if(f.forEach(m=>{m.token=n.replaceBytes(m.token),m.topToken&&(m.topToken=n.replaceBytes(m.topToken))}),f.length===0){let m={completionId:u.id,created:u.created,completionIndex:p,text:d.text};this.push(m)}else if(f.length===1){let m={completionId:u.id,created:u.created,completionIndex:p,text:d.text,...f[0]};this.push(m)}else if(f.map(m=>m.token).join("").startsWith(d.text)){let m="",h=0;for(;!m.startsWith(d.text);){let g={completionId:u.id,created:u.created,completionIndex:p,text:f[h].token,...f[h]};this.push(g),m+=f[h].token,h++}}else a=new z0("unknown",this.requestId,"Unhandled case "+l);d.finish_reason==="content_filter"&&(this.logService.public.info(`Response got filtered for request id ${this.requestId}`),a=new z0("stop_content_filter",this.requestId,"Response got filtered")),d.finish_reason==="length"&&(this.logService.public.info(`Response too long for request id ${this.requestId}`),a=new z0("stop_length",this.requestId,"Response too long"))}}}s.length===0?this.buf="":this.buf=s[s.length-1],o(a,null)}static replaceBytes(t){if(!t.startsWith("bytes:"))return t;let r=[],o=6,s=new TextEncoder;for(;o<t.length;)if(t.slice(o,o+3)==="\\\\x")r.push(parseInt(t.slice(o+3,o+5),16)),o+=5;else if(t.slice(o,o+2)==="\\x")r.push(parseInt(t.slice(o+2,o+4),16)),o+=4;else{let a=s.encode(t.slice(o,o+1));for(let c of a)r.push(c);o+=1}return new TextDecoder("utf8",{fatal:!1}).decode(new Uint8Array(r))}};function $dt(n,e,t){if(n)return n[t]?Object.keys(n[t])[0]:e}var tR=class{constructor(e,t,r,o,s,a){this.authService=e;this.fetcherService=t;this.envService=r;this.configurationService=o;this.logService=s;this.domainService=a}async fetchNesFineTunedModel(e,t,r,o){let s={model:VRe},a,c,l,u=this.configurationService.getConfig(le.InlineEditsFineTunedModelEndpointOverride);u?(a=u.url,c=u.apiKey,l=u.apiKeyHeaderName,this.logService.public.info(`Fetching NES fine-tuned model at '${a}' with secret key '${c.slice(0,2)}...'`+(l===void 0?"":` and API key header name '${l}'`))):(a=s.model.url,c=(await this.authService.getCopilotToken()).token);let d=l===void 0?void 0:{[l]:c};return this._fetch(a,c,{prompt:e,...s.model.params,stop:t??void 0},r,o,d)}async fetchGhostText(e,t,r,o,s){let a={model:{url:"https://copilot-proxy.githubusercontent.com/v1/engines/copilot-codex/completions",apiKey:"",params:{max_tokens:500,temperature:0,n:1}}},c=a.model.apiKey.length>0?a.model.apiKey:(await this.authService.getCopilotToken()).token;return this._fetch(a.model.url,c,{prompt:e,suffix:t,...a.model.params,stop:r??void 0},o,s)}async fetchSpeculation(e,t,r,o,s){let a=this.configurationService.getConfig(le.DebugOverrideFastRewriteUrl)??this.domainService.proxyBaseURL,c=this.configurationService.getConfig(le.DebugOverrideFastRewriteEngine)??"copilot-centralus-h100",l;this.authService.speculativeDecodingEndpointToken&&(l={"Copilots-Edits-Session":this.authService.speculativeDecodingEndpointToken});let u=await this._fetch(`${a}/${c}/speculation`,(await this.authService.getCopilotToken()).token,{prompt:e,speculation:t,temperature:0,stream:!0,stop:r??void 0},o,s,l);return Br.isFailure(u)&&u.errVal==="invalid-api-key"&&(this.authService.speculativeDecodingEndpointToken=void 0),u}async _fetch(e,t,r,o,s,a){if(s.isCancellationRequested)return Br.failure("cancelled");let c=new ko(s),l={requestId:o,headers:this.getHeaders(o,t,a),body:{...r,stream:!0}},u=await this._fetchFromUrl(e,l,c.token);if(Br.isFailure(u))return c.dispose(),u.errVal==="model_error"&&u.message==="The operation was aborted."?Br.failure("cancelled"):u;if(u.value.status===200){u.value.body.on("close",()=>{c.cancel(),c.dispose()});let d=new nr(async f=>{let m=u.value.body.on("error",h=>f.reject(h)).pipe(new xq(o,this.logService)).on("error",h=>f.reject(h)).pipe(new _q(0)).on("error",h=>f.reject(h));for await(let h of m)f.emitOne(h)}),p=new bq(d);return Br.ok(p)}else{c.dispose();let d=await GRe.text(u.value.body);return d.match(/This model's maximum context length is /)?Br.failure("context-window-exceeded",d):d.match(/Access denied due to invalid subscription key or wrong API endpoint/)||u.value.status===401||u.value.status===403?Br.failure("invalid-api-key",d):d.match(/exceeded call rate limit/)?Br.failure("exceeded-rate-limit",d):Br.failure("not-200-status",[u.value.status.toString(),u.value.statusText,d].join(" "))}}async _fetchFromUrl(e,t,r){let o=this.fetcherService.makeAbortController(),s=r.onCancellationRequested(()=>{o.abort()});try{let a=await this.fetcherService.fetch(e,{headers:t.headers,json:t.body,signal:o.signal,method:"POST"});if(a.status!==200)return Br.failure("not-200-status",`status: ${a.status} statusText: "${a.statusText}"`);let c=await a.body(),l=c?new Zre.Readable().wrap(c):new Zre.Readable;return l.on("error",u=>{if(!(this.fetcherService.isAbortError(u)||u.name==="AbortError")){if(!(u.message==="ERR_HTTP2_STREAM_ERROR"||u.code==="ERR_HTTP2_STREAM_ERROR"))throw u}}),l.on("close",()=>s.dispose()),Br.ok({status:a.status,statusText:a.statusText,headers:Wdt(a.headers),body:l})}catch(a){return s.dispose(),a.code==="ECONNRESET"||a.code==="ETIMEDOUT"||a.code==="ERR_HTTP2_INVALID_SESSION"||a.message==="ERR_HTTP2_GOAWAY_SESSION"||a.code==="429"?Br.failure("model_overloaded",a.message):Br.failure("model_error",a.message)}}getHeaders(e,t,r={}){return{"Content-Type":"application/json","x-policy-id":"nil",Authorization:"Bearer "+t,"X-Request-Id":e,"VScode-SessionId":this.envService.sessionId,"VScode-MachineId":this.envService.machineId,...this.envService.getEditorVersionHeaders(),...r}}};tR=E([v(0,xt),v(1,hn),v(2,it),v(3,be),v(4,oe),v(5,xn)],tR);function Wdt(n){let e={};for(let[t,r]of n)e[t]=r;return e}var nR=class{constructor(e,t,r,o){this._logService=e;this._instantiationService=o;this._fetcher=this._getFetcher(r,t)}_getFetcher(e,t){if(e.getConfig(le.DebugUseElectronFetcher)){let s=ZE.create(t);if(s)return this._logService.public.info("Using the Electron fetcher."),s;this._logService.public.info("Can't use the Electron fetcher in this environment.")}return e.getConfig(le.DebugUseNodeFetcher)?(this._logService.public.info("Using the Node fetcher."),new JE(t)):(this._logService.public.info("Using the Helix fetcher."),this._instantiationService.createInstance(Ey))}fetch(e,t){return this._fetcher.fetch(e,t)}disconnectAll(){return this._fetcher.disconnectAll()}makeAbortController(){return this._fetcher.makeAbortController()}isAbortError(e){return this._fetcher.isAbortError(e)}isDNSLookupFailedError(e){return this._fetcher.isDNSLookupFailedError(e)}isFetcherError(e){return this._fetcher.isFetcherError(e)}getUserMessageForFetcherError(e){return this._fetcher.getUserMessageForFetcherError(e)}};nR=E([v(0,oe),v(1,it),v(2,be),v(3,H)],nR);var eie=q(require("vscode")),Sq=class{async loadKerberos(){try{return require(`${eie.env.appRoot}/node_modules.asar/kerberos`)}catch{}try{return require(`${eie.env.appRoot}/node_modules/kerberos`)}catch{}}};var zRe=q(require("os")),tie=q(require("vscode")),Iq=class{async loadCaCerts(){let e=await this.loadBuiltInWinCAModule(),t=new Set,r=new e.Crypt32;try{let o;for(;o=r.next();)t.add(Kdt(o))}finally{r.done()}return Array.from(t)}async loadBuiltInWinCAModule(){try{return require(`${tie.env.appRoot}/node_modules.asar/@vscode/windows-ca-certs`)}catch{}try{return require(`${tie.env.appRoot}/node_modules/@vscode/windows-ca-certs`)}catch{}}};function Kdt(n){let e=["-----BEGIN CERTIFICATE-----"],t=n.toString("base64");for(let r=0;r<t.length;r+=64)e.push(t.substr(r,64));return e.push("-----END CERTIFICATE-----",""),e.join(zRe.EOL)}var Gf=require("vscode");var $Re=require("vscode");var Tq=class{constructor(){this._onDidChangeNotebookCellExecutionStateEmitter=new jt;this.onDidChangeNotebookCellExecutionState=this._onDidChangeNotebookCellExecutionStateEmitter.event;this._disposables=[];this._cellExecution=new WeakMap;this._disposables.push($Re.workspace.onDidChangeNotebookDocument(e=>{for(let t of e.cellChanges)t.executionSummary&&(t.executionSummary.success===void 0?this._cellExecution.has(t.cell)||(this._cellExecution.set(t.cell,!0),this._onDidChangeNotebookCellExecutionStateEmitter.fire({cell:t.cell,state:2})):(this._cellExecution.delete(t.cell),this._onDidChangeNotebookCellExecutionStateEmitter.fire({cell:t.cell,state:1})))}))}dispose(){this._disposables.forEach(e=>e.dispose())}};var rR=class{constructor(e,t){this._configurationService=e;this._experimentationService=t;this._cellExecution=new Map;this._cellSymbols=new WeakMap;this._executionService=new Tq;this._disposables=[];this._isVariableFilteringEnabled=!1;this._isVariableFilteringEnabled=this._experimentationService.getTreatmentVariable("vscode","copilotchat.notebookVariableFiltering")||this._configurationService.getConfig(le.NotebookVariableFilteringEnabled),this._registerExecutionListener()}get isVariableFilteringEnabled(){return this._isVariableFilteringEnabled}_hasJupyterExtension(){return Gf.extensions.getExtension("ms-toolsai.jupyter")?.isActive}async getVariables(e){if(!this._hasJupyterExtension())try{let t=await Gf.commands.executeCommand("vscode.executeNotebookVariableProvider",e);if(t&&Array.isArray(t)){let r=t.map(this._convertResult);return this._filterVariables(e,r)}return[]}catch{return[]}try{let t=await Gf.commands.executeCommand("jupyter.listVariables",e);if(t&&Array.isArray(t)){let r=t.map(this._convertResult);return this._filterVariables(e,r)}return[]}catch{return[]}}_convertResult(e){return"variable"in e?e:{variable:e,hasNamedChildren:!1,indexedChildrenCount:0}}_filterVariables(e,t){if(!this.isVariableFilteringEnabled)return t;let r=new Set;return Gf.workspace.notebookDocuments.find(o=>o.uri.toString()===e.toString())?.getCells().forEach(o=>{let s=this._cellSymbols.get(o);s&&s.forEach(a=>r.add(a.name))}),t.filter(o=>r.has(o.variable.name))}async getPipPackages(e){if(!this._hasJupyterExtension())return[];try{return await Gf.commands.executeCommand("jupyter.listPipPackages",e)}catch{return[]}}setVariables(e,t){}_registerExecutionListener(){this._disposables.push(this._executionService.onDidChangeNotebookCellExecutionState(e=>{let t=e.cell,o=t.notebook.uri.toString(),s=this._cellExecution.get(o);s||(s=[],this._cellExecution.set(o,s));let a=s.findIndex(c=>c.cell===t);a!==-1&&s.splice(a,1),s.push({cell:t,executionCount:t.executionSummary?.executionOrder})})),this._disposables.push(Gf.workspace.onDidChangeNotebookDocument(e=>{if(this.isVariableFilteringEnabled){for(let t of e.cellChanges)t.executionSummary&&t.executionSummary.success&&Gf.commands.executeCommand("vscode.executeDocumentSymbolProvider",t.cell.document.uri).then(o=>{this._cellSymbols.set(t.cell,o||[])}),t.document&&this._cellSymbols.delete(t.cell);for(let t of e.contentChanges)t.removedCells.forEach(r=>{this._cellSymbols.delete(r)})}}))}getCellExecutions(e){return this._cellExecution.get(e.toString())?.map(t=>t.cell)||[]}dispose(){this._disposables.forEach(e=>e.dispose())}};rR=E([v(0,be),v(1,fn)],rR);var WRe=re("IUrlOpener"),Cq=class{constructor(){this.openedUrls=[]}open(e){this.openedUrls.push(e)}};var wq=q(require("vscode")),Eq=class{async open(e){await wq.commands.executeCommand("vscode.open",wq.Uri.parse(e))}};var EPe=q(require("path"));var uie={};Dr(uie,{_dispose:()=>YRe,_findLastTest:()=>hPe,_getCallExpressions:()=>opt,_getClassDeclarations:()=>apt,_getClassReferences:()=>upt,_getCoarseParentScope:()=>hpt,_getDocumentableNodeIfOnIdentifier:()=>pPe,_getFineScopes:()=>vpt,_getFixSelectionOfInterest:()=>gpt,_getFunctionBodies:()=>mpt,_getFunctionDefinitions:()=>spt,_getNodeMatchingSelection:()=>TS,_getNodeToDocument:()=>dPe,_getNodeToExplain:()=>ypt,_getSemanticChunkNames:()=>fpt,_getSemanticChunkTree:()=>ppt,_getStructure:()=>kpt,_getSymbols:()=>dpt,_getTestableNode:()=>fPe,_getTestableNodes:()=>mPe,_getTypeDeclarations:()=>cpt,_getTypeReferences:()=>lpt,getBlockNameTree:()=>IPe});var jO=class{constructor(e,t){this.syntaxTreeRoot=t;this.roots=[];this.formTree(e)}formTree(e){e.sort((s,a)=>s.mainBlock.startIndex-a.mainBlock.startIndex||s.mainBlock.endIndex-a.mainBlock.endIndex);let t=[],r=()=>t[t.length-1],o=(s,a)=>s.mainBlock.startIndex===a.mainBlock.startIndex&&s.mainBlock.endIndex===a.mainBlock.endIndex;for(let s of e){let a={info:s,children:[]},c=r();if(!c){this.roots.push(a),t.push(a);continue}if(!o(c.info,s)){for(;c&&!Fr.doesContain(c.info.mainBlock,s.mainBlock);)t.pop(),c=r();c?c.children.push(a):this.roots.push(a),t.push(a)}}}};var HO=q(require("path")),Ydt=kq(),Rq=class{constructor(){this.loadedLanguagesCache=new Map}loadLanguage(e){return this.loadedLanguagesCache.has(e)||this.loadedLanguagesCache.set(e,this._doLoadLanguage(e)),this.loadedLanguagesCache.get(e)}_doLoadLanguage(e){let r=`tree-sitter-${e==="csharp"?"c-sharp":e}.wasm`,o=HO.basename(__dirname)==="dist"?HO.resolve(__dirname,r):HO.resolve(__dirname,"../../../../dist",r);return Ydt.Language.load(o)}};var KRe=kq(),Pq=class n{static{this.INSTANCE=new n}static{this.CACHE_SIZE_PER_LANGUAGE=5}constructor(){this.caches=new Map,this.languageLoader=new Rq,this._parser=null}get parser(){return this._parser||(this._parser=new KRe),this._parser}async parse(e,t){await KRe.init();let r=this.getParseTreeCache(e),o=r.get(t);if(o)return o.createReference();let s=await this.languageLoader.loadLanguage(e);if(this.parser.setLanguage(s),o=r.get(t),o)return o.createReference();let a=this.parser.parse(t);return o=new nie(a),r.put(t,o),o.createReference()}dispose(){this._parser&&(this.parser.delete(),this._parser=null);for(let e of this.caches.values())e.dispose()}getParseTreeCache(e){let t=this.caches.get(e);return t||(t=new T5(n.CACHE_SIZE_PER_LANGUAGE),this.caches.set(e,t)),t}},nie=class{constructor(e){this._tree=new iie(e)}dispose(){this._tree.deref()}createReference(){return new rie(this._tree)}},rie=class{constructor(e){this._parseTree=e;this._parseTree.ref()}get tree(){return this._parseTree.tree}dispose(){this._parseTree.deref()}},iie=class{constructor(e){this._tree=e;this._refCount=1}get tree(){if(this._refCount===0)throw new Error("Cannot access disposed RefCountedParseTree");return this._tree}ref(){if(this._refCount===0)throw new Error("Cannot ref disposed RefCountedParseTree");this._refCount++}deref(){if(this._refCount===0)throw new Error("Cannot deref disposed RefCountedParseTree");this._refCount--,this._refCount===0&&this._tree.delete()}};function YRe(){Pq.INSTANCE.dispose()}function bi(n,e){return Pq.INSTANCE.parse(n,e)}var oie=class{constructor(e){this.language=e;this.map=new Map}getQuery(e){return this.map.has(e)||this.map.set(e,this.language.query(e)),this.map.get(e)}},sie=class n{constructor(){this.map=new Map}static{this.INSTANCE=new n}getQuery(e,t){return this.map.has(e)||this.map.set(e,new oie(e)),this.map.get(e).getQuery(t)}};function Sa(n,e){let t=[];for(let r of n){let s=sie.INSTANCE.getQuery(e.tree.getLanguage(),r).matches(e);t.push(...s)}return t}function VO(n,e){switch(e){case"python":case"csharp":return n.children.find(t=>t.type.match(/identifier/))?.text;case"go":{let t=n.children.find(o=>o.type.match(/identifier/));return t?t.text:n.children.find(o=>o.type.match(/spec/))?.children.find(o=>o.type.match(/identifier/))?.text}case"javascript":case"javascriptreact":case"typescript":case"typescriptreact":case"cpp":{let t=n.children.find(o=>o.type.match(/declarator/));return t?t.children.find(o=>o.type.match(/identifier/))?.text:n.children.find(o=>o.type.match(/identifier/))?.text}case"java":return n.children.find(r=>r.type==="identifier")?.text;case"ruby":return n.children.find(t=>t.type.match(/constant|identifier/))?.text;default:return n.children.find(t=>t.type.match(/identifier/))?.text}}function GO(n,e){switch(e){case"typescript":case"tsx":case"javascript":return n.type.match(/definition|declaration|declarator|export_statement/);case"go":return n.type.match(/definition|declaration|declarator|var_spec/);case"cpp":return n.type.match(/definition|declaration|class_specifier/);case"ruby":return n.type.match(/module|class|method|assignment/);default:return n.type.match(/definition|declaration|declarator/)}}function TS(n,e,t,r=GO){let o=[n.rootNode],s=[];for(;;){let a=o.map(c=>[c,Fr.intersectionSize(c,e)]).filter(([c,l])=>l>0).sort(([c,l],[u,d])=>d-l);if(a.length===0)return s.length===0?void 0:yO(s,([c,l],[u,d])=>l-d)[0];{let c=a.map(([l,u])=>{let d=Fr.len(l),p=Math.abs(Fr.len(e)-u),m=(u-p)/d;return[l,m]});s.push(...c.filter(([l,u])=>r(l,t))),o=[],o.push(...c.flatMap(([l,u])=>l.children))}}}var Tn=(()=>{function n(e,...t){return e.length===1?e[0]:e.reduce((r,o,s)=>`${r}${o}${t[s]||""}`,"")}return{typescript:n,javascript:n,python:n,go:n,ruby:n,csharp:n,cpp:n,java:n,rust:n}})();function Lu(n,e){return Object.fromEntries(n.map(t=>[t,e]))}var Qdt={javascript:[],typescript:[],tsx:[],python:[],csharp:[],go:[],java:[],ruby:[],cpp:[],rust:[]};function Ou(n){for(let e in n){let t=n[e];Qdt[e].push(...t)}return n}var QRe=Ou({...Lu(["javascript","typescript","tsx"],[`[
			(call_expression
				function: (identifier) @identifier)
			(call_expression
				function: (member_expression
					(property_identifier) @identifier))
		] @call_expression`]),python:[`[
			(call
				function: (identifier) @identifier)
			(call
				function: (attribute
					attribute: (identifier) @identifier))
		] @call_expression`],csharp:[`[
			(invocation_expression
				function: (identifier) @identifier)
			(invocation_expression
				function: (member_access_expression
					name: (identifier) @identifier))
		] @call_expression`],go:[`[
			(call_expression
				((selector_expression
					(field_identifier) @identifier)))
			(call_expression
				(identifier) @identifier)
		] @call_expression`],java:[`[
			(method_invocation
				name: (identifier) @identifier)
		] @call_expression`],ruby:[`[
			(call (identifier) @identifier
				(#not-match? @identifier "new|send|public_send|method"))
			(call
				receiver: (identifier)
				method: (identifier) @method
				(#match? @method "^(send|public_send|method)")
				arguments: (argument_list
					(simple_symbol) @symbol))
		] @call_expression`],cpp:[`[
			(function_declarator
				(identifier) @identifier)
			(function_declarator
				(field_identifier) @identifier)
			(call_expression (identifier) @identifier)
			(call_expression
				(field_expression
					field: (field_identifier) @identifier))
			(call_expression
				(call_expression
					(primitive_type)
					(argument_list
						(pointer_expression
						(identifier) @identifier))))
		] @call_expression`],rust:[`[
			(call_expression (identifier) @identifier)
			(call_expression (field_expression (identifier) (field_identifier) @identifier))
			(call_expression (scoped_identifier (identifier) (identifier) @identifier (#not-match? @identifier "new")))
		] @call_expression`]}),XRe=Ou({...Lu(["javascript","typescript","tsx"],["(class_declaration) @class_declaration"]),java:["(class_declaration) @class_declaration"],csharp:["(class_declaration) @class_declaration"],python:["(class_definition) @class_declaration"],cpp:["(class_specifier) @class_declaration"],ruby:["(class) @class_declaration"],go:[`(type_declaration
			(type_spec
				(type_identifier) @type_identifier)) @class_declaration`],rust:["(impl_item (type_identifier) @type_identifier) @class_declaration"]}),JRe=Ou({typescript:[`[
			(interface_declaration)
			(type_alias_declaration)
		] @type_declaration`],csharp:[`(interface_declaration
			(identifier) @type_identifier) @type_declaration`],cpp:[`[
			(struct_specifier
				(type_identifier) @type_identifier)
			(union_specifier
				(type_identifier) @type_identifier)
			(enum_specifier
				(type_identifier) @type_identifier)
		] @type_declaration`],java:[`(interface_declaration
			(identifier) @type_identifier) @type_declaration`],go:[`(type_declaration
			(type_spec
				(type_identifier) @type_identifier)) @type_declaration`],ruby:["((constant) @type_identifier) @type_declaration"],python:[`(class_definition
			(identifier) @type_identifier) @type_declaration`]}),ZRe=Ou({typescript:["(type_identifier) @type_identifier"],go:["(type_identifier) @type_identifier"],ruby:["(constant) @type_identifier"],csharp:[`[
			(base_list
				(identifier) @type_identifier)
			(variable_declaration
				(identifier) @type_identifier)
		]`],cpp:["(type_identifier) @type_identifier"],java:["(type_identifier) @type_identifier"],python:[`[
			(type (identifier) @type_identifier)
			(argument_list
				(identifier) @type_identifier)
		]`]}),ePe=Ou({...Lu(["javascript","typescript","tsx"],[`(new_expression
			constructor: (identifier) @new_expression)`]),python:[`(call
			function: (identifier) @new_expression)`],csharp:[`(object_creation_expression
			(identifier) @new_expression)`],java:[`(object_creation_expression
			(type_identifier) @new_expression)`],cpp:[`[
			(declaration
				(type_identifier) @new_expression)
			(class_specifier
				(type_identifier) @new_expression)
		]`],go:["(composite_literal (type_identifier) @new_expression)"],ruby:[`((call
			receiver: ((constant) @new_expression)
			method: (identifier) @method)
				(#eq? @method "new"))`],rust:[`(call_expression
			(scoped_identifier
				(identifier) @new_expression
				(identifier) @identifier
				(#eq? @identifier "new")))`]}),tPe=Ou({python:[`[
			(function_definition
				name: (identifier) @identifier
				body: (block
						(expression_statement (string))? @docstring) @body)
			(assignment
				left: (identifier) @identifier
				right: (lambda) @body)
		] @function`,'(ERROR ("def" (identifier) (parameters))) @function'],...Lu(["javascript","typescript","tsx"],[`[
			(function_expression
				name: (identifier)? @identifier
				body: (statement_block) @body)
			(function_declaration
				name: (identifier)? @identifier
				body: (statement_block) @body)
			(generator_function
				name: (identifier)? @identifier
				body: (statement_block) @body)
			(generator_function_declaration
				name: (identifier)? @identifier
				body: (statement_block) @body)
			(method_definition
				name: (property_identifier)? @identifier
				body: (statement_block) @body)
			(arrow_function
				body: (statement_block) @body)
		] @function`]),go:[`[
			(function_declaration
				name: (identifier) @identifier
				body: (block) @body)
			(method_declaration
				name: (field_identifier) @identifier
				body: (block) @body)
		] @function`],ruby:[`[
			(method
				name: (_) @identifier
				parameters: (method_parameters)? @params
				[(_)+ "end"] @body)
			(singleton_method
				name: (_) @identifier
				parameters: (method_parameters)? @params
				[(_)+ "end"] @body)
		] @function`],csharp:[`[
			(constructor_declaration
				(identifier) @identifier
				(block) @body)
			(destructor_declaration
				(identifier) @identifier
				(block) @body)
			(operator_declaration
				(block) @body)
			(method_declaration
				(identifier) @identifier
				(block) @body)
			(local_function_statement
				(identifier) @identifier
				(block) @body)
		] @function`],cpp:[`[
			(function_definition
				(_
					(identifier) @identifier)
					(compound_statement) @body)
			(function_definition
				(function_declarator
					(qualified_identifier
						(identifier) @identifier))
					(compound_statement) @body)
		] @function`],java:[`[
			(constructor_declaration
				name: (identifier) @identifier
				body: (constructor_body) @body)
			(method_declaration
				name: (_) @identifier
				body: (block) @body)
			(lambda_expression
				body: (block) @body)
		] @function`],rust:[`[
			(function_item (identifier) @identifier)
			(let_declaration (identifier) @identifier)
		] @function`]}),O$n=Ou({javascript:[Tn.javascript`((comment) @comment
			(#match? @comment "^\\\\/\\\\*\\\\*")) @docComment`],...Lu(["typescript","tsx"],[Tn.typescript`((comment) @comment
			(#match? @comment "^\\\\/\\\\*\\\\*")) @docComment`]),java:[Tn.java`((block_comment) @block_comment
			(#match? @block_comment "^\\\\/\\\\*\\\\*")) @docComment`],cpp:[Tn.cpp`((comment) @comment
			(#match? @comment "^\\\\/\\\\*\\\\*")) @docComment`],csharp:[Tn.csharp`(
			((comment) @c
				(#match? @c "^\\\\/\\\\/\\\\/"))+
		) @docComment`],rust:[Tn.rust`((line_comment) @comment
			(#match? @comment "^\/\/\/|^\/\/!"))+ @docComment`],go:[Tn.go`((comment)+) @docComment`],ruby:[Tn.ruby`((comment)+) @docComment`],python:[`(expression_statement
			(string) @docComment)`]}),aie=Ou({javascript:[Tn.javascript`[
			(function_declaration
				(identifier) @function.identifier
			) @function

			(generator_function_declaration
				name: (identifier) @generator_function.identifier
			) @generator_function

			(class_declaration
				name: (identifier) @class.identifier ;; note: (type_identifier) in typescript
				body: (class_body
							(method_definition
								name: (property_identifier) @method.identifier
							) @method
						)
			) @class
		]`],...Lu(["typescript","tsx"],[Tn.typescript`[
				(function_declaration
					(identifier) @function.identifier
				) @function

				(generator_function_declaration
					name: (identifier) @generator_function.identifier
				) @generator_function

				(class_declaration
					name: (type_identifier) @class.identifier
					body: (class_body
								(method_definition
									(accessibility_modifier)? @method.accessibility_modifier
									name: (property_identifier) @method.identifier
									(#not-eq? @method.accessibility_modifier "private")
								) @method
							)
				) @class
			]`]),python:[Tn.python`[
				(function_definition
					name: (identifier) @function.identifier
				) @function
			]`],go:[Tn.go`[
				(function_declaration
					name: (identifier) @function.identifier
				) @function

				(method_declaration
					name: (field_identifier) @method.identifier
				) @method
			]`],ruby:[Tn.ruby`[
				(method
					name: (identifier) @method.identifier
				) @method

				(singleton_method
					name: (_) @singleton_method.identifier
				) @singleton_method
			]`],csharp:[Tn.csharp`[
				(constructor_declaration
					(identifier) @constructor.identifier
				) @constructor

				(destructor_declaration
					(identifier) @destructor.identifier
				) @destructor

				(method_declaration
					(identifier) @method.identifier
				) @method

				(local_function_statement
					(identifier) @local_function.identifier
				) @local_function
			]`],cpp:[Tn.cpp`[
				(function_definition
					(_
						(identifier) @identifier)
				) @function
			]`],java:[Tn.java`(class_declaration
			name: (_) @class.identifier
			body: (_
						[
							(constructor_declaration
								(modifiers)? @constructor.modifiers
								(#not-eq? @constructor.modifiers "private")
								name: (identifier) @constructor.identifier
							) @constructor

							(method_declaration
								(modifiers)? @method.modifiers
								(#not-eq? @method.modifiers "private")
								name: (identifier) @method.identifier
							) @method
						]
					)
		) @class`],rust:[Tn.rust`[
				(function_item
					(identifier) @function.identifier
				) @function
			]`]}),nPe=Ou({javascript:[Tn.javascript`[
			(identifier) @symbol
			(property_identifier) @symbol
			(private_property_identifier) @symbol
		]`],...Lu(["typescript","tsx"],[Tn.typescript`[
			(identifier) @symbol
			(type_identifier) @symbol
			(property_identifier) @symbol
			(private_property_identifier) @symbol
		]`]),cpp:[Tn.cpp`[
			(identifier) @symbol
			(type_identifier) @symbol
		]`],csharp:[Tn.csharp`[
			(identifier) @symbol
		]`],go:[Tn.go`[
			(identifier) @symbol
		]`],java:[Tn.java`[
			(identifier) @symbol
		]`],python:[Tn.python`[
			(identifier) @symbol
		]`],ruby:[Tn.ruby`[
			(identifier) @symbol
		]`],rust:[Tn.rust`[
			(identifier) @symbol
		]`]}),rPe=Ou({typescript:[Tn.typescript`
			[
				(comment) @comment ;; split into multiple comment kinds?

				(declaration) @declaration

				;; class declaration related
				(public_field_definition) @public_field_definition
				(method_definition) @method_definition
				(class_declaration (_ (method_signature) @method_signature))
				(abstract_method_signature) @abstract_method_signature

				;; enum declaration related
				(enum_assignment) @enum_assignment

				;; interface declaration related
				(interface_declaration (_ (method_signature) @method_signature))
				(interface_declaration (_ (property_signature) @property_signature))

				;; statements

				(import_statement) @import_statement
				(export_statement) @export_statement

				(expression_statement) @expression_statement

				(for_in_statement) @for_in_statement
				;; exclude any children found in the for loop condition
				(for_statement condition: (_) @for_statement.exclude_captures ) @for_statement
				(break_statement) @break_statement
				(continue_statement) @continue_statement
				(do_statement) @do_statement
				(if_statement) @if_statement
				(if_statement
					consequence: [
						(expression_statement)
						(if_statement)
					] @if_statement.exclude_captures)
				(else_clause
					[
						(expression_statement)
						(if_statement) ; for if-else chains
					] @else_clause.exclude_captures)
				(switch_statement) @switch_statement
				(switch_case) @switch_case
				(try_statement) @try_statement
				(throw_statement) @throw_statement
				(debugger_statement) @debugger_statement
				(return_statement) @return_statement
			]
		`],tsx:[Tn.typescript`
			[
				(comment) @comment ;; split into multiple comment kinds?

				(declaration) @declaration

				;; class declaration related
				(public_field_definition) @public_field_definition
				(method_definition) @method_definition
				(class_declaration (_ (method_signature) @method_signature))
				(abstract_method_signature) @abstract_method_signature

				;; enum declaration related
				(enum_assignment) @enum_assignment

				;; interface declaration related
				(interface_declaration (_ (method_signature) @method_signature))
				(interface_declaration (_ (property_signature) @property_signature))

				;; statements

				(import_statement) @import_statement
				(export_statement) @export_statement

				(expression_statement) @expression_statement

				(for_in_statement) @for_in_statement
				;; exclude any children found in the for loop condition
				(for_statement condition: (_) @for_statement.exclude_captures ) @for_statement
				(break_statement) @break_statement
				(continue_statement) @continue_statement
				(do_statement) @do_statement
				(if_statement) @if_statement
				(if_statement
					consequence: [
						(expression_statement)
						(if_statement)
					] @if_statement.exclude_captures)
				(else_clause
					[
						(expression_statement)
						(if_statement) ; for if-else chains
					] @else_clause.exclude_captures)
				(switch_statement) @switch_statement
				(switch_case) @switch_case
				(try_statement) @try_statement
				(throw_statement) @throw_statement
				(debugger_statement) @debugger_statement
				(return_statement) @return_statement

				;; jsx
				(jsx_element) @jsx_element
				(jsx_element (_ (jsx_expression) @jsx_expression))
			]
		`],python:[Tn.python`
			[
				(comment) @comment

				;; simple statements
				(assert_statement) @assert_statement
				(break_statement) @break_statement
				(continue_statement) @continue_statement
				(delete_statement) @delete_statement
				(exec_statement) @exec_statement
				(expression_statement) @expression_statement
				(future_import_statement) @future_import_statement
				(global_statement) @global_statement
				(import_from_statement) @import_from_statement
				(import_statement) @import_statement
				(nonlocal_statement) @nonlocal_statement
				(pass_statement) @pass_statement
				(print_statement) @print_statement
				(raise_statement) @raise_statement
				(return_statement) @return_statement
				(type_alias_statement) @type_alias_statement


				;; compound statements

				(class_definition) @class_definition
				(decorated_definition) @decorated_definition
				(for_statement) @for_statement
				(function_definition) @function_definition
				(if_statement) @if_statement
				(try_statement) @try_statement
				(while_statement) @while_statement
				(with_statement) @with_statement


				;; expressions

				(expression_list) @expression_list
				(expression_statement) @expression_statement
			]
		`],javascript:[Tn.javascript`
			[
				(comment) @comment ;; split into multiple comment kinds?

				(declaration) @declaration

				;; class declaration related

				(field_definition) @field_definition
				(method_definition) @method_definition

				;; statements

				(import_statement) @import_statement
				(export_statement) @export_statement

				(expression_statement) @expression_statement

				(for_in_statement) @for_in_statement
				;; exclude any children found in the for loop condition
				(for_statement condition: (_) @for_statement.exclude_captures ) @for_statement
				(break_statement) @break_statement
				(continue_statement) @continue_statement
				(do_statement) @do_statement
				(if_statement) @if_statement
				(switch_statement) @switch_statement
				(switch_case) @switch_case
				(try_statement) @try_statement
				(throw_statement) @throw_statement
				(debugger_statement) @debugger_statement
				(return_statement) @return_statement
			]`],go:[Tn.go`
		[
			(_statement) @statement
			(function_declaration) @function_declaration
			(import_declaration) @import_declaration
			(method_declaration) @method_declaration
			(package_clause) @package_clause

			(if_statement
				initializer: (_) @for_statement.exclude_captures) @for_statement

			(expression_case) @expression_case ;; e.g., case 0:
		]
		`],ruby:[Tn.ruby`
			[
				(comment) @comment

				(assignment) @assignment

				(if) @if

				(call) @call

				(case) @case

				(when) @when

				(while) @while

				(for) @for

				(method) @method

				(class) @class

				(module) @module

				(begin) @begin
			]
		`],csharp:[Tn.csharp`
			[
				(comment) @comment

				(class_declaration) @class_declaration
				(constructor_declaration) @constructor_declaration
				(method_declaration) @method_declaration
				(delegate_declaration) @delegate_declaration
				(enum_declaration) @enum_declaration
				(extern_alias_directive) @extern_alias_directive
				(file_scoped_namespace_declaration) @file_scoped_namespace_declaration
				(global_attribute) @global_attribute
				(global_statement) @global_statement
				(interface_declaration) @interface_declaration
				(namespace_declaration) @namespace_declaration
				(record_declaration) @record_declaration
				(struct_declaration) @struct_declaration
				(using_directive) @using_directive

				(local_declaration_statement) @local_declaration_statement
				(expression_statement) @expression_statement
				(for_statement) @for_statement
				(foreach_statement) @foreach_statement
				(continue_statement) @continue_statement
				(break_statement) @break_statement
				(throw_statement) @throw_statement
				(return_statement) @return_statement
				(try_statement) @try_statement
			]
		`],cpp:[Tn.cpp`
			[
				(declaration) @declaration

				(expression_statement) @expression_statement

				(comment) @comment

				(preproc_include) @preproc_include

				(namespace_definition) @namespace_definition

				(enum_specifier) @enum_specifier

				(struct_specifier) @struct_specifier

				(template_declaration) @template_declaration

				(function_definition) @function_definition

				(return_statement) @return_statement

				(class_specifier) @class_specifier

				(try_statement) @try_statement

				(throw_statement) @throw_statement

				(for_statement) @for_statement
				(for_statement
					initializer:(_) @for_statement.exclude_captures) @for_statement

				(for_range_loop) @for_range_loop
			]
		`],java:[Tn.java`
		[
			(statement) @statement ;; @ulugbekna: this includes (declaration); but somehow it can't capture inner classes

			(line_comment) @line_comment
			(block_comment) @block_comment

			(for_statement
				init: (_) @for_statement.exclude_captures)

			(block) @block.exclude_captures

			(field_declaration) @field_declaration
		]
		`],rust:[]}),iPe={...Lu(["typescript","tsx"],["program","interface_declaration","class_declaration","function_declaration","function_expression","type_alias_declaration","method_definition"]),javascript:["program","class_declaration","function_declaration","function_expression","method_definition"],java:["program","class_declaration","interface_declaration","method_declaration"],cpp:["translation_unit","class_specifier","function_definition"],csharp:["compilation_unit","class_declaration","interface_declaration","method_declaration"],python:["module","class_definition","function_definition"],go:["source_file","type_declaration","function_declaration","method_declaration"],ruby:["program","method","class","method"],rust:["source_file","function_item","impl_item","let_declaration"]},oPe=Ou({typescript:[zf("typescript")],tsx:[zf("tsx")],javascript:[zf("javascript")],java:[zf("java")],cpp:[zf("cpp")],csharp:[zf("csharp")],python:[zf("python")],go:[zf("go")],ruby:[zf("ruby")],rust:[zf("rust")]}),sPe={...Lu(["typescript","tsx","javascript"],["for_in_statement","for_statement","if_statement","while_statement","do_statement","try_statement","switch_statement"]),java:["for_statement","enhanced_for_statement","if_statement","while_statement","do_statement","try_statement","switch_expression"],cpp:["for_statement","for_range_loop","if_statement","while_statement","do_statement","try_statement","switch_statement"],csharp:["for_statement","for_each_statement","if_statement","while_statement","do_statement","try_statement","switch_expression"],python:["for_statement","if_statement","while_statement","try_statement"],go:["for_statement","if_statement","type_switch_statement"],ruby:["while","for","if","case"],rust:["for_statement","if_statement","while_statement","loop_statement","match_expression"]},Xdt={...Lu(["typescript","tsx"],["lexical_declaration","expression_statement","public_field_definition"]),javascript:["call_expression","expression_statement","variable_declaration","public_field_definition"],java:["expression_statement","local_variable_declaration","field_declaration"],cpp:["field_declaration","expression_statement","declaration"],csharp:["field_declaration","expression_statement"],python:["expression_statement"],go:["short_var_declaration","call_expression"],ruby:["call","assignment"],rust:["expression_statement","let_declaration","use_declaration","assignment_expression","macro_definition","extern_crate_declaration"]},Jdt={...Lu(["typescript","tsx"],["class_declaration","function_declaration","generator_function_declaration","interface_declaration","internal_module","method_definition","abstract_class_declaration","abstract_method_signature","enum_declaration"]),javascript:["class_declaration","function_declaration","generator_function_declaration","method_definition"],java:["class_declaration","constructor_declaration","enum_declaration","interface_declaration","method_declaration","module_declaration"],cpp:["class_specifier","function_definition","namespace_definition","struct_specifier"],csharp:["class_declaration","constructor_declaration","destructor_declaration","enum_declaration","interface_declaration","method_declaration","namespace_declaration","struct_declaration"],python:["function_definition","class_definition"],go:["function_declaration","method_declaration"],ruby:["class","method","module"],rust:["function_item","impl_item","mod_item","struct_item","trait_item","union_item"]},aPe=Ou({typescript:[$f("typescript")],tsx:[$f("tsx")],javascript:[$f("javascript")],java:[$f("java")],cpp:[$f("cpp")],csharp:[$f("csharp")],python:[$f("python")],go:[$f("go")],rust:[$f("rust")],ruby:[$f("ruby")]});function zf(n){return iPe[n].map(e=>`(${e}) @scope`).join(`
`)}function $f(n){return`[
		${Jdt[n].map(t=>`(${t})`).join(`
`)}
	] @definition`}function zO(n,e){return iPe[n].includes(e.type)||sPe[n].includes(e.type)}function cPe(n,e){return sPe[n].includes(e.type)}function cie(n,e){return Xdt[n].includes(e.type)}var lPe={...Lu(["typescript","tsx"],[Tn.typescript`[
			(expression_statement
				(call_expression
					function: (identifier) @fn
					(#any-of? @fn "test" "it")
				)
			) @test
		]`]),javascript:[Tn.javascript`[
			(call_expression
				function: (identifier) @fn
				(#any-of? @fn "test" "it")
			) @test
		]`],python:[Tn.python`[
			(function_definition
				name: (identifier) @fn
				(#match? @fn "^test_")
			) @test
		]`],java:[Tn.java`[
			(method_declaration
				name: (identifier) @fn
				(#match? @fn "^test")
			) @test
		]`],go:[Tn.go`[
			(function_declaration
				name: (identifier) @fn
				(#match? @fn "^Test")
			) @test
		]`],ruby:[],csharp:[],cpp:[],rust:[]};var lie=class{constructor(){this._cache=new Xl(5)}setCacheSize(e){this._cache=new Xl(e)}async getStructure(e,t){let r=`${e}:${t}`,o=this._cache.get(r);return o||(o=await this._getStructure(e,t),this._cache.put(r,o)),o}async _getStructure(e,t){let r=rPe[e];if(r.length===0)return;let o=await bi(e,t);try{let s=Sa(r,o.tree.rootNode).flatMap(u=>u.captures).sort((u,d)=>Fr.compare(u.node,d.node)),a=[];for(let u of s)u.name.endsWith(".exclude_captures")&&a.push(Fr.ofSyntaxNode(u.node));let c=new Yp(0,t.length,"root",[]),l=[c];for(let u=0;u<s.length;++u){let p=s[u].node;if(a.some(h=>Fr.isEqual(h,p)))continue;let f;do f=l.pop();while(f&&!Fr.doesContain(f,p));if(new Set(["export_statement","ambient_declaration"]).has(f.kind))f.kind=p.type,l.push(f);else{let h=p.type;(e==="typescript"||e==="tsx"||e==="javascript")&&h==="method_definition"&&p.namedChildren.some(I=>I.type==="property_identifier"&&I.text==="constructor")&&(h="constructor");let g=p.startIndex,y=p.previousSibling;if(y!==null){let S=t.substring(y.endIndex,p.startIndex).indexOf(`
`);S===-1?g=y.endIndex:g=y.endIndex+S+1}let b=p.endIndex,_=p.nextSibling;if(e==="typescript"&&_!==null&&(_.type===";"||_.type===",")&&(_=_.nextSibling),_!==null){let S=t.substring(p.endIndex,_.startIndex).indexOf(`
`);S!==-1&&(b=p.endIndex+S+1)}let x=new Yp(g,b,h,[]);f.children.push(x),l.push(f,x)}}return c}catch(s){console.error(s instanceof Error?s:new Error(s))}finally{o.dispose()}}},uPe=new lie;async function dPe(n,e,t){let r=await bi(n,e);try{let s=t.startIndex===t.endIndex?void 0:TS(r.tree,t,n);if(s)return{nodeIdentifier:VO(s,n),nodeToDocument:Qv.ofSyntaxNode(s),nodeSelectionBy:"matchingSelection"};let c=r.tree.rootNode.descendantForIndex(t.startIndex,t.endIndex),l=0;for(;!GO(c,n)&&c.parent!==null;)c=c.parent,++l;return{nodeIdentifier:VO(c,n),nodeToDocument:Qv.ofSyntaxNode(c),nodeSelectionBy:"expanding"}}finally{r.dispose()}}async function pPe(n,e,t){let r=await bi(n,e);try{let o=r.tree.rootNode.descendantForIndex(t.startIndex,t.endIndex);if(o.type.match(/identifier/)&&(o.parent===null||GO(o.parent,n))){let s=o.parent,a=s===null?void 0:{startIndex:s.startIndex,endIndex:s.endIndex};return{identifier:o.text,nodeRange:a}}}finally{r.dispose()}}async function fPe(n,e,t){let r=await bi(n,e);try{let o=Sa(aie[n],r.tree.rootNode).flatMap(({captures:c})=>c),s=new Map;for(let c of o){let[l,u]=c.name.split(".");if(u!=="identifier")continue;let d=s.get(l)||[];d.push(c),s.set(l,d)}let a=null;for(let c of o){let[l,u]=c.name.split(".");if(u!==void 0||!Fr.doesContain(c.node,t)||a!==null&&Fr.len(a.node)<Fr.len(c.node))continue;let d=s.get(l);Vs(d!==void 0,`must have seen identifier for symbol kind '${l}' (lang: ${n})`);let p=d.find(f=>Fr.doesContain(c.node,f.node));Vs(p!==void 0,`must have seen identifier for symbol '${l}' (lang: ${n})`),a={identifier:{name:p.node.text,range:Fr.ofSyntaxNode(p.node)},node:Qv.ofSyntaxNode(c.node)}}return a}catch(o){return console.error("getTestableNode: Unexpected error",o),null}finally{r.dispose()}}async function mPe(n,e){let t=await bi(n,e);try{let r=Sa(aie[n],t.tree.rootNode).flatMap(({captures:a})=>a).filter(Ume(a=>[a.node.startIndex,a.node.endIndex].toString())),o=new Map;for(let a of r){let[c,l]=a.name.split(".");if(l!=="identifier")continue;let u=o.get(c)||[];u.push(a),o.set(c,u)}let s=[];for(let a of r){if(a.name.includes("."))continue;let c=a.name,l=o.get(c);Vs(l!==void 0,`must have seen identifier for symbol kind '${c}' (lang: ${n})`);let u=l.find(d=>Fr.doesContain(a.node,d.node));Vs(u!==void 0,`must have seen identifier for symbol '${c}' (lang: ${n})`),s.push({identifier:{name:u.node.text,range:Fr.ofSyntaxNode(u.node)},node:Qv.ofSyntaxNode(a.node)})}return s}catch(r){return console.error("getTestableNodes: Unexpected error",r),null}finally{t.dispose()}}async function hPe(n,e){let t=await bi(n,e);try{let o=Sa(lPe[n],t.tree.rootNode).flatMap(a=>a.captures).sort((a,c)=>a.node.endIndex-c.node.endIndex).filter(a=>a.name==="test");if(o.length===0)return null;let s=o[o.length-1].node;return{startIndex:s.startIndex,endIndex:s.endIndex}}finally{t.dispose()}}var _Wn=kq();function Zdt(n,e){let t=oPe[n];return Sa(t,e)}function yPe(n,e){let t=tPe[n];return Sa(t,e)}function ept(n,e){let t=QRe[n];return t?Sa(t,e):[]}function tpt(n,e){let t=XRe[n];return t?Sa(t,e):[]}function npt(n,e){let t=JRe[n];return t?Sa(t,e):[]}function rpt(n,e){let t=ZRe[n];return t?Sa(t,e):[]}function ipt(n,e){let t=ePe[n];return t?Sa(t,e):[]}function bPe(n,e){let t=aPe[n];return Sa(t,e)}async function opt(n,e,t){let r=await bi(n,e);try{return ept(n,r.tree.rootNode).reduce((a,c)=>{let l=c.captures.find(u=>u.name==="call_expression").node;if(Fr.doIntersect(t,l)){let u,d;n==="ruby"&&(d=c.captures.find(p=>p.name==="symbol")?.node,u=d?.text?.slice(1)),d??=c.captures.find(p=>p.name==="identifier")?.node,u??=d?.text,a.push({identifier:u??"",text:l.text,startIndex:(d??l).startIndex,endIndex:(d??l).endIndex})}return a},[])}finally{r.dispose()}}async function spt(n,e){let t=await bi(n,e);try{return yPe(n,t.tree.rootNode).map(s=>{let a=s.captures.find(l=>l.name==="function").node;return{identifier:s.captures.find(l=>l.name==="identifier")?.node.text??"",text:a.text,startIndex:a.startIndex,endIndex:a.endIndex}})}finally{t.dispose()}}async function apt(n,e){let t=await bi(n,e);try{return tpt(n,t.tree.rootNode).map(s=>{let a=s.captures.find(l=>l.name==="class_declaration").node;return{identifier:a?.children.find(l=>l.type==="type_identifier"||l.type==="identifier"||l.type==="constant")?.text??"",text:a.text,startIndex:a.startIndex,endIndex:a.endIndex}})}finally{t.dispose()}}async function cpt(n,e){let t=await bi(n,e);try{return npt(n,t.tree.rootNode).map(s=>{let a=s.captures.find(l=>l.name==="type_declaration").node,c=s.captures.find(l=>l.name==="type_identifier")?.node.text;return c||(c=a?.children.find(l=>l.type==="type_identifier")?.text),{identifier:c??"",text:a.text,startIndex:a.startIndex,endIndex:a.endIndex}})}finally{t.dispose()}}async function lpt(n,e,t){let r=await bi(n,e);try{return rpt(n,r.tree.rootNode).reduce((a,c)=>{let l=c.captures.find(u=>u.name==="type_identifier").node;return Fr.doIntersect(t,l)&&a.push({identifier:l.text,text:l.text,startIndex:l.startIndex,endIndex:l.endIndex}),a},[])}finally{r.dispose()}}async function upt(n,e,t){let r=await bi(n,e);try{return ipt(n,r.tree.rootNode).reduce((a,c)=>{let l=c.captures.find(u=>u.name==="new_expression").node;return Fr.doIntersect(t,l)&&a.push({identifier:l.text,text:l.text,startIndex:l.startIndex,endIndex:l.endIndex}),a},[])}finally{r.dispose()}}async function dpt(n,e,t){let r=await bi(n,e);try{let o=nPe[n];return Sa(o,r.tree.rootNode).reduce((c,l)=>{let u=l.captures.find(d=>d.name==="symbol").node;return Fr.doIntersect(t,u)&&c.push({identifier:u.text,text:u.text,startIndex:u.startIndex,endIndex:u.endIndex}),c},[])}finally{r.dispose()}}async function ppt(n,e){let t=await bi(n,e);try{let r=bPe(n,t.tree.rootNode);return _pt(n,r,t.tree.rootNode)}finally{t.dispose()}}async function fpt(n,e){let t=await bi(n,e);try{let r=bPe(n,t.tree.rootNode);return IPe(n,r,t.tree.rootNode)}finally{t.dispose()}}async function mpt(n,e){let t=await bi(n,e);try{return yPe(n,t.tree.rootNode).map(s=>{let a=s.captures.find(c=>c.name==="body").node;return{startIndex:a.startIndex,endIndex:a.endIndex}})}finally{t.dispose()}}async function hpt(n,e,t){let r=await bi(n,e);try{let o=Zdt(n,r.tree.rootNode),s;for(let a of o){let c=a.captures[0].node,l=Yv.ofSyntaxNode(c);if(Yv.doesContain(l,t)&&(s=c),Nd.isBefore(t.endPosition,l.startPosition))break}if(s)return Yv.ofSyntaxNode(s);throw new Error("No parent node found")}finally{r.dispose()}}async function gpt(n,e,t,r){let o=await bi(n,e);try{let s=o.tree.rootNode.descendantForPosition(t.startPosition,t.endPosition),a={startPosition:s.startPosition,endPosition:s.endPosition},c=xPe(n,s,r,t,!0);return Yv.equals(a,c)?_Pe(n,s):c}finally{o.dispose()}}function _Pe(n,e){let t=e.parent,r={startPosition:e.startPosition,endPosition:e.endPosition};if(zO(n,e)||!t)return r;let{filteredRanges:o,indexOfInterest:s}=SPe(n,t.children,r,!1);if(s-1>=0&&s+1<=o.length-1){let a=o[s-1],c=o[s+1];return{startPosition:a.startPosition,endPosition:c.endPosition}}return _Pe(n,t)}function xPe(n,e,t,r,o){let s=e.children;if(e.endPosition.row-e.startPosition.row+1<=t){let c=zO(n,e)?{startPosition:e.startPosition,endPosition:e.endPosition}:vPe(n,s,t,r,o),l=e.parent;return l?xPe(n,l,t,c,!1):c}return vPe(n,s,t,r,o)}function gPe(n,e){return e.endPosition.row-n.startPosition.row+1}function vPe(n,e,t,r,o){if(e.length===0)return r;let{filteredRanges:s,indexOfInterest:a}=SPe(n,e,r,o),c=0,l=s.length-1,u=s[c],d=s[l];for(;gPe(u,d)>t&&c!==l;)a-c<l-a?(l--,d=s[l]):(c++,u=s[c]);return gPe(u,d)<=t?{startPosition:u.startPosition,endPosition:d.endPosition}:r}function SPe(n,e,t,r){let o,s;if(r?(o=e.filter(a=>zO(n,a)||cie(n,a)),s=Ike(o,t,(a,c)=>Nd.isBefore(a.startPosition,c.startPosition)),o.splice(s,0,t)):(o=e.filter(a=>Yv.doesContain(a,t)||zO(n,a)||cie(n,a)),s=o.findIndex(a=>Yv.doesContain(a,t))),s===-1)throw new Error("Valid index not found");return{filteredRanges:o,indexOfInterest:s}}async function vpt(n,e,t){let r=[],a=(await bi(n,e)).tree.rootNode.descendantForIndex(t.startIndex,t.endIndex);for(;a!==null;)cPe(n,a)&&r.push({startIndex:a.startIndex,endIndex:a.endIndex}),a=a.parent;return r}async function ypt(n,e,t){let r=await bi(n,e);try{let o=t.startIndex===t.endIndex;if(o)return;let s=o?void 0:TS(r.tree,t,n),a=o?void 0:TS(r.tree,t,n,bpt);if(a&&s)return{nodeIdentifier:VO(s,n),nodeToExplain:Qv.ofSyntaxNode(a)}}finally{r.dispose()}}function bpt(n,e){return n.type.match(/definition/)}function IPe(n,e,t){let r=new Map;e.forEach(s=>{let c=s.captures.find(d=>d.name==="definition")?.node,l;n==="cpp"&&c?.type==="function_definition"?l=c?.childForFieldName("declarator")?.childForFieldName("declarator"):n==="rust"&&c?.type==="impl_item"?l=c?.childForFieldName("trait"):l=c?.childForFieldName("name");let u=c?.childForFieldName("body");if(c&&u){switch(n){case"typescript":case"javascript":{let{definition:p}=TPe(c);c=p;break}}r.get(c.id)||r.set(c.id,{mainBlock:Ic.ofSyntaxNode(c),detailBlocks:{body:Ic.ofSyntaxNode(u),name:l?.text}})}});let o=Array.from(r.values());return new jO(o,Ic.ofSyntaxNode(t))}function _pt(n,e,t){let r;switch(n){case"python":r=Tpt(e);break;case"ruby":r=Ipt(e);break;default:{r=xpt(e,n);break}}return new jO(r,Ic.ofSyntaxNode(t))}function xpt(n,e){let t=new Map;return n.forEach(r=>{let s=r.captures.find(c=>c.name==="definition")?.node,a=s?.childForFieldName("body");if(s&&a){let c;switch(e){case"typescript":case"javascript":{let{definition:u,comments:d}=TPe(s);s=u,c=d;break}case"java":case"rust":c=Cpt(s);break;default:{c=$O(s);break}}t.get(s.id)||t.set(s.id,{mainBlock:Ic.ofSyntaxNode(s),detailBlocks:{comments:c.map(u=>Ic.ofSyntaxNode(u)),body:Ic.ofSyntaxNode(a)}})}}),Array.from(t.values())}function Spt(n){if(!(n.length<2))for(let e=1;e<n.length;e++){let t=n[e];if(!t.type.includes("parameters"))return t}}function Ipt(n){let e=new Map;return n.forEach(t=>{let o=t.captures.find(s=>s.name==="definition")?.node;if(o){let s=o.namedChildren,a=Spt(s);if(a){let c=s[s.length-1],l=o.text.substring(a.startIndex-o.startIndex,c.endIndex-o.startIndex),u=$O(o);e.get(o.id)||e.set(o.id,{mainBlock:Ic.ofSyntaxNode(o),detailBlocks:{comments:u.map(p=>Ic.ofSyntaxNode(p)),body:{range:{startPosition:{row:a.startPosition.row,column:a.startPosition.column},endPosition:{row:c.endPosition.row,column:c.endPosition.column}},startIndex:a.startIndex,text:l,endIndex:c.endIndex}}})}}}),Array.from(e.values())}function Tpt(n){let e=new Map;return n.forEach(t=>{let o=t.captures.find(a=>a.name==="definition")?.node,s=o?.childForFieldName("body");if(o&&s){let a=wpt(s),c=Ept(o);e.set(o.id,{mainBlock:Ic.ofSyntaxNode(o),detailBlocks:{docstring:a?Ic.ofSyntaxNode(a):void 0,decorator:c?Ic.ofSyntaxNode(c):void 0,body:Ic.ofSyntaxNode(s)}});return}}),Array.from(e.values())}function $O(n,e=["comment"]){let t=[],r=n.previousNamedSibling;for(;r&&e.some(o=>o===r?.type);)t.push(r),r=r.previousNamedSibling;return t.reverse()}function TPe(n){let e=n.parent;return e?.type==="export_statement"?{definition:e,comments:$O(e)}:{definition:n,comments:$O(n)}}function Cpt(n){return $O(n,["block_comment","line_comment"])}function Ept(n){let e=n.previousNamedSibling;return e?.type==="decorator"?e:void 0}function wpt(n){let e=n.firstChild;if(!e||e.type!=="expression_statement")return;let t=e.firstChild;return t?.type==="string"?t:void 0}function kpt(n,e){return uPe.getStructure(n,e)}var Rpt=EPe.join(__dirname,"worker2.js"),Aq=class{constructor(e){this._parser=new die(uie,Rpt,e)}dispose(){this._parser.dispose()}getTreeSitterAST(e){let t=_l(e.languageId);if(t)return this.getTreeSitterASTForWASMLanguage(t,e.getText())}getTreeSitterASTForWASMLanguage(e,t){let r=this._parser.proxy;return{getFunctionBodies:()=>r._getFunctionBodies(e,t),getCoarseParentScope:o=>r._getCoarseParentScope(e,t,o),getFixSelectionOfInterest:(o,s)=>r._getFixSelectionOfInterest(e,t,o,s),getCallExpressions:o=>r._getCallExpressions(e,t,o),getFunctionDefinitions:()=>r._getFunctionDefinitions(e,t),getClassReferences:o=>r._getClassReferences(e,t,o),getClassDeclarations:()=>r._getClassDeclarations(e,t),getTypeDeclarations:()=>r._getTypeDeclarations(e,t),getTypeReferences:o=>r._getTypeReferences(e,t,o),getSymbols:o=>r._getSymbols(e,t,o),getDocumentableNodeIfOnIdentifier:o=>r._getDocumentableNodeIfOnIdentifier(e,t,o),getTestableNode:o=>r._getTestableNode(e,t,o),getTestableNodes:()=>r._getTestableNodes(e,t),getNodeToExplain:o=>r._getNodeToExplain(e,t,o),getNodeToDocument:o=>r._getNodeToDocument(e,t,o),getFineScopes:o=>r._getFineScopes(e,t,o),getStructure:()=>r._getStructure(e,t),findLastTest:()=>r._findLastTest(e,t)}}getSemanticChunkTree(e,t){return this._parser.proxy._getSemanticChunkTree(e,t)}getSemanticChunkNames(e,t){return this._parser.proxy._getSemanticChunkNames(e,t)}},die=class{constructor(e,t,r){this._workerPath=t;this._useWorker=r;this._local=new Proxy(e,{get:(o,s,a)=>{let c=o[s];return typeof c!="function"?c:async(...l)=>{let u=await c.apply(o,CPe(l));return CPe(u)}}}),this._worker=new kr(()=>new h0(this._workerPath,{name:"Parser worker"}))}get proxy(){return this._useWorker?this._worker.value.proxy:this._local}dispose(){this._worker.hasValue&&this._worker.value.terminate()}};function CPe(n){return typeof n>"u"?n:JSON.parse(JSON.stringify(n))}var Dq=require("vscode");var Lq=re("IRemoteRepositoriesService"),Nq=class{async loadWorkspaceContents(e){return await(await this.getApi()).loadWorkspaceContents?.(e)??!1}getApi(){return this.getRemoteExtension().activate()}getRemoteExtension(){if(this._remoteHub!==void 0)return this._remoteHub;if(this._remoteHub=Dq.extensions.getExtension("ms-vscode.remote-repositories")??Dq.extensions.getExtension("GitHub.remoteHub")??Dq.extensions.getExtension("GitHub.remoteHub-insiders"),this._remoteHub===void 0)throw new Error("No Remote repository extension found.");return this._remoteHub}};function wPe(n){let t=[`(repo:${(Array.isArray(n.repo)?n.repo:[n.repo]).join(" OR repo:")})`];return n.lang&&t.push(`(lang:${n.lang.join(" OR lang:")})`),n.notLang&&t.push(`NOT (lang:${n.notLang.join(" OR lang:")})`),n.path&&t.push(`(path:${n.path.join(" OR path:")})`),n.notPath&&t.push(`NOT (path:${n.notPath.join(" OR path:")})`),t.join(" ")}var Oq=class extends Error{constructor(t,r){super(r);this.status=t}},Ppt=6,Apt=100,Dpt=.766,CS=class{constructor(e,t,r,o,s,a){this._domainService=e;this._telemetryService=t;this._authenticationService=r;this._fetcherService=o;this._envService=s;this._logService=a}async search(e,t,r={},o){if(Array.isArray(t.repo)&&!t.repo.length)throw new Error("No repos specified");let s;try{s=await this.postCodeOrDocsSearchRequestWithRetry(e,t,r,o??Zt.None)}catch(c){throw wo(c)||this._telemetryService.sendGHTelemetryException(c,`${this.slug} search failed`),c}let a=s.errors?.map(_be)??[];if(!Array.isArray(t.repo)){if(a.length)throw a.length>1?new AggregateError(a):a[0];return s.results}return{results:s.results,errors:a}}async postCodeOrDocsSearchRequestWithRetry(e,t,r,o){let s=(await this._authenticationService.getPermissiveGitHubSession({silent:!0}))?.accessToken??(await this._authenticationService.getAnyGitHubSession({silent:!0}))?.accessToken;if(o.isCancellationRequested)throw new dt;let a=`${this._domainService.searchSkillURL}/${this.slug}`,c=3,l=0,u=new Set,d;for(;l<c;){if(o.isCancellationRequested)throw new dt;try{try{return await this.postCodeOrDocsSearchRequest(a,s,e,t,r,o)}catch(p){if(p instanceof Oq)throw p;d=p;break}}catch(p){l++;let f=100;u.add(`Error fetching ${this.slug} search. ${p.message??p}`),this._logService.public.warn(`[repo:${t.repo}] Error fetching ${this.slug} search. Error: ${p.message??p}. Retrying in ${l}ms. Query: ${e}`),await new Promise(m=>setTimeout(m,f))}}throw o.isCancellationRequested?new dt:(l>=c&&(this._logService.public.warn(`[repo:${t.repo}] Max Retry Error thrown while querying '${e}'`),d=yX({error:"ERROR_TYPE_MAX_RETRIES_EXCEEDED",message:`${this.slug} search timed out after ${c} retries. ${Array.from(u).join(`
`)}`})),d)}async postCodeOrDocsSearchRequest(e,t,r,o,s,a){let c=Math.min(s.limit??Ppt,Apt),l=s.similarity??Dpt,u=s.rawChunks??!1,d={url:e,tokenizer:"o200k_base",family:"Code Or Doc Search",name:"Code Or Doc Search",version:"2023-12-12-preview",modelMaxPromptTokens:0,getExtraHeaders(){let h={Accept:"application/json","X-GitHub-Api-Version":"2023-12-12-preview"};return u&&(h["X-Experiment-blackbird_snippet_mode"]="raw"),h}},p=await cf(this._fetcherService,this._envService,this._telemetryService,this._domainService,d,t??"",await ja(process.env.HMAC_SECRET),void 0,Gt(),{query:r,scopingQuery:wPe(o),similarity:l,limit:c},a),f=await p.text();if(p.status===404||p.status===400&&f.includes("unknown integration"))throw this._logService.public.debug(`${this.slug} search endpoint not available for this user.`),yX({error:"ERROR_TYPE_NO_ACCESS_TO_ENDPOINT",message:`${this.slug}: ${f}`});let m;try{m=JSON.parse(f)}catch{throw new Oq(p.status,f)}return m}};E([Jo(e=>e._logService)],CS.prototype,"search",1),CS=E([v(0,xn),v(1,ge),v(2,xt),v(3,hn),v(4,it),v(5,oe)],CS);var Mq=class extends CS{constructor(){super(...arguments);this.slug="code"}},Fq=class extends CS{constructor(){super(...arguments);this.slug="docs"}};var go=q(require("vscode")),iR=require("vscode");var kPe="github.copilot.chat.reviewDiff.enabled",oR=class{constructor(e,t,r){this._configurationService=e;this._authenticationService=t;this._contextService=r;this._disposables=new _t;this._commentController=go.comments.createCommentController("github-copilot-review","GitHub Copilot Review");this._comments=[];this._disposables.add(go.workspace.onDidChangeConfiguration(o=>{o.affectsConfiguration(le.CodeFeedback.fullyQualifiedId)&&go.commands.executeCommand("setContext",le.CodeFeedback.fullyQualifiedId,this.isCodeFeedbackEnabled()),(o.affectsConfiguration("github.copilot.advanced")||o.affectsConfiguration("github.copilot.advanced.review.intent"))&&go.commands.executeCommand("setContext",le.ReviewIntent.fullyQualifiedId,this.isIntentEnabled())})),this._disposables.add(this._authenticationService.onDidAuthenticationChange(()=>{go.commands.executeCommand("setContext",kPe,this.isReviewDiffEnabled())})),this.updateContextValues()}updateContextValues(){go.commands.executeCommand("setContext",le.CodeFeedback.fullyQualifiedId,this.isCodeFeedbackEnabled()),go.commands.executeCommand("setContext",kPe,this.isReviewDiffEnabled()),go.commands.executeCommand("setContext",le.ReviewIntent.fullyQualifiedId,this.isIntentEnabled())}isCodeFeedbackEnabled(){let e=this._configurationService.inspectConfig(le.CodeFeedback);return e?.workspaceFolderValue??e?.workspaceValue??e?.globalValue??le.CodeFeedback.defaultValue}isReviewDiffEnabled(){return this._authenticationService.copilotToken?.isCopilotCodeReviewEnabled??!1}isIntentEnabled(){return this._configurationService.getConfig(le.ReviewIntent)}getDiagnosticCollection(){return this._diagnosticCollection||this._disposables.add(this._diagnosticCollection=go.languages.createDiagnosticCollection("github.copilot.chat.review"))}getReviewComments(){return this._comments.map(({comment:e})=>e)}addReviewComments(e){for(let t of e){let r=this._commentController.createCommentThread(t.uri,t.range,this.createUIComments(t));r.contextValue="hasNoSuggestion",r.canReply=!1,this._comments.find(o=>o.comment.uri.toString()===t.uri.toString())||(r.collapsibleState=go.CommentThreadCollapsibleState.Expanded),this._comments.push({comment:t,thread:r}),this.updateThreadLabels(),this._comments.length===1&&(go.commands.executeCommand("github.copilot.chat.review.next"),this._monitorActiveThread=setInterval(()=>{let o=this._commentController.activeCommentThread,s=o&&this._comments.find(a=>a.thread.label===o.label)?.thread;s!==this._activeThread&&(this._activeThread=s,s&&go.commands.executeCommand("github.copilot.chat.review.current",s))},500))}}updateReviewComment(e){let t=this.findCommentThread(e);t&&(t.comments=this.createUIComments(e))}createUIComments(e){let t="",r=e.suggestion?"edits"in e.suggestion?e.suggestion.edits.length?`

***
${iR.l10n.t("Suggested change:")}${e.suggestion.edits.map(s=>`
\`\`\`diff
${Npt(s)}
\`\`\``).join("")}
***`:`

${iR.l10n.t("No change found to suggest.")}`:`

${iR.l10n.t("Looking up change to suggest...")}`:"";return[{body:typeof e.body=="string"?`${e.body}${r}${t}`:new go.MarkdownString(`${e.body.value}${r}${t}`),mode:go.CommentMode.Preview,author:{name:iR.l10n.t("GitHub Copilot"),iconPath:$e.joinPath(this._contextService.extensionUri,"assets","Copilot-chat-avatar.png")}}]}collapseReviewComment(e){let t=this._comments.find(s=>s.comment===e);if(!t)return;let r=t.thread;r.dispose();let o=this._commentController.createCommentThread(e.uri,e.range,r.comments);o.contextValue=r.contextValue,o.canReply=!1,o.label=r.label,t.thread=o}removeReviewComments(e){for(let t of e){let r=this._comments.findIndex(o=>o.comment===t);r!==-1&&(this._comments[r].thread.dispose(),this._comments.splice(r,1))}this.updateThreadLabels(),this._comments.length===0&&this._monitorActiveThread&&(clearInterval(this._monitorActiveThread),this._monitorActiveThread=void 0)}updateThreadLabels(){this._comments.forEach((e,t)=>{e.thread.label=iR.l10n.t("Code Review Comment ({0} of {1})",t+1,this._comments.length)})}findReviewComment(e){return this._comments.find(r=>r.thread===e||r.thread.comments[0]===e)?.comment}findCommentThread(e){return this._comments.find(r=>r.comment===e)?.thread}dispose(){this._disposables.dispose()}};oR=E([v(0,be),v(1,xt),v(2,qt)],oR);function Npt(n){let e=n.oldText.split(/\r?\n/),t=n.newText.split(/\r?\n/);for(;e.length&&t.length&&e[0]===t[0];)e.shift(),t.shift();for(;e.length&&t.length&&e[e.length-1]===t[t.length-1];)e.pop(),t.pop();return`${e.map(r=>`- ${r}`).join(`
`)}
${t.map(r=>`+ ${r}`).join(`
`)}`}var WO=require("vscode");var sR=class{constructor(e,t,r){this.parserService=e;this.languageFeaturesService=t;this.dialogService=r}async findEnclosingBlocks(e,t){let r=this.parserService.getTreeSitterAST(e);if(r===void 0)return;let o=No(t,e);return(await r.getFineScopes(o))?.map(a=>{let c=Gs(e,a);return{kind:"code",name:e.lineAt(c.start).text.trim(),range:c}})}findEnclosingSymbols(e,t){for(let r of e)if(r.range.contains(t)){let o=this.findEnclosingSymbols(r.children,t);return o?[r,...o]:[r]}}async selectEnclosingScope(e,t){let r=await this.languageFeaturesService.getDocumentSymbols(e.document.uri);if(!r||r.length>0&&!r[0].hasOwnProperty("children"))return;let o=e.selection;if(!o.isEmpty)return;let s=this.findEnclosingSymbols(r,e.selection.active);if(t?.includeBlocks&&s?.push(...await this.findEnclosingBlocks(Bt.create(e.document),e.selection)??[]),s||(s=r),s?.length===1){let a=s[0];e.selection=new WO.Selection(a.range.start,a.range.end)}else if(s&&s.length>1||!s&&r.length>1){let a=s.sort((l,u)=>u.range.start.line-l.range.start.line).map(l=>({label:`$(${l.kind==="code"?"code":RPe.toIcon(l.kind).id}) ${l.name}`,description:`:${l.range.start.line+1}-${l.range.end.line+1}`,symbol:l}));if(!await this.dialogService.showQuickPick(a,{placeHolder:t?.reason??WO.l10n.t("Select an enclosing range"),onDidSelectItem(l){let u=l.symbol;u&&(e.selection=new WO.Selection(u.range.start,u.range.end),e.revealRange(u.range))}}))throw e.selection=o,new dt}return e.selection}};sR=E([v(0,ft),v(1,Ts),v(2,nq)],sR);var RPe;(t=>{let n=new Map;n.set(0,_r.symbolFile),n.set(1,_r.symbolModule),n.set(2,_r.symbolNamespace),n.set(3,_r.symbolPackage),n.set(4,_r.symbolClass),n.set(5,_r.symbolMethod),n.set(6,_r.symbolProperty),n.set(7,_r.symbolField),n.set(8,_r.symbolConstructor),n.set(9,_r.symbolEnum),n.set(10,_r.symbolInterface),n.set(11,_r.symbolFunction),n.set(12,_r.symbolVariable),n.set(13,_r.symbolConstant),n.set(14,_r.symbolString),n.set(15,_r.symbolNumber),n.set(16,_r.symbolBoolean),n.set(17,_r.symbolArray),n.set(18,_r.symbolObject),n.set(19,_r.symbolKey),n.set(20,_r.symbolNull),n.set(21,_r.symbolEnumMember),n.set(22,_r.symbolStruct),n.set(23,_r.symbolEvent),n.set(24,_r.symbolOperator),n.set(25,_r.symbolTypeParameter);function e(r){let o=n.get(r);return o||(console.info("No codicon found for SymbolKind "+r),o=_r.symbolProperty),o}t.toIcon=e})(RPe||={});var ES=class extends Xk{constructor(t,r){super();this._ignoreService=t;this._logService=r}async findFilesWithDefaultExcludes(t,r,o){let s=await this._ignoreService.asMinimatchPattern(),a=await this._findFilesWithDefaultExcludesAndExcludes(t,s,r,o);return!this._ignoreService.isRegexExclusionsEnabled||!a?a:Array.isArray(a)?await cK(this._ignoreService,a):await this._ignoreService.isCopilotIgnored(a)?void 0:a}async findFiles(t,r,o){let s=await this._ignoreService.asMinimatchPattern();r?.exclude?r={...r,exclude:s?bbe(r.exclude,s):r.exclude}:r={...r,exclude:s};let a=await super.findFiles(t,r,o);return this._ignoreService.isRegexExclusionsEnabled?await cK(this._ignoreService,a):a}async findTextInFiles(t,r,o,s){let a={report:async c=>{await this._ignoreService.isCopilotIgnored(c.uri)||o.report(c)}};return super.findTextInFiles(t,r,a,s)}};E([Jo(t=>t._logService)],ES.prototype,"findFiles",1),ES=E([v(0,Te),v(1,oe)],ES);var Uq=q(require("vscode")),KO=require("vscode");var Lpt="https://aka.ms/vscode-gh-copilot",PPe="survey.usage",APe="survey.nextSurveyDate",pie=14*24*60*60*1e3,Opt=7,Mpt=90,Fpt=3*60*1e3,Upt=5*60*1e3,Bpt=2,qpt=2,jpt=20,Hpt=1,aR=class{constructor(e,t,r,o,s){this.telemetryService=e;this.vscodeExtensionContext=t;this.envService=r;this.experimentationService=o;this.authenticationService=s;this.debounceTimeout=null;this.lastSource=null;this.lastLanguageId=null;this.surveyUri=zt.parse(Lpt),this.sessionSeed=Math.random(),setTimeout(async()=>{await this.updateUsageData(!1),await this.checkInactiveUserHeuristic()&&this.promptSurvey("churn")},Upt)}async signalUsage(e,t){await this.updateUsageData(!0),this.lastSource=e,t&&(this.lastLanguageId=t),this.debounceTimeout||(this.debounceTimeout=setTimeout(async()=>{await this.checkEligibility()&&this.promptSurvey("usage"),this.debounceTimeout=null},Fpt))}async checkInactiveUserHeuristic(){let e=await this.getUsageData(),t=await this.getNextSurveyDate(),r=Date.now(),o=e.activeDays.length,s=e.firstActive>0&&e.firstActive<r-pie,a=!t||t<r;if(o===0&&s&&a){let u=await this.experimentationService.getTreatmentVariableAsync("vscode","copilotchat.feedback.sessionProbability.inactive")??Hpt;return this.sessionSeed<u/100}return!1}async checkEligibility(){let e=await this.getUsageData(),t=await this.getNextSurveyDate(),r=Date.now(),o=e.activeDays.length,s=e.firstActive<r-pie,a=!t||t<r;if(o>=Bpt&&s&&a){let u=await this.experimentationService.getTreatmentVariableAsync("vscode","copilotchat.feedback.sessionProbability")??qpt;if(this.sessionSeed<u/100){let d=await this.experimentationService.getTreatmentVariableAsync("vscode","copilotchat.feedback.notificationProbability")??jpt;return Math.random()<d/100}}return!1}async getUsageData(){let e=this.vscodeExtensionContext.globalState.get(PPe);return e||{firstActive:0,activeDays:[]}}async getNextSurveyDate(){return this.vscodeExtensionContext.globalState.get(APe)??null}async updateUsageData(e){let t=await this.getUsageData(),r=Date.now();if(e){t.firstActive||(t.firstActive=r);let o=new Date().setHours(0,0,0,0);t.activeDays.includes(o)||t.activeDays.push(o)}t.activeDays=t.activeDays.filter(o=>o>=r-pie),await this.vscodeExtensionContext.globalState.update(PPe,t)}async updateNextSurveyDate(e){await this.vscodeExtensionContext.globalState.update(APe,Date.now()+e*24*60*60*1e3)}async promptSurvey(e){let t=await this.getUsageData(),r=this.lastSource||"",o=this.lastLanguageId||"",s=Math.floor((Date.now()-t.firstActive)/(1e3*60*60*24));this.telemetryService.sendMSFTTelemetryEvent("survey.show",{source:r,language:o,surveyType:e},{activeDays:t.activeDays.length,firstActive:s}),await this.updateNextSurveyDate(Mpt);let a=KO.l10n.t("Give Feedback"),c=KO.l10n.t("Later"),l=KO.l10n.t("Skip");Uq.window.showInformationMessage(KO.l10n.t("Got a minute? Help us make GitHub Copilot better."),a,c,l).then(async u=>{let d=u===a,p=u===c;if(this.telemetryService.sendMSFTTelemetryEvent("survey.action",{source:r,language:o,selection:d?"accepted":p?"postponed":"skipped",surveyType:e}),d){let f=await this.authenticationService.getCopilotToken(),m={m:this.envService.machineId,s:this.envService.sessionId,k:f.sku??"",d:t.activeDays.length.toString(),f:s.toString(),v:this.envService.getVersion(),l:o,src:r,type:e},h=this.surveyUri.with({query:new URLSearchParams(m).toString()});Uq.env.openExternal(h)}else p&&await this.updateNextSurveyDate(Opt)})}};aR=E([v(0,ge),v(1,qt),v(2,it),v(3,fn),v(4,xt)],aR);var Os=q(require("vscode"));var Bq=class{constructor(){this._store=new _t;this._tabGroupsUseInfo=new Map;this._tabClock=0;this.onDidChangeActiveTextEditor=Os.window.onDidChangeActiveTextEditor;this.onDidChangeTabs=Os.window.tabGroups.onDidChangeTabs;let e=()=>this._tabGroupsUseInfo.set(Os.window.tabGroups.activeTabGroup,this._tabClock++);e(),this._store.add(Os.window.tabGroups.onDidChangeTabGroups(t=>{t.closed.forEach(r=>this._tabGroupsUseInfo.delete(r)),e()}))}dispose(){this._store.dispose()}get activeTextEditor(){let e=Os.window.activeTextEditor;if(e&&e.document.uri.scheme!=="output")return e;let t=new kn;Os.window.visibleTextEditors.forEach(o=>t.set(o.document.uri,o));let r=[...this._tabGroupsUseInfo];r.sort((o,s)=>s[1]-o[1]);for(let[o]of r)if(o.activeTab){let s=this._asTabInfo(o.activeTab);if(s.uri&&t.has(s.uri))return t.get(s.uri)}}get visibleTextEditors(){return Os.window.visibleTextEditors}get activeNotebookEditor(){return Os.window.activeNotebookEditor}get tabs(){return Os.window.tabGroups.all.flatMap(e=>e.tabs).map(this._asTabInfo,this)}_asTabInfo(e){let t;return e.input instanceof Os.TabInputText||e.input instanceof Os.TabInputNotebook?t=e.input.uri:(e.input instanceof Os.TabInputTextDiff||e.input instanceof Os.TabInputNotebookDiff)&&(t=e.input.modified),{tab:e,uri:t}}};var qq=class{dispose(){}sendInternalMSFTTelemetryEvent(e,t,r){}sendMSFTTelemetryEvent(e,t,r){}sendMSFTTelemetryErrorEvent(e,t,r){}sendGHTelemetryEvent(e,t,r){}sendGHTelemetryErrorEvent(e,t,r){}sendGHTelemetryException(e,t){}sendTelemetryEvent(e,t,r,o){}sendTelemetryErrorEvent(e,t,r,o){}setSharedProperty(e,t){}postEvent(e,t){}sendRestrictedGHTelemetryEvent(e,t,r){}sendRestrictedGHTelemetryErrorEvent(e,t,r){}};var x9e=q(_9e()),zV=q(require("os")),CP=class{constructor(e,t,r,o){this.namespace=r;this.client=twt(e,t,o),S9e(e,t,this.client)}separateData(e){if(e.properties!==void 0||e.measurements!==void 0)return e.properties=e.properties||{},e.measurements=e.measurements||{},e;let t={},r={};for(let[o,s]of Object.entries(e))typeof s=="number"?r[o]=s:t[o]=s;return{properties:t,measurements:r}}sendEventData(e,t){let{properties:r,measurements:o}=this.separateData(t||{});this.client.trackEvent({name:this.qualifyEventName(e),properties:r,measurements:o})}sendErrorData(e,t){let{properties:r,measurements:o}=this.separateData(t||{});this.client.trackException({exception:e,properties:r,measurements:o})}flush(){return new Promise(e=>{this.client.flush({callback:()=>{e(void 0)}})})}qualifyEventName(e){return e.includes(this.namespace)?e:`${this.namespace}/${e}`}};function twt(n,e,t){let r=new x9e.TelemetryClient(t);return r.config.enableAutoCollectRequests=!1,r.config.enableAutoCollectPerformance=!1,r.config.enableAutoCollectExceptions=!1,r.config.enableAutoCollectConsole=!1,r.config.enableAutoCollectDependencies=!1,r.config.noDiagnosticChannel=!0,S9e(n,e,r),r}function S9e(n,e,t){t.commonProperties=nwt(t.commonProperties,e),t.context.tags[t.context.keys.cloudRoleInstance]="REDACTED",t.config.endpointUrl=n.telemetryURL}function nwt(n,e){return n=n||{},n.common_os=zV.platform(),n.common_platformversion=zV.release(),n.common_vscodemachineid=e.machineId,n.common_vscodesessionid=e.sessionId,n.common_uikind="desktop",n.common_remotename="none",n.common_isnewappinstall="",n}var I9e="7d7048df-6dd0-4048-bb23-b716c1461f8f",T9e="3fdd7f28-937a-48c8-9a21-ba337db23bd1";var SM=q(j9e());function Iwt(n){return n?SM.TargetPopulation.Insiders:SM.TargetPopulation.Public}var RP=class{constructor(e,t,r){let o=t.extension.id,s=t.extension.packageJSON.version,a=Iwt(r.isPreRelease());this._delegate=(0,SM.getExperimentationService)(o,s,a,e,t.globalState)}get initializePromise(){return this._delegate.initializePromise}get initialFetch(){return this._delegate.initialFetch}isFlightEnabled(e){return this._delegate.isFlightEnabled(e)}isCachedFlightEnabled(e){return this._delegate.isCachedFlightEnabled(e)}isFlightEnabledAsync(e){return this._delegate.isFlightEnabledAsync(e)}getTreatmentVariable(e,t){return this._delegate.getTreatmentVariable(e,t)}getTreatmentVariableAsync(e,t,r){return this._delegate.getTreatmentVariableAsync(e,t,r)}};RP=E([v(0,ge),v(1,qt),v(2,it)],RP);var rG=class{constructor(e,t,r){this._tokenStore=e;this._microsoftTelemetrySender=t;this._ghTelemetrySender=r;this._sharedProperties={};this._disposables=[];this._disposables.push(this._microsoftTelemetrySender,this._ghTelemetrySender),this._disposables.push(e.onDidStoreUpdate(()=>{let o=e.copilotToken;o&&this.sendMSFTTelemetryEvent("token",void 0,{chatEnabled:o.isChatEnabled()?1:0,snippyEnabled:o.isPublicSuggestionsEnabled()?1:0,telemetryEnabled:o.isTelemetryEnabled()?1:0})}))}dispose(){this._disposables.forEach(e=>e.dispose())}sendMSFTTelemetryEvent(e,t,r){this.sendTelemetryEvent(e,{github:!1,microsoft:!0},t,r)}sendMSFTTelemetryErrorEvent(e,t,r){this.sendTelemetryErrorEvent(e,{github:!1,microsoft:!0},t,r)}sendGHTelemetryEvent(e,t,r){this.sendTelemetryEvent(e,{github:!0,microsoft:!1},t,r)}sendGHTelemetryErrorEvent(e,t,r){this.sendTelemetryErrorEvent(e,{github:!0,microsoft:!1},t,r)}sendGHTelemetryException(e,t){this._ghTelemetrySender.sendExceptionTelemetry(e,t)}sendRestrictedGHTelemetryEvent(e,t,r){t={...t,...this._sharedProperties},this._ghTelemetrySender.sendRestrictedTelemetryEvent(e,t,r)}sendRestrictedGHTelemetryErrorEvent(e,t,r){t={...t,...this._sharedProperties},this._ghTelemetrySender.sendRestrictedTelemetryErrorEvent(e,t,r)}sendInternalMSFTTelemetryEvent(e,t,r){t={...t,...this._sharedProperties},this._microsoftTelemetrySender.sendInternalTelemetryEvent(e,t,r)}sendTelemetryEvent(e,t,r,o){r={...r,...this._sharedProperties},t.github&&this._ghTelemetrySender.sendTelemetryEvent(e,r,o),t.microsoft&&this._microsoftTelemetrySender.sendTelemetryEvent(e,r,o)}sendTelemetryErrorEvent(e,t,r,o){r={...r,...this._sharedProperties},t.github&&this._ghTelemetrySender.sendTelemetryErrorEvent(e,r,o),t.microsoft&&this._microsoftTelemetrySender.sendTelemetryErrorEvent(e,r,o)}setSharedProperty(e,t){this._sharedProperties[e]=t}postEvent(e,t){for(let[r,o]of Object.entries(this._sharedProperties))t.set(r,o);this._microsoftTelemetrySender.postEvent(e,t)}};var bue=require("vscode");function H9e(n){return n.replace(/([\s|(]|file:\/\/)(\/[^\s]+)/g,"$1[redacted]").replace(/([\s|(]|file:\/\/)([a-zA-Z]:[(\\|/){1,2}][^\s]+)/gi,"$1[redacted]").replace(/([\s|(]|file:\/\/)(\\[^\s]+)/gi,"$1[redacted]")}var iG=class{constructor(e,t,r,o,s,a){this._createTelemetryLogger=t;this._configService=r;this._telemetryConfig=o;this._envService=s;this._domainService=a;this._disposables=new _t;this._processToken(e.copilotToken),this._nonRestrictedTelemetryLogger=this._createTelemetryLogger(!1),this._disposables.add(e.onDidStoreUpdate(()=>{let c=e.copilotToken;this._processToken(c)})),this._disposables.add(this._domainService.onDidChangeDomains(()=>{this._nonRestrictedTelemetryLogger.dispose(),this._nonRestrictedTelemetryLogger=this._createTelemetryLogger(!1),this._restrictedTelemetryLogger&&(this._restrictedTelemetryLogger.dispose(),this._restrictedTelemetryLogger=this._createTelemetryLogger(!0))}))}_processToken(e){e||this._restrictedTelemetryLogger&&(this._restrictedTelemetryLogger.dispose(),this._restrictedTelemetryLogger=void 0),e?.getTokenValue("rt")==="1"?this._restrictedTelemetryLogger=this._createTelemetryLogger(!0):(this._restrictedTelemetryLogger&&this._restrictedTelemetryLogger.dispose(),this._restrictedTelemetryLogger=void 0)}sendTelemetryEvent(e,t,r){this._nonRestrictedTelemetryLogger.logUsage(e,this.markAsIssuedAndMakeReadyForSending(t,r))}sendTelemetryErrorEvent(e,t,r){this._nonRestrictedTelemetryLogger.logError(e,this.markAsIssuedAndMakeReadyForSending(t,r))}sendRestrictedTelemetryEvent(e,t,r){this._restrictedTelemetryLogger&&this._restrictedTelemetryLogger?.logUsage(e,this.markAsIssuedAndMakeReadyForSending(t,r))}sendRestrictedTelemetryErrorEvent(e,t,r){this._restrictedTelemetryLogger&&this._restrictedTelemetryLogger?.logError(e,this.markAsIssuedAndMakeReadyForSending(t,r))}sendExceptionTelemetry(e,t){let r=e instanceof Error?e:new Error("Non-error thrown: "+e),o=mi.createAndMarkAsIssued({origin:H9e(t),reason:this._restrictedTelemetryLogger?"Exception logged to restricted telemetry":"Exception, not logged due to opt-out"});if(o.makeReadyForSending(this._configService,this._envService,this._telemetryConfig),this.sendTelemetryEvent("exception",o.properties,o.measurements),!this._restrictedTelemetryLogger)return;let s=mi.createAndMarkAsIssued({origin:t});s.makeReadyForSending(this._configService,this._envService,this._telemetryConfig),this._restrictedTelemetryLogger.logError(r,s)}markAsIssuedAndMakeReadyForSending(e,t){let r=mi.createAndMarkAsIssued(ave(e),t);r.makeReadyForSending(this._configService,this._envService,this._telemetryConfig);let o={};for(let s in r.properties)o[s]=new j1(r.properties[s]);return{properties:o,measurements:r.measurements}}dispose(){this._nonRestrictedTelemetryLogger.dispose(),this._disposables.dispose(),this._restrictedTelemetryLogger&&this._restrictedTelemetryLogger.dispose()}};var oG=class extends iG{constructor(e,t,r,o,s,a,c,l){let u=d=>d?bue.env.createTelemetryLogger(new CP(o,t,s,c),{ignoreBuiltInCommonProperties:!0,ignoreUnhandledErrors:!0}):bue.env.createTelemetryLogger(new CP(o,t,s,a),{ignoreBuiltInCommonProperties:!0,ignoreUnhandledErrors:!0});super(l,u,e,r,t,o)}};var hme=q(kHe());var mW=class{constructor(e,t){this._createTelemetryReporter=t;this._disposables=new _t;this._vscodeTeamMember=!1;this._isInternal=!1;this._externalTelemetryReporter=this._createTelemetryReporter(!1),this.processToken(e.copilotToken),this._disposables.add(e.onDidStoreUpdate(()=>this.processToken(e.copilotToken)))}postEvent(e,t){let r={};for(let[o,s]of t)r[o]=s;this._isInternal&&this.sendInternalTelemetryEvent(e,r),this.sendTelemetryEvent(e,r)}sendInternalTelemetryEvent(e,t,r){this._internalTelemetryReporter&&(t={...t,"common.tid":this._tid,"common.userName":this._username??"undefined"},r={...r,"common.isVscodeTeamMember":this._vscodeTeamMember?1:0},this._internalTelemetryReporter.sendRawTelemetryEvent(e,t,r))}sendTelemetryEvent(e,t,r){t={...t,"common.tid":this._tid??"","common.sku":this._sku??"undefined"},this._isInternal&&(r={...r,"common.internal":1}),this._externalTelemetryReporter.sendTelemetryEvent(e,t,r)}sendTelemetryErrorEvent(e,t,r){t={...t,"common.tid":this._tid??"","common.sku":this._sku??"undefined"},this._isInternal&&(r={...r,"common.internal":1}),this._externalTelemetryReporter.sendTelemetryErrorEvent(e,t,r)}dispose(){this._externalTelemetryReporter.dispose(),this._internalTelemetryReporter?.dispose()}processToken(e){if(this._username=e?.username,this._vscodeTeamMember=!!e?.isVscodeTeamMember,this._tid=e?.getTokenValue("tid"),this._sku=e?.sku,this._isInternal=!!e?.isInternal,this._isInternal&&!this._internalTelemetryReporter&&(this._internalTelemetryReporter=this._createTelemetryReporter(!0)),!e||!this._isInternal||!e.isChatEnabled()){this._internalTelemetryReporter?.dispose(),this._internalTelemetryReporter=void 0;return}}};var hW=class extends mW{constructor(e,t,r){let o=s=>s?new hme.default(e):new hme.default(t);super(r,o)}};var JA=class extends rG{constructor(e,t,r,o,s,a,c,l,u,d){let p=new hW(t,r,c),f=new oG(a,l,u,d,e,o,s,c);super(c,p,f)}};JA=E([v(5,be),v(6,gc),v(7,it),v(8,KF),v(9,xn)],JA);var PHe=require("path"),AHe=require("process"),P_=require("vscode"),gW=new Map,vme=new Map;function DHe(){let n=P_.window.activeTerminal;return n===void 0?"":gW.get(n)?.join(`
`)||""}function NHe(){let n=P_.window.activeTerminal;if(n!==void 0)return vme.get(n)?.at(-1)}function LHe(){try{return P_.window.activeTerminal?.selection??""}catch{return""}}var gme;function OHe(){let n=P_.window.activeTerminal;if(n&&"shellPath"in n.creationOptions){let e=n.creationOptions.shellPath;if(e){let t,r=(0,PHe.basename)(e);if(r==="bash.exe")t="Git Bash";else{let o=r.replace(/\..+/,"");switch(o){case"pwsh":case"powershell":t="powershell";break;case"":break;default:t=o}}if(t)return gme=t,t}}return gme||(AHe.platform==="win32"?"powershell":"bash")}function RHe(n,e){n.push(e),n.length>40&&n.shift()}function CPt(n){let e=/(:?\x1b\[|\x9B)[=?>!]?[\d;:]*["$#'* ]?[a-zA-Z@^`{}|~]/g;return n&&(n=n.replace(e,"")),n}function MHe(){return[P_.window.onDidWriteTerminalData(n=>{let e=gW.get(n.terminal);e||(e=[],gW.set(n.terminal,e)),RHe(e,CPt(n.data))}),P_.window.onDidExecuteTerminalCommand(n=>{let e=vme.get(n.terminal);e||(e=[],vme.set(n.terminal,e)),RHe(e,n)}),P_.window.onDidCloseTerminal(n=>{gW.delete(n)})]}var vW=class extends ye{constructor(){super();for(let e of MHe())this._register(e)}get terminalBuffer(){return DHe()}get terminalLastCommand(){return NHe()}get terminalSelection(){return LHe()}get terminalShellType(){return OHe()}};var js=q(require("vscode"));var ZA=class extends ye{constructor(t){super();this.configService=t;this.resultsDocs=new kn;this.isEnabled=tge(this.configService,le.FixTestFailure);this._register(js.tests.onDidChangeTestResults(()=>this.setHasFailureContextKey())),this.setHasFailureContextKey()}setHasFailureContextKey(){js.commands.executeCommand("setContext","github.copilot.chat.fixTestFailures.hasFailure",!!ti.first(this.getAllFailures()))}get lastResultsFrom(){return js.tests.testResults[0]?.completedAt}getAllFailures(){let t=js.tests.testResults[0];return t?this.dfsFailures(t.results):ti.empty()}getLastFailureFor(t){let r=[];for(let o=t;o;o=o.parent)r.push(o.id);r.reverse();for(let o of js.tests.testResults)for(let s of o.results){let a=s;for(let l of r)if(a=a.children.find(u=>u.id===l),!a)break;let c=a?.taskStates.find(l=>l.state===js.TestResultState.Failed||l.state===js.TestResultState.Errored);if(c&&a)return{snapshot:a,task:c}}}getFailureAtPosition(t,r){let o=js.tests.testResults[0];if(this.resultsDocsAreForTestRun!==o&&this.makeResultsDocs(o),!o)return;let s=this.resultsDocs.get(t)||[],a=aF(s,c=>!!c.range&&c.range.start.line<=r.line);if(a){for(let c of a.taskStates)if(c.state===js.TestResultState.Failed||c.state===js.TestResultState.Errored)return{snapshot:a,task:c}}}async hasAnyTests(){return!!(await js.commands.executeCommand("vscode.testing.getControllersWithTests")).length}*dfsFailures(t){for(let r of t){yield*this.dfsFailures(r.children);for(let o of r.taskStates)(o.state===js.TestResultState.Failed||o.state===js.TestResultState.Errored)&&(yield{snapshot:r,task:o})}}makeResultsDocs(t){if(this.resultsDocs.clear(),this.resultsDocsAreForTestRun=t,!t)return;let r=[t.results];for(;r.length;)for(let s of r.pop()){if(r.push(s.children),!s.uri)continue;let a=this.resultsDocs.get(s.uri);a?a.push(s):this.resultsDocs.set(s.uri,[s])}let o=new js.Range(0,0,0,0);for(let s of this.resultsDocs.values())s.sort((a,c)=>(a.range||o).start.compareTo((c.range||o).start)||EPt(a.taskStates,c.taskStates))}};ZA=E([v(0,be)],ZA);var EPt=(n,e)=>{let t=0,r=0;for(let o of n)t=Math.max(t,o.state);for(let o of e)r=Math.max(r,o.state);return t-r};var Z3=q(require("vscode")),yW=class{getAllExtensions(){return Z3.extensions.all}async getAllCommands(){return Z3.commands.executeCommand("_getAllCommands")}async getAllSettings(){return Z3.commands.executeCommand("_getAllSettings")}};var $m=require("vscode");function FHe(n){return n.scheme==="vscode-vfs"&&n.authority.startsWith("github")}var e2=class extends U5{constructor(t,r){super();this._logService=t;this._remoteRepositoriesService=r;this.onDidOpenTextDocument=$m.workspace.onDidOpenTextDocument;this.onDidChangeTextDocument=$m.workspace.onDidChangeTextDocument;this.onDidCloseTextDocument=$m.workspace.onDidCloseTextDocument}get textDocuments(){return $m.workspace.textDocuments}async openTextDocument(t){return await $m.workspace.openTextDocument(t)}get notebookDocuments(){return $m.workspace.notebookDocuments}getWorkspaceFolders(){return $m.workspace.workspaceFolders?.map(t=>t.uri)??[]}ensureWorkspaceIsFullyLoaded(){return this._fullyLoadedPromise??=(async()=>{for(let t of this.getWorkspaceFolders())if(FHe(t)){this._logService.public.debug(`Preloading virtual workspace contents for ${t}`);try{let r=await this._remoteRepositoriesService.loadWorkspaceContents(t);this._logService.public.info(`loading virtual workspace contents resulted in ${r} for: ${t}`)}catch(r){this._logService.public.error(`Error loading virtual workspace contents for ${t}: ${r}`)}}})(),this._fullyLoadedPromise}async showWorkspaceFolderPicker(){if(this.getWorkspaceFolders())return $m.window.showWorkspaceFolderPick()}};e2=E([v(0,oe),v(1,Lq)],e2);var Ei=q(require("vscode"));var t2=q(Ve());var bW=class extends t2.PromptElement{render(){let e=this.props.history.slice(-6);return vscpp(vscppf,null,vscpp(t2.SystemMessage,{priority:1e3},"You are helping to continue an AI pair programming chat conversation within Visual Studio Code.",vscpp("br",null),vscpp(Ze,null)),vscpp(Nt,{historyPriority:800,history:e,passPriority:!0,omitPromptVariables:!0},vscpp(Tt,{priority:1e3},"Given the conversation's last user/assistant (developer/AI-developer) turn, write a follow-up message that the developer would send. Your suggested messages keep the conversation going with curiosity and a bias for action. Assume the AI-assistant can only talk about code, but not implement/test/run/etc it.",vscpp("br",null),"Keep your suggested message succinct (under 6 words).",vscpp("br",null),vscpp(kt,null))),vscpp(t2.UserMessage,{priority:900},"Suggest a succinct (under 6 words) follow-up message to the last AI-assistant response."))}};var n2=class{constructor(e,t,r,o,s,a,c){this.logService=e;this.endpointProvider=t;this.configurationService=r;this.chatMLFetcher=o;this.telemetryService=s;this.tabsAndEditorsService=a;this.instantiationService=c}async computeFollowups(e,t){let r=e.getLatestTurn();if(!r)return[];let o={messageId:r.requestId},s=this.configurationService.getConfig(le.FollowUpsEnabled),c=(s==="always"||s==="firstOnly"&&e.turns.length===1)&&r.status==="success"&&(!r.intentInvocation?.location||r.intentInvocation?.location===2)?await this.followUp(e,2,t,o):[];if(t.isCancellationRequested)return[];let l=c.map(d=>this.conversationToReplyFollowup(d,o)),u=r.intentInvocation;if(u?.generateFollowUps){let d=await u.generateFollowUps(r);l.push(...d)}return t.isCancellationRequested?[]:(this.telemetryService.sendMSFTTelemetryEvent("followUps.suggested",{requestId:r.requestId,messageId:o.messageId},{turn:e.turns.length,suggestionCount:l.length,characterCount:l.reduce((d,p)=>d+p.prompt.length,0)}),l)}async followUp(e,t,r,o){let s=o?{...o}:{};s.requestId=Gt(),s.messageSource="chat.followup";let a=await this.endpointProvider.getChatEndpoint("gpt-4o-mini"),{messages:c}=await Qi(this.instantiationService,a,bW,{history:e.turns,endpoint:a,location:t}),l=await this.chatMLFetcher.fetchOne("followUp",c,void 0,r,t,a,void 0,void 0,s);if(l.type==="success"){let u=[];return l.value&&u.push(l.value.trim()),u}else return this.logService.public.error(`Failed to fetch followups because of response type (${l.type}) and reason (${l.reason})`),[]}conversationToReplyFollowup(e,t){let r=t??{};return r.suggestionId=Gt(),r.suggestionType="Follow-up from model",F8(this.telemetryService,r.suggestionType,r.messageId,r.suggestionId,this.tabsAndEditorsService.activeTextEditor?.document),{prompt:e}}};n2=E([v(0,oe),v(1,_e),v(2,be),v(3,Et),v(4,ge),v(5,$t),v(6,H)],n2);var r2=q(Ve());var _W=class extends r2.PromptElement{render(){return vscpp(vscppf,null,vscpp(r2.SystemMessage,{priority:1e3},"You are an expert in crafting pithy titles for chatbot conversations. You are presented with a chat conversation, and you reply with a brief title that captures the main topic of discussion in that conversation.",vscpp("br",null),vscpp(Ze,null)),vscpp(Nt,{historyPriority:800,passPriority:!0,history:this.props.history},vscpp(Tt,{priority:1e3},vscpp(kt,null),"The title should not be wrapped in quotes. It should about 8 words or fewer.",vscpp("br",null),"Here are some examples of good titles:",vscpp("br",null),"- Git rebase question",vscpp("br",null),"- Installing Python packages",vscpp("br",null),"- Location of LinkedList implentation in codebase",vscpp("br",null),"- Adding a tree view to a VS Code extension",vscpp("br",null),"- React useState hook usage")),vscpp(r2.UserMessage,{priority:900},"Please write a brief title for the chat conversation above. If the conversation covers multiple topics, you can just focus on the last one."))}};var i2=class{constructor(e,t,r,o){this.logService=e;this.endpointProvider=t;this.chatMLFetcher=r;this.instantiationService=o}async provideChatTitle(e,t){let r=new Vp;if(this.instantiationService.invokeFunction(c=>eN(c,r,e.history)),r.turns.filter(c=>c.status==="success").length===0)return"";let o=await this.endpointProvider.getChatEndpoint("gpt-4o-mini"),{messages:s}=await Qi(this.instantiationService,o,_W,{history:r.turns}),a=await this.chatMLFetcher.fetchOne("title",s,void 0,t,2,o);if(t.isCancellationRequested)return"";if(a.type==="success"){let c=a.value.trim();return c.match(/^".*"$/)&&(c=c.slice(1,-1)),c}else return this.logService.public.error(`Failed to fetch conversation title because of response type (${a.type}) and reason (${a.reason})`),""}};i2=E([v(0,oe),v(1,_e),v(2,Et),v(3,H)],i2);var To=q(require("vscode"));var xW=class{constructor(e,t){this.configurationService=e;this.authenticationService=t}async getBaseWelcomeMessage(){let e=(await this.authenticationService.getCopilotToken()).isInternal,t;if(e&&this.configurationService.getConfig(le.InternalWelcomeHintEnabled)){let r="workbench.action.openSettings";t=new To.MarkdownString(To.l10n.t({message:`{0} is powered by AI, so mistakes are possible. Review output carefully before use.

As an internal user, additional telemetry is collected. If you work on a project that contains customer content, you must [disable telemetry]({1}).`,args:["Copilot",`command:${r}?${encodeURIComponent('["telemetry.telemetryLevel"]')}`],comment:["{Locked=']({'}"]})),t.isTrusted={enabledCommands:[r]}}else t=new To.MarkdownString(To.l10n.t("{0} is powered by AI, so mistakes are possible. Review output carefully before use.",["Copilot"]));return t}collectWelcomeQuestions(){let e=Bv("workspace");return this.asFollowUps([[e,"fix",To.l10n.t("the problems in my code")],[e,"tests",To.l10n.t("add unit tests for my code")],[e,"explain",To.l10n.t("how the selected code works")]])}asFollowUps(e){return e.map(([t,r,o])=>({prompt:"",participant:t,command:r,label:`/${r} ${o}`}))}},o2=class extends xW{constructor(t,r,o){super(o,r);this.telemetryService=t}async provideWelcomeMessage(t){return{icon:new To.ThemeIcon("copilot"),title:To.l10n.t("Ask Copilot"),message:await this.getBaseWelcomeMessage()}}provideSampleQuestions(t,r){let o=To.window.activeNotebookEditor||To.window.activeTextEditor?this.collectWelcomeQuestions():this.asFollowUps([["","help",To.l10n.t("What can you do?")]]);return this.suggestionsToTelemetry([...o],"welcome"),o}suggestionsToTelemetry(t,r){t.map(o=>{F8(this.telemetryService,`@${o.participant} /${o.command} ${o.prompt}`,r,"",To.window.activeTextEditor?.document)})}};o2=E([v(0,ge),v(1,xt),v(2,be)],o2);var s2=class extends xW{constructor(e,t){super(t,e)}async provideWelcomeMessage(e){let t=await this.getBaseWelcomeMessage(),r=new To.MarkdownString(To.l10n.t("Start your editing session by defining a set of files that you want to work with. Then ask Copilot for the changes you want to make.")).appendMarkdown(`

`).appendMarkdown(t.value);return r.isTrusted=t.isTrusted,{icon:new To.ThemeIcon("copilot"),title:To.l10n.t("Edit with Copilot"),message:r}}provideSampleQuestions(e,t){return[]}};s2=E([v(0,xt),v(1,be)],s2);var a2=class{constructor(e){this.instantiationService=e}debugGetCurrentChatAgents(){return this._lastChatAgents}register(){let e=this.instantiationService.createInstance(eF);return e.register(),this._lastChatAgents=e,{dispose:()=>{e.dispose(),this._lastChatAgents=void 0}}}};a2=E([v(0,H)],a2);var eF=class{constructor(e,t,r,o,s,a,c,l,u){this.extensionContext=e;this.octoKitService=t;this.authenticationService=r;this.languageDiagnosticsService=o;this.instantiationService=s;this.userFeedbackService=a;this.configurationService=c;this.conversationStore=l;this.endpointProvider=u;this._disposables=new _t}dispose(){this._disposables.dispose()}register(){this._disposables.add(this.registerDefaultAgent()),this._disposables.add(this.registerEditingAgent()),this._disposables.add(this.registerEditorDefaultAgent()),this._disposables.add(this.registerNotebookDefaultAgent()),this._disposables.add(this.registerWorkspaceAgent()),this._disposables.add(this.registerVSCodeAgent()),this._disposables.add(this.registerTerminalAgent()),this._disposables.add(this.registerTerminalPanelAgent())}createAgent(e,t,r){let o=r?.id||Bv(e),s=Ei.chat.createChatParticipant(o,this.getChatParticipantHandler(o,e,t));return s.onDidReceiveFeedback(a=>{this.userFeedbackService.handleFeedback(a,o)}),s.onDidPerformAction(a=>{this.userFeedbackService.handleUserAction(a,o)}),s.supportIssueReporting=this.configurationService.getConfig(le.DebugReportFeedback),r?.useFollowupProvider&&(s.followupProvider={provideFollowups:async(a,c,l)=>{let u=a.metadata?.responseId&&this.conversationStore.getConversation(a.metadata.responseId);return u?await this.instantiationService.createInstance(n2).computeFollowups(u,l):[]}}),s}registerWorkspaceAgent(){let e=this.createAgent(Wve,"workspace",{useFollowupProvider:!0});return e.iconPath=new Ei.ThemeIcon("code"),e.isSecondary=!0,e}registerVSCodeAgent(){let e=this.createAgent(Kve,"vscode",{useFollowupProvider:!0}),t=Ei.env.appName.includes("Insiders")||Ei.env.appName.includes("OSS");return e.iconPath=$e.joinPath(this.extensionContext.extensionUri,"assets",t?"vscode-chat-avatar-insiders.svg":"vscode-chat-avatar-stable.svg"),e.supportsSlowReferences=!0,e}registerTerminalAgent(){let e=this.createAgent(nT,"terminal");return e.iconPath=new Ei.ThemeIcon("terminal"),e.supportsSlowReferences=!0,e.followupProvider=void 0,e}registerTerminalPanelAgent(){let e=this.createAgent(nT,"terminal",{id:"github.copilot.terminalPanel",useFollowupProvider:!0});return e.iconPath=new Ei.ThemeIcon("terminal"),e.supportsSlowReferences=!0,e}async initDefaultAgentRequestorProps(e){let t=async()=>{let r=await this.octoKitService.getCurrentAuthedUser();return r?(e.requester={name:r.login,icon:$e.parse(r?.avatar_url??`https://avatars.githubusercontent.com/${r.login}`)},!0):!1};if(!await t()){let r=this.authenticationService.onDidAuthenticationChange(async()=>{await t()&&r.dispose()})}}registerEditingAgent(){let e=this.createAgent(Yve,"edit");return e.iconPath=new Ei.ThemeIcon("copilot"),e.supportsSlowReferences=!0,e.welcomeMessageProvider=this.instantiationService.createInstance(s2),e}registerDefaultAgent(){let e=this.createAgent($ve,"unknown",{useFollowupProvider:!0});e.iconPath=new Ei.ThemeIcon("copilot"),e.supportsSlowReferences=!0,this.initDefaultAgentRequestorProps(e),e.helpTextPrefix=Ei.l10n.t("You can ask me general programming questions, or chat with the following participants which have specialized expertise and can perform actions:");let t=Ei.l10n.t({message:`To have a great conversation, ask me questions as if I was a real programmer:

* **Show me the code** you want to talk about by having the files open and selecting the most important lines.
* **Make refinements** by asking me follow-up questions, adding clarifications, providing errors, etc.
* **Review my suggested code** and tell me about issues or improvements, so I can iterate on it.

You can also ask me questions about your editor selection by [starting an inline chat session](command:inlineChat.start).

Learn more about [GitHub Copilot](https://docs.github.com/copilot/using-github-copilot/getting-started-with-github-copilot?tool=vscode&utm_source=editor&utm_medium=chat-panel&utm_campaign=2024q3-em-MSFT-getstarted) in [Visual Studio Code](https://code.visualstudio.com/docs/copilot/overview).`,comment:"{Locked='](command:inlineChat.start)'}"}),r=new Ei.MarkdownString(t);return r.isTrusted={enabledCommands:["inlineChat.start"]},e.helpTextPostfix=r,e.helpTextVariablesPrefix=Ei.l10n.t("You can also help me understand your question by using the following variables to give me extra context:"),e.welcomeMessageProvider=this.instantiationService.createInstance(o2),e.titleProvider=this.instantiationService.createInstance(i2),e}registerEditorDefaultAgent(){let e=this.createAgent(fD,"editor");return e.iconPath=new Ei.ThemeIcon("copilot"),e.welcomeMessageProvider={provideWelcomeMessage:()=>{},provideSampleQuestions:(t,r)=>{if(Ei.window.activeTextEditor){let{document:o,selection:s}=Ei.window.activeTextEditor,a=KX(this.languageDiagnosticsService.getDiagnostics(o.uri),s);if(a)return[{prompt:`/fix ${a.message}`}]}}},e}registerNotebookDefaultAgent(){let e=this.createAgent("notebook","editor");return e.iconPath=new Ei.ThemeIcon("copilot"),e.welcomeMessageProvider={provideSampleQuestions:(t,r)=>{if(Ei.window.activeTextEditor){let{document:o,selection:s}=Ei.window.activeTextEditor,a=KX(this.languageDiagnosticsService.getDiagnostics(o.uri),s);if(a)return[{prompt:`/fix ${a.message}`}]}}},e}getChatParticipantHandler(e,t,r){return async(o,s,a,c)=>{let l=await this.requestPolicyConfirmation(o,a);if(typeof l=="boolean")return{};o=l;let u=oT[r],d=o.command&&u?u[o.command]:r;return await this.instantiationService.createInstance(D0,s.history,o,a,c,{agentName:t,agentId:e,intentId:d}).getResult()}}async requestPolicyConfirmation(e,t){let r=await this.endpointProvider.getChatEndpoint(e);return r.policy==="enabled"?e:e.acceptedConfirmationData?.[0]?.prompt&&await r.acceptChatPolicy()?{...e,prompt:e.acceptedConfirmationData[0].prompt}:(t.confirmation(`Enable ${r.name} for all clients`,r.policy.terms,{prompt:e.prompt},["Enable"]),!0)}};eF=E([v(0,qt),v(1,g5),v(2,xt),v(3,Zo),v(4,H),v(5,yE),v(6,be),v(7,Md),v(8,_e)],eF);var Wl=q(require("vscode"));var SW=class{async add(e,t){let r=Wl.workspace.getConfiguration("launch",e),o=r.get("configurations");t.configurations.length&&await r.update("configurations",[...t.configurations,...o||[]],Wl.ConfigurationTarget.WorkspaceFolder);let s=r.get("inputs");t.inputs?.length&&await r.update("inputs",[...t.inputs,...s||[]],Wl.ConfigurationTarget.WorkspaceFolder)}async show(e,t){let r=$e.joinPath(e,".vscode","launch.json"),o;try{o=await Wl.workspace.openTextDocument(r)}catch{return}let s;if(t)try{let a=o.getText(),c=[],l=!1;k_e(a,{onObjectBegin(u){c.push(u)},onObjectEnd(u,d){let p=c.pop();if(l){l=!1;let f=new xc(a),m=f.offsetToPosition(p),h=f.offsetToPosition(u+d);s=new Wl.Range(m.lineNumber-1,m.column-1,h.lineNumber-1,h.column-1)}},onLiteralValue(u,d,p,f,m,h){if(u===t){let g=h();g[g.length-1]==="name"&&(l=!0)}}})}catch{}await Wl.window.showTextDocument(o,{selection:s})}async launch(e){let t="configurations"in e&&e.configurations.length?e.configurations[0]:e;t&&await Wl.debug.startDebugging(void 0,t)}async resolveConfigurationInputs(e,t,r){r||(r={isGenerating:()=>{},didGenerate:()=>{},prompt:async(a,c)=>await Wl.window.showInputBox({prompt:a,value:c,ignoreFocusOut:!0})});let o=new Map;for(let a of e.inputs||[]){let c=await r.prompt(a.description,t?.get(a.id));if(c===void 0)return;o.set("${input:"+a.id+"}",c)}return{config:Mhe(e.configurations[0],a=>{if(typeof a=="string"){for(let[c,l]of o)a=a.replaceAll(c,l);return a}}),inputs:o}}};var wPt=[{max_token_sequence_length:1,last_tokens_to_consider:10},{max_token_sequence_length:10,last_tokens_to_consider:30},{max_token_sequence_length:20,last_tokens_to_consider:45},{max_token_sequence_length:30,last_tokens_to_consider:60},{max_token_sequence_length:60,last_tokens_to_consider:120}];function BHe(n){if(n.length===0)return{numberOfRepetitions:0,mostRepeatedLine:"",totalLines:0};let e=new Map,t=n.split(`
`);for(let s of t){if(s=s.trim(),s.length===0)continue;let a=e.get(s)||0;e.set(s,a+1)}let r="",o=0;for(let[s,a]of e.entries())a>o&&(o=a,r=s);return{numberOfRepetitions:o,mostRepeatedLine:r,totalLines:t.length}}function qHe(n){let e=n.slice();return e.reverse(),UHe(e)||UHe(e.filter(t=>t.trim().length>0))}function UHe(n){let e=kPt(n);for(let t of wPt){if(n.length<t.last_tokens_to_consider)continue;if(t.last_tokens_to_consider-1-e[t.last_tokens_to_consider-1]<=t.max_token_sequence_length)return!0}return!1}function kPt(n){let e=Array(n.length).fill(0);e[0]=-1;let t=-1;for(let r=1;r<n.length;r++){for(;t>=0&&n[t+1]!==n[r];)t=e[t];n[t+1]===n[r]&&t++,e[r]=t}return e}function jHe(n){if(n!==void 0&&n!==0&&n.hostname==="github.com")return n.owner+"/"+n.repo}async function HHe(n,e,t,r,o,s,a,c,l,u,d,p){let f=PPt(c);if(d?.isCancellationRequested)return{type:"canceled",reason:"before fetch request"};n.internal.debug(`url ${a.url}`),n.internal.debug(`modelMaxPromptTokens ${a.modelMaxPromptTokens}`),n.internal.debug(`modelMaxResponseTokens ${f.max_tokens??2048}`),n.internal.debug(`chat model ${c.model}`);let m=c.secretKey??(await s.getCopilotToken()).token;if(!m)return n.public.error(`Failed to send request to ${a.url} due to missing key`),wh(e,`Failed to send request to ${a.url} due to missing key`),{type:"failed",modelRequestId:void 0,failKind:"tokenExpiredOrInvalid",reason:"key is missing"};let h=await DPt(n,e,t,r,o,a,c.ourRequestId,f,m,c.location,d,p);if(d?.isCancellationRequested){let b=await h.body();try{b.destroy()}catch(_){n.public.error(_,"Error destroying stream"),e.sendGHTelemetryException(_,"Error destroying stream")}return{type:"canceled",reason:"after fetch request"}}if(h.status!==200){let b=RPt(a,c.location,c.ourRequestId);return n.public.info("Request ID for failed request: "+c.ourRequestId),APt(n,e,s,b,h,c.ourRequestId)}let g=c.postOptions?.n??1,y=await a.processResponseFromChatEndpoint(e,n,h,g,u,l,d);return h.headers.get("Copilot-Edits-Session")&&(s.speculativeDecodingEndpointToken=h.headers.get("Copilot-Edits-Session")??void 0),{type:"success",chatCompletions:y,getProcessingTime:()=>mxe(h)}}function RPt(n,e,t){return mi.createAndMarkAsIssued({endpoint:"completions",engineName:"chat",uiKind:lt.toString(e),headerRequestId:t})}function PPt(n){let e={messages:n.messages,model:n.model};n.postOptions&&Object.assign(e,n.postOptions);let t=jHe(n.repoInfo);return t!==void 0&&(e.nwo=t),n.intent&&(e.intent=n.intent,n.intent_threshold&&(e.intent_threshold=n.intent_threshold)),e}async function APt(n,e,t,r,o,s){let a=hE(o,void 0);s=a.headerRequestId||s,a.headerRequestId=s,r.properties.error=`Response status was ${o.status}`,r.properties.status=String(o.status),e.sendGHTelemetryEvent("request.shownWarning",r.properties,r.measurements);let c=await o.text();if(o.status===401&&c.includes("authorize_url"))try{let l=JSON.parse(c);return{type:"failed",modelRequestId:a,failKind:"unauthorized",reason:o.statusText||o.statusText,data:l}}catch{}if(o.status===401||o.status===403)return t.resetCopilotToken(o.status),{type:"failed",modelRequestId:a,failKind:"tokenExpiredOrInvalid",reason:`token expired or invalid: ${o.status}`};if(o.status===499)return n.public.info("Cancelled by server"),{type:"failed",modelRequestId:a,failKind:"serverCanceled",reason:"canceled by server"};if(o.status===466)return n.public.info(c),{type:"failed",modelRequestId:a,failKind:"clientNotSupported",reason:`client not supported: ${c}`};if(o.status===400&&c.includes("off_topic"))return{type:"failed",modelRequestId:a,failKind:"offTopic",reason:"filtered as off_topic by intent classifier: message was not programming related"};if(o.status===424)return{type:"failed",modelRequestId:a,failKind:"failedDependency",reason:c};if(o.status===429){if(c.includes("extension_blocked"))try{let l=JSON.parse(c);if(l.error&&(l=l.error),l.code==="extension_blocked"&&l.type==="rate_limit_error")return{type:"failed",modelRequestId:a,failKind:"extensionBlocked",reason:l.reason??l.code,data:{...l.message,retryAfter:o.headers.get("retry-after")}}}catch{}return{type:"failed",modelRequestId:a,failKind:"rateLimited",reason:c,data:{retryAfter:o.headers.get("retry-after")}}}return o.status>=500&&o.status<600?(n.public.error(`Server error: ${o.status} ${c}`),{type:"failed",modelRequestId:a,failKind:"serverError",reason:`Server error, please report the following request id: ${s}`}):o.status===422?{type:"failed",modelRequestId:a,failKind:"contentFilter",reason:"Filtered by Responsible AI Service"}:(n.public.error(`Request Failed: ${o.status} ${c}`),wh(e,"Unhandled status from server: "+o.status,c),{type:"failed",modelRequestId:a,failKind:"unknown",reason:`Request Failed: ${o.status} ${c}`})}async function DPt(n,e,t,r,o,s,a,c,l,u,d,p){let f=mi.createAndMarkAsIssued({endpoint:"completions",engineName:"chat",uiKind:lt.toString(u),...p},{maxTokenWindow:s.modelMaxPromptTokens});for(let[g,y]of Object.entries(c))g!=="messages"&&(f.properties[`request.option.${g}`]=JSON.stringify(y)??"undefined");f.properties.headerRequestId=a,e.sendGHTelemetryEvent("request.sent",f.properties,f.measurements);let m=Date.now(),h=NPt(u);return cf(t,r,e,o,s,l,await ja(process.env.HMAC_SECRET),h,a,c,d).then(g=>{let y=hE(g,void 0);f.extendWithRequestId(y);let b=Date.now()-m;return f.measurements.totalTimeMs=b,n.internal.debug(`request.response: [${s.url}], took ${b} ms`),n.internal.debug(`messages: ${JSON.stringify(c.messages)}`),e.sendGHTelemetryEvent("request.response",f.properties,f.measurements),g}).catch(g=>{if(t.isAbortError(g))throw g;let y=f.extendedBy({error:"Network exception"});e.sendGHTelemetryEvent("request.shownWarning",y.properties,y.measurements),f.properties.code=String(g.code??""),f.properties.errno=String(g.errno??""),f.properties.message=String(g.message??""),f.properties.type=String(g.type??"");let b=Date.now()-m;throw f.measurements.totalTimeMs=b,n.internal.debug(`request.response: [${s.url}] took ${b} ms`),e.sendGHTelemetryEvent("request.error",f.properties,f.measurements),g}).finally(()=>{HJ(e,c.messages,f)})}function NPt(n){switch(n){case 2:return"conversation-panel";case 1:return"conversation-inline";case 3:return"conversation-edits"}}var yme=class{constructor(e){this.options=e;this._onDidMakeChatMLRequest=new jt;this.onDidMakeChatMLRequest=this._onDidMakeChatMLRequest.event}preparePostOptions(e){return{temperature:this.options.temperature,top_p:this.options.topP,...e,stream:!0}}async fetchOne(e,t,r,o,s,a,c,l,u,d){let p=await this.fetchMany(e,t,r,o,s,a,c,{...l,n:1},u,d);return p.type==="success"?{...p,value:p.value[0]}:p}},c2=class extends yme{constructor(t,r,o,s,a,c,l,u,d){super(d);this._fetcherService=t;this._telemetryService=r;this._tokenizerProvider=o;this._requestLogger=s;this._logService=a;this._envService=c;this._domainService=l;this._authenticationService=u}async fetchMany(t,r,o,s,a,c,l,u,d){d||(d={}),d.messageSource||(d.messageSource=t);let p=d.requestId??d.messageId??Gt(),f=c.maxOutputTokens;u={max_tokens:f,...u};let m=this.preparePostOptions(u),h=c.model,g={messages:r,model:h,repoInfo:void 0,ourRequestId:p,location:a,postOptions:m,secretKey:u.secretKey},y=mi.createAndMarkAsIssued({...d,uiKind:lt.toString(a)}),b=this._requestLogger.logChatRequest(t,c,g),_=-1;try{let x,I=new W6(o),S=LPt(g);if(!S.isValid)x={type:"failed",modelRequestId:void 0,failKind:"validationFailed",reason:`Prompt failed validation with the reason: ${S.reason}. Please file an issue.`};else{x=await HHe(this._logService,this._telemetryService,this._fetcherService,this._envService,this._domainService,this._authenticationService,c,g,y,I.callback,s,d),_=bC(this._tokenizerProvider.acquireTokenizer(c),r.map(V=>({role:V.role,content:V.content,..."name"in V&&V.name?{name:V.name}:void 0})));let k=l?.extensionId??lh;this._onDidMakeChatMLRequest.fire({messages:r,model:c.model,source:{extensionId:k},tokenCount:_})}let w=Date.now()-y.issuedTime;b?.markTimeToFirstToken(w);let R;switch(x.type){case"success":{let k=await this.processSuccessfulResponse(x,g.ourRequestId,f,_,w,y,c);return b?.resolve(k,I.deltas),k}case"canceled":return this._telemetryService.sendMSFTTelemetryEvent("response.cancelled",{source:d.messageSource??"unknown",requestId:g.ourRequestId,model:c.model},{totalTokenMax:c.modelMaxPromptTokens??-1,promptTokenCount:_,tokenCountMax:f,timeToFirstToken:w,timeToCancelled:y?Date.now()-y.issuedTime:-1}),b?.resolveWithCancelation(),this.processCanceledResponse(x,g.ourRequestId);case"failed":return R=this.processFailedResponse(x,g.ourRequestId),this._sendResponseErrorTelemetry(R,d,g,c,_,f,w),b?.resolve(R),R}}catch(x){let I=Date.now()-y.issuedTime,S=this.processError(x,g.ourRequestId);return this._sendResponseErrorTelemetry(S,d,g,c,_,f,I),b?.resolve(S),S}}_sendResponseErrorTelemetry(t,r,o,s,a,c,l){this._telemetryService.sendMSFTTelemetryEvent("response.error",{type:t.type,reason:new j1(t.reason),source:r?.messageSource??"unknown",requestId:o.ourRequestId,model:s.model},{totalTokenMax:s.modelMaxPromptTokens??-1,promptTokenCount:a,tokenCountMax:c,timeToFirstToken:l})}async processSuccessfulResponse(t,r,o,s,a,c,l){let u=[];for await(let m of t.chatCompletions)this._telemetryService.sendMSFTTelemetryEvent("response.success",{reason:m.finishReason,filterReason:m.filterReason,source:c?.properties.messageSource??"unknown",model:l?.model,requestId:r},{totalTokenMax:l?.modelMaxPromptTokens??-1,tokenCountMax:o,promptTokenCount:s,tokenCount:m.usage.total_tokens,timeToFirstToken:a,timeToComplete:c?Date.now()-c.issuedTime:-1}),this.isRepetitive(m,c?.properties)||u.push(m);let d=new Set(["stop","client-trimmed","function_call","tool_calls"]),p=u.filter(m=>d.has(m.finishReason));if(p.length>=1)return{type:"success",usage:p.reduce((m,h)=>{let g={completion_tokens:0,prompt_tokens:0,total_tokens:0},y=h.usage||g;return{completion_tokens:m.completion_tokens+y.completion_tokens,prompt_tokens:m.prompt_tokens+y.prompt_tokens,total_tokens:m.total_tokens+y.total_tokens}},{completion_tokens:0,prompt_tokens:0,total_tokens:0}),value:p.map(m=>m.message.content),requestId:r,serverRequestId:p[0].requestId.headerRequestId};let f=u.at(0);switch(f?.finishReason){case"content_filter":return{type:"filtered",category:f.filterReason??"snippy",reason:"Response got filtered.",requestId:r,serverRequestId:f.requestId.headerRequestId};case"length":return{type:"length",reason:"Response too long.",requestId:r,serverRequestId:f.requestId.headerRequestId,truncatedValue:f.message.content}}return{type:"unknown",reason:"Response contained no choices.",requestId:r,serverRequestId:f?.requestId.headerRequestId}}isRepetitive(t,r){let o=BHe(t.message.content),s=qHe(t.tokens);if(s){let a=mi.createAndMarkAsIssued();a.extendWithRequestId(t.requestId);let c=a.extendedBy(r);this._telemetryService.sendRestrictedGHTelemetryEvent("conversation.repetition.detected",c.properties,c.measurements)}return o.numberOfRepetitions>=10&&this._telemetryService.sendMSFTTelemetryEvent("conversation.repetition.detected",{requestId:t.requestId.headerRequestId,finishReason:t.finishReason},{numberOfRepetitions:o.numberOfRepetitions,lengthOfLine:o.mostRepeatedLine.length,totalLines:o.totalLines}),s}processCanceledResponse(t,r){return{type:"canceled",reason:t.reason,requestId:r,serverRequestId:void 0}}processFailedResponse(t,r){let o=t.modelRequestId?.headerRequestId,s=t.reason;if(t.failKind==="rateLimited")return{type:"rateLimited",reason:s,requestId:r,serverRequestId:o,retryAfter:t.data?.retryAfter};if(t.failKind==="offTopic")return{type:"offTopic",reason:s,requestId:r,serverRequestId:o};if(t.failKind==="tokenExpiredOrInvalid"||t.failKind==="clientNotSupported"||s.includes("Bad request: "))return{type:"badRequest",reason:s,requestId:r,serverRequestId:o};if(t.failKind==="serverError")return{type:"failed",reason:s,requestId:r,serverRequestId:o};if(t.failKind==="contentFilter")return{type:"filtered",reason:s,category:"prompt",requestId:r,serverRequestId:o};if(t.failKind==="unauthorized")return{type:"agent_unauthorized",reason:s,authorizationUrl:t.data.authorize_url,requestId:r,serverRequestId:o};if(t.failKind==="failedDependency")return{type:"agent_failed_dependency",reason:s,requestId:r,serverRequestId:o};if(t.failKind==="extensionBlocked"){let a=typeof t.data?.retryAfter=="number"?t.data.retryAfter:300;return{type:"extensionBlocked",reason:s,requestId:r,retryAfter:a,learnMoreLink:t.data?.learnMoreLink??"",serverRequestId:o}}return{type:"failed",reason:s,requestId:r,serverRequestId:o}}processError(t,r){let o=this._fetcherService;return o.isAbortError(t)?{type:"canceled",reason:"network request aborted",requestId:r,serverRequestId:void 0}:wo(t)?{type:"canceled",reason:"Got a cancellation error",requestId:r,serverRequestId:void 0}:(this._logService.public.error(t,"Error on conversation request"),this._telemetryService.sendGHTelemetryException(t,"Error on conversation request"),o.isDNSLookupFailedError(t)?{type:"failed",reason:"It appears you're not connected to the internet, please check your network connection and try again.",requestId:r,serverRequestId:void 0}:o.isFetcherError(t)?{type:"failed",reason:o.getUserMessageForFetcherError(t),requestId:r,serverRequestId:void 0}:{type:"failed",reason:"Error on conversation request. Check the log for more details.",requestId:r,serverRequestId:void 0})}};c2=E([v(0,hn),v(1,ge),v(2,Qn),v(3,eu),v(4,oe),v(5,it),v(6,xn),v(7,xt),v(8,va)],c2);function LPt(n){if(n.messages.length===0)return{isValid:!1,reason:"No messages provided"};if(n?.postOptions?.max_tokens&&n?.postOptions?.max_tokens<1)return{isValid:!1,reason:"Invalid response token parameter"};let e=/^[a-zA-Z0-9_-]+$/;return n.messages.some(t=>t.role==="function"&&t.name&&!t.name.match(e))||n.postOptions?.functions?.some(t=>!t.name.match(e))||n.postOptions?.function_call?.name&&!n.postOptions.function_call.name.match(e)?{isValid:!1,reason:"Function names must match ^[a-zA-Z0-9_-]+$"}:{isValid:!0,reason:""}}var IW=class{constructor(e,t){this._modelInfo=e;this._domainService=t;this.name=this._modelInfo.name;this.version=this._modelInfo.version;this.model=this._modelInfo.id;this.family=this._modelInfo.capabilities.family;this.tokenizer=this._modelInfo.capabilities.tokenizer;this.maxBatchSize=this._modelInfo.capabilities.limits?.max_inputs??256,this.modelMaxPromptTokens=8192}get url(){return this._domainService.capiEmbeddingsURL}};var Wm=class{constructor(e,t,r,o,s,a,c,l){this._fetcher=e;this._domainService=t;this._configService=r;this._expService=o;this._envService=s;this._authService=a;this._telemetryService=c;this._logService=l;this._familyMap=new Map;this._lastFetchTime=0;this._taskSingler=new H0;this._onDidModelRefresh=new jt;this.onDidModelsRefresh=this._onDidModelRefresh.event}static{this.ALL_MODEL_KEY="allModels"}async getAllChatModels(){await this._taskSingler.getOrCreate(Wm.ALL_MODEL_KEY,this._fetchModels.bind(this));let e=[];for(let[,t]of this._familyMap)for(let r of t)mD(r)&&e.push(r);return e}async _hydrateResolvedModel(e){if(e=e?await this._findExpOverride(e):void 0,!e)throw this._lastFetchError;if(mD(e)&&e.capabilities.limits?.max_prompt_tokens){e.capabilities.limits.max_prompt_tokens=_xe(this._authService,this._configService,this._expService,e);let t=e.capabilities.limits.max_output_tokens??4096,r=e.capabilities.limits.max_context_window_tokens??t+e.capabilities.limits.max_prompt_tokens;e.capabilities.limits.max_prompt_tokens+t>r&&(e.capabilities.limits.max_prompt_tokens=Math.min(r-4096,e.capabilities.limits.max_prompt_tokens),e.capabilities.limits.max_output_tokens=4096)}return e}async getChatModelFromFamily(e){await this._taskSingler.getOrCreate(Wm.ALL_MODEL_KEY,this._fetchModels.bind(this));let t;if(e==="gpt-4"?t=this._familyMap.get("gpt-4o")?.[0]:e==="gpt-4o-mini"?t=this._familyMap.get("gpt-4o-mini")?.[0]:t=this._familyMap.get(e)?.[0],t=await this._hydrateResolvedModel(t),!mD(t))throw new Error(`Unable to resolve chat model with family selection: ${e}`);return t}async getChatModelFromApiModel(e){await this._taskSingler.getOrCreate(Wm.ALL_MODEL_KEY,this._fetchModels.bind(this));let t;for(let r of this._familyMap.values())if(t=r.find(o=>o.id===e.id&&o.version===e.version&&o.capabilities.family===e.family),t)break;if(t){if(t=await this._hydrateResolvedModel(t),!mD(t))throw new Error(`Unable to resolve chat model: ${e.id},${e.name},${e.version},${e.family}`);return t}}async getEmbeddingsModel(e){await this._taskSingler.getOrCreate(Wm.ALL_MODEL_KEY,this._fetchModels.bind(this));let t=this._familyMap.get(e)?.[0];if(t=await this._hydrateResolvedModel(t),!Xve(t))throw new Error(`Unable to resolve embeddings model with family selection: ${e}`);return t}_shouldRefreshModels(){if(this._familyMap.size===0)return!0;let e=10*60*1e3,t=Date.now();return this._lastFetchTime?t-this._lastFetchTime>e:!0}async _fetchModels(e){if(!e&&!this._shouldRefreshModels())return;let t=Date.now(),r=(await this._authService.getCopilotToken()).token,o=Gt();try{let s=await CX(this._fetcher,this._envService,this._telemetryService,this._domainService,this._domainService.capiModelsURL,r,await ja(process.env.HMAC_SECRET),"model-access",o);if(this._lastFetchTime=Date.now(),this._logService.public.info(`Fetched model metadata in ${Date.now()-t}ms ${o}`),s.status<200||s.status>=300){if(s.status===429&&this._familyMap.size>0){this._logService.public.warn(`Rate limited while fetching models ${o}`);return}throw new Error(`Failed to fetch models (${o}): ${await s.text()||s.statusText||`HTTP ${s.status}`}`)}this._familyMap.clear();let a=(await s.json()).data;a.push(...this._findInternalModels());for(let c of a){let l=c.capabilities.family;this._familyMap.has(l)||this._familyMap.set(l,[]),this._familyMap.get(l)?.push(c)}this._lastFetchError=void 0,this._onDidModelRefresh.fire()}catch(s){this._logService.public.error(s,`Failed to fetch models (${o})`),this._lastFetchError=s,this._lastFetchTime=0}}async _fetchModel(e){let t=(await this._authService.getCopilotToken()).token;try{let o=await(await CX(this._fetcher,this._envService,this._telemetryService,this._domainService,`${this._domainService.capiModelsURL}/${e}`,t,await ja(process.env.HMAC_SECRET),"model-access",Gt())).json();return this._familyMap.has(o.capabilities.family)?this._familyMap.get(o.capabilities.family)?.push(o):this._familyMap.set(o.capabilities.family,[o]),this._onDidModelRefresh.fire(),o}catch{return}}async _findExpOverride(e){let t={},r=this._expService.getTreatmentVariable("vscode","copilotchat.modelOverrides");try{t=JSON.parse(r||"{}")}catch{}if(t[e.id]){for(let[,s]of this._familyMap){let a=s.find(c=>c.id===t[e.id]);if(a)return a}e=await this._taskSingler.getOrCreate(t[e.id],()=>this._fetchModel(t[e.id]))??e}return e}_findInternalModels(){return!this._authService.copilotToken?.isVscodeTeamMember||this._envService.isProduction()?[]:[{id:"copilot-preview-gpt4o-centralus",name:"GPT 4o 128k",version:"1.0.0",model_picker_enabled:!0,capabilities:{type:"chat",family:"gp4o-128k",tokenizer:"o200k_base",limits:{max_context_window_tokens:128e3,max_output_tokens:4096,max_prompt_tokens:123e3}}}]}};Wm=E([v(0,hn),v(1,xn),v(2,be),v(3,fn),v(4,it),v(5,xt),v(6,ge),v(7,oe)],Wm);var l2=class{constructor(e,t,r,o,s,a,c,l,u){this._authService=e;this._domainService=t;this._expService=o;this._envService=s;this._logService=c;this._configService=l;this._instantiationService=u;this._chatEndpoints=new Map;this._embeddingEndpoints=new Map;e.onDidAuthenticationChange(()=>{let d=l.getConfig(le.DebugOverrideChatEngine),p=l.getConfig(le.DebugOverrideEmbeddingsModel),f=e.copilotToken?.isInternal??!1;f&&d&&(this._overridenChatModel=d),f&&p&&(this._overridenEmbeddingsModel=p)}),this._modelFetcher=new Wm(r,t,this._configService,this._expService,s,e,a,c),this._modelFetcher.onDidModelsRefresh(()=>{this._chatEndpoints.clear(),this._embeddingEndpoints.clear()})}shouldDisableSnippy(){let e=this._authService.copilotToken?.isInternal??!1,t=!this._envService.isProduction();return e&&t}getOrCreateChatEndpointInstance(e){let t=e.id,r=this._chatEndpoints.get(t);if(!r){this._configService.getConfig(le.DebugOverrideModelNames)[t]&&(e={...e,name:this._configService.getConfig(le.DebugOverrideModelNames)[t]});let o=this.shouldDisableSnippy();r=this._instantiationService.createInstance(K0,e,o,void 0),this._chatEndpoints.set(t,r)}return r}async getOrCreateEmbeddingEndpointInstance(e){let t=e.id,r=this._embeddingEndpoints.get(t);return r||(r=new IW(e,this._domainService),this._embeddingEndpoints.set(t,r)),r}async getChatEndpoint(e){if(this._logService.public.trace("Resolving chat model"),this._overridenChatModel)return this._logService.public.trace("Using overriden chat model"),this.getOrCreateChatEndpointInstance({id:this._overridenChatModel,name:"Custom Overriden Chat Model",version:"1.0.0",model_picker_enabled:!0,capabilities:{tokenizer:"o200k_base",family:"custom",type:"chat"}});let t;if(typeof e=="string"){let r=await this._modelFetcher.getChatModelFromFamily(e);t=this.getOrCreateChatEndpointInstance(r)}else if(e.model){let r=await this._modelFetcher.getChatModelFromApiModel(e.model);t=r?this.getOrCreateChatEndpointInstance(r):await this.getChatEndpoint("gpt-4")}else t=await this.getChatEndpoint("gpt-4");return this._logService.public.trace("Resolved chat model"),t}async getEmbeddingsEndpoint(e){if(this._logService.public.trace("Resolving embedding model"),this._overridenEmbeddingsModel)return this._logService.public.trace("Using overriden embeddings model"),this.getOrCreateEmbeddingEndpointInstance({id:this._overridenEmbeddingsModel,name:"Custom Overriden Embeddings Model",model_picker_enabled:!1,version:"1.0.0",capabilities:{tokenizer:"o200k_base",family:"custom",type:"embeddings"}});let t=await this._modelFetcher.getEmbeddingsModel("text-embedding-3-small"),r=await this.getOrCreateEmbeddingEndpointInstance(t);return this._logService.public.trace("Resolved embedding model"),r}async getAllChatEndpoints(){let e=await this._modelFetcher.getAllChatModels(),t=[];for(let r of e){let o=this.getOrCreateChatEndpointInstance(r);t.push(o)}return t}};l2=E([v(0,xt),v(1,xn),v(2,hn),v(3,fn),v(4,it),v(5,ge),v(6,oe),v(7,be),v(8,H)],l2);var VHe=q(require("path")),GHe=q(require("vscode"));var A_=q(Ve());var TW=class extends A_.PromptElement{render(){return vscpp(vscppf,null,vscpp(A_.SystemMessage,null,vscpp(bme,null),vscpp(Ze,null)),vscpp(A_.UserMessage,null,vscpp(_me,{templates:this.props.templates,features:this.props.features,filenames:this.props.filenames})))}},bme=class extends A_.PromptElement{render(){return vscpp(vscppf,null,"You are an AI programming assistant.",vscpp("br",null),"You are helping a software developer to configure a Dev Container by picking a configuration template and features.")}},_me=class extends A_.PromptElement{render(){return vscpp(vscppf,null,"This is a partial list of workspace files:",vscpp("br",null),this.props.filenames.map(e=>`- ${e}
`).join(""),vscpp("br",null),"Based on the workspace files, please suggest the best template from the list of templates below.",vscpp("br",null),"First identify the relevant files ignoring common files, then pick the best template and reply with the best template's id.",vscpp("br",null),"This is the list of available templates:",vscpp("br",null),this.props.templates.map(e=>`- ${e.id}: ${e.name||e.id}: ${e.description||e.name||e.id}
`).join(""),vscpp("br",null),"Also based on the workspace files, please suggest all relevant features from the list of features below.",vscpp("br",null),"First identify the relevant files ignoring common files, then pick all relevant features and reply with the relevant features' ids.",vscpp("br",null),"This is the list of available features:",vscpp("br",null),this.props.features.map(e=>`- ${e.id}: ${e.name||e.id}: ${e.description||e.name||e.id}
`).join(""),vscpp("br",null))}};var OPt=["alpine","debian","docker-existing-docker-compose","docker-existing-dockerfile","docker-in-docker","docker-outside-of-docker","docker-outside-of-docker-compose","ubuntu","universal"].map(n=>`ghcr.io/devcontainers/templates/${n}`),MPt=["common-utils","git"].map(n=>`ghcr.io/devcontainers/features/${n}`),u2=class{constructor(e,t,r,o){this.telemetryService=e;this.endpointProvider=t;this.instantiationService=r;this.chatMLFetcher=o}async generate(e,t,r){if(!t.length)return{type:"success",template:void 0,features:[]};let o=Date.now(),s=await this.endpointProvider.getChatEndpoint("gpt-4"),a=Math.floor(s.modelMaxPromptTokens*4/3),c=this.processFilenames(t,a),l=e.templates.filter(g=>!OPt.includes(g.id)),u=(e.features||[]).filter(g=>!MPt.includes(g.id)),p=await Fe.create(this.instantiationService,s,TW,{filenames:c,templates:l,features:u}).render(),f=Date.now(),m=await this.chatMLFetcher.fetchOne("devContainerConfigGenerator",p.messages,void 0,r,5,s),h=m.type==="success"?this.processGeneratedConfig(m.value,l,u):void 0;return this.telemetryService.sendMSFTTelemetryEvent("devcontainer.generateConfig",{model:s.model,requestId:m.requestId,responseType:m.type,templateId:h?.template,featureIds:h?.features.join(",")},{originalFilenameCount:t.length,originalFilenameLength:t.join("").length,processedFilenameCount:c.length,processedFilenameLength:c.join("").length,timeToRequest:f-o,timeToComplete:Date.now()-o}),{type:"success",template:h?.template,features:h?.features||[]}}processFilenames(e,t){let r=[...e],o=Math.floor(t*.9),s=r.join(`
`).length;if(s>o)for(;s>o&&r.length>0;){let a=r.pop();s-=a.length}return r}processGeneratedConfig(e,t,r){let o=t.find(s=>new RegExp(`\\b${j_(s.id)}\\b`).test(e))?.id;return o==="ghcr.io/devcontainers/templates/javascript-node"&&(o="ghcr.io/devcontainers/templates/typescript-node"),{template:o,features:r.filter(s=>new RegExp(`\\b${j_(s.id)}\\b`).test(e)).map(s=>s.id)}}};u2=E([v(0,ge),v(1,_e),v(2,H),v(3,Et)],u2);var d2=class{constructor(e,t){this.instantiationService=e;this.searchService=t}async generateConfiguration(e,t){if(t.isCancellationRequested)return{type:"cancelled"};let r=(await Promise.all(["*","*/*","*/*/*"].map(s=>this.searchService.findFilesWithDefaultExcludes(new GHe.RelativePattern(e.rootUri,s),1e3,t)))).flat().map(s=>VHe.posix.relative(e.rootUri.path,s.path));return this.instantiationService.createInstance(u2).generate(e.index,r,t)}};d2=E([v(0,H),v(1,af)],d2);var tF=q(require("path")),uc=require("vscode");var Km=q(Ve());var CW=class extends Km.PromptElement{render(){return vscpp(vscppf,null,vscpp(Km.SystemMessage,{priority:1e3},vscpp(xme,null),vscpp(Ze,null),vscpp(kt,null)),this.props.recentCommitMessages.user.length>0&&vscpp(Km.UserMessage,{priority:700,name:"user-commits"},"# RECENT USER COMMITS (For reference only, do not copy!):",vscpp("br",null),this.props.recentCommitMessages.user.map(e=>`- ${e}
`).join("")),this.props.recentCommitMessages.repository.length>0&&vscpp(Km.UserMessage,{priority:600,name:"recent-commits"},"# RECENT REPOSITORY COMMITS (For reference only, do not copy!):",vscpp("br",null),this.props.recentCommitMessages.repository.map(e=>`- ${e}
`).join("")),vscpp(Km.UserMessage,{priority:800,name:"changes"},"# CODE CHANGES:",vscpp("br",null),this.props.diff.map(e=>vscpp(vscppf,null,vscpp(Pr,{code:e}),vscpp("br",null)))),vscpp(Km.UserMessage,{priority:900,name:"reminder"},"Now generate a commit messages that describe the CODE CHANGES.",vscpp("br",null),"DO NOT COPY commits from RECENT COMMITS, but it as reference for the commit style.",vscpp("br",null),"ONLY return a single markdown code block, NO OTHER PROSE!",vscpp("br",null),vscpp(Pr,{languageId:"text",code:"commit message goes here"})))}},xme=class extends Km.PromptElement{render(){return vscpp(vscppf,null,"You are an AI programming assistant, helping a software developer to come with the best git commit message for their code changes.",vscpp("br",null),"You excel in interpreting the purpose behind code changes to craft succinct, clear commit messages that adhere to the repository's guidelines.",vscpp("br",null),vscpp("br",null),"# First, think step-by-step:",vscpp("br",null),"1. Analyze the CODE CHANGES thoroughly to understand what's been modified.",vscpp("br",null),"2. Identify the purpose of the changes to answer the *why* for the commit messages, also considering the optionally provided RECENT USER COMMITS.",vscpp("br",null),"3. Review the provided RECENT REPOSITORY COMMITS to identify established commit message conventions. Focus on the format and style, ignoring commit-specific details like refs, tags, and authors.",vscpp("br",null),"4. Generate a thoughtful and succinct commit message for the given CODE CHANGES. It MUST follow the the established writing conventions. 5. Remove any meta information like issue references, tags, or author names from the commit message. The developer will add them.",vscpp("br",null),"6. Now only show your message, wrapped with a single markdown ```text codeblock! Do not provide any explanations or details",vscpp("br",null))}};var p2=class{constructor(e,t,r,o,s){this.chatMLFetcher=e;this.conversationOptions=t;this.endpointProvider=r;this.instantiationService=o;this.telemetryService=s}async generateGitCommitMessage(e,t,r,o){let s=Date.now(),a=await this.endpointProvider.getChatEndpoint("gpt-4o-mini"),c=Math.floor(a.modelMaxPromptTokens*4/3),l=this.processDiff(e,c),d=await Fe.create(this.instantiationService,a,CW,{diff:l,recentCommitMessages:t}).render(void 0,void 0),p=Math.min(this.conversationOptions.temperature*(1+r),2),f=Date.now(),m=await this.chatMLFetcher.fetchOne("gitCommitMessageGenerator",d.messages,void 0,o,5,a,void 0,{temperature:p});if(this.telemetryService.sendMSFTTelemetryEvent("git.generateCommitMessage",{model:a.model,requestId:m.requestId,responseType:m.type},{attemptCount:r+1,originalDiffFileCount:e.length,originalDiffLength:e.join("").length,processedDiffFileCount:l.length,processedDiffLength:l.join("").length,timeToRequest:f-s,timeToComplete:Date.now()-s}),m.type!=="success")return;let[h,g]=this.processGeneratedCommitMessage(m.value);return h!=="oneTextCodeBlock"&&this.telemetryService.sendMSFTTelemetryEvent("git.generateCommitMessageIncorrectResponseFormat",{requestId:m.requestId,responseFormat:h}),g}processDiff(e,t){let r=[...e],o=t-Math.floor(t*.2),s=r.join(`

`).length;if(s>o)for(r.sort((a,c)=>a.length-c.length);s>o&&r.length>0;){let a=r.pop();s-=a.length}return r}processGeneratedCommitMessage(e){let r=/^```text\s*([\s\S]+?)\s*```$/m.exec(e);return r===null?["noTextCodeBlock",e]:r.length!==2?["multipleTextCodeBlocks",e]:["oneTextCodeBlock",r[1]]}};p2=E([v(0,Et),v(1,va),v(2,_e),v(3,H),v(4,ge)],p2);var f2=class{constructor(e,t,r,o,s){this._gitExtensionService=e;this._ignoreService=t;this._instantiationService=r;this._logService=o;this._telemetryService=s;this._commitMessages=new Map;this._disposables=new _t;this._repositoryDisposables=new S1;let a=()=>{this._disposables.add(this._gitExtensionApi.onDidOpenRepository(this._onDidOpenRepository,this)),this._disposables.add(this._gitExtensionApi.onDidCloseRepository(this._onDidCloseRepository,this));for(let c of this._gitExtensionApi.repositories)this._onDidOpenRepository(c)};this._gitExtensionApi=this._gitExtensionService.getExtensionApi(),this._gitExtensionApi?a():this._disposables.add(this._gitExtensionService.onDidChange(c=>{c.enabled&&(this._gitExtensionApi=this._gitExtensionService.getExtensionApi(),a())}))}async generateCommitMessage(e,t=Zt.None){if(!t.isCancellationRequested)return uc.window.withProgress({location:uc.ProgressLocation.SourceControl},async()=>{let r=await this._getChanges(e);if(this._logService.public.debug(`[GitCommitMessageService] Changes (before context exclusion): ${r.length} file(s)`),r.length===0){uc.window.showInformationMessage(uc.l10n.t("Cannot generate a commit message because there are no changes."));return}let o=await this._applyContentExclusion(r);if(this._logService.public.debug(`[GitCommitMessageService] Changes (after context exclusion): ${o.length} file(s)`),o.length===0){uc.window.showInformationMessage(uc.l10n.t("Cannot generate a commit message because the changes were excluded from the context due to content exclusion rules."));return}let s=this._getAttemptCount(e,o),a=await this._getRecentCommitMessages(e),l=await this._instantiationService.createInstance(p2).generateGitCommitMessage(o,a,s,t);if(l&&e.state.HEAD&&e.state.HEAD.commit){let u=this._commitMessages.get(e.rootUri.toString())??new Map;u.set(e.state.HEAD.commit,{attemptCount:s,changes:o,message:l}),this._commitMessages.set(e.rootUri.toString(),u)}return l})}getRepository(e){return this._gitExtensionApi?this._gitExtensionApi.repositories.length===1?this._gitExtensionApi.repositories[0]:(e=e??uc.window.activeTextEditor?.document.uri,e?this._gitExtensionApi.getRepository(e):null):null}async _applyContentExclusion(e){let t=[];for(let r of e){if(r.originalUri===void 0&&r.modifiedUri===void 0){this._logService.public.debug("[GitCommitMessageService] Ignoring change due to missing originalUri and modifiedUri.");continue}if(r.originalUri&&await this._ignoreService.isCopilotIgnored(r.originalUri)){this._logService.public.debug(`[GitCommitMessageService] Ignoring change due to content exclusion rule based on originalUri: ${r.originalUri.toString()}`);continue}if(r.modifiedUri&&r.modifiedUri!==r.originalUri&&await this._ignoreService.isCopilotIgnored(r.modifiedUri)){this._logService.public.debug(`[GitCommitMessageService] Ignoring change due to content exclusion rule based on modifiedUri: ${r.modifiedUri.toString()}`);continue}t.push(r.diff)}return t}_getAttemptCount(e,t){let o=this._commitMessages.get(e.rootUri.toString())?.get(e.state.HEAD?.commit??"");if(!o||o.changes.length!==t.length)return 0;for(let s=0;s<t.length;s++)if(o.changes[s]!==t[s])return 0;return o.attemptCount+1}async _getChanges(e){let t=await e.diff(!0);if(t!=="")return this._parseGitDiff(e,t);let r=await e.diff(),o=this._parseGitDiff(e,r);return o.push(...await this._getUntrackedChanges(e)),o}async _getRecentCommitMessages(e){let t=[],r=[];try{let o=await e.log({maxEntries:5});t.push(...o.map(c=>c.message.split(`
`)[0]));let s=await e.getConfig("user.name")??await e.getGlobalConfig("user.name"),a=await e.log({maxEntries:5,author:s});r.push(...a.map(c=>c.message.split(`
`)[0]))}catch{}return{repository:t,user:r}}async _getUntrackedChanges(e){let t=[];for(let r of e.state.workingTreeChanges.filter(o=>o.status===7))t.push({modifiedUri:r.uri,diff:await this._getUntrackedChangePatch(e,r.uri)});for(let r of e.state.untrackedChanges??[])t.push({modifiedUri:r.uri,diff:await this._getUntrackedChangePatch(e,r.uri)});return t}async _getUntrackedChangePatch(e,t){this._logService.public.info(`[GitCommitMessageService] Generating patch file for untracked file: ${t.toString()}`);let r=[];try{let o=await uc.workspace.fs.readFile(t),s=tF.relative(e.rootUri.fsPath,t.fsPath);r.push(`diff --git a/${s} b/${s}`),r.push("--- /dev/null",`+++ b/${s}`),r.push(`@@ -0,0 +1,${o.length} @@`),r.push(...o.toString().split(`
`).map(a=>`+${a}`))}catch(o){this._logService.public.error(o,`Failed to generate patch file for untracked file: ${t.toString()}`)}return r.join(`
`)}_parseGitDiff(e,t){let r=[],o=l=>{let u=/^---\s(.*)\n\+\+\+\s(.*)$/m.exec(l);if(!u||u.length!==3)return{originalUri:void 0,modifiedUri:void 0};let d=u[1]==="/dev/null"?void 0:uc.Uri.file(tF.join(e.rootUri.fsPath,u[1].substring(2))),p=u[2]==="/dev/null"?void 0:uc.Uri.file(tF.join(e.rootUri.fsPath,u[2].substring(2)));return{originalUri:d,modifiedUri:p}},s=0,a,c=/^diff --git a\/(.+?) b\/(.+?)$/gm;do{if(a=c.exec(t),a===null)break;if(s<a.index){let l=t.substring(s,a.index),{originalUri:u,modifiedUri:d}=o(l);r.push({diff:l,originalUri:u,modifiedUri:d})}s=a.index}while(!0);if(s<t.length){let l=t.substring(s),{originalUri:u,modifiedUri:d}=o(l);r.push({diff:l,originalUri:u,modifiedUri:d})}return r}_onDidOpenRepository(e){typeof e.onDidCommit!==void 0&&this._repositoryDisposables.set(e,e.onDidCommit(()=>this._onDidCommit(e),this))}_onDidCloseRepository(e){this._repositoryDisposables.deleteAndDispose(e),this._commitMessages.delete(e.rootUri.toString())}async _onDidCommit(e){let t=e.state.HEAD;if(!t?.commit)return;let r=this._commitMessages.get(e.rootUri.toString());if(!r)return;let o=await e.getCommit(t.commit),s=o.parents.length>0?o.parents[0]:"",a=r.get(s);if(!a)return;let c=tN(o.message,a.message);this._telemetryService.sendMSFTTelemetryEvent("git.generateCommitMessageSurvival",void 0,{attemptCount:a.attemptCount,survivalRateFourGram:c}),r.delete(s),this._commitMessages.set(e.rootUri.toString(),r)}dispose(){this._repositoryDisposables.dispose(),this._disposables.dispose()}};f2=E([v(0,Ji),v(1,Te),v(2,H),v(3,oe),v(4,ge)],f2);var zHe=require("vscode");var m2=class{constructor(e,t){this._chatVariableService=e,this._fsService=t}async resolveVariablesInPrompt(e,t){let r=[];for(let o of t){let s=o.value;if(s instanceof zHe.Uri){let c=(await this._fsService.readFile(s)).toString().replace(/\r/g,"");s=mo("",c)}let a=this._chatVariableService.getVariable(o.name);r.push({kind:a?.kind??"variable",userMessages:[FPt(o.name)+s]}),o.range&&(e=e.slice(0,o.range[0])+`[#${o.name}](#${o.name}-context)`+e.slice(o.range[1]))}return{parts:r,message:e}}};m2=E([v(0,rE),v(1,gn)],m2);function FPt(n){return`# ${n.toUpperCase()} CONTEXT
`}var Tp=require("vscode");var h2=class extends M5{constructor(t,r){super();this._logService=t;this._authenticationService=r;this._didRegisterLinkProvider=!1;this._entries=[];this._onDidChangeRequests=new jt;this.onDidChangeRequests=this._onDidChangeRequests.event;this._isFirst=!0;this._register(Tp.workspace.registerTextDocumentContentProvider(Ed.chatRequestScheme,{onDidChange:Kl.map(this.onDidChangeRequests,()=>Tp.Uri.parse(Ed.buildUri({kind:"latest"}))),provideTextDocumentContent:o=>{let s=Ed.parseUri(o.toString());if(!s)return`Invalid URI: ${o}`;let a=s.kind==="latest"?this._entries[this._entries.length-1]:this._entries.find(c=>c.id===s.id);return a?a.kind===0?"Not available":this._renderEntryToMarkdown(a.id,a.entry):"Request not found"}}))}getRequests(){return[...this._entries]}addPromptTrace(t,r,o,s){let a=Gt().substring(0,8);this._addEntryIfInternal({kind:0,id:a,name:t,tokens:o.tokenCount,maxTokens:r.modelMaxPromptTokens,trace:s}).catch(c=>this._logService.internal.error(c))}addEntry(t){let r=Gt().substring(0,8);this._addEntryIfInternal({kind:1,id:r,entry:t}).then(o=>{if(o){this._ensureLinkProvider();let s=t.type==="MarkdownContentRequest"?"markdown":`${t.type==="ChatMLCancelation"?"cancelled":t.result.type} | ${t.chatEndpoint.model} | ${t.endTime.getTime()-t.startTime.getTime()}ms | [${t.debugName}]`;this._logService.internal.info(`${Ed.buildUri({kind:"request",id:r})} | ${s}`)}}).catch(o=>this._logService.internal.error(o))}async _addEntryIfInternal(t){return(await this._authenticationService.getCopilotToken())?.isInternal?(this._isFirst&&(this._isFirst=!1,this._logService.internal.info(`Latest entry: ${Ed.buildUri({kind:"latest"})}`)),this._entries.push(t),this._entries.length>100&&this._entries.shift(),this._onDidChangeRequests.fire(),!0):!1}_ensureLinkProvider(){if(this._didRegisterLinkProvider)return;this._didRegisterLinkProvider=!0;let t=new class{provideDocumentLinks(r,o){return Ed.findAllUris(r.getText()).map(s=>new Tp.DocumentLink(new Tp.Range(r.positionAt(s.range.start),r.positionAt(s.range.endExclusive)),Tp.Uri.parse(s.uri)))}};this._register(Tp.languages.registerDocumentLinkProvider({scheme:"output"},t))}_renderMarkdownStyles(){return`
<style>
[id^="system"], [id^="user"], [id^="assistant"] {
		margin: 4px 0 4px 0;
}

.markdown-body > pre {
		padding: 4px 16px;
}
</style>
`}_renderEntryToMarkdown(t,r){if(r.type==="MarkdownContentRequest")return r.markdownContent;let o=[];o.push(`# ${r.debugName} - ${t}`),o.push(""),o.push("## Metadata"),o.push("~~~"),o.push(`url              : ${r.chatEndpoint.url}`),o.push(`model            : ${r.chatParams.model}`),o.push(`maxPromptTokens  : ${r.chatEndpoint.modelMaxPromptTokens}`),o.push(`maxResponseTokens: ${r.chatParams.postOptions?.max_tokens}`),o.push(`location         : ${r.chatParams.location}`),o.push(`postOptions      : ${JSON.stringify(r.chatParams.postOptions)}`),o.push(`intent           : ${r.chatParams.intent}`),o.push(`startTime        : ${r.startTime.toJSON()}`),o.push(`endTime          : ${r.endTime.toJSON()}`),o.push(`duration         : ${r.endTime.getTime()-r.startTime.getTime()}ms`),o.push(`ourRequestId     : ${r.chatParams.ourRequestId}`),r.type==="ChatMLSuccess"?(o.push(`requestId        : ${r.result.requestId}`),o.push(`serverRequestId  : ${r.result.serverRequestId}`),o.push(`timeToFirstToken : ${r.timeToFirstToken}ms`)):r.type==="ChatMLFailure"&&(o.push(`requestId        : ${r.result.requestId}`),o.push(`serverRequestId  : ${r.result.serverRequestId}`)),o.push("~~~"),o.push("## Request Messages");for(let s of r.chatParams.messages)o.push(this._renderMessageToMarkdown(s));if(o.push(""),r.type==="ChatMLSuccess")if(o.push(""),o.push("## Response"),r.deltas?.length)o.push(this._renderDeltasToMarkdown("assistant",r.deltas));else{let s=r.result.value,a="";Array.isArray(s)&&(s.length===1?a=s[0]:a=`${s.map(c=>`<<${c}>>`).join(", ")}`),o.push(this._renderStringMessageToMarkdown("assistant",a))}else r.type==="ChatMLFailure"?(o.push(""),o.push(`## FAILED: ${r.result.reason}`)):r.type==="ChatMLCancelation"&&(o.push(""),o.push("## CANCELED"));return o.push(this._renderMarkdownStyles()),o.join(`
`)}_renderMessageToMarkdown(t){let o=`### ${t.role.charAt(0).toUpperCase()+t.role.slice(1)}
\`\`\`\`md
`;return t.role==="tool"&&(o+=`\u{1F6E0}\uFE0F ${t.tool_call_id}`,t.content&&(o+=`
`)),o+=t.content,t.role==="assistant"&&t.tool_calls?.length&&(t.content&&(o+=`
`),o+=t.tool_calls.map(s=>"\u{1F6E0}\uFE0F "+JSON.stringify(s)).join(`
`)),o+="\n````\n",o}_renderStringMessageToMarkdown(t,r){return`### ${t.charAt(0).toUpperCase()+t.slice(1)}
\`\`\`\`md
${r}
\`\`\`\`
`}_renderDeltasToMarkdown(t,r){let o=t.charAt(0).toUpperCase()+t.slice(1),s=r.map(a=>{let c="";return a.text&&(c+=a.text),a.copilotFunctionCalls&&(c&&(c+=`
`),c+=a.copilotFunctionCalls.map(l=>"\u{1F6E0}\uFE0F "+JSON.stringify(l)).join(`
`)),c}).join("");return`### ${o}
\`\`\`\`md
${s}
\`\`\`\`
`}};h2=E([v(0,oe),v(1,xt)],h2);var g2=q(ht()),Ym=q(Ve());var UPt=5,v2=class{constructor(e){this.instantiationService=e;this.requests=new Map}create(e,t){let r=this.instantiationService.createInstance(nF,t);return this.requests.set(e,r),this.requests.size>UPt&&this.requests.delete(ti.first(this.requests.keys())),r}get(e){let t=this.requests.get(e);if(!t)throw new Error(g2.t("No request found, or it has expired. Please re-submit your query."));return t}};v2=E([v(0,H)],v2);var nF=class{constructor(e,t,r,o,s,a){this.opts=e;this.fileSystemService=t;this.endpointProvider=r;this.instantiationService=o;this.chatMLFetcher=s;this.workspaceService=a;this.fileDescriptions=this.getFileDescriptions();this.fileContents=new Map;this.applied=!1;this.fileDescriptions=this.getFileDescriptions()}get(e){e=e.replaceAll("\\","/").replace(/^\//,"");let t=this.getInner(e),r=this.opts.files.indexOf(e);return r!==-1&&r<this.opts.files.length-1&&t.then(()=>this.getInner(this.opts.files[r+1])),t}async apply(e,t){if(this.applied)throw new Error(g2.t("Edits have already been applied"));try{this.applied=!0;for(let r of this.opts.files){if(t.isCancellationRequested)return;e?.report({message:g2.t("Generating {0}",r)});let o=await this.getInner(r);await this.fileSystemService.writeFile($e.joinPath(this.opts.baseURI,r),new TextEncoder().encode(o))}e?.report({message:g2.t("Edits applied successfully")})}catch(r){throw this.applied=!1,r}}async getInner(e){let t=this.fileContents.get(e);if(t)return t;let r=this.generateContent(e);return this.fileContents.set(e,r),r}async generateContent(e){let t=await this.fileDescriptions,r;try{r=await this.workspaceService.openTextDocumentAndSnapshot($e.joinPath(this.opts.baseURI,e))}catch{}let o=r?.getText(),s=await this.endpointProvider.getChatEndpoint("gpt-4o-mini"),c=await Fe.create(this.instantiationService,s,Ime,{file:e,document:r,allInstructions:t?.response,fileTree:this.opts.fileTree,query:this.opts.query,instructionsForThisFile:t?.perFile.find(u=>u.file===e)?.description}).render(),l=await this.chatMLFetcher.fetchOne("workspaceMutationFileGenerator",c.messages,void 0,Zt.None,5,s,void 0,void 0);if(l.type!=="success")throw this.fileContents.delete(e),new Error(g2.t("Encountered an error while generating the file: ({0}) {1}",l.type,l.reason));if(o&&r){let u=T0().process(l.value,o,r.uri);return wye(o,u.edits)}return l.value}async getFileDescriptions(){let e=await this.endpointProvider.getChatEndpoint("gpt-4o-mini"),r=await Fe.create(this.instantiationService,e,Sme,{fileTreeStr:this.opts.fileTree,query:this.opts.query}).render(),o=await this.chatMLFetcher.fetchOne("workspaceMutationSummarizer",r.messages,void 0,Zt.None,5,e,void 0,void 0);if(o.type!=="success")return;let s=[];for(let[,a,c]of o.value.matchAll(/^`?(.*?)`?:\s*(.+)$/gm))s.push({file:a,description:c});return{perFile:s,response:o.value}}};nF=E([v(1,gn),v(2,_e),v(3,H),v(4,Et),v(5,Be)],nF);var Sme=class extends Ym.PromptElement{render(){return vscpp(vscppf,null,vscpp(Ym.SystemMessage,{priority:1e3},"You are a VS Code assistant. Your job is to generate the project specification when given the user description and file tree structure of the project that a user wants to create. ",vscpp("br",null),vscpp(vn,null),vscpp(Ze,null),vscpp(kt,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"You will be given a user query and a tree of files they wish to edit or create in order to accomplish a task. Think step by step and respond with a text description that lists and summarizes what needs to be done in each file to accomplish the user's task.",vscpp("br",null),"Below you will find a set of examples of what you should respond with. Please follow these examples as closely as possible.",vscpp("br",null),vscpp("br",null),"## Valid question",vscpp("br",null),"User: I want to: add the sequelize ORM to my project and add a user model",vscpp("br",null),"This is the project tree structure:",vscpp("br",null),"```markdown ",vscpp("br",null),"my-express-app",vscpp("br",null),"\u251C\u2500\u2500 src",vscpp("br",null),"\u2502   \u2514\u2500\u2500 models",vscpp("br",null),"\u2502       \u2514\u2500\u2500 user.ts",vscpp("br",null),"\u251C\u2500\u2500 package.json",vscpp("br",null),"\u2514\u2500\u2500 README.md",vscpp("br",null),"```",vscpp("br",null),"## Valid response",vscpp("br",null),"`src/models/user.ts`: This file defines and exports the User model for use in the application.",vscpp("br",null),"`src/routes/index.ts`: This file exports a function `setRoutes` which sets up the routes for the application. It uses the `IndexController` to handle the root route.",vscpp("br",null),"`package.json`: We need to edit the package.json to ensure Sequelize is defined as a dependency",vscpp("br",null),"`README.md`: We should add documentation to the readme file to make consumers aware of the new setup steps.",vscpp("br",null)),vscpp(Ym.UserMessage,{priority:900},"I want to: ",this.props.query,vscpp("br",null),"This is the project tree structure:",vscpp("br",null),"```markdown' ",vscpp("br",null),this.props.fileTreeStr,vscpp("br",null),"```",vscpp("br",null)))}},Ime=class extends Ym.PromptElement{render(){let{file:e,query:t,fileTree:r,allInstructions:o,instructionsForThisFile:s,document:a}=this.props;return vscpp(vscppf,null,vscpp(Ym.SystemMessage,{priority:1e3},"You are a VS Code assistant. Your job is to generate the project specification when given the user description and file tree structure of the project that a user wants to create. ",vscpp("br",null),vscpp(vn,null),vscpp(Ze,null),vscpp(kt,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"The user will describe the task they're trying to accomplish, and ask you to generate or edit a file in persuit of that task.",vscpp("br",null),a?vscpp(Il,null):vscpp(vscppf,null,"Print the entire contents of the file you propose.",vscpp("br",null),"If asked to generate a test file, create a file with a self-contained 'hello world' test case without dependency on any other files or imports aside from the testing framwork.",vscpp("br",null)),"Do not include comments in json files.",vscpp("br",null),"Do not use code blocks or backticks.",vscpp("br",null),"Do not include any other explanation.",vscpp("br",null),vscpp("br",null),a?vscpp(uu,{changes:[{fileName:"package.json",find:['"dependencies": {','  "typescript": "^4.5.4",'],replace:['"dependencies": {','  "mocha": "latest"','  "typescript": "^4.5.4",']}]}):vscpp(vscppf,null,"# Example",vscpp("br",null),"## Question:",vscpp("br",null),"I want to: set up mocha in my workspace",vscpp("br",null),"Please print the contents of the file `src/index.test.ts`",vscpp("br",null),"## Response:",`
const assert = require('assert');
test('hello world!', () => {
	assert.strictEqual(1 + 1, 2);
});
`)),vscpp(Ym.UserMessage,{priority:900},"I want to: ",t,vscpp("br",null),"Please print the contents of the file `",e,"`",vscpp("br",null),s?vscpp(vscppf,null,"Description of this file: ",s):vscpp(vscppf,null,"Here are the files in my workspace, including this one: ",o,"`"),vscpp("br",null),"This is the project tree structure:",vscpp("br",null),"```filetree",vscpp("br",null),r,vscpp("br",null),"```",vscpp("br",null),vscpp("br",null),a&&vscpp(rF,{flexGrow:1,document:a})))}},rF=class extends Ym.PromptElement{constructor(t,r){super(t);this.parserService=r}async render(t,r){let{document:o}=this.props,s=await fx(this.parserService,o,void 0,new Me(0,0,0,0),r.tokenBudget*(2/3));return vscpp(tt,{uri:o.uri,languageId:o.languageId,code:s.text})}};rF=E([v(1,ft)],rF);var Tme=q(require("vscode")),EW=class{get tools(){return Tme.lm.tools}invokeTool(e,t,r){return Tme.lm.invokeTool(e,t,r)}getTool(e){return this.tools.find(t=>t.name===e)}getToolByToolReferenceName(e){throw new Error("This method for tests only")}};function WHe(n,e){let t=e.extensionMode===y2.ExtensionMode.Test;n.define(be,new eq),n.define(Md,new E8),n.define(gc,new OF),n.define(QC,new tq),n.define(nq,new rq),n.define(SC,new aq),n.define(it,new cq),n.define(gn,new uq),n.define(Dbe,new _8),n.define(cO,new Sq),n.define(uC,new fe(rR)),n.define(Lq,new Nq),n.define($t,new Bq),n.define(vi,new vW),n.define(Tl,new fe(ZA)),n.define(Qn,new C5),n.define(WRe,t?new Cq:new Eq),n.define(qt,e),n.define(x7,new Iq),n.define(ah,new yW),n.define(va,{_serviceBrand:void 0,maxResponseTokens:void 0,temperature:.1,topP:1,rejectionMessage:y2.l10n.t("Sorry, but I can only assist with programming related questions.")}),n.define(K6,new EW),n.define(oe,new fe(B1,[[new G8(e)]])),n.define(eu,new fe(h2)),n.define(nB,new fe(Tw,[process.platform])),n.define(ww,new fe(Ew)),n.define(hn,new fe(nR)),n.define(xn,new fe(zk)),n.define(KF,new fe(q1,[void 0,void 0]));let r=e.extension.packageJSON.internalAIKey??"",o=e.extension.packageJSON.ariaKey??"";t?($He(n,e,r,o),n.define(J_,$ke())):($He(n,e,r,o),n.define(J_,new fe(iE))),n.define(xt,new fe(jk)),n.define(iC,new fe(C8)),n.define(_e,new fe(l2)),n.define(ft,new fe(Aq,[!0])),n.define(Ld,new fe(kT)),n.define(m9,new fe(tE)),n.define(Te,new fe(eR)),n.define(_s,new fe(Gk)),n.define(qT,new fe(BT)),n.define(wc,new fe(YT)),n.define(mx,new fe(RT)),n.define(rE,new fe(nE)),n.define(f8,new fe(Mq)),n.define(GT,new fe(Fq)),n.define(af,new fe(ES)),n.define(Dk,new fe(Ak)),n.define(zB,new fe(Nk)),n.define($w,new fe(v2)),n.define(bd,new fe(sR)),n.define(Ji,new fe(Wk)),n.define(z5,new fe(f2)),n.define(Ks,new fe(Au)),n.define(Id,new fe(Yk)),n.define(g5,new fe(Kk)),n.define(H5,new fe(d2)),n.define(ya,new fe(oR)),n.define(Zo,new fe(vq)),n.define(Ts,new fe(yq)),n.define(jd,new fe(Hk)),n.define(j5,new fe(a2)),n.define(EC,new fe(CC)),n.define(u0,new fe(s8)),n.define(Et,new fe(c2)),n.define(R9,new fe(jE)),n.define(Be,new fe(e2)),n.define(Bc,new fe(lq)),n.define(Pd,new fe(iT,[!0])),n.define(wJ,new fe(JC,[!0])),n.define(Y8,new fe(OC,[!0])),n.define(yh,new fe(v0)),n.define(TB,new fe(rk)),n.define(uN,new fe(qC)),n.define(PB,new fe(fk)),n.define(w9,new fe(m2)),n.define(B5,new fe(eT)),n.define(T9,new fe(I9)),n.define(yE,new fe(vE)),n.define(J6,new fe(PT)),n.define(iB,new fe(Lw)),n.define(Dw,new fe(SW)),n.define(dB,new fe(Bw)),n.define(uB,new fe(Uw)),n.define(M1,new fe(Qk)),n.define(pf,new fe(aR)),n.define(cE,new fe(aE)),n.define($0,new fe(tR)),n.define(d9,new fe(XC))}function BPt(n,e){y2.ExtensionMode.Production===e.extensionMode?n.define(fn,new fe(RP)):n.define(fn,new LF)}function $He(n,e,t,r){y2.ExtensionMode.Production===e.extensionMode?n.define(ge,new fe(JA,[e.extension.packageJSON.name,t,r,I9e,T9e])):n.define(ge,new qq),BPt(n,e)}async function qPt(n,e){if(n.extensionMode===b2.ExtensionMode.Test&&!e)return n;b2.l10n.bundle&&KHe.config({contents:b2.l10n.bundle});let t=QHe(n);return await t.invokeFunction(async r=>{let o=r.get(it),s=r.get(fn);o.isProduction()||jPt(),await s.initializePromise,await s.initialFetch;let a=t.createInstance(Ev,oke);n.subscriptions.push(a),await a.waitForActivationBlockers()}),b2.ExtensionMode.Test===n.extensionMode?t:{getAPI(r){if(r>V_.version)throw new Error("Invalid Copilot Chat extension API version. Please upgrade Copilot Chat.");return t.createInstance(V_)}}}function jPt(){try{require("source-map-support").install(),require("dotenv").config({path:[YHe.resolve(__dirname,"../.env")]})}catch(n){console.error(n)}}function QHe(n){let e=new AF;WHe(e,n);let t=e.seal();return n.subscriptions.push(t),t.invokeFunction(r=>{r.get(Te).init(),r.get(PB),r.get(M1)}),t}0&&(module.exports={activate,createExtensionContext});
//!!! DO NOT modify, this file was COPIED from 'microsoft/vscode'
/*! Bundled license information:

@vscode/prompt-tsx/dist/base/util/vs/nls.js:
  (*!!! DO NOT modify, this file was COPIED from 'microsoft/vscode' *)

@vscode/prompt-tsx/dist/base/util/vs/common/platform.js:
  (*!!! DO NOT modify, this file was COPIED from 'microsoft/vscode' *)

@vscode/prompt-tsx/dist/base/util/vs/common/process.js:
  (*!!! DO NOT modify, this file was COPIED from 'microsoft/vscode' *)

@vscode/prompt-tsx/dist/base/util/vs/common/path.js:
  (*!!! DO NOT modify, this file was COPIED from 'microsoft/vscode' *)

@vscode/prompt-tsx/dist/base/util/vs/common/uri.js:
  (*!!! DO NOT modify, this file was COPIED from 'microsoft/vscode' *)

@microsoft/applicationinsights-web-snippet/dist/esm/applicationinsights-web-snippet.js:
  (*!
   * Application Insights JavaScript SDK - Web Snippet, 1.0.1
   * Copyright (c) Microsoft and contributors. All rights reserved.
   *)

mime-db/index.js:
  (*!
   * mime-db
   * Copyright(c) 2014 Jonathan Ong
   * Copyright(c) 2015-2022 Douglas Christopher Wilson
   * MIT Licensed
   *)

mime-types/index.js:
  (*!
   * mime-types
   * Copyright(c) 2014 Jonathan Ong
   * Copyright(c) 2015 Douglas Christopher Wilson
   * MIT Licensed
   *)
*/
